@&#MAIN-TITLE@&#A bi-level belief rule based decision support system for diagnosis of lymph node metastasis in gastric cancer

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A bi-level belief rule based model is proposed for diagnosing gastric cancer.


                        
                        
                           
                           A clonal selection algorithm based method is proposed for optimizing the model.


                        
                        
                           
                           A case study demonstrates the effectiveness of the proposed method.


                        
                        
                           
                           Comparative studies show the better performance of the proposed method.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Clinical decision support system

Gastric cancer

Lymph node metastasis

Belief rule base

Clonal selection algorithm

@&#ABSTRACT@&#


               
               
                  Lymph Node Metastasis (LNM) in gastric cancer is an important prognostic factor regarding long-term survival. As it is difficult for doctors to combine multiple factors for a comprehensive analysis, Clinical Decision Support System (CDSS) is desired to help the analysis. In this paper, a novel Bi-level Belief Rule Based (BBRB) prototype CDSS is proposed. The CDSS consists of a two-layer Belief Rule Base (BRB) system. It can be used to handle uncertainty in both clinical data and specific domain knowledge. Initial BRBs are constructed by domain specific knowledge, which may not be accurate. Traditional methods for optimizing BRB are sensitive to initialization and are limited by their weak local searching abilities. In this paper, a new Clonal Selection Algorithm (CSA) is proposed to train a BRB system. Based on CSA, efficient global search can be achieved by reproducing individuals and selecting their improved maturated progenies after the affinity maturation process. The proposed prototype CDSS is validated using a set of real patient data and performs extremely well. In particular, BBRB is capable of providing more reliable and informative diagnosis than a single-layer BRB system in the case study. Compared with conventional optimization method, the new CSA could improve the diagnostic performance further by trying to avoid immature convergence to local optima.
               
            

@&#INTRODUCTION@&#

Gastric cancer is one of the leading causes for cancer-related death in the world [25]. Lymph Node Metastasis (LNM) is one of the most important prognostic factors regarding long-term survival [7,24,30,34]. The TNM
                        1
                        The international normative TNM classification describes the state of the tumor (T), the lymph nodes (N), and possible metastases (M).
                     
                     
                        1
                      staging system based on American Joint Committee on Cancer (AJCC) is taken as the evaluated standard and has been widely accepted [15]. Based on this standard, the 5-year survival rate of patients in the N0 stage after surgery is 86.1%, while the survival rate for the N1, N2 and N3 stage patients is just 58.1%, 23.3% and 5.9%, respectively [45].

Currently, doctors manually diagnose LNM according to the size of lymph nodes, which relies on various imaging methods, such as multi-slice spiral Computerized Tomography (CT), Magnetic Resonance Imaging (MRI) and Positron Emission computed Tomography (PET). However, any of the above imaging tools cannot assess the lymph node status satisfactorily. For example, large lymph nodes may be caused by inflammation, while small ones may be metastatic. In fact, many studies have shown that LNM is not only associated with the size of lymph nodes but also with the number of lymph nodes. It is difficult for doctors to combine the above two factors to conduct a comprehensive analysis. Fortunately, Clinical Decision Support System (CDSS) from Information Technology (IT) can be used to help solve this problem, which has been applied to medical domains successfully [1,18].

In the current studies, several CDSSs have been proposed for diagnosing LNM, such as Support Vector Machine (SVM) based CDSS [46], and Artificial Neural Network (ANN) based CDSS [9]. However, there are some limitations when these methods are applied in reality. Firstly, these methods are block-box modeling approaches in nature and their internal structures are not directly linked to the reasoning logic or process, which makes it difficult for doctors to know how important each medical attribute is regarding prediction results. Secondly, ANN and SVM are implemented by pure nonlinear data fitting. However, as doctors play an essential role in determining the final stage, it is important to evaluate LNM using both clinical data and doctors’ domain specific knowledge.

From the above discussions, it can be concluded that CDSSs can take into account human judgments are more appropriate to help diagnose LNM. For knowledge based CDSSs, representing and reasoning with uncertain medical knowledge are critical areas which need outstanding methodologies and techniques [18,23]. This is because uncertainties exist in clinical signs, clinical domain knowledge and clinical symptoms, and it is difficult to select domain knowledge and construct knowledge bases [11]. Several CDSSs have been developed by using domain knowledge. An early rule-based expert system named as MYCIN [29] was developed in the early 1970s. Another CDSS called Iliad [33] was developed to assist medical decision-making. In Iliad, a sequential Bayesian inference algorithm is used to generate a ranked list of diagnoses and assign a posterior probability to each diagnosis. Fuzzy logic was used in CDSS for renal transplantation assignment [44]. However, the above methods have their deficiencies in knowledge representation and reasoning. Complete knowledge about all parameters is required in a Bayesian inference model. This creates a bottleneck in a knowledge acquisition process that can be extremely time-consuming. As there is usually a fuzzification and de-fuzzification procedure in a fuzzy inference process, reasoning is controversial in most fuzzy logic based systems [11].

To support modeling and inference with clinical domain knowledge under uncertainties, a recently developed belief Rule-based Inference Methodology using the Evidential Reasoning approach (RIMER) [41] is employed for developing an intelligent CDSS [11] which is used for clinical risk assessment of cardiac chest pain. In this CDSS, Belief Rule Base (BRB) is used to model clinical domain knowledge and reasoning is implemented by the Evidential Reasoning (ER) approach [37,38,40–42]. Compared to other CDSSs as described above, it has the following advantages: (1) BRB can be initialized using domain knowledge or assigned randomly, because the belief rules can be adjusted by historical clinical data, which can help circumvent the bottleneck of estimating all initial parameters. (2) Different types of uncertainties can be included in initial BRB as ER can preserve the original features of uncertainties in inference process and the corresponding effects can also be represented in the final conclusion.

According to the clinical domain knowledge, LNM can be divided into four stages. The higher the stage is, the more severe the illness. Stage 0 represents that LNM does not occur, while stage 3 shows that metastasis is most serious. These two stages can be predicted easily by a single-layer BRB system. However, the prediction of stages 1 and 2 is difficult because they are easily confusing [13,17]. So a single-layer BRB system is difficult to diagnose LNM accurately. To solve this problem, a Bi-level Belief Rule Based (BBRB) prototype CDSS is proposed in this paper. The new prototype CDSS consists of two layers [10,16,28] which are modeled by a single-layer BRB. In the first layer, original stages 1 and 2 are integrated into a new stage, resulting in three stages which include original stages 0, stage 3 and the new stage. In the second layer, a specialized BRB is constructed to distinguish stage 1 from stage 2. Compared to single-layer BRB, BBRB can provide more reliable and informative diagnosis for LNM. As manually constructed belief rules may not be accurate, there is a need to train BBRB. However, training a BRB system is sensitive to system initialization and may lead to a locally optimized BRB system. In this paper, a novel Clonal Selection Algorithm (CSA) for training BRB system is proposed. Compared to conventional methods, new CSA is capable of improving performance significantly.

The rest of the paper is organized as follows. The problem formulation is shown in Section 2. In Section 3, the BBRB CDSS prototype is described. A new CSA based method for optimizing BRB is developed in Section 4. In Section 5, the proposed CDSS prototype for diagnosing LNM is presented. The validation of BBRB is discussed in Section 6. This paper is concluded in Section 7.

Suppose that x
                     =[x
                     1,
                     x
                     2,…,
                     xM
                     ] is the diagnosis factor which are obtained from medical images such as CT images, where xi
                     (i
                     =1,…,
                     M) denotes an attribute and M is the number of attributes. It is assumed that D is the output and P is the corresponding parameter vector. The LNM diagnosis problem is in essence aimed to establish causal relationships between x and D. Such relationships are generally represented by
                        
                           (1)
                           
                              D
                              =
                              f
                              (
                              x
                              ,
                              P
                              )
                           
                        
                     where f is in general a function of D. As there are four stages, the output can also be represented as:
                        
                           (2)
                           
                              D
                              =
                              {
                              (
                              
                                 
                                    D
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    0
                                 
                              
                              )
                              ,
                              (
                              
                                 
                                    D
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              (
                              
                                 
                                    D
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    2
                                 
                              
                              )
                              ,
                              (
                              
                                 
                                    D
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    3
                                 
                              
                              )
                              }
                           
                        
                     where Di
                     (i
                     =0,…,3) is the stage of LNM, βi
                     (i
                     =0,…,3) is the corresponding belief degree and the following constraints are satisfied.
                        
                           (3)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       3
                                    
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                              
                              and
                              
                              0
                              ⩽
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              ⩽
                              1
                              ,
                              
                              i
                              =
                              0
                              ,
                              …
                              ,
                              3
                           
                        
                     
                  

As mentioned in Section 1, D
                     1 and D
                     2 is difficult to distinguish. Therefore, a new BBRB model will be presented to solve this problem. On the other hand, the parameter P is initialized by expert knowledge and may be inaccurate. Although the optimal learning methods have been proposed, they are sensitive to initialization and may lead to local optimization. Therefore, a new CSA based method is proposed, which will be described in Section 4.

In this section, the BBRB model is presented as a two layer system.

The new CDSS prototype is shown in Fig. 1
                        , where x
                        1,
                        x
                        2,…,
                        xM
                         denote the inputs and stage 0–stage 3 is the final output. BRB_1 represents the first layer in BBRB, while BRB_2 represents the second layer. In the first layer, the original stages D
                        1 and D
                        2 are integrated into a new stage, and the output O
                        1 is represented as:
                           
                              (4)
                              
                                 
                                    
                                       O
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         3
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         3
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              (
                              i
                              =
                              1
                              ,
                              …
                              ,
                              3
                              )
                           
                         is the output in BRB_1 and 
                           
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              (
                              i
                              =
                              1
                              ,
                              …
                              ,
                              3
                              )
                           
                         is the belief degree which satisfies:
                           
                              (5)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 1
                                 
                                 and
                                 
                                 0
                                 ⩽
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ⩽
                                 1
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 3
                              
                           
                        If the result is 
                           
                              
                                 
                                    D
                                 
                                 
                                    1
                                 
                                 
                                    1
                                 
                              
                           
                         or 
                           
                              
                                 
                                    D
                                 
                                 
                                    3
                                 
                                 
                                    1
                                 
                              
                           
                        , it shows that LNM will be predicted as D
                        0 or D
                        3 and the decision process ends. Otherwise, the second layer will be activated. Let O
                        2 represent the output of BRB_2 as follows:
                           
                              (6)
                              
                                 
                                    
                                       O
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              (
                              i
                              =
                              1
                              ,
                              2
                              )
                           
                         is the output of BRB_2, and 
                           
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              (
                              i
                              =
                              1
                              ,
                              2
                              )
                           
                         is the assigned belief degree that should satisfy:
                           
                              (7)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 1
                                 
                                 and
                                 
                                 0
                                 ⩽
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 ⩽
                                 1
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                              
                           
                        In BRB_2, the result 
                           
                              
                                 
                                    D
                                 
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                           
                         shows that the final result is D
                        1, while 
                           
                              
                                 
                                    D
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                           
                         shows that it is D
                        2. Since this layer is specially constructed, D
                        1 and D
                        2 may be predicted more accurately. After integrating O
                        1 and O
                        2, the final result D can be obtained. As each layer in BBRB is a BRB system, basics about BRB will be described in the following subsection.

The proposed BBRB prototype CDSS is a two-layer system. Each layer is modeled by a single-layer BRB system, which consists of belief rules for domain knowledge representation. A typical belief rule is defined as follows [41]:
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                          :
                                          if
                                          
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          
                                          is
                                          
                                          
                                             
                                                A
                                             
                                             
                                                1
                                             
                                             
                                                k
                                             
                                          
                                          ∧
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          
                                          is
                                          
                                          
                                             
                                                A
                                             
                                             
                                                2
                                             
                                             
                                                k
                                             
                                          
                                          ⋯
                                          ∧
                                          
                                             
                                                x
                                             
                                             
                                                M
                                             
                                          
                                          
                                          is
                                          
                                          
                                             
                                                A
                                             
                                             
                                                M
                                             
                                             
                                                k
                                             
                                          
                                          ,Then
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  1
                                                                  ,
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  N
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  N
                                                                  ,
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          With a rule weight
                                          
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                          
                                          and attribute weight
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                1
                                                ,
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                δ
                                             
                                             
                                                2
                                                ,
                                                k
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                δ
                                             
                                             
                                                M
                                                ,
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where x
                        1,
                        x
                        2,…,
                        xM
                         denotes the antecedent attributes in the kth rule. The referential value of the jth antecedent attribute in the kth rule is denoted by 
                           
                              
                                 
                                    A
                                 
                                 
                                    j
                                 
                                 
                                    k
                                 
                              
                              (
                              j
                              =
                              1
                              ,
                              …
                              ,
                              M
                              ,
                              k
                              =
                              1
                              ,
                              …
                              ,
                              L
                              )
                           
                        . M represents the number of antecedent attribute, and L is the number of rules in BRB. Further, “∧” represents the “AND” relationship. In addition, Dj
                        (j
                        =1,…,
                        M) is the consequence of LNM stage, and βj
                        
                        ,
                        
                           k
                        (j
                        =1,…,
                        N, k
                        =1,…,
                        L) is the belief degree assigned to the stage Dj
                        . It should be noted that the kth rule is complete if 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    j
                                    ,
                                    k
                                 
                              
                              =
                              1
                           
                        ; otherwise, it is incomplete. θk
                        (k
                        =1,…,
                        L) is the relative weight of the kth rule, while δj
                        
                        ,
                        
                           k
                        (j
                        =1,…,
                        M) represents the relative weight of the jth antecedent attributes in the kth rules, which shows the relative importance of the attribute.

The inference of BRB is implemented by the ER approach. It is originally proposed to deal with Multiple Attribute Decision Analysis (MADA) problems [14] having both qualitative and quantitative attributes under uncertainty [37,38]. The kernel of the ER approach is the ER algorithm which is based on the decision theory and the Dempster–Shafer (D–S) theory of evidence [8,27]. It is utilized to aggregate nonlinear information under uncertainty. It consists of the following two steps.
                           
                              (1)
                              Calculating the activation weight.

The activation weight of the kth rule ωk
                         is calculated by Eq. (9):
                           
                              (9)
                              
                                 
                                    
                                       ω
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                
                                                   ∏
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          L
                                       
                                    
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                
                                                
                                                   l
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                       
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         i
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                              (
                              i
                              =
                              1
                              ,
                              …
                              ,
                              M
                              )
                           
                         are the normalized attribute weights. 
                           
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                              (
                              i
                              =
                              1
                              ,
                              …
                              ,
                              M
                              )
                           
                        , which is called the individual matching degree, is the degree of belief to which the input for the ith antecedent attribute belongs to its jth referential value 
                           
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                           
                         in the kth rule. It can be generated using various ways, depending on the nature of an antecedent attribute and data that are available such as a qualitative attribute using linguistic values [43]. αk
                         is the normalized combined matching degree as follows:
                           
                              (10)
                              
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ki
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        
                           
                              (2)
                              Combining rules by the ER approach.

The final conclusion D which is generated through aggregating all rules using the ER analytical algorithms [32] can be represented as follows:
                           
                              (11)
                              
                                 D
                                 =
                                 f
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                D
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          ,
                                          
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          N
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                           
                         denotes the belief degree in Dj
                        , and are calculated as follows:
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          μ
                                          ×
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∏
                                                         
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         
                                                            L
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ω
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  j
                                                                  ,
                                                                  k
                                                               
                                                            
                                                            +
                                                            1
                                                            -
                                                            
                                                               
                                                                  ω
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     N
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            ∏
                                                         
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         
                                                            L
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            -
                                                            
                                                               
                                                                  ω
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     N
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 1
                                 -
                                 μ
                                 ×
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∏
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   L
                                                
                                             
                                          
                                          (
                                          1
                                          -
                                          
                                             
                                                ω
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 μ
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∏
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      L
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                            ,
                                                            k
                                                         
                                                      
                                                      +
                                                      1
                                                      -
                                                      
                                                         
                                                            ω
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               N
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            i
                                                            ,
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             -
                                             (
                                             N
                                             -
                                             1
                                             )
                                             
                                                
                                                   
                                                      ∏
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      L
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      1
                                                      -
                                                      
                                                         
                                                            ω
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               N
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            i
                                                            ,
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                              
                           
                        
                     

Assume P represents a vector composed of the above parameters in BRB. P includes rule weight, attribute weights and consequent belief degrees as follows:
                           
                              (14)
                              
                                 P
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             L
                                          
                                       
                                       ,
                                       
                                          
                                             δ
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             δ
                                          
                                          
                                             M
                                          
                                       
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             N
                                             ,
                                             L
                                          
                                       
                                       ]
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        The parameters should satisfy the following constraints:
                           
                              (15)
                              
                                 0
                                 ⩽
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 1
                                 ,
                                 0
                                 ⩽
                                 
                                    
                                       δ
                                    
                                    
                                       m
                                    
                                 
                                 ⩽
                                 1
                                 ,
                                 0
                                 ⩽
                                 
                                    
                                       β
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 ⩽
                                 1
                                 ,
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 L
                                 ,
                                 
                                 m
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 M
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 N
                              
                           
                        
                     

The initial parameters of two BRBs in BBRB are given using domain knowledge and may not be accurate. Therefore, it is necessary to adjust them. In the following section, a new optimization method is proposed to fine-tune these parameters for optimal performance.

In this section, a new optimization method that is composed of an optimization model and a new CSA based optimization algorithm is proposed.

The aim of training BBRB is to find a set of parameters which can accurately represent domain knowledge. Fig. 2
                         shows the optimization model of BBRB. In Fig. 2, U is the given input, O is the simulated output, and 
                           
                              
                                 
                                    O
                                 
                                 
                                    ˆ
                                 
                              
                           
                         is the observed output. ζ(P) is the diagnosing error rate. Thus the objective function is described as follows:
                           
                              (16)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          P
                                       
                                    
                                 
                                 {
                                 ζ
                                 (
                                 P
                                 )
                                 }
                              
                           
                        
                     

As two BRBs in BBRB are independent, they can be optimized, respectively. The optimal learning method for training BRB was proposed by Yang et al. [43]. Zhou et al. proposed the recursive optimal training methods to update BRB [48–51]. These training schemes have been applied to several practical problems [5,36,47] successfully. However, current strategies are sensitive to initialization and are limited by their weak local searching abilities.

It is well known that Evolutionary Algorithms (EAs) utilize computational models of evolutionary processes as key elements and are adaptive search schemes which are suitable for optimization in a nonlinear and discrete space. Because this type of algorithms can obtain optimal or near-optimal solutions, they have been applied to many real-world optimization problems. Several different computing paradigms have also been developed, such as genetic algorithm, and particle swarm optimization simulating bird flight. Artificial Immune System (AIS) is another adaptive system inspired by human immune system. AIS makes use of the mechanism of vertebrate immune system in terms of the model of information processing, and constructs new intelligent methods for problem solving. These methods provide evolutionary learning mechanisms including robustness, unsupervised learning, self-organization, and memory. Therefore, they have received a significant amount of interest from researchers and industrial sponsors in recent years. Clonal Selection Algorithm (CSA) is a major part for optimization in AIS, which has received wide attention [19–21]. The potential of CSA for global optimization inspires us to use it to train a BRB system. To solve this problem, a new CSA, which is a global and efficient optimization algorithm, is proposed in this paper.

It is well known that CSA should initialize population in the first step. Most of the existing CSAs initialize population randomly. However, BRB allows direct intervention of human judgments and thus domain knowledge should be embedded. The initial population is a suitable place to embed knowledge from problem domain.

In our case, initial rules in BRB are extracted by examining historical data and domain knowledge. Different individuals are generated in initial population to keep the diversity of individuals. To obtain a sufficient number of individuals, we utilize individuals provided by experts to generate other individuals which are added to the initial population. This process will not stop until sufficient individuals are generated. So the initial population consists of two parts: individuals provided by experts and generated antibodies [26]. The initial population is represented as
                           
                              (17)
                              
                                 Pop
                                 (
                                 j
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                j
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                I
                                             
                                             
                                                j
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                I
                                             
                                             
                                                j
                                             
                                             
                                                Num
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 j
                                 =
                                 0
                              
                           
                        where the population number is Num. Suppose that G is the maximum number of evolutionary generation. The initial objective-function values of population are
                           
                              (18)
                              
                                 
                                    
                                       ζ
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                ζ
                                             
                                             
                                                1
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                ζ
                                             
                                             
                                                2
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ζ
                                             
                                             
                                                M
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 j
                                 =
                                 0
                              
                           
                        
                     

The whole process is shown as follows.
                           
                              Step 1: Clone operator is executed. Assume that CS represents clonal scale. Each individual in Pop(j) is cloned CS times.

Step 2: Mutation is operated on the cloned population. As different parameters in BRB have different constraints, mutation cannot be executed simultaneously. So a novel Group based Mutation Operator (GMO) is devised.

GMO is a two-stage operator. In the first stage, certain individuals are selected for mutation with probability 1/CS. Then the parameters in BRB are divided into several groups according to the types of constraints. Attribute weights δj
                        , j
                        =1,…,
                        Mk
                         and rule weights θi
                        , i
                        =1,…,
                        L are two groups, and they satisfy
                           
                              (19)
                              
                                 0
                                 ⩽
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 1
                                 
                                 and
                                 
                                 0
                                 ⩽
                                 
                                    
                                       δ
                                    
                                    
                                       j
                                    
                                 
                                 ⩽
                                 1
                              
                           
                        
                     

Meanwhile, there are L groups of belief degrees as L rules are generated. Every group should satisfy
                           
                              (20)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       j
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                                 ,
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 L
                                 
                                 and
                                 
                                 0
                                 ⩽
                                 
                                    
                                       β
                                    
                                    
                                       j
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 1
                              
                           
                        Therefore, there are L
                        +2 groups in total. According to prior knowledge, each group is chosen by the probability of 0.5 in the selected individuals. If a group is chosen, it will be mutated by a set of randomly generated constrained data.


                        
                           
                              Step 3: Updating population is performed. After the mutation operation is finished, several new individuals are generated and added to the population. To keep the number of original population unchanged, a new population is generated by selecting M individuals. The objective-function values of cloned population are calculated firstly. Then the minimal objective-function value of every cloned individual will be selected and represented by 
                                    
                                       
                                          
                                             ζ
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       {
                                       
                                          
                                             ζ
                                          
                                          
                                             1
                                          
                                          
                                             c
                                          
                                       
                                       ,
                                       
                                          
                                             ζ
                                          
                                          
                                             2
                                          
                                          
                                             c
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             ζ
                                          
                                          
                                             M
                                          
                                          
                                             c
                                          
                                       
                                       }
                                    
                                 . The cloned individual will replace the original individual only if


                        
                           
                              Step 4: Step 1–3 is executed repeatedly until j
                                 =
                                 G. When the algorithm stops, the individual with minimal objective-function value is considered as output.

After constructing the BBRB model and describing the proposed optimization algorithm, we will utilize them for diagnosing LNM which is presented in the following section (see Table 1
                        ).

In this section, BBRB prototype CDSS is used for diagnosing LNM. The proposed prototype CDSS consists of two aspects: (i) constructing each component in a BBRB system and (ii) the training process.

Since the size of LN (represented as LNsize) and the number of LN (represented as LNnumber) are the two important factors in LNM diagnosis, they are chosen as the medical antecedent attributes. The two medical antecedent attributes are described as follows:
                              
                                 (1)
                                 The number of LN: The number of all visible gastric regional lymph nodes in CT images by groups is counted.

The size of LN: The short axis of the largest lymph node detected in CT images is measured.

To represent the domain knowledge in BBRB, the referential points are given. Note that the number and the value of referential points are set on the basis of clinical domain knowledge [22,35]. As there are two BRBs in the BBRB, two groups of referential points are given.

In BRB_1, for LNsize, eleven referential points are used, and they are zero (Z), super small (SS), very small (VS), small (S), a little small (LS), middle (M), a little large (LL), large (L), very large (VL), greatly large (GL), and super larger (SL). That is
                              
                                 (22)
                                 
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                       
                                          1
                                       
                                    
                                    ∈
                                    
                                       
                                          
                                             Z,SS,VS,S,LS,M,LL,L,VL,GL,SL
                                          
                                       
                                    
                                 
                              
                           
                        

For LNnumber, nine referential points are used, and they are zero (Z), very small (VS), small (S), a little small (LS), middle (M), a little larger (LL), large (L), very large (VL), and greatly large (GL), i.e.,
                              
                                 (23)
                                 
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                       
                                          1
                                       
                                    
                                    ∈
                                    
                                       
                                          
                                             Z,VS,S,LS,M,LL,L,VL,GL
                                          
                                       
                                    
                                 
                              
                           
                        

As the number of output in BRB_1 is three, three referential points are used and shown as follows:
                              
                                 (24)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   D
                                                
                                                
                                                   2
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   D
                                                
                                                
                                                   3
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           However, the referential points defined above are in linguistic terms. So they should be quantified. Table 2
                            shows the quantified value of LNsize, while Table 3
                            shows the quantified value of LNnumber.

BRB_2 is mainly used for evaluating original stage 1 and stage 2. For LNsize in BRB_2, nine referential points are used, and they are zero (Z), very small (VS), small (S), a little small (LS), middle (M), a little larger (LL), large (L), very large (VL), and greatly large (GL). That is
                              
                                 (25)
                                 
                                    
                                       
                                          A
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    ∈
                                    {
                                    Z,VS,S,LS,M,LL,L,VL,GL
                                    }
                                 
                              
                           
                        

For LNnumber in BRB_2, eight referential points are used. They are zero (Z), very small (VS), small (S), middle (M), a little larger (LL), large (L), very large (VL), and greatly large (GL), i.e.,
                              
                                 (26)
                                 
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    ∈
                                    {
                                    Z,VS,S,M,LL,L,VL,GL
                                    }
                                 
                              
                           
                        

The output in BRB_2 is two, and there are two referential points as follows. In addition, the corresponding quantified values are shown in Tables 4 and 5
                           
                           .
                              
                                 (27)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   D
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The final output of BBRB is four stages, so there are four referential points. They are
                              
                                 (28)
                                 
                                    D
                                    =
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          D
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          D
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          D
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                              
                           
                        

According to the above description, the prototype CDSS can be generated. A belief rule in BRB_1 is represented as follows.
                              
                                 (29)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                             :
                                             if
                                             
                                             LNsize
                                             
                                             is
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   1
                                                
                                                
                                                   k
                                                
                                             
                                             
                                             and
                                             
                                             LNnumber
                                             
                                             is
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   2
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             THEN stage is
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            1
                                                            k
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      ,
                                                      (
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            2
                                                            k
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      ,
                                                      (
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            3
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            3
                                                            k
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            ik
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ⩽
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             with a rule weight
                                             
                                             
                                                
                                                   θ
                                                
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                             
                                             (
                                             k
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             99
                                             )
                                             
                                             and attribute weight
                                             
                                             
                                                
                                                   δ
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   δ
                                                
                                                
                                                   2
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The belief rule in BRB_2 can be represented as shown in Eq. (30), where 
                              
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                    
                                       k
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       A
                                    
                                    
                                       2
                                    
                                    
                                       k
                                    
                                 
                              
                            are the referential values in BRB_1 and BRB_2 as defined in Tables 2–5. As LNsize is divided into 11 terms and LNnumber 9 terms, the combinations of the two antecedents generate 99 rules in total in BRB_1. Similarly, 72 rules are generated in BRB_2. In the two BRBs, we assume that all belief rules have equal rule weight, all medical antecedent attributes have equal weight, and the initial belief degrees assigned to each stage is based on the statistics of available historical patient data and clinical domain knowledge.
                              
                                 (30)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   k
                                                
                                                
                                                   2
                                                
                                             
                                             :
                                             if
                                             
                                             LNsize
                                             
                                             is
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   1
                                                
                                                
                                                   k
                                                
                                             
                                             
                                             and
                                             
                                             LNnumber
                                             
                                             is
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   2
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             THEN stage is
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            1
                                                            k
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                      ,
                                                      (
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            2
                                                            k
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            ik
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ⩽
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             with a rule weight
                                             
                                             
                                                
                                                   θ
                                                
                                                
                                                   k
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             k
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             72
                                             )
                                             
                                             and ttribute weight
                                             
                                             
                                                
                                                   δ
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   δ
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           Compared to traditional rules, reasoning with belief rules is more informative because BBRB shows a distributed clinical conclusion which provides an overall view about the situation of LNM. This is helpful for each patient to determine a therapeutic regimen. For example, an evaluating result for one patient in BRB_1 is 
                              
                                 {
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 0.00
                                 )
                                 ,
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 0.80
                                 )
                                 ,
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       3
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 0.20
                                 )
                                 }
                              
                            and BRB_2 is 
                              
                                 {
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 0.65
                                 )
                                 ,
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 0.35
                                 )
                                 }
                              
                           . The final result is {(D
                           0,0.00),(D
                           1,0.52),(D
                           2,0.28),(D
                           3,0.20)}. Although the result is mainly stage 1, we still should consider the changeable tendency of state of an illness because the condition may become worse in the future. Therefore, doctors not only should provide treatment for illness at stage 1, but also think about how to treat it if patient’s condition becomes stage 2.

As the two BRBs in BBRB are independent, they can be optimized, respectively. The parameters that need to be trained are shown in Eq. (4). In BRB_1, N
                        =3 L
                        =99 and M
                        =2, while N
                        =2, L
                        =72 and M
                        =2 in BRB_2. The inputs for the two layers are both LNsize and LNnumber, that is
                           
                              (31)
                              
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 (
                                 LNsize
                                 ,
                                 LNnumber
                                 )
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                              
                           
                        
                     

The training process is outlined in the following steps.
                           
                              Step 1: Set initial parameters

When CSA is used, an initial population should be generated. Meanwhile, the clinical domain knowledge should be embedded. In this paper, the initial belief degrees are obtained based on the statistics of available historical patient data and clinical domain knowledge. Then two populations which both consist of 100 individuals in two BRBs are generated, respectively. To simplify the initial process, we use the fminimax function provided by the optimization toolbox in MATLAB environment to generate individuals. Different intermediate results in optimizing process are considered as individuals. The process will not stop until generating the required number of individuals. The maximum number of evolutionary generation is set as 50.
                           
                              Step 2: Input data transformation

A rule-based transformation technique is applied to the transformation of quantitative data [39]. The input value U
                        1 in BRB_1 needs to be transformed and represented in terms of the referential values as defined in Tables 2 and 3 using belief degrees representing the degrees to which the input values match the referential values [36]. The input U
                        2 in BRB_2 is also transformed and represented based on Tables 4 and 5.
                           
                              Step 3: Combine the activated rules

By utilizing the ER analytical algorithm [32], the activated rules can be combined to generate the final result. For BRB_1, the result is as follows:
                           
                              (32)
                              
                                 
                                    
                                       O
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       U
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          3
                                       
                                    
                                 
                              
                           
                        
                     

The result in BRB_2 is
                           
                              (33)
                              
                                 
                                    
                                       O
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       U
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          j
                                          =
                                          1
                                          ,
                                          2
                                       
                                    
                                 
                              
                           
                        
                     


                        
                           
                              Step 4: Calculate the prediction error rate

The objective functions that need to be optimized are calculated as follows:
                           
                              (34)
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       M
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                              
                           
                        where M is the number of training samples, and C is the number of correct prediction samples in training set.


                        
                           
                              Step 5: Update the parameters

We use the proposed CSA for updating. The objective is to update Pi
                         in two BRBs so as to minimize the prediction error rate, that is
                           
                              (35)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                              
                           
                        
                     

Then a new population will be generated. Steps 2–5 will be executed iteratively until it achieves the maximum number of evolutionary generation. As a result, there will be a new set of parameters for two BRBs. To validate the proposed model and CSA based training algorithm, a case study is given in the next section.

The proposed prototype CDSS is validated by a set of real patient data. To test the system, the 2-cross-validation approach is used [31]. In detail, we divide the data into two subsets with similar size. Then we run each experiment twice, each time using one subset as training set, and using the other subset as test set. Different from traditional cross-validation which randomly split available data into training and testing set, we split the data into two similar sets to ensure most belief rules in BBRB can be trained and also tested in the testing process [11].

To better demonstrate the overall performance of system, we use Confusion Matrix (CM) [3] to show the results. Each column of the matrix represents the instances in a predicted stage, while each row represents the instances in an actual stage. There are two evaluated indexes: User Accuracy (UA) and Procedure Accuracy (PA). UA is the ratio of the number of correct predicted stage to the number of test sets in this stage. PA is the ratio of the number of correct predicted stage to the number of a part of test data whose predicting result is this stage. All the experiments are performed in MATLAB 2009a and run on PC with 2.99GHz and 2G memory.

In this section, the real patient data are described firstly. Then BBRB is validated by comparing it with a traditional BRB system. The new optimization method is validated in the following subsection. Finally, a comparative study among SVM, ANN and BBRB is presented.

255 Real patient data provided by Beijing Cancer Hospital (Beijing, PR China) are taken as samples. It should be noted that the informed consent from all selected patients were obtained prior to the routine clinical course. The details of patient characteristics are shown in Table 6
                         and two medical antecedent attributes are described in Table 7
                        .

In this study, the proposed CSA is utilized for training BBRB. In the training process, all the training data can be used in BRB_1. In BRB_2, training data whose original stage is 1 or 2 are utilized. Table 8
                         shows the CM of BBRB. It can be seen the overall correct rate achieves 85.1%. To demonstrate the performance better, several comparative studies are given in the following subsection.

A single-layer BRB system is used for comparison. The same CSA is utilized for training both single-layer BRB and BBRB. The reference points of BRB are the same as BRB_1 in BBRB. The initial belief degrees in BRB are also given by the statistics of available historical patient data and domain knowledge, and other parameters are the same as BBRB. The way to generate initial population and the number of initial population in BRB are also the same as in BBRB.


                        Table 9
                         shows the CM of BRB. From PA and UA, it can be seen that BBRB performs better than BRB. The overall correct rate of BRB is just 77.65%, which is lower than BBRB. By comparing the PA and UA of the two systems in stage 1 and stage 2, BBRB outperforms BRB as well. This shows that BBRB is more effective for distinguishing stage 1 from stage 2 in this case study. To better show the evaluated results, Fig. 3
                         shows the PA and UA of the two systems. It shows that BBRB performs better in all four stages.

To show the performance of CSA based training algorithm, we compare CSA (represented as BBRB-CSA) with the minmax method (represented as BBRB-minmax) [42] which are realized by MATLAB optimization toolbox [6]. The initialization of belief degrees and other parameters are the same in both methods. Meanwhile, the diagnostic performance in test set before training (represented as BBRB-pre) is also presented.


                        Tables 10 and 11
                        
                         shows the CM of BBRB-mimax and BBRB-pre. Before training, the overall correct rate is only 57.65%. More seriously, the UA and PA of stage 2 are both 0. Therefore, training procedure is very important. Fig. 4
                         shows the UA and PA of three conditions. BBRB-CSA performs better than BBRB-minmax in all cases. This may be due to the fact that the proposed CSA overcomes the drawback of conventional methods.

As SVM and ANN have been applied to evaluating LNM, the following comparative study is carried out. On the other hand, we develop the same two-layer system for SVM (represented as BSVM) and ANN (represented as BANN) for comparisons because BBRB is the two-layer system. Firstly, the type of SVM in BSVM is LibSVM2.91 [4]. The kernel function is Radial Basis Function (RBF), in which the regularization and kernel parameters are set to {2−3,2−2,…,210}. The highest recognition rate is regarded as the output of BSVM. Secondly, for BANN, the feed forward neural network [2,12] in MATLAB tool box is adopted for two layers. Note that each ANN has a single hidden layer and the number of nodes is 5. Moreover, As ANN is always sensitive to initial parameters, the best results in 10 different runs are considered as the output. The 2-fold-cross validation method is still adopted. Training and test data in each fold is the same among the three CDSSs.


                        Tables 12 and 13
                        
                         shows the CM of BANN and BSVM. The overall correct rate of BANN and BSVM is 75.69% and 77.25%, respectively. It is clear that the proposed prototype CDSS is significantly better than BANN and BSVM. Fig. 5
                         shows the PA and UA of the three CDSSs. In most cases, BBRB can obtain best performance, especially stage 1 and stage 2. This may be partly because the domain knowledge is embedded into the BBRB.

@&#CONCLUSIONS@&#

In this paper, a Bi-level Belief Rule Based (BBRB) CDSS prototype was proposed for diagnosing LNM in gastric cancer. The proposed prototype CDSS consists of two layers which are both modeled by BRB. Moreover, as the current methods for optimizing BRB are sensitive to initial values and are limited by their weak local searching abilities, a novel CSA strategy was developed, which is also taken as a general method for optimizing BRB. The validation of the proposed prototype CDSS was conducted using a set of real patient data. Based on the developed CDSS prototype and the system validation results, it is concluded that (1) BBRB is more suitable in evaluating LNM than traditional BRB system, especially for distinguishing stage 2 from stage 3. (2) Compared to traditional optimization method, the proposed CSA can improve performance further. (3) A comparative study among available CDSSs demonstrated that BBRB is capable of generating better diagnostic performance.

The effectiveness of the BBRB prototype CDSS for diagnosing LNM has been validated by a real patient data set. However, this is a preliminary study and its capability still needs to be tested by more case studies. Meanwhile, the proposed prototype CDSS can be generalized to other medical diagnosis problems. The proposed CSA method can also be designed by other EAs. Those need to be studied in future research.

@&#ACKNOWLEDGMENTS@&#

The authors thank the editor and two anonymous referees for their constructive comments and suggestions, which have been very help in enhancing the paper quality. The authors would like to thank their collaborators of Beijing Cancer Hospital for their suggestions and impressive work. This research was supported in part by the Fund for Foreign Scholars in University Research and Teaching Programs (the 111 Project) (Grant No. B07048), in part by the National Natural Science Foundation of China (Nos. 60970067, 61072139, 61272282, 61173092), in part by the Program for Cheung Kong Scholars and Innovative Research Team in University (No. IRT1170), and in part by the Fundamental Research Funds for the Central Universities (No. K5051203002).

@&#REFERENCES@&#

