@&#MAIN-TITLE@&#A therapy parameter-based model for predicting blood glucose concentrations in patients with type 1 diabetes

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           New glucose prediction model for the treatment of type 1 diabetes.


                        
                        
                           
                           Strongly correlation of model parameters with therapy parameters.


                        
                        
                           
                           Equivalent predictions to models with 50% more parameters.


                        
                        
                           
                           Validation on clinical data as well as UVa simulation data.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Type 1 diabetes mellitus

Blood glucose prediction

Therapy parameters

Physiological model

Blood glucose control

@&#ABSTRACT@&#


               
               
                  In this paper, the problem of predicting blood glucose concentrations (BG) for the treatment of patients with type 1 diabetes, is addressed. Predicting BG is of very high importance as most treatments, which consist in exogenous insulin injections, rely on the availability of BG predictions. Many models that can be used for predicting BG are available in the literature. However, it is widely admitted that it is almost impossible to perfectly model blood glucose dynamics while still being able to identify model parameters using only blood glucose measurements. The main contribution of this work is to propose a simple and identifiable linear dynamical model, which is based on the static prediction model of standard therapy. It is shown that the model parameters are intrinsically correlated with physician-set therapy parameters and that the reduction of the number of model parameters to identify leads to inferior data fits but to equivalent or slightly improved prediction capabilities compared to state-of-the-art models: a sign of an appropriate model structure and superior reliability. The validation of the proposed dynamic model is performed using data from the UVa simulator and real clinical data, and potential uses of the proposed model for state estimation and BG control are discussed.
               
            

@&#INTRODUCTION@&#

Type 1 diabetes mellitus is an autoimmune disease that destroys insulin producing beta cells. Since insulin stimulates the uptake of glucose by cells, the lack of insulin leads to high levels of BG. This condition, referred to as hyperglycemia, is at the origin of numerous other medical conditions such as blindness, nerve damage, vascular diseases, and so forth [1]. Patients with Type 1 diabetes are typically treated by exogenous insulin injections that replace endogenous production. The amount of insulin, which can be administered by means of an insulin pen or pump, needs to be carefully computed, as an insulin overdose leads to low BG, i.e. to hypoglycemia. Fainting, coma or even death may result from hypoglycemia, which, thus, has to be avoided. Preventing hyper- and hypoglycemia is complicated by the huge variability of insulin absorption and action between patients, but also within one patient [2]. Thus, predicting BG is a challenging but crucial task, as most therapies rely, to some extent, on BG predictions.

The development of reliable BG prediction models, that can be used e.g. in bolus calculators, educational tools, insulin pump suspension algorithms and closed-loop BG controllers, is a very active research field and many prediction models are now available in the literature. Some of these models, which can be of very different nature, have been recently reviewed and discussed by Steil et al. and Boutayeb et al. [3,4]. But among all the available models, the most commonly used are undoubtedly compartmental models. These models, whose complexities rise from the simplicity of the minimal model of Bergman [5] to the complexity of the models of Hovorka et al. [6] or Dalla Man et al. [7], e.g., show potentially good prediction capabilities as long as they can be personalized [8]. The personalization of the corresponding model parameters is only possible if, together with BG, additional measured quantities, such as insulin concentrations and tracer measurements, are available. Unfortunately this is rarely the case and prediction models that are identifiable with only BG measurements should be preferred. This justifies the widespread use of black-box models, such as auto-regressive models [9], or neural networks [10–12]. These models, however, have the disadvantage that their parameters cannot be linked to physically observable quantities. As a result, identification errors which result in unlikely parameters cannot be easily detected and predictions may become dangerously corrupted. Yates and Watson therefore proposed recently to use a Maximum A Posteriori method in combination with the minimal model in order to do BG predictions [13]. However, this has the disadvantage of heavily relying on prior knowledge.

In this context, the contribution of this paper is to propose a new compartmental model that can be identified using only BG measurements. Its simple linear structure, together with its low number of model parameters and states, facilitates the identification step and prevents fitting measurement noise. Additionally, it is proven that the corresponding models parameters are related to the standard therapy parameters, which have a physiological meaning. These are very valuable model properties for applications like continuous glucose measurement signal filtering, BG control (automated pancreas or open loop control), state estimation, bolus calculators, or pump suspension algorithms.

The paper is organized as follows: in Section 2, the new Therapy Parameter-based Model (TPM) is presented and the link between its parameters and standard therapy parameters is discussed. In Section 3, the UVa simulator and clinical data used to validate the model, the identification method, and the evaluation metrics are described. The validation method of the TPM is presented in Section 4. This validation is performed in 3 successive steps: (i) the model is fitted to the UVa simulator and study data, (ii) the correlation between model and therapy parameters is verified, and (iii) model predictions are analyzed and compared. We conclude the paper in Section 5 and give an outlook on future work.

In this section, the model equations of the TPM are derived from the Bergman Minimal Model and the relation between TPM parameters and physician-set therapy parameters is shown.

Though originally designed to provide estimations of insulin sensitivities based on intravenous glucose tolerance tests in dogs and subsequently in humans [14], the BMM [5] has recently been used for BG prediction and control [15–18] and is found in modified versions, too [19]. One variation of the Bergman minimal model equations is as follows:


                           
                              
                                 (1)
                                 
                                    
                                       
                                          dG
                                          (
                                          t
                                          )
                                       
                                       dt
                                    
                                    =
                                    −
                                    X
                                    (
                                    t
                                    )
                                    G
                                    (
                                    t
                                    )
                                    −
                                    
                                       S
                                       G
                                    
                                    G
                                    (
                                    t
                                    )
                                    +
                                    
                                       U
                                       endo
                                    
                                 
                              
                           
                           
                              
                                 (2)
                                 
                                    
                                       
                                          dX
                                          (
                                          t
                                          )
                                       
                                       dt
                                    
                                    =
                                    −
                                    
                                       p
                                       2
                                    
                                    (
                                    X
                                    (
                                    t
                                    )
                                    −
                                    
                                       S
                                       I
                                    
                                    I
                                    (
                                    t
                                    )
                                    )
                                 
                              
                           
                        

where G is the BG concentration in mg
                           
                           dl
                           −1, X is the insulin action in 
                              
                                 min
                                 
                                    −
                                    1
                                 
                              
                           , S
                           
                              G
                            is the glucose effectiveness at zero insulin in 
                              
                                 min
                                 
                                    −
                                    1
                                 
                              
                           , S
                           
                              I
                            is the insulin sensitivity in 
                              
                                 U
                                 
                                    −
                                    1
                                 
                              
                              ·
                              
                                 min
                                 
                                    −
                                    1
                                 
                              
                              ·
                              l
                           , U
                           
                              endo
                            is the endogenous glucose production in 
                              mg
                              
                              
                                 dl
                                 
                                    −
                                    1
                                 
                              
                              
                              
                                 min
                                 
                                    −
                                    1
                                 
                              
                           , and p
                           2 is the inverse of time constant of the insulin action in 
                              
                                 min
                                 
                                    −
                                    1
                                 
                              
                           . I is the plasma insulin concentration in U/l.

What makes the BMM appealing for prediction and control is mainly its simple structure and its widespread acceptance, although, to be used as a prediction model, it requires additional sub-models for meal contributions, insulin dynamics and, optionally, physical activity [20]. However, the identification of BMM parameters is only possible with a priori knowledge [21] or using insulin concentration measurements [22]. Identifiability can be improved by using sub-models such as proposed by Kanderian et al. [23], provided the insulin concentration profile I(t) is available. This is unfortunately not the case in practice, as I(t) is not measured, and the identifiability of the BMM is still an issue.

Prud’homme et al. [24] recently extended the BMM by substituting the insulin action and insulin absorption models [25] by a 2nd-order insulin action model and by adding the 2nd-order linear carbohydrates (CHO) sub-model by Hovorka et al. [26], resulting in the following set of ODEs:


                           
                              
                                 (3)
                                 
                                    
                                       
                                          dG
                                          (
                                          t
                                          )
                                       
                                       dt
                                    
                                    =
                                    −
                                    X
                                    (
                                    t
                                    )
                                    G
                                    (
                                    t
                                    )
                                    −
                                    
                                       S
                                       G
                                    
                                    G
                                    (
                                    t
                                    )
                                    +
                                    
                                       U
                                       endo
                                    
                                    +
                                    
                                       U
                                       G
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                           
                              
                                 (4)
                                 
                                    
                                       
                                          
                                             dU
                                             G
                                          
                                          (
                                          t
                                          )
                                       
                                       dt
                                    
                                    =
                                    
                                       
                                          U
                                          ˙
                                       
                                       G
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                           
                              
                                 (5)
                                 
                                    
                                       
                                          d
                                          
                                             
                                                U
                                                ˙
                                             
                                             G
                                          
                                          (
                                          t
                                          )
                                       
                                       dt
                                    
                                    =
                                    −
                                    2
                                    
                                       a
                                       g
                                    
                                    
                                       
                                          U
                                          ˙
                                       
                                       G
                                    
                                    (
                                    t
                                    )
                                    −
                                    
                                       a
                                       g
                                       2
                                    
                                    
                                       U
                                       G
                                    
                                    (
                                    t
                                    )
                                    +
                                    
                                       K
                                       g
                                    
                                    
                                       a
                                       g
                                       2
                                    
                                    
                                       U
                                       CHO
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                           
                              
                                 (6)
                                 
                                    
                                       
                                          dX
                                          (
                                          t
                                          )
                                       
                                       dt
                                    
                                    =
                                    −
                                    
                                       a
                                       x
                                    
                                    X
                                    (
                                    t
                                    )
                                    +
                                    
                                       a
                                       x
                                    
                                    
                                       X
                                       1
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                           
                              
                                 (7)
                                 
                                    
                                       
                                          
                                             dX
                                             1
                                          
                                          (
                                          t
                                          )
                                       
                                       dt
                                    
                                    =
                                    −
                                    
                                       a
                                       x
                                    
                                    
                                       X
                                       1
                                    
                                    (
                                    t
                                    )
                                    +
                                    
                                       K
                                       x
                                    
                                    
                                       a
                                       x
                                    
                                    
                                       U
                                       I
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                        

where the new states are the gut glucose absorption U
                           
                              G
                            in 
                              g
                              
                              
                                 min
                                 
                                    −
                                    1
                                 
                              
                           , its time derivative 
                              
                                 
                                    U
                                    ˙
                                 
                                 G
                              
                            in 
                              g
                              
                              
                                 min
                                 
                                    −
                                    2
                                 
                              
                           , and the intermediate insulin action X
                           1 in 
                              
                                 min
                                 
                                    −
                                    1
                                 
                              
                           . Additional model parameters are introduced: the meal sensitivity K
                           
                              g
                            in mg
                           
                           dl
                           −1
                           
                           g
                           −1, the inverse of the meal time constant a
                           
                              g
                            in 
                              
                                 min
                                 
                                    −
                                    1
                                 
                              
                           , the insulin sensitivity K
                           
                              x
                            in U
                           −1 (different from S
                           
                              I
                           ), and the inverse of the insulin absorption/action time constant a
                           
                              x
                            in 
                              
                                 min
                                 
                                    −
                                    1
                                 
                              
                           . The manipulated inputs are the subcutaneous insulin infusion, U
                           
                              I
                            in 
                              U
                              ·
                              
                                 min
                                 
                                    −
                                    1
                                 
                              
                            and the carbohydrate intake rate U
                           
                              CHO
                            in 
                              g
                              
                              
                                 min
                                 
                                    −
                                    1
                                 
                              
                           . This model is referred to as the Minimal model (MM) in what follows.

The fact that the insulin concentration – which is neither measured nor used – is not explicitly modeled improves the identifiability of this model compared to models using the original Bergman minimal model insulin action of Eq. (2).

However, the results presented by Prud’homme et al. show that, despite improved identifiability and the use of prior knowledge, the resulting predictions are still unsatisfactory and lead to sub-optimal insulin infusions. Another drawback of the MM lies in the behavior induced by the bilinear term of Eq. 3 (Eq. 1 for the BMM). As such, Eq. 1 predicts that, for any given value X of the insulin action X(t), the reduction of the blood glucose concentration is an increasing function of BG. In other words, according to the term −X(t)G(t), high BG values should always lead to a large effect of a given insulin action X(t) on BG concentration (and vice-versa). This is however not always true, since the opposite effect has been observed in practice [27]. Especially prolonged hyperglycemia blunts the effect of insulin.

A simple yet effective approach to circumvent the limitations of both the BMM and MM is to linearize the BG equation. As linearity is also advantageous for identification and control purposes [28], several linearized versions of the minimal model are available in the literature. Linearizing the MM will lead to the removal of the effect of glucose concentration on the insulin efficiency. As said before, although many models (like the MM) incorporate the bilinear term X(t)G(t), this removal can be physiologically justified since the increased effect of X on the variation of G at high BG concentrations cannot be observed in real patients [27]. It has been shown that the performances of both the minimal model and the LMM are comparable, though none fits all the available data [29]. Linearized minimal models were also used for predicting BG, with limited success [16]. The LMM presented here and used thereafter is a linear version of the MM that reads:


                           
                              
                                 (8)
                                 
                                    
                                       
                                          dG
                                          (
                                          t
                                          )
                                       
                                       dt
                                    
                                    =
                                    −
                                    X
                                    (
                                    t
                                    )
                                    −
                                    
                                       S
                                       G
                                    
                                    G
                                    (
                                    t
                                    )
                                    +
                                    
                                       U
                                       endo
                                    
                                    +
                                    
                                       U
                                       G
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                           
                              
                                 (9)
                                 
                                    
                                       
                                          
                                             dU
                                             G
                                          
                                          (
                                          t
                                          )
                                       
                                       dt
                                    
                                    =
                                    
                                       
                                          U
                                          ˙
                                       
                                       G
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                           
                              
                                 (10)
                                 
                                    
                                       
                                          d
                                          
                                             
                                                U
                                                ˙
                                             
                                             G
                                          
                                          (
                                          t
                                          )
                                       
                                       dt
                                    
                                    =
                                    −
                                    2
                                    
                                       a
                                       g
                                    
                                    
                                       
                                          U
                                          ˙
                                       
                                       G
                                    
                                    (
                                    t
                                    )
                                    −
                                    
                                       a
                                       g
                                       2
                                    
                                    
                                       U
                                       G
                                    
                                    (
                                    t
                                    )
                                    +
                                    
                                       K
                                       g
                                    
                                    
                                       a
                                       g
                                       2
                                    
                                    
                                       U
                                       CHO
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                           
                              
                                 (11)
                                 
                                    
                                       
                                          dX
                                          (
                                          t
                                          )
                                       
                                       dt
                                    
                                    =
                                    −
                                    
                                       a
                                       x
                                    
                                    X
                                    (
                                    t
                                    )
                                    +
                                    
                                       a
                                       x
                                    
                                    
                                       X
                                       1
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                           
                              
                                 (12)
                                 
                                    
                                       
                                          
                                             dX
                                             1
                                          
                                          (
                                          t
                                          )
                                       
                                       dt
                                    
                                    =
                                    −
                                    
                                       a
                                       x
                                    
                                    
                                       X
                                       1
                                    
                                    (
                                    t
                                    )
                                    +
                                    
                                       K
                                       x
                                    
                                    
                                       a
                                       x
                                    
                                    
                                       U
                                       I
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                        

with the insulin sensitivity K
                           
                              x
                            being now in mg
                           
                           dl
                           −1
                           ·
                           U
                           −1.

Despite the removal of the bilinear term, the LMM is still not very efficient in terms of steady-state predictions. In fact, if no insulin bolus is infused and no meal is ingested, steady-state BG concentration is obtained by setting all inputs and time derivatives to 0 in Eqs. (8)–(12) and reads:
                              
                                 (13)
                                 
                                    
                                       G
                                       ss
                                    
                                    =
                                    
                                       
                                          
                                             U
                                             endo
                                          
                                          −
                                          
                                             K
                                             x
                                          
                                          
                                             U
                                             
                                                I
                                                ,
                                                b
                                             
                                          
                                       
                                       
                                          
                                             S
                                             G
                                          
                                       
                                    
                                 
                              
                           where U
                           
                              I,b
                            is the corresponding basal insulin infusion. Typical values of G
                           
                              ss
                            are around 100 mg
                           
                           dl
                           −1, when adequate U
                           
                              I,b
                            are infused. However this is rarely the case as shown in Section 4.1.1.

As such, the steady-state BG concentration predicted by the LMM does not depend on a patient's initial BG. For example all the aforementioned models predict recovery even when a patient in hyperglycemic condition does not take counteractive actions. This is in contradiction with practical observations that showed that in such a case, the patient will typically remain in hyperglycemic condition. Also, the parameters U
                           
                              endo
                            and S
                           
                              G
                            directly influence the identification of insulin and meal parameters, which makes identification particularly prone to model mismatch – which is inevitable in such a high noise and perturbation-rich environment. Indeed, the couples of insulin and meal time constants and sensitivities, i.e. (a
                           
                              x
                           ,K
                           
                              x
                           ) and (a
                           
                              g
                           ,K
                           
                              g
                           ), respectively, are dependent. This latter issue is illustrated by Fig. 1
                           , where it is shown that the time constant 1/a
                           
                              x
                            influences the amplitude of an insulin injection-related drop in BG. To obtain meaningful model parameters the amplitude and the rate of the effect of meal and/or insulin on BG concentration have to be decoupled, which furthermore increases correlation with therapy parameters (cf. Sections 4.1.1 and 4.2.2). Therefore this influence should be eliminated, making a
                           
                              x
                            and a
                           
                              g
                            independent of the respective response amplitudes.

To improve the LMM, it is proposed to remove U
                           
                              endo
                            and S
                           
                              G
                           , leading to the following set of ODEs:


                           
                              
                                 (14)
                                 
                                    
                                       
                                          dG
                                          (
                                          t
                                          )
                                       
                                       dt
                                    
                                    =
                                    −
                                    X
                                    (
                                    t
                                    )
                                    +
                                    
                                       U
                                       G
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                           
                              
                                 (15)
                                 
                                    
                                       
                                          
                                             dU
                                             G
                                          
                                          (
                                          t
                                          )
                                       
                                       dt
                                    
                                    =
                                    
                                       
                                          U
                                          ˙
                                       
                                       G
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                           
                              
                                 (16)
                                 
                                    
                                       
                                          d
                                          
                                             
                                                U
                                                ˙
                                             
                                             G
                                          
                                          (
                                          t
                                          )
                                       
                                       dt
                                    
                                    =
                                    −
                                    2
                                    
                                       a
                                       g
                                    
                                    
                                       
                                          U
                                          ˙
                                       
                                       G
                                    
                                    (
                                    t
                                    )
                                    −
                                    
                                       a
                                       g
                                       2
                                    
                                    
                                       U
                                       G
                                    
                                    (
                                    t
                                    )
                                    +
                                    
                                       K
                                       g
                                    
                                    
                                       a
                                       g
                                       2
                                    
                                    
                                       U
                                       CHO
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                           
                              
                                 (17)
                                 
                                    
                                       
                                          dX
                                          (
                                          t
                                          )
                                       
                                       dt
                                    
                                    =
                                    −
                                    
                                       a
                                       x
                                    
                                    X
                                    (
                                    t
                                    )
                                    +
                                    
                                       a
                                       x
                                    
                                    
                                       X
                                       1
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                           
                              
                                 (18)
                                 
                                    
                                       
                                          
                                             dX
                                             1
                                          
                                          (
                                          t
                                          )
                                       
                                       dt
                                    
                                    =
                                    −
                                    
                                       a
                                       x
                                    
                                    
                                       X
                                       1
                                    
                                    (
                                    t
                                    )
                                    +
                                    
                                       K
                                       x
                                    
                                    
                                       a
                                       x
                                    
                                    
                                       U
                                       I
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                        

The removal of U
                           
                              endo
                            and S
                           
                              G
                            leads to the following changes in the properties of the resulting dynamical model properties:
                              
                                 •
                                 After an insulin bolus or a meal, BG drops or rises, respectively, as a second-order dynamical system.


                                    G
                                    
                                       ss
                                     only varies with K
                                    
                                       x
                                    , K
                                    
                                       g
                                    , and the initial BG concentration:
                                       
                                          (19)
                                          
                                             
                                                G
                                                ss
                                             
                                             =
                                             G
                                             (
                                             0
                                             )
                                             −
                                             
                                                K
                                                x
                                             
                                             
                                                U
                                                
                                                   I
                                                   ,
                                                   tot
                                                
                                             
                                             +
                                             
                                                K
                                                g
                                             
                                             
                                                U
                                                
                                                   CHO
                                                   ,
                                                   tot
                                                
                                             
                                          
                                       
                                    where G(0) is the initial BG, 
                                       
                                          U
                                          
                                             I
                                             ,
                                             tot
                                          
                                       
                                       =
                                       
                                          ∫
                                          0
                                          
                                             
                                                t
                                                f
                                             
                                          
                                       
                                       
                                          U
                                          I
                                       
                                       (
                                       t
                                       )
                                       dt
                                     is the total amount of infused insulin between the initial time and the final time t
                                    
                                       f
                                    , and 
                                       
                                          U
                                          
                                             CHO
                                             ,
                                             tot
                                          
                                       
                                       =
                                       
                                          ∫
                                          0
                                          
                                             
                                                t
                                                f
                                             
                                          
                                       
                                       
                                          U
                                          CHO
                                       
                                       (
                                       t
                                       )
                                       dt
                                     is the total amount of ingested CHO between the initial time and the final time t
                                    
                                       f
                                    .

As depicted in Fig. 2
                                    , the sensitivities are now decoupled from their respective time constants.

The number of parameters to identify has been reduced from 6 to 4.

By coincidence, Kirchsteiger et al. used the same model as the TPM to predict BG concentrations on real patient data [30]. However, neither a comparison to other models was performed, nor a link to therapy parameters was established.

Percival et al. developed a similar model with first-order dynamics and a pure time delay [31]. However, the corresponding simulated BG profiles are not smooth and the time delay is difficult to identify. Also, their correlation analysis showed that the identified parameters were not significantly correlated to therapy parameters.

In this subsection, the principles of the standard bolus and insulin pump therapy are described and it is shown how therapy parameters are related to the parameters of the TPM.

Patients with type 1 diabetes typically:
                              
                                 •
                                 Take a fingerstick BG measurement (G
                                    
                                       m
                                    ) before a meal, or whenever they suspect their BG to be high,

Compare G
                                    
                                       m
                                     to the target BG (G
                                    
                                       t
                                    ), and compute the difference: ΔG
                                    =
                                    G
                                    
                                       m
                                    
                                    −
                                    G
                                    
                                       t
                                    .

Compute the correction bolus as I
                                    
                                       corr
                                    
                                    =ΔG/CF, with CF being the correction factor in mg
                                    
                                    dl
                                    −1
                                    ·
                                    U
                                    −1. I
                                    
                                       corr
                                     may be negative if the patient plans to ingest a meal.

Compute the meal bolus as I
                                    
                                       meal
                                    
                                    =
                                    I2C
                                    ·
                                    CHO, with I2C being the insulin-to-carbohydrates ratio in U
                                    ·
                                    g
                                    −1, and CHO being the corresponding weight of carbohydrates in g.

Inject the bolus I
                                    =
                                    I
                                    
                                       corr
                                    
                                    +
                                    I
                                    
                                       meal
                                     using their insulin pump or pen.

Indeed, CF and I2C correspond to the therapy parameters and are set by a physician. CF quantifies the drop in BG resulting from a 1U insulin injection at steady-state, while I2C indicates how much insulin should be injected per gram of ingested carbohydrates. MS
                           =
                           I2C
                           ·
                           CF can thus be defined as the meal sensitivity, which indicates the increase in BG per gram of ingested carbohydrates.

From the viewpoint of systems theory, a way to interpret the standard therapy parameters MS and CF is by assimilating them to the parameters of a static model, identified by physicians, that maps the amount of insulin to the future steady-state BG.

With an insulin pump, insulin may be infused almost continuously. This basal rate is useful in that it counteracts circadian variations in insulin sensitivity, such as the dawn effect. It is generally tuned by a physician in such a way that, in the absence of disturbances (such as meals or physical activity), BG stays approximately at the target value throughout the day. Hereafter, we will always assume a properly set basal rate. In this case, basal insulin is not considered as an input, i.e. inputs correspond exclusively to insulin boluses.


                           
                              Proposition 2.1
                              
                                 The TPM parameter K
                                 
                                    x
                                  
                                 is equal to the therapy parameter CF.
                              


                           
                              Proof 2.2
                              If a 1U insulin bolus is infused at t
                                 =0, U
                                 
                                    I
                                 (s)=1 and, in the absence of previous insulin boluses and meals, CF, according to the definition given in Section 2.2, is given as:
                                    
                                       (20)
                                       
                                          CF
                                          =
                                          −
                                          (
                                          G
                                          (
                                          ∞
                                          )
                                          −
                                          G
                                          (
                                          0
                                          )
                                          )
                                       
                                    
                                 where G(∞) is the BG at steady-state and G(0) the initial BG.


                                 
                                    
                                       (21)
                                       
                                          G
                                          (
                                          s
                                          )
                                          =
                                          −
                                          
                                             
                                                
                                                   K
                                                   x
                                                
                                             
                                             
                                                s
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            
                                                               1
                                                               
                                                                  
                                                                     a
                                                                     x
                                                                  
                                                               
                                                            
                                                            s
                                                         
                                                      
                                                   
                                                   2
                                                
                                             
                                          
                                          
                                             U
                                             I
                                          
                                          (
                                          s
                                          )
                                          +
                                          
                                             1
                                             s
                                          
                                          G
                                          (
                                          0
                                          )
                                       
                                    
                                 Applying the final value theorem leads to:
                                    
                                       
                                          
                                             
                                                
                                                   G
                                                   (
                                                   ∞
                                                   )
                                                
                                                
                                                   =
                                                   
                                                      lim
                                                      
                                                         s
                                                         →
                                                         0
                                                      
                                                   
                                                   sG
                                                   (
                                                   s
                                                   )
                                                
                                             
                                             
                                                
                                                
                                                   =
                                                   −
                                                   
                                                      lim
                                                      
                                                         s
                                                         →
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            K
                                                            x
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     1
                                                                     +
                                                                     
                                                                        1
                                                                        
                                                                           
                                                                              a
                                                                              x
                                                                           
                                                                        
                                                                     
                                                                     s
                                                                  
                                                               
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                   −
                                                   G
                                                   (
                                                   0
                                                   )
                                                
                                             
                                             
                                                
                                                
                                                   =
                                                   −
                                                   
                                                      K
                                                      x
                                                   
                                                   −
                                                   G
                                                   (
                                                   0
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 Thus,
                                    
                                       (22)
                                       
                                          
                                             K
                                             x
                                          
                                          =
                                          −
                                          (
                                          G
                                          (
                                          ∞
                                          )
                                          −
                                          G
                                          (
                                          0
                                          )
                                          )
                                          =
                                          CF
                                       
                                    
                                 □


                           
                              Proposition 2.3
                              
                                 The TPM parameter K
                                 
                                    g
                                  
                                 is equal to the therapy parameter MS.
                              


                           
                              Proof 2.4
                              If 1g of CHO is ingested at t
                                 =0, and in the absence of previous insulin boluses and meals, MS, according to its definition (see Section 2.2), reads:
                                    
                                       (23)
                                       
                                          MS
                                          =
                                          G
                                          (
                                          ∞
                                          )
                                          −
                                          G
                                          (
                                          0
                                          )
                                       
                                    
                                 The rest of the proof is straightforward and is similar to that of Proposition 1. □

As shown, the therapy parameters CF and MS correspond by construction to the model parameters K
                           
                              x
                            and K
                           
                              g
                            of the TPM, respectively. Both indicate how much BG will drop or rise, respectively, in between consecutive steady states. In other words, the TPM may be considered as a dynamical extension of the standard, static, therapy model. This property is illustrated in Fig. 3
                           , while experimental verification of this link is presented in Section 4.2.2.

The main advantage of TPM compared to the standard therapy model lies in its ability to predict BG evolution over time. Thus, TPM may be used for predictions, control, and other applications requesting time-varying BG concentrations. The link between therapy and model parameters is very valuable, because TPM parameters have a physical meaning that is recognized by physicians and may therefore be accepted more easily. On the other hand, a priori knowledge of the physician-set therapy parameters can be used, if available, to improve the reliability of the TPM parameters.

On the other hand, no explicit link between therapy parameters and parameters of the LMM and the MM can be established, because these models have a stead-state behavior that is not compatible with the definition of CF and MS. In fact, with these models, if time goes to infinity, simulated BG concentration will tend to the value defined in Eq. (13), irrespective of the initial BG concentration. However, it does make sense to compare the values of K
                           
                              g
                            and K
                           
                              x
                            to MS and CF, respectively, because these parameters define the amplitude of the rise or drop in BG concentration. As will be seen in Section 4, these values are correlated. Hence, such a comparison will be performed in the next sections, but it has to be clear that this comparison is not performed to quantify the correlation between the parameters of the MM or of the LMM to the therapy parameters as such, but rather to highlight the intrinsic higher correlation degrees between the parameters of the TPM and the therapy parameters, which is one of the main added-values of the TPM.

This section describes the data used for the validation of the TPM as well as the practical methods and tools.

For model validation, a first step is to test the models on virtual patients. For this reason the UVa-Padova simulator, based on the model by Dalla Man et al. [7,32] and approved by the FDA to replace animal testing in the context of closed-loop control, has been used to generate data sets.

We evaluate the models on 4 days that have been chosen in the following way:
                           
                              •
                              The first three days are similar. An insulin bolus and a meal are taken simultaneously at 8 AM, but are varied from day to day to span the whole BG range. This way the nonlinearities of the UVa model are taken into account. The insulin bolus is chosen such that it decreases BG concentrations by 10, 70 and 120mg/dl, respectively. The exact amount is calculated using the CF that is given in the simulator. The meals are then given such that they counteract these boluses based on the I2C provided in the simulator. Meal durations where chosen to be 10, 20, and 10min, respectively.

The fourth day spans the whole palette of BG concentrations and incorporates different amounts of carbohydrate ingestion and insulin injections. Boli reducing BG by approximately 100, 5, 10, and 15mg/dl are given respectively at 10 AM, 2 PM, 3 PM and 4 PM. Meals, rising BG by approximately 80, 20, and 10mg/dl are taken respectively at 8 AM, 2 PM, and 6 PM. Meal durations are 10, 15, and 20min.

The noiseless measurements of the 10 adults are used and are sampled with a period of 15min. On days 1 to 3, data between 8 AM and 4 PM are considered. On day 4, data between 8 AM and 11 PM are used. All patients have their standard basal insulin administered during this time.

Data used for model validation are extracted from a mono-center and open-label study, designed to evaluate an investigational meal bolus advice method, similar to that of Prud’homme et al. [24]. 12 subjects with type 1 diabetes mellitus followed the same 10-day procedure:
                           
                              •
                              
                                 Clinical habituation phase: The objective of the 3 first days was to get the subjects used to the clinical environment and changes in their daily routine. Meanwhile, physicians adjusted the therapy parameters. On day 3, an additional basal rate test was performed to verify and adapt the basal rate.


                                 Sensitivity tests: On days 4 and 5, insulin sensitivity tests were performed, i.e. patients received an isolated insulin shot, followed by BG monitoring. The goal was to observe the effect of insulin without the influence of any meal perturbation, which is key for obtaining reliable insulin action parameters (Section 3.4). Whenever necessary, the basal rate was slightly reduced a few hours before the test, so that at 8:30 AM a corrective bolus could be infused. Until 11:30 AM, the sampling period for SMBG measurements was set equal to 15min.


                                 Standard therapy days: On days 6 and 7, standard therapy was applied (Section 2.2). At 9:00 AM, the subjects received the test meal and infused their standard insulin bolus. BG was measured every 30min until 4:00 PM.


                                 Optimized insulin infusion days: On days 8 to 10, optimized insulin patterns were infused under the same meal and BG measurements conditions than before. The therapy consisted of small insulin boluses, potentially administered every 30min until 2:00 PM.

Data collected after a hypoglycemic intervention.

Data collected after the intake of medication.

Data with very high variability and unexplained BG excursions.

Of note is that this corresponds to the exclusion of 2 subjects. Overall, the standard therapy I2C was often underestimated leading to high BG concentrations, most likely due to the slow nature of the selected meal. Therapy parameter values were updated on a day-to-day basis. For the validation of the TPM, we only consider one single therapy parameter value per patient.

The data from this study are very well suited to analyze parameter correlations and compare model predictions since:
                           
                              •
                              insulin sensitivity tests were performed (cf. Section 3.4).

the patients had the same meal several times on consecutive days, which prevents that parameters change significantly over the course of the study.

the basal rates and therapy parameters were very well adjusted by physicians.

two different insulin infusion strategies were used.

Model parameters identification is performed by minimizing the following weighted least squares objective function J:
                           
                              (24)
                              
                                 J
                                 (
                                 θ
                                 )
                                 =
                                 
                                    ∑
                                    
                                       d
                                       =
                                       1
                                    
                                    D
                                 
                                 
                                    α
                                    d
                                 
                                 
                                    J
                                    d
                                 
                                 (
                                 θ
                                 )
                              
                           
                        
                     

where θ is the vector of model parameters to estimate (θ
                        =[a
                        
                           x
                        
                        
                        a
                        
                           g
                        
                        
                        K
                        
                           x
                        
                        
                        K
                        
                           g
                        ]
                           T
                         for the TPM, e.g.), D is the number of days, α
                        
                           d
                         is the weight associated to day d, and J
                        
                           d
                         is defined for each day d:
                           
                              (25)
                              
                                 
                                    J
                                    d
                                 
                                 (
                                 θ
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          N
                                          d
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          G
                                          
                                             d
                                             ,
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             G
                                             ˆ
                                          
                                          
                                             d
                                             ,
                                             i
                                          
                                       
                                       (
                                       θ
                                       )
                                       )
                                    
                                    2
                                 
                              
                           
                        where N
                        
                           d
                         is the number of BG measurements for day d, G
                        
                           d,i
                         and 
                           
                              
                                 G
                                 ˆ
                              
                              
                                 d
                                 ,
                                 i
                              
                           
                         are the measured and simulated BG concentrations on day d, respectively.

The optimal values θ
                        * are such that they minimize the cumulated (and weighted) prediction error:


                        
                           
                              (26)
                              
                                 
                                    min
                                    θ
                                 
                                 J
                                 (
                                 θ
                                 )
                                 =
                                 
                                    ∑
                                    
                                       d
                                       =
                                       1
                                    
                                    D
                                 
                                 
                                    
                                       
                                          
                                             α
                                             d
                                          
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            N
                                                            d
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            G
                                                            
                                                               d
                                                               ,
                                                               i
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               G
                                                               ˆ
                                                            
                                                            
                                                               d
                                                               ,
                                                               i
                                                            
                                                         
                                                         (
                                                         θ
                                                         )
                                                         )
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    s
                                    .
                                    t
                                    .
                                 
                                 
                                    Model
                                    Equations
                                 
                              
                           
                        
                     

where the Model equations (Eqs. (14)–(18) for the TPM, e.g.) are integrated to compute the predicted values 
                           
                              
                                 G
                                 ˆ
                              
                              
                                 d
                                 ,
                                 i
                              
                           
                           (
                           θ
                           )
                         at the sampling instant i of day d under the same conditions than the corresponding measured values G
                        
                           d,i
                        , for any choice of θ.

Particular attention has to be paid to the estimation of insulin action, as, for instance, underestimating the insulin effect increases the risk of overdosing insulin. It is made more complicated when meals and insulin boluses are taken simultaneously, since the effects of carbohydrates and insulin cancel each other out, especially if they act at similar speeds. Note that this remark further justifies the choice of slow meals in the context of the clinical study associated with this paper, as the meals taken by the subjects were mostly slower than the insulin actions.

This difficulty to identify insulin parameters – worsened by the high noise level – is depicted in Fig. 4
                        . It shows that when the meal and the bolus are taken simultaneously, the simulated BG does not change significantly when K
                        
                           x
                         is doubled, while the right-hand side plot shows the large sensitivity of the simulated BG profile to a change in K
                        
                           x
                         when the meal and the bolus are taken separately. In other words, Fig. 4 illustrates how difficult it is to reliably identify K
                        
                           x
                         on the basis of BG measurements if the meal and the bolus are taken simultaneously. Indeed, in such a case, it is possible to estimate the ratio 
                           
                              
                                 
                                    K
                                    g
                                 
                              
                              
                                 
                                    K
                                    x
                                 
                              
                           
                         that corresponds to I2C, but not K
                        
                           x
                         (corresponding to CF).

To eliminate this problem, the only solution is to perform insulin sensitivity tests, where a bolus without a corresponding meal is infused.

A good overview of the different metrics used to compare different BG profiles is given by Del Favero et al. [33]. Additionally, the authors propose an extension of existing metrics to incorporate a glucose specific penalty.

In this paper, we propose to assess the quality of the LMM, the MM and the TPM by three different indicators, which are detailed below.

The MAD is used to compare data fits, as well as model predictions resulting from the different investigated models.
                              
                                 (28)
                                 
                                    MAD
                                    =
                                    
                                       1
                                       N
                                    
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       N
                                    
                                    |
                                    G
                                    (
                                    t
                                    )
                                    −
                                    
                                       G
                                       ˆ
                                    
                                    (
                                    t
                                    )
                                    |
                                 
                              
                           where N denotes the number of samples.

The coefficient of determination R
                           2 in % is defined as:
                              
                                 (29)
                                 
                                    
                                       R
                                       2
                                    
                                    
                                    =
                                    
                                    100
                                    
                                       
                                          
                                             1
                                             −
                                             
                                                
                                                   
                                                      1
                                                      N
                                                   
                                                   
                                                      ∑
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      N
                                                   
                                                   
                                                      
                                                         (
                                                         G
                                                         (
                                                         t
                                                         )
                                                         −
                                                         
                                                            G
                                                            ˆ
                                                         
                                                         (
                                                         t
                                                         )
                                                         )
                                                      
                                                      2
                                                   
                                                
                                                
                                                   
                                                      1
                                                      N
                                                   
                                                   
                                                      ∑
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      N
                                                   
                                                   
                                                      
                                                         (
                                                         G
                                                         (
                                                         t
                                                         )
                                                         −
                                                         
                                                            G
                                                            ¯
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 G
                                 ¯
                              
                            is the average BG: 
                              
                                 G
                                 ¯
                              
                              =
                              
                                 1
                                 N
                              
                              
                                 ∑
                                 
                                    t
                                    =
                                    1
                                 
                                 N
                              
                              G
                              (
                              t
                              )
                           . A value of 100% is equivalent to a perfect fit, while worse fits may have negative values. This method is more sensitive to outliers because of its quadratic term.

In this paper it is not necessary to use the glucose specific metrics since hypo- and hyperglycemia conditions rarely occurred during the clinical study.

As BG predictions are thought to be, in the ideal case, used in the same way as BG measurements, they should also be evaluated using the EGA [34], which is used to assess the performances of BG meters. BG measurements are compared to reference BG measurements and are classified via a grid that rates resulting treatment decisions.
                              
                                 •
                                 If the measurement is “clinically accurate”, i.e. if it deviates by no more than 20%, it is classified in zone A. If 95% of the measurements are in zone A, the BG meter is approximately achieving the standards of the ISO 15197 norm. However, as shown by Freckmann et al. [35], many current BG meters do not fulfill this norm.

If a measurement is “clinically appropriate”, i.e. if it would lead to benign or no treatment, it is classified in zone A and B.

All other zones are considered potentially dangerous and should therefore be avoided.

Clearly, it is highly desired to obtain as many predictions in zone A as possible, and to avoid zones other than A or B.

The validation of TPM is performed with the UVa simulator data of Section 3.1 and the clinical study data of Section 3.2 and follows 3 separate steps: (i) the data fits are analyzed, (ii) the correlation between therapy and model parameters is checked, and (iii), model predictions are evaluated.

The structure of the TPM mainly differs from that of the other models because of the absence of endogenous glucose production and glucose effectiveness at zero insulin, resulting in different behavior at steady-state. The UVa model, however, has similar steady-state behavior as the MM and LMM that the TPM is not able to reproduce. For this reason, no insulin sensitivity tests are done with the UVa simulator – the TPM does not have the dynamics to be able to fit such data. This situation is not optimal and may result in unreliable insulin action, as explained in Section 3.4, but the challenge is the same for each tested model.

For the identification of UVa simulator data, the weight between the different days is equal, i.e. α
                           
                              d
                           
                           =1 for all days d. All data are used for the evaluation of fitting performance (D
                           =4), leading to one parameter set for each patient. Initial BG is computed via linear interpolation between the values just before and right after the first measurement used for identification. The initialization of the other states is performed by propagating past model inputs. Examples of such simulations are given in Fig. 5
                           .


                           Table 1
                            shows that LMM and the MM have comparable fitting capabilities on UVa simulator data, while the TPM is slightly lower. This fact was expected as the number of model parameters of the TPM is lower. However, as it will be seen in Sections 4.1.2 and 4.1.3, this small decrease in the fitting capability is largely compensated by the improvement in parameter identifiability and prediction performance.

Indeed, good model fits do not necessarily imply good model predictions. With a high number of parameters, a model is typically able to generate many different BG profiles, leading to good data fits even though the dynamics of the model are not appropriate. However, in such a case, model predictions will not be good when the data set used for validation differs from that used for identification. Conversely, a model with less parameters may have inferior fitting capabilities but better predictions capabilities if its dynamics are more appropriate. This effect increases with the presence of measurement noise (which is high in our case), because having more parameters to identify increases the risk of fitting the noise. To summarize, a model with more appropriate dynamics, but less parameters will have potentially worse data fits, but better model predictions than a model with a high number of parameters, but less appropriate dynamics. The variability on parameter identifications is similar for all models as shown in Fig. 6
                            and shows few significant outliers.

In this subsection, we experimentally verify the relation between the therapy parameters provided in the UVa simulator and those identified using the models by analyzing their correlation. D
                           =4 and α
                           
                              d
                           
                           =1 for all d as in Section 4.1.1. It is not clear how the therapy parameters provided in the UVa simulator were determined, but simulations show that they are accurate.

To calculate the correlation factor, the correlation between the therapy parameter values provided in the UVa simulator and the identified parameter values are used. In other words, we are comparing MS to K
                           
                              g
                            and CF to K
                           
                              x
                           .

The results are summarized in Table 2
                            and illustrated in Fig. 7
                           . It can be observed that for the LMM and the MM, there is one outlier patient that corresponds to Adult 9 of the UVa standard database. This subject was previously identified as an abnormal subject [36]. The structure of these two models does not allow to identify this subject. In fact some bounds that are set on the parameters in the identification are attained and show that the computed parameter values are unrealistic. This outlier heavily influences the comparison of correlation factors given in Table 2. For this reason, the correlation analysis without Adult 9 is shown in Table 3
                           .

When not considering Adult 9, the identified parameters of all models (except K
                           
                              g
                            of the MM) are correlated (p
                           <0.05) to their respective values provided with the UVa simulator. However, the correlation factors of the TPM are much higher than those of the other two models, indicating that the TPM is capable of reliably identifying therapy parameters. These are excellent results for the TPM, considering that no specific insulin sensitivity tests could be included in the identification. It should be noted that TPM parameters for Adult 9 were correctly identified. The correlation factors for the LMM are higher than those of the MM, indicating that its structure is more appropriate. Also, the insulin-to-carbohydrates ratio is accurately identified by the LMM, which indicates that, as discussed in Section 3.4, the LMM is not capable to reliably identify K
                           
                              g
                            and K
                           
                              x
                            in the absence of insulin sensitivity tests.

Removing Adult 9 from the data fit analysis (Section (4.1.1) does not significantly change the results, since its data fits were a little below average for all models, but not outliers.

In this section, we compare prediction capabilities of the TPM to those of the MM and the LMM.

To obtain reliable results, the data used for identification (training data) should not be used for validation (validation data). In this study, we perform cross-validation: in the case of UVa simulator data, model parameters are identified on 3 data sets and validated on the 4th, for all possible permutations of the data sets. Thus, we obtain 4 parameters sets with the corresponding predictions for every subject, which total up to 40 different parameter sets.

Given a prediction horizon of h minutes, model predictions are done as follows:
                              
                                 •
                                 A validation data set with corresponding model parameters (identified on training data) for a given patient and day is chosen.

For every available BG measurement we start to simulate the model h minutes earlier. The initial BG values are set to the measured value preceding the h-minute simulation (this is different to the identification because future values are assumed unknown). All other states are initialized using simulations with model inputs dating back several hours before the beginning of the simulation.

The BG value after the h-minute simulation is the predicted BG and coincides with an experimental measurement point.

The evaluation metrics are evaluated on all prediction points.

Finally, the results are averaged over all parameters sets for comparison purposes.

For comparison, we also show the results of a Zero Order Hold (ZOH) model, which is often used as a reference. It consists in setting the predicted BG value to the initial BG value. In other words, we consider BG concentrations to stay constant over the prediction horizon.

We do predictions with horizons reaching from h
                           =15 minutes to h
                           =165min with 15min increments. The prediction results of all models are compared in Fig. 8
                           . We compare (i) the MAD, which measures the prediction fit quality, and (ii) the percentage of predictions in Clarke EGA zone A, which quantifies patient safety. In these graphs, for each prediction horizon, the averaged value over all possible combinations and all patients is given, as well as the corresponding standard deviation.

For small prediction horizons up to 60min, the TPM gives better MAD values than all other models. For longer prediction horizons, the MM is the most effective, followed by the LMM and the TPM.

The percentage in zone A of the Clarke EGA shows similar results. This is caused by the steady-state behavior of the MM that is closer to that of the UVa simulator model (which always converges to a value independently of the inputs) than the TPM. All model predictions, except for the ZOH, are within zones A and B of the EGA. Overall, the difference between the different models is small and not statistically significant.

If Adult 9 is disregarded, only small changes are observed in the results.

It can be concluded that for predicting BG on UVa simulator data, the TPM is an excellent choice because, despite having less parameters, worse data fits, and a model structure that is not fully compatible with the UVa simulator model, it is superior or comparable to the other models in terms of prediction performance, model identifiability and therapy parameter correlation.

On the clinical study data the data fits are computed in the same way as described in Section 4.1.1, with a few exceptions: (i) the model parameters are identified with D
                           =7 (i.e. the full data set is used). (ii) As discussed in Section 3.4, to be able to identify K
                           
                              x
                           , the sensitivity tests described in Section 3.2 were performed. However, 2 sensitivity test days out of 7 were insufficient. For this reason, the weight of the insulin sensitivity test days was increased by 5 – the value that showed the best results. Thus, the objective function defined in Eq. (26) used α
                           4
                           =
                           α
                           5
                           =5 and α
                           
                              d
                           
                           =1 otherwise. Ideally, more sensitivity tests should be performed, so that they outweigh the meal tests.

Examples of data fits are given in Fig. 9
                           , while Table 4
                            compares the performances of the TPM, the LMM, and the MM in terms of the MAD and R
                           2 indicators.

The LMM shows the best fitting capabilities. Hence, the structure of the LMM is more appropriate than the MM structure, as both have 6 parameters to identify. The performances of the TPM and the MM are comparable, with a slight advantage for the MM. Fig. 10
                            depicts the variability of data fits, that is the lowest for the LMM and increases for the MM and the TPM. A higher variability is due to a higher number of patients that were more difficult to fit. However, it will be seen in Sections 4.2.2 and 4.2.3 that this is not detrimental to neither parameter identification nor model prediction, the reason being that some patients have intrinsically higher variability in their BG concentrations. The lower variability for the LMM and MM can be attributed to model mismatch and noise fitting, rather than to model structures.

For 4 patients out of 10, the values of S
                           
                              G
                            and U
                           
                              endo
                            collapsed to 0, with the consequence that the LMM becomes identical to the TPM and that the corresponding model fits are very close.

The correlation analysis on clinical data is done in the same way as for UVa simulator data in Section 4.1.2, with the exception that physician-set therapy parameter values are used instead of those provided in the UVa simulator. Similarly to Section 4.2.1, the identification of the TPM parameters is performed with the full set of data, i.e. D
                           =7, and the same α.

The results are summarized in Table 5
                            and illustrated in Fig. 11
                           . The parameters of the MM are not correlated with the physician-set parameters and the correlation of the correction factor is very low, indicating a dangerously unreliable insulin action. Also, the identified values of K
                           
                              x
                            have some outliers with very high values (compared to the corresponding physician-set counterparts), which can be due to high values of U
                           
                              endo
                           . The meal sensitivity on the other hand has a higher correlation factor, although the results from Fig. 11 show that the K
                           
                              g
                            parameter has low sensitivity. High K
                           
                              g
                            values should lead to high K
                           
                              x
                            values (cf. Section 3.4), but this is not the case, probably due to high values of S
                           
                              G
                           . The overestimation of the meal effect is to be avoided as it could lead to the computation of potentially massive insulin doses.

Similar results were found for the identification of K
                           
                              g
                            with the LMM. Though the correlation of K
                           
                              x
                            and the correction factor are improved by the LMM structure, this improvement is not significant.

On the other hand, with the TPM, all model parameters are significantly correlated with the therapy parameters. In some cases however, the modeled insulin sensitivity seems to underestimate the value set by the physician. At this point it is hard to know whether the real value is overestimated by the physician (for safety purposes), or underestimated by the model, or both. The TPM also slightly overestimates the insulin-to-carbohydrates ratio set by the physician. If the TPM would have been used for control, this would have resulted in higher insulin injections. In the context of this study this would not have been detrimental as insulin boluses were generally too small during the standard therapy experiments.

We can conclude that with the TPM, parameters are more reliably and safely identified, compared to the LMM and MM. This is a clear hint that the TPM model structure is more appropriate for BG predictions. Conversely, this nice feature of the TPM model could make it a valuable tool for assisting physicians in determining the therapy parameters.

The BG prediction analysis follows the same principle as described in Section 4.1.3, but again with α as described in Section 4.2.1. Also this time the cross-validation leads to up to 7 parameter sets per patient and gives a total of 58 parameter sets.

Two examples of BG predictions with h
                           =90 are plotted in Fig. 12
                           , with on the left-hand side a relatively good prediction and on the right-hand side a less successful one.

Initial BG concentration is noisy because it depends on real measurements. This directly influences BG predictions and can lead in some cases to wrong predictions. This does not preclude the representativity of the comparison as the same initialization method is applied to every tested model. Of course, a more elaborate initial state estimation (e.g. using a Kalman filter) may lead to more accurate predictions, but is beyond the scope of this paper.

As can be seen in Fig. 13
                           , the mean MAD for the TPM and LMM are almost equal, the latter only having a slightly lower standard deviation. The MM is less effective, especially with small prediction horizons, where predictions are worse than with the ZOH. The mean percentage of predictions in EGA zone A leads to a similar conclusion – this time the TPM being marginally better and having smaller standard deviations than the LMM.

On average, 97% of predictions for TPM and LMM are in zones A and B for the EGA. This means that nearly no wrong treatment decisions would be taken, even for long prediction horizons. The MM goes down to 94%, whereas the ZOH goes to 88%.

Predictions do not significantly differ between the three models – a difference occurs mainly if, during identification, a model's global minimum does not coincide with the actual patient dynamics. This happens mostly with the MM, which is due to the less favorable model dynamics. These outliers change the average and are the main reason for the differences between the different models in Fig. 13.

Overall the TPM always shows superior or comparable prediction capabilities. This is particularly interesting considering that it only requires 4 parameters to identify and it compensates for its slightly inferior fitting capabilities.

As a concluding remark, it should be noted that the different days of the clinical study were very similar, which most likely makes predicting BG easier. With more varied scenarios, some of the tested models could prove inappropriate. It would therefore be interesting to test the model in a more diverse setting, similar to the previous analysis on UVa simulator data, however this is not possible with the currently available data.

Results found with the UVa simulator data and clinical data are consistent. The TPM is the best choice in both cases because of improved BG predictions and parameter correlation, while having less parameters. One main difference is the relative performance of the LMM and the MM: LMM is better on clinical data, while the MM is better on UVa simulator data. This is probably due to the fact that the MM dynamics are closer to the UVa simulator and its non-linearity, while the LMM dynamics are closer to real human glucose dynamics.

@&#CONCLUSION@&#

The TPM measures up to the expectations of being a reliable but simple prediction model identifiable on BG measurements only. Stripping the model to a bare minimum allows reliable parameter identification, even in the presence of the characteristic high noise levels in BG measurements. We linked the model parameters directly to physician-set therapy parameters and showed their strong correlation. This adds another safety layer to the resulting model identification and the model may easily be personalized. Additionally, the TPM may be used to support physicians in determining patients' therapy parameters.

As expected, model fits were slightly worse than with other models – a result of the lower number of identified parameters. However, model predictions were on par or slightly better than the alternatives, even though the improvement is not statistically significant. A higher number of parameters is therefore not necessary.

Predictions are used to calculate insulin doses and as such are critical for patient safety. If carefully identified, the TPM leads to reliable insulin sensitivity estimation, which is rarely the case with other models identified under the same conditions. As such, the TPM may be used to assist physicians in determining therapy parameters. Additionally, the TPM has the property of only predicting an increase of BG concentration in case of a meal. The possibility of predicting an erroneous increase in BG is thus eliminated and hypoglycemia might be avoided in certain cases, especially when used in closed-loop controllers. Insulin infusions based on the TPM are therefore safer than with conventional models.

The properties of the three prediction models are summarized and compared in Table 6
                     .

The TPM has been tailor-made for the use in state estimation, predictive control, and recommendation methods, e.g. Model Predictive Control (MPC), optimal control, or pump suspension algorithms. As such it can be used under different scenarios:
                        
                           •
                           For state estimation, i.e. for determining the BG concentrations in the present:
                                 
                                    -
                                    In the absence of CGM measurements, the TPM can be used to estimate a patient's current BG concentrations.

If CGM measurements are available, it can be used to filter the latter (using a Kalman filter, e.g.), to detect sensor errors, or to detect system disturbances such as unannounced meals.

Independently of CGM measurements, it can be used to recommend additional SMBG measurements.

For control and recommendation, i.e. for determining future BG concentrations (this cannot be done by a CGM device), the TPM can be used to:
                                 
                                    -
                                    Compute optimal insulin infusions for optimal control (open-loop control) or MPC (closed-loop control).

Improve controllers using a Smith predictor.

Automatically suspend or alter insulin pump infusions to prevent hypoglycemia.

Warn patients of impending hypo- or hyperglycemia and recommend counteractive measures.

Future work will address the following points:
                        
                           •
                           The evolution of BG is a process with many sources of uncertainty that are not modeled in the TPM (and neither in any other common models). It is therefore almost impossible to have an accurate prediction of BG, even with the best possible model and measurement devices. Future work will focus on estimating the probabilistic distribution of BG predictions, because, considering the encountered noise levels, significantly more accurate predictions or simpler models seem unlikely. This would associate a confidence interval to any prediction, which is of high value. These results could be applied in the context of robust control such as proposed by, e.g., Kovács et al., Chee et al., or Palumbo et al. [37–39].

The current TPM does not take physical activity into account. Adding two additional states and parameters, similarly to the insulin action sub-model, would probably lead to an acceptable and more detailed model. This will be checked on clinical data in future work.

The available clinical data used for validation was very similar from one day to the other. The TPM should be tested on more random test days to show its full potential.

The TPM parameters are correlated to physician-set therapy parameters. To improve identification results, especially for patients with few or noisy measurements, the physician set parameters may be used as prior knowledge. Many methods applying Bayesian principles are available among which population-based methods [13,24,40] that may perform well and that will be investigated in the near future.

The TPM should be tested on different meals and the meal sub-model should be adapted if necessary.

@&#ACKNOWLEDGEMENT@&#

The authors acknowledge the financial support from Roche Diagnostic Diabetes Care. We would also like to thank Dr. Abhishek Soni for helpful comments and suggestions.

@&#REFERENCES@&#

