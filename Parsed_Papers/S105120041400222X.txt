@&#MAIN-TITLE@&#On the performance of digital adaptive spur cancellation for multi-standard radio frequency transceivers

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We model a multi-spur pollution and take into account the impairments affecting the spurs (pulsation shift, phase noise).


                        
                        
                           
                           We derive all closed-form formulae (optimal step, Signal to Interference Ratio) of the LMS-based spurs cancellation scheme.


                        
                        
                           
                           We add an original adaptive step overlay to improve the transitional mode while keeping the same asymptotic performance.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Multi-standard transceiver

Radio frequency impairment

Spurs

Digital cancellation

Least-mean-square (LMS) algorithm

Adaptive-step-size algorithm

@&#ABSTRACT@&#


               
               
                  This study deals with the asymptotic performance of a multiple-spur cancellation scheme. Radio frequency transceivers are now multi-standard and specific impairment can occur. The clock harmonics, called spurs, can leak into the signal band of the reception stage, and thus degrade the performance. The performance of a fully digital approach is presented here. A one-spur cancellation scheme is first described, for which we exploit the a priori knowledge of the spur frequency to create a reference of the polluting tone with the same frequency. A least-mean-square (LMS) algorithm block that uses this reference to mitigate the polluter is designed. However, due to imperfections in the physical components, there is a shift between the a priori frequency and the actual frequency of the spur, and the spur is affected by Brownian phase noise. Under these circumstances, we study the asymptotic and transient performance of the algorithm. We next improve the transient performance by adding a previously proposed adaptive-step-size process. In a second part of this paper, we present a multiple-spur parallel approach that is based on the one-spur cancellation scheme, for which we provide a closed-form expression of the asymptotic signal-plus-noise interference ratio in the presence of frequency shifts and phase noise.
               
            

@&#INTRODUCTION@&#

The development of multiple standards for wireless communication, from Global System for Mobile (GSM) to Long-Term Evolution (LTE), has been motivated by the increasing demand for mobility and new telecommunication services (e.g., data, audio, video) [1]. The coexistence of different wireless systems has resulted in multi-standard solutions for the mobile architecture loading, for instance, GSM, 3G, LTE, and WiFi devices, each of which comes with their specific impairments [2–5].

Due to a multiplicity of the operating frequencies and the physical proximity between the components, harmonics from clocks, called spurs, can appear at detrimental frequencies. These spurs can have at least two harmful consequences. First, due to substrate coupling between components, they can leak into the phase-locked loop. If they fall near the transmission frequency, they can demodulate the received signal into the receiver path, which leads to degradation of the receiver signal-to-noise ratio (SNR) [6]. The second case is when spurs couple directly into the receiver path, which leads to a mixture of desired noisy signal and additive spurs (see Fig. 1
                     ).

Spurs can be mitigated using different passive and active techniques. From frequency planning [7] to clock spreading [8,9], all of these passive methods aim at mitigating the level of the spur, to reduce the polluting interference that is synthesized.

Nevertheless, the multiplicity of standards that are supported has lead to the constant growth of spur sources (which is related to the growing number of operating frequencies), and passive cancellation has become more difficult. At the same time, radio frequency (RF) transceivers contain more and more digital parts, and signal processing techniques are becoming an area of interest for problematic RF impairment [10–12,6]. Thus, active methods for spur cancellation that are based on notch filter techniques or signal processing algorithms have been developed over the last few years [13–17].

In this study, we focus on direct pollution from spurs. The observed noisy signal is polluted by a fixed number of spurs that need to be mitigated. The aim of this study is to propose a fully digital approach for spur attenuation and to derive its analytic performance. We first focus on a one-spur model, for easy comprehension, and then extend the problem and results to a multiple-spur compensation model.

Our method is based on (more or less accurate) knowledge of the spur frequency. The algorithms studied here are based on synthesized references of the spurs, which are tones with the same frequency. Due to imperfections in the physical components, the reference cannot be considered as a perfect replica of the polluting spur. We assume here that there is a shift between the a priori or expected frequency (assumed to be known or estimated) and the actual frequency of the spur. However, in real cases, the spur is not a pure tone, as it is modulated by phase noise (PN). This PN should follow a Brownian model, which is a classical model used in the literature for free-running oscillators [18–21].

For the one-spur model, we introduce a mono-spur cancellation block. For this real-case model, we derive closed-form formulae of the signal-plus-noise-to-interference ratio (SNIR) at the output of the algorithm. We also give an equivalent scheme, which is a notch filter, and propose a frequency interpretation of the system design. Then, we improve the transient response of the algorithm by adding a previously proposed adaptive-step-size process to the least-mean-square (LMS) algorithm, which leads to a more rapid solution that has the same asymptotic performance.

In the second part of this paper, we consider a problematic P-spur mixture, and propose a multiple-spur cancellation scheme based on a parallel structure that is composed of P mono-spur cancellation blocks. In this model, we still consider imperfections, e.g., PN and frequency shift (FS), for all of the spurs and references, and compute the theoretical values of the asymptotic SNIR in the most general case. Our main contributions, in addition to being a comprehensive study, can be summarized below:
                        
                           •
                           Proposition and analytical analysis of a LMS-based algorithm for multiple-spur pollution with specific impairments (frequency shift and phase noise), with a frequency interpretation of the compensation system (equivalence to a first-order infinite impulse response (IIR) notch filter).

Derivation of closed-form expressions usable to tune the step-size parameter of the LMS-based spur cancellation algorithms, as well as to predict the SIR performance with respect to the polluter properties (frequency shift values, phase noise variances, reference amplitudes). To the best of our knowledge, no such analytical results have been found to date.

Proposition of an adaptive step overlay to the LMS algorithm to improve the transient response while keeping the same asymptotic performance. The improved algorithm has almost the same convergence speed as the recursive least squares (RLS) algorithm, but can better cope with a sudden change in the configuration of the spurs (if the parameters of the reference remain unchanged).

This paper is organized as follows. We give the one-spur model in Section 2 and present the cancellation scheme in Section 3, for which we express asymptotic and transient studies. Then, we develop a multiple-spur cancellation scheme and provide closed-form formulae of the overall performance in Section 4. Section 5 validates our method and theoretical results through simulations.

In this section, we first consider the cancellation of a single spur. The discrete-time observation model (at sample time 
                        n
                        
                           
                              T
                           
                           
                              s
                           
                        
                     ) is
                        
                           (1)
                           
                              d
                              (
                              n
                              )
                              =
                              x
                              (
                              n
                              )
                              +
                              b
                              (
                              n
                              )
                              +
                              s
                              (
                              n
                              )
                              ,
                           
                        
                      where 
                        d
                        (
                        n
                        )
                      is the observed signal, 
                        x
                        (
                        n
                        )
                      is the zero-mean data signal of variance 
                        
                           
                              σ
                           
                           
                              x
                           
                           
                              2
                           
                        
                     , 
                        b
                        (
                        n
                        )
                      is circular complex additive white Gaussian noise with zero mean and variance 
                        
                           
                              σ
                           
                           
                              b
                           
                           
                              2
                           
                        
                     , and 
                        s
                        (
                        n
                        )
                      is the additive spur. The spur is expressed as
                        
                           (2)
                           
                              s
                              (
                              n
                              )
                              =
                              A
                              
                                 
                                    e
                                 
                                 
                                    j
                                    (
                                    ω
                                    −
                                    
                                       
                                          δ
                                       
                                       
                                          ω
                                       
                                    
                                    )
                                    n
                                    +
                                    j
                                    ϕ
                                    (
                                    n
                                    )
                                    +
                                    j
                                    
                                       
                                          ϕ
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              ,
                           
                        
                      where A is the unknown amplitude, 
                        
                           
                              ϕ
                           
                           
                              0
                           
                        
                      is the unknown phase, 
                        ϕ
                        (
                        n
                        )
                      is the PN that affects the spur, and ω is the a priori spur (natural) frequency, which is normalized by the sample time. Nevertheless, due to imperfections in the oscillators, the spur is affected by an unknown (natural) frequency shift (FS) 
                        
                           
                              δ
                           
                           
                              ω
                           
                        
                     , which corresponds to the difference between the normalized a priori frequency and the normalized effective frequency of the spur.

As mentioned in the introduction, we consider here that the PN is under a Brownian model [19–21]. The evolution of the phase is
                        
                           (3)
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    ϕ
                                 
                                 
                                    n
                                 
                              
                              +
                              ξ
                              (
                              n
                              )
                              ,
                           
                        
                      with 
                        ϕ
                        (
                        0
                        )
                        =
                        0
                      and 
                        ξ
                        (
                        n
                        )
                      is an additive white noise of variance 
                        
                           
                              σ
                           
                           
                              ξ
                           
                           
                              2
                           
                        
                     .

As the a priori frequency of the spur is known, a reference signal is synthesized as an image of the polluting spur. The evolution of this reference is written as
                        
                           (4)
                           
                              u
                              (
                              n
                              )
                              =
                              B
                              
                                 
                                    e
                                 
                                 
                                    j
                                    ω
                                    n
                                    +
                                    j
                                    
                                       
                                          ϕ
                                       
                                       
                                          R
                                       
                                    
                                 
                              
                              ,
                           
                        
                      where B is the amplitude of the reference and 
                        
                           
                              ϕ
                           
                           
                              R
                           
                        
                      is its phase. In a real case, the synthesized reference can also have a FS and PN. Nevertheless, as it is only the global FS (spur + reference) and the global PN that matter, we assume for simplicity that all of the imperfections are attributed to the spur. The aim of the cancellation is to use the synthesized reference 
                        u
                        (
                        n
                        )
                      to cancel the polluting spur and to evaluate the influence of the PN and FS on the performance. The influence of the polluting spur, in terms of the signal-plus-noise-to-interference-ratio (SNIR) expressed in dB, is
                        
                           (5)
                           
                              
                                 
                                    SNIR
                                 
                                 
                                    Mixture
                                 
                              
                              =
                              −
                              10
                              
                                 
                                    log
                                 
                                 
                                    10
                                 
                              
                              ⁡
                              
                                 (
                                 
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                      We denote 
                        e
                        (
                        n
                        )
                      as the compensated signal after application of the algorithm, and introduce the estimation error 
                        ϵ
                        (
                        n
                        )
                      as
                        
                           (6)
                           
                              ϵ
                              (
                              n
                              )
                              =
                              x
                              (
                              n
                              )
                              +
                              b
                              (
                              n
                              )
                              −
                              e
                              (
                              n
                              )
                              .
                           
                        
                      The asymptotic variance of the estimation error 
                        
                           
                              σ
                           
                           
                              ϵ
                           
                           
                              2
                           
                        
                      is expressed as
                        
                           (7)
                           
                              
                                 
                                    σ
                                 
                                 
                                    ϵ
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 lim
                                 
                                    n
                                    →
                                    ∞
                                 
                              
                              ⁡
                              E
                              
                                 [
                                 
                                    
                                       |
                                       ϵ
                                       (
                                       n
                                       )
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              .
                           
                        
                     
                  

The spur canceler is not intended to cancel the additive noise term. As we focus here on the performance of the spur canceler and not on the impact of the additive white noise, we consider for the performance measurement that the noise is part of the desired signal. In other words, regarding the spur cancellation algorithm, the desired signal is the observed signal without the spur. The performance of the algorithm will be described by the SNIR after compensation, defined by:
                        
                           (8)
                           
                              
                                 
                                    SNIR
                                 
                                 
                                    comp
                                 
                              
                              =
                              −
                              10
                              
                                 
                                    log
                                 
                                 
                                    10
                                 
                              
                              ⁡
                              
                                 (
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ϵ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

For the theoretical results, several hypotheses are made:
                        
                           •
                           The desired signal 
                                 x
                                 (
                                 n
                                 )
                               is a white complex zero-mean circular signal;

The normalized FS 
                                 
                                    
                                       δ
                                    
                                    
                                       ω
                                    
                                 
                                 ≪
                                 ω
                               (normalized frequency);

The PN variance 
                                 
                                    
                                       σ
                                    
                                    
                                       ξ
                                    
                                    
                                       2
                                    
                                 
                                 ≪
                                 1
                              .

We will see in Section 5.1 that the last two assumptions are completely satisfied in practical cases. The link between our model parameters (
                        
                           
                              δ
                           
                           
                              ω
                           
                        
                      and 
                        
                           
                              σ
                           
                           
                              ξ
                           
                           
                              2
                           
                        
                     ) and physical parameters of oscillator used in practice will also be explained later.

The compensated signal 
                           e
                           (
                           n
                           )
                         is obtained by subtracting the estimated spur value 
                           
                              
                                 s
                              
                              
                                 ˆ
                              
                           
                           (
                           n
                           )
                         from the input sample 
                           d
                           (
                           n
                           )
                        . This value is obtained by multiplying the reference signal 
                           u
                           (
                           n
                           )
                         by a complex adaptive coefficient 
                           w
                           (
                           n
                           )
                        , which is updated using the output of the algorithm 
                           e
                           (
                           n
                           )
                        , as shown in Fig. 2
                        .

From an analysis perspective, let us introduce the ideal coefficient for this cancellation scheme, which is defined by a complex coefficient 
                           
                              
                                 w
                              
                              
                                 opt
                              
                           
                           (
                           n
                           )
                         that provides an output 
                           
                              
                                 s
                              
                              
                                 ˆ
                              
                           
                           (
                           n
                           )
                         that is strictly equal to the polluting spur 
                           s
                           (
                           n
                           )
                         for all n. Thus, 
                           
                              
                                 w
                              
                              
                                 opt
                              
                           
                           (
                           n
                           )
                         verifies:
                           
                              (9)
                              
                                 
                                    
                                       w
                                    
                                    
                                       opt
                                    
                                 
                                 (
                                 n
                                 )
                                 u
                                 (
                                 n
                                 )
                                 =
                                 s
                                 (
                                 n
                                 )
                                 
                                 ∀
                                 n
                                 ∈
                                 N
                                 .
                              
                           
                         The iterative expression of the ideal coefficient using (2) and (4) is:
                           
                              (10)
                              
                                 
                                    
                                       w
                                    
                                    
                                       opt
                                    
                                 
                                 (
                                 n
                                 )
                                 =
                                 
                                    A
                                    B
                                 
                                 
                                    
                                       e
                                    
                                    
                                       j
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             ϕ
                                          
                                          
                                             R
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       j
                                       
                                          
                                             δ
                                          
                                          
                                             ω
                                          
                                       
                                       n
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       j
                                       ϕ
                                       (
                                       n
                                       )
                                    
                                 
                                 .
                              
                           
                         Due to the hypotheses made at the end of Section 2 (
                           
                              
                                 δ
                              
                              
                                 ω
                              
                           
                           ≪
                           ω
                           ,
                           
                              
                                 σ
                              
                              
                                 ξ
                              
                              
                                 2
                              
                           
                           ≪
                           1
                        ), the ideal coefficient can be expressed recursively as
                           
                              (11)
                              
                                 
                                    
                                       w
                                    
                                    
                                       opt
                                    
                                 
                                 (
                                 n
                                 +
                                 1
                                 )
                                 ≈
                                 
                                    
                                       w
                                    
                                    
                                       opt
                                    
                                 
                                 (
                                 n
                                 )
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       opt
                                    
                                 
                                 (
                                 n
                                 )
                                 
                                    [
                                    j
                                    ξ
                                    (
                                    n
                                    )
                                    −
                                    j
                                    
                                       
                                          δ
                                       
                                       
                                          ω
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                         Using 
                           w
                           (
                           n
                           )
                           =
                           
                              
                                 w
                              
                              
                                 opt
                              
                           
                           (
                           n
                           )
                         specified in (10) or (11) in Fig. 2 gives an ideally recovered signal, which means that in this case 
                           e
                           (
                           n
                           )
                           =
                           x
                           (
                           n
                           )
                           +
                           b
                           (
                           n
                           )
                           ,
                           ∀
                           n
                           ∈
                           N
                        . As most of the parameters (e.g., amplitudes, phases, FS, PN) are not known, the ideal coefficient cannot be used, and a recursive estimation of 
                           
                              
                                 w
                              
                              
                                 opt
                              
                           
                           (
                           n
                           )
                         has to be performed.

We propose to use the LMS algorithm [22,23], which is based on the error signal 
                           e
                           (
                           n
                           )
                           =
                           d
                           (
                           n
                           )
                           −
                           
                              
                                 s
                              
                              
                                 ˆ
                              
                           
                           (
                           n
                           )
                        , to perform the updating of the coefficient 
                           w
                           (
                           n
                           )
                        :
                           
                              (12)
                              
                                 
                                    
                                       s
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 n
                                 )
                                 =
                                 w
                                 (
                                 n
                                 )
                                 u
                                 (
                                 n
                                 )
                              
                           
                        
                        
                           
                              (13)
                              
                                 e
                                 (
                                 n
                                 )
                                 =
                                 d
                                 (
                                 n
                                 )
                                 −
                                 
                                    
                                       s
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 n
                                 )
                              
                           
                        
                        
                           
                              (14)
                              
                                 w
                                 (
                                 n
                                 +
                                 1
                                 )
                                 =
                                 w
                                 (
                                 n
                                 )
                                 +
                                 μ
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 n
                                 )
                                 e
                                 (
                                 n
                                 )
                              
                           
                         where μ is the constant step size of the algorithm and 
                           
                              
                                 (
                                 )
                              
                              
                                 ⁎
                              
                           
                         denotes complex conjugate. The LMS algorithm is a stochastic-gradient descent method that computes at each iteration n the gradient of the instantaneous square error as 
                           1
                           /
                           2
                           ∂
                           
                              
                                 |
                                 e
                                 (
                                 n
                                 )
                                 |
                              
                              
                                 2
                              
                           
                           /
                           ∂
                           w
                           =
                           −
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                           (
                           n
                           )
                           e
                           (
                           n
                           )
                        , in order to use the steepest descend to update the coefficient 
                           w
                           (
                           n
                           )
                         in (14). In Appendix A, we briefly review how the LMS algorithm approach can also be legitimized thanks to a weighted-least-squares error cost function to be minimized. In the case of a perfect situation (i.e., no PN and no FS), it can be shown that (10) is the solution of the Yule–Walker equation, to which the LMS algorithm converges [24].

We now introduce the difference between the ideal coefficient and the iterative coefficient 
                           w
                           (
                           n
                           )
                        , called the misalignment 
                           v
                           (
                           n
                           )
                        :
                           
                              (15)
                              
                                 v
                                 (
                                 n
                                 )
                                 =
                                 w
                                 (
                                 n
                                 )
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       opt
                                    
                                 
                                 (
                                 n
                                 )
                                 .
                              
                           
                         From (13), with the model defined in (1) and using the property of the ideal coefficient of (9), the output of the algorithm then becomes
                           
                              (16)
                              
                                 e
                                 (
                                 n
                                 )
                                 =
                                 x
                                 (
                                 n
                                 )
                                 +
                                 b
                                 (
                                 n
                                 )
                                 −
                                 v
                                 (
                                 n
                                 )
                                 u
                                 (
                                 n
                                 )
                                 .
                              
                           
                         We see from (16) and (6), that 
                           ϵ
                           (
                           n
                           )
                           =
                           v
                           (
                           n
                           )
                           u
                           (
                           n
                           )
                        , and with (8), we can link the SNIR after compensation to the variance of the misalignment as
                           
                              (17)
                              
                                 
                                    
                                       SNIR
                                    
                                    
                                       comp
                                    
                                 
                                 =
                                 −
                                 10
                                 
                                    
                                       log
                                    
                                    
                                       10
                                    
                                 
                                 ⁡
                                 
                                    (
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                v
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         The variance of the misalignment can be expressed recursively using (11), (14), (16), and (17) (see Appendix B). We use the same hypotheses as mentioned at the end of Section 2, and since the PN follows a Brownian model, only the scale of this model 
                           ϕ
                           (
                           n
                           +
                           1
                           )
                           −
                           ϕ
                           (
                           n
                           )
                         [which is the white noise 
                           ξ
                           (
                           n
                           )
                        ] has any influence. Therefore,
                           
                              (18)
                              
                                 E
                                 
                                    [
                                    
                                       
                                          |
                                          v
                                          (
                                          n
                                          +
                                          1
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    
                                       (
                                       1
                                       −
                                       μ
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 E
                                 
                                    [
                                    
                                       
                                          |
                                          v
                                          (
                                          n
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 +
                                 Q
                                 
                                    (
                                    
                                       
                                          δ
                                       
                                       
                                          ω
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          ξ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where
                           
                              (19)
                              
                                 Q
                                 
                                    (
                                    
                                       
                                          δ
                                       
                                       
                                          ω
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          ξ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          ξ
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          δ
                                       
                                       
                                          ω
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       2
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       1
                                       −
                                       μ
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       
                                          
                                             δ
                                          
                                          
                                             ω
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       μ
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             ω
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             δ
                                          
                                          
                                             ω
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       μ
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             ω
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       2
                                       μ
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             ω
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             4
                                          
                                       
                                       )
                                    
                                 
                                 .
                              
                           
                         Eq. (18) is composed of three terms: the first is the recursive term; the second is the contribution of the noisy signal; and the last term 
                           Q
                           (
                           
                              
                                 δ
                              
                              
                                 ω
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 ξ
                              
                              
                                 2
                              
                           
                           )
                         represents the impact of both the PN and FS on the overall performance.

Asymptotically, we assume that 
                           E
                           [
                           
                              
                                 |
                                 v
                                 (
                                 n
                                 +
                                 1
                                 )
                                 |
                              
                              
                                 2
                              
                           
                           ]
                           =
                           E
                           [
                           
                              
                                 |
                                 v
                                 (
                                 n
                                 )
                                 |
                              
                              
                                 2
                              
                           
                           ]
                        , and substituting (18) into (17) and using the definition of (19), we obtain the asymptotic SNIR after convergence as
                           
                              (20)
                              
                                 
                                    
                                       SNIR
                                    
                                    
                                       comp
                                    
                                 
                                 =
                                 −
                                 10
                                 
                                    
                                       log
                                    
                                    
                                       10
                                    
                                 
                                 ⁡
                                 
                                    [
                                    
                                       
                                          μ
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                          −
                                          μ
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          Q
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                ξ
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                δ
                                             
                                             
                                                ω
                                             
                                          
                                          )
                                       
                                       
                                          μ
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          (
                                          2
                                          −
                                          μ
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     

A maximal value of the step size μ, to ensure the convergence of the algorithm (see [24, Section 9-4]), is given by
                           
                              (21)
                              
                                 μ
                                 <
                                 
                                    
                                       μ
                                    
                                    
                                       max
                                    
                                 
                                 =
                                 
                                    2
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The asymptotic SNIR is composed of a static term (misalignment due to the presence of the input noise) and the pollution term (due to the PN and FS). It appears that the step size μ defined in (14) leads to a trade-off between the accuracy of the estimate and resistance against the contribution of the polluter.

We consider here that 
                           μ
                           ≪
                           1
                        . The optimal step size 
                           
                              
                                 μ
                              
                              
                                 opt
                              
                           
                         is then obtained by the maximization of (20) (see Appendix C), and is described on
                           
                              (22)
                              
                                 
                                    
                                       μ
                                    
                                    
                                       opt
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      108
                                                      (
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            b
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            
                                                               
                                                                  δ
                                                               
                                                               
                                                                  ω
                                                               
                                                            
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               
                                                                  σ
                                                               
                                                               
                                                                  ξ
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            b
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   3
                                                
                                                
                                                   
                                                      3
                                                      2
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   σ
                                                
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   σ
                                                
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             
                                                
                                                   B
                                                
                                                
                                                   6
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             2
                                             
                                                
                                                   A
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         ω
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   σ
                                                
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   σ
                                                
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             
                                                
                                                   B
                                                
                                                
                                                   6
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          1
                                          3
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ξ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       3
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            108
                                                            (
                                                            
                                                               
                                                                  σ
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  σ
                                                               
                                                               
                                                                  b
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  
                                                                     
                                                                        δ
                                                                     
                                                                     
                                                                        ω
                                                                     
                                                                  
                                                               
                                                               
                                                                  4
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        ξ
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  σ
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  σ
                                                               
                                                               
                                                                  b
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         3
                                                      
                                                      
                                                         
                                                            3
                                                            2
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   2
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               ω
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             
                                                1
                                                3
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

From (12), (13), (14), the update of the filter coefficient can be expressed as
                           
                              (23)
                              
                                 w
                                 (
                                 n
                                 +
                                 1
                                 )
                                 =
                                 
                                    (
                                    1
                                    −
                                    μ
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 w
                                 (
                                 n
                                 )
                                 +
                                 μ
                                 d
                                 (
                                 n
                                 )
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 n
                                 )
                                 .
                              
                           
                         This means that the algorithm can be considered as a low-pass filter (LPF) noise canceler, based on the filtering of 
                           d
                           (
                           n
                           )
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                           (
                           n
                           )
                        . The equivalent scheme is presented in Fig. 3
                        .

The observation 
                           d
                           (
                           n
                           )
                         is first frequency shifted downward (by −ω) and then filtered using a LPF. As a consequence, the translated observation 
                           d
                           (
                           n
                           )
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                           (
                           n
                           )
                         has its spur at the frequency 
                           −
                           
                              
                                 δ
                              
                              
                                 ω
                              
                           
                         and is selected by the LPF. The result is then frequency shifted back upward by the reference frequency ω and then subtracted from the observed data.

From (23), the transfer function of the LPF in the z domain is
                           
                              (24)
                              
                                 L
                                 (
                                 z
                                 )
                                 =
                                 
                                    
                                       W
                                       (
                                       z
                                       )
                                    
                                    
                                       
                                          
                                             U
                                          
                                          
                                             ⁎
                                          
                                       
                                       (
                                       z
                                       )
                                       ⁎
                                       D
                                       (
                                       z
                                       )
                                    
                                 
                                 =
                                 
                                    μ
                                    
                                       z
                                       −
                                       (
                                       1
                                       −
                                       μ
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                           
                         where ⁎ denotes convolution in the z domain. This filter has a cut-off frequency of 
                           μ
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                        . As a consequence, there is a direct link between the value of the LMS step size and the bandwidth of the LPF.

From this filter scheme, a global notch structure can be obtained as the result of the direct filtering of the observation 
                           d
                           (
                           n
                           )
                         by a filter 
                           H
                           (
                           z
                           )
                         (cf. Fig. 3). In the z domain, as 
                           L
                           (
                           z
                           )
                           ⁎
                           U
                           (
                           z
                           )
                           =
                           B
                           L
                           (
                           z
                           
                              
                                 e
                              
                              
                                 −
                                 j
                                 ω
                              
                           
                           )
                        , the output of the global filter H is [24]
                        
                           
                              
                                 E
                                 (
                                 z
                                 )
                                 =
                                 D
                                 (
                                 z
                                 )
                                 −
                                 W
                                 (
                                 z
                                 )
                                 ⁎
                                 U
                                 (
                                 z
                                 )
                                 =
                                 D
                                 (
                                 z
                                 )
                                 −
                                 
                                    {
                                    L
                                    (
                                    z
                                    )
                                    
                                       [
                                       D
                                       (
                                       z
                                       )
                                       ⁎
                                       
                                          
                                             U
                                          
                                          
                                             ⁎
                                          
                                       
                                       (
                                       z
                                       )
                                       ]
                                    
                                    }
                                 
                                 ⁎
                                 U
                                 (
                                 z
                                 )
                                 =
                                 D
                                 (
                                 z
                                 )
                                 −
                                 
                                    [
                                    B
                                    L
                                    (
                                    z
                                    )
                                    D
                                    
                                       (
                                       z
                                       
                                          
                                             e
                                          
                                          
                                             j
                                             ω
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 ⁎
                                 U
                                 (
                                 z
                                 )
                                 .
                              
                           
                         We denote
                           
                              
                                 G
                                 (
                                 z
                                 )
                                 =
                                 B
                                 L
                                 (
                                 z
                                 )
                                 D
                                 
                                    (
                                    z
                                    
                                       
                                          e
                                       
                                       
                                          j
                                          ω
                                       
                                    
                                    )
                                 
                              
                           
                         so that
                           
                              
                                 E
                                 (
                                 z
                                 )
                                 =
                                 D
                                 (
                                 z
                                 )
                                 −
                                 B
                                 G
                                 
                                    (
                                    z
                                    
                                       
                                          e
                                       
                                       
                                          −
                                          j
                                          ω
                                       
                                    
                                    )
                                 
                                 =
                                 D
                                 (
                                 z
                                 )
                                 −
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 L
                                 
                                    (
                                    z
                                    
                                       
                                          e
                                       
                                       
                                          −
                                          j
                                          ω
                                       
                                    
                                    )
                                 
                                 D
                                 (
                                 z
                                 )
                                 =
                                 D
                                 (
                                 z
                                 )
                                 −
                                 
                                    [
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                    L
                                    (
                                    z
                                    )
                                    ⁎
                                    U
                                    (
                                    z
                                    )
                                    ]
                                 
                                 D
                                 (
                                 z
                                 )
                                 .
                              
                           
                         We can define 
                           H
                           (
                           z
                           )
                         as the global notch filter response of the overall structure in the z domain, expressed as
                           
                              (25)
                              
                                 H
                                 (
                                 z
                                 )
                                 =
                                 
                                    
                                       E
                                       (
                                       z
                                       )
                                    
                                    
                                       D
                                       (
                                       z
                                       )
                                    
                                 
                                 =
                                 1
                                 −
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 L
                                 (
                                 z
                                 )
                                 ⁎
                                 U
                                 (
                                 z
                                 )
                                 .
                              
                           
                         The filter thus obtained is a band stop filter, as 
                           L
                           (
                           z
                           )
                           ⁎
                           U
                           (
                           z
                           )
                         is a LPF that is up-shifted in frequency by ω. Furthermore, from (25), the z transform of the filter becomes
                           
                              (26)
                              
                                 H
                                 (
                                 z
                                 )
                                 =
                                 1
                                 −
                                 
                                    
                                       μ
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       z
                                       
                                          
                                             e
                                          
                                          
                                             j
                                             ω
                                          
                                       
                                       −
                                       (
                                       1
                                       −
                                       μ
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       1
                                       −
                                       
                                          
                                             z
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             e
                                          
                                          
                                             j
                                             ω
                                          
                                       
                                    
                                    
                                       1
                                       −
                                       (
                                       1
                                       −
                                       μ
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       
                                          
                                             e
                                          
                                          
                                             j
                                             ω
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         It is of note that the equivalent notch filter 
                           H
                           (
                           z
                           )
                         coincides with the first-order IIR notch filter implemented in [14].

In this subsection, we consider two special cases (frequency shift only and phase noise only) to obtain simplified and more interpretable asymptotic performance formulae.

We consider here that there is no PN, i.e., 
                              
                                 
                                    σ
                                 
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                              
                              =
                              0
                           . The pollution term from (19) thus becomes
                              
                                 (27)
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          FS
                                       
                                    
                                    (
                                    
                                       
                                          δ
                                       
                                       
                                          ω
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          2
                                          
                                             
                                                A
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          1
                                          −
                                          μ
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          
                                             
                                                δ
                                             
                                             
                                                ω
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          μ
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                ω
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                δ
                                             
                                             
                                                ω
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          μ
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                μ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                4
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                ω
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          2
                                          μ
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                ω
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                μ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                4
                                             
                                          
                                          )
                                       
                                    
                                    .
                                 
                              
                           
                        

We assume that the FS 
                              
                                 
                                    δ
                                 
                                 
                                    ω
                                 
                              
                            is smaller than the step μ. The asymptotic SNIR with only FS can therefore be approximated as:
                              
                                 (28)
                                 
                                    
                                       
                                          SNIR
                                       
                                       
                                          FS
                                       
                                    
                                    ≃
                                    −
                                    10
                                    
                                       
                                          log
                                       
                                       
                                          10
                                       
                                    
                                    ⁡
                                    
                                       [
                                       
                                          
                                             μ
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          2
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   δ
                                                
                                                
                                                   ω
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   σ
                                                
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   σ
                                                
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             
                                                
                                                   μ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                            It should be noted that due to the simplifications of (19) and (20), (28) can be obtained equivalently with a frequency-domain representation based on the LPF 
                              L
                              (
                              z
                              )
                            and a power spectral density computation (see Appendix D). The hypothesis 
                              
                                 
                                    δ
                                 
                                 
                                    ω
                                 
                              
                              <
                              μ
                            consists of having a LPF cut-off frequency that is greater than the FS. Indeed, the input of the LPF 
                              d
                              (
                              n
                              )
                              
                                 
                                    u
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              n
                              )
                            has a spur at frequency 
                              −
                              
                                 
                                    δ
                                 
                                 
                                    ω
                                 
                              
                           , which can only be mitigated if the LPF has a cut-off frequency that is greater than the FS.

From the maximization of (28), a simplified expression of the optimal step size in this case can be obtained as
                              
                                 (29)
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          opt
                                       
                                       
                                          FS
                                       
                                    
                                    =
                                    
                                       
                                          
                                             4
                                             
                                                
                                                   A
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   δ
                                                
                                                
                                                   ω
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   6
                                                
                                             
                                             (
                                             
                                                
                                                   σ
                                                
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   σ
                                                
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       3
                                    
                                    .
                                 
                              
                            From (28) and (29), the maximal value of the SNIR can be analytically expressed as
                              
                                 (30)
                                 
                                    
                                       
                                          SNIR
                                       
                                       
                                          Max
                                       
                                       
                                          FS
                                       
                                    
                                    =
                                    −
                                    
                                       1
                                       3
                                    
                                    10
                                    
                                       
                                          log
                                       
                                       
                                          10
                                       
                                    
                                    ⁡
                                    
                                       [
                                       
                                          
                                             27
                                             
                                                
                                                   A
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   δ
                                                
                                                
                                                   ω
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             16
                                             (
                                             
                                                
                                                   σ
                                                
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   σ
                                                
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                            Eq. (30) means that the SNIR performance will decrease by 6.66 dB per decade of the increase in the FS. This gives a direct link between the expected performance and the acceptable FS.

We now consider that the reference frequency perfectly matches the spur frequency, i.e., 
                              
                                 
                                    δ
                                 
                                 
                                    ω
                                 
                              
                              =
                              0
                           . With only PN, the pollution term from (19) is
                              
                                 (31)
                                 
                                    Q
                                    
                                       (
                                       
                                          
                                             δ
                                          
                                          
                                             ω
                                          
                                       
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             ξ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          ξ
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                            The associated SNIR is
                              
                                 (32)
                                 
                                    
                                       
                                          SNIR
                                       
                                       
                                          PN
                                       
                                    
                                    =
                                    −
                                    10
                                    
                                       
                                          log
                                       
                                       
                                          10
                                       
                                    
                                    ⁡
                                    
                                       [
                                       
                                          
                                             μ
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             2
                                             −
                                             μ
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   ξ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   σ
                                                
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   σ
                                                
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             μ
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             2
                                             −
                                             μ
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                           
                        

In the frequency domain, the PN will widen the spur spectrum, so if the cut-off frequency of the LPF 
                              L
                              (
                              z
                              )
                            is too small, the LPF will not mitigate all of the spur band, which introduces performance loss.

As in the case of FS only, a simplified optimal step size can be obtained from (32) in the case of PN only:
                              
                                 (33)
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          opt
                                       
                                       
                                          PN
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                ξ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            and from (33), the maximal SNIR for a given PN can be analytically expressed as
                              
                                 (34)
                                 
                                    
                                       
                                          SNIR
                                       
                                       
                                          max
                                       
                                       
                                          PN
                                       
                                    
                                    =
                                    10
                                    
                                       
                                          log
                                       
                                       
                                          10
                                       
                                    
                                    ⁡
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      b
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      ξ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       −
                                       
                                          1
                                          2
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        

Eqs. (19)–(28) describe the performance in the asymptotic mode, after convergence of the system. In the transient mode, where the filter 
                           w
                           (
                           n
                           )
                         converges to the ideal coefficient, the average SNIR is a function of the sample index n, and is denoted as
                           
                              (35)
                              
                                 
                                    SNIR
                                 
                                 (
                                 n
                                 )
                                 =
                                 −
                                 10
                                 
                                    
                                       log
                                    
                                    
                                       10
                                    
                                 
                                 ⁡
                                 
                                    [
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                          E
                                          [
                                          
                                             
                                                |
                                                v
                                                (
                                                n
                                                )
                                                |
                                             
                                             
                                                2
                                             
                                          
                                          ]
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                         In the asymptotic mode, where 
                           n
                           →
                           ∞
                        , the transient SNIR defined in (35) converges to the asymptotic SNIR defined in (17). From (18), and assuming 
                           w
                           (
                           1
                           )
                           =
                           0
                        , the average SNIR can be obtained recursively, which leads to the closed-form formula
                           
                              (36)
                              
                                 SNIR
                                 (
                                 n
                                 )
                                 =
                                 −
                                 10
                                 
                                    
                                       log
                                    
                                    
                                       10
                                    
                                 
                                 ⁡
                                 
                                    {
                                    
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       [
                                       
                                          
                                             (
                                             1
                                             −
                                             μ
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             2
                                             n
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                       
                                       +
                                       
                                          [
                                          
                                             
                                                μ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   σ
                                                
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   σ
                                                
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          +
                                          Q
                                          
                                             (
                                             
                                                
                                                   δ
                                                
                                                
                                                   ω
                                                
                                             
                                             ,
                                             
                                                
                                                   σ
                                                
                                                
                                                   ξ
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          ]
                                       
                                       
                                          
                                             1
                                             −
                                             
                                                
                                                   (
                                                   1
                                                   −
                                                   μ
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                   n
                                                
                                             
                                          
                                          
                                             μ
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             2
                                             −
                                             μ
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       ]
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

First, it is important to note that 
                           
                              
                                 lim
                              
                              
                                 n
                                 →
                                 ∞
                              
                           
                           ⁡
                           SNIR
                           (
                           n
                           )
                           =
                           
                              
                                 SNIR
                              
                              
                                 comp
                              
                           
                        , as defined in (20). At the same time, (36) demonstrates that the asymptotic convergence speed is inversely proportional to the step size μ. To have a faster algorithm in the transient mode, we propose to add an adaptive-step-size process to the LMS algorithm. Thus, the step size will have a large value if the convergence is not settled, and will have to converge to a deterministic value. The purpose is to have the same asymptotic performance as theoretically expressed in (20), but also to limit the transient mode of the algorithm.

The step-size update is based on the instantaneous square error 
                           
                              
                                 |
                                 e
                                 (
                                 n
                                 )
                                 |
                              
                              
                                 2
                              
                           
                        , to which a gradient descent is applied. We use the step-size update proposed in [25], which is based on a geometric update [26] with a forgetting factor 
                           γ
                           <
                           1
                         
                        [27]:
                           
                              (37)
                              
                                 
                                    
                                       μ
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       {
                                       
                                          
                                             μ
                                          
                                          
                                             n
                                          
                                       
                                       
                                          [
                                          γ
                                          +
                                          η
                                          
                                             |
                                             
                                                
                                                   u
                                                
                                                
                                                   ⁎
                                                
                                             
                                             (
                                             n
                                             )
                                             e
                                             (
                                             n
                                             )
                                             G
                                             (
                                             n
                                             )
                                             |
                                          
                                          ]
                                       
                                       }
                                    
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             min
                                          
                                       
                                    
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             max
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           G
                           (
                           n
                           )
                           =
                           ∂
                           w
                           (
                           n
                           )
                           /
                           ∂
                           μ
                         can be expressed recursively as
                           
                              (38)
                              
                                 G
                                 (
                                 n
                                 )
                                 =
                                 
                                    (
                                    1
                                    −
                                    
                                       
                                          μ
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 G
                                 (
                                 n
                                 )
                                 +
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 n
                                 )
                                 e
                                 (
                                 n
                                 )
                              
                           
                         
                        η is a constant factor, and 
                           
                              
                                 {
                                 }
                              
                              
                                 
                                    
                                       μ
                                    
                                    
                                       min
                                    
                                 
                              
                              
                                 
                                    
                                       μ
                                    
                                    
                                       max
                                    
                                 
                              
                           
                         means that the step size is bounded between a maximal and a minimal value. The maximal value is set for convergence reasons from (21), and the minimal value is set to have the desired asymptotic performance [for instance, by setting the value of 
                           
                              
                                 μ
                              
                              
                                 min
                              
                           
                         to the optimal value (22) in a given scenario, typically, the worst case, where 
                           Q
                           (
                           
                              
                                 δ
                              
                              
                                 ω
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 ξ
                              
                              
                                 2
                              
                           
                           )
                         is maximum].

The term 
                           |
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                           (
                           n
                           )
                           e
                           (
                           n
                           )
                           G
                           (
                           n
                           )
                           |
                         represents the recursive expression of the cost function derivative 
                           ∂
                           
                              
                                 |
                                 e
                                 (
                                 n
                                 )
                                 |
                              
                              
                                 2
                              
                           
                           /
                           
                              
                                 ∂
                              
                              
                                 μ
                              
                           
                           
                              
                                 |
                              
                              
                                 n
                              
                           
                        . By construction, this has an important value if the convergence is not settled, and in the asymptotic mode, it converges to 0.

With a geometric update combined with a forgetting factor, the step size will necessarily increase during transient mode, where 
                           γ
                           +
                           η
                           |
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                           (
                           n
                           )
                           e
                           (
                           n
                           )
                           G
                           (
                           n
                           )
                           |
                           >
                           1
                        , and then decrease to finally converge to 
                           
                              
                                 μ
                              
                              
                                 min
                              
                           
                         in the asymptotic mode (where 
                           γ
                           +
                           η
                           |
                           
                              
                                 u
                              
                              
                                 ⁎
                              
                           
                           (
                           n
                           )
                           e
                           (
                           n
                           )
                           G
                           (
                           n
                           )
                           |
                           <
                           1
                        ).

The LMS algorithm combined with the adaptive-step-size process designed is summarized as
                           
                              (39)
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    n
                                    )
                                    =
                                    w
                                    (
                                    n
                                    )
                                    u
                                    (
                                    n
                                    )
                                 
                              
                              
                                 
                                    e
                                    (
                                    n
                                    )
                                    =
                                    d
                                    (
                                    n
                                    )
                                    −
                                    
                                       
                                          s
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    n
                                    )
                                 
                              
                              
                                 
                                    w
                                    (
                                    n
                                    +
                                    1
                                    )
                                    =
                                    w
                                    (
                                    n
                                    )
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          ⁎
                                       
                                    
                                    (
                                    n
                                    )
                                    e
                                    (
                                    n
                                    )
                                 
                              
                              
                                 
                                    G
                                    (
                                    n
                                    +
                                    1
                                    )
                                    =
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             μ
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    G
                                    (
                                    n
                                    )
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          ⁎
                                       
                                    
                                    (
                                    n
                                    )
                                    e
                                    (
                                    n
                                    )
                                 
                              
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          {
                                          
                                             
                                                μ
                                             
                                             
                                                n
                                             
                                          
                                          
                                             [
                                             γ
                                             +
                                             η
                                             
                                                |
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ⁎
                                                   
                                                
                                                (
                                                n
                                                )
                                                e
                                                (
                                                n
                                                )
                                                G
                                                (
                                                n
                                                )
                                                |
                                             
                                             ]
                                          
                                          }
                                       
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                min
                                             
                                          
                                       
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                max
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                         Here, the first three equations correspond to the LMS algorithm, and the last two correspond to the adaptive-step-size process overlay. In the asymptotic mode, (39) is equivalent to (12), (13), and (14) with 
                           
                              
                                 μ
                              
                              
                                 n
                              
                           
                           =
                           
                              
                                 μ
                              
                              
                                 min
                              
                           
                        .

Several spurs can be present in the baseband signal at different frequencies. We consider here the case where P spurs pollute the noisy signal. We assume that all of the spur frequencies are different from each other. The mixture is given by
                        
                           (40)
                           
                              d
                              (
                              n
                              )
                              =
                              x
                              (
                              n
                              )
                              +
                              b
                              (
                              n
                              )
                              +
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 P
                              
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              )
                           
                        
                      with
                        
                           (41)
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              )
                              =
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    e
                                 
                                 
                                    j
                                    (
                                    
                                       
                                          ω
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    )
                                    n
                                    +
                                    j
                                    
                                       
                                          ϕ
                                       
                                       
                                          0
                                          i
                                       
                                    
                                    +
                                    j
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    n
                                    )
                                 
                              
                           
                        
                      where 
                        
                           
                              A
                           
                           
                              i
                           
                        
                      is the unknown amplitude, 
                        
                           
                              ϕ
                           
                           
                              0
                              i
                           
                        
                      is the unknown phase, 
                        
                           
                              ϕ
                           
                           
                              i
                           
                        
                        (
                        n
                        )
                      is the PN that affects Spur i, 
                        
                           
                              ω
                           
                           
                              i
                           
                        
                      is the a priori frequency, and 
                        
                           
                              δ
                           
                           
                              
                                 
                                    ω
                                 
                                 
                                    i
                                 
                              
                           
                        
                      is the FS of Spur i. We consider that all of the PNs are under a Brownian model of variance 
                        
                           
                              σ
                           
                           
                              
                                 
                                    ξ
                                 
                                 
                                    i
                                 
                              
                           
                           
                              2
                           
                        
                     , as in Section 2. For each spur, a dedicated reference is synthesized as
                        
                           (42)
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              )
                              =
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    e
                                 
                                 
                                    j
                                    
                                       
                                          ω
                                       
                                       
                                          i
                                       
                                    
                                    n
                                    +
                                    j
                                    
                                       
                                          ϕ
                                       
                                       
                                          R
                                          i
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

As all of the spur frequencies are assumed to be different, the spurs are temporally uncorrelated. From the one-spur cancellation scheme defined in Section 3, a parallel structure can be designed, where all of the spurs are simultaneously filtered (the P references are weighted by P complex coefficients). The parallel cancellation scheme is presented in Fig. 4
                     . In this structure, all of the estimates 
                        
                           
                              
                                 
                                    s
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              i
                           
                        
                        (
                        n
                        )
                      coming from the LMS blocks are summed and then subtracted from the observation 
                        d
                        (
                        n
                        )
                     . The resulting output 
                        e
                        (
                        n
                        )
                      is then used as feedback to the P blocks.

The output of the algorithm at time index n is written as
                        
                           (43)
                           
                              e
                              (
                              n
                              )
                              =
                              d
                              (
                              n
                              )
                              −
                              
                                 
                                    Σ
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              n
                              )
                              ,
                           
                        
                      where
                        
                           (44)
                           
                              
                                 
                                    Σ
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              n
                              )
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 P
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              )
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              )
                           
                        
                      is the global estimate. The iteration process of the P filter coefficients is then set from (14) as
                        
                           (45)
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              +
                              1
                              )
                              =
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              )
                              +
                              μ
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              n
                              )
                              e
                              (
                              n
                              )
                              ;
                              
                              ∀
                              i
                           
                        
                      where μ is the global constant step size used in the structure. For all of the blocks in Fig. 4, the adaptive-step-size process described in (39) can also be used.

At the same time, for each block, we introduce the related pollution factor from (19) as
                        
                           (46)
                           
                              
                                 
                                    Q
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              +
                              
                                 
                                    2
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    1
                                    −
                                    μ
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    μ
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    μ
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          μ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    2
                                    μ
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          4
                                       
                                    
                                    )
                                 
                              
                              .
                           
                        
                      Assuming there is no correlation between the spurs and the spur estimates, the asymptotic SNIR can be expressed (see Appendix E) as
                        
                           (47)
                           
                              
                                 
                                    SNIR
                                 
                                 
                                    
                                       
                                          PaLMS
                                       
                                       
                                          [
                                          P
                                          ]
                                       
                                    
                                 
                              
                              =
                              −
                              10
                              
                                 
                                    log
                                 
                                 
                                    10
                                 
                              
                              ⁡
                              
                                 [
                                 
                                    
                                       μ
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             P
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                       −
                                       μ
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             P
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             P
                                          
                                       
                                       
                                          
                                             Q
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          
                                             δ
                                          
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       μ
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       (
                                       2
                                       −
                                       μ
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             P
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                                 ]
                              
                              .
                           
                        
                      The SNIR is composed of two terms: the first is due to the desired noisy signal, and the second is due to the polluting terms. In the case of one spur, the expression in (47) is equal to the asymptotic SNIR expressed in (20).

In this section, analytic formulae for the asymptotic and transient performance of the digital spur cancellation algorithms are compared to simulations.

First, we have supposed that the a priori spur frequency is perfectly known, as in the case of multi-standard transceivers. The clock harmonics are exact multiples of the operating clock frequency, and a spur will fall into the reception stage if one of the harmonics is within the signal bandwidth at the receiver carrier frequency 
                           
                              
                                 f
                              
                              
                                 Rx
                              
                           
                         (see Fig. 1). In such a case, the a priori spur natural frequency ω (normalized between 0 and 2π), defined in (2) and (4), is obtained from the clock frequency harmonic, which is a multiple of the operating clock frequency 
                           
                              
                                 F
                              
                              
                                 clock
                              
                           
                        , the received carrier frequency 
                           
                              
                                 f
                              
                              
                                 Rx
                              
                           
                         and the sampling frequency F, where
                           
                              (48)
                              
                                 ω
                                 =
                                 2
                                 π
                                 
                                    
                                       p
                                       
                                          
                                             F
                                          
                                          
                                             clock
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             Rx
                                          
                                       
                                    
                                    F
                                 
                                 ,
                              
                           
                         with p the index of the polluting harmonic.

As an example, if we consider a clock operating at 
                           
                              
                                 F
                              
                              
                                 clock
                              
                           
                           =
                           26
                            
                           MHz
                        , and a carrier frequency 
                           
                              
                                 f
                              
                              
                                 Rx
                              
                           
                           =
                           930
                            
                           MHz
                         for a LTE 
                           10
                            
                           MHz
                         signal (at sampling frequency 
                           F
                           =
                           15.36
                            
                           MHz
                        ), the 36th clock harmonic, (at 
                           936
                            
                           MHz
                        ) will pollute the received signal. The spur will be at 
                           
                              
                                 f
                              
                              
                                 s
                              
                           
                           =
                           6
                            
                           MHz
                         in baseband, leading to
                           
                              
                                 ω
                                 =
                                 2
                                 π
                                 
                                    
                                       36
                                       ⋅
                                       26
                                       e
                                       6
                                       −
                                       930
                                       e
                                       6
                                    
                                    
                                       15.36
                                       e
                                       6
                                    
                                 
                                 =
                                 2
                                 π
                                 ⋅
                                 0.39
                                 .
                              
                           
                        
                     

Our models and performance equations are based on values of the frequency shift 
                           
                              
                                 δ
                              
                              
                                 ω
                              
                           
                         and the phase noise variance 
                           
                              
                                 σ
                              
                              
                                 ξ
                              
                              
                                 2
                              
                           
                        . First, the parameter 
                           
                              
                                 δ
                              
                              
                                 ω
                              
                           
                         is related to the practical imprecision Δ of a synthesized frequency, which is expressed in parts-per-million (ppm). For example, in LTE systems, a typical frequency drift is about 10 ppm [28,29]. The link between 
                           
                              
                                 δ
                              
                              
                                 ω
                              
                           
                         and the physical parameters (spur frequency 
                           
                              
                                 f
                              
                              
                                 s
                              
                           
                        , sampling frequency F, expressed in Hertz) is 
                           
                              
                                 δ
                              
                              
                                 ω
                              
                           
                           =
                           Δ
                           
                              
                                 f
                              
                              
                                 s
                              
                           
                           /
                           F
                        . For example, in LTE, for a signal bandwidth of 10 MHz sampled at 
                           F
                           =
                           15.36
                            
                           MHz
                        , with a polluting spur at 
                           6
                            
                           MHz
                        , the resulting 
                           
                              
                                 δ
                              
                              
                                 ω
                              
                           
                         is 
                           4
                           ⋅
                           
                              
                                 10
                              
                              
                                 −
                                 6
                              
                           
                        .

Secondly, we have to link our parameter model 
                           
                              
                                 σ
                              
                              
                                 ξ
                              
                              
                                 2
                              
                           
                         to a practical phase noise specification. A state-of-the-art discretized model for Brownian phase noise is 
                           ϕ
                           (
                           n
                           )
                           =
                           2
                           π
                           
                              
                                 f
                              
                              
                                 s
                              
                           
                           
                              c
                           
                           B
                           (
                           n
                           )
                        , where 
                           
                              
                                 f
                              
                              
                                 s
                              
                           
                         is the spur frequency, 
                           B
                           (
                           n
                           )
                         represents the Brownian motion process of variance 
                           
                              1
                              F
                           
                         (where F is the sampling frequency), and c is a parameter of the oscillator defined in [18]. Thus, our state noise variance 
                           
                              
                                 σ
                              
                              
                                 ξ
                              
                              
                                 2
                              
                           
                         is 
                           4
                           
                              
                                 π
                              
                              
                                 2
                              
                           
                           
                              
                                 f
                              
                              
                                 s
                              
                              
                                 2
                              
                           
                           c
                           /
                           F
                        . The oscillator constant c cannot be obtained directly, but is a function of the oscillator power spectral density L expressed in dBc/Hz at a specific frequency f (>0), with the relation 
                           L
                           (
                           f
                           )
                           =
                           10
                           
                              
                                 log
                              
                              
                                 10
                              
                           
                           ⁡
                           (
                           
                              
                                 f
                              
                              
                                 s
                              
                              
                                 2
                              
                           
                           c
                           /
                           
                              
                                 f
                              
                              
                                 2
                              
                           
                           )
                         
                        [18,30]. The link between a phase noise specification and the state noise variance of our model is finally
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ξ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 4
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       10
                                    
                                    
                                       −
                                       
                                          
                                             L
                                             (
                                             f
                                             )
                                          
                                          10
                                       
                                    
                                 
                                 
                                    1
                                    F
                                 
                                 .
                              
                           
                         For example, in LTE, for a signal bandwidth of 10 MHz (
                           F
                           =
                           15.36
                            
                           MHz
                        ) and for a power spectral density of 
                           −
                           100
                            
                           dBc
                           /
                           Hz
                         at 
                           f
                           =
                           10
                         kHz, the equivalent variance of the Brownian model is 
                           
                              
                                 σ
                              
                              
                                 ξ
                              
                              
                                 2
                              
                           
                           =
                           2.5
                           ⋅
                           
                              
                                 10
                              
                              
                                 −
                                 8
                              
                           
                        .

We focus first on the transient performance for one spur. We consider here that the observation is composed of a white complex signal of unit variance, an additive white complex Gaussian noise with a SNR of 10 dB and a spur of known frequency, where the SNIR before compensation is 0 dB. The spur follows the model presented in (2), which is affected by a frequency shift 
                           
                              
                                 δ
                              
                              
                                 ω
                              
                           
                           =
                           
                              
                                 10
                              
                              
                                 −
                                 7
                              
                           
                        , and the corresponding Brownian PN has a variance 
                           
                              
                                 σ
                              
                              
                                 ξ
                              
                              
                                 2
                              
                           
                         of 
                           
                              
                                 10
                              
                              
                                 −
                                 7
                              
                           
                        . The reference is constructed from (4) and is used in the filter scheme described in Fig. 2. At the middle of the simulation, a change in the configuration is applied: the frequency of the spur and the reference are not changed, but the level of the spur is raised from 0 dB to 5 dB to force the algorithm to re-converge after having reached the asymptotic mode (assuming unchanged parameters for the reference). The two algorithms presented in Section 3 are compared: the constant-step solution of (12)–(14), and the adaptive-step-size solution of (39). For these algorithms to have the same asymptotic performance, the value of the constant LMS step size is the same as the minimal step of the adaptive-step-size solution, and this is set to 
                           
                              
                                 2
                              
                              
                                 −
                                 11
                              
                           
                         (which is close to optimal). The maximal value of the adaptive step size is bounded by (21). The simulated mean transient SNIRs for the two algorithms, the theoretical SNIR evolution for the constant step size of (36), the theoretical asymptotic value of (20), and the adaptive-step-size algorithm of (39) are depicted in Fig. 5
                        . Also, two other methods in the literature are computed for comparison: the recursive least squares (RLS) algorithm [24] and the equivalent IIR as described in (26) and presented in [14]. It is first shown that the theoretical formulae are validated by the simulations: the mean transient performance of the constant-step-size LMS follows (36) and constant and adaptive-step-sized algorithms have the same asymptotic performance, as defined in (20). Furthermore, the adaptive-step-size solution is more rapid than the constant-step-size solution for the same asymptotic performance. The constant-step-size LMS solution has the same transient and asymptotic performance as the IIR filter, which is in agreement with the equivalent notch filter of (26). Finally, the adaptive solution has a convergence rate that is similar to the RLS solution, but can better cope with a change in the configuration of the spurs, and offers a more suitable hardware implementation (as there is no division in our algorithm).


                        Fig. 6
                         compares the asymptotic SNIR to the simulated results for one spur with input SNIR of 10 dB, in the case of FS only (no PN). The SNIR is computed versus the step size (which is equivalent to the minimal step size in the case of the adaptive-step-size solution) for different values of FS. The simulated data is white and has an additive white noise of variance 10 dB. The figure validates the asymptotic formula (28). The presence of the optimal step size is also validated, and the loss of performance, due to the second term of (28), is proportional to the square of the step size, as expected by the formulae.

At the same time, the optimal step size gives the maximal value of the SNIR that can be obtained for a given FS. Fig. 7
                         shows the evolution of this maximal SNIR (30) versus FS. This shows that the theory is in agreement, and that the FS leads to a loss of performance of 6.66 dB per decade.


                        Fig. 8
                         compares the asymptotic SNIR to the simulated results in the case of PN (no FS). The asymptotic SNIR is computed versus the step size, for different variances of the Brownian model of (3), again, showing agreement with the theory described in (32).

The maximal SNIR is given by (34), and is validated in Fig. 9
                         for an initial SNIR of 10 dB.

In Fig. 10
                        , we consider both the PN and FS for one spur, and the theory elaborated in (20) is validated by the simulation for several pairs of 
                           
                              
                                 σ
                              
                              
                                 ξ
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 δ
                              
                              
                                 ω
                              
                           
                        .

In order to show the impact of the number of spurs on the asymptotic performance, Fig. 11
                         shows the asymptotic SNIR of (47), as compared to the simulations. The noisy signal is still white, and is polluted by 1 to P spurs of different frequencies. All of the P spurs are affected by a Brownian PN of variance 
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 2
                              
                           
                         and their reference has a FS of 
                           
                              
                                 δ
                              
                              
                                 
                                    
                                       ω
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        , following the model described in (41) and (42). The parameters used are described in Table 1
                        . It should be noted that the frequency values are given for information only, and have no impact on the overall performance, as (47) does not depend on 
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                        .

We compare the influence of the spurs and the compensated spurs in terms of the bit error rate (BER). We first consider a data signal modulated by quadrature phase shift keying (QPSK) modulation through an additive white Gaussian noise channel with various SNRs. We suppose that the noisy signal is polluted by two spurs, affected by a FS of 
                              
                                 
                                    10
                                 
                                 
                                    −
                                    7
                                 
                              
                            and a PN of variance 
                              
                                 
                                    10
                                 
                                 
                                    −
                                    7
                                 
                              
                           . We show in Fig. 12
                            the results of the BER without the compensation system and with the parallel LMS compensation scheme (with step size of 
                              
                                 
                                    2
                                 
                                 
                                    −
                                    11
                                 
                              
                           ) for different values of the channel SNR and for different SIRs. (Here, the amplitudes of the spurs are computed from only the power of the desired signal (SIR) neglecting the additive white noise in order to have constant spur amplitude versus the channel SNR: the amplitudes of the spurs are obtained directly by 
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    
                                       
                                          10
                                       
                                       
                                          
                                             SIR
                                          
                                          /
                                          10
                                       
                                    
                                 
                              
                           , where 
                              
                                 
                                    σ
                                 
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                            is the variance of the data signal without noise.) We show that our methods greatly reduce the BER and that the compensated BER comes close to the ideal channel influence 
                              Q
                              (
                              
                                 
                                    2
                                    
                                       
                                          E
                                       
                                       
                                          b
                                       
                                    
                                    /
                                    
                                       
                                          N
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              )
                           .

Finally, we compare the BER for the more realistic case of a simplified LTE modulation that is based on the Third Generation Partnership Project (3GPP) model [31]. The data signal follows a LTE 1.4 MHz bandwidth specifications based on orthogonal frequency division multiplexing (OFDM), with 72 QPSK subcarriers, a fast Fourier transform (FFT) of size of 128, and a cyclic prefix of length nine samples. The BER is computed on the uncoded bits of the data and through an additive white Gaussian noise channel with various SNRs. We consider that the noisy signal is polluted by two spurs. These spurs are affected by a FS of 
                              
                                 
                                    10
                                 
                                 
                                    −
                                    7
                                 
                              
                            and are modulated with a Brownian PN of variance 
                              
                                 
                                    10
                                 
                                 
                                    −
                                    7
                                 
                              
                           .


                           Fig. 13
                            shows the results of the BER without compensation and with the parallel LMS compensation scheme for different values of the channel SNR and for different SIRs. The theoretical performance without spurs (i.e., only the influence of the channel) is shown in black.
                              1
                           
                           
                              1
                              For the simulation, the theoretical curve is given by the link between the SNR and 
                                    
                                       
                                          E
                                       
                                       
                                          b
                                       
                                    
                                    /
                                    
                                       
                                          N
                                       
                                       
                                          0
                                       
                                    
                                 . In the case of LTE with 1.4-MHz bandwidth and QPSK modulation, the link is given by 
                                    
                                       
                                          E
                                       
                                       
                                          b
                                       
                                    
                                    /
                                    
                                       
                                          N
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       SNR
                                    
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          FFT
                                       
                                    
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          CP
                                       
                                    
                                    )
                                    /
                                    (
                                    2
                                    
                                       
                                          n
                                       
                                       
                                          Re
                                       
                                    
                                    )
                                 , where 
                                    
                                       
                                          n
                                       
                                       
                                          FFT
                                       
                                    
                                    =
                                    128
                                  is the size of the fast Fourier transform, 
                                    
                                       
                                          n
                                       
                                       
                                          CP
                                       
                                    
                                    =
                                    9
                                  is the length of the cyclic prefix, and 
                                    
                                       
                                          n
                                       
                                       
                                          Re
                                       
                                    
                                    =
                                    72
                                  is the number of received carriers. This leads to the expression of 
                                    
                                       BER
                                    
                                    =
                                    Q
                                    [
                                    
                                       
                                          
                                             SNR
                                          
                                          (
                                          
                                             
                                                n
                                             
                                             
                                                FFT
                                             
                                          
                                          +
                                          
                                             
                                                n
                                             
                                             
                                                CP
                                             
                                          
                                          )
                                          /
                                          
                                             
                                                n
                                             
                                             
                                                Re
                                             
                                          
                                       
                                    
                                    ]
                                 .
                            Without compensation, it is shown that the presence of the spurs reduces the performance of the overall system, which leads to a lower limit on the BER. The decrease in performance depends on input SIR, although it impacts the signal as soon as the SNR is greater than about 4 dB. After compensation, the BER is greatly reduced compared to the initial BER, and reaches a floor. Thus, the designed system has good performance if the spurs have an initial SIR between 0 dB and 20 dB.

Up to now, we have verified the theoretical performance of the proposed algorithm in the presence of Brownian phase noise, which is the usual model chosen in practice for free running oscillators [19–21]. However, if a more practical PLL-type oscillator is used, the polluting model for the phase noise will not be Brownian. In such a case, the theoretical asymptotic performance expressions (20) and (32) are no longer valid, and the performance will depend on the scale and shape of chosen phase noise.

The profile of a practical phase noise is depicted in Fig. 14
                        . Such a phase noise spectrum can result from a sum of 
                           1
                           /
                           
                              
                                 f
                              
                              
                                 2
                              
                           
                         noise modeled as a Lorenz spectrum, 
                           1
                           /
                           f
                         noise (flicker noise) filtered by a second-order PLL, and a noise floor as described in [32, Section 2.3]. An example of a phase noise specification from [32, Section 2.3] is proposed in Table 2
                        .

In Fig. 15
                        , we represent in red the asymptotic performance of our algorithm versus the step size in the presence of one spur, impaired by the practical phase noise described in Table 2, obtained by Monte-Carlo simulation. For comparison, we also plot the theoretical asymptotic performance with Brownian phase noise with specific variance obtained in (32). We note that, for large values of the step size, the performance is similar for the two models [since the first term of (32), 
                           μ
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                           /
                           (
                           2
                           −
                           μ
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                           )
                        , is predominant and does not depend on the model], whereas for small values of the step size, the theoretical curve under the Brownian assumption does not match with the practical performance [since the second term of (32) is predominant and is model dependent].

@&#CONCLUSIONS@&#

This study has focused on the performance of a multiple-spur cancellation scheme. We first proposed a one-spur canceler based on the LMS algorithm, which uses a priori knowledge of spur frequency to create a reference. We proposed a model with imperfections, due to the limited accuracy of frequency knowledge and Brownian phase noise. In this case, we derived closed-form formulae of the asymptotic SNR and show that the step size of the algorithm can be optimally tuned. We showed that the LMS algorithm is equivalent to a notch filter, which leads to simplified expressions in the case of PN only or FS only. We added an adaptive-step-size process to improve the convergence speed without lowering the asymptotic performance. This solution offers performance similar to the RLS algorithm but can better cope with configuration changes. In a second part of the paper, we extended the problem to the multiple-spur case, and developed a parallel scheme that uses the one-spur block previously described. We developed closed-form formulae of the asymptotic SNIR for P spurs, in a general case of P Brownian noises and P FSs.

The goal of this appendix is to recall how the LMS approach can be legitimized, from simplification of the recursive-least-squares approach. The weighted least-squares cost function used is [24,33]
                     
                        
                           
                              
                                 
                                    J
                                 
                                 
                                    n
                                 
                              
                              (
                              
                                 
                                    w
                                 
                                 
                                    ˆ
                                 
                              
                              )
                              =
                              
                                 ∑
                                 
                                    p
                                    =
                                    1
                                 
                                 n
                              
                              
                                 
                                    λ
                                 
                                 
                                    n
                                    −
                                    p
                                 
                              
                              
                                 
                                    |
                                    e
                                    (
                                    p
                                    )
                                    |
                                 
                                 
                                    2
                                 
                              
                           
                        
                      with 
                        λ
                        <
                        1
                     , because of the nonstationarity of the parameters to be estimated. Due to the structure of the filter defined in Fig. 2, we have:
                        
                           
                              
                                 
                                    J
                                 
                                 
                                    n
                                 
                              
                              (
                              
                                 
                                    w
                                 
                                 
                                    ˆ
                                 
                              
                              )
                              =
                              
                                 ∑
                                 
                                    p
                                    =
                                    1
                                 
                                 n
                              
                              
                                 
                                    λ
                                 
                                 
                                    n
                                    −
                                    p
                                 
                              
                              
                                 
                                    |
                                    d
                                    (
                                    p
                                    )
                                    −
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                    u
                                    (
                                    p
                                    )
                                    |
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 ∑
                                 
                                    p
                                    =
                                    1
                                 
                                 n
                              
                              
                                 
                                    λ
                                 
                                 
                                    n
                                    −
                                    p
                                 
                              
                              
                                 [
                                 d
                                 (
                                 p
                                 )
                                 
                                    
                                       d
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 p
                                 )
                                 −
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ⁎
                                    
                                 
                                 d
                                 (
                                 p
                                 )
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 p
                                 )
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       ˆ
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 p
                                 )
                                 u
                                 (
                                 p
                                 )
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       ˆ
                                    
                                 
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ⁎
                                    
                                 
                                 u
                                 (
                                 p
                                 )
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 p
                                 )
                                 ]
                              
                              .
                           
                        
                      At each iteration, the weight estimate update 
                        w
                        (
                        n
                        +
                        1
                        )
                      is based on the minimization of 
                        
                           
                              J
                           
                           
                              n
                           
                        
                        (
                        
                           
                              w
                           
                           
                              ˆ
                           
                        
                        )
                     . As the cost function is a real function of complex variables, using complex derivative theory [34], the minimization is obtained by setting 
                        ∂
                        
                           
                              J
                           
                           
                              n
                           
                        
                        (
                        
                           
                              w
                           
                           
                              ˆ
                           
                        
                        )
                        /
                        ∂
                        
                           
                              
                                 
                                    w
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ⁎
                           
                        
                        =
                        0
                      and assuming 
                        ∂
                        
                           
                              w
                           
                           
                              ˆ
                           
                        
                        /
                        ∂
                        
                           
                              
                                 
                                    w
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ⁎
                           
                        
                        =
                        0
                     .

As a consequence, the derivative component is written as
                        
                           
                              
                                 
                                    ∂
                                    
                                       
                                          J
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ⁎
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∇
                                 
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ⁎
                                       
                                    
                                 
                              
                              
                                 
                                    J
                                 
                                 
                                    n
                                 
                              
                              (
                              
                                 
                                    w
                                 
                                 
                                    ˆ
                                 
                              
                              )
                              =
                              
                                 ∑
                                 
                                    p
                                    =
                                    1
                                 
                                 n
                              
                              
                                 
                                    λ
                                 
                                 
                                    n
                                    −
                                    p
                                 
                              
                              
                                 
                                    ∇
                                 
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ⁎
                                       
                                    
                                 
                              
                              
                                 
                                    |
                                    e
                                    (
                                    p
                                    )
                                    |
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 ∑
                                 
                                    p
                                    =
                                    1
                                 
                                 n
                              
                              
                                 
                                    λ
                                 
                                 
                                    n
                                    −
                                    p
                                 
                              
                              
                                 [
                                 −
                                 d
                                 (
                                 p
                                 )
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 p
                                 )
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       ˆ
                                    
                                 
                                 u
                                 (
                                 p
                                 )
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 p
                                 )
                                 ]
                              
                              .
                           
                        
                      Setting 
                        ∂
                        
                           
                              J
                           
                           
                              n
                           
                        
                        (
                        
                           
                              w
                           
                           
                              ˆ
                           
                        
                        )
                        /
                        ∂
                        
                           
                              
                                 
                                    w
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ⁎
                           
                        
                        =
                        0
                      then leads to
                        
                           (49)
                           
                              w
                              (
                              n
                              +
                              1
                              )
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          n
                                          −
                                          p
                                       
                                    
                                    [
                                    d
                                    (
                                    p
                                    )
                                    
                                       
                                          u
                                       
                                       
                                          ⁎
                                       
                                    
                                    (
                                    p
                                    )
                                    ]
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          n
                                          −
                                          p
                                       
                                    
                                    [
                                    u
                                    (
                                    p
                                    )
                                    
                                       
                                          u
                                       
                                       
                                          ⁎
                                       
                                    
                                    (
                                    p
                                    )
                                    ]
                                 
                              
                              .
                           
                        
                     
                  

We denote the temporal autocorrelation of the reference by 
                        
                           
                              R
                           
                           
                              λ
                           
                        
                        (
                        n
                        )
                      and the temporal cross-correlation between the reference and the observation by 
                        
                           
                              p
                           
                           
                              λ
                           
                        
                        (
                        n
                        )
                     , which are estimated as
                        
                           (50)
                           
                              
                                 
                                    R
                                 
                                 
                                    λ
                                 
                              
                              (
                              n
                              )
                              =
                              
                                 ∑
                                 
                                    p
                                    =
                                    1
                                 
                                 n
                              
                              
                                 
                                    λ
                                 
                                 
                                    n
                                    −
                                    p
                                 
                              
                              u
                              (
                              p
                              )
                              
                                 
                                    u
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              p
                              )
                           
                        
                     
                     
                        
                           (51)
                           
                              
                                 
                                    p
                                 
                                 
                                    λ
                                 
                              
                              (
                              n
                              )
                              =
                              
                                 ∑
                                 
                                    p
                                    =
                                    1
                                 
                                 n
                              
                              
                                 
                                    λ
                                 
                                 
                                    n
                                    −
                                    p
                                 
                              
                              d
                              (
                              p
                              )
                              
                                 
                                    u
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              p
                              )
                              ,
                           
                        
                      and finally have
                        
                           (52)
                           
                              w
                              (
                              n
                              +
                              1
                              )
                              =
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          λ
                                       
                                    
                                    (
                                    n
                                    )
                                 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          λ
                                       
                                    
                                    (
                                    n
                                    )
                                 
                              
                              .
                           
                        
                      The temporal cross-correlation and autocorrelation can be recursively expressed as
                        
                           (53)
                           
                              
                                 
                                    p
                                 
                                 
                                    λ
                                 
                              
                              (
                              n
                              )
                              =
                              λ
                              
                                 
                                    p
                                 
                                 
                                    λ
                                 
                              
                              (
                              n
                              −
                              1
                              )
                              +
                              d
                              (
                              n
                              )
                              
                                 
                                    u
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              n
                              )
                           
                        
                     
                     
                        
                           (54)
                           
                              
                                 
                                    R
                                 
                                 
                                    λ
                                 
                              
                              (
                              n
                              )
                              =
                              λ
                              
                                 
                                    R
                                 
                                 
                                    λ
                                 
                              
                              (
                              n
                              −
                              1
                              )
                              +
                              u
                              (
                              n
                              )
                              
                                 
                                    u
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              n
                              )
                              .
                           
                        
                      Substituting (53) in (52), we have
                        
                           (55)
                           
                              w
                              (
                              n
                              +
                              1
                              )
                              =
                              
                                 1
                                 
                                    
                                       
                                          R
                                       
                                       
                                          λ
                                       
                                    
                                    (
                                    n
                                    )
                                 
                              
                              
                                 [
                                 λ
                                 
                                    
                                       p
                                    
                                    
                                       λ
                                    
                                 
                                 (
                                 n
                                 −
                                 1
                                 )
                                 +
                                 d
                                 (
                                 n
                                 )
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 n
                                 )
                                 ]
                              
                              .
                           
                        
                      From (52) and due to the recursive update of 
                        
                           
                              R
                           
                           
                              λ
                           
                        
                        (
                        n
                        )
                      expressed in (54)
                     
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    λ
                                 
                              
                              (
                              n
                              −
                              1
                              )
                              =
                              w
                              (
                              n
                              )
                              
                                 
                                    R
                                 
                                 
                                    λ
                                 
                              
                              (
                              n
                              −
                              1
                              )
                              =
                              w
                              (
                              n
                              )
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          λ
                                       
                                    
                                    (
                                    n
                                    )
                                    −
                                    u
                                    (
                                    n
                                    )
                                    
                                       
                                          u
                                       
                                       
                                          ⁎
                                       
                                    
                                    (
                                    n
                                    )
                                 
                                 λ
                              
                              ,
                           
                        
                      and substitution into (55) gives
                        
                           (56)
                           
                              w
                              (
                              n
                              +
                              1
                              )
                              =
                              w
                              (
                              n
                              )
                              +
                              
                                 1
                                 
                                    
                                       
                                          R
                                       
                                       
                                          λ
                                       
                                    
                                    (
                                    n
                                    )
                                 
                              
                              
                                 [
                                 −
                                 w
                                 (
                                 n
                                 )
                                 u
                                 (
                                 n
                                 )
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 n
                                 )
                                 +
                                 d
                                 (
                                 n
                                 )
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 n
                                 )
                                 ]
                              
                              .
                           
                        
                      As by construction 
                        e
                        (
                        n
                        )
                        =
                        d
                        (
                        n
                        )
                        −
                        w
                        (
                        n
                        )
                        u
                        (
                        n
                        )
                     , the update becomes
                        
                           (57)
                           
                              w
                              (
                              n
                              +
                              1
                              )
                              =
                              w
                              (
                              n
                              )
                              +
                              
                                 1
                                 
                                    
                                       
                                          R
                                       
                                       
                                          λ
                                       
                                    
                                    (
                                    n
                                    )
                                 
                              
                              
                                 [
                                 e
                                 (
                                 n
                                 )
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 n
                                 )
                                 ]
                              
                              .
                           
                        
                      The standard update of the LMS algorithm [22] is finally obtained by substituting the inverse recursive update of the temporal autocorrelation of the reference [
                        1
                        /
                        
                           
                              R
                           
                           
                              λ
                           
                        
                        (
                        n
                        )
                     ] with a constant step size μ, to have a less complex algorithm, and thus the recursive equation of 
                        w
                        (
                        n
                        )
                      becomes
                        
                           (58)
                           
                              
                                 w
                                 (
                                 n
                                 +
                                 1
                                 )
                                 =
                                 w
                                 (
                                 n
                                 )
                                 +
                                 μ
                                 
                                    
                                       u
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 n
                                 )
                                 e
                                 (
                                 n
                                 )
                              
                           
                           
                              
                                 
                                    w
                                    (
                                    n
                                    +
                                    1
                                    )
                                 
                                 =
                                 w
                                 (
                                 n
                                 )
                                 −
                                 
                                    μ
                                    2
                                 
                                 
                                    
                                       ∇
                                    
                                    
                                       w
                                    
                                 
                                 
                                    
                                       |
                                       e
                                       (
                                       n
                                       )
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        
                     
                  

The expression of the misalignment can be expressed recursively using (14) and (11), as
                        
                           (59)
                           
                              v
                              (
                              n
                              +
                              1
                              )
                              =
                              w
                              (
                              n
                              +
                              1
                              )
                              −
                              
                                 
                                    w
                                 
                                 
                                    opt
                                 
                              
                              (
                              n
                              +
                              1
                              )
                              =
                              w
                              (
                              n
                              )
                              +
                              μ
                              
                                 
                                    u
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              n
                              )
                              
                                 [
                                 x
                                 (
                                 n
                                 )
                                 +
                                 b
                                 (
                                 n
                                 )
                                 ]
                              
                              −
                              μ
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              v
                              (
                              n
                              )
                              −
                              
                                 
                                    w
                                 
                                 
                                    opt
                                 
                              
                              (
                              n
                              )
                              −
                              
                                 
                                    w
                                 
                                 
                                    Opt
                                 
                              
                              (
                              n
                              )
                              
                                 [
                                 j
                                 ξ
                                 (
                                 n
                                 )
                                 −
                                 j
                                 
                                    
                                       δ
                                    
                                    
                                       ω
                                    
                                 
                                 ]
                              
                              =
                              
                                 [
                                 w
                                 (
                                 n
                                 )
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       opt
                                    
                                 
                                 (
                                 n
                                 )
                                 ]
                              
                              +
                              μ
                              
                                 
                                    u
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              n
                              )
                              
                                 [
                                 x
                                 (
                                 n
                                 )
                                 +
                                 b
                                 (
                                 n
                                 )
                                 ]
                              
                              −
                              μ
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              v
                              (
                              n
                              )
                              −
                              
                                 
                                    w
                                 
                                 
                                    opt
                                 
                              
                              (
                              n
                              )
                              
                                 [
                                 j
                                 ξ
                                 (
                                 n
                                 )
                                 −
                                 j
                                 
                                    
                                       δ
                                    
                                    
                                       ω
                                    
                                 
                                 ]
                              
                              =
                              
                                 (
                                 1
                                 −
                                 μ
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              v
                              (
                              n
                              )
                              +
                              μ
                              
                                 
                                    u
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              n
                              )
                              
                                 [
                                 x
                                 (
                                 n
                                 )
                                 +
                                 b
                                 (
                                 n
                                 )
                                 ]
                              
                              −
                              
                                 
                                    w
                                 
                                 
                                    opt
                                 
                              
                              (
                              n
                              )
                              
                                 [
                                 j
                                 ξ
                                 (
                                 n
                                 )
                                 −
                                 j
                                 
                                    
                                       δ
                                    
                                    
                                       ω
                                    
                                 
                                 ]
                              
                              .
                           
                        
                     
                  

The LMS algorithm is based on minimization of the gradient of 
                        J
                        (
                        n
                        )
                     , so the complex sequence of the misalignment 
                        v
                        (
                        n
                        )
                      is white. Assuming temporal uncorrelation between the white sequences [the misalignment 
                        v
                        (
                        n
                        )
                     , the signal 
                        x
                        (
                        n
                        )
                     , the additive noise 
                        b
                        (
                        n
                        )
                     , and the phase noise 
                        ξ
                        (
                        n
                        )
                     ], we only have dependence between the misalignment 
                        v
                        (
                        n
                        )
                      and the recursive expression of the optimal filter 
                        
                           
                              w
                           
                           
                              opt
                           
                        
                        (
                        n
                        )
                     . Note that there is no single dependency between 
                        v
                        (
                        n
                        )
                      and 
                        [
                        x
                        (
                        n
                        )
                        +
                        b
                        (
                        n
                        )
                        ]
                      due to causality and the whiteness of the desired noisy signal. The variance of the misalignment can be expressed as
                        
                           (60)
                           
                              E
                              
                                 [
                                 
                                    
                                       |
                                       v
                                       (
                                       n
                                       +
                                       1
                                       )
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              =
                              
                                 
                                    (
                                    1
                                    −
                                    μ
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              E
                              
                                 [
                                 
                                    
                                       |
                                       v
                                       (
                                       n
                                       )
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              +
                              
                                 
                                    μ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              +
                              
                                 
                                    
                                       A
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       ξ
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       δ
                                    
                                    
                                       ω
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              +
                              
                                 
                                    δ
                                 
                                 
                                    ω
                                 
                              
                              
                                 (
                                 1
                                 −
                                 μ
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              E
                              
                                 [
                                 
                                    |
                                    v
                                    (
                                    n
                                    )
                                    
                                       
                                          w
                                       
                                       
                                          opt
                                       
                                    
                                    (
                                    n
                                    )
                                    |
                                 
                                 ]
                              
                              .
                           
                        
                      The term 
                        E
                        [
                        |
                        v
                        (
                        n
                        )
                        
                           
                              w
                           
                           
                              opt
                           
                        
                        (
                        n
                        )
                        |
                        ]
                      can be expressed through the separation between the real part and the imaginary part of the two components:
                        
                           (61)
                           
                              E
                              
                                 [
                                 
                                    |
                                    v
                                    (
                                    n
                                    )
                                    
                                       
                                          w
                                       
                                       
                                          opt
                                       
                                    
                                    (
                                    n
                                    )
                                    |
                                 
                                 ]
                              
                              =
                              
                                 
                                    2
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    μ
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          ω
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          δ
                                       
                                       
                                          ω
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    μ
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          μ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          ω
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    2
                                    μ
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          ω
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          4
                                       
                                    
                                    )
                                 
                              
                              .
                           
                        
                      Then, replacing (61) in (60) leads to (18).

We still assume the aforementioned hypotheses
                        
                           •
                           The normalized FS 
                                 
                                    
                                       δ
                                    
                                    
                                       ω
                                    
                                 
                                 ≪
                                 ω
                               (normalized frequency),

The PN variance 
                                 
                                    
                                       σ
                                    
                                    
                                       ξ
                                    
                                    
                                       2
                                    
                                 
                                 ≪
                                 1
                              ,

The step size 
                                 μ
                                 ≪
                                 1
                              .

In the asymptotic mode, assuming that there is no PN, the algorithm is equivalent to a notch filter after baseband frequency shifting of the spur. The estimation error at the output of the structure is expressed after shifting as
                        
                           (65)
                           
                              
                                 
                                    ϵ
                                 
                                 
                                    BB
                                 
                              
                              (
                              n
                              )
                              =
                              
                                 [
                                 x
                                 (
                                 n
                                 )
                                 +
                                 b
                                 (
                                 n
                                 )
                                 −
                                 e
                                 (
                                 n
                                 )
                                 ]
                              
                              
                                 
                                    u
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              n
                              )
                              .
                           
                        
                      Expressing the z transform of the filter obtained, using the z transform of the equivalent LPF (24), the estimation error can be expressed as:
                        
                           
                              
                                 
                                    E
                                 
                                 
                                    BB
                                 
                              
                              (
                              z
                              )
                              =
                              S
                              (
                              z
                              )
                              ⁎
                              
                                 
                                    U
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              z
                              )
                              −
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              W
                              (
                              z
                              )
                              =
                              S
                              (
                              z
                              )
                              ⁎
                              
                                 
                                    U
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              z
                              )
                              −
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              L
                              (
                              z
                              )
                              
                                 [
                                 D
                                 (
                                 z
                                 )
                                 ⁎
                                 
                                    
                                       U
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 z
                                 )
                                 ]
                              
                              .
                           
                        
                      With (1) for the observation equation
                        
                           (66)
                           
                              
                                 
                                    E
                                 
                                 
                                    BB
                                 
                              
                              (
                              z
                              )
                              =
                              −
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              L
                              (
                              z
                              )
                              
                                 [
                                 X
                                 (
                                 z
                                 )
                                 ⁎
                                 
                                    
                                       U
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 z
                                 )
                                 ]
                              
                              +
                              
                                 [
                                 1
                                 −
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 L
                                 (
                                 z
                                 )
                                 ]
                              
                              
                                 [
                                 S
                                 (
                                 z
                                 )
                                 ⁎
                                 
                                    
                                       U
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 z
                                 )
                                 ]
                              
                              .
                           
                        
                      The variance of the estimation error is from (66)
                     
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    
                                       
                                          ϵ
                                       
                                       
                                          BB
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    4
                                 
                              
                              T
                              
                                 ∫
                                 
                                    −
                                    
                                       1
                                       
                                          2
                                          T
                                       
                                    
                                 
                                 
                                    1
                                    
                                       2
                                       T
                                    
                                 
                              
                              
                                 
                                    |
                                    L
                                    
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             2
                                             j
                                             π
                                             f
                                             T
                                          
                                       
                                       )
                                    
                                    |
                                 
                                 
                                    2
                                 
                              
                              d
                              f
                              +
                              
                                 ∫
                                 
                                    −
                                    
                                       1
                                       
                                          2
                                          T
                                       
                                    
                                 
                                 
                                    1
                                    
                                       2
                                       T
                                    
                                 
                              
                              
                                 
                                    |
                                    1
                                    −
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                    L
                                    
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             2
                                             j
                                             π
                                             f
                                             T
                                          
                                       
                                       )
                                    
                                    |
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    Γ
                                 
                                 
                                    s
                                    
                                       
                                          u
                                       
                                       
                                          ⁎
                                       
                                    
                                 
                              
                              (
                              f
                              )
                              d
                              f
                              .
                           
                        
                      The first term corresponds to the static error due to the presence of the noisy data (assumed to be white and with a power spectral density 
                        
                           
                              σ
                           
                           
                              x
                           
                           
                              2
                           
                        
                        T
                     ). The second term corresponds to the dynamic error related to the frequency shift, where 
                        
                           
                              Γ
                           
                           
                              s
                              
                                 
                                    u
                                 
                                 
                                    ⁎
                                 
                              
                           
                        
                        (
                        f
                        )
                      is the power spectral density of 
                        s
                        
                           
                              u
                           
                           
                              ⁎
                           
                        
                      (which corresponds to the downshifted spur frequency). After computation and using the same hypotheses (
                        
                           
                              δ
                           
                           
                              ω
                           
                        
                        ≪
                        1
                        ,
                        
                           
                              δ
                           
                           
                              ω
                           
                        
                        <
                        μ
                        ;
                        μ
                        ≪
                        1
                     ), the variance of the estimation error is
                        
                           (67)
                           
                              
                                 
                                    σ
                                 
                                 
                                    
                                       
                                          ϵ
                                       
                                       
                                          BB
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ≈
                              
                                 
                                    σ
                                 
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    μ
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    2
                                    −
                                    μ
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    (
                                    
                                       
                                          A
                                          
                                             
                                                δ
                                             
                                             
                                                ω
                                             
                                          
                                       
                                       
                                          μ
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                        
                      which leads to the same value of the asymptotic SNIR as described in the simplified form of (28).

In the parallel structure, the global output of the algorithm is composed of the signal 
                        x
                        (
                        n
                        )
                     , the noise 
                        b
                        (
                        n
                        )
                     , the spurs 
                        
                           
                              s
                           
                           
                              i
                           
                        
                        (
                        n
                        )
                     , and the spur estimates 
                        
                           
                              w
                           
                           
                              i
                           
                        
                        (
                        n
                        )
                        
                           
                              u
                           
                           
                              i
                           
                        
                        (
                        n
                        )
                     , such that
                        
                           (68)
                           
                              e
                              (
                              n
                              )
                              =
                              x
                              (
                              n
                              )
                              +
                              b
                              (
                              n
                              )
                              +
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 P
                              
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              )
                              −
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 P
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              )
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              )
                              .
                           
                        
                      The misalignments for each block are introduced with the same definition as in (15), as 
                        
                           
                              s
                           
                           
                              i
                           
                        
                        (
                        n
                        )
                        =
                        
                           
                              w
                           
                           
                              
                                 
                                    opt
                                 
                                 
                                    i
                                 
                              
                           
                        
                        (
                        n
                        )
                        
                           
                              u
                           
                           
                              i
                           
                        
                        (
                        n
                        )
                     , so that
                        
                           (69)
                           
                              e
                              (
                              n
                              )
                              =
                              x
                              (
                              n
                              )
                              +
                              b
                              (
                              n
                              )
                              −
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 P
                              
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              )
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              )
                              .
                           
                        
                      The estimation error of the structure, which is defined in (6), leads to the expression of the asymptotic SNIR of the P stages:
                        
                           (70)
                           
                              
                                 
                                    SNIR
                                 
                                 
                                    P
                                 
                              
                              =
                              −
                              10
                              
                                 
                                    log
                                 
                                 
                                    10
                                 
                              
                              ⁡
                              
                                 (
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             P
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       E
                                       [
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                      For each block, the misalignment is recursively described using (11), (15), (45), (59), and (69) as
                        
                           (71)
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              +
                              1
                              )
                              =
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              )
                              +
                              μ
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              n
                              )
                              
                                 [
                                 x
                                 (
                                 n
                                 )
                                 +
                                 b
                                 (
                                 n
                                 )
                                 ]
                              
                              −
                              
                                 
                                    w
                                 
                                 
                                    
                                       
                                          opt
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              n
                              )
                              
                                 [
                                 j
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 n
                                 )
                                 −
                                 j
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 ]
                              
                              −
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 P
                              
                              μ
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              (
                              n
                              )
                              ,
                              
                              ∀
                              i
                              ∈
                              [
                              1
                              ;
                              P
                              ]
                              .
                           
                        
                      Assuming the same hypothesis between uncorrelated misalignment, the variance of Block i is expressed 
                        ∀
                        i
                        ∈
                        [
                        1
                        ;
                        P
                        ]
                      as
                        
                           (72)
                           
                              E
                              
                                 [
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 n
                                 )
                                 ]
                              
                              =
                              
                                 
                                    μ
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    2
                                    −
                                    μ
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    μ
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    2
                                    −
                                    μ
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              +
                              
                                 ∑
                                 
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       j
                                       ≠
                                       i
                                    
                                 
                                 P
                              
                              
                                 [
                                 
                                    
                                       μ
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       E
                                       [
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       n
                                       )
                                       ]
                                    
                                    
                                       2
                                       −
                                       μ
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ]
                              
                              .
                           
                        
                     
                  

From (72), the problem can be set in matrix form as
                        
                           
                              
                                 (
                                 
                                    
                                       
                                          2
                                          −
                                          μ
                                          
                                             
                                                B
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          …
                                       
                                       
                                          −
                                          μ
                                          
                                             
                                                B
                                             
                                             
                                                P
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          −
                                          μ
                                          
                                             
                                                B
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          …
                                       
                                       
                                          −
                                          μ
                                          
                                             
                                                B
                                             
                                             
                                                P
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          ⋮
                                       
                                       
                                          ⋮
                                       
                                       
                                          ⋮
                                       
                                    
                                    
                                       
                                          −
                                          μ
                                          
                                             
                                                B
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          …
                                       
                                       
                                          2
                                          −
                                          μ
                                          
                                             
                                                B
                                             
                                             
                                                P
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              
                                 (
                                 
                                    
                                       
                                          E
                                          [
                                          
                                             
                                                v
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          n
                                          )
                                          ]
                                       
                                    
                                    
                                       
                                          E
                                          [
                                          
                                             
                                                v
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          n
                                          )
                                          ]
                                       
                                    
                                    
                                       
                                          ⋮
                                       
                                    
                                    
                                       
                                          E
                                          [
                                          
                                             
                                                v
                                             
                                             
                                                P
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          n
                                          )
                                          ]
                                       
                                    
                                 
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          μ
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          μ
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          ⋮
                                       
                                    
                                    
                                       
                                          μ
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                 
                                 )
                              
                              +
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                μ
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                μ
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          ⋮
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      P
                                                   
                                                
                                                (
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            P
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                         
                                                            P
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                μ
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      P
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                      The system can be solved for the P blocks, which leads to the same expression of the variance, i.e., ∀i:
                        
                           (73)
                           
                              E
                              
                                 [
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              =
                              
                                 
                                    μ
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    2
                                    −
                                    μ
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          P
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          P
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    2
                                    −
                                    μ
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          P
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    2
                                    μ
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              .
                           
                        
                      Finally, substituting (73) into (70) gives
                        
                           
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 P
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              E
                              
                                 [
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              =
                              
                                 
                                    μ
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          P
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    2
                                    −
                                    μ
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          P
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          P
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          P
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          j
                                       
                                    
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    2
                                    −
                                    μ
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          P
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          P
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    2
                                    μ
                                 
                              
                              ,
                              
                              ∀
                              i
                              .
                           
                        
                      The above equation can be simplified to
                        
                           (74)
                           
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 P
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              E
                              
                                 [
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              =
                              
                                 
                                    μ
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          P
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    2
                                    −
                                    μ
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          P
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          P
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    μ
                                    (
                                    2
                                    −
                                    μ
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          P
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              .
                           
                        
                      Then, substituting (74) into (70) leads to the expression of the asymptotic SNIR expressed in (47).

@&#REFERENCES@&#

