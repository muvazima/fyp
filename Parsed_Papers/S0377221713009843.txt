@&#MAIN-TITLE@&#Pricing exotic derivatives exploiting structure

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We deal with exotic derivatives when the discrete monitoring is considered.


                        
                        
                           
                           We prove that, in the classical quadrature recursive approach, the structure of the sampling matrix is strongly clustered.


                        
                        
                           
                           We show how the cluster property allows us to improve the performance of the recursive approach.


                        
                        
                           
                           We show numerical results considering the CEV process.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

CEV process

Discrete monitoring

Exotic derivatives

Matrix Factorization

Numerical quadrature

Option pricing

@&#ABSTRACT@&#


               
               
                  In this paper we introduce a new fast and accurate numerical method for pricing exotic derivatives when discrete monitoring occurs, and the underlying evolves according to a Markov one-dimensional stochastic processes. The approach exploits the structure of the matrix arising from the numerical quadrature of the pricing backward formulas to devise a convenient factorization that helps greatly in the speed-up of the recursion. The algorithm is general and is examined in detail with reference to the CEV (Constant Elasticity of Variance) process for pricing different exotic derivatives, such as Asian, barrier, Bermudan, lookback and step options for which up to date no efficient procedures are available. Extensive numerical experiments confirm the theoretical results. The MATLAB code used to perform the computation is available online at http://www1.mate.polimi.it/∼marazzina/BP.htm.
               
            

@&#INTRODUCTION@&#

Over the years exotic options, such as Asian, barrier, and lookback contracts, have become more and more popular in equity markets and raised the attention in the academic research. Most of the articles in this literature price these contracts assuming a continuous monitoring, i.e., the payoff is triggered by events occurring continuously before expiry. Under this assumption, the option can often be priced in closed form. However, many real exotic contracts specify discrete monitoring instants, such as daily or weekly, see for example (Becker & Wystup, 2009) for a detailed description of the real market functioning of foreign exchange discrete barrier options. On the other hand, analytical formulae are available only when the underlying evolves according to a geometric Brownian motion (GBM) process and barrier and lookback options are considered, see (Fusai, Abrahams, & Sgarra, 2006), whilst other path-dependent options, such as Asian, do not admit closed form pricing formula. In addition, as at first noticed in Broadie, Glasserman, and Kou (1997), there can be substantial differences between discrete and continuous monitoring prices, even under very frequent monitoring. In fact, given the complexity of financial models and option contracts used in practice, we need a numerical method able to calibrate plain vanilla options, and at the same time price and hedge in a fast and accurate way exotic derivatives, such as the ones considered in this paper. As discussed in Bouzoubaa and Osseiran (2010), errors in computing sensitivities replacing the discrete feature with the continuous one (or a different discrete one) can cause large damages in the dynamic hedging strategy. As an example, in Fig. 1
                      we show how the Deltas of exotic contracts (barrier, Bermudan, Asian and lookback) vary according to different discrete monitoring features: with the exception of the Asian call, where the Deltas are very similar, for all the other contracts different monitoring features result in significant differences in Deltas, and thus in very different replicating portfolios. This problem is illustrated in detail in Castagna (2009): the author considers a market maker who is short a reverse knock-out option with a short time to maturity and the underlying spot price is around the barrier level and between two fixings dates, it is not possible to take the unequivocal decision whether to completely unwind the Delta-hedge. This uncertainty generates the so-called slippage cost that can be quite significant, and motivates the search for a fast and accurate algorithm for pricing the above mentioned contracts.

The discrete monitoring feature here considered is also relevant in real option application, for which the management decision making to continue or to abandon the project is determined on the basis of accounting reports published periodically. An interesting application using additive processes is given by Alexander, Mengija, and Stent (2012).

The discretely monitoring pricing procedure for exotic options is based on the standard backward recursion: at each monitoring date the option price is updated by taking the expectation of the derivative price at the previous date and checking if the underlying satisfies the monitoring condition. For example, in a down-and-out barrier option we set to zero the option value if the corresponding underlying price falls below the barrier. A possible numerical implementation consists of computing the nested (iterated) expectation via a recursive numerical quadrature (integration), as shown for example in Andricopoulos, Widdicks, Duck, and Newton (2003), Fusai and Recchioni (2007). This approach allows us to move directly from one date to the following one without any intermediate time discretization. In contrast lattice and finite difference or element methods are affected by errors due to the time discretization between monitoring dates. A considerable speed-up in the recursion can be obtained when the underlying asset evolves according to an exponential Lévy model. In this case the iterated expectation is a convolution between the transition density and the contract price at the previous monitoring date. The convolution can be computed efficiently via Fourier transform and exploiting the Fast Fourier Transform (FFT) algorithm: at each monitoring date we apply a Fourier transform-convolution-Fourier inversion, see for example (Fusai & Recchioni, 2007; Fusai, Marazzina, Marena, & Ng, 2012; Lord, Fang, Bervoets, & Oosterlee, 2008) and references therein. In this case, the computational cost is linear in the number of monitoring dates and of order 
                        
                           m
                           log
                           (
                           m
                           )
                        
                      with respect to the number of discretization points m of the quadrature scheme. However the convolution structure of the transition density is due to the independent and identically distributed (i.i.d.) assumption on log-price increments. Unfortunately, if this assumption does not hold, the numerical integration becomes computational intensive with a cost proportional to 
                        
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                        
                     .

Therefore the main contribution of the present paper is to devise an efficient algorithm to price discretely monitored options previously described exploiting the structure of the probability transition density of the underlying asset and of its sampling matrix when log-price increments are not i.i.d. and the FFT algorithm cannot be used. More precisely, we introduce the concept of cluster of eigenvalues of a sequence of matrices arising from the numerical quadrature of the backward recursion as we increase the number of nodes m. We formally prove (Theorem 3) that the number of significant eigenvalues (i.e., larger than a fixed tolerance 
                        
                           ∊
                        
                     ) is approaching a constant 
                        
                           
                              
                                 r
                              
                              
                                 ∊
                              
                           
                        
                      independent of 
                        
                           m
                           ,
                           
                              
                                 r
                              
                              
                                 ∊
                              
                           
                           ≪
                           m
                        
                     , as we take larger values of m. This result can be exploited to factorize the iteration matrix, giving a computational cost of 
                        
                           O
                           (
                           
                              
                                 k
                              
                              
                                 ∊
                              
                           
                           m
                           )
                        
                      operations, 
                        
                           
                              
                                 k
                              
                              
                                 ∊
                              
                           
                           ≈
                           
                              
                                 r
                              
                              
                                 ∊
                              
                           
                        
                     , for the matrix–vector multiplication, instead of the standard 
                        
                           O
                           (
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           )
                        
                     . Given that the cost of the factorization is nearly independent on the number of monitoring dates, the advantage of our approach will be the greatest, greater the number of monitoring dates. The algorithm is general in the sense that it can be applied to stochastic processes for which the transition density is known in closed form. However, to make concrete our analysis, we examine it in detail with reference to the Constant Elasticity of Variance (CEV) model, introduced by Cox (1996), Cox and Ross (1976). This dynamics is interesting allowing for very different transition densities and implied volatility shapes. Very few option pricing models yield fully analytical results, and most require numerical evaluations. The CEV model is not an exception. Numerical methods for pricing derivatives under the CEV process are presented, for example, in Boyle and Tian (1999), Boyle, Tian, and Imai (1999), Costabile (2006), Peng (2006). All the mentioned articles refer to the continuous monitoring case and do not admit a simple implementation for exotic derivatives, whilst our approach can easily deal with a variety of path-dependent options.

Our algorithm is suitable to fast and accurate computation of prices and sensitivities of discretely monitored path-dependent options and therefore makes a real novel contribution for pricing real life contracts, see (Becker & Wystup, 2009), and risk-management decision making, (Castagna, 2009). For this reason our research is relevant to the methodology of operational research and to the practice of decision making. From the methodological point of view, we would like also to stress that the proposed factorization has potential and immediate applications to the study of properties of discrete time Markov Chains as well, a very important topic in operational research for modeling queuing sequences and many other practical systems, see (Norris, 1997).

To confirm the efficiency of the proposed methodology, theoretical results are proved in appendix, and extensive numerical experiments are conducted to compare the accuracy and the computational cost of our algorithm with respect to a standard backward recursive quadrature and to Monte Carlo simulation. In particular, numerical experiments confirm that the greatest benefits are achieved for a large number of monitoring dates.

The structure of the paper is as follows. First of all, Section 2 introduces the general setup to price exotic derivatives with the discrete monitoring feature. Section 3 deals with the quadrature approach to solve the recursive pricing formulas, and we introduce the factorization idea, based on the structure of the pricing matrix. Finally, in Section 4 we validate the pricing procedure with numerical results assuming a CEV dynamics for the underlying. Accuracy and computational cost of our pricing algorithm are compared with the above mentioned benchmarks, i.e., the classical quadrature approach and Monte Carlo simulation. Theoretical results supporting the proposed methodology are provided in appendix.

Let us consider a derivative contract with a payoff 
                        
                           ϕ
                           
                              
                                 
                                    ·
                                 
                              
                           
                        
                      at maturity 
                        
                           T
                           =
                           N
                           Δ
                        
                     , where N is the number of 
                        
                           Δ
                        
                     -equally spaced monitoring dates, and let S be the underlying asset price. The standard backward procedure computes the derivative price 
                        
                           V
                           (
                           S
                           ,
                           n
                           )
                        
                      at time 
                        
                           n
                           Δ
                        
                      through the following recursion (eventually with a modification to deal with the early exercise feature):
                        
                           (1)
                           
                              V
                              
                                 
                                    
                                       S
                                       ,
                                       n
                                    
                                 
                              
                              =
                              
                                 
                                    e
                                 
                                 
                                    -
                                    r
                                    Δ
                                 
                              
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              p
                              
                                 
                                    
                                       S
                                       ,
                                       ξ
                                       ;
                                       Δ
                                    
                                 
                              
                              V
                              
                                 
                                    
                                       ξ
                                       ,
                                       n
                                       +
                                       1
                                    
                                 
                              
                              d
                              ξ
                              ,
                              
                              n
                              =
                              N
                              -
                              1
                              ,
                              …
                              ,
                              0
                              ,
                           
                        
                     where r is the risk-free rate, and 
                        
                           p
                           
                              
                                 
                                    S
                                    ,
                                    ξ
                                    ;
                                    Δ
                                 
                              
                           
                        
                      is the transition density from S at time t to 
                        
                           ξ
                        
                      at time 
                        
                           t
                           +
                           Δ
                        
                     . 
                        
                           Ω
                        
                      refers to the integration domain and can vary depending on the trigger event. The above recursion starts with the payoff condition at maturity 
                        
                           V
                           (
                           S
                           ,
                           N
                           )
                           =
                           ϕ
                           (
                           S
                           )
                        
                     . We are interested in computing 
                        
                           V
                           (
                           
                              
                                 S
                              
                              
                                 0
                              
                           
                           ,
                           0
                           )
                           ,
                           
                              
                                 S
                              
                              
                                 0
                              
                           
                        
                      being the current spot price.

In the following subsections, we show how the above framework fits different exotic contracts.

If we deal with barrier options, the pricing recursion (1) starts from the payoff function 
                           
                              ϕ
                              (
                              S
                              )
                              ≔
                              
                                 
                                    (
                                    φ
                                    (
                                    S
                                    -
                                    E
                                    )
                                    )
                                 
                                 
                                    +
                                 
                              
                           
                        , where E is the strike price and 
                           
                              φ
                           
                         is a binary variables taking value 1 for calls, and −1 for puts. If we denote with 
                           
                              L
                              
                              (
                              U
                              )
                           
                         the lower (upper) barrier, the domain 
                           
                              Ω
                           
                         is 
                           
                              (
                              L
                              ,
                              +
                              ∞
                              )
                           
                         for down-and-out, 
                           
                              (
                              L
                              ,
                              U
                              )
                           
                         for knock-and-out, and 
                           
                              (
                              0
                              ,
                              U
                              )
                           
                         for up-and-out barrier options.

For numerical purposes, the integration interval in (1) is truncated to 
                           
                              (
                              L
                              ,
                              U
                              )
                           
                         – for down-and-out options – or 
                           
                              (
                              L
                              ,
                              U
                              )
                           
                         – for up-and-out options – with 
                           
                              L
                              <
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                           
                         (
                           
                              U
                              >
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                           
                        ). The truncation is chosen such that the probability of moving from 
                           
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                           
                         to 
                           
                              L
                           
                         (
                           
                              U
                           
                        ) is less than a preassigned tolerance.

A Bermudan option gives the holder the right to early exercise at each monitoring date. This option is worth more than the corresponding European version, but less than the American counterparty, for which the exercise occurs continuously. To take into account the early exercise possibility we modify (1) into:
                           
                              (2)
                              
                                 V
                                 
                                    
                                       
                                          S
                                          ,
                                          n
                                       
                                    
                                 
                                 =
                                 max
                                 
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                -
                                                r
                                                Δ
                                             
                                          
                                          
                                             ∫
                                             
                                                Ω
                                             
                                          
                                          p
                                          
                                             
                                                
                                                   S
                                                   ,
                                                   ξ
                                                   ;
                                                   Δ
                                                
                                             
                                          
                                          V
                                          
                                             
                                                
                                                   ξ
                                                   ,
                                                   n
                                                   +
                                                   1
                                                
                                             
                                          
                                          d
                                          ξ
                                          ,
                                          
                                          ϕ
                                          (
                                          S
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                 n
                                 =
                                 N
                                 -
                                 1
                                 ,
                                 …
                                 ,
                                 0
                                 ,
                              
                           
                        with 
                           
                              Ω
                              =
                              (
                              0
                              ,
                              +
                              ∞
                              )
                           
                         for standard Bermudan options. If we have Bermudan contracts with a barrier trigger, then 
                           
                              Ω
                              =
                              (
                              L
                              ,
                              +
                              ∞
                              )
                              ,
                              
                              Ω
                              =
                              (
                              0
                              ,
                              U
                              )
                           
                         or 
                           
                              Ω
                              =
                              (
                              L
                              ,
                              U
                              )
                           
                        . Payoff function and domain truncation are as in Section 2.1.

The maturity settlement of lookback options is based on the minimum or the maximum value of the underlying asset as registered during the lifetime of the option. At maturity, the holder can “look-back” and select the most favorable figure of the underlying as occurring at the monitoring dates. If we let 
                           
                              S
                              (
                              n
                              Δ
                              )
                           
                         to be the asset price at the nth monitoring date, we can define the discretely observed minimum price as
                           
                              
                                 
                                    
                                       J
                                    
                                    
                                       n
                                    
                                 
                                 ≔
                                 
                                    min
                                 
                                 {
                                 S
                                 (
                                 0
                                 )
                                 ,
                                 …
                                 ,
                                 S
                                 (
                                 n
                                 Δ
                                 )
                                 }
                                 .
                              
                           
                        The payoff function of a fixed-strike lookback on the minimum is given by 
                           
                              
                                 
                                    
                                       
                                          E
                                          -
                                          
                                             
                                                J
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                           
                        . The lookback option price at time 
                           
                              n
                              Δ
                           
                         depends on the underlying asset price S, and on the up-to-date minimum 
                           
                              
                                 
                                    J
                                 
                                 
                                    n
                                 
                              
                              =
                              J
                           
                         and we denote it by 
                           
                              V
                              (
                              S
                              ,
                              J
                              ,
                              n
                              )
                           
                        . Clearly it must be 
                           
                              J
                              ⩽
                              S
                           
                        . Similar considerations hold for payoffs written on the maximum.

Respect to the GBM dynamics, where a change of numeraire argument reduces the number of state variables, under a more general process specification we must keep track of both state variables, underlying price and running minimum. Given that 
                           
                              
                                 
                                    J
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              min
                              {
                              
                                 
                                    J
                                 
                                 
                                    n
                                 
                              
                              ,
                              S
                              (
                              (
                              n
                              +
                              1
                              )
                              Δ
                              )
                              }
                           
                        , the backward recursion becomes 
                           
                              V
                              (
                              S
                              ,
                              J
                              ,
                              N
                              )
                              =
                              
                                 
                                    
                                       
                                          φ
                                          
                                             
                                                
                                                   J
                                                   -
                                                   E
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                           
                         and for 
                           
                              n
                              =
                              N
                              -
                              1
                              ,
                              …
                              ,
                              0
                           
                        
                        
                           
                              (3)
                              
                                 V
                                 (
                                 S
                                 ,
                                 J
                                 ,
                                 n
                                 )
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       r
                                       Δ
                                    
                                 
                                 
                                    ∫
                                    
                                       0
                                    
                                    
                                       +
                                       ∞
                                    
                                 
                                 p
                                 (
                                 S
                                 ,
                                 ξ
                                 ;
                                 Δ
                                 )
                                 V
                                 (
                                 ξ
                                 ,
                                 
                                    min
                                 
                                 {
                                 J
                                 ,
                                 ξ
                                 }
                                 ,
                                 n
                                 +
                                 1
                                 )
                                 d
                                 ξ
                                 ,
                              
                           
                        
                        S being greater or equal to J. Here 
                           
                              min
                              {
                              J
                              ,
                              ξ
                              }
                           
                         is the minimum value of the underlying asset at the 
                           
                              (
                              n
                              +
                              1
                              )
                           
                        th monitoring date given that 
                           
                              
                                 
                                    J
                                 
                                 
                                    n
                                 
                              
                              =
                              J
                           
                         and 
                           
                              S
                              (
                              (
                              n
                              +
                              1
                              )
                              Δ
                              )
                              =
                              ξ
                           
                        . The initial option price is then given by 
                           
                              V
                              (
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                              ,
                              0
                              )
                           
                        .

Asian options are a very popular type of exotic derivative. Such as for lookback options, their pricing requires the introduction of a new state variable, i.e., the (arithmetic) average up to time 
                           
                              n
                              Δ
                           
                        
                        
                           
                              
                                 
                                    
                                       A
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                       
                                    
                                 
                                 S
                                 (
                                 n
                                 Δ
                                 )
                                 .
                              
                           
                        
                     

The arithmetic average follows the updating rule
                           
                              
                                 
                                    
                                       A
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       n
                                       +
                                       2
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       n
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       n
                                       +
                                       2
                                    
                                 
                                 S
                                 (
                                 (
                                 n
                                 +
                                 1
                                 )
                                 Δ
                                 )
                                 ,
                              
                           
                        so that the price of the arithmetic fixed-strike Asian option satisfies the following backward recursion:
                           
                              (4)
                              
                                 V
                                 (
                                 S
                                 ,
                                 A
                                 ,
                                 n
                                 )
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       r
                                       Δ
                                    
                                 
                                 
                                    ∫
                                    
                                       0
                                    
                                    
                                       +
                                       ∞
                                    
                                 
                                 p
                                 (
                                 S
                                 ,
                                 ξ
                                 ;
                                 Δ
                                 )
                                 V
                                 
                                    
                                       
                                          ξ
                                          ,
                                          
                                             
                                                n
                                                +
                                                1
                                             
                                             
                                                n
                                                +
                                                2
                                             
                                          
                                          A
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                n
                                                +
                                                2
                                             
                                          
                                          ξ
                                          ,
                                          n
                                          +
                                          1
                                       
                                    
                                 
                                 d
                                 ξ
                                 ,
                              
                           
                        for 
                           
                              n
                              =
                              N
                              -
                              1
                              ,
                              …
                              ,
                              0
                           
                        , with 
                           
                              V
                              (
                              S
                              ,
                              A
                              ,
                              N
                              )
                              =
                              
                                 
                                    (
                                    φ
                                    (
                                    A
                                    -
                                    E
                                    )
                                    )
                                 
                                 
                                    +
                                 
                              
                           
                        .

Step options are similar to barrier options, but the knock-and-out feature operates only gradually. To this aim we define the occupation time 
                           
                              
                                 
                                    I
                                 
                                 
                                    n
                                 
                              
                           
                         of the subset 
                           
                              I
                              ,
                              I
                              ⊂
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                              
                           
                        ,
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       {
                                       S
                                       (
                                       i
                                       Δ
                                       )
                                       ∈
                                       I
                                       }
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    1
                                 
                                 
                                    {
                                    S
                                    (
                                    i
                                    Δ
                                    )
                                    ∈
                                    I
                                    }
                                 
                              
                           
                         is the indicator function, i.e., it is equal to 1 if 
                           
                              S
                              (
                              i
                              Δ
                              )
                              ∈
                              I
                           
                        , 0 otherwise. Notice that 
                           
                              
                                 
                                    I
                                 
                                 
                                    n
                                 
                              
                           
                         measures the time spent by the underlying asset in the set 
                           
                              I
                           
                         up to time 
                           
                              n
                              Δ
                           
                        . 
                           
                              
                                 
                                    I
                                 
                                 
                                    n
                                 
                              
                           
                         takes values in 
                           
                              {
                              0
                              ,
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              }
                           
                         and satisfies the updating rule 
                           
                              
                                 
                                    I
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    I
                                 
                                 
                                    n
                                 
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    {
                                    S
                                    (
                                    (
                                    n
                                    +
                                    1
                                    )
                                    Δ
                                    )
                                    ∈
                                    I
                                    }
                                 
                              
                           
                        .

Given 
                           
                              S
                              (
                              N
                              Δ
                              )
                              =
                              S
                           
                         and 
                           
                              
                                 
                                    I
                                 
                                 
                                    N
                                 
                              
                              =
                              I
                           
                        , the payoff of a step option with principal amortization below the barrier is
                           
                              
                                 V
                                 (
                                 S
                                 ,
                                 I
                                 ,
                                 N
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   ρ
                                                
                                                
                                                   N
                                                
                                             
                                             I
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 
                                    
                                       (
                                       φ
                                       (
                                       S
                                       -
                                       E
                                       )
                                       )
                                    
                                    
                                       +
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              ρ
                           
                         is the knock-out killing rate. The introduction of the knock-out range has the advantage of regularize the barrier option by making the price and the delta continuous at the barrier, see for example (Linetsky, 1999). The price recursion for step options reads as: for 
                           
                              n
                              =
                              N
                              -
                              1
                              ,
                              …
                              ,
                              0
                           
                        
                        
                           
                              
                                 V
                                 (
                                 S
                                 ,
                                 I
                                 ,
                                 n
                                 )
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       r
                                       Δ
                                    
                                 
                                 
                                    ∫
                                    
                                       0
                                    
                                    
                                       +
                                       ∞
                                    
                                 
                                 p
                                 (
                                 S
                                 ,
                                 ξ
                                 ;
                                 Δ
                                 )
                                 V
                                 
                                    
                                       
                                          ξ
                                          ,
                                          I
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                {
                                                ξ
                                                ∈
                                                I
                                                }
                                             
                                          
                                          ,
                                          n
                                          +
                                          1
                                       
                                    
                                 
                                 d
                                 ξ
                                 .
                              
                           
                        We also refer to (Cai, Chen, & Wan, 2010) for further details.

As shown in the previous section, the general pricing framework requires the numerical computation of the following recursive integral equation
                        
                           (5)
                           
                              W
                              (
                              x
                              ,
                              n
                              )
                              =
                              
                                 ∫
                                 
                                    a
                                 
                                 
                                    b
                                 
                              
                              H
                              (
                              x
                              ,
                              y
                              ;
                              Δ
                              )
                              W
                              (
                              y
                              ,
                              n
                              +
                              1
                              )
                              dy
                              ,
                              
                              
                              
                              ∀
                              
                              x
                              ∈
                              (
                              a
                              ,
                              b
                              )
                              ,
                           
                        
                     for 
                        
                           n
                           =
                           N
                           -
                           1
                           ,
                           …
                           ,
                           0
                        
                     , with 
                        
                           W
                           (
                           x
                           ,
                           N
                           )
                        
                      assigned. This recursion holds for European and barrier options. Bermudan options also require an early exercise clause.

If we have more than one state variable (such as for lookback, Asian and step derivatives), the function W depends on the time index n and on two state variables, so that we write 
                        
                           W
                           (
                           x
                           ,
                           ·
                           ,
                           n
                           )
                        
                     . The additional state variable is the minimum value J if lookback options are considered, the average value A for Asian contracts and the occupation time I for step options.

If we apply a quadrature formula to (5), with nodes 
                        
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                        
                      and weights 
                        
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           ,
                           i
                           =
                           0
                           ,
                           …
                           ,
                           m
                           -
                           1
                        
                     , we obtain
                        
                           (6)
                           
                              W
                              (
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              ,
                              n
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       0
                                    
                                    
                                       m
                                       -
                                       1
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    j
                                 
                              
                              H
                              (
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                              ;
                              Δ
                              )
                              W
                              (
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                              ,
                              n
                              +
                              1
                              )
                              .
                           
                        
                     If we define the matrix 
                        
                           
                              
                                 H
                              
                              
                                 m
                              
                           
                        
                      as 
                        
                           
                              
                                 H
                              
                              
                                 m
                              
                           
                           =
                           
                              
                                 
                                    
                                       H
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       Δ
                                       )
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                                 =
                                 0
                              
                              
                                 m
                                 -
                                 1
                              
                           
                        
                     , then (6) can be written as
                        
                           (7)
                           
                              
                                 
                                    W
                                 
                                 
                                    n
                                 
                              
                              =
                              
                                 
                                    H
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    W
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              ,
                              
                              
                              
                              n
                              =
                              N
                              -
                              1
                              ,
                              …
                              ,
                              0
                              ,
                           
                        
                     where 
                        
                           
                              
                                 W
                              
                              
                                 n
                              
                           
                           =
                           
                              
                                 [
                                 W
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 n
                                 )
                                 ]
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 m
                                 -
                                 1
                              
                           
                        
                     , and 
                        
                           
                              
                                 D
                              
                              
                                 m
                              
                           
                           =
                           diag
                           (
                           
                              
                                 w
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 w
                              
                              
                                 m
                                 -
                                 1
                              
                           
                           )
                        
                     . The matrix 
                        
                           
                              
                                 H
                              
                              
                                 m
                              
                           
                        
                      is called the sampling matrix of the function H, while 
                        
                           
                              
                                 H
                              
                              
                                 m
                              
                           
                           
                              
                                 D
                              
                              
                                 m
                              
                           
                        
                      is the iteration matrix of the backward procedure (in the following we omit the subscripts to lighten the notation). Due to additional contractual features, such as early exercise, lookback or time averages, the recursion in (7) needs additional changes. In particular, the iteration matrix is the same for European, Bermudan, Asian, lookback and step options. The knock-out trigger event in barrier options generates a different structure of the domain 
                        
                           Ω
                        
                      and thus of the iteration matrix. This is discussed in Appendix A.

In the recursion (7) the size of the iteration matrix equals the number of discretization points (nodes). It is well-known that increasing the number of nodes improves the accuracy of the solution. More precisely, the speed of convergence of the quadrature error to zero can be determined by using results on the speed of convergence of the integration rule when it is applied to the integral 
                        
                           
                              ∫
                              
                                 Ω
                              
                           
                           H
                           (
                           ·
                           ,
                           ξ
                           ;
                           Δ
                           )
                           d
                           ξ
                        
                     , as discussed in Atkinson (2009, Chapter 4). In this setting the backward recursion (7) has a cost proportional to 
                        
                           N
                           
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                        
                      operations.

Our aim is to reduce this cost substantially by exploiting the spectral properties of the iteration matrix 
                        
                           HD
                        
                     , analyzed in details in Appendix B, as the matrix size m grows. In fact, in the present context, the iteration matrix has two interesting properties: (1) its eigenvalues are clustered at zero, i.e., only a small number of non-negligible eigenvalues can be retained, and (2) it is close, within a prefixed tolerance, to a banded matrix. Given these properties, the main idea is at first to replace the iteration matrix by its factorization 
                        
                           
                              
                                 PJQ
                              
                              
                                 H
                              
                           
                        
                     , where 
                        
                           P
                        
                      and 
                        
                           Q
                        
                      are unitary matrices, 
                        
                           
                              
                                 Q
                              
                              
                                 H
                              
                           
                        
                      is the hermitian of matrix 
                        
                           Q
                        
                     , and 
                        
                           J
                        
                      is a bidiagonal matrix.
                        1
                        For the sake of completeness, we recall that the hermitian matrix of a matrix 
                              
                                 Q
                              
                            is its transpose conjugate, and 
                              
                                 Q
                              
                            is unitary if and only if 
                              
                                 
                                    
                                       QQ
                                    
                                    
                                       H
                                    
                                 
                              
                            is the identity matrix.
                     
                     
                        1
                      The factorization gives a relevant computational advantage in performing the matrix–vector multiplications required at each step of the backward procedure. The factorization, performed via the bidiagonalization algorithm of Golub and Kahan (1965), is very fast given the clustering property of the eigenvalues of the iteration matrix. In fact, as proved in Appendix B.2, the number 
                        
                           
                              
                                 r
                              
                              
                                 ∊
                              
                           
                        
                      of eigenvalues greater than a fixed tolerance 
                        
                           ∊
                        
                      is small with respect to the size m of the given matrix (usually, in applications, we use matrices of size at most 
                        
                           4000
                           ×
                           4000
                        
                     ). To grasp the idea, if we consider an Asian option with 252 monitoring dates, and we let m to grow from 1000 to 4000, 
                        
                           
                              
                                 r
                              
                              
                                 ∊
                              
                           
                        
                      remains constant at 412 (this will be throughly discussed in the numerical section part).

Secondly, due to the fact that the matrix 
                        
                           HD
                        
                      is obtained by the discretization of a transition probability density, it turns out to be ‘nearly’ banded: the significant entries having values larger than a prefixed tolerance are confined to a diagonal band. The banded behavior is illustrated by the coloured part of the iteration matrix in Fig. 2
                     . Therefore we can exploit the banded structure by “breaking into pieces” the matrix 
                        
                           HD
                        
                      as shown in the same figure. In practice, we factorize separately each piece via the bidiagonalization algorithm. This is possible because each sub piece of the sampling matrix 
                        
                           HD
                        
                      inherits its cluster property, so that it is convenient to perform the factorization on matrices of a smaller size. This makes the procedure even faster (especially when the size of the original matrix is very large). It is clear that a too large band leads to consider “pieces of matrix” having a large size, so that we do not achieve any benefit from the suggested breakdown procedure. In this case, the standard quadrature will remain the preferred approach. However, if a band structure is detected, once each piece is factorized we can calculate the matrix–vector product as shown in Fig. 2: the original matrix (top left corner of Fig. 2) is “broken” into smaller pieces (top right corner of Fig. 2). Then each piece is factorized using the Golub-Reinsch algorithm (bottom left corner of Fig. 2) and the matrix–vector product is computed exploiting the Householder or bidiagonal structure of the matrices involved. Finally the resulting vectors are “summed up” taking into account the overlapping parts.

In conclusion, the combination of the clustering and bandwidth properties allows us to reduce the computational cost of the pricing procedure, thanks to the factorization, which can be performed in a fast way due to the spectral properties above mentioned. More precisely, since in the recursive quadrature Eq. (7) we have to compute N matrix–vector products, the classical approach requires 
                        
                           O
                           (
                           
                              
                                 Nm
                              
                              
                                 2
                              
                           
                           )
                        
                      operations against 
                        
                           O
                           (
                           
                              
                                 k
                              
                              
                                 ∊
                              
                           
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 Nk
                              
                              
                                 ∊
                              
                           
                           m
                           )
                        
                      operations, being 
                        
                           O
                           (
                           
                              
                                 k
                              
                              
                                 ∊
                              
                           
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           )
                        
                      (
                        
                           O
                           (
                           
                              
                                 k
                              
                              
                                 ∊
                              
                           
                           m
                           )
                        
                     ) the cost of the factorization (matrix–vector multiplication). In practice 
                        
                           
                              
                                 k
                              
                              
                                 ∊
                              
                           
                           ≈
                           
                              
                                 r
                              
                              
                                 ∊
                              
                           
                        
                     , and we have a cost reduction if 
                        
                           
                              
                                 r
                              
                              
                                 ∊
                              
                           
                           <
                           mN
                           /
                           (
                           N
                           +
                           m
                           )
                        
                     . In particular, as the number of monitoring dates increases, the cost reduction is effective if 
                        
                           
                              
                                 r
                              
                              
                                 ∊
                              
                           
                           <
                           m
                        
                     , that, in general, it is always the case for the examples here considered, such as the previously mentioned Asian option contract. Using the proposed “Breaking into pieces” algorithm, it is thus possible even to achieve a larger time reduction exploiting the structure of the matrix 
                        
                           HD
                        
                     , since the factorization and the matrix–vector products are computed considering the smaller submatrices and not the whole (large) iteration matrix, as shown in Fig. 2. The idea here described find a theoretical support in Appendix B.

In this section we validate with numerical experiments the ideas put forward in the previous section (theoretical results are in the appendix). The setup is absolutely general but for aim of clarity we consider the CEV process. This dynamics is indeed quite interesting allowing for very different transition densities and implied volatility shapes. For this reason, we describe it in some detail in Section 4.1. Then in Section 4.2 we show that the matrix 
                        
                           HD
                        
                      obtained by the discretization of the CEV transition density exhibits eigenvalues strongly clustered at zero: if we increase the size (number of quadrature points) of the matrix, the number of eigenvalues greater than a given tolerance remains constant. Thus the CEV process admits the cluster property that allows us to improve the performance of the recursive approach. Finally, in Section 4.3 we apply our algorithm (hereafter denominated BP algorithm) to “break into pieces” the matrix 
                        
                           HD
                        
                      and we apply it to price exotic derivatives. This algorithm is detailed with a pseudo-code in the electronic supplementary material.
                  

For the numerical discretization of (5) we opt for a Gauss–Legendre quadrature (Quarteroni, Sacco, & Saleri, 2000). Numerical experiments not reported here have shown that the cluster of eigenvalues of the iteration matrix is independent of the adopted quadrature formulas, but the bandwidth of the matrix is larger for Gaussian quadrature respect to Newton–Cotes ones. However the results are similar, in terms of computational efficiency, for both classes of quadrature formulas.

All calculations were performed using Matlab R2008a on a PC Intel Core2 Quad 2.40GHz with 3.24GB RAM and Windows XP operating system.

Even if our algorithm is quite general, from now on, we assume that the underlying asset evolves according to a CEV process (Cox, 1996), i.e.,
                           
                              (8)
                              
                                 dS
                                 (
                                 t
                                 )
                                 =
                                 rS
                                 (
                                 t
                                 )
                                 dt
                                 +
                                 σ
                                 
                                    
                                       S
                                    
                                    
                                       β
                                       +
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 dW
                                 (
                                 t
                                 )
                                 ,
                                 
                                 
                                 
                                 S
                                 (
                                 0
                                 )
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       0
                                    
                                 
                                 ,
                              
                           
                        and thus the transition probability density is given by
                           
                              
                                 p
                                 
                                    
                                       
                                          S
                                          ,
                                          ξ
                                          ;
                                          Δ
                                       
                                    
                                 
                                 ≔
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       r
                                       Δ
                                    
                                 
                                 
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       
                                          S
                                          ,
                                          
                                          
                                             
                                                e
                                             
                                             
                                                -
                                                r
                                                Δ
                                             
                                          
                                          ξ
                                          ;
                                          
                                          
                                             
                                                1
                                             
                                             
                                                2
                                                r
                                                β
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         2
                                                         r
                                                         β
                                                         Δ
                                                      
                                                   
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        with
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       
                                          S
                                          ,
                                          ξ
                                          ;
                                          Δ
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             -
                                             2
                                             β
                                             -
                                             
                                                
                                                   3
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             S
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       |
                                       β
                                       |
                                       Δ
                                    
                                 
                                 
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   -
                                                   2
                                                   β
                                                
                                             
                                             +
                                             
                                                
                                                   ξ
                                                
                                                
                                                   -
                                                   2
                                                   β
                                                
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   σ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   β
                                                
                                                
                                                   2
                                                
                                             
                                             Δ
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       I
                                    
                                    
                                       
                                          
                                             1
                                          
                                          
                                             2
                                             |
                                             β
                                             |
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      -
                                                      β
                                                   
                                                
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      -
                                                      β
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      2
                                                   
                                                
                                                Δ
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    I
                                 
                                 
                                    ν
                                 
                              
                           
                         is the modified Bessel function of the first kind of order 
                           
                              ν
                           
                        . In particular, when 
                           
                              β
                              =
                              0
                           
                         we have the classical geometric Brownian process (GBM), when 
                           
                              β
                              =
                              -
                              1
                           
                         we have an arithmetic Brownian motion (ABM), while when 
                           
                              β
                              =
                              -
                              0.5
                           
                         the Cox-Ingersoll-Ross square-root process (SR) is obtained. For details see also (Cox, 1996; Davydov & Linetsky, 2001; Fusai & Recchioni, 2007). In Fig. 3
                         we plot the density function for different values of the leverage parameter 
                           
                              β
                           
                         (left panel) and the corresponding implied volatility curve (right panel). In particular, large negative values of 
                           
                              β
                           
                         generate a skewed to the left density function and a very steep implied volatility curve, as often observed in the market. The CEV process, consistently with empirical studies, allows for the volatility to depend on the price level and in addition the two are negatively correlated (leverage effect); moreover, the model is able to generate the smirk effect often observed in the market implied volatility curve. See for example (Boyle & Tian, 1999; Costabile, 2006). Unfortunately, the transition density of the CEV process is not of convolution type, thus a fast computation of the recursion via the FFT is not feasible. For these reasons, the CEV dynamics turns out to be an interesting case to test our pricing procedure.

Numerical methods for pricing derivatives under the CEV process are presented, for example, in Boyle and Tian (1999), Boyle et al. (1999), Costabile (2006), Peng (2006). These articles price derivatives contracts, like barrier (Boyle & Tian, 1999), lookback (Boyle & Tian, 1999; Boyle et al., 1999; Costabile, 2006) and geometric Asian (Peng, 2006) options, assuming continuous monitoring and using a lattice approach, i.e., binomial or trinomial trees. In general, if we consider a non-Gaussian diffusion process, the diffusion coefficient is not constant and it is not possible to construct a recombining tree in the usual way. Therefore, the price process is transformed into another process having a constant diffusion coefficient, and the tree is built for the transformed process. In this case, advanced technique, like the adaptive averaging binomial method presented in Moon and Kim (2013) are available. Unfortunately, this procedure is reliable only for barrier options. For example, results in Boyle and Tian (1999) for lookback options are not accurate. To cope with this problem, in Costabile (2006) the author proposes a forward induction procedure that allows to compute the risk-neutral probability of each different payoff of the lookback option at maturity but with a computational cost that is cubic in the number of time step against the linear cost of the recursive quadrature. In addition, by using trees, we have slow and erratic convergence to the true price largely caused by the position of the barrier relative to the adjacent stock prices, see the theoretical results in Lin and Palmer (2013) with reference to the GBM dynamics. We can have large errors even with thousands of time steps and millions of node calculations. American options are considered in Nunes (2009), where the author proposes an alternative characterization of the early exercise premium that is valid for any Markovian and diffusive underlying price process. However, the author does not consider Bermudan options, for which early exercise can occur only on discrete dates. Finally, an analytical Laplace transform approach based on the scale function of a diffusion process is pursued in Davydov and Linetsky (2001). These authors obtain Laplace transform of barrier and lookback option prices involving Whittaker and Bessel functions of complex argument. Option prices are then obtained via a numerical inversion of the Laplace transform. Unfortunately, the procedure is quite computational intensive mainly for lookback options: this problem requires the numerical computation of an integral involving the inverse Laplace transform.

Unless otherwise specified, we consider the same parameter setting as in Davydov and Linetsky (2001): the initial asset price is 
                           
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                              =
                              100
                           
                        , the risk-free interest rate is 
                           
                              10
                              %
                           
                         per annum (
                           
                              r
                              =
                              0.1
                           
                        ), the volatility is 
                           
                              σ
                              =
                              0.25
                              /
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                                 
                                    β
                                 
                              
                           
                        . Moreover, we assume that the asset pays no dividends (
                           
                              q
                              =
                              0
                           
                        ), and all options have six months to expiration (
                           
                              T
                              =
                              0.5
                           
                        ). If necessary, we truncate the integration interval as stated in Section 2.1 with a 
                           
                              
                                 
                                    10
                                 
                                 
                                    -
                                    8
                                 
                              
                           
                         tolerance.


                        Table 1
                         provides the number of eigenvalues greater, in absolute value, than 
                           
                              ∊
                              =
                              
                                 
                                    10
                                 
                                 
                                    -
                                    11
                                 
                              
                           
                         and the bandwidth size 
                           
                              
                                 
                                    b
                                 
                                 
                                    top
                                 
                              
                           
                         of the matrix 
                           
                              HD
                           
                        , see Fig. 2. The bandwidth size is fixed setting to zero the elements smaller, in absolute value, than 
                           
                              
                                 
                                    10
                                 
                                 
                                    -
                                    9
                                 
                              
                           
                        . The leverage parameter 
                           
                              β
                           
                         in the CEV model is set equal to 
                           
                              -
                              0.5
                           
                         (results for different values of 
                           
                              β
                           
                         are reported in the electronic supplementary material). We stress that this table refers to pricing problems characterized by a different iteration matrix. We notice that:
                           
                              •
                              a strong cluster at zero always occurs. For example, let us consider down-and-out options in Table 1, given a number of monitoring dates 
                                    
                                       N
                                       =
                                       52
                                    
                                 . The number of significative eigenvalues (greater than 
                                    
                                       ∊
                                    
                                 ) is 107, independently of the matrix dimension m;

the cluster increases less than linearly with respect to the number of monitoring dates N. Thus our algorithm will achieve a large time reduction when N is large. In fact, we see in Table 1 that, given m, as the number of monitoring dates increases, the same happens to the number of eigenvalues greater than 
                                    
                                       ∊
                                    
                                 , but the ratio 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             ∊
                                          
                                       
                                       /
                                       N
                                    
                                  decreases;

the presence of barriers strongly improves the cluster. This is evident if we compare the double barrier case in Table 1 to other contracts. In particular this suggests a relative better performance of the algorithm in pricing this kind of exotics;

changing the value of the leverage parameter 
                                    
                                       β
                                    
                                  in the CEV density does not affect the cluster. This is shown in the electronic supplementary material.

We can also make some additional considerations on the bandwidth of the matrix:
                           
                              •
                              we always have banded matrices; for example in Table 1 for European, lookback, Asian or step options with 
                                    
                                       N
                                       =
                                       52
                                    
                                  and 
                                    
                                       m
                                       =
                                       4000
                                    
                                 , the bandwidth size is 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             top
                                          
                                       
                                       =
                                       493
                                    
                                 . However, the presence of barriers increases 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             top
                                          
                                       
                                    
                                 . Indeed barriers cut the tails of the density so that we have to sample a function that does not approach zero on the frontier of the domain. In general, the ratio 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             top
                                          
                                       
                                       /
                                       m
                                    
                                  remains constant as m varies.

the bandwidth size decreases as we increase the number N of monitoring dates; this is, for example, confirmed for all contracts in Table 1 when 
                                    
                                       m
                                       =
                                       4000
                                    
                                  and we let N to vary from 52 to 1008;

Since the performance of the algorithm is optimized when the cluster size 
                           
                              
                                 
                                    r
                                 
                                 
                                    ∊
                                 
                              
                           
                         and the bandwidth size 
                           
                              
                                 
                                    b
                                 
                                 
                                    top
                                 
                              
                           
                         are both small, the above remarks suggest that this happens in all cases and the greatest benefit occurs as we increase N.

In Table 2
                         we show the speed-up for different contracts. Here the speed-up is defined as the ratio between the CPU time for the classical recursive (Rec.) algorithm and the one for our pricing procedure (Rec.+BP). As expected, the speed-up is always greater than 1. Double barrier options are the exception when the number of monitoring dates is small, due to a too large bandwidth. 
                     

In this section we validate our pricing procedure comparing it to standard numerical quadrature and to Monte Carlo simulation. This has been implemented with an Euler discretization scheme with 300 steps between two consecutive monitoring dates, and 1,000,000 runs. In general Monte Carlo simulations applied to the CEV process achieve a two digits accuracy, but with a CPU time that turns to be higher than the recursive quadrature of a factor that varies from 4 to 10.
                           2
                           We also considered an exact Monte Carlo simulation by sampling from the known transition cumulative density function, but the procedure turns out to be too time consuming and of no practical relevance.
                        
                        
                           2
                         Extended numerical results are reported in the electronic supplementary material.

In Tables 4,5
                           
                            we price European and barrier call options. Analytical formulas for European options are available in terms of the non-central chi-square distribution, see (Schroder, 1989). Prices of continuously monitored barrier options, i.e., 
                              
                                 N
                                 =
                                 ∞
                              
                           , are given in Davydov and Linetsky (2001) and reported here in Table 3.

Since European options are path-independent contracts, their pricing requires a single recursion. For this reason, in Table 4 we set 
                              
                                 N
                                 =
                                 1
                              
                            and the BP algorithm is not at all convenient because the factorization is too costly with respect to a single matrix–vector multiplication. However the algorithm has the same accuracy as the analytical formula: our price estimates agree with those of the first row of Table 3.

Numerical results for barrier options with 
                              
                                 β
                                 =
                                 -
                                 0.5
                              
                            are given in Table 5. Prices for different values of 
                              
                                 β
                              
                            and for up-and-out options are reported in the electronic supplementary material. We notice that:
                              
                                 •
                                 prices computed with the BP algorithm agree with the ones from the pure recursion up to five decimal digits;

as expected, the BP algorithm performs better as we increase the number of monitoring dates N, since the factorization has to be performed only once, and, at the same time, the bandwidth decreases (see Table 1 – we recall that our algorithm performs well if the bandwidth size is not too large). In fact, from Table 5 we notice the benefits of the BP factorization for 
                                       
                                          N
                                          =
                                          252
                                       
                                     or greater;

the algorithm works better as we increase the number of quadrature nodes m, since the cluster size 
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ∊
                                             
                                          
                                       
                                     does not increase varying m, while the computational cost of the matrix–vector multiplication increases;

for double barrier options we observe that, increasing N, we have a trade-off between the cluster size (it improves) and the bandwidth size (it becomes larger). On this point we can make two remarks:
                                       
                                          1.
                                          In general, our algorithm improves the standard recursion for N larger than 252. Additional numerical tests have shown that the algorithm applied to the double barrier case can achieve a speed-up up to 3.6 when 
                                                
                                                   N
                                                   =
                                                   10
                                                   ,
                                                   000
                                                
                                             .

Numerical results in Table 2 show that the BP algorithm performs better for single barrier respect to double barrier options if N is lower than 1008.

concerning the convergence of the discrete monitoring price to the continuous monitoring case, we notice a slow convergence from above of prices in Table 5 to the ones in Table 3. For example, when 
                                       
                                          β
                                          =
                                          -
                                          0.5
                                       
                                     and 
                                       
                                          N
                                          =
                                          10
                                          ,
                                          000
                                       
                                    , a single barrier option with discrete monitoring is worth 6.2756, whilst the continuous version is 6.2554. Moreover, comparing the two tables, it is clear that pricing a discrete monitoring contracts with a continuous monitoring algorithm could result in a substantial different, and thus wrong, price. As an example, considering 
                                       
                                          β
                                          =
                                          -
                                          0.5
                                       
                                     and assuming to price a twice-a-day monitoring double barrier option, i.e., 
                                       
                                          N
                                          =
                                          52
                                       
                                    , the real price, i.e., the one computed considering the real monitoring is 0.7710, while the one computed assuming the continuous monitoring is 0.5126. Thus the importance of considering numerical algorithms with discrete monitoring, when contracts with this feature have to be priced.

Experiments not reported here show similar performances for Bermudan options. The results are not affected by the presence or absence of dividends.

Pricing lookback options is in general more expensive than pricing barrier options, because we have to keep trace of an additional state variable, the running minimum J. Thus, we expect an increase in the CPU time with respect to barrier and Bermudan option. However, since the matrix factorization is independent on the J-grid nodes, we still expect an improvement with respect to the standard recursion. Results reported in Table 6
                            confirm this. In addition the two recursive algorithms show comparable accuracy. Table 7
                            provides, as benchmark, confidence intervals computed by the Monte Carlo algorithm. An additional speed-up can be obtained considering less nodes on the J-grid, up to ten times if we reduce by a factor of four the nodes on the J-grid (
                              
                                 ω
                                 =
                                 4
                              
                            in the mentioned table), maintaining a two decimal digits accuracy.

Asian options (see Section 2.4) share with lookback options the presence of an additional state variable. Given that the iteration matrix is the same for the two contracts, we expect a similar performance of the algorithm in the Asian as in the lookback case. Results are given in Table 8
                           , and comments given in Section 4.3.2 still apply. For example, if we set 
                              
                                 ω
                                 =
                                 4
                              
                           , we reduce the CPU time by a factor of seven, still maintaining a two decimal digits accuracy. Reported option prices always fall into the Monte Carlo confidence intervals (see Table 9
                           ).

Finally, in Table 10
                            we consider the log-normal process (
                              
                                 β
                                 =
                                 0
                              
                           ). In this case, indeed, it is more efficient to use a FFT approach, as in Černý and Kyriakou (2011), or a randomization technique, as in Fusai, Marazzina, and Marena (2011). We use the results in Černý and Kyriakou (2011, Table 7) as benchmark. In Table 10 we also analyze the effect on the price accuracy of the truncation of the integration interval (see Section 2.1). The Rec.+BP algorithm always achieves a three to five decimal digits accuracy depending on the tolerance level when we truncate the domain. Significant reduction in the CPU time, without loss of accuracy, can be achieved with a sparser grid (
                              
                                 ω
                                 =
                                 2
                              
                            and 
                              
                                 ω
                                 =
                                 4
                              
                           ) on the running average.

Numerical results given in Table 11
                            show that our algorithm applied to step options achieves the same accuracy as the direct recursive procedure: they agree up to the sixth digit, but with a strong reduction in the computational time. Thus, also for this kind of contracts the Rec.+BP algorithm is more efficient than the plain recursion and Monte Carlo simulation.

@&#CONCLUSION@&#

In this paper we have shown how to price exotic options when discrete monitoring is considered exploiting the structure of the matrix arising from the numerical quadrature of the pricing backward formulas. This has been accomplished through a convenient factorization of the iteration matrix that helps greatly in the speed-up of the recursion. The proposed BP algorithm is general and is examined in detail with reference to the CEV process, for which, according to our knowledge, no efficient and general enough procedure is available in literature, and to discretely monitored option.

Our numerical experiments show that the BP algorithm performs well respect to the standard recursive quadrature for all considered exotic options (barrier, lookback, Asian, Bermudan and step options), mainly when the number of monitoring dates is large: they have a similar accuracy, but our scheme is considerably faster. In addition, we show how to accelerate the scheme for both lookback and Asian options, losing a little bit of accuracy.

We would like to stress that, according to our knowledge, this article is the first one investigating a fast and accurate algorithm for pricing exotic options when the discrete monitoring is assumed and a CEV process (or, more generally, processes for which the log-price is not i.i.d.) is considered. Finally the proposed factorization has potential and immediate applications to the study of properties of discrete time Markov Chains as well, a very important topic in operational research for modeling queuing sequences and many other practical systems, see (Norris, 1997). Extension to other processes, as normal mixture distribution, see (Bhat & Kumar, 2012), and options with multiple risk factors, such as stochastic volatility models or multi-assets contracts, as in Breton and de Frutos (2010), Jin, Li, Tan, and Wu (2013), Rambeerich, Tangman, Lollchund, and Bhuruth (2013), are also amenable to the presented technique, and will be treated in a follow-up paper.

In the following we detail how the quadrature applies to different contractual settings.

For barrier options, i.e., recursions (1) and (2), we have 
                           
                              W
                              (
                              x
                              ,
                              N
                              )
                              =
                              ϕ
                              (
                              x
                              )
                              ,
                              H
                              (
                              x
                              ,
                              y
                              ;
                              Δ
                              )
                              =
                              
                                 
                                    e
                                 
                                 
                                    -
                                    r
                                    Δ
                                 
                              
                              p
                              (
                              x
                              ,
                              y
                              ;
                              Δ
                              )
                           
                        , and 
                           
                              a
                              ,
                              
                              b
                           
                         depend on the domain 
                           
                              Ω
                           
                        . For example, for down-and-out barrier options, we set 
                           
                              a
                              =
                              L
                           
                         and 
                           
                              b
                              =
                              U
                           
                        . From the discretization of (1), we obtain a recursion of the form (7) with 
                           
                              
                                 
                                    W
                                 
                                 
                                    N
                                 
                              
                              =
                              
                                 
                                    [
                                    ϕ
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ]
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    m
                                    -
                                    1
                                 
                              
                           
                        .

If Bermudan options are considered, we have 
                           
                              W
                              (
                              x
                              ,
                              N
                              )
                              ,
                              H
                              (
                              x
                              ,
                              y
                              ;
                              Δ
                              )
                           
                        , and 
                           
                              a
                              ,
                              
                              b
                           
                         as above. From the discretization of (2) we obtain
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         n
                                                      
                                                      
                                                         CV
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         n
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   =
                                                   max
                                                   {
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         n
                                                      
                                                      
                                                         CV
                                                      
                                                   
                                                   ,
                                                   Φ
                                                   }
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    W
                                 
                                 
                                    CV
                                 
                              
                           
                         is the continuation value, and 
                           
                              Φ
                              =
                              
                                 
                                    [
                                    ϕ
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ]
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    m
                                    -
                                    1
                                 
                              
                              =
                              
                                 
                                    W
                                 
                                 
                                    N
                                 
                              
                           
                        .

If fixed-strike lookback put options are considered, we set 
                           
                              H
                              (
                              x
                              ,
                              y
                              ;
                              Δ
                              )
                              =
                              
                                 
                                    e
                                 
                                 
                                    -
                                    r
                                    Δ
                                 
                              
                              p
                              (
                              x
                              ,
                              y
                              ;
                              Δ
                              )
                              ,
                              a
                              =
                              0
                           
                         and 
                           
                              b
                              =
                              +
                              ∞
                           
                         (truncated to 
                           
                              L
                           
                         and 
                           
                              U
                           
                         for numerical valuation). Thus the semi-discrete formulation of (3) is
                           
                              
                                 W
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 J
                                 ,
                                 n
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          =
                                          0
                                       
                                       
                                          m
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       l
                                    
                                 
                                 H
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       l
                                    
                                 
                                 ;
                                 Δ
                                 )
                                 W
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 
                                    min
                                 
                                 {
                                 J
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       l
                                    
                                 
                                 }
                                 ,
                                 n
                                 +
                                 1
                                 )
                                 ,
                              
                           
                        
                        
                           
                              i
                              =
                              0
                              ,
                              …
                              ,
                              m
                              -
                              1
                           
                        , with 
                           
                              W
                              (
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              ,
                              J
                              ,
                              N
                              )
                              =
                              
                                 
                                    (
                                    E
                                    -
                                    min
                                    {
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    J
                                    }
                                    )
                                 
                                 
                                    +
                                 
                              
                           
                        . Since J is the minimum value of the underlying asset, we discretize J on the same grid 
                           
                              
                                 
                                    {
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    m
                                    -
                                    1
                                 
                              
                           
                         used for the underlying asset. More precisely, we can implement recursion (3) as follows: considering m quadrature nodes 
                           
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                           
                         and weights 
                           
                              
                                 
                                    w
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                              j
                              =
                              0
                              ,
                              …
                              ,
                              m
                              -
                              1
                           
                        , we define for 
                           
                              n
                              =
                              N
                              -
                              1
                              ,
                              …
                              ,
                              0
                           
                         the vectors
                           
                              
                                 
                                    
                                       W
                                    
                                    
                                       n
                                    
                                    
                                       j
                                    
                                 
                                 ≔
                                 
                                    
                                       [
                                       W
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       n
                                       )
                                       ]
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       m
                                       -
                                       1
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       n
                                    
                                    
                                       j
                                    
                                 
                                 ≔
                                 
                                    
                                       [
                                       W
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          min
                                       
                                       {
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             j
                                          
                                       
                                       }
                                       ,
                                       n
                                       )
                                       ]
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       m
                                       -
                                       1
                                    
                                 
                                 ,
                              
                           
                        with 
                           
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    N
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    [
                                    
                                       
                                          (
                                          E
                                          -
                                          min
                                          {
                                          
                                             
                                                s
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                j
                                             
                                          
                                          }
                                          )
                                       
                                       
                                          +
                                       
                                    
                                    ]
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    m
                                    -
                                    1
                                 
                              
                           
                        .

The fully-discretized lookback recursion (3) is: for 
                           
                              n
                              =
                              N
                              -
                              1
                              ,
                              …
                              ,
                              0
                           
                        
                        
                           
                              
                                 
                                    
                                       W
                                    
                                    
                                       n
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       H
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       j
                                    
                                 
                                 ,
                              
                           
                        with 
                           
                              
                                 
                                    D
                                 
                                 
                                    m
                                 
                              
                           
                         and 
                           
                              
                                 
                                    H
                                 
                                 
                                    m
                                 
                              
                           
                         defined as above. Notice that 
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          n
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                    i
                                 
                              
                           
                         corresponds to 
                           
                              W
                              (
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                              ,
                              n
                              )
                           
                         (and thus to 
                           
                              
                                 
                                    (
                                    
                                       
                                          W
                                       
                                       
                                          n
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                    i
                                 
                              
                           
                        ) only if 
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              ⩾
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                           
                        , and thus 
                           
                              i
                              ⩾
                              j
                           
                        . Thus, moving from 
                           
                              
                                 
                                    W
                                 
                                 
                                    n
                                 
                                 
                                    j
                                 
                              
                           
                         to 
                           
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    n
                                 
                                 
                                    j
                                 
                              
                           
                        , an update of the minimum value is necessary for the indices i such that 
                           
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                              >
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                           
                        . This implies that the pricing recursion can be written as: for 
                           
                              n
                              =
                              N
                              -
                              1
                              ,
                              …
                              ,
                              0
                           
                         and 
                           
                              j
                              =
                              0
                              ,
                              …
                              ,
                              m
                              -
                              1
                           
                        ,
                           
                              (A.1)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         n
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               W
                                                            
                                                            
                                                               ^
                                                            
                                                         
                                                      
                                                      
                                                         n
                                                         +
                                                         1
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   
                                                   Recursion
                                                   
                                                   Step
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     W
                                                                  
                                                                  
                                                                     ^
                                                                  
                                                               
                                                            
                                                            
                                                               n
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           (
                                                                           
                                                                              
                                                                                 W
                                                                              
                                                                              
                                                                                 n
                                                                              
                                                                              
                                                                                 j
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     if
                                                                     
                                                                     i
                                                                     ⩾
                                                                     j
                                                                     ,
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           (
                                                                           
                                                                              
                                                                                 W
                                                                              
                                                                              
                                                                                 n
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     if
                                                                     
                                                                     i
                                                                     <
                                                                     j
                                                                     ,
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                   Updating
                                                   
                                                   Step
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           Remark 1
                           The iteration (A.1) can be accelerated using a subset 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ∼
                                       
                                    
                                 
                               of 
                                 
                                    m
                                    /
                                    ω
                                 
                               quadrature nodes, i.e., for 
                                 
                                    n
                                    =
                                    N
                                    -
                                    1
                                    ,
                                    …
                                    ,
                                    0
                                 
                              , for 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          ω
                                       
                                    
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    m
                                    /
                                    ω
                                    -
                                    1
                                 
                              , being 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                W
                                             
                                             
                                                n
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      ω
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    W
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                ω
                                             
                                          
                                       
                                    
                                    ,
                                    n
                                    )
                                 
                              , it holds
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               W
                                                            
                                                            
                                                               n
                                                            
                                                            
                                                               
                                                                  
                                                                     j
                                                                  
                                                                  
                                                                     ω
                                                                  
                                                               
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               H
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     W
                                                                  
                                                                  
                                                                     ^
                                                                  
                                                               
                                                            
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     j
                                                                  
                                                                  
                                                                     ω
                                                                  
                                                               
                                                            
                                                         
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        
                                                                           W
                                                                        
                                                                        
                                                                           ^
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           j
                                                                        
                                                                        
                                                                           ω
                                                                        
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 (
                                                                                 
                                                                                    
                                                                                       W
                                                                                    
                                                                                    
                                                                                       n
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             j
                                                                                          
                                                                                          
                                                                                             ω
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                                 )
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           if
                                                                           
                                                                           i
                                                                           ⩾
                                                                           
                                                                              
                                                                                 j
                                                                              
                                                                              
                                                                                 ω
                                                                              
                                                                           
                                                                           ,
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 (
                                                                                 
                                                                                    
                                                                                       W
                                                                                    
                                                                                    
                                                                                       n
                                                                                    
                                                                                    
                                                                                       i
                                                                                    
                                                                                 
                                                                                 )
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           if
                                                                           
                                                                           i
                                                                           <
                                                                           
                                                                              
                                                                                 j
                                                                              
                                                                              
                                                                                 ω
                                                                              
                                                                           
                                                                           ,
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              where the element 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                W
                                             
                                             
                                                n
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          i
                                       
                                    
                                 
                               is computed by cubic interpolation if the node 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                 
                               do not belong to the subgrid 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ∼
                                       
                                    
                                 
                              .

For Asian options, at each step the possible new values of the state variable A do not fall on the A-grid at the previous step. Therefore an interpolation is also required at each iteration. More precisely, the semi-discrete formulation of (4) is: for 
                           
                              i
                              =
                              0
                              ,
                              …
                              ,
                              m
                              -
                              1
                           
                        
                        
                           
                              
                                 W
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 A
                                 ,
                                 n
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          =
                                          0
                                       
                                       
                                          m
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       l
                                    
                                 
                                 H
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       l
                                    
                                 
                                 ;
                                 Δ
                                 )
                                 W
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                l
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                n
                                                +
                                                1
                                             
                                             
                                                n
                                                +
                                                2
                                             
                                          
                                          A
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                n
                                                +
                                                2
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                l
                                             
                                          
                                          ,
                                          
                                          n
                                          +
                                          1
                                       
                                    
                                 
                                 .
                              
                           
                        To obtain the fully-discrete formulation, we define for 
                           
                              j
                              =
                              0
                              ,
                              …
                              ,
                              m
                              -
                              1
                           
                        
                        
                           
                              
                                 
                                    
                                       W
                                    
                                    
                                       n
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             W
                                             
                                                
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ,
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       m
                                       -
                                       1
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             W
                                             
                                                
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            n
                                                            +
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            n
                                                            +
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       m
                                       -
                                       1
                                    
                                 
                                 .
                              
                           
                        Thus the discretization of (4) can be written as: for 
                           
                              n
                              =
                              N
                              -
                              1
                              ,
                              …
                              ,
                              0
                           
                        , given 
                           
                              
                                 
                                    W
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 
                                    j
                                 
                              
                           
                        , compute 
                           
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    n
                                 
                                 
                                    j
                                 
                              
                           
                         exploiting cubic interpolation, and then set
                           
                              
                                 
                                    
                                       W
                                    
                                    
                                       n
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       H
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       j
                                    
                                 
                                 .
                              
                           
                        Again, as stated in Remark 1, we can assume that the average falls on a subset 
                           
                              
                                 
                                    s
                                 
                                 
                                    ∼
                                 
                              
                           
                         of 
                           
                              m
                              /
                              ω
                           
                         quadrature nodes, i.e., 
                           
                              
                                 
                                    W
                                 
                                 
                                    n
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          ω
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          W
                                          
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         
                                                            
                                                               j
                                                            
                                                            
                                                               ω
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    m
                                    -
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    j
                                 
                                 
                                    ω
                                 
                              
                              =
                              0
                              ,
                              …
                              ,
                              
                              
                                 
                                    m
                                 
                                 
                                    ω
                                 
                              
                              -
                              1
                           
                        .

Finally, for step derivatives, 
                           
                              
                                 
                                    I
                                 
                                 
                                    n
                                 
                              
                           
                         can only assume the 
                           
                              n
                              +
                              1
                           
                         values 
                           
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              n
                           
                        . The payoff is discretized according to
                           
                              
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       N
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      -
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               j
                                                               +
                                                               
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     {
                                                                     
                                                                        
                                                                           s
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                     ∈
                                                                     I
                                                                     }
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         φ
                                                         (
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         -
                                                         E
                                                         )
                                                      
                                                   
                                                
                                                
                                                   +
                                                
                                             
                                          
                                       
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       m
                                       -
                                       1
                                    
                                 
                                 ,
                                 
                                 j
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 N
                                 -
                                 1
                                 .
                              
                           
                        Then, for 
                           
                              n
                              =
                              N
                              -
                              1
                              ,
                              …
                              ,
                              0
                           
                        , we compute
                           
                              
                                 
                                    
                                       W
                                    
                                    
                                       n
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       H
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                 j
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                              
                           
                        and then, if 
                           
                              n
                              >
                              0
                           
                        , we construct 
                           
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    n
                                 
                                 
                                    j
                                 
                              
                           
                         as follows: for 
                           
                              i
                              =
                              0
                              ,
                              …
                              ,
                              m
                              -
                              1
                           
                        , for 
                           
                              j
                              =
                              0
                              ,
                              …
                              ,
                              n
                              -
                              1
                           
                        , if 
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              
                              ∉
                              
                              I
                           
                        , then 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                n
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                n
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                        , otherwise 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                n
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                n
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                        .

In this section, we analyze the spectral properties of the matrix 
                        
                           HD
                        
                     . These properties allow us to factorize 
                        
                           HD
                        
                      by using the bidiagonalization algorithm of Golub and Kahan (1965). For this purpose, at first we define the cluster point of eigenvalues of a sequence of matrices of increasing dimension (that can be obtained, for example, by increasing the number of nodes in the quadrature formula (7)). This means to analyze the asymptotic behavior of eigenvalues of a sequence of matrices, and to show that, in our case, they cluster around zero. In particular, the number 
                        
                           
                              
                                 r
                              
                              
                                 ∊
                              
                           
                        
                      of eigenvalues greater than a fixed tolerance 
                        
                           ∊
                        
                      remains constant as we increase the number of quadrature nodes. Therefore the factorization of the matrix 
                        
                           HD
                        
                      into the product 
                        
                           
                              
                                 PJQ
                              
                              
                                 H
                              
                           
                        
                      returns a bidiagonal matrix 
                        
                           J
                        
                      having as non-zero elements only the first 
                        
                           
                              
                                 k
                              
                              
                                 ∊
                              
                           
                        
                      elements, 
                        
                           
                              
                                 k
                              
                              
                                 ∊
                              
                           
                           ≈
                           
                              
                                 r
                              
                              
                                 ∊
                              
                           
                        
                     , on the main and on the upper diagonals. This means that it is not necessary to perform the full factorization 
                        
                           
                              
                                 PJQ
                              
                              
                                 H
                              
                           
                        
                     , but we can stop at the 
                        
                           
                              
                                 k
                              
                              
                                 ∊
                              
                           
                        
                     th step. If 
                        
                           
                              
                                 k
                              
                              
                                 ∊
                              
                           
                        
                      is much smaller than m, where m is the dimension of the matrix, this implies a significant reduction in the computational cost. Furthermore, the particular “composition” of matrices 
                        
                           P
                        
                      and 
                        
                           Q
                        
                      allows us to compute the matrix–vector multiplication in 
                        
                           O
                           (
                           
                              
                                 k
                              
                              
                                 ∊
                              
                           
                           m
                           )
                        
                      operations instead of the 
                        
                           O
                           (
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           )
                        
                      characterizing the standard recursive approach.

In this section we give the main definitions and theorems related to the spectral properties of sequences of matrices that satisfy certain conditions.

In the following, we denote with 
                           
                              {
                              
                                 
                                    A
                                 
                                 
                                    m
                                 
                              
                              }
                              =
                              
                                 
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                    }
                                 
                                 
                                    m
                                    =
                                    1
                                 
                                 
                                    ∞
                                 
                              
                           
                         a sequence of matrices in 
                           
                              
                                 
                                    C
                                 
                                 
                                    m
                                    ×
                                    m
                                 
                              
                           
                         joined by a structural content that remains unchanged when the size varies. For brevity, we will denote the sequence simply by 
                           
                              {
                              
                                 
                                    A
                                 
                                 
                                    m
                                 
                              
                              }
                           
                         and we use the symbols 
                           
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                                 
                                    (
                                    m
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    j
                                 
                                 
                                    (
                                    m
                                    )
                                 
                              
                              ,
                              
                              j
                              =
                              1
                              ,
                              …
                              ,
                              m
                           
                        , to denote, respectively, the eigenvalues and the singular values of 
                           
                              
                                 
                                    A
                                 
                                 
                                    m
                                 
                              
                           
                        .

A property of the spectrum of a sequence of matrices is its cluster point.
                           Definition 1
                           
                              Tyrtyshnikov (1996)
                           


                           A matrix sequence 
                                 
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                    }
                                 
                               is strongly clustered at 
                              
                                 
                                    s
                                    ∈
                                    C
                                 
                               (in the eigenvalue sense), if for any 
                                 
                                    ε
                                    >
                                    0
                                 
                               the number of the eigenvalues of 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                 
                               off the disc 
                                 
                                    D
                                    (
                                    s
                                    ,
                                    ε
                                    )
                                    ≔
                                    {
                                    z
                                    :
                                    |
                                    z
                                    -
                                    s
                                    |
                                    <
                                    ε
                                    }
                                 
                               can be bounded by a pure constant 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          ε
                                       
                                    
                                 
                               possibly depending on 
                                 
                                    ε
                                 
                              , but not on m. In other words
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ε
                                          
                                       
                                       (
                                       m
                                       ,
                                       s
                                       )
                                       ≔
                                       #
                                       {
                                       j
                                       :
                                       
                                          
                                             λ
                                          
                                          
                                             j
                                          
                                          
                                             (
                                             m
                                             )
                                          
                                       
                                       
                                       ∉
                                       
                                       D
                                       (
                                       s
                                       ,
                                       ε
                                       )
                                       }
                                       =
                                       O
                                       (
                                       1
                                       )
                                       ,
                                       
                                       m
                                       →
                                       ∞
                                       .
                                    
                                 
                              
                           

If every 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                 
                               has only real eigenvalues (at least for large m) then we may assume that s is real and that the disc 
                                 
                                    D
                                    (
                                    s
                                    ,
                                    ε
                                    )
                                 
                               is the interval 
                                 
                                    (
                                    s
                                    -
                                    ε
                                    ,
                                    s
                                    +
                                    ε
                                    )
                                 
                              . We replace the term “strongly” by “weakly”, if 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          ε
                                       
                                    
                                    (
                                    m
                                    ,
                                    s
                                    )
                                    =
                                    o
                                    (
                                    m
                                    )
                                 
                              , when 
                                 
                                    m
                                    →
                                    ∞
                                 
                              . Similar definitions hold if we replace the term eigenvalues with singular values.

A sufficient condition under which a sequence of matrices is strongly clustered is given in the following theorem.
                           Theorem 1
                           
                              Serra Capizzano, Bertaccini, and Golub (2005, Theorem 1.2)
                           


                           
                              Let 
                              
                                 
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                    }
                                 
                               
                              be a sequence of matrices of strictly increasing dimension (
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                    ∈
                                    
                                       
                                          C
                                       
                                       
                                          m
                                          ×
                                          m
                                       
                                    
                                 
                              
                              ) with eigenvalues 
                              
                                 
                                    |
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                    |
                                    ⩾
                                    |
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                    |
                                    ⩾
                                    ⋯
                                    ⩾
                                    |
                                    
                                       
                                          λ
                                       
                                       
                                          m
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                    |
                                 
                               
                              and singular values 
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                    ⩾
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                    ⩾
                                    ⋯
                                    ⩾
                                    
                                       
                                          σ
                                       
                                       
                                          m
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                 
                              
                              . If
                              
                                 
                                    - there exist a number 
                                       
                                          
                                             N
                                             >
                                             0
                                          
                                       
                                       , independent of m, such that 
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   1
                                                
                                                
                                                   (
                                                   m
                                                   )
                                                
                                             
                                             =
                                             ‖
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                             
                                             
                                                
                                                   ‖
                                                
                                                
                                                   2
                                                
                                             
                                             ⩽
                                             N
                                          
                                       
                                       , that is 
                                       
                                          
                                             {
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                             
                                             }
                                          
                                        
                                       is a sequence uniformly bounded;
                                    

- the sequence 
                                       
                                          
                                             {
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                             
                                             }
                                          
                                        
                                       is strongly clustered at 0 in the singular value sense, that is, following 
                                       
                                          Definition 1
                                       , 
                                       
                                          
                                             ∀
                                             ∊
                                             >
                                             0
                                             
                                             ∃
                                             
                                             C
                                             =
                                             
                                                
                                                   C
                                                
                                                
                                                   ∊
                                                
                                             
                                          
                                        
                                       independent of m such that 
                                       
                                          
                                             #
                                             {
                                             j
                                             :
                                             
                                                
                                                   σ
                                                
                                                
                                                   j
                                                
                                                
                                                   (
                                                   m
                                                   )
                                                
                                             
                                             >
                                             ∊
                                             }
                                             ⩽
                                             
                                                
                                                   C
                                                
                                                
                                                   ∊
                                                
                                             
                                          
                                       
                                       , uniformly 
                                       
                                          
                                             ∀
                                             m
                                          
                                       
                                       ;
                                    

The following lemma gives us a sufficient condition under which a sequence of matrices is strongly clustered at zero.
                           Lemma 2
                           
                              Let 
                              
                                 
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                    }
                                 
                               
                              be a sequence of matrices (
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                    ∈
                                    
                                       
                                          C
                                       
                                       
                                          m
                                          ×
                                          m
                                       
                                    
                                 
                              
                              ), if 
                              
                                 
                                    ∃
                                    N
                                    >
                                    0
                                 
                              
                              , independent of m, such that 
                              
                                 
                                    ‖
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          F
                                       
                                    
                                    ⩽
                                    N
                                 
                              
                              , where 
                              
                                 
                                    ‖
                                    ·
                                    
                                       
                                          ‖
                                       
                                       
                                          F
                                       
                                    
                                 
                               
                              is the Frobenius norm, then the sequence 
                              
                                 
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                    }
                                 
                               
                              is strongly clustered at zero in the singular value and eigenvalue sense.
                           

For the singular value cluster see (Serra Capizzano, 2001, Section 4, Corollary 4.1, point 2, with B
                                 
                                    n
                                 =0). For the cluster of the eigenvalues, if 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                    ⩾
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                    ⩾
                                    ⋯
                                    ⩾
                                    
                                       
                                          σ
                                       
                                       
                                          m
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                 
                               are the singular values of 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    [
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          m
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                    ]
                                 
                              , we observe that 
                                 
                                    N
                                    ⩾
                                    ‖
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          F
                                       
                                    
                                    =
                                    ‖
                                    
                                       
                                          σ
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                    ⩾
                                    ‖
                                    
                                       
                                          σ
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          ∞
                                       
                                    
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                    =
                                    ‖
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                 
                              , then we are under the hypotheses of Theorem 1 and we can conclude that the sequence 
                                 
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                    }
                                 
                               is strongly clustered at zero in the sense of the eigenvalues. □

We conclude this section with our main result on the clustering of sequences of matrices that arise from discretization of integrals of functions in two variables.
                           Theorem 3
                           
                              Let us define 
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          K
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          D
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                              , where 
                              
                                 
                                    
                                       
                                          K
                                       
                                       
                                          m
                                       
                                    
                                 
                               
                              is the sampling matrix of a continuous function 
                              
                                 
                                    k
                                    ,
                                    k
                                    (
                                    ·
                                    ,
                                    ·
                                    )
                                    :
                                    Ω
                                    ×
                                    Ω
                                    →
                                    R
                                    ,
                                    
                                    Ω
                                    ⊂
                                    
                                       
                                          R
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                    
                                    d
                                    ⩾
                                    1
                                    ,
                                    
                                    Ω
                                 
                               
                              closed and bounded, and 
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    diag
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          w
                                       
                                       
                                          m
                                          -
                                          1
                                       
                                    
                                    )
                                 
                               
                              is the diagonal matrix with the weights of the quadrature formula 
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              . Then the sequence 
                              
                                 
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                    }
                                 
                               
                              is strongly clustered at zero in the singular value and eigenvalue sense.
                           

We consider the Frobenius norm of the matrix 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          m
                                       
                                    
                                 
                              :
                                 
                                    
                                       ‖
                                       
                                          
                                             A
                                          
                                          
                                             m
                                          
                                       
                                       
                                          
                                             ‖
                                          
                                          
                                             F
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ,
                                                j
                                                =
                                                0
                                             
                                             
                                                m
                                             
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   A
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ,
                                                j
                                                =
                                                0
                                             
                                             
                                                m
                                             
                                          
                                       
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       ih
                                       ,
                                       jh
                                       )
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          ∫
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       dxdy
                                       +
                                       
                                          
                                             ∊
                                          
                                          
                                             m
                                          
                                       
                                       ⩽
                                       C
                                       ,
                                    
                                 
                              
                           

where C is a constant which depends on 
                                 
                                    Ω
                                 
                               and the smoothness of the function k, and 
                                 
                                    
                                       
                                          ∊
                                       
                                       
                                          m
                                       
                                    
                                 
                               is the error of the quadrature formula which approaches to 0 as m increases. The application of Lemma 2 concludes the proof.□

In conclusion, we observe that the above theorem can be applied to the sampling matrix 
                           
                              
                                 
                                    H
                                 
                                 
                                    m
                                 
                              
                           
                         in (7). Thus we have proved that our iteration matrix is strongly clustered at zero.

Formula (7) implies that the option price 
                           
                              
                                 
                                    W
                                 
                                 
                                    0
                                 
                              
                           
                         can be obtained by performing N times the matrix–vector multiplication 
                           
                              HDv
                           
                        , starting from the payoff vector 
                           
                              
                                 
                                    W
                                 
                                 
                                    N
                                 
                              
                           
                        . In order to speed-up the matrix–vector product, we use the spectral properties of the matrix 
                           
                              HD
                           
                         as discussed above. These properties allow us to factorize the iteration matrix into the product of “simpler” matrices. To this end, we consider the following theorem.
                           Theorem 4
                           
                              Golub and Kahan (1965, Theorem 1)
                           


                           
                              Let 
                              
                                 
                                    A
                                 
                               
                              be any 
                              
                                 
                                    m
                                    ×
                                    m
                                 
                               
                              matrix with complex elements. Then 
                              
                                 
                                    A
                                 
                               
                              can be decomposed as 
                              
                                 
                                    A
                                    =
                                    
                                       
                                          PJQ
                                       
                                       
                                          H
                                       
                                    
                                 
                               
                              where 
                              
                                 
                                    P
                                 
                               
                              and 
                              
                                 
                                    Q
                                 
                               
                              are unitary matrices and 
                              
                                 
                                    J
                                 
                               
                              is an 
                              
                                 
                                    m
                                    ×
                                    m
                                 
                               
                              bidiagonal matrix of the form
                              
                                 
                                    
                                       J
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         ⋱
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋱
                                                      
                                                      
                                                         ⋱
                                                      
                                                      
                                                         ⋱
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋱
                                                      
                                                      
                                                         ⋱
                                                      
                                                      
                                                         ⋱
                                                      
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               m
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

Matrices 
                           
                              P
                           
                         and 
                           
                              Q
                           
                         are obtained as products of Householder’s elementary (rank 1) matrices, i.e., matrices of the form 
                           
                              I
                              -
                              2
                              
                                 
                                    xx
                                 
                                 
                                    H
                                 
                              
                              ,
                              
                              x
                              ∈
                              
                                 
                                    C
                                 
                                 
                                    m
                                 
                              
                              ,
                              
                              
                                 
                                    x
                                 
                                 
                                    H
                                 
                              
                              x
                              =
                              1
                           
                        . Moreover, the matrix–vector product with Householder matrix requires only 
                           
                              2
                              m
                           
                         multiplicative and 
                           
                              2
                              m
                              -
                              1
                           
                         additive operations. This means that it is not necessary to calculate explicitly the matrices 
                           
                              P
                           
                         and 
                           
                              Q
                           
                        , but we can simply store the vectors of the Householder’s matrices that generate them. If, for example, 
                           
                              P
                              =
                              (
                              I
                              -
                              2
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    H
                                 
                              
                              )
                              (
                              I
                              -
                              2
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                                 
                                    H
                                 
                              
                              )
                              ⋯
                              (
                              I
                              -
                              2
                              
                                 
                                    x
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    m
                                 
                                 
                                    H
                                 
                              
                              )
                              ,
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    C
                                 
                                 
                                    m
                                 
                              
                           
                         it is sufficient to store the vectors 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    m
                                 
                              
                           
                         to get all the informations necessary to calculate the matrix–vector product 
                           
                              Pv
                           
                        .

Using Theorem 4 we can factorize the matrix 
                           
                              HD
                           
                         as 
                           
                              
                                 
                                    PJQ
                                 
                                 
                                    H
                                 
                              
                           
                        . In general, this algorithm is very expensive requiring 
                           
                              O
                              (
                              
                                 
                                    m
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         operations (see Golub & VanLoan, 1996). However, using the cluster property of the matrix 
                           
                              HD
                           
                        , it is possible to see experimentally that the elements (
                           
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    α
                                 
                                 
                                    m
                                 
                              
                           
                        ) on the main diagonal and those (
                           
                              
                                 
                                    β
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    β
                                 
                                 
                                    m
                                    -
                                    1
                                 
                              
                           
                        ) on the upper diagonal of the matrix 
                           
                              J
                           
                        , exhibit, in modulus, the behavior shown in Fig. B.4
                        . Therefore, if we consider to be non-zero only the 
                           
                              
                                 
                                    k
                                 
                                 
                                    ∊
                                 
                              
                           
                         elements above a certain threshold 
                           
                              ∊
                           
                        , the computation of the matrices 
                           
                              P
                              ,
                              J
                           
                         and 
                           
                              Q
                           
                         can stop at the 
                           
                              
                                 
                                    k
                                 
                                 
                                    ∊
                                 
                              
                           
                        th iteration with 
                           
                              O
                              (
                              
                                 
                                    k
                                 
                                 
                                    ∊
                                 
                              
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         operations. The value of 
                           
                              
                                 
                                    k
                                 
                                 
                                    ∊
                                 
                              
                           
                         is closely related to the fixed tolerance 
                           
                              ∊
                           
                         and to the cluster of the matrix. As a rule of thumb, if the number of eigenvalues greater than a tolerance 
                           
                              ∊
                           
                         is 
                           
                              
                                 
                                    r
                                 
                                 
                                    ∊
                                 
                              
                           
                        , then the number of steps 
                           
                              
                                 
                                    k
                                 
                                 
                                    ∊
                                 
                              
                           
                         of the algorithm is only slightly larger than 
                           
                              
                                 
                                    r
                                 
                                 
                                    ∊
                                 
                              
                           
                        .

Given the matrix 
                           
                              HD
                           
                         and using the algorithm of Golub and Kahan (1965), we compute the vectors 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ∊
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    y
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ∊
                                       
                                    
                                 
                              
                           
                         and the elements 
                           
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    α
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ∊
                                       
                                    
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    β
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    β
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ∊
                                       
                                    
                                    -
                                    1
                                 
                              
                           
                        , so that
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ∊
                                                      
                                                   
                                                
                                             
                                             =
                                             (
                                             I
                                             -
                                             2
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   H
                                                
                                             
                                             )
                                             (
                                             I
                                             -
                                             2
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   H
                                                
                                             
                                             )
                                             ⋯
                                             (
                                             I
                                             -
                                             2
                                             
                                                
                                                   x
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ∊
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ∊
                                                      
                                                   
                                                
                                                
                                                   H
                                                
                                             
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ∊
                                                      
                                                   
                                                
                                             
                                             =
                                             (
                                             I
                                             -
                                             2
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                                
                                                   H
                                                
                                             
                                             )
                                             (
                                             I
                                             -
                                             2
                                             
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                                
                                                   H
                                                
                                             
                                             )
                                             ⋯
                                             (
                                             I
                                             -
                                             2
                                             
                                                
                                                   y
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ∊
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ∊
                                                      
                                                   
                                                
                                                
                                                   H
                                                
                                             
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        and
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ∊
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   ⋱
                                                
                                                
                                                   ⋱
                                                
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                                
                                                
                                                   ⋱
                                                
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               ∊
                                                            
                                                         
                                                         -
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                                
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               ∊
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ∊
                                          
                                       
                                    
                                    
                                       H
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ∊
                                          
                                       
                                    
                                 
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ∊
                                          
                                       
                                    
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ∊
                                          
                                       
                                    
                                    
                                       H
                                    
                                 
                                 ≅
                                 HD
                                 .
                              
                           
                        Using this factorization, we compute 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ∊
                                       
                                    
                                 
                              
                              
                                 
                                    J
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ∊
                                       
                                    
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ∊
                                       
                                    
                                 
                                 
                                    H
                                 
                              
                              v
                           
                        , instead of 
                           
                              HDv
                              ,
                              
                              v
                              ∈
                              
                                 
                                    C
                                 
                                 
                                    m
                                 
                              
                           
                        . In addition, exploiting the Householder structure of matrices 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ∊
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Q
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ∊
                                       
                                    
                                 
                              
                           
                         we can reduce the number of operations in the matrix–vector product from 
                           
                              O
                              (
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         to 
                           
                              O
                              (
                              
                                 
                                    k
                                 
                                 
                                    ∊
                                 
                              
                              m
                              )
                           
                        .

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.ejor.2013.12.009.


                     
                        
                           Supplementary data 1
                           
                        
                     
                  


                     
                        
                           Supplementary data 2
                           
                        
                     
                  

@&#REFERENCES@&#

