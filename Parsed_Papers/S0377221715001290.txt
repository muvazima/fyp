@&#MAIN-TITLE@&#Stronger multi-commodity flow formulations of the Capacitated Vehicle Routing Problem

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present several new formulations for the classical “Capacitated Vehicle Routing Problem”.


                        
                        
                           
                           We survey other previous flow-based formulations.


                        
                        
                           
                           We show that our new formulations have desired properties.


                        
                        
                           
                           We prove that the linear programming relaxations of the new formulations give better bounds.


                        
                        
                           
                           We analyse computational results to compare the known and new formulations.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Vehicle routing

Multi-commodity flows

Integer programming

@&#ABSTRACT@&#


               
               
                  The Capacitated Vehicle Routing Problem is a much-studied (and strongly 
                        
                           N
                           P
                        
                     -hard) combinatorial optimization problem, for which many integer programming formulations have been proposed. We present two new multi-commodity flow (MCF) formulations, and show that they dominate all of the existing ones, in the sense that their continuous relaxations yield stronger lower bounds. Moreover, we show that the relaxations can be strengthened, in pseudo-polynomial time, in such a way that all of the so-called knapsack large multistar (KLM) inequalities are satisfied. The only other relaxation known to satisfy the KLM inequalities, based on set partitioning, is strongly 
                        
                           N
                           P
                        
                     -hard to solve. Computational results demonstrate that the new MCF relaxations are significantly stronger than the previously known ones.
               
            

@&#INTRODUCTION@&#


                     Vehicle Routing Problems (VRPs) are classic problems in operational research and logistics, and have also received a great deal of attention from the combinatorial optimization community. A huge number of papers have been written on the theory and applications of VRPs, and on exact and heuristic solution methods for them (see, e.g., the edited volumes Ball, Magnanti, Monma, and Nemhauser, 1995; Golden, Raghavan, and Wasil, 2008; Toth and Vigo, 2001.)

This paper is concerned with the Capacitated VRP (CVRP), which Dantzig and Ramser (1959) defined as follows. A fleet of identical vehicles, with limited capacity, is located at a depot. There are n customers that require service. Each customer has a known demand. The cost of travel between any pair of customers, or between any customer and the depot, is also known. The task is to find a minimum-cost collection of vehicle routes, each starting and ending at the depot, such that each customer is visited by exactly one vehicle, and no vehicle visits a set of customers whose total demand exceeds the vehicle capacity.


                     Letchford and Salazar-González (2006) surveyed and compared several integer programming formulations of the CVRP. These included the so-called two- and three-index formulations, the single-, two- and multi-commodity flow formulations, and the set partitioning formulations. At present, the most successful exact algorithms for the CVRP are based on the two-index formulation (e.g., Lysgaard, Letchford, and Eglese, 2004) or on set partitioning formulations (e.g., Fukasawa et al., 2006, Baldacci, Christofides, and Mingozzi (2008)).

One way to measure the strength of an alternative formulation is to project the feasible region of its continuous relaxation into the space of the natural (two-index) formulation. Gouveia (1995) showed that, in the case of the single-commodity flow formulation, the projection satisfies a family of valid inequalities now known as generalized large multistar (GLM) inequalities. Letchford and Salazar-González (2006) showed that the projection of the set partitioning formulation (with only elementary routes permitted) satisfies the so-called knapsack large multistar (KLM) inequalities, defined by Letchford, Eglese, and Lysgaard (2002). The KLM inequalities include the GLM inequalities and the so-called subtour elimination (SE) inequalities as special cases. Unfortunately, the continuous relaxation of the set partitioning formulation is itself strongly 
                        
                           N
                           P
                        
                     -hard to solve.

This paper has four main contributions. First, we show how to strengthen the two best multi-commodity flow (MCF) formulations, by adding only a polynomial number of additional constraints. Second, we show that the projections of our two formulations satisfy the GLM and SE inequalities. Third, we show that the new formulations can be further strengthened, in pseudo-polynomial time, in such a way that all of the KLM inequalities are satisfied. (We remark that no polynomial or pseudo-polynomial time separation algorithm is known for the KLM inequalities themselves.) Finally, we present some computational results that demonstrate that the new MCF formulations are significantly stronger than the previously known ones.

As mentioned above, the current best algorithms for the CVRP are based on two-index or set partitioning formulations. The contribution of this paper may therefore appear to be only of theoretical interest. We would like to point out, however, that there exist variants of the CVRP for which it is natural, or even essential, to use additional commodity-flow variables. This includes, for example, the problem described by Hernández-Pérez and Salazar-González (2009), in which several distinct products have to be picked up and delivered at various locations, and the one described by Kara, Kara, and Yetis (2007), in which the cost of traversing an arc is an increasing function of vehicle load. Potentially, our results could be used to derive better formulations and algorithms for such problems.

The structure of the paper is as follows. The literature is reviewed in Section 2. The strengthened MCF formulations are presented and analysed in Section 3. The result on KLM inequalities is given in Section 4. Some computational results are given in Section 5, and some concluding remarks are made in Section 6.

Throughout the paper, we use the following notation. We have a complete directed graph G with node set 
                        
                           V
                           =
                           {
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                           }
                        
                      and arc set A. Node 0 represents the depot, and nodes 
                        
                           1
                           ,
                           …
                           ,
                           n
                        
                      represent customers. We sometimes write Vc
                      for V∖{0}, the set of customer nodes. The (positive integer) demand of customer i ∈ Vc
                      is qi
                     . The (positive integer) vehicle capacity is Q. The (non-negative integer) cost of traversing arc (i, j) ∈ A is cij
                     . (Our approach can easily be adapted to the case of symmetric costs and/or the case in which the number of vehicles is restricted.)

@&#LITERATURE REVIEW@&#

As mentioned above, many formulations have been proposed for the CVRP. For brevity, we review only ones of relevance here. Subsections 2.1–2.4 cover two-index vehicle flow, single- and two-commodity flow, multi-commodity flow and set partitioning formulations, respectively.


                        Laporte and Nobert (1983) presented what is now called the two-index vehicle flow formulation. For all (i, j) ∈ A, define a binary variable xij
                        , taking the value 1 if and only if some vehicle travels from i to j. For any S⊂V, let 
                           
                              
                                 δ
                                 +
                              
                              
                                 (
                                 S
                                 )
                              
                           
                         (respectively, 
                           
                              
                                 δ
                                 −
                              
                              
                                 (
                                 S
                                 )
                              
                           
                        ) denote the set of arcs (i, j) with i ∈ S, j ∈ V∖S (respectively, with i ∈ V∖S, j ∈ S). If 
                           
                              S
                              =
                              {
                              i
                              }
                           
                         then we will write 
                           
                              
                                 δ
                                 +
                              
                              
                                 (
                                 i
                                 )
                              
                           
                         and 
                           
                              
                                 δ
                                 −
                              
                              
                                 (
                                 i
                                 )
                              
                           
                         rather than 
                           
                              
                                 δ
                                 +
                              
                              
                                 (
                                 
                                    {
                                    i
                                    }
                                 
                                 )
                              
                           
                         and 
                           
                              
                                 δ
                                 −
                              
                              
                                 (
                                 
                                    {
                                    i
                                    }
                                 
                                 )
                              
                              ,
                           
                         for brevity. Given some F⊂A, let x(F) denote ∑(i, j) ∈ F
                        
                        xij
                        . Finally, for any set of customers S⊂Vc
                        , let 
                           
                              q
                              
                                 (
                                 S
                                 )
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    S
                                 
                              
                              
                                 q
                                 i
                              
                           
                        . Then the formulation is:

                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             min
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   A
                                                
                                             
                                             
                                                c
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             s.t.
                                             
                                             x
                                             (
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             )
                                             =
                                             1
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             (
                                             i
                                             ∈
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             x
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             )
                                             =
                                             1
                                          
                                       
                                       
                                       
                                          
                                             (
                                             i
                                             ∈
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             x
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   S
                                                   )
                                                
                                                )
                                             
                                             ≥
                                             
                                                ⌈
                                                q
                                                
                                                   (
                                                   S
                                                   )
                                                
                                                /
                                                Q
                                                ⌉
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             S
                                             ⊆
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             A
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The out-degree equations 
                        (2) and the in-degree equations
                        (3) ensure that vertices are visited exactly once. The constraints (4), called rounded capacity (RC) inequalities, prevent the existence of infeasible routes, and also have the side-effect of preventing subtours. Finally, (5) are the integrality conditions on the x-variables.

Several families of valid linear inequalities (cutting planes) have been developed for the two-index vehicle flow formulation (see Naddef and Rinaldi, 2001 for a survey). We will be interested in the following inequalities:

                           
                              •
                              The fractional capacity (FC) inequalities:

                                    
                                       (6)
                                       
                                          
                                             x
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   S
                                                   )
                                                
                                                )
                                             
                                             ≥
                                             
                                                
                                                   q
                                                   (
                                                   S
                                                   )
                                                
                                                Q
                                             
                                             
                                             
                                                (
                                                S
                                                ⊆
                                                
                                                   V
                                                   c
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              

The subtour elimination (SE) inequalities:

                                    
                                       (7)
                                       
                                          
                                             x
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   S
                                                   )
                                                
                                                )
                                             
                                             ≥
                                             1
                                             
                                             
                                                (
                                                S
                                                ⊆
                                                
                                                   V
                                                   c
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              

The generalized large multistar (GLM) inequalities (see Gouveia, 1995):

                                    
                                       (8)
                                       
                                          
                                             x
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   S
                                                   )
                                                
                                                )
                                             
                                             ≥
                                             
                                                1
                                                Q
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                (
                                                
                                                   q
                                                   i
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      
                                                         V
                                                         c
                                                      
                                                      ∖
                                                      S
                                                   
                                                
                                                
                                                   q
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   +
                                                   
                                                      x
                                                      
                                                         j
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             
                                             
                                                (
                                                S
                                                ⊆
                                                
                                                   V
                                                   c
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              

The knapsack large multistar (KLM) inequalities (see Letchford et al., 2002):

                                    
                                       (9)
                                       
                                          
                                             x
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   S
                                                   )
                                                
                                                )
                                             
                                             ≥
                                             
                                                1
                                                β
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                (
                                                
                                                   α
                                                   i
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      
                                                         V
                                                         c
                                                      
                                                      ∖
                                                      S
                                                   
                                                
                                                
                                                   α
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   +
                                                   
                                                      x
                                                      
                                                         j
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             
                                             
                                                (
                                                S
                                                ⊆
                                                
                                                   V
                                                   c
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 where α ≥ 0 and β > 0 are such that the inequality 
                                    
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             
                                                V
                                                c
                                             
                                          
                                       
                                       
                                          α
                                          i
                                       
                                       
                                          y
                                          i
                                       
                                       ≤
                                       β
                                    
                                  is valid for the 0-1 knapsack polytope:

                                    
                                       (10)
                                       
                                          
                                             KP
                                             
                                                (
                                                Q
                                                ,
                                                q
                                                )
                                             
                                             :
                                             =
                                             conv
                                             
                                             
                                                {
                                                y
                                                ∈
                                                
                                                   
                                                      {
                                                      0
                                                      ,
                                                      1
                                                      }
                                                   
                                                   n
                                                
                                                :
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         V
                                                         c
                                                      
                                                   
                                                
                                                
                                                   q
                                                   i
                                                
                                                
                                                   y
                                                   i
                                                
                                                ≤
                                                Q
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              

Obviously, the RC inequalities dominate the FC and SE inequalities, and the GLM inequalities dominate the FC inequalities. It is also not difficult to see that the KLM inequalities include the GLM and SE inequalities as special cases. In general, there are no other dominance relations.

The first single-commodity flow formulation, that we call “SCF1”, was presented by Gavish and Graves (1979). A continuous variable fij
                         is defined for each (i, j) ∈ A, representing the total load (if any) carried along the arc (i, j). One then replaces constraints (4) in the two-index vehicle flow formulation with:

                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             f
                                             
                                                (
                                                
                                                   δ
                                                   −
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                )
                                             
                                             −
                                             f
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                )
                                             
                                             =
                                             
                                                q
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             (
                                             i
                                             ∈
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             0
                                             ≤
                                             
                                                f
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≤
                                             Q
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             A
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The constraints (11) ensure that each customer i receives the demand of qi
                        . The constraints (12) are just bounds on the f variables.


                        Gavish (1984) proposed to strengthen SCF1 by replacing the bounds (12) with the stronger bounds

                           
                              
                                 
                                    
                                       q
                                       j
                                    
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    ≤
                                    
                                       f
                                       
                                          i
                                          j
                                       
                                    
                                    ≤
                                    
                                       (
                                       Q
                                       −
                                       
                                          q
                                          i
                                       
                                       )
                                    
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    
                                    
                                       (
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       ∈
                                       A
                                       )
                                    
                                    .
                                 
                              
                           
                        We call this strengthened formulation “SCF2”.


                        Gouveia (1995) used Hoffman’s circulation theorem (Hoffman, 1960) to project the feasible regions of the LP relaxations of SCF1 and SCF2 into the space of the x variables. The projection of SCF1 is given by the out-degree equations (2), the in-degree equations (3), the FC inequalities (6) and non-negativity. The projection of SCF2, as expected, is stronger, satisfying the GLM inequalities (8) in place of the FC inequalities.

In the paper of Baldacci, Hadjiconstantinou, and Mingozzi (2004), a two-commodity flow formulation is presented for the case in which the costs cij
                         are symmetric. Letchford and Salazar-González (2006) show that, in this case, the LP relaxation of their formulation gives the same lower bound as that of SCF2.

The first multi-commodity flow formulation, that we call “MCF1a”, was presented by Garvin, Crandall, John, and Spellman (1957). A binary variable 
                           
                              f
                              
                                 i
                                 j
                              
                              k
                           
                         is defined for each k ∈ Vc
                         and each (i, j) ∈ A, taking the value 1 if and only if a vehicle traverses (i, j) on the way from the depot to k. The formulation is then obtained by replacing constraints (4) in the two-index vehicle flow formulation with:

                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   0
                                                   )
                                                
                                                )
                                             
                                             =
                                             
                                                f
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   −
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                                )
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             (
                                             k
                                             ∈
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   −
                                                
                                                
                                                   (
                                                   0
                                                   )
                                                
                                                )
                                             
                                             =
                                             
                                                f
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                                )
                                             
                                             =
                                             0
                                          
                                       
                                       
                                       
                                          
                                             (
                                             k
                                             ∈
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                )
                                             
                                             =
                                             
                                                f
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   −
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             k
                                             ,
                                             i
                                             ∈
                                             
                                                V
                                                c
                                             
                                             :
                                             i
                                             ≠
                                             k
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                       
                                          
                                             (
                                             k
                                             ∈
                                             
                                                V
                                                c
                                             
                                             ,
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             A
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   
                                                      V
                                                      c
                                                   
                                                
                                             
                                             
                                                q
                                                k
                                             
                                             
                                                f
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             ≤
                                             Q
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             A
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The single-source multi-commodity flow theorem of Papernov (1976) implies that the LP relaxations of MCF1a and SCF1 are of equal strength.


                        Gavish (1984) proposed an alternative formulation, that we call “MCF1b”. It is obtained by replacing (17) with the following constraints:

                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   
                                                      V
                                                      c
                                                   
                                                   ∖
                                                   
                                                      {
                                                      i
                                                      }
                                                   
                                                
                                             
                                             
                                                q
                                                k
                                             
                                             
                                                f
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                )
                                             
                                             ≤
                                             Q
                                             −
                                             
                                                q
                                                i
                                             
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             (
                                             i
                                             ∈
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             ≤
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             k
                                             ∈
                                             
                                                V
                                                c
                                             
                                             ,
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             A
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        It follows from the max-flow/min-cut theorem that, if the constraints (18) are dropped from MCF1b, then the projection into x-space is given by (2), (3), (7) and non-negativity. No similar projection result is known for MCF1b itself.


                        Letchford and Salazar-González (2006) presented a different MCF formulation, with two commodities per customer. For each arc (i, j) and customer k, the variable 
                           
                              f
                              
                                 i
                                 j
                              
                              k
                           
                         is defined as before, but there is now also a binary variable 
                           
                              
                                 g
                                 
                                    i
                                    j
                                 
                                 k
                              
                              ,
                           
                         taking the value 1 if and only if a vehicle traverses (i, j) on the way from k to the depot. We then replace the constraints (4) in the two-index vehicle flow formulation with the constraints (13)–(16), together with:

                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                                )
                                             
                                             =
                                             
                                                g
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   −
                                                
                                                
                                                   (
                                                   0
                                                   )
                                                
                                                )
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             (
                                             k
                                             ∈
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   −
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                                )
                                             
                                             =
                                             
                                                g
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   0
                                                   )
                                                
                                                )
                                             
                                             =
                                             0
                                          
                                       
                                       
                                       
                                          
                                             (
                                             k
                                             ∈
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                )
                                             
                                             =
                                             
                                                g
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   −
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             k
                                             ,
                                             i
                                             ∈
                                             
                                                V
                                                c
                                             
                                             :
                                             i
                                             ≠
                                             k
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                       
                                          
                                             (
                                             k
                                             ∈
                                             
                                                V
                                                c
                                             
                                             ,
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             A
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             +
                                             
                                                g
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             ≤
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             k
                                             ∈
                                             
                                                V
                                                c
                                             
                                             ,
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             A
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   
                                                      V
                                                      c
                                                   
                                                   ∖
                                                   
                                                      {
                                                      i
                                                      }
                                                   
                                                
                                             
                                             
                                                q
                                                k
                                             
                                             
                                                (
                                                
                                                   f
                                                   i
                                                
                                                
                                                   (
                                                   
                                                      δ
                                                      +
                                                   
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                
                                                   g
                                                   i
                                                
                                                
                                                   (
                                                   
                                                      δ
                                                      −
                                                   
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                   )
                                                
                                                )
                                             
                                             ≤
                                             Q
                                             −
                                             
                                                q
                                                i
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             i
                                             ∈
                                             
                                                V
                                                c
                                             
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        We will call this formulation “MCF2a”. Note that the depot is either the source or the sink of every commodity. The above-mentioned result by Papernov (1976) then implies that, if the constraints (25) are dropped from MCF2a, then the projection into x-space is again given by (2), (3), (7) and non-negativity. No similar projection result is known for MCF2a itself.

We will also need the following set partitioning (SP) formulation, due to Balinski and Quandt (1964). Let Ω denote the set of possible routes for a single vehicle, and let zr
                         for each r ∈ Ω be a binary variable taking the value 1 if and only if that route is used. Define the constant air
                         for each customer i and route r, taking the value 1 if i is served by r, and 0 otherwise. Finally let cr
                         denote the cost of route r. Then the SP formulation is:

                           
                              
                                 
                                    
                                       
                                          
                                             min
                                             
                                             
                                                ∑
                                                
                                                   r
                                                   ∈
                                                   Ω
                                                
                                             
                                             
                                                c
                                                r
                                             
                                             
                                                z
                                                r
                                             
                                          
                                       
                                       
                                          
                                       
                                       
                                    
                                    
                                       
                                          
                                             s.t.
                                             
                                             
                                                ∑
                                                
                                                   r
                                                   ∈
                                                   Ω
                                                
                                             
                                             
                                                a
                                                
                                                   i
                                                   r
                                                
                                             
                                             
                                                z
                                                r
                                             
                                             =
                                             1
                                          
                                       
                                       
                                       
                                          
                                             (
                                             i
                                             ∈
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                z
                                                r
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             r
                                             ∈
                                             Ω
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Since the number of variables in this formulation can be exponential in n, column generation is necessary. Unfortunately, the pricing subproblem is easily shown to be strongly 
                           
                              N
                              P
                           
                        -hard. Agarwal, Mathur, and Salkin (1989) solve it via integer programming. Foster and Ryan (1976) noted that pricing becomes easier if one enlarges the set Ω by allowing routes in which the vehicle is permitted to visit customers more than once (now called non-elementary routes). Pricing can then be performed in pseudo-polynomial time, by dynamic programming, see, e.g., Martinelli, Pecin, and Poggi (2014) for details.


                        Letchford and Salazar-González (2006) prove the following:

                           
                              •
                              When elementary routes are used, the projection of the LP relaxation into x-space satisfies all KLM inequalities.

Again, when elementary routes are used, the LP relaxation is at least as strong as those of all of the SCF and MCF formulations mentioned in the previous two subsections.

If, however, non-elementary routes are permitted, then the only KLM inequalities which are satisfied by the projection are those in which αy ≤ β is valid for the general integer knapsack polytope

                                    
                                       
                                          
                                             conv
                                             
                                             
                                                {
                                                y
                                                ∈
                                                
                                                   Z
                                                   +
                                                   n
                                                
                                                :
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         V
                                                         c
                                                      
                                                   
                                                
                                                
                                                   q
                                                   i
                                                
                                                
                                                   y
                                                   i
                                                
                                                ≤
                                                Q
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 These less general KLM inequalities still include the GLM inequalities as a special case, but no longer include the SE inequalities.

In this section, we present four new multi-commodity flow formulations, each of which satisfies the SE inequalities (7) and GLM inequalities (8). The ones presented in Subsection 3.1 dominate SCF1, SCF2, MCF1a and MCF1b. The one presented in Subsection 3.2 also dominates MCF2a. The one presented in Subsection 3.3 is designed especially for instances with symmetric costs.

In this subsection we will need the following lemma.

                           Lemma 1
                           The LP relaxation of formulation MCF1b satisfies the equations

                                 
                                    (26)
                                    
                                       
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                             j
                                          
                                          =
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          
                                             (
                                             j
                                             ∈
                                             
                                                V
                                                c
                                             
                                             ,
                                             i
                                             ∈
                                             V
                                             ∖
                                             
                                                {
                                                j
                                                }
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           

Let j ∈ Vc
                               be fixed. From (3) we have 
                                 
                                    x
                                    (
                                    
                                       δ
                                       −
                                    
                                    
                                       (
                                       j
                                       )
                                    
                                    )
                                    =
                                    1
                                    ,
                                 
                               from (13) we have 
                                 
                                    
                                       f
                                       j
                                    
                                    
                                       (
                                       
                                          δ
                                          −
                                       
                                       
                                          (
                                          j
                                          )
                                       
                                       )
                                    
                                    =
                                    1
                                    ,
                                 
                               and from (19) we have 
                                 
                                    
                                       f
                                       
                                          i
                                          j
                                       
                                       j
                                    
                                    ≤
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                 
                               for all i ∈ V∖{j}. The only way for these to all hold simultaneously is for (26) to hold.□

The following proposition introduces a class of valid inequalities.

                           Proposition 1
                           All (integer) solutions to formulation MCF1b satisfy the following inequalities:

                                 
                                    (27)
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   V
                                                   c
                                                
                                                ∖
                                                
                                                   {
                                                   i
                                                   }
                                                
                                             
                                          
                                          
                                             q
                                             k
                                          
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                             k
                                          
                                          ≤
                                          
                                             (
                                             Q
                                             −
                                             
                                                q
                                                i
                                             
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          
                                             (
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             A
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           

If the vehicle traverses the arc (i, j), then it must have already delivered a demand of qi
                               to customer i.□

Our first new formulation, which we call MCF1c, is obtained from MCF1b by replacing the constraints (18) with inequalities (27). The following two propositions state that MCF1c has some desirable properties.

                           Proposition 2
                           The LP relaxation of MCF1c satisfies the SE inequalities (7) and the GLM inequalities (8).

As mentioned in Subsection 2.3, the max-flow/min-cut theorem implies that the SE inequalities are satisfied. Now, for a given S⊆Vc
                               and a given commodity k ∈ S, the flow equations (13)–(15) imply that

                                 
                                    
                                       
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                S
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                S
                                                )
                                             
                                             )
                                          
                                          +
                                          1
                                          .
                                       
                                    
                                 
                              Multiplying these equations by qk
                               and summing over all k ∈ S, we obtain

                                 
                                    (28)
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                S
                                             
                                          
                                          
                                             q
                                             k
                                          
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                S
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                S
                                             
                                          
                                          
                                             q
                                             k
                                          
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                S
                                                )
                                             
                                             )
                                          
                                          +
                                          q
                                          
                                             (
                                             S
                                             )
                                          
                                          .
                                       
                                    
                                 
                              Now, the constraints (27) for all 
                                 
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    
                                       δ
                                       −
                                    
                                    
                                       (
                                       S
                                       )
                                    
                                 
                               imply that the left-hand side of (28) is no larger than

                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   δ
                                                   −
                                                
                                                
                                                   (
                                                   S
                                                   )
                                                
                                             
                                          
                                          
                                             (
                                             Q
                                             −
                                             
                                                q
                                                i
                                             
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          .
                                       
                                    
                                 
                              On the other hand, the constraints (26) for all 
                                 
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    
                                       δ
                                       +
                                    
                                    
                                       (
                                       S
                                       )
                                    
                                    ,
                                 
                               together with non-negativity, imply that the right-hand side of (28) is no smaller than

                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   S
                                                   )
                                                
                                             
                                          
                                          
                                             q
                                             j
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          +
                                          q
                                          
                                             (
                                             S
                                             )
                                          
                                          .
                                       
                                    
                                 
                              From this we deduce that the relaxation of MCF1d satisfies

                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   δ
                                                   −
                                                
                                                
                                                   (
                                                   S
                                                   )
                                                
                                             
                                          
                                          
                                             (
                                             Q
                                             −
                                             
                                                q
                                                i
                                             
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ≥
                                          
                                             ∑
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   S
                                                   )
                                                
                                             
                                          
                                          
                                             q
                                             j
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          +
                                          q
                                          
                                             (
                                             S
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              which is equivalent to the GLM inequality (8) for the given S.□

The LP relaxation of MCF1c is stronger than that of SCF1, SCF2 and MCF1a, and at least as strong as that of MCF1b.

The LP relaxation of MCF1c satisfies the constraints (2), (3) (7) and (8). The fact that it is stronger than the LP relaxations of SCF1 and SCF2 then follow from the result of Gouveia (1995) mentioned in Subsection 2.2. It is also stronger than the LP relaxation of MCF1a since, as mentioned in Subsection 2.3, that relaxation is identical to the one of SCF1. To show that the LP relaxation of MCF1c is at least as strong as that of MCF1b, it suffices to show that it satisfies the inequalities (18). To this end, let i ∈ Vc
                               be fixed. Sum the inequalities (27) over all arcs entering i to obtain

                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   V
                                                   c
                                                
                                             
                                          
                                          
                                             q
                                             k
                                          
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             )
                                          
                                          ≤
                                          Q
                                          −
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   V
                                                   c
                                                
                                                ∖
                                                
                                                   {
                                                   i
                                                   }
                                                
                                             
                                          
                                          
                                             q
                                             k
                                          
                                          
                                             x
                                             
                                                k
                                                i
                                             
                                          
                                          .
                                       
                                    
                                 
                              Together with Eq. (13) for 
                                 
                                    i
                                    =
                                    k
                                    ,
                                 
                               this implies

                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   V
                                                   c
                                                
                                                ∖
                                                
                                                   {
                                                   i
                                                   }
                                                
                                             
                                          
                                          
                                             q
                                             k
                                          
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             )
                                          
                                          ≤
                                          Q
                                          −
                                          
                                             q
                                             i
                                          
                                          −
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   V
                                                   c
                                                
                                                ∖
                                                
                                                   {
                                                   i
                                                   }
                                                
                                             
                                          
                                          
                                             q
                                             k
                                          
                                          
                                             x
                                             
                                                k
                                                i
                                             
                                          
                                          .
                                       
                                    
                                 
                              Eqs. (15) then imply

                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   V
                                                   c
                                                
                                                ∖
                                                
                                                   {
                                                   i
                                                   }
                                                
                                             
                                          
                                          
                                             q
                                             k
                                          
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             )
                                          
                                          ≤
                                          Q
                                          −
                                          
                                             q
                                             i
                                          
                                          −
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   V
                                                   c
                                                
                                                ∖
                                                
                                                   {
                                                   i
                                                   }
                                                
                                             
                                          
                                          
                                             q
                                             k
                                          
                                          
                                             x
                                             
                                                k
                                                i
                                             
                                          
                                          .
                                       
                                    
                                 
                              This dominates the inequality (18) for the given i.□

Our computational results (Section 5) show that, in fact, the LP relaxation of MCF1c is stronger than that of MCF1b, and is also stronger than the relaxation in x-space defined by the out-degree equations (2), the in-degree equations (3), the SE inequalities (7), the GLM inequalities (8), and non-negativity.

Now, in the proof of Proposition 3, we showed that the inequalities (18) are redundant, being implied by the other constraints in MCF1c. Interestingly, however, they can be strengthened (lifted) to obtain a non-redundant family of inequalities. These stronger inequalities are presented in the following proposition.

                           Proposition 4
                           All (integer) solutions to formulation MCF1c satisfy the following inequalities:

                                 
                                    (29)
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   V
                                                   c
                                                
                                                ∖
                                                
                                                   {
                                                   i
                                                   }
                                                
                                             
                                          
                                          
                                             q
                                             k
                                          
                                          
                                             (
                                             
                                                f
                                                i
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                                )
                                             
                                             +
                                             
                                                f
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                )
                                             
                                             )
                                          
                                          ≤
                                          Q
                                          −
                                          
                                             q
                                             i
                                          
                                          
                                          
                                             (
                                             i
                                             ∈
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           

Consider the vehicle that services customer i. The two terms on the left-hand side represent the total demand delivered by the vehicle before arriving at customer i and after leaving customer i, respectively.□

Adding the inequalities (29) to MCF1c, we obtain a formulation that we call “MCF1d”. (For ease of reference, we present MCF1d in its entirety in the Appendix.) The computational results in Section 5 show that the LP relaxation of MCF1d is stronger than that of MCF1c, which shows that the inequalities (29) are not implied by the other linear constraints in MCF1d.

Now we turn our attention to MCF2a. We will show that MCF2a can be strengthened to obtain a formulation that also dominates MCF1d, the strongest of the formulations given in the previous subsection. Our starting point is the following proposition:

                           Proposition 5
                           All (integer) solutions to formulation MCF2a satisfy the following constraints:

                                 
                                    (30)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                      k
                                                   
                                                   
                                                      (
                                                      
                                                         δ
                                                         +
                                                      
                                                      
                                                         (
                                                         i
                                                         )
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      g
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         δ
                                                         −
                                                      
                                                      
                                                         (
                                                         k
                                                         )
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                             
                                             
                                                
                                                   (
                                                   k
                                                   ,
                                                   i
                                                   ∈
                                                   
                                                      V
                                                      c
                                                   
                                                   :
                                                   i
                                                   ≠
                                                   k
                                                   )
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The left-hand and right-hand sides are each equal to 1 if customer i is served before customer k on the same route, and 0 otherwise.□

The next step is to observe that, using Lemma 1, constraints (27) can be written as

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   
                                                      V
                                                      c
                                                   
                                                   ∖
                                                   
                                                      {
                                                      i
                                                      ,
                                                      j
                                                      }
                                                   
                                                
                                             
                                             
                                                q
                                                k
                                             
                                             
                                                f
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             ≤
                                             
                                                (
                                                Q
                                                −
                                                
                                                   q
                                                   i
                                                
                                                −
                                                
                                                   q
                                                   j
                                                
                                                )
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             (
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             A
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        The following proposition shows that these inequalities can then be strengthened, using the g-variables.

                           Proposition 6
                           All (integer) solutions to formulation MCF2a satisfy the following constraints:

                                 
                                    (31)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         k
                                                         ∈
                                                         
                                                            V
                                                            c
                                                         
                                                         ∖
                                                         
                                                            {
                                                            i
                                                            ,
                                                            j
                                                            }
                                                         
                                                      
                                                   
                                                   
                                                      q
                                                      k
                                                   
                                                   
                                                      (
                                                      
                                                         f
                                                         
                                                            i
                                                            j
                                                         
                                                         k
                                                      
                                                      +
                                                      
                                                         g
                                                         
                                                            i
                                                            j
                                                         
                                                         k
                                                      
                                                      )
                                                   
                                                   ≤
                                                   
                                                      (
                                                      Q
                                                      −
                                                      
                                                         q
                                                         i
                                                      
                                                      −
                                                      
                                                         q
                                                         j
                                                      
                                                      )
                                                   
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                
                                             
                                             
                                                
                                                   (
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   A
                                                   )
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

If a vehicle traverses the arc (i, j), then it must have already delivered a demand of qi
                               to customer i, and be about to deliver qj
                               to customer j. Therefore the total load of the vehicle dedicated to the other customers on the route cannot exceed 
                                 
                                    Q
                                    −
                                    
                                       q
                                       i
                                    
                                    −
                                    
                                       q
                                       j
                                    
                                 
                              .□

We now show that the constraints (25) can be discarded when (30) and (31) are considered. To this end, we need the following lemma:

                           Lemma 2
                           The LP relaxation of formulation MCF2a satisfies the equations

                                 
                                    (32)
                                    
                                       
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                             j
                                          
                                          =
                                          
                                             g
                                             
                                                i
                                                j
                                             
                                             i
                                          
                                          =
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ∈
                                             
                                                V
                                                c
                                             
                                             :
                                             i
                                             ≠
                                             j
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           

Similar to the proof of Lemma 1.□

If the constraints (30) and (31) are added to MCF2a, then the constraints (25) become redundant.

Use (21) and (32) to write (31) as:

                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   V
                                                   c
                                                
                                                ∖
                                                
                                                   {
                                                   i
                                                   }
                                                
                                             
                                          
                                          
                                             q
                                             k
                                          
                                          
                                             (
                                             
                                                f
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             +
                                             
                                                g
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             )
                                          
                                          ≤
                                          
                                             (
                                             Q
                                             −
                                             
                                                q
                                                i
                                             
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          
                                             (
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             A
                                             )
                                          
                                          .
                                       
                                    
                                 
                              Sum these over all j ∈ V∖{i}, and use (2) to obtain:

                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   V
                                                   c
                                                
                                                ∖
                                                
                                                   {
                                                   i
                                                   }
                                                
                                             
                                          
                                          
                                             q
                                             k
                                          
                                          
                                             (
                                             
                                                f
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                )
                                             
                                             +
                                             
                                                g
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                )
                                             
                                             )
                                          
                                          ≤
                                          Q
                                          −
                                          
                                             q
                                             i
                                          
                                          
                                          
                                             (
                                             i
                                             ∈
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              Reverse the roles of i and k, and use (15) and (30) to obtain (25).□

Accordingly, we add constraints (30) and (31) to MCF2a, and delete the redundant constraints (25), to obtain what we call “MCF2b”. (We present MCF2b in its entirety in the Appendix.) The following proposition shows that MCF2b is the strongest of all the MCF formulations considered so far.

                           Proposition 8
                           Let (x*, f*, g*) be a solution to the LP relaxation of MCF2b. Then (x*, f*) is a solution to the LP relaxation of MCF1d.

The feasible region of the LP relaxation of MCF1d is defined by the constraints (2), (3), (13)–(16), (19), (27) and (29). Constraints (2), (3) and (13)–(16) are already present in MCF2b. Constraints (19) are dominated by (24). Constraints (27) are dominated by (31). Finally, the fact that constraints (29) are satisfied by (x*, f*) follows from Proposition 7 together with the fact that MCF2b contains Eqs. (30).□

The LP relaxation of formulation MCF2b satisfies the SE inequalities (7) and the GLM inequalities (8).

Our computational results (Section 5) indicate that the lower bound given by MCF2b is significantly stronger than the lower bounds given by either MCF1d or MCF2a. It is therefore the strongest known formulation based on commodity-flow variables.

To finish this section, we present a ‘hybrid’ formulation, which attempts to ‘mimic’ formulation MCF2b, but use only one commodity per customer, instead of two. We will show that, when a CVRP instance has symmetric costs, the lower bound from this hybrid formulation is just as good as the one from MCF2b.

The basic idea of the ‘hybrid’ formulation is to take the formulation MCF2b (given in the Appendix), and simplify it by using aggregated flow variables 
                           
                              
                                 
                                    f
                                    ˜
                                 
                                 
                                    i
                                    j
                                 
                                 k
                              
                              =
                              
                                 f
                                 
                                    i
                                    j
                                 
                                 k
                              
                              +
                              
                                 g
                                 
                                    j
                                    i
                                 
                                 k
                              
                           
                         for all k ∈ Vc
                         and (i, j) ∈ A. (Note that these aggregated variables have no natural physical interpretation.) The constraints in the resulting formulation are as follows:

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                   ˜
                                                
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   0
                                                   )
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   f
                                                   ˜
                                                
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   −
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                                )
                                             
                                             =
                                             2
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             (
                                             k
                                             ∈
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                   ˜
                                                
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   −
                                                
                                                
                                                   (
                                                   0
                                                   )
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   f
                                                   ˜
                                                
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                                )
                                             
                                             =
                                             0
                                          
                                       
                                       
                                       
                                          
                                             (
                                             k
                                             ∈
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                   ˜
                                                
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   f
                                                   ˜
                                                
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   −
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             k
                                             ,
                                             i
                                             ∈
                                             
                                                V
                                                c
                                             
                                             :
                                             i
                                             ≠
                                             k
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                   ˜
                                                
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             ∈
                                             
                                                V
                                                c
                                             
                                             :
                                             i
                                             ≠
                                             j
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                   ˜
                                                
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             +
                                             
                                                
                                                   f
                                                   ˜
                                                
                                                
                                                   j
                                                   i
                                                
                                                k
                                             
                                             ≤
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                x
                                                
                                                   j
                                                   i
                                                
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             ∈
                                             
                                                V
                                                c
                                             
                                             :
                                             i
                                             <
                                             j
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   
                                                      V
                                                      c
                                                   
                                                   ∖
                                                   
                                                      {
                                                      i
                                                      ,
                                                      j
                                                      }
                                                   
                                                
                                             
                                             
                                                q
                                                k
                                             
                                             
                                                (
                                                
                                                   
                                                      f
                                                      ˜
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                   k
                                                
                                                +
                                                
                                                   
                                                      f
                                                      ˜
                                                   
                                                   
                                                      j
                                                      i
                                                   
                                                   k
                                                
                                                )
                                             
                                             ≤
                                             
                                                (
                                                Q
                                                −
                                                
                                                   q
                                                   i
                                                
                                                −
                                                
                                                   q
                                                   j
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                +
                                                
                                                   x
                                                   
                                                      j
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             i
                                             ,
                                             j
                                             ∈
                                             
                                                V
                                                c
                                             
                                             :
                                             i
                                             <
                                             j
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                   ˜
                                                
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   f
                                                   ˜
                                                
                                                i
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             k
                                             ,
                                             i
                                             ∈
                                             
                                                V
                                                c
                                             
                                             :
                                             i
                                             ≠
                                             k
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We call this formulation “MCF3”. Although MCF3 is weaker than MCF2b by construction, it does have some interesting properties. These are given in the following theorem and corollaries.

                           Theorem 1
                           If the costs are symmetric, i.e. 
                                 
                                    
                                       c
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       c
                                       
                                          j
                                          i
                                       
                                    
                                 
                               for all (i, j) ∈ A, then the lower bounds obtained by solving the LP relaxations of MCF2b and MCF3 are equal.

Let 
                                 
                                    (
                                    x
                                    ,
                                    
                                       f
                                       ˜
                                    
                                    )
                                 
                               be any feasible solution to the LP relaxation of MCF3. We can construct a feasible solution to the LP relaxation of MCF2b, say 
                                 
                                    (
                                    
                                       x
                                       ¯
                                    
                                    ,
                                    
                                       f
                                       ¯
                                    
                                    ,
                                    
                                       g
                                       ¯
                                    
                                    )
                                    ,
                                 
                               using the following mapping:

                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         ¯
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   =
                                                   
                                                      (
                                                      
                                                         x
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      +
                                                      
                                                         x
                                                         
                                                            j
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   /
                                                   2
                                                
                                             
                                             
                                                
                                             
                                             
                                                
                                                   (
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   A
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                            ¯
                                                         
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      k
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            g
                                                            ¯
                                                         
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      k
                                                   
                                                   =
                                                   
                                                      (
                                                      
                                                         f
                                                         
                                                            i
                                                            j
                                                         
                                                         k
                                                      
                                                      +
                                                      
                                                         f
                                                         
                                                            j
                                                            i
                                                         
                                                         k
                                                      
                                                      )
                                                   
                                                   /
                                                   2
                                                
                                             
                                             
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∈
                                                   A
                                                   ,
                                                   
                                                   k
                                                   ∈
                                                   
                                                      V
                                                      c
                                                   
                                                   )
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Moreover, if the costs are symmetric, then the cost of 
                                 
                                    (
                                    
                                       x
                                       ¯
                                    
                                    ,
                                    
                                       f
                                       ¯
                                    
                                    ,
                                    
                                       g
                                       ¯
                                    
                                    )
                                 
                               is the same as that of 
                                 
                                    (
                                    x
                                    ,
                                    
                                       f
                                       ˜
                                    
                                    )
                                 
                              . This shows that, when costs are symmetric, the lower bound from MCF2b cannot be better than the one from MCF3. But it cannot be worse, since MCF3 is weaker than MCF2b by construction.□

The LP relaxation of MCF3 satisfies the SE inequalities (7) and the GLM inequalities (8).

The in- and out-degree equations imply that 
                                 
                                    x
                                    
                                       (
                                       
                                          δ
                                          +
                                       
                                       
                                          (
                                          S
                                          )
                                       
                                       )
                                    
                                    =
                                    x
                                    
                                       (
                                       
                                          δ
                                          −
                                       
                                       
                                          (
                                          S
                                          )
                                       
                                       )
                                    
                                 
                               for all S⊂Vc
                              . It follows that the SE inequalities can be written as

                                 
                                    
                                       
                                          x
                                          
                                             (
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                S
                                                )
                                             
                                             )
                                          
                                          +
                                          x
                                          
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                S
                                                )
                                             
                                             )
                                          
                                          ≥
                                          2
                                          
                                          
                                             (
                                             S
                                             ⊆
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              and the GLM inequalities can be written as

                                 
                                    
                                       
                                          x
                                          
                                             (
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                S
                                                )
                                             
                                             )
                                          
                                          +
                                          x
                                          
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                S
                                                )
                                             
                                             )
                                          
                                          ≥
                                          
                                             2
                                             Q
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                S
                                             
                                          
                                          
                                             (
                                             
                                                q
                                                i
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   
                                                      V
                                                      c
                                                   
                                                   ∖
                                                   S
                                                
                                             
                                             
                                                q
                                                j
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                +
                                                
                                                   x
                                                   
                                                      j
                                                      i
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                          
                                          
                                             (
                                             S
                                             ⊆
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              In this form, the inequalities are symmetric (that is, for all (i, j) ∈ A, the coefficients of xij
                               and xji
                               are equal). The result then follows from Corollary 1
and Theorem 1.□

The LP relaxation of MCF3 is stronger than those of SCF1, SCF2 and MCF1a.

Our computational results, given in Section 5, suggest that the LP relaxation of MCF3 may be stronger than those of MCF1b, MCF1c and MCF2a as well. On the other hand, they show that there is no dominance relationship between the LP relaxations of MCF3 and MCF1d.

In this section we show that, if we are willing to sacrifice the property of having only a polynomial number of variables and constraints, then we can strengthen both MCF1d and MCF2b even further. In Subsection 4.1, we strengthen them by adding certain inequalities derived from facets of the 0-1 knapsack polytope, and show that the continuous relaxations of the resulting formulations satisfy all KLM inequalities. In Subsection 4.2, we present alternative strengthened formulations, of the same quality, which have additional variables, rather than constraints. We then show that the continuous relaxations of these latter formulations can be solved in pseudo-polynomial time, via column generation.

The following lemma introduces exponentially-large families of valid inequalities that, in theory, could be used to strengthen further the formulations MCF1d and MCF2b.

                           Lemma 3
                           Let αTy ≤ β be any valid inequality for the 0-1 knapsack polytope (10), with α ≥ 0 and β > 0. Then all (integer) solutions to formulation MCF1d satisfy the inequalities

                                 
                                    (33)
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   V
                                                   c
                                                
                                                ∖
                                                
                                                   {
                                                   i
                                                   }
                                                
                                             
                                          
                                          
                                             α
                                             k
                                          
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                             k
                                          
                                          ≤
                                          
                                             (
                                             β
                                             −
                                             
                                                α
                                                i
                                             
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          
                                             (
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             A
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              and all (integer) solutions to formulation MCF2b satisfy the inequalities:

                                 
                                    (34)
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   V
                                                   c
                                                
                                                ∖
                                                
                                                   {
                                                   i
                                                   ,
                                                   j
                                                   }
                                                
                                             
                                          
                                          
                                             α
                                             k
                                          
                                          
                                             (
                                             
                                                f
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             +
                                             
                                                g
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             )
                                          
                                          ≤
                                          
                                             (
                                             β
                                             −
                                             
                                                α
                                                i
                                             
                                             −
                                             
                                                α
                                                j
                                             
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          
                                             (
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             A
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           

Let 
                                 
                                    (
                                    
                                       x
                                       ¯
                                    
                                    ,
                                    
                                       f
                                       ¯
                                    
                                    )
                                 
                               be a feasible integer solution to MCF1d. If 
                                 
                                    
                                       
                                          x
                                          ¯
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    0
                                    ,
                                 
                               the inequality (33) holds triviallly. So, suppose that 
                                 
                                    
                                       
                                          x
                                          ¯
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    1
                                    ,
                                 
                               i.e., a vehicle traverses the arc (i, j). Now consider the vector 
                                 
                                    
                                       y
                                       ¯
                                    
                                    ∈
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       n
                                    
                                 
                               obtained by setting 
                                 
                                    
                                       y
                                       ¯
                                    
                                    k
                                 
                               to 1 if and only if commodity k is on the vehicle just before the vehicle arrives at node i. Then 
                                 
                                    y
                                    ¯
                                 
                               must be an extreme point of the polytope (10), and therefore it satisfies αTy ≤ β. Moreover, 
                                 
                                    
                                       y
                                       ¯
                                    
                                    i
                                 
                               must equal 1, which implies

                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   V
                                                   c
                                                
                                                ∖
                                                
                                                   {
                                                   i
                                                   }
                                                
                                             
                                          
                                          
                                             α
                                             k
                                          
                                          
                                             
                                                y
                                                ¯
                                             
                                             k
                                          
                                          ≤
                                          
                                             (
                                             β
                                             −
                                             
                                                α
                                                i
                                             
                                             )
                                          
                                          
                                             
                                                x
                                                ¯
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          .
                                       
                                    
                                 
                              Now, for k ∈ Vc
                              ∖{i}, we must have 
                                 
                                    
                                       
                                          y
                                          ¯
                                       
                                       k
                                    
                                    =
                                    
                                       
                                          f
                                          ¯
                                       
                                       
                                          i
                                          j
                                       
                                       k
                                    
                                 
                              . This implies that 
                                 
                                    f
                                    ¯
                                 
                               satisfies the inequality (33).

The proof for MCF2b is similar. The only differences are that (i) we set 
                                 
                                    
                                       y
                                       ¯
                                    
                                    k
                                 
                               to 1 if and only if commodity k is on the vehicle when it leaves the depot and (ii) for k ∈ Vc
                              ∖{i, j}, we must have 
                                 
                                    
                                       
                                          y
                                          ¯
                                       
                                       k
                                    
                                    =
                                    
                                       f
                                       
                                          i
                                          j
                                       
                                       k
                                    
                                    +
                                    
                                       g
                                       
                                          i
                                          j
                                       
                                       k
                                    
                                 
                              .□

We have the following result:

                           Theorem 2
                           If all non-redundant inequalities of the form (33) are added to MCF1d, the continuous relaxation of the resulting formulation satisfies the KLM inequalities (9). The same holds if all non-redundant inequalities of the form (34) are added to MCF2b.

To show that the relaxation of MCF1d with (33) added satisfies the KLM inequalities (9), just use the proof of Proposition 2 with αi
                               and β taking the place of qi
                               and Q, and (33) taking the place of (27). To show the same result for MCF2b with (34) added, just note that the inequalities (34) are stronger than the inequalities (33).□

The models in the previous subsection have a drawback from a computational point of view. Not only are the constraints (33) and (34) exponential in number, but their coefficients are given only implicitly. To overcome this drawback, we present alternative formulations that are more explicit, but yield lower bounds of the same quality. These formulations have an exponential number of variables rather than constraints.

Let P be the set of all possible loading patterns of a single vehicle. That is, each member of P is a subset of Vc
                         whose total demand does not exceed Q. For each arc (i, j) and for each p ∈ P, let 
                           
                              λ
                              
                                 i
                                 j
                              
                              p
                           
                         be a binary variable, taking the value 1 if and only if a vehicle arrives at node i carrying loading pattern p, and then traverses arc (i, j). (This implies of course that i and j are in p). Then the model MCF1d is enlarged by adding the constraints

                           
                              (35)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   p
                                                   ∈
                                                   P
                                                   :
                                                   
                                                   i
                                                   ,
                                                   j
                                                   ∈
                                                   p
                                                
                                             
                                             
                                                λ
                                                
                                                   i
                                                   j
                                                
                                                p
                                             
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             (
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             A
                                             :
                                             i
                                             ,
                                             j
                                             ∈
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (36)
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             =
                                             
                                                ∑
                                                
                                                   p
                                                   ∈
                                                   P
                                                   :
                                                   
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   ∈
                                                   p
                                                
                                             
                                             
                                                λ
                                                
                                                   i
                                                   j
                                                
                                                p
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             A
                                             :
                                             i
                                             ,
                                             j
                                             ∈
                                             
                                                V
                                                c
                                             
                                             ,
                                             k
                                             ∈
                                             
                                                V
                                                c
                                             
                                             ∖
                                             
                                                {
                                                i
                                                ,
                                                j
                                                }
                                             
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Now, for each arc (i, j) and for each p ∈ P, let 
                           
                              μ
                              
                                 i
                                 j
                              
                              p
                           
                         be a binary variable, taking the value 1 if and only if a vehicle that departed from the depot with loading pattern p goes on to traverse the arc (i, j). (This implies again that i and j are in p). Then the model MCF2b is enlarged by adding the constraints

                           
                              (37)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   p
                                                   ∈
                                                   P
                                                   :
                                                   
                                                   i
                                                   ,
                                                   j
                                                   ∈
                                                   p
                                                
                                             
                                             
                                                μ
                                                
                                                   i
                                                   j
                                                
                                                p
                                             
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             (
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             A
                                             :
                                             i
                                             ,
                                             j
                                             ∈
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (38)
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             +
                                             
                                                g
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             =
                                             
                                                ∑
                                                
                                                   p
                                                   ∈
                                                   P
                                                   :
                                                   
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   ∈
                                                   p
                                                
                                             
                                             
                                                μ
                                                
                                                   i
                                                   j
                                                
                                                p
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             A
                                             :
                                             i
                                             ,
                                             j
                                             ∈
                                             
                                                V
                                                c
                                             
                                             ,
                                             k
                                             ∈
                                             
                                                V
                                                c
                                             
                                             ∖
                                             
                                                {
                                                i
                                                ,
                                                j
                                                }
                                             
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Observe that the members of P correspond to extreme points of the 0-1 knapsack polytope (10). Accordingly, we call the strengthened formulations “MCF1K” and “MCF2K”, respectively. The following two theorems show that these formulations have two desirable properties.

                           Theorem 3
                           The LP relaxations of formulations MCF1K and MCF2K satisfy the KLM inequalities (9).

Let α and β be as in Lemma 3. From the definition of P it follows that ∑
                                 k ∈ p
                              
                              αk
                               ≤ β for all p ∈ P. Therefore, for all i ∈ Vc
                               and all p ∈ P such that i ∈ p, we have 
                                 
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          p
                                          ∖
                                          {
                                          i
                                          }
                                       
                                    
                                    
                                       α
                                       k
                                    
                                    ≤
                                    β
                                    −
                                    
                                       α
                                       i
                                    
                                 
                              . This implies

                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                p
                                                ∈
                                                P
                                                :
                                                
                                                i
                                                ,
                                                j
                                                ∈
                                                p
                                             
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   p
                                                   ∖
                                                   {
                                                   i
                                                   }
                                                
                                             
                                             
                                                α
                                                k
                                             
                                             )
                                          
                                          
                                             λ
                                             
                                                i
                                                j
                                             
                                             p
                                          
                                          ≤
                                          
                                             (
                                             β
                                             −
                                             
                                                α
                                                i
                                             
                                             )
                                          
                                          
                                             ∑
                                             
                                                p
                                                ∈
                                                P
                                                :
                                                
                                                i
                                                ,
                                                j
                                                ∈
                                                p
                                             
                                          
                                          
                                             λ
                                             
                                                i
                                                j
                                             
                                             p
                                          
                                       
                                    
                                 
                              for all (i, j) ∈ A. Rearranging the left-hand side, and using (35) to simplify the right-hand side, we get

                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   V
                                                   c
                                                
                                                ∖
                                                
                                                   {
                                                   i
                                                   }
                                                
                                             
                                          
                                          
                                             α
                                             k
                                          
                                          
                                             ∑
                                             
                                                p
                                                ∈
                                                P
                                                :
                                                
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                                ∈
                                                p
                                             
                                          
                                          
                                             λ
                                             
                                                i
                                                j
                                             
                                             p
                                          
                                          ≤
                                          
                                             (
                                             β
                                             −
                                             
                                                α
                                                i
                                             
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          
                                             (
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             A
                                             :
                                             i
                                             ,
                                             j
                                             ∈
                                             
                                                V
                                                c
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              These constraints together with (36) then imply (33). In a similar way, constraints (37) and (38) imply (34). The result then follows from Theorem 2.□

The LP relaxations of MCF1K and MCF2K can be solved in pseudo-polynomial time.

Suppose we have solved a restricted master problem associated with MCF1K, i.e., an LP obtained from MCF1K by relaxing the integrality condition and replacing P with a small (polynomial-sized) subset P′⊂P. Let ρij
                               and 
                                 
                                    π
                                    
                                       i
                                       j
                                    
                                    k
                                 
                               be the optimal dual prices for (35) and (36), respectively. For a given (i, j) ∈ A, there exists a column 
                                 
                                    λ
                                    
                                       i
                                       j
                                    
                                    p
                                 
                               with negative reduced cost if and only if

                                 
                                    
                                       
                                          max
                                          
                                             {
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   
                                                      V
                                                      c
                                                   
                                                   ∖
                                                   
                                                      {
                                                      i
                                                      ,
                                                      j
                                                      }
                                                   
                                                
                                             
                                             
                                             
                                                π
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             
                                                y
                                                k
                                             
                                             :
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   
                                                      V
                                                      c
                                                   
                                                   ∖
                                                   
                                                      {
                                                      i
                                                      ,
                                                      j
                                                      }
                                                   
                                                
                                             
                                             
                                                q
                                                k
                                             
                                             
                                                y
                                                k
                                             
                                             ≤
                                             Q
                                             −
                                             
                                                q
                                                i
                                             
                                             −
                                             
                                                q
                                                j
                                             
                                             ,
                                             y
                                             ∈
                                             
                                                
                                                   {
                                                   0
                                                   ,
                                                   1
                                                   }
                                                
                                                
                                                   n
                                                   −
                                                   2
                                                
                                             
                                             
                                             }
                                          
                                          >
                                          
                                             ρ
                                             
                                                i
                                                j
                                             
                                          
                                          .
                                       
                                    
                                 
                              This is a 0-1 knapsack problem, that can be solved in 
                                 
                                    O
                                    (
                                    n
                                    Q
                                    )
                                 
                               time via dynamic programming (Bellman, 1957). The pricing problem for MCF2K is similar. Now note that pricing in an LP is equivalent to separation in the dual of the LP. The desired results then follow from the polynomial equivalence of separation and optimization (Grötschel, Lovász, and Schrijver, 1981).□

We remark that this is the first time that an LP relaxation of the CVRP has been found that can be solved in pseudo-polynomial time, yet satisfies all of the KLM inequalities. (As mentioned in Subsection 2.4, the LP relaxation of the SP formulation with elementary routes satisfies the KLM inequalities, but is strongly 
                           
                              N
                              P
                           
                        -hard to solve.) Moreover, no pseudo-polynomial separation algorithm is known for the KLM inequalities themselves.

The strongest of our MCF formulations is MCF2K. A natural question is how the lower bound associated with MCF2K compares with the lower bound associated with the SP formulation given in Subsection 2.4. The answer to this question depends on whether or not the set Ω is permitted to contain columns that correspond to non-elementary routes. As mentioned at the end of Subsection 2.4, the LP relaxation with non-elementary routes permitted does not satisfy all KLM inequalities. Thus, the associated bound does not dominate the bound from MCF2K. The following theorem settles the question for the case in which only elementary routes are permitted:

                           Theorem 5
                           If z* is a solution to the LP relaxation of the SP formulation, then there exists a solution (x*, f*, g*, μ*) to the LP relaxation of MCF2K that has the same cost.

For each arc (i, j) ∈ A and each route r ∈ Ω, let bijr
                               be a binary constant which takes the value 1 if and only if route r traverses arc (i, j). Also, for any (i, j) ∈ A, any r ∈ Ω and any customer node k ∈ Vc
                              , let dijkr
                               (respectively, 
                                 
                                    d
                                    
                                       i
                                       j
                                       k
                                       r
                                    
                                    ′
                                 
                              ) be a binary constant which takes the value 1 if and only if, in route r,

                                 
                                    •
                                    vertex k is visited and

the arc (i, j) is traversed on the way from the depot to k (respectively, on the way from k to the depot).

Finally, for any (i, j) ∈ A, r ∈ Ω and loading pattern p ∈ P, let tijrp
                               be a binary constant which takes the value 1 if and only if a vehicle following route r departs from the depot with loading pattern p and then goes on to traverse arc (i, j). The desired quadruple (x*, f*, g*, μ*) is then created by setting:

                                 
                                    •
                                    
                                       
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                             *
                                          
                                        to 
                                          
                                             
                                                ∑
                                                
                                                   r
                                                   ∈
                                                   Ω
                                                
                                             
                                             
                                                b
                                                
                                                   i
                                                   j
                                                   r
                                                
                                             
                                             
                                                z
                                                r
                                                *
                                             
                                          
                                        for all (i, j) ∈ A;


                                       
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                             
                                                *
                                                k
                                             
                                          
                                        to 
                                          
                                             
                                                ∑
                                                
                                                   r
                                                   ∈
                                                   Ω
                                                
                                             
                                             
                                                d
                                                
                                                   i
                                                   j
                                                   k
                                                   r
                                                
                                             
                                             
                                                z
                                                r
                                                *
                                             
                                          
                                        for all (i, j) ∈ A and all k ∈ Vc
                                       ;


                                       
                                          
                                             g
                                             
                                                i
                                                j
                                             
                                             
                                                *
                                                k
                                             
                                          
                                        to 
                                          
                                             
                                                ∑
                                                
                                                   r
                                                   ∈
                                                   Ω
                                                
                                             
                                             
                                                d
                                                
                                                   i
                                                   j
                                                   k
                                                   r
                                                
                                                ′
                                             
                                             
                                                z
                                                r
                                                *
                                             
                                          
                                        for all (i, j) ∈ A and all k ∈ Vc
                                       ;


                                       
                                          
                                             μ
                                             
                                                i
                                                j
                                             
                                             
                                                *
                                                p
                                             
                                          
                                        to 
                                          
                                             
                                                ∑
                                                
                                                   r
                                                   ∈
                                                   Ω
                                                
                                             
                                             
                                                t
                                                
                                                   i
                                                   j
                                                   r
                                                   p
                                                
                                             
                                             
                                                z
                                                r
                                                *
                                             
                                          
                                        for all (i, j) ∈ A and p ∈ P.

This quadruple has the same cost as z*, from the definition of cr
                               in the objective of the SP formulation. One can check that it also satisfies all of the linear constraints in the formulation MCF2K, i.e., the constraints (2), (3), (13)–(16), (20)–(24), (30), (31), (37) and (38).□


                        Theorem 5 implies that the lower bound from MCF2K is dominated by the lower bound from the SP formulation with elementary routes. We stress however that the former bound can be computed in pseudo-polynomial time, whereas the latter bound cannot (unless 
                           
                              P
                              =
                              
                                 N
                                 P
                              
                           
                        ).

In this section, we report on some computational experiments. We stress from the outset that the goal of these experiments was not to solve large-scale CVRP instances to proven optimality, but rather to establish dominance relations between the lower bounds obtained when solving the LP relaxation of various formulations. (The development of a viable exact algorithm for the CVRP based on formulation MCF2K may be the topic of a future paper.) We found that, for this purpose, it was sufficient to use small instances with 
                        
                           n
                           =
                           16
                        
                     . The advantage of using these instances is that the RC inequalities (4) can be enumerated and added to the LP relaxation if desired. (No efficient separation procedure is known for the RC inequalities.)

We created both asymmetric and symmetric instances. In the asymmetric instances, the costs cij
                      were randomly generated in [0, 500]. In the symmetric instances, the costs cij
                      were obtained by computing the Euclidean distance between locations randomly distributed in the square [0, 500] × [0, 500], except the depot, which was located in the centre of the square. We created instances with general demands (random integers in the range [25, 33]) and instances with only unit demands. For the instances with general demands, we considered Q ∈ {100, 150, 200}. For the instances with unit demands, we considered Q ∈ {4, 6, 8}. This led to 12 families of instances, and for each family we generated 20 instances. The instance generator and the formulations were implemented in FICO Xpress Mosel 3, and the source code is available to readers on request to the authors.


                     Table 1
                      gives the results for seven LP relaxations that only involve x-variables. The first column describes the instance type, and the remaining columns summarise the results that we obtained when adding various combinations of the SE, FC, GLM and RC inequalities to the LP relaxation consisting of (1)–(3) and non-negativity. Each figure is the average, over 20 instances, of the ratio between the lower bound and the optimum, expressed as a percentage. Table 2
                      gives analogous results for six LP relaxations that involve f-variables, Table 3
                      does the same for five relaxations that involve f- and g-variables, and Table 4
                      does the same for four SP relaxations, that involve x and z variables. Columns nSP and eSP refer to the SP relaxation with non-elementary and elementary routes, respectively. Columns nSP+RC and eSP+RC refer to the same relaxations strengthened with RC inequalities (4).

The main conclusion from the results in Table 1 is that the RC inequalities are the most important inequalities by far. Comparing Tables 1 and 2, we see that, as expected, MCF1a gives the same bound as the FC inequalities. We also see that the four new formulations give better bounds than MCF1a and MCF1b, and also better bounds than the SE and GLM inequalities combined. Note also that there is no dominance between MCF1a and MCF1b, but MCF1b tends to perform poorly. Moreover, as expected, MCF1c, MCF1d and MCF1K are of increasing strength. As for MCF3, we see that it appears to dominate MCF1c, but does not dominate MCF1d. Interestingly, MCF1K does not dominate MCF3, despite the fact that it satisfies all KLM inequalities and is weakly 
                        
                           N
                           P
                        
                     -hard to compute. Also, MCF1K gives the same bound as MCF1d in the unit demand case.

Turning our attention to Table 3, we see that MCF2a consistently gives worse bounds than the SE and GLM inequalities combined. As expected, MCF2b dominates MCF1d and MCF2a, and gives the same bound as MCF3 on the symmetric instances. Also as expected, MCF2K dominates MCF1K and MCF2b. In fact, it is significantly stronger than MCF1K in all cases. On the other hand, MCF2K gives the same bound as MCF2b in the unit demand case. Note also that using MCF2b or MCF2K in combination with the RC inequalities gives better results than using RC and GLM inequalities in combination. The difference is noticeable especially for the asymmetric instances.

Now consider Table 4. We see that, as expected, the SP relaxation with non-elementary routes dominates the GLM relaxation. On the other hand, it is weaker even than MCF1c in some cases, despite being weakly 
                        
                           N
                           P
                        
                     -hard to compute. Moreover, it neither dominates nor is dominated by MCF2K, which is also weakly 
                        
                           N
                           P
                        
                     -hard to compute. As for the SP relaxation with elementary routes, which is strongly 
                        
                           N
                           P
                        
                     -hard to compute, it dominates all of the MCF formulations. This is in accordance with Theorem 5. Finally, including RC inequalities makes a considerable difference in some cases.

To aid the reader, Fig. 1
                      shows all known dominance relations between all relaxations considered. An arrow from one relaxation to another indicates that the latter is stronger than the former.

@&#CONCLUSION@&#

In this paper, we have surveyed the known CVRP formulations based on additional commodity-flow variables, and introduced several new multi-commodity flow formulations that are provably stronger than all of them, in both theory and practice. Of particular interest is the formulation that we have called MCF2b, which is of polynomial size and yields lower bounds that are significantly stronger than those obtained by all other known formulations of polynomial size.

A natural question for future research is whether one could devise a competitive exact algorithm for the CVRP based upon one of our new formulations, or some similar formulation. To do this, some kind of decomposition scheme might be needed. Another interesting research topic would be to completely characterise the projections into x-space of the feasible regions of the LP relaxations of MCF1b to MCF1d, MCF2a and MCF2b, and possibly devise efficient separation routines for them, so that the additional flow variables could be avoided. Finally, one could attempt to adapt our formulations to other similar vehicle routing problems, such as the CVRP with pickup-and-delivery (Desaulniers, Desrosiers, Erdmann, Solomon, and Soumis, 2001), the multi-commodity TSP described by Hernández-Pérez and Salazar-González (2009), or the VRP with load-dependent costs (Kara et al., 2007).

@&#ACKNOWLEDGEMENTS@&#

The second author was supported by the research project MTM2012-36163-C06-01.

For ease of reference, we include here two of our multi-commodity flow formulations: MCF1d, which is the strongest known formulation of polynomial size that involves only x and f variables, and MCF2b, which is the strongest known formulation of polynomial size that involves x, f and g variables.
Formulation
                     
                        MCF1d
                     
                     :
                     
                        
                           
                              
                                 
                                    
                                       
                                          min
                                          
                                             ∑
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                A
                                             
                                          
                                          
                                             c
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                       
                                    
                                    
                                    
                                 
                                 
                                    
                                       
                                          s.t.
                                          
                                          
                                          x
                                          
                                             (
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             )
                                          
                                          =
                                          x
                                          
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             )
                                          
                                          =
                                          1
                                       
                                    
                                    
                                       
                                    
                                    
                                       
                                          (
                                          i
                                          ∈
                                          
                                             V
                                             c
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                       
                                    
                                    
                                    
                                       
                                          (
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                0
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                             )
                                          
                                          =
                                          1
                                       
                                    
                                    
                                    
                                       
                                          (
                                          k
                                          ∈
                                          
                                             V
                                             c
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                0
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                             )
                                          
                                          =
                                          0
                                       
                                    
                                    
                                    
                                       
                                          (
                                          k
                                          ∈
                                          
                                             V
                                             c
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             )
                                          
                                          
                                       
                                    
                                    
                                    
                                       
                                          (
                                          k
                                          ,
                                          i
                                          ∈
                                          
                                             V
                                             c
                                          
                                          :
                                          i
                                          ≠
                                          k
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          0
                                          ≤
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                             k
                                          
                                          ≤
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          (
                                          k
                                          ∈
                                          
                                             V
                                             c
                                          
                                          ,
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          A
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   V
                                                   c
                                                
                                                ∖
                                                
                                                   {
                                                   i
                                                   ,
                                                   j
                                                   }
                                                
                                             
                                          
                                          
                                             q
                                             k
                                          
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                             k
                                          
                                          ≤
                                          
                                             (
                                             Q
                                             −
                                             
                                                q
                                                i
                                             
                                             −
                                             
                                                q
                                                j
                                             
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          (
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   V
                                                   c
                                                
                                                ∖
                                                
                                                   {
                                                   k
                                                   }
                                                
                                             
                                          
                                          
                                             q
                                             i
                                          
                                          
                                             (
                                             
                                                f
                                                k
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                )
                                             
                                             +
                                             
                                                f
                                                i
                                             
                                             
                                                (
                                                
                                                   δ
                                                   +
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                                )
                                             
                                             )
                                          
                                          ≤
                                          Q
                                          −
                                          
                                             q
                                             k
                                          
                                       
                                    
                                    
                                    
                                       
                                          (
                                          k
                                          ∈
                                          
                                             V
                                             c
                                          
                                          )
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                     Formulation
                     
                        MCF2b
                     
                     :
                     
                        
                           
                              
                                 
                                    
                                       
                                          min
                                          
                                             ∑
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                A
                                             
                                          
                                          
                                             c
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          
                                       
                                    
                                    
                                    
                                 
                                 
                                    
                                       
                                          s.t.
                                          
                                          
                                          x
                                          
                                             (
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             )
                                          
                                          =
                                          x
                                          
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             )
                                          
                                          =
                                          1
                                       
                                    
                                    
                                    
                                       
                                          (
                                          i
                                          ∈
                                          
                                             V
                                             c
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                       
                                    
                                    
                                    
                                       
                                          (
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                0
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             g
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             g
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                0
                                                )
                                             
                                             )
                                          
                                          =
                                          1
                                       
                                    
                                    
                                    
                                       
                                          (
                                          k
                                          ∈
                                          
                                             V
                                             c
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                0
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             g
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             g
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                0
                                                )
                                             
                                             )
                                          
                                          =
                                          0
                                       
                                    
                                    
                                    
                                       
                                          (
                                          k
                                          ∈
                                          
                                             V
                                             c
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             f
                                             k
                                          
                                          
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             g
                                             i
                                          
                                          
                                             (
                                             
                                                δ
                                                +
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             g
                                             i
                                          
                                          
                                             (
                                             
                                                δ
                                                −
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                             )
                                          
                                          
                                       
                                    
                                    
                                    
                                       
                                          (
                                          k
                                          ,
                                          i
                                          ∈
                                          
                                             V
                                             c
                                          
                                          :
                                          i
                                          ≠
                                          k
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                             k
                                          
                                          ,
                                          
                                             g
                                             
                                                i
                                                j
                                             
                                             k
                                          
                                          ≥
                                          0
                                          ;
                                          
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                             k
                                          
                                          +
                                          
                                             g
                                             
                                                i
                                                j
                                             
                                             k
                                          
                                          ≤
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          (
                                          k
                                          ∈
                                          
                                             V
                                             c
                                          
                                          ,
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          A
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   V
                                                   c
                                                
                                                ∖
                                                
                                                   {
                                                   i
                                                   ,
                                                   j
                                                   }
                                                
                                             
                                          
                                          
                                             q
                                             k
                                          
                                          
                                             (
                                             
                                                f
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             +
                                             
                                                g
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             )
                                          
                                          ≤
                                          
                                             (
                                             Q
                                             −
                                             
                                                q
                                                i
                                             
                                             −
                                             
                                                q
                                                j
                                             
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          (
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          )
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

@&#REFERENCES@&#

