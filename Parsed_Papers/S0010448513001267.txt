@&#MAIN-TITLE@&#Efficient time-optimal feedrate planning under dynamic constraints for a high-order CNC servo system

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A relationship between the tracking error and the input signal is established.


                        
                        
                           
                           The tracking error constraint for a CNC system is reduced to a kinematic constraint.


                        
                        
                           
                           The nonlinear constraints on jerk are reduced to linear constraints.


                        
                        
                           
                           Feedrate planning under confined tracking error is reduced to convex optimization.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Time-optimal feedrate planning

Tracking error

Jerk

High-order CNC servo system

Convex optimization

@&#ABSTRACT@&#


               
               
                  In this paper, the time-optimal feedrate planning problem under confined feedrate, axis velocity, axis acceleration, axis jerk, and axis tracking error for a high-order CNC servo system is studied. The problem is useful in that the full ability of the CNC machine is used to enhance the machining productivity while keeping the machining precision under a given level. However, the problem is computationally challenging. The main contribution of this paper is to approximate the problem nicely by a finite-state convex optimization problem which can be solved efficiently. The method consists of two key ingredients. First, a relationship between the tracking error and the input signal in a high-order CNC servo system is established. As a consequence, the tracking error constraint is reduced to a constraint on the kinematic quantities. Second, a novel method is introduced to relax the nonlinear constraints on kinematic quantities to linear ones. Experimental results are used to validate the proposed method.
               
            

@&#INTRODUCTION@&#

The problem of time-optimal feedrate planning along a given parametric tool path has received a significant amount of attention in the CNC machining literature due to its ability to increase the productivity of CNC machining by using the full ability of the machines  [1–13]. The feedrate planning problem is usually formulated as a time-minimum optimal control problem under kinematic constraints such as confined feedrate, axis acceleration, jerk, and even jounce, and efficient algorithms have been proposed to solve the problem. The acceleration bounds are introduced to reduce inertia and prevent mechanical shocks. The jerk and jounce bounds are used to generate smooth feedrate profiles aimed at improving the machining quality.

For various reasons, such as the inertia of the CNC axes and inaccurate modeling of the CNC dynamic system, the tracking error is not guaranteed to reach the desired level even if the acceleration and jerk are bounded. A common method to reduce tracking errors is to use a closed-loop controller which calculates the difference between the desired signal and the feedback signal in real time and generates a control signal to minimize the dynamic error. Many algorithms along this line have been developed, such as the cross-coupled control strategy  [14,15], the model-referenced adaptive control  [16], the predictive control [17], and the learning control  [18]. In order to use these closed-loop methods, users need to access the control system, which demands more from the end-users.

An alternative approach is to combine “open-loop” feedrate planning with dynamic precision control by adding a tracking error bound as a new constraint in the feedrate planning phase. An advantage of this approach is that accessing the control system is not required, and hence this is more convenient for the end-users. Dong and Stori  [19,20] considered the dynamic error information in the feedrate planning phase by approximating the tracking error with the linear part of its Taylor expansion. Ernesto and Farouki  [4] solved the problem of compensating for inertia and damping of the machine axes by a priori modifying the commanded tool path. In  [21,22], Lin, Tsai, et al. used critical point approaches to generate a feedrate with confined contouring errors. In  [23], a linear programming method is proposed to solve the feedrate planning problem under confined tracking error for CNC systems based on PD controllers.

In this paper, the time-minimum feedrate planning problem under confined feedrate, axis velocity, axis acceleration, axis jerk, and axis tracking error is studied. To be practical, dynamic systems with PID controllers are considered, where the tracking error satisfies a third-order differential equation. The time-minimum feedrate planning problem in this situation is strongly nonlinear, and there exist no efficient algorithms for solving it at present. The main contribution of this paper is to reduce the time-minimum feedrate planning problem into a finite-state convex optimization problem whose global optimal solution can be computed efficiently. The work consists of two key ingredients. First, a relationship between the tracking error and the input signal in high-order CNC servo systems is established. As a consequence, the tracking error constraint can be reduced to a constraint on a linear combination of kinematic quantities such as accelerations and jerks. Second, a novel method is introduced to relax the nonlinear constraints involving the jerk to linear constraints. Experimental results show that the new convex optimization problem gives a nice approximation to the original problem and can be solved efficiently.

In contrast to the work reported in  [19,4,23], high-order CNC servo systems are considered, which allows the usage of PID controllers, while the work reported in  [19,4,23] only considered second-order systems for P or PD controllers. Furthermore, the relaxation of the tracking error in this paper is theoretically guaranteed to be valid, while the one given in  [19] is an approximation. Also, our approach reduces the optimal feedrate planning problem into a convex programming problem which can be solved efficiently. The method proposed in  [10], although more general than ours, is less efficient. In contrast to  [21,22], our approach generates an approximate time minimum feedrate, while the feedrate generated with methods in  [21,22] is not time minimum. And in contrast to  [9], which initiates the powerful convex optimization approach, we consider a much more general and non-convex problem which is reduced to a convex optimization problem, while the problem considered in  [9] is itself convex.

The paper is organized as follows. Section  2 describes high-order dynamic models and shows how to simplify the tracking error constraint. Section  3 presents an efficient method to solve the time-minimum feedrate planning problem by converting it to a convex optimization problem. In Section  4, experimental results are used to demonstrate the effectiveness of the approach. In Section  5, concluding remarks are given.

In this section, we will show that the tracking error constraint can be replaced by a constraint on kinematic quantities such as accelerations and jerks.

Suppose that the CNC machine is controlled by 
                           M
                         axes; the subscript 
                           τ
                           ∈
                           
                              {
                              1
                              ,
                              …
                              ,
                              M
                              }
                           
                         will represent these axes. Each axis is powered by a DC motor satisfying an 
                           n
                        th-order linear system whose transfer function is  [24, p. 70]
                        
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       τ
                                    
                                 
                                 
                                    (
                                    s
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             τ
                                          
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                    
                                       
                                          
                                             X
                                          
                                          
                                             τ
                                          
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             m
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             m
                                          
                                       
                                       +
                                       
                                          
                                             b
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       +
                                       ⋯
                                       +
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       s
                                       +
                                       
                                          
                                             b
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             n
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       +
                                       ⋯
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       s
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 X
                              
                              
                                 τ
                              
                           
                         and 
                           
                              
                                 x
                              
                              
                                 τ
                              
                           
                         are the commanded axis location and the actual axis location, respectively.

Using the closed-form position control shown in Fig. 1
                        , we can calculate the transfer function between the tracking error 
                        
                           
                              
                                 e
                              
                              
                                 τ
                              
                           
                           =
                           
                              
                                 X
                              
                              
                                 τ
                              
                           
                           −
                           
                              
                                 x
                              
                              
                                 τ
                              
                           
                         and the input signal 
                           
                              
                                 X
                              
                              
                                 τ
                              
                           
                        : 
                           
                              
                                 G
                                 
                                    (
                                    s
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             τ
                                          
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                    
                                       
                                          
                                             X
                                          
                                          
                                             τ
                                          
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                n
                                             
                                          
                                          +
                                          
                                             
                                                a
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          +
                                          ⋯
                                          +
                                          
                                             
                                                a
                                             
                                             
                                                1
                                             
                                          
                                          s
                                          +
                                          
                                             
                                                a
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                m
                                             
                                          
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                m
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                m
                                                −
                                                1
                                             
                                          
                                          +
                                          ⋯
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          s
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             n
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       +
                                       ⋯
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       s
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             l
                                          
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             l
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             l
                                             −
                                             1
                                          
                                       
                                       +
                                       ⋯
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       s
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             n
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       +
                                       ⋯
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       s
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           l
                           ≤
                           max
                           
                              (
                              m
                              ,
                              n
                              )
                           
                        . Using the inverse Laplace transformation of the above equation, if the initial values of 
                           
                              
                                 e
                              
                              
                                 τ
                              
                           
                           
                              (
                              t
                              )
                           
                         and its derivatives are zero, then the tracking error 
                           
                              
                                 e
                              
                              
                                 τ
                              
                           
                           
                              (
                              t
                              )
                           
                         satisfies the following differential equation: 
                           
                              (2.1)
                              
                                 
                                    
                                       a
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             e
                                          
                                          
                                             τ
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          
                                             t
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             e
                                          
                                          
                                             τ
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          
                                             t
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          
                                             e
                                          
                                          
                                             τ
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       τ
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             τ
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          
                                             t
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       l
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             l
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             τ
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          
                                             t
                                          
                                          
                                             l
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          
                                             X
                                          
                                          
                                             τ
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       τ
                                    
                                 
                                 ,
                              
                           
                         where 
                           t
                         represents time. In order for the above system in 
                           
                              
                                 e
                              
                              
                                 τ
                              
                           
                         to be stable, the real parts of the eigenvalues of the linear system on the left-hand side of (2.1) are assumed to be negative  [24, p. 76]. More precisely, the roots of the following character equation of system (2.1)
                        
                           
                              (2.2)
                              
                                 
                                    
                                       a
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       n
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 λ
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                              
                           
                         are assumed to have negative real parts.

Now, the problem of optimal trajectory planning along a given tool-path can be formulated as the following time-minimum control problem under kinematic constraints and tracking error constraints: 
                           
                              (2.3)
                              
                                 min
                                 T
                                 
                                 s
                                 .
                                 t
                                 .
                                 
                                 
                                    |
                                    
                                       
                                          
                                             d
                                          
                                          
                                             
                                                X
                                             
                                             
                                                τ
                                             
                                          
                                       
                                       
                                          
                                             d
                                          
                                          t
                                       
                                    
                                    |
                                 
                                 ≤
                                 
                                    
                                       X
                                    
                                    
                                       max
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    |
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                τ
                                             
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    |
                                 
                                 ≤
                                 
                                    
                                       X
                                    
                                    
                                       max
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    |
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                τ
                                             
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             
                                                t
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                    |
                                 
                                 ≤
                                 
                                    
                                       X
                                    
                                    
                                       max
                                    
                                    
                                       m
                                    
                                 
                                 ,
                                 
                                    |
                                    
                                       
                                          e
                                       
                                       
                                          τ
                                       
                                    
                                    |
                                 
                                 ≤
                                 
                                    
                                       E
                                    
                                    
                                       max
                                    
                                 
                                 ,
                              
                           
                         where 
                           τ
                           ∈
                           
                              {
                              1
                              ,
                              …
                              ,
                              M
                              }
                           
                         represents the axes, 
                           m
                         is a positive integer to be given by the user, 
                           
                              
                                 X
                              
                              
                                 max
                              
                              
                                 j
                              
                           
                         are positive real numbers, and 
                           
                              
                                 e
                              
                              
                                 τ
                              
                           
                           
                              (
                              t
                              )
                           
                         satisfies Eq. (2.1).

Note that the number 
                           m
                         determines the smoothness of the velocity functions to be obtained. For instance, if 
                           m
                           =
                           2
                        , then the acceleration is bounded and the velocity function is continuous; if 
                           m
                           =
                           3
                        , then the acceleration and the jerk are bounded, and the velocity function is differentiable; and if 
                           m
                           =
                           4
                        , then the acceleration, jerk, and jounce are bounded, and the acceleration function is differentiable. Generally speaking, the smoother the velocity function is, the less vibration occurs, as shown in [5].

The last constraint of (2.3) is difficult to deal with since it will lead to complicated equations when solving the optimization problem via discrete methods. In this section, we will show that the tracking error constraint can be replaced with a constraint on the kinematic quantities. More precisely, we have the following.


                        
                           Theorem 2.1
                           
                              Let 
                              
                                 
                                    
                                       e
                                    
                                    
                                       τ
                                    
                                 
                               
                              be the tracking error for the 
                              
                                 τ
                               
                              axis, which satisfies   (2.1)   and has initial values 
                              
                                 
                                    
                                       e
                                    
                                    
                                       τ
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          d
                                       
                                       
                                          
                                             e
                                          
                                          
                                             τ
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       t
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 ⋯
                                 =
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             e
                                          
                                          
                                             τ
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          
                                             t
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 0
                               
                              . Then
                              
                                 
                                    (2.4)
                                    
                                       
                                          |
                                          
                                             
                                                c
                                             
                                             
                                                l
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                      l
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      τ
                                                   
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      l
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                l
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                      l
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      τ
                                                   
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      l
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                          +
                                          ⋯
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      τ
                                                   
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                τ
                                             
                                          
                                          |
                                       
                                       ≤
                                       δ
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                    
                                 
                              
                              implies that 
                              
                                 
                                    |
                                    
                                       
                                          e
                                       
                                       
                                          τ
                                       
                                    
                                    |
                                 
                                 ≤
                                 
                                    
                                       E
                                    
                                    
                                       max
                                    
                                 
                               
                              . The constant 
                              
                                 δ
                               
                              in   (2.4)   is 
                              
                                 
                                    
                                       a
                                    
                                    
                                       0
                                    
                                 
                               
                              in   (2.1)   if the roots of Eq.   (2.2)   are real numbers and is computed with   (2.7)   otherwise.
                           

The above theorem will be proved in the rest of this section. Two cases will be considered according to whether the roots of Eq. (2.2) are real numbers or not. First, we deal with the easier case given in the following theorem. 
                           Theorem 2.2
                           
                              Let 
                              
                                 y
                                 
                                    (
                                    t
                                    )
                                 
                               
                              be a function in time 
                              
                                 t
                              
                              , which satisfies the following 
                              
                                 n
                              
                              th-order ordinary differential equation (ODE):
                              
                                 
                                    (2.5)
                                    
                                       
                                          
                                             a
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                             y
                                          
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             y
                                          
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       +
                                       ⋯
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                d
                                             
                                             y
                                          
                                          
                                             
                                                d
                                             
                                             t
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             0
                                          
                                       
                                       y
                                       =
                                       g
                                       
                                          (
                                          t
                                          )
                                       
                                       ,
                                    
                                 
                              
                              where 
                              
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                               
                              are constants and 
                              
                                 g
                                 
                                    (
                                    t
                                    )
                                 
                               
                              is a nonlinear function in 
                              
                                 t
                               
                              . Furthermore, assume that 
                              
                                 y
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 ⋯
                                 =
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       y
                                    
                                    
                                       
                                          d
                                       
                                       
                                          
                                             t
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 0
                               
                              and that the roots of Eq.
                              (2.2)   are negative real numbers. Then, for a constant 
                              
                                 M
                              
                              , 
                              
                                 
                                    |
                                    g
                                    
                                       (
                                       t
                                       )
                                    
                                    |
                                 
                                 ≤
                                 
                                    |
                                    
                                       
                                          a
                                       
                                       
                                          0
                                       
                                    
                                    |
                                 
                                 M
                               
                              implies that 
                              
                                 
                                    |
                                    y
                                    
                                       (
                                       t
                                       )
                                    
                                    |
                                 
                                 ≤
                                 M
                              
                              .
                           

In order to prove the above theorem, the following lemma is needed, which is from  [23].


                        
                           Lemma 2.3
                           
                              Let 
                              
                                 y
                                 
                                    (
                                    t
                                    )
                                 
                               
                              be a differentiable function in the time domain 
                              
                                 t
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    ∞
                                    )
                                 
                               
                              such that 
                              
                                 y
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 0
                              
                              , and let 
                              
                                 M
                               
                              and 
                              
                                 r
                               
                              be positive real numbers. If 
                              
                                 y
                               
                              satisfies 
                              
                                 
                                    |
                                    r
                                    
                                       
                                          
                                             d
                                          
                                          y
                                       
                                       
                                          
                                             d
                                          
                                          t
                                       
                                    
                                    +
                                    y
                                    |
                                 
                                 ≤
                                 M
                              
                              , then 
                              
                                 
                                    |
                                    y
                                    |
                                 
                                 ≤
                                 M
                              
                              .
                           


                        
                           Proof of Theorem 2.2
                           By the assumption of the theorem, the roots of the character equation (2.2) are negative real numbers, which are denoted by 
                                 −
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 ,
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              , 
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 >
                                 0
                              . Then, the character equation (2.2) of the left-hand side of system (2.5) can be expressed as 
                                 
                                    
                                       f
                                       
                                          (
                                          λ
                                          )
                                       
                                       /
                                       
                                          
                                             a
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                          λ
                                          +
                                          1
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          λ
                                          +
                                          1
                                          )
                                       
                                       ⋯
                                       
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                n
                                             
                                          
                                          λ
                                          +
                                          1
                                          )
                                       
                                       =
                                       0
                                       .
                                    
                                 
                               Define 
                                 
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         y
                                                      
                                                      
                                                         
                                                            d
                                                         
                                                         t
                                                      
                                                   
                                                   +
                                                   y
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            d
                                                         
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   ⋯
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               n
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            d
                                                         
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         n
                                                         −
                                                         1
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                               It is easy to verify that the left-hand side of (2.5) becomes 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                y
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                a
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                                y
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                          +
                                          ⋯
                                          +
                                          
                                             
                                                a
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                y
                                             
                                             
                                                
                                                   d
                                                
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                a
                                             
                                             
                                                0
                                             
                                          
                                          y
                                          )
                                       
                                       /
                                       
                                          
                                             a
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       
                                          
                                             z
                                          
                                          
                                             n
                                          
                                       
                                       =
                                       
                                          
                                             d
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             z
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       =
                                       g
                                       
                                          (
                                          t
                                          )
                                       
                                       /
                                       
                                          
                                             a
                                          
                                          
                                             0
                                          
                                       
                                       .
                                    
                                 
                               Thus, by Lemma 2.3, from 
                                 
                                    |
                                    g
                                    
                                       (
                                       t
                                       )
                                    
                                    /
                                    
                                       
                                          a
                                       
                                       
                                          0
                                       
                                    
                                    |
                                 
                                 ≤
                                 M
                              , we have 
                                 
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    |
                                 
                                 ≤
                                 M
                              . Since 
                                 
                                    
                                       z
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       n
                                       −
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       n
                                       −
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       d
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 >
                                 0
                              , using Lemma 2.3 again, we have 
                                 
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          n
                                          −
                                          2
                                       
                                    
                                    |
                                 
                                 ≤
                                 M
                              . Repeatedly, we have 
                                 
                                    |
                                    y
                                    |
                                 
                                 ≤
                                 M
                              , which proves the theorem.■

The second case, where Eq. (2.2) has complex roots, is more involved. Before giving the result, some notation and a lemma are needed.

Let 
                           R
                         be the set of real numbers, 
                           x
                           ∈
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        , and 
                           A
                           ∈
                           
                              
                                 R
                              
                              
                                 n
                                 ×
                                 n
                              
                           
                        . Then it is well known that the following vector 1-norm and matrix 1-norm
                        
                           
                              
                                 
                                    
                                       
                                          ‖
                                          x
                                          ‖
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    |
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    |
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          ‖
                                          A
                                          ‖
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       1
                                       ≤
                                       j
                                       ≤
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    |
                                    
                                       
                                          a
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    |
                                 
                              
                           
                         satisfy the following compatible condition: 
                           
                              
                                 
                                    
                                       
                                          ‖
                                          A
                                          x
                                          ‖
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    
                                       
                                          ‖
                                          A
                                          ‖
                                       
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          x
                                          ‖
                                       
                                    
                                    
                                       1
                                    
                                 
                                 .
                              
                           
                        
                     

Besides, the following lemma is needed. 
                           Lemma 2.4
                           
                              Let 
                              
                                 x
                                 =
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                 
                               
                              and let 
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               
                              be integrable functions from 
                              
                                 R
                               
                              to 
                              
                                 R
                               
                              . Then
                              
                                 
                                    
                                       
                                          
                                             
                                                ‖
                                                
                                                   
                                                      ∫
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      b
                                                   
                                                
                                                x
                                                
                                                   (
                                                   τ
                                                   )
                                                
                                                
                                                   d
                                                
                                                τ
                                                ‖
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ≤
                                       
                                          
                                             ∫
                                          
                                          
                                             a
                                          
                                          
                                             b
                                          
                                       
                                       
                                          
                                             
                                                ‖
                                                x
                                                
                                                   (
                                                   τ
                                                   )
                                                
                                                ‖
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          d
                                       
                                       τ
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           
                              
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                ∫
                                             
                                             
                                                a
                                             
                                             
                                                b
                                             
                                          
                                          x
                                          
                                             (
                                             τ
                                             )
                                          
                                          
                                             d
                                          
                                          τ
                                          ‖
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    |
                                    
                                       
                                          ∫
                                       
                                       
                                          a
                                       
                                       
                                          b
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       τ
                                       )
                                    
                                    
                                       d
                                    
                                    τ
                                    |
                                 
                                 ≤
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       a
                                    
                                    
                                       b
                                    
                                 
                                 
                                    |
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       τ
                                       )
                                    
                                    |
                                 
                                 
                                    d
                                 
                                 τ
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       a
                                    
                                    
                                       b
                                    
                                 
                                 
                                    {
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          τ
                                          )
                                       
                                       |
                                    
                                    }
                                 
                                 
                                    d
                                 
                                 τ
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       a
                                    
                                    
                                       b
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          x
                                          
                                             (
                                             τ
                                             )
                                          
                                          ‖
                                       
                                    
                                    
                                       1
                                    
                                 
                                 
                                    d
                                 
                                 τ
                              .■

The following theorem simplifies the tracking error in the second case. 
                           Theorem 2.5
                           
                              Let 
                              
                                 y
                                 
                                    (
                                    t
                                    )
                                 
                               
                              be a function in time 
                              
                                 t
                              
                              , which satisfies the following 
                              
                                 n
                              
                              th-order ODE:
                              
                                 
                                    (2.6)
                                    
                                       
                                          
                                             a
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                             y
                                          
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             y
                                          
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       +
                                       ⋯
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                d
                                             
                                             y
                                          
                                          
                                             
                                                d
                                             
                                             t
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             0
                                          
                                       
                                       y
                                       =
                                       g
                                       
                                          (
                                          t
                                          )
                                       
                                       ,
                                    
                                 
                              
                              where 
                              
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                               
                              are constants and 
                              
                                 g
                                 
                                    (
                                    t
                                    )
                                 
                               
                              is a nonlinear function in 
                              
                                 t
                               
                              . Furthermore, assume that 
                              
                                 y
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 ⋯
                                 =
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       y
                                    
                                    
                                       
                                          d
                                       
                                       
                                          
                                             t
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 0
                               
                              . Then, for a constant 
                              
                                 M
                              
                              , 
                              
                                 
                                    |
                                    g
                                    
                                       (
                                       t
                                       )
                                    
                                    |
                                 
                                 ≤
                                 δ
                                 M
                               
                              implies that 
                              
                                 
                                    |
                                    y
                                    |
                                 
                                 ≤
                                 M
                              
                              , where the constant 
                              
                                 δ
                               
                              is calculated using
                              
                                 
                                    (2.7)
                                    
                                       δ
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   ∫
                                                
                                                
                                                   0
                                                
                                                
                                                   ∞
                                                
                                             
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            τ
                                                            A
                                                         
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                d
                                             
                                             τ
                                          
                                       
                                    
                                 
                              
                              for 
                              
                                 A
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   ⋯
                                                
                                             
                                             
                                                
                                                   ⋯
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               n
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       n
                                       ×
                                       n
                                    
                                 
                              .


                        
                           Proof
                           We rewrite the ODE (2.6) in matrix form: 
                                 
                                    (2.8)
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                y
                                             
                                          
                                          
                                             
                                                d
                                             
                                             t
                                          
                                       
                                       =
                                       A
                                       
                                          y
                                       
                                       +
                                       
                                          g
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       ,
                                    
                                 
                               where 
                                 
                                    y
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          y
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          
                                             
                                                y
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                              , 
                                 
                                    g
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          0
                                          ,
                                          0
                                          ,
                                          …
                                          ,
                                          0
                                          ,
                                          g
                                          
                                             (
                                             t
                                             )
                                          
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                              , and matrix 
                                 A
                               is given in the theorem to be proved. Obviously, 
                                 
                                    
                                       
                                          |
                                          λ
                                          I
                                          −
                                          A
                                          |
                                       
                                       =
                                       det
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         ⋯
                                                      
                                                   
                                                   
                                                      
                                                         ⋯
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         λ
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     a
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     a
                                                                  
                                                                  
                                                                     n
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     a
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     a
                                                                  
                                                                  
                                                                     n
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         λ
                                                         +
                                                         
                                                            
                                                               
                                                                  
                                                                     a
                                                                  
                                                                  
                                                                     n
                                                                     −
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     a
                                                                  
                                                                  
                                                                     n
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             n
                                             ×
                                             n
                                          
                                       
                                       .
                                    
                                 
                              Expand this determinant along the last column:


                              
                                 
                                    
                                       
                                          |
                                          λ
                                          I
                                          −
                                          A
                                          |
                                       
                                       =
                                       
                                          (
                                          λ
                                          +
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   n
                                                   −
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             n
                                             −
                                             2
                                          
                                       
                                       +
                                       ⋯
                                       +
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       λ
                                       +
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                               which is the character equation of (2.6). Hence, the eigenvalues of 
                                 A
                               are the same as the roots of Eq. (2.2).

According to the theory of differential equations, the solution of (2.8) can be calculated as 
                                 
                                    
                                       
                                          y
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          
                                             e
                                          
                                          
                                             
                                                (
                                                t
                                                )
                                             
                                             A
                                          
                                       
                                       
                                          y
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       +
                                       
                                          
                                             ∫
                                          
                                          
                                             0
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             e
                                          
                                          
                                             
                                                (
                                                t
                                                −
                                                τ
                                                )
                                             
                                             A
                                          
                                       
                                       
                                          g
                                       
                                       
                                          (
                                          τ
                                          )
                                       
                                       
                                          d
                                       
                                       τ
                                       ,
                                    
                                 
                               where 
                                 
                                    y
                                 
                                 
                                    (
                                    0
                                    )
                                 
                               is the initial value. Since 
                                 
                                    y
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 
                                    0
                                 
                              , according to the definition of vector norm and Lemma 2.4, we have 
                                 
                                    
                                       
                                          
                                             
                                                ‖
                                                
                                                   y
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                ‖
                                             
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ‖
                                                
                                                   
                                                      ∫
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      
                                                         (
                                                         t
                                                         −
                                                         τ
                                                         )
                                                      
                                                      A
                                                   
                                                
                                                
                                                   g
                                                
                                                
                                                   (
                                                   τ
                                                   )
                                                
                                                
                                                   d
                                                
                                                τ
                                                ‖
                                             
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ‖
                                                
                                                   
                                                      ∫
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      τ
                                                      A
                                                   
                                                
                                                
                                                   g
                                                
                                                
                                                   (
                                                   t
                                                   −
                                                   τ
                                                   )
                                                
                                                
                                                   d
                                                
                                                τ
                                                ‖
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ≤
                                       
                                          
                                             ∫
                                          
                                          
                                             0
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             
                                                ‖
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      τ
                                                      A
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                ‖
                                                
                                                   g
                                                
                                                
                                                   (
                                                   t
                                                   −
                                                   τ
                                                   )
                                                
                                                ‖
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          d
                                       
                                       τ
                                       .
                                    
                                 
                               Thus 
                                 
                                    
                                       
                                          |
                                          y
                                          |
                                       
                                       ≤
                                       
                                          
                                             
                                                ‖
                                                
                                                   y
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                ‖
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ≤
                                       δ
                                       M
                                       
                                          
                                             ∫
                                          
                                          
                                             0
                                          
                                          
                                             ∞
                                          
                                       
                                       
                                          
                                             
                                                ‖
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      τ
                                                      A
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          d
                                       
                                       τ
                                       ≤
                                       M
                                       .
                                    
                                 
                               Since the roots of (2.2) have negative real parts, 
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       ∞
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                e
                                             
                                             
                                                τ
                                                A
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       1
                                    
                                 
                                 
                                    d
                                 
                                 τ
                               exists, and the theorem is proved.■

In most cases, error-based feedback controllers are based on PID controllers whose control parameters are the proportional, integral, and derivative gains 
                           
                              
                                 k
                              
                              
                                 P
                              
                           
                        , 
                           
                              
                                 k
                              
                              
                                 I
                              
                           
                        , and 
                           
                              
                                 k
                              
                              
                                 D
                              
                           
                        , respectively. An illustration is given in Fig. 2
                        , where 
                           
                              
                                 e
                              
                              
                                 τ
                              
                           
                           =
                           
                              
                                 X
                              
                              
                                 τ
                              
                           
                           −
                           
                              
                                 x
                              
                              
                                 τ
                              
                           
                         is the tracking error. The other parameters are explained below. The current amplifier 
                           
                              
                                 k
                              
                              
                                 a
                              
                           
                         converts the actuating signal 
                           u
                         into the current 
                           i
                         to control the motor, which produces a torque 
                           T
                         through the motor torque gain 
                           
                              
                                 k
                              
                              
                                 t
                              
                           
                        . The torque 
                           T
                         determines the angular speed through the system inertia 
                           J
                         and damping 
                           B
                        . The motor shaft angle 
                           θ
                        , obtained by integration of the motor shaft angle speed 
                           w
                        , determines the axis linear position 
                           x
                         through the transmission ratio 
                           
                              
                                 r
                              
                              
                                 g
                              
                           
                        . Besides, set 
                           K
                           =
                           
                              
                                 k
                              
                              
                                 a
                              
                           
                           
                              
                                 k
                              
                              
                                 t
                              
                           
                           
                              
                                 r
                              
                              
                                 g
                              
                           
                        , since these three parameters often occur in this product form. Then, the tracking error and the input signal satisfy the following dynamic equation: 
                           
                              (2.9)
                              
                                 J
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             e
                                          
                                          
                                             τ
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             3
                                          
                                       
                                       t
                                    
                                 
                                 +
                                 
                                    (
                                    B
                                    +
                                    K
                                    
                                       
                                          k
                                       
                                       
                                          D
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             e
                                          
                                          
                                             τ
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             2
                                          
                                       
                                       t
                                    
                                 
                                 +
                                 K
                                 
                                    
                                       k
                                    
                                    
                                       P
                                    
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          
                                             e
                                          
                                          
                                             τ
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       t
                                    
                                 
                                 +
                                 K
                                 
                                    
                                       k
                                    
                                    
                                       I
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       τ
                                    
                                 
                                 =
                                 J
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             τ
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             3
                                          
                                       
                                       t
                                    
                                 
                                 +
                                 B
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             τ
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             2
                                          
                                       
                                       t
                                    
                                 
                                 =
                                 J
                                 
                                    
                                       j
                                    
                                    
                                       τ
                                    
                                 
                                 +
                                 B
                                 
                                    
                                       a
                                    
                                    
                                       τ
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 a
                              
                              
                                 τ
                              
                           
                         and 
                           
                              
                                 j
                              
                              
                                 τ
                              
                           
                         are the acceleration and the jerk of the 
                           τ
                         axis.

Notice that a third-order system with real coefficients has either one real eigenvalue or three real eigenvalues, and explicit criteria can be given for these cases. Thus, we have the following simplification criterion for system (2.9).


                        
                           Theorem 2.6
                           
                              Let the tracking error 
                              
                                 
                                    
                                       e
                                    
                                    
                                       τ
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                               
                              satisfy the initial values 
                              
                                 
                                    
                                       e
                                    
                                    
                                       τ
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          d
                                       
                                       
                                          
                                             e
                                          
                                          
                                             τ
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       t
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             e
                                          
                                          
                                             τ
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             2
                                          
                                       
                                       t
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 0
                               
                              . Then the tracking error constraint 
                              
                                 
                                    |
                                    
                                       
                                          e
                                       
                                       
                                          τ
                                       
                                    
                                    |
                                 
                                 ≤
                                 
                                    
                                       E
                                    
                                    
                                       max
                                    
                                 
                               
                              can be replaced by
                              
                                 
                                    (2.10)
                                    
                                       
                                          |
                                          
                                             
                                                J
                                             
                                             
                                                K
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      I
                                                   
                                                
                                             
                                          
                                          
                                             
                                                j
                                             
                                             
                                                τ
                                             
                                          
                                          +
                                          
                                             
                                                B
                                             
                                             
                                                K
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      I
                                                   
                                                
                                             
                                          
                                          
                                             
                                                a
                                             
                                             
                                                τ
                                             
                                          
                                          |
                                       
                                       ≤
                                       δ
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                       ,
                                    
                                 
                              
                              where 
                              
                                 δ
                               
                              is determined as follows. Let
                              
                                 
                                    
                                       d
                                       =
                                       4
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         (
                                                         B
                                                         +
                                                         K
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               D
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                3
                                                J
                                                K
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      P
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       
                                          (
                                          2
                                          
                                             
                                                
                                                   (
                                                   B
                                                   +
                                                   K
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         D
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                3
                                             
                                          
                                          −
                                          9
                                          J
                                          
                                             (
                                             B
                                             +
                                             k
                                             
                                                
                                                   k
                                                
                                                
                                                   D
                                                
                                             
                                             )
                                          
                                          K
                                          
                                             
                                                k
                                             
                                             
                                                P
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          27
                                          K
                                          
                                             
                                                k
                                             
                                             
                                                I
                                             
                                          
                                          
                                             
                                                J
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                              Then, if 
                              
                                 d
                                 >
                                 0
                              
                              , we can set 
                              
                                 δ
                                 =
                                 1
                               
                              . If 
                              
                                 d
                                 <
                                 0
                              
                              , 
                              
                                 δ
                               
                              is calculated with   (2.7)
                              .
                           


                        
                           Proof
                           We need to know when the following cubic equation 
                                 
                                    (2.11)
                                    
                                       J
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       
                                          (
                                          B
                                          +
                                          K
                                          
                                             
                                                k
                                             
                                             
                                                D
                                             
                                          
                                          )
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       K
                                       
                                          
                                             k
                                          
                                          
                                             P
                                          
                                       
                                       λ
                                       +
                                       K
                                       
                                          
                                             k
                                          
                                          
                                             I
                                          
                                       
                                       =
                                       0
                                    
                                 
                               has real or complex roots. A cubic equation has either one or three real roots. Following the criterion given in  [25, p. 299], if 
                                 d
                                 >
                                 0
                              , then Eq. (2.11) has three distinct real roots and 
                                 δ
                                 =
                                 1
                               by Theorem 2.2; if 
                                 d
                                 <
                                 0
                              , then Eq. (2.11) has one real root and two distinct complex roots, and the theorem follows from Theorem 2.5.■

In this section, we will show how to convert the time-optimal feedrate planning problem for CNC systems with PID controllers into a finite-state convex optimization problem.

We consider a CNC system with three translational axes 
                           x
                           ,
                           y
                           ,
                           z
                        , and assume that these axes have the same dynamic parameters. Also assume that the PID controller is used for each axis. Thus the tracking error satisfies Eq. (2.9). The tool-path of the three-axis CNC machine is given by a set of parametric functions with at least 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         continuity: 
                           
                              
                                 r
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    (
                                    x
                                    
                                       (
                                       u
                                       )
                                    
                                    ,
                                    y
                                    
                                       (
                                       u
                                       )
                                    
                                    ,
                                    z
                                    
                                       (
                                       u
                                       )
                                    
                                    )
                                 
                                 ,
                                 
                                 u
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 .
                              
                           
                         The tool-path 
                           r
                           
                              (
                              u
                              )
                           
                         could be described by NURBS, 
                           B
                        -splines, or other parametric equations. We will see in Section  3.3 that only the evaluations of 
                           r
                           
                              (
                              u
                              )
                           
                           ,
                           
                              
                                 
                                    d
                                 
                                 r
                                 
                                    (
                                    u
                                    )
                                 
                              
                              
                                 
                                    d
                                 
                                 u
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       2
                                    
                                 
                                 r
                                 
                                    (
                                    u
                                    )
                                 
                              
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       2
                                    
                                 
                                 u
                              
                           
                         at certain given parametric values are needed in the feedrate planning.

In order to obtain smooth velocity functions, bounds of axis velocity, acceleration, and jerk are introduced. Furthermore, high-precision machining can be achieved by bounding the axis tracking error. Therefore, the problem is to design a parametric velocity 
                           
                              
                                 u
                              
                              
                                 ̇
                              
                           
                           =
                           
                              
                                 
                                    d
                                 
                                 u
                              
                              
                                 
                                    d
                                 
                                 t
                              
                           
                         such that the tool-path can be traversed with minimal time under the kinematic and precision constraints mentioned above: 
                           
                              
                                 (3.1)
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∫
                                       
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                    
                                    
                                    
                                       d
                                    
                                    u
                                 
                              
                              
                                 
                                    s
                                    .
                                    t
                                    .
                                    
                                    
                                       |
                                       
                                          
                                             v
                                          
                                          
                                             f
                                          
                                       
                                       |
                                    
                                    ≤
                                    
                                       
                                          V
                                       
                                       
                                          f
                                          max
                                       
                                    
                                    ,
                                    
                                    
                                       |
                                       
                                          
                                             v
                                          
                                          
                                             τ
                                          
                                       
                                       |
                                    
                                    ≤
                                    
                                       
                                          V
                                       
                                       
                                          max
                                       
                                    
                                    ,
                                    
                                    
                                       |
                                       
                                          
                                             a
                                          
                                          
                                             τ
                                          
                                       
                                       |
                                    
                                    ≤
                                    
                                       
                                          A
                                       
                                       
                                          max
                                       
                                    
                                    ,
                                    
                                    
                                       |
                                       
                                          
                                             j
                                          
                                          
                                             τ
                                          
                                       
                                       |
                                    
                                    ≤
                                    
                                       
                                          J
                                       
                                       
                                          max
                                       
                                    
                                    ,
                                    
                                    
                                       |
                                       
                                          
                                             e
                                          
                                          
                                             τ
                                          
                                       
                                       |
                                    
                                    ≤
                                    
                                       
                                          E
                                       
                                       
                                          max
                                       
                                    
                                 
                              
                           
                         where 
                           τ
                           ∈
                           
                              {
                              x
                              ,
                              y
                              ,
                              z
                              }
                           
                         is the axis, 
                           
                              
                                 v
                              
                              
                                 f
                              
                           
                         is the tangential feedrate, 
                           
                              
                                 v
                              
                              
                                 τ
                              
                           
                         is the axis velocity, 
                           
                              
                                 a
                              
                              
                                 τ
                              
                           
                         is the axis acceleration, 
                           
                              
                                 j
                              
                              
                                 τ
                              
                           
                         is the axis jerk, 
                           
                              
                                 e
                              
                              
                                 τ
                              
                           
                         is the axis dynamic error satisfying (2.9), and 
                           
                              
                                 V
                              
                              
                                 f
                                 max
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 max
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 max
                              
                           
                           ,
                           
                              
                                 J
                              
                              
                                 max
                              
                           
                           ,
                           
                              
                                 E
                              
                              
                                 max
                              
                           
                         are the corresponding bounds, respectively. The following initial values are assumed: 
                           
                              
                                 u
                              
                              
                                 ̇
                              
                           
                           
                              (
                              0
                              )
                           
                           =
                           
                              
                                 u
                              
                              
                                 ̇
                              
                           
                           
                              (
                              1
                              )
                           
                           =
                           
                              
                                 u
                              
                              
                                 ̈
                              
                           
                           
                              (
                              0
                              )
                           
                           =
                           
                              
                                 u
                              
                              
                                 ̈
                              
                           
                           
                              (
                              1
                              )
                           
                           =
                           0
                        .

Note that, instead of the contour error, the tracking error is considered here for two reasons: the model based on tracking error is simpler and can be solved efficiently, as shown by this paper, and limited tracking errors lead to limited contour errors.

By Theorem 2.6, the tracking error constraint can be simplified and the optimal control problem (3.1) can be relaxed into the following problem, whose constraints involve kinematic quantities only. 
                           
                              
                                 (3.2)
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∫
                                       
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                    
                                    
                                    
                                       d
                                    
                                    u
                                 
                              
                              
                                 (3.3)
                                 
                                    s
                                    .
                                    t
                                    .
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   |
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         f
                                                      
                                                   
                                                   |
                                                
                                                ≤
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      f
                                                      max
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   |
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         τ
                                                      
                                                   
                                                   |
                                                
                                                ≤
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      max
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   |
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         τ
                                                      
                                                   
                                                   |
                                                
                                                ≤
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      max
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   |
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         τ
                                                      
                                                   
                                                   |
                                                
                                                ≤
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      max
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   |
                                                   
                                                      
                                                         J
                                                      
                                                      
                                                         K
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               I
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         τ
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         K
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               I
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         τ
                                                      
                                                   
                                                   |
                                                
                                                ≤
                                                δ
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      max
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           δ
                         is given in Theorem 2.6 and 
                           
                              
                                 u
                              
                              
                                 ̇
                              
                           
                           
                              (
                              0
                              )
                           
                           =
                           
                              
                                 u
                              
                              
                                 ̇
                              
                           
                           
                              (
                              1
                              )
                           
                           =
                           
                              
                                 u
                              
                              
                                 ̈
                              
                           
                           
                              (
                              0
                              )
                           
                           =
                           
                              
                                 u
                              
                              
                                 ̈
                              
                           
                           
                              (
                              1
                              )
                           
                           =
                           0
                        .

In the rest of this section, we will rewrite problem (3.2) into a form which is more convenient for numerical solution. Denote “′” to be “
                           
                              
                                 
                                    d
                                 
                              
                              
                                 
                                    d
                                 
                                 u
                              
                           
                        ” and “
                           
                              
                                 
                              
                              
                                 ̇
                              
                           
                        ” to be “
                           
                              
                                 
                                    d
                                 
                              
                              
                                 
                                    d
                                 
                                 t
                              
                           
                        ”. Introduce three new functions 
                           a
                           
                              (
                              u
                              )
                           
                           ,
                           b
                           
                              (
                              u
                              )
                           
                        , and 
                           c
                           
                              (
                              u
                              )
                           
                         in 
                           u
                        : 
                           
                              
                                 
                                    a
                                    
                                       (
                                       u
                                       )
                                    
                                    =
                                    
                                       
                                          u
                                       
                                       
                                          ̇
                                       
                                    
                                    
                                       
                                          
                                             (
                                             u
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                              
                                 (3.4)
                                 
                                    b
                                    
                                       (
                                       u
                                       )
                                    
                                    =
                                    
                                       
                                          u
                                       
                                       
                                          ̈
                                       
                                    
                                    =
                                    
                                       
                                          
                                             d
                                          
                                          
                                             
                                                u
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          
                                             d
                                          
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          a
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    c
                                    
                                       (
                                       u
                                       )
                                    
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    .
                                 
                              
                           
                         Then the kinematic quantities can be written as functions in 
                           a
                           ,
                           b
                        , and 
                           c
                        : 
                           
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          τ
                                       
                                    
                                    =
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          ̇
                                       
                                    
                                    =
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                       
                                    
                                    ,
                                 
                              
                              
                                 (3.5)
                                 
                                    
                                       
                                          a
                                       
                                       
                                          τ
                                       
                                    
                                    =
                                    
                                       
                                          τ
                                       
                                       
                                          ″
                                       
                                    
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          ̈
                                       
                                    
                                    =
                                    
                                       
                                          τ
                                       
                                       
                                          ″
                                       
                                    
                                    a
                                    
                                       (
                                       u
                                       )
                                    
                                    +
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    b
                                    
                                       (
                                       u
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          j
                                       
                                       
                                          τ
                                       
                                    
                                    =
                                    
                                       
                                          τ
                                       
                                       
                                          ‴
                                       
                                    
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          τ
                                       
                                       
                                          ″
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          ̇
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          ̈
                                       
                                    
                                    +
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             τ
                                          
                                          
                                             ‴
                                          
                                       
                                       a
                                       
                                          (
                                          u
                                          )
                                       
                                       +
                                       
                                          
                                             τ
                                          
                                          
                                             ″
                                          
                                       
                                       b
                                       
                                          (
                                          u
                                          )
                                       
                                       +
                                       
                                          
                                             τ
                                          
                                          
                                             ′
                                          
                                       
                                       c
                                       
                                          (
                                          u
                                          )
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          f
                                       
                                    
                                    =
                                    σ
                                    
                                       
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                         where 
                           σ
                           =
                           
                              
                                 
                                    
                                       x
                                       
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       y
                                       
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       z
                                       
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         and 
                           τ
                           ∈
                           
                              {
                              x
                              ,
                              y
                              ,
                              z
                              }
                           
                        .

Treat 
                           c
                           
                              (
                              u
                              )
                           
                         as the control variable and 
                           a
                           ,
                           b
                         as the state as the state variables. Then problem (3.2) becomes a classic optimal control problem: 
                           
                              
                                 (3.6)
                                 
                                    
                                       
                                          min
                                       
                                       
                                          c
                                          
                                             (
                                             u
                                             )
                                          
                                       
                                    
                                    
                                       
                                          ∫
                                       
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                a
                                                
                                                   (
                                                   u
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                    
                                       d
                                    
                                    u
                                 
                              
                              
                                 (3.7)
                                 
                                    s
                                    .
                                    t
                                    .
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                a
                                                
                                                   (
                                                   u
                                                   )
                                                
                                                ≤
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      f
                                                      max
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               τ
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                a
                                                
                                                   (
                                                   u
                                                   )
                                                
                                                ≤
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      max
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   |
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ″
                                                      
                                                   
                                                   a
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   b
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   |
                                                
                                                ≤
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      max
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   |
                                                   
                                                      
                                                         a
                                                         
                                                            (
                                                            u
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            ‴
                                                         
                                                      
                                                      a
                                                      
                                                         (
                                                         u
                                                         )
                                                      
                                                      +
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            ″
                                                         
                                                      
                                                      b
                                                      
                                                         (
                                                         u
                                                         )
                                                      
                                                      +
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      c
                                                      
                                                         (
                                                         u
                                                         )
                                                      
                                                      )
                                                   
                                                   |
                                                
                                                ≤
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      max
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   |
                                                   
                                                      
                                                         J
                                                         
                                                            
                                                               a
                                                               
                                                                  (
                                                                  u
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  τ
                                                               
                                                               
                                                                  ‴
                                                               
                                                            
                                                            a
                                                            
                                                               (
                                                               u
                                                               )
                                                            
                                                            +
                                                            
                                                               
                                                                  τ
                                                               
                                                               
                                                                  ″
                                                               
                                                            
                                                            b
                                                            
                                                               (
                                                               u
                                                               )
                                                            
                                                            +
                                                            
                                                               
                                                                  τ
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            c
                                                            
                                                               (
                                                               u
                                                               )
                                                            
                                                            )
                                                         
                                                         +
                                                         B
                                                         
                                                            (
                                                            
                                                               
                                                                  τ
                                                               
                                                               
                                                                  ″
                                                               
                                                            
                                                            a
                                                            
                                                               (
                                                               u
                                                               )
                                                            
                                                            +
                                                            
                                                               
                                                                  τ
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            b
                                                            
                                                               (
                                                               u
                                                               )
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         K
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               I
                                                            
                                                         
                                                      
                                                   
                                                   |
                                                
                                                ≤
                                                δ
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      max
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           τ
                           ∈
                           
                              {
                              x
                              ,
                              y
                              ,
                              z
                              }
                           
                         represents the axis. From (3.4), the initial values are 
                           a
                           
                              (
                              0
                              )
                           
                           =
                           a
                           
                              (
                              1
                              )
                           
                           =
                           b
                           
                              (
                              0
                              )
                           
                           =
                           b
                           
                              (
                              1
                              )
                           
                           =
                           0
                        .

Obtaining a numerical solution to problem (3.6) is challenging due to the strong nonlinear part in the jerk and tracking error constraints, as shown in Section  4.2. In this section, we will show that problem (3.6) can be relaxed to a convex optimal control problem whose constraints are linear in the control and state variables.

Two ideas are used in the relaxation. First, the unique optimal solution of the following time-minimum feedrate planning problem under confined acceleration 
                           
                              (3.8)
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 
                                    d
                                 
                                 u
                                 
                                 
                                 s
                                 .
                                 t
                                 .
                                 
                                 
                                 
                                    |
                                    
                                       
                                          v
                                       
                                       
                                          f
                                       
                                    
                                    |
                                 
                                 ≤
                                 
                                    
                                       V
                                    
                                    
                                       f
                                       max
                                    
                                 
                                 ,
                                 
                                 
                                    |
                                    
                                       
                                          v
                                       
                                       
                                          τ
                                       
                                    
                                    |
                                 
                                 ≤
                                 
                                    
                                       V
                                    
                                    
                                       max
                                    
                                 
                                 ,
                                 
                                 
                                    |
                                    
                                       
                                          a
                                       
                                       
                                          τ
                                       
                                    
                                    |
                                 
                                 ≤
                                 
                                    
                                       A
                                    
                                    
                                       max
                                    
                                 
                              
                           
                         is generated and used to simplify the last two constraints in (3.7). Second, new conditions on the dynamic parameters will be introduced to further simplify the last constraint in (3.7).

The following important property for problem (3.8) is proved in  [2,19].


                        
                           Lemma 3.1
                           
                              The optimal solution of problem   (3.8)   achieves the maximum values among all feasible solutions at any parameter value.
                           

We now reduce problem (3.6) to a new form, where the constraints are linear in the control and the state variables 
                           a
                           ,
                           b
                           ,
                           c
                        .


                        
                           Theorem 3.2
                           
                              Let 
                              
                                 
                                    
                                       a
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       ̇
                                    
                                 
                                 
                                    
                                       
                                          (
                                          u
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                               
                              be the optimal solution of problem   (3.8)
                              , and assume that the parameters satisfy the following condition:
                              
                                 
                                    (3.9)
                                    
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                       K
                                       
                                          
                                             k
                                          
                                          
                                             I
                                          
                                       
                                       −
                                       B
                                       
                                          
                                             A
                                          
                                          
                                             max
                                          
                                       
                                       >
                                       0
                                       .
                                    
                                 
                              
                              Then problem   (3.6)   can be relaxed to the following optimal control problem:
                              
                                 
                                    
                                       (3.10)
                                       
                                          
                                             
                                                min
                                             
                                             
                                                c
                                                
                                                   (
                                                   u
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                ∫
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      a
                                                      
                                                         (
                                                         u
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          
                                             d
                                          
                                          u
                                       
                                    
                                    
                                       (3.11)
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      a
                                                      
                                                         (
                                                         u
                                                         )
                                                      
                                                      ≤
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            f
                                                            max
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     τ
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      a
                                                      
                                                         (
                                                         u
                                                         )
                                                      
                                                      ≤
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            max
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               τ
                                                            
                                                            
                                                               ″
                                                            
                                                         
                                                         a
                                                         
                                                            (
                                                            u
                                                            )
                                                         
                                                         +
                                                         
                                                            
                                                               τ
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         b
                                                         
                                                            (
                                                            u
                                                            )
                                                         
                                                         |
                                                      
                                                      ≤
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               
                                                                  
                                                                     a
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                               
                                                                  (
                                                                  u
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  τ
                                                               
                                                               
                                                                  ‴
                                                               
                                                            
                                                            a
                                                            
                                                               (
                                                               u
                                                               )
                                                            
                                                            +
                                                            
                                                               
                                                                  τ
                                                               
                                                               
                                                                  ″
                                                               
                                                            
                                                            b
                                                            
                                                               (
                                                               u
                                                               )
                                                            
                                                            +
                                                            
                                                               
                                                                  τ
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            c
                                                            
                                                               (
                                                               u
                                                               )
                                                            
                                                            )
                                                         
                                                         |
                                                      
                                                      ≤
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               J
                                                               
                                                                  
                                                                     
                                                                        
                                                                           a
                                                                        
                                                                        
                                                                           ∗
                                                                        
                                                                     
                                                                     
                                                                        (
                                                                        u
                                                                        )
                                                                     
                                                                  
                                                               
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        τ
                                                                     
                                                                     
                                                                        ‴
                                                                     
                                                                  
                                                                  a
                                                                  
                                                                     (
                                                                     u
                                                                     )
                                                                  
                                                                  +
                                                                  
                                                                     
                                                                        τ
                                                                     
                                                                     
                                                                        ″
                                                                     
                                                                  
                                                                  b
                                                                  
                                                                     (
                                                                     u
                                                                     )
                                                                  
                                                                  +
                                                                  
                                                                     
                                                                        τ
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                                  c
                                                                  
                                                                     (
                                                                     u
                                                                     )
                                                                  
                                                                  )
                                                               
                                                               +
                                                               B
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        τ
                                                                     
                                                                     
                                                                        ″
                                                                     
                                                                  
                                                                  a
                                                                  
                                                                     (
                                                                     u
                                                                     )
                                                                  
                                                                  +
                                                                  
                                                                     
                                                                        τ
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                                  b
                                                                  
                                                                     (
                                                                     u
                                                                     )
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               K
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     I
                                                                  
                                                               
                                                            
                                                         
                                                         |
                                                      
                                                      ≤
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              with initial values 
                              
                                 a
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 a
                                 
                                    (
                                    1
                                    )
                                 
                                 =
                                 b
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 b
                                 
                                    (
                                    1
                                    )
                                 
                                 =
                                 0
                               
                              . More precisely, if 
                              
                                 a
                                 ,
                                 b
                                 ,
                                 c
                               
                              satisfy constraints   (3.11)
                              , then they must satisfy constraints   (3.7)
                              .
                           


                        
                           Proof
                           Since the first three constrains in (3.7) and (3.11) are the same, we just need to show that the fourth and fifth constraints of (3.11) imply the fourth and fifth constraints of (3.7).

Let 
                                 a
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                                 b
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                                 c
                                 
                                    (
                                    u
                                    )
                                 
                               be feasible solutions to problem (3.10). Since the first three constraints of (3.11) are the same as those of (3.8), 
                                 a
                                 
                                    (
                                    u
                                    )
                                 
                               is also a feasible solution to problem (3.8). Then, by Lemma 3.1, 
                                 a
                                 
                                    (
                                    u
                                    )
                                 
                                 ≤
                                 
                                    
                                       a
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                               for 
                                 u
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                              . We thus have 
                                 
                                    
                                       
                                          |
                                          
                                             
                                                a
                                                
                                                   (
                                                   u
                                                   )
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   τ
                                                
                                                
                                                   ‴
                                                
                                             
                                             a
                                             
                                                (
                                                u
                                                )
                                             
                                             +
                                             
                                                
                                                   τ
                                                
                                                
                                                   ″
                                                
                                             
                                             b
                                             
                                                (
                                                u
                                                )
                                             
                                             +
                                             
                                                
                                                   τ
                                                
                                                
                                                   ′
                                                
                                             
                                             c
                                             
                                                (
                                                u
                                                )
                                             
                                             )
                                          
                                          |
                                       
                                       =
                                       
                                          |
                                          
                                             
                                                a
                                                
                                                   (
                                                   u
                                                   )
                                                
                                             
                                          
                                          |
                                       
                                       
                                          |
                                          
                                             (
                                             
                                                
                                                   τ
                                                
                                                
                                                   ‴
                                                
                                             
                                             a
                                             
                                                (
                                                u
                                                )
                                             
                                             +
                                             
                                                
                                                   τ
                                                
                                                
                                                   ″
                                                
                                             
                                             b
                                             
                                                (
                                                u
                                                )
                                             
                                             +
                                             
                                                
                                                   τ
                                                
                                                
                                                   ′
                                                
                                             
                                             c
                                             
                                                (
                                                u
                                                )
                                             
                                             )
                                          
                                          |
                                       
                                       ≤
                                       
                                          |
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   )
                                                
                                             
                                          
                                          |
                                       
                                       
                                          |
                                          
                                             (
                                             
                                                
                                                   τ
                                                
                                                
                                                   ‴
                                                
                                             
                                             a
                                             
                                                (
                                                u
                                                )
                                             
                                             +
                                             
                                                
                                                   τ
                                                
                                                
                                                   ″
                                                
                                             
                                             b
                                             
                                                (
                                                u
                                                )
                                             
                                             +
                                             
                                                
                                                   τ
                                                
                                                
                                                   ′
                                                
                                             
                                             c
                                             
                                                (
                                                u
                                                )
                                             
                                             )
                                          
                                          |
                                       
                                       ,
                                    
                                 
                               and hence the fourth constraint in (3.11) implies the fourth constraint in (3.7).

For the fifth constraint, two cases are considered. In the first case, the fifth constraint in (3.11) is assumed to be bang–bang; that is, 
                                 
                                    
                                       
                                          |
                                          
                                             
                                                J
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         (
                                                         u
                                                         )
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ‴
                                                      
                                                   
                                                   a
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ″
                                                      
                                                   
                                                   b
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   c
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                B
                                                
                                                   (
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ″
                                                      
                                                   
                                                   a
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   b
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                K
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      I
                                                   
                                                
                                             
                                          
                                          |
                                       
                                       =
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                       ,
                                    
                                 
                               which means either 
                                 
                                    (3.12)
                                    
                                       J
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                ‴
                                             
                                          
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ″
                                             
                                          
                                          b
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ′
                                             
                                          
                                          c
                                          
                                             (
                                             u
                                             )
                                          
                                          )
                                       
                                       +
                                       B
                                       
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                ″
                                             
                                          
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ′
                                             
                                          
                                          b
                                          
                                             (
                                             u
                                             )
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                       K
                                       
                                          
                                             k
                                          
                                          
                                             I
                                          
                                       
                                       ,
                                    
                                 
                               or 
                                 
                                    (3.13)
                                    
                                       J
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                ‴
                                             
                                          
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ″
                                             
                                          
                                          b
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ′
                                             
                                          
                                          c
                                          
                                             (
                                             u
                                             )
                                          
                                          )
                                       
                                       +
                                       B
                                       
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                ″
                                             
                                          
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ′
                                             
                                          
                                          b
                                          
                                             (
                                             u
                                             )
                                          
                                          )
                                       
                                       =
                                       −
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                       K
                                       
                                          
                                             k
                                          
                                          
                                             I
                                          
                                       
                                       .
                                    
                                 
                               Suppose that (3.12) is valid. Due to condition (3.9), 
                                 
                                    
                                       J
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                ‴
                                             
                                          
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ″
                                             
                                          
                                          b
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ′
                                             
                                          
                                          c
                                          
                                             (
                                             u
                                             )
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                       K
                                       
                                          
                                             k
                                          
                                          
                                             I
                                          
                                       
                                       −
                                       B
                                       
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                ″
                                             
                                          
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ′
                                             
                                          
                                          b
                                          
                                             (
                                             u
                                             )
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                       K
                                       
                                          
                                             k
                                          
                                          
                                             I
                                          
                                       
                                       −
                                       B
                                       
                                          
                                             a
                                          
                                          
                                             τ
                                          
                                       
                                       ≥
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                       K
                                       
                                          
                                             k
                                          
                                          
                                             I
                                          
                                       
                                       −
                                       B
                                       
                                          |
                                          
                                             
                                                a
                                             
                                             
                                                τ
                                             
                                          
                                          |
                                       
                                       ≥
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                       K
                                       
                                          
                                             k
                                          
                                          
                                             I
                                          
                                       
                                       −
                                       B
                                       
                                          
                                             A
                                          
                                          
                                             max
                                          
                                       
                                       ≥
                                       0
                                       .
                                    
                                 
                               Hence, 
                                 
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          ‴
                                       
                                    
                                    a
                                    
                                       (
                                       u
                                       )
                                    
                                    +
                                    
                                       
                                          τ
                                       
                                       
                                          ″
                                       
                                    
                                    b
                                    
                                       (
                                       u
                                       )
                                    
                                    +
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    c
                                    
                                       (
                                       u
                                       )
                                    
                                    )
                                 
                                 ≥
                                 0
                               and 
                                 
                                    
                                       J
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                ‴
                                             
                                          
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ″
                                             
                                          
                                          b
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ′
                                             
                                          
                                          c
                                          
                                             (
                                             u
                                             )
                                          
                                          )
                                       
                                       ≥
                                       J
                                       
                                          
                                             a
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                ‴
                                             
                                          
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ″
                                             
                                          
                                          b
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ′
                                             
                                          
                                          c
                                          
                                             (
                                             u
                                             )
                                          
                                          )
                                       
                                       .
                                    
                                 
                               Therefore, the fifth constraint in (3.11) implies the fifth constraint in (3.7). Likewise, if (3.13) is valid, 
                                 
                                    
                                       J
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                ‴
                                             
                                          
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ″
                                             
                                          
                                          b
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ′
                                             
                                          
                                          c
                                          
                                             (
                                             u
                                             )
                                          
                                          )
                                       
                                       =
                                       −
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                       K
                                       
                                          
                                             k
                                          
                                          
                                             I
                                          
                                       
                                       −
                                       B
                                       
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                ″
                                             
                                          
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ′
                                             
                                          
                                          b
                                          
                                             (
                                             u
                                             )
                                          
                                          )
                                       
                                       =
                                       −
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                       K
                                       
                                          
                                             k
                                          
                                          
                                             I
                                          
                                       
                                       −
                                       B
                                       
                                          
                                             a
                                          
                                          
                                             τ
                                          
                                       
                                       ≤
                                       −
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                       K
                                       
                                          
                                             k
                                          
                                          
                                             I
                                          
                                       
                                       +
                                       B
                                       
                                          
                                             A
                                          
                                          
                                             max
                                          
                                       
                                       ≤
                                       −
                                       
                                          (
                                          
                                             
                                                E
                                             
                                             
                                                max
                                             
                                          
                                          K
                                          
                                             
                                                k
                                             
                                             
                                                I
                                             
                                          
                                          −
                                          B
                                          
                                             
                                                A
                                             
                                             
                                                max
                                             
                                          
                                          )
                                       
                                       ≤
                                       0
                                       .
                                    
                                 
                               Then, in this case, 
                                 
                                    
                                       J
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                ‴
                                             
                                          
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ″
                                             
                                          
                                          b
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ′
                                             
                                          
                                          c
                                          
                                             (
                                             u
                                             )
                                          
                                          )
                                       
                                       ≤
                                       J
                                       
                                          
                                             a
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                ‴
                                             
                                          
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ″
                                             
                                          
                                          b
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ′
                                             
                                          
                                          c
                                          
                                             (
                                             u
                                             )
                                          
                                          )
                                       
                                       .
                                    
                                 
                               Thus, in the first case, a solution of (3.10) is also a feasible solution of (3.6).

Now consider the second case, that is, the fifth constraint in (3.11) is not bang–bang: 
                                 
                                    (3.14)
                                    
                                       
                                          |
                                          
                                             
                                                J
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      
                                                         (
                                                         u
                                                         )
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ‴
                                                      
                                                   
                                                   a
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ″
                                                      
                                                   
                                                   b
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   c
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                B
                                                
                                                   (
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ″
                                                      
                                                   
                                                   a
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   b
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                K
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      I
                                                   
                                                
                                             
                                          
                                          |
                                       
                                       <
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                       .
                                    
                                 
                               We will show that the fifth constraint in (3.7) is also valid. Suppose the contrary; that is, 
                                 
                                    
                                       
                                          |
                                          
                                             
                                                J
                                                
                                                   
                                                      a
                                                      
                                                         (
                                                         u
                                                         )
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ‴
                                                      
                                                   
                                                   a
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ″
                                                      
                                                   
                                                   b
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   c
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                B
                                                
                                                   (
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ″
                                                      
                                                   
                                                   a
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   b
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                K
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      I
                                                   
                                                
                                             
                                          
                                          |
                                       
                                       >
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                       .
                                    
                                 
                               Consider one case as an example: 
                                 
                                    (3.15)
                                    
                                       
                                          
                                             J
                                             
                                                
                                                   a
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      ‴
                                                   
                                                
                                                a
                                                
                                                   (
                                                   u
                                                   )
                                                
                                                +
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      ″
                                                   
                                                
                                                b
                                                
                                                   (
                                                   u
                                                   )
                                                
                                                +
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                c
                                                
                                                   (
                                                   u
                                                   )
                                                
                                                )
                                             
                                             +
                                             B
                                             
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      ″
                                                   
                                                
                                                a
                                                
                                                   (
                                                   u
                                                   )
                                                
                                                +
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                b
                                                
                                                   (
                                                   u
                                                   )
                                                
                                                )
                                             
                                          
                                          
                                             K
                                             
                                                
                                                   k
                                                
                                                
                                                   I
                                                
                                             
                                          
                                       
                                       >
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                       .
                                    
                                 
                               From (3.9) and (3.15), we have 
                                 
                                    
                                       J
                                       
                                          
                                             a
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                ‴
                                             
                                          
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ″
                                             
                                          
                                          b
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ′
                                             
                                          
                                          c
                                          
                                             (
                                             u
                                             )
                                          
                                          )
                                       
                                       >
                                       K
                                       
                                          
                                             k
                                          
                                          
                                             I
                                          
                                       
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                       −
                                       B
                                       
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                ″
                                             
                                          
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ′
                                             
                                          
                                          b
                                          
                                             (
                                             u
                                             )
                                          
                                          )
                                       
                                       >
                                       0
                                       .
                                    
                                 
                               Hence, 
                                 
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          ‴
                                       
                                    
                                    a
                                    
                                       (
                                       u
                                       )
                                    
                                    +
                                    
                                       
                                          τ
                                       
                                       
                                          ″
                                       
                                    
                                    b
                                    
                                       (
                                       u
                                       )
                                    
                                    +
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    c
                                    
                                       (
                                       u
                                       )
                                    
                                    )
                                 
                                 >
                                 0
                               and 
                                 
                                    
                                       J
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                ‴
                                             
                                          
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ″
                                             
                                          
                                          b
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ′
                                             
                                          
                                          c
                                          
                                             (
                                             u
                                             )
                                          
                                          )
                                       
                                       ≥
                                       J
                                       
                                          
                                             a
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                ‴
                                             
                                          
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ″
                                             
                                          
                                          b
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ′
                                             
                                          
                                          c
                                          
                                             (
                                             u
                                             )
                                          
                                          )
                                       
                                       ≥
                                       K
                                       
                                          
                                             k
                                          
                                          
                                             I
                                          
                                       
                                       
                                          
                                             E
                                          
                                          
                                             max
                                          
                                       
                                       −
                                       B
                                       
                                          (
                                          
                                             
                                                τ
                                             
                                             
                                                ″
                                             
                                          
                                          a
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                ′
                                             
                                          
                                          b
                                          
                                             (
                                             u
                                             )
                                          
                                          )
                                       
                                       ,
                                    
                                 
                               which contradicts (3.14). The theorem is proved.■

Note that the constraints in (3.11) are linear in the control and state variables and that the objective function is a convex function [9]. Then, problem (3.10) is a convex optimal control problem.

In this section, the direct transcription method is used to solve problem (3.10). It is shown that problem (3.10) can be reduced to a finite-state convex optimization problem which admits efficient numerical solution.

To convert the infinite-state optimization problem into a finite-state optimization problem, the parametric interval 
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                         is divided into 
                           N
                         equal parts with knots 
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 i
                              
                              
                                 N
                              
                           
                        , 
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           N
                        . The length of each subinterval is 
                           Δ
                           =
                           
                              
                                 1
                              
                              
                                 N
                              
                           
                        . Since 
                           Δ
                         is very small, the constraints can be approximately transformed into discrete inequalities at points 
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                        .

Problem (3.10) is solved in two steps.

First, efficient numerical methods from  [13] or [9] are used to compute a discrete optimal solution 
                           
                              
                                 a
                              
                              
                                 i
                              
                              
                                 ∗
                              
                           
                           =
                           a
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           ,
                           i
                           =
                           0
                           ,
                           …
                           ,
                           N
                         for problem (3.8).

Second, to solve problem (3.10), we use 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           =
                           c
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           ,
                           i
                           =
                           0
                           ,
                           …
                           ,
                           N
                         as the control variables, and the state variables 
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                           =
                           a
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           ,
                           i
                           =
                           0
                           ,
                           …
                           ,
                           N
                         and 
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                           =
                           b
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           ,
                           i
                           =
                           0
                           ,
                           …
                           ,
                           N
                         can be calculated with finite differences due to (3.4): 
                           
                              
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 ≈
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       2
                                       Δ
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 ≈
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       Δ
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 N
                                 −
                                 1
                                 .
                              
                           
                         Since 
                           a
                           
                              (
                              0
                              )
                           
                           =
                           b
                           
                              (
                              0
                              )
                           
                           =
                           a
                           
                              (
                              1
                              )
                           
                           =
                           b
                           
                              (
                              1
                              )
                           
                           =
                           0
                        , we have 
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 b
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 a
                              
                              
                                 N
                              
                           
                           =
                           
                              
                                 b
                              
                              
                                 N
                              
                           
                           =
                           0
                         and 
                           
                              
                                 (3.16)
                                 
                                    
                                       
                                          b
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    =
                                    Δ
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          0
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          b
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    Δ
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          0
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                    i
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    N
                                    −
                                    1
                                    .
                                 
                              
                              
                                 (3.17)
                                 
                                    
                                       
                                          a
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    =
                                    2
                                    Δ
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          0
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    2
                                    
                                       
                                          Δ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          =
                                          0
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       i
                                       −
                                       l
                                       )
                                    
                                    
                                       
                                          c
                                       
                                       
                                          l
                                       
                                    
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                    −
                                    1
                                    .
                                 
                              
                           
                        
                     

Following the two steps described above, problem (3.10) can be approximated by the following finite-state nonlinear programming problem:
                           
                              (3.18)
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       2
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 s
                                 .
                                 t
                                 .
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                
                                             
                                             ≤
                                             
                                                
                                                   V
                                                
                                                
                                                   f
                                                   max
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  τ
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                
                                             
                                             ≤
                                             
                                                
                                                   V
                                                
                                                
                                                   max
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      ″
                                                   
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      i
                                                   
                                                
                                                |
                                             
                                             ≤
                                             
                                                
                                                   A
                                                
                                                
                                                   max
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               τ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         ‴
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               τ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         ″
                                                      
                                                   
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               τ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                |
                                             
                                             ≤
                                             
                                                
                                                   J
                                                
                                                
                                                   max
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      J
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     a
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     ∗
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        τ
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                               
                                                                  ‴
                                                               
                                                            
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        τ
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                               
                                                                  ″
                                                               
                                                            
                                                            
                                                               
                                                                  b
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        τ
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            )
                                                         
                                                         )
                                                      
                                                      +
                                                      B
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     τ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               ″
                                                            
                                                         
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               
                                                                  
                                                                     τ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      K
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                             ≤
                                             
                                                
                                                   E
                                                
                                                
                                                   max
                                                
                                             
                                          
                                       
                                       
                                          
                                             Ξ
                                             ∈
                                             Ω
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           τ
                           ∈
                           
                              {
                              x
                              ,
                              y
                              ,
                              z
                              }
                           
                        , 
                           i
                           =
                           0
                           ,
                           …
                           ,
                           N
                        , 
                           
                              
                                 
                                    
                                       τ
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 τ
                              
                              
                                 ′
                              
                           
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        , 
                           
                              
                                 
                                    
                                       τ
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 ″
                              
                           
                           =
                           
                              
                                 τ
                              
                              
                                 ″
                              
                           
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        , 
                           
                              
                                 a
                              
                              
                                 i
                              
                              
                                 ∗
                              
                           
                         are the solution of (3.8) obtained in the first step, 
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                         can be derived from (3.17) and (3.16), 
                           Ξ
                         is the set of mechanism and bound parameters, and 
                           Ω
                         is the parameter domain determined by (3.9). Also, the initial values 
                           
                              
                                 a
                              
                              
                                 N
                              
                           
                           =
                           
                              
                                 b
                              
                              
                                 N
                              
                           
                           =
                           0
                         lead to the following constraints on 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                        : 
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                                 
                                 and
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       N
                                       −
                                       2
                                    
                                 
                                 
                                    (
                                    N
                                    −
                                    1
                                    −
                                    i
                                    )
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                        
                     

The constraints of problem (3.18) are linear in variables 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                        , and the objective function is a convex function in 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           [9]. As a consequence, problem (3.18) is a convex optimization problem which has the nice property that a local optimal solution of the problem is its unique global optimal solution. This allows us to use any gradient-based method to solve problem (3.18).

In this paper, the Sequential Quadratic Programming (SQP) method [26] is used to solve problem (3.18). The SQP method reduces the problem to a sequence of optimization subproblems, each of which optimizes a quadratic model of the objective function to a linearization of the constraints. Since the constraints of problem (3.18) are already linear, the SQP method is particularly suited for it.

In order to use the SQP method to solve problem (3.18), the number 
                           N
                         of discretizations need to be given. The selection of 
                           N
                         is closely related to the lengths 
                           Δ
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                           =
                           
                              ‖
                              r
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              −
                              r
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 )
                              
                              ‖
                           
                         of the line segments 
                           r
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           r
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              )
                           
                        . According to the theory of the finite element method  [7], these lengths need to satisfy 
                           Δ
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                           ≤
                           0.1
                           
                           
                              mm
                           
                         in order to achieve high-accuracy computation for most CNC machining. So, a lower bound 
                           
                              
                                 N
                              
                              
                                 l
                              
                           
                         for 
                           N
                         is the smallest integer such that 
                           Δ
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                           ≤
                           0.1
                           
                           
                              mm
                           
                         for 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           N
                        . Furthermore, 
                           N
                         should be large enough for the tool-path to be sufficiently subdivided. Combining these two factors, an experimental lower bound for 
                           N
                         is 
                           max
                           
                              {
                              100
                              ,
                              
                                 
                                    N
                                 
                                 
                                    l
                                 
                              
                              }
                           
                        .

In this section, the proposed method is tested in a CNC tool to validate its effectiveness.

The plane curve “star” shown in Fig. 3
                         is used as the experimental tool-path, whose parametric equation is
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             x
                                             =
                                             
                                                (
                                                15
                                                +
                                                5
                                                ⋅
                                                cos
                                                
                                                   (
                                                   10
                                                   π
                                                   u
                                                   )
                                                
                                                )
                                             
                                             ⋅
                                             cos
                                             
                                                (
                                                2
                                                π
                                                u
                                                +
                                                0.5
                                                π
                                                )
                                             
                                          
                                       
                                       
                                          
                                             y
                                             =
                                             
                                                (
                                                15
                                                +
                                                5
                                                ⋅
                                                cos
                                                
                                                   (
                                                   10
                                                   π
                                                   u
                                                   )
                                                
                                                )
                                             
                                             ⋅
                                             sin
                                             
                                                (
                                                2
                                                π
                                                u
                                                +
                                                0.5
                                                π
                                                )
                                             
                                             ,
                                             
                                             u
                                             ∈
                                             
                                                [
                                                0
                                                ,
                                                1
                                                ]
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         Moreover, the curve will be initialized from the original point 
                           
                              (
                              0
                              ,
                              0
                              )
                           
                         in order to satisfy the inverse Laplace transformation.

A Fadal CNC machine tool shown Fig. 4
                         is used for the experiment. The kinematic limits are set to be 
                           
                              
                                 V
                              
                              
                                 f
                                 max
                              
                           
                           =
                           150
                           
                           
                              mm
                           
                           /
                           
                              s
                           
                        , 
                           
                              
                                 
                                    V
                                 
                              
                              
                                 max
                              
                           
                           =
                           
                              (
                              250
                              ,
                              250
                              )
                           
                           
                           
                              mm
                           
                           /
                           
                              s
                           
                        , 
                           
                              
                                 
                                    A
                                 
                              
                              
                                 max
                              
                           
                           =
                           
                              (
                              1500
                              ,
                              1500
                              )
                           
                           
                           
                              mm
                           
                           /
                           
                              
                                 
                                    s
                                 
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 
                                    J
                                 
                              
                              
                                 max
                              
                           
                           =
                           
                              (
                              18
                              
                              000
                              ,
                              18
                              
                              000
                              )
                           
                           
                           
                              mm
                           
                           /
                           
                              
                                 
                                    s
                                 
                              
                              
                                 3
                              
                           
                        , which are for the tangent velocity, axis velocity, axis acceleration, and axis jerk, respectively. The initial and terminal axis velocities and axis accelerations are all zero. The number 
                           N
                         of discretizations is set to be 120. The sampling period is 1 ms. The drive parameters for the 
                           x
                         and 
                           y
                         axes are listed in Table 1
                        . The actual positions on the 
                           x
                         and 
                           y
                         axes are obtained from their encoders mounted on the CNC machine tool.

@&#EXPERIMENTAL RESULTS@&#

Two tests are conducted to illustrate the real and complex eigenvalue cases.


                        Test  1: Real eigenvalue case.
                     

The proportional, integral, and derivative gains of the PID controller are chosen as 
                           
                              
                                 k
                              
                              
                                 P
                              
                           
                           =
                           30
                           
                           
                              V
                           
                           /
                           
                              mm
                           
                        , 
                           
                              
                                 k
                              
                              
                                 I
                              
                           
                           =
                           650
                           
                           
                              V
                           
                           /
                           
                              (
                              
                                 mm s
                              
                              )
                           
                        , and 
                           
                              
                                 k
                              
                              
                                 D
                              
                           
                           =
                           0.4
                           
                           
                              V
                           
                           /
                           
                              (
                              
                                 mm
                              
                              /
                              
                                 s
                              
                              )
                           
                         for both axes. It is easy to show that the eigenvalues of Eq. (2.11) are negative real numbers.

We first run the test without considering the tracking error constraints; that is, problem (3.18) is solved without the last constraint. Figs. 5–8
                        
                        
                        
                         illustrate the feedrate, acceleration, pseudo-jerk, and the real-time tracking error obtained from the encoder mounted on the CNC machine tool. By pseudo-jerk, we mean 
                           
                              
                                 j
                              
                              
                                 ∗
                              
                           
                           =
                           
                              
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    
                                       
                                          τ
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    ‴
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          τ
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    ″
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          τ
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        , which is an approximation of the real jerk (see (3.18)). Obviously, the pseudo-jerk has a bang–bang structure; that is, one of the constraints reaches its bound for any parametric value. From Fig. 8, the tracking error is fluctuating between −0.044 mm and 0.044 mm for both 
                           x
                         and 
                           y
                         axes.

To make a comparison, nominal bounds 
                           
                              
                                 
                                    E
                                 
                              
                              
                                 max
                              
                           
                           =
                           
                              (
                              0.022
                              
                              
                                 mm
                              
                              ,
                              0.022
                              
                              
                                 mm
                              
                              )
                           
                         on the tracking error are added and the method proposed in this paper is used to compute the optimal feedrate. Results are shown in Figs. 9–13
                        
                        
                        
                        
                        . In Fig. 12, the pseudo tracking error is the expression 
                           
                              |
                              
                                 
                                    J
                                 
                                 
                                    K
                                    
                                       
                                          k
                                       
                                       
                                          I
                                       
                                    
                                 
                              
                              
                                 
                                    j
                                 
                                 
                                    τ
                                 
                              
                              +
                              
                                 
                                    B
                                 
                                 
                                    K
                                    
                                       
                                          k
                                       
                                       
                                          I
                                       
                                    
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    τ
                                 
                              
                              |
                           
                         in (3.3), which is used to approximate the tracking error. It can be seen from Fig. 13 that the real-time tracking error is confined with the desired bound 0.022 mm. The fact that the real-time tracking error bound is approximately the same as the theoretical bound shows that the simplification method proposed in this paper performs nicely. The machining time of the test in Fig. 13 is increased to 3.7 s from 2.7 s, which is the machining time of the test in Fig. 8. This is a reasonable price to pay for reducing the tracking error by half.

Comparing with the test without tracking error bounds, the control is still bang–bang. However, in this case, the pseudo tracking error constraints are bang–bang in most places, as shown by Fig. 12. The reason for that is obvious. From Fig. 8, it can be seen that the tracking errors exceed the bound 0.022 mm in most places. After adding the tracking error bound, the pseudo tracking error bound will be the control variable in these places, and the velocity and acceleration have to coordinate themselves to satisfy the tracking error constraints.

Finally, a set of data is used to show the computational scalability of problem (3.18). 
                           N
                         is set to be different values, and the execution times are listed in Table 2
                        . The computation times are taken for 50 iterations of the algorithm, where the algorithm reaches about 99% of the optimum value. The computation times are collected from Matlab on a PC with a 3.0 GHz CPU. On the other hand, the direct solution to the discrete form of problem (3.6) using the same parameters fails for all 
                           N
                        .


                        Test 2:  Complex eigenvalue case.
                     

The proportional, integral, and derivative gains of the PID controller are chosen as 
                           
                              
                                 k
                              
                              
                                 P
                              
                           
                           =
                           10
                           
                           
                              V
                           
                           /
                           
                              mm
                           
                        , 
                           
                              
                                 k
                              
                              
                                 I
                              
                           
                           =
                           480
                           
                           
                              V
                           
                           /
                           
                              (
                              
                                 mm s
                              
                              )
                           
                        , and 
                           
                              
                                 k
                              
                              
                                 D
                              
                           
                           =
                           0.4
                           
                           
                              V
                           
                           /
                           
                              (
                              
                                 mm
                              
                              /
                              
                                 s
                              
                              )
                           
                         for both axes. It can be easily verified that Eq. (2.11) has two conjugate complex eigenvalues. For reasons of simplicity, 
                           δ
                         is set to be 1.

Similar to Test 1, two experiments are carried out. First, we run the test without considering tracking error constraints; the result is shown in Fig. 14
                        . In this situation, the maximum tracking error is 0.085 mm. Then, nominal bounds on the tracking error 
                           
                              
                                 
                                    E
                                 
                              
                              
                                 max
                              
                           
                           =
                           
                              (
                              0.035
                              
                              
                                 mm
                              
                              ,
                              0.035
                              
                              
                                 mm
                              
                              )
                           
                         are added. The corresponding results are shown in Fig. 15
                        , from which we can see that the maximum tracking error is about 0.04 mm. The bounds 
                           
                              
                                 
                                    E
                                 
                              
                              
                                 max
                              
                           
                         are violated slightly, which is due to the omission of the coefficient 
                           δ
                         in problem (3.6).

@&#CONCLUSION@&#

How to use the full ability of a CNC machine to increase machining productivity and at the same time to achieve high machining precision is a basic research problem in CNC machining. The problem is usually formulated as a time-optimal feedrate planning problem under various constraints. To generate a smooth feedrate is an important way to improve machining quality, so bounds for acceleration and jerk are usually used as constraints. On the other hand, the machine dynamic may also lead to large tracking errors. In this paper, bounds of these dynamic errors are also added as constraints in the feedrate planning problem to increase the machining quality. So the minimum-time feedrate planning problem under confined velocity, acceleration, jerk, and tracking error is considered. To be practical, PID controllers are considered, which leads to a third-order dynamic system.

The minimum-time feedrate planning problem in this situation is quite involved, and there exist no efficient algorithms for solving it at present. The main contribution of this paper is to reduce the above minimum-time feedrate planning problem into a finite-state convex optimization problem which can be solved efficiently. The work consists of two key ingredients. First, it is proved that the tracking error constraint can be reduced to a constraint on a linear combination of the acceleration and the jerk. Second, a novel method is introduced to relax the nonlinear constraints involving jerk into linear ones. Experimental results show that the new convex optimization problem gives a nice approximation to the original problem and can be solved efficiently.

It is clear that the machining time is also limited by other factors, such as the cutting force and the quality of the tool-path. It is an interesting problem to consider the time-optimal feedrate planning problem under these new constraints.

@&#REFERENCES@&#

