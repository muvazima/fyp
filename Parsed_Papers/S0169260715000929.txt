@&#MAIN-TITLE@&#uSIMPK. An Excel for Windows-based simulation program for instruction of basic pharmacokinetics principles to pharmacy students

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A pharmacokinetics simulation teaching program is described.


                        
                        
                           
                           It is written in VBA in Excel for Windows.


                        
                        
                           
                           The program covers a wide variety of basic pharmacokinetic content.


                        
                        
                           
                           Students have responded favorably to its use.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Pharmacokinetics

Pharmacy education

Visual Basic for Applications

Microsoft Office

@&#ABSTRACT@&#


               
               
                  Pharmacokinetics can be a challenging topic to teach due to the complex relationships inherent between physiological parameters, mathematical descriptors and equations, and their combined impact on shaping the blood fluid concentration vs. time curves of drugs. A computer program was developed within Microsoft Excel for Windows, designed to assist in the instruction of basic pharmacokinetics within an entry-to-practice pharmacy class environment. The program is composed of a series of spreadsheets (modules) linked by Visual Basic for Applications, intended to illustrate the relationships between pharmacokinetic and in some cases physiological parameters, doses and dose rates and the drug blood fluid concentration vs. time curves. Each module is accompanied by a simulation user's guide, prompting the user to change specific independent parameters and then observe the impact of the change(s) on the drug concentration vs. time curve and on other dependent parameters. “Slider” (or “scroll”) bars can be selected to readily see the effects of repeated changes on the dependencies. Topics covered include one compartment single dose administration (iv bolus, oral, short infusion), intravenous infusion, repeated doses, renal and hepatic clearance, nonlinear elimination, two compartment model, plasma protein binding and the relationship between pharmacokinetics and drug effect. The program has been used in various forms in the classroom over a number of years, with positive ratings generally being received from students for its use in the classroom.
               
            

@&#INTRODUCTION@&#

Pharmacokinetics (PK) constitutes an essential foundational component of entry-to-practice pharmacy curricula. It has roots in biopharmaceutics and impinges extensively into clinical therapeutics. The field incorporates physiological concepts and mathematical descriptors in combination to provide a formative understanding of the relationship between independent pharmacokinetic parameters and on other dependent parameters, and the resultant blood fluid concentrations of drug achieved after drug administration. In pharmacy curricula, the concept of the drug concentration vs. time relationship is integral to an understanding of the relationship between the dose, and drug efficacy and toxicity. This is in turn associated with practical issues in the clinical realm of drug use, such establishing dosing rates and dosing intervals, both fundamental considerations in designing individualized dosing regimens.

The approaches taken in the instruction of PK have the potential to vary widely. Figures are a useful component of PK textbooks [1–4] as they allow for a visualization of discreet changes in PK parameters on the concentration vs. time curve. Because of the complexity in all of the factors working in concert to make up the concentration vs. time curve, a compartmental approach provides a good starting point for introducing the topic to students. Compartmental equations simplify the understanding of PK, and more importantly, allow for the ability to predict the concentrations achieved at any time after administration of drug, once individual constants have been determined.

An intrinsic challenge to teaching PK is related to its association with mathematic relationships incorporating rates of drug movement, volumes and clearances [5,6]. Consequently, delivery of the content in the classroom has the potential to gravitate toward mathematical relationships. There is no denying that this is a necessary educational component, because these mathematical components link the physiological variables to drug movement, and ultimately, the observed blood fluid concentrations. However, if overemphasized, the student may lose sight of the physiological considerations and perhaps fail to recognize the importance of considering PK in the clinical use of drugs. Conversely, too little emphasis on the mathematical components might lead to a failure to become adept with the “tools” of PK (i.e. equations) and their utility in tailoring of individualized dose regimens. Many PK equations are aimed at deriving a concentration of drug at a particular instance in time, sometimes making it difficult for the student to realize the overall concentration vs. time profile of a particular drug in a patient. Graphical figures may provide for visualization of how factors may affect the concentration vs. time curve, but these are limited by their static nature. The availability of a computer simulation program [7] can potentially provide a greater breadth of exposure to this topic.

The purpose of this article is to describe and present an overview of a computer simulation program designed to assist in the teaching of basic PK to undergraduate students (named uSIMPK). It was developed to bridge the gap between PK constants and discrete concentration vs. time relationships, thus allowing a more encompassing view of the relationships. This manuscript focuses on the description of the program, an overview into how it is used in the classroom to illustrate concepts.

@&#METHODS@&#

The program was developed with the intent of being made freely available to all students taking the introductory PK course offered to our pharmacy students. Its design generally followed the content that was presented to the students as part of their didactic learning materials (i.e. lectures) at the University of Alberta. Its design was therefore modular in nature, each module intended to illustrate or explore a specific component of PK behavior of drugs. The Microsoft Excel for Windows program served as the foundation for the program. This selection made it possible to take advantage of the many features (calculations, functions and graphics) already incorporated in a powerful spreadsheet program. The feasibility of the program was immensely enhanced by the presence in Excel of a built-in programming language (Visual Basic for Applications, VBA), which allowed for linkages between modules and sophisticated changes to be made within some of the modules. Another attractive feature of this selection is that Microsoft products are extensively used in educational institutions, thereby facilitating its use and availability.

The framework of the program was dictated by a series of individual spreadsheets within a workbook. Each “module” was really a protected spreadsheet with a basic structure incorporating PK constants and graphics, most of the latter related to blood or plasma concentration vs. time curves. These basic equations relating parameters to concentrations are available in most general textbooks in PK, and are displayed when used within each of the modules. The modules are linked together with ActiveX controls and VBA code, with safeguards incorporated to limit the ability of the user to modify and corrupt the structure of the modules. A selectable User Guide was included which could assist the user to maximize the use of the module from an instructional or self-learning perspective.

To assess the ability of the program to aid in the achievement of the educational outcomes in the curse, student feedback was obtained in two ways. At the University of Alberta there is a requirement for each instructor of a class with 10 or more students to circulate a course evaluation questionnaire. The questions are mostly set by the University, although instructors can add questions that are more specific to their course. The question “The use of instructional technology was a valuable part of this course” has been optionally incorporated to the questionnaire for several years. This question was not fully specific to uSIMPK though, because other elements of instructional technology are also present in the course (specifically on-line notes, an integrated website, and on-line computerized assignments [8]). A survey was also sent to students via their University email accounts. The instrument was designed to assess the student perception of the general utility of uSIMPK (Question 1: “The program was beneficial in helping me to see the relationships between the change in PK parameters and the change in concentration vs. time curves”), and also the manner of its use in the classroom (Question 2: “The program was used effectively in class”). Information was also sought regarding whether the student used an Apple Mac or a Windows-based PC computer, and whether the student actually had used it outside of the classroom environment. This survey (in the format of a Google Docs form) was capable of recording responses anonymously, and limiting one response per student (thus preventing multiple entries from the same student).

@&#RESULTS@&#

In our PK course the first attempt to tackle concentration vs. time curves with first order processes comes with the introduction of intravenous (iv) bolus dosing. This topic is a natural starting point owing to its relative simplicity considering that systemic drug input is immediate. A common misconceptions with clinicians not well versed in PK is a misunderstanding of the relationship between half-life (t½), clearance (CL) and volume of distribution (Vd). In uSIMPK, users can change the independent pharmacokinetic parameters, and they can clearly see that these are the CL and Vd terms (Fig. 1
                           ). Although values are provided for each independent and dependent parameter in the form of a Table, the graphical amount or concentration vs. time data is a key feature of each module. There is an option to use slider bars allowing changes in parameter over a predefined range. By incrementally moving the bar in a direction a virtual animated sequence of changes in the concentration vs. time curve and dynamic change in dependent parameters can be seen.

In using the program in class, a question and answer followed by discussion approach is used. The students are asked what will happen when the dose is say, increased by a factor of 2. A student response system is used to create a poll where a multiple choice question can be asked (for example, AUC will increase, decrease or not change). After short period the poll is closed and the program is used to show the outcome. After a discussion of the reasons for the result, other parameters are explored. In this instructor's experience, the effects of dose and CL are most intuitive for understanding by the students; changes in Vd usually garner a variety of responses, many of them incorrect. uSIMPK can be used to help clarify this for the students.

This module was developed to observe changes in compartmental volumes and clearances from plasma (Fig. 1E). Changing these values will change the intercompartmental rate constants (k
                           10, k
                           21, and k
                           12) normally used to illustrate a conventional compartmental model. This shows the student that the micro-rate constants are dependent variables. Once these values are altered, the program makes use of the Solver routine in Excel to find the values of the macro-rate constants α and β. The distributional CL term is set to be the same in both directions, although students are asked in the Guide to ponder what might cause it to be different in one direction than the other (i.e. transporters).

The displayed graph shows amount rather than the concentration of drug in each compartment vs. time. This allows the user to realize the changes that a parameter can impart on the comparative residence and movement of the drug in each compartment. Values based on plasma are however depicted in tabular form for parameters such as plasma AUC and Vd.

Oral dosing is inherently complex due to the additional dependencies of plasma concentrations on the extent (F) and rate (ka) of absorption. Similar to IV bolus dosing two drugs are shown where for one the dose, CL, Vd, F and ka can be changed. The dependent parameters are AUC, maximum concentration (C
                           max), time of maximum concentration (t
                           max), t½, CL/F and Vd/F (Fig. 1C and D). A complex issues inherent to oral absorption is the phenomenon of flip-flop kinetics [9], which becomes apparent once k becomes larger than ka. A term called t½ terminal is shown to illustrate this point. Slider bars are especially useful here; as the ka is reduced the t½ terminal matches that of the terminal elimination phase (0.693/k). Once the ka falls to less than CL/Vd, the terminal phase t½ becomes the same as 0.693/ka, thus allowing students to readily observe the phenomenon in the plasma concentration vs. time curve.

Here the drug is administered as constant infusion (Fig. 1F). Students can alter independent parameters such as infusion rate, CL and Vd and see the impact on the steady-state plasma concentrations (Css) and on the time to achieve 90% of the steady-state plasma concentrations (this is an arbitrary definition since steady-state is never truly attained, and it varies from module to module so students can realize this). Another alteration the students can make is on the duration of infusion. The infusion can be stopped after it is started to see the decline in the plasma concentrations.

Four modules are included to demonstrate kinetics after repeated doses (Fig. 2
                           ); many of the equations used are summarized in reference [10]. Three modules depict the plasma concentration with repeated IV bolus, short zero-order intermittent iv infusion or oral doses, plotted to steady-state (ranging from 90% to 99%). The key parameters of interest are steady-state maximum, minimum and average concentrations. The peak to trough concentration ratio is also apparent. For oral dosing, the change in tmax between dose one and at steady-state is also shown. One module specifically shows the dosing interval and its effect on steady-state concentrations (“Repeat dose: Effect of dosing interval”). Here the user can use slide bars to incrementally increase the dosing interval keeping the same dose rate. The peak to trough fluctuation ratio is the focus on this module.

In this module four scenarios are presented to the student where a drug with a narrow therapeutic margin has a less than optimal design (each is randomly determined each time the program is opened or button is pressed). They must determine a dose and dosing interval that can be best used to optimize the plasma concentrations for each of the drugs.

Two modules allow for an exploration of the relationships governing the kinetics of drugs excreted by the urinary and metabolic pathways of elimination (Fig. 3
                           ) with the use of a one compartment model. In the renal kinetics module the user can alter some independent pharmacokinetic parameters and observe the influence of the changes on the concentration, urinary excretion rate, amount remaining to be excreted, and the cumulative excretion vs. time profiles. In the metabolite kinetics module, students can see the relative plasma concentration or amount metabolized vs. time profiles of the metabolite vs. parent drug by altering the formation or elimination rates of the metabolite.

Hepatic clearance concepts [11] can be explored for iv and oral dose administration (Fig. 4
                           ). A one compartment model is used, but unlike most other modules, here both drugs can be modified. When these modules are selected, the drugs are randomly generated to be either of low (near plasma volume) or high (much greater than plasma volume) Vd. The initial scenario is that of a low extraction ratio (ER) drug, where ER has a value of 0.053. The user can change the intrinsic CL of unbound drug, unbound fraction in blood (fu), or the hepatic blood flow and see the effects on the hepatic CL and concentration vs. time profile. The Guide then prompts the user to create a high ER drug. By repeating the same steps the difference in dependencies of hepatic CL of a low and high ER drug become apparent.

When slider bars are activated, a drug is randomly created which is either of low (<0.3), moderate (0.3–0.7), or high ER (>0.7). The slider bars allow one to see the changes in the dependent pharmacokinetic parameters and in the concentration vs. time profiles that occur as the basic parameters of flow, intrinsic CL or fu are altered. In the concentration vs. time plots, values are not shown in all of the x- and y-axes to preserve the visual appearance of the graph; focus should be directed to the relative changes in concentrations and dependent variable of AUC, C
                           max and t½.

Three modules specifically focus on nonlinear elimination (Fig. 5
                           ). Upon opening each module, the initial scenario is one where dose or dose rate is well below the capacity of the eliminating process(es). Slider bars are an included option for each module, permitting visualization of the changes over a wide range of altered parameter. In the two modules single doses are examined whereby the dose, the capacity (maximum velocity of reaction, Vmax) of metabolism, or the affinity constant (km) of metabolism, and for the oral dosing, the rate of absorption (ka) can be changed. The user can see the impact of these changes on the concentration vs. time curve after single iv bolus or oral dosing (incorporating a one-compartment model). The ratios of parameters are shown, which allows the user to visualize the changes in the pharmacokinetic parameters in reference to the original situation. In the third module, the impact of changes in the dose rate, capacity and affinity of the enzyme for drug on the steady-state average plasma concentrations.

Two modules have a special focus on the effects protein binding on PK. One module (Fig. 3C) shows how protein binding can influence the distribution and CL of a drug that follows a two compartment model. This is done by allowing the fu of a drug to be changed in either the plasma, the extravascular tissues comprising the central compartment, or the tissues constituting the peripheral compartment. A dialog box appears that invites the user to change parameters by modifying the fu or the CL values for distribution/elimination. The volume of the central compartment (V
                           1) is given by V
                           
                              plasma
                           
                           +
                           V
                           
                              tissue1
                           ×(f
                           
                              u,plasma
                           /f
                           
                              u,tissue1). The volume of the peripheral compartment (V
                           2) is given as V
                           
                              tissue2
                           ×(f
                           
                              u,plasma
                           /f
                           
                              u,tissue2). The steady-state volume of distribution (Vss) is given as V
                           1
                           +
                           V
                           2. The user may also modify the elimination and distribution CL in the dialog box.

Nonlinearity in the binding of the drug to plasma proteins can also be explored (Fig. 3D). This sheet opens as a drug that has a low hepatic extraction ratio. Initially, the fu is close to one, because the plasma protein has a very low capacity and affinity for the drug. A Michaelis–Menten type relationship for binding is defined as C
                           
                              blood,bound
                           
                           =(C
                           
                              bound,max
                           ×
                           C
                           
                              free
                           /C
                           
                              bound,50%
                           +
                           C
                           
                              free
                           ). The Css of free drug is estimated by division of dose rate by the hepatic CL of free drug, which is given by 
                              
                                 (
                                 D
                                 o
                                 s
                                 e
                                 /
                                 τ
                                 )
                                 /
                                 (
                                 (
                                 Q
                                 ⋅
                                 C
                                 
                                    L
                                    
                                       int
                                    
                                    '
                                 
                                 )
                                 /
                                 (
                                 Q
                                 +
                                 C
                                 
                                    L
                                    
                                       int
                                    
                                    '
                                 
                                 )
                                 )
                              
                           . The user may increase capacity (C
                           
                              bound,max) and/or increase the affinity (i.e. decrease C
                           
                              bound,50%). Changes in the fu, CL and Vd of total drug can be visualized which become very marked after maximum capacity and affinity is reached. A toggle button allows the user to view the effect on the steady-state concentration vs. dose rate for total and unbound drug, and the concentration vs. time profile after a single high dose is administered. Doses are fixed in the program, but the dose rate can be changed by modifying the dosing interval. The impact of the protein binding on a high extraction ratio drug is achieved by selecting the labeled toggle button. The outcomes are quite different for the two types of drugs, as the user will find.

In each case, a comparator example is provided for reference, which assumes that the binding is maintained at the same level as the smallest dose administered in the scenario. The chapter on nonlinear processes by Dr.’s Gibaldi and Perrier [12] was invaluable in setting up the scenarios in this module.

One module is specifically designed to examine the impact of dose, changes in affinity of the drug for the proteins involved in the effect, and in PK, and their interrelationships (Fig. 6
                           ) in the form of plasma concentration (one compartment model) and effect vs. time curves. One panel compares the concentration and the effect vs. time profiles for the alterable drug 1, and the other compares the effect vs. time curve for the alterable drug and the one that cannot be altered (the baseline situation).

Two modules (Fig. 6) explore the effect vs. concentration relationship. In these modules upon entering from the main page, the drug is randomly allocated to one where a hysteresis loop [13] is either present or absent. This means that in the two compartment model, the drug receptors for effect are located either in the central or peripheral compartments, or for metabolite kinetics, either the drug or metabolite can interact with receptors for effect. The user is asked to identify which is which in the guide.

To the question “The use of instructional technology was a valuable part of this course” the students have consistently rated the use of instructional technology (of which the program is part) a composite favorability rating of 80–90% over the past 7 years. Because there are other elements of instructional technology used in the PK class, however, another survey was sent to students that specifically addressed the use of uSIMPK in the classroom. A total of 30 responses (Fig. 7
                        ) were received from the students (equivalent to about 24% of the typical 2nd year pharmacy class). The two main questions 1 and 2 gave responses that were highly positively correlated with r
                        2 of 0.76 (p
                        <0.001). The mean overall approval rating for Questions 1 and 2 were 81±21% and 78±23%, respectively. Of the respondents, there was a slight excess (52%) of primary Windows PC than Mac users. Half of the Mac users reported that they still used the program outside of class (e.g. in the computer labs on campus that stock Windows PCs or at home on a PC). Of the 16 PC respondents, there were 13 that said they used the program outside of class. The mean favorability scores to Question 1 (general utility) of respondents who used it outside of class was significantly higher (87%) than that of students who did not use it outside of class (67%; p
                        <0.05). The trend was similar for question 2 (use in class) (means of 8.2 vs. 6.9, respectively) but this difference was not significant for this comparison.

@&#DISCUSSION@&#

Many of the modules are of potential utility in a basic undergraduate course in PK, for either in-class instruction or for home use. An instructor can fit the module into his/her own course as deemed appropriate (e.g. to illustrate concepts in lectures, to promote teamwork when small groups are feasible in classrooms, in computer labs, etc.). Microsoft Excel has been used by others to demonstrate PK principles [14] or for use as a research tool [15]. uSIMPK perhaps differs from many other programs [16] in that it was specifically designed to achieve teaching (rather than research) goals within a structured and relatively simple framework in an entry to practice pharmacy curriculum. As much as possible, limitations have been placed in the selectable cells and in the scales on graphs so that computational errors (e.g. #DIV/0! and #NUM!) are avoided and the visual integrity of the graphs is maintained.

Because the programming components reside within a base program (Excel), this can pose some difficulties. A problematic issue is that Microsoft Office for Mac computers is not compatible with ActiveX controls and lacks some other features present in its Windows version. This can be frustrating for students with Mac computers, and has been articulated by students as written comments in the surveys described in this paper. However, the issue is not insurmountable because there are ways for a Mac user to upload and run Windows and Windows versions of the Office software [17], although it is admittedly not an ideal situation for students due to the extra cost and complexity. At our University, however, students also have access to PC computer labs which can alleviate the problem as long as students are motivated to use them. Even within the Windows version though, difficulties may occasionally occur. A case in point is the recent Windows Security Update in early December 2014, which caused all programs written in its Excel using ActiveX controls to suddenly and unexpectedly fail to function [18]. Although Microsoft has released corrective patches, such occurrences can be frustrating for users and developers. There is a web-based simulator available for use in the classroom to assist in the instruction of PK [8] that overcomes limitations of Excel inherent in Mac computers, but this presents with some limitations (e.g. the use of slider bars as present in uSIMPK would be of limited feasibility in such an application because of transmission delays over the internet).

Most of the students that responded to the uSIMPK-specific survey felt the program was of benefit in helping them to learn PK in the classroom. The numerical scores of the specific survey were very similar to that received from the general question regarding use of instructional technology as included in the final course evaluation, and for which there is a much greater response rate (40–90% in any given year). Despite the limited sample size, the uSIMPK specific survey was still highly informative. First, it established that many of the students use Macs, which underscores the need to encourage them to use the PC computer labs, and perhaps to better inform them of ways to run Windows on their Mac computer if they wish to use the program at home. Another option would be to perhaps hold seminar sessions in the PC computer lab preferably with smaller group learning, although in our case that is limited by curricular design of the course. The favorability scores to the general educational value of the program were higher when the program was used outside of class, but even then many of the Mac users still felt the program was of great benefit within and outside of class. It was of interest that the lowest 3 scores to both questions 1 and 2 were actually provided by students with PCs. This may reflect not necessarily the program itself, but perhaps how they feel about the course (and perhaps the topic) in general; none of these students tried to use the program outside of class.

@&#CONCLUSION@&#

uSIMPK is an Excel for Windows-based program designed to assist in the instruction of PK. The program will be made freely available to interested professors who teach PK at not-for-profit institutions, upon request.

@&#ACKNOWLEDGEMENTS@&#

The author extends thanks to Dr. Reza Mehvar of Chapman University and Dr. Ken Cor at the University of Alberta for their valuable discussions and suggestions.

@&#REFERENCES@&#

