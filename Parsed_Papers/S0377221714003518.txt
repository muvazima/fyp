@&#MAIN-TITLE@&#An implicit enumeration algorithm for the passenger service planning problem: Application to the Taiwan Railways Administration line

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We investigated the passenger service planning problem of a railway company.


                        
                        
                           
                           An implicit enumeration algorithm was developed to solve this problem.


                        
                        
                           
                           Intelligent branching and effective bounding strategies were explored and incorporated.


                        
                        
                           
                           Results show that we can obtain service plans that are at least as good as real-world plans.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in service industries

Passenger railway

Service planning

Implicit enumeration

@&#ABSTRACT@&#


               
               
                  In a passenger railroad system, the service planning problem determines the train stopping strategy, taking into consideration multiple train classes and customer origin–destination (OD) demand, to maximize the short-term operational profit of a rail company or the satisfaction levels of the passengers. The service plan is traditionally decided by rule of thumb, an approach that leaves much room for improvement. To systematically analyze this problem, we propose an integer program approach to determine the optimal service plan for a rail company. The formulated problem has a complex solution space, and commonly used commercial optimization packages are currently incapable of solving this problem efficiently, especially when problems of realistic sizes are considered. Therefore, we develop an implicit enumeration algorithm that incorporates intelligent branching and effective bounding strategies so that the solution space of this integer program can be explored efficiently. The numerical results show that the proposed implicit enumeration algorithm can solve real-world problems and can obtain service plans that are at least as good as those developed by the rail company.
               
            

@&#INTRODUCTION@&#

Railway transport plays an important role in passenger service for long-distance transportation in various metropolitan areas, especially in many Asian countries (e.g., Japan and China). With the growing importance of energy conservation and carbon emissions reduction, improving the quality of railway system service and encouraging its use have become significant issues because public railway transport produces less pollution than private transport. For a passenger railroad system, the rail company must address the service planning problem, which determines the train stopping strategy; to do so, the company must take into consideration both the multiple train classes in use and the customer origin–destination (OD) demand to maximize its profit. Note that train class is related to its service level. For instance, the express train can provide the highest service level by skipping certain stations with fewer passengers and only stop at major stations while local train stops at every station to service the short-distance commuters. If a train skips more stations, the travel times to reach different OD pairs can be shorter.

According to an interview with the staff from Taiwan Railways Administration (TRA), which is one of the major railway companies in Taiwan, service plans are primarily determined manually based on experience. To the best of our knowledge, most rail companies do not have a systematic procedure for solving this service planning problem. In this work, we propose a mathematical programming model for the service planning problem and develop an implicit enumeration algorithm, which explores problem features to accelerate the solution process. Specifically, we devise effective bounding techniques and propose a series of enhanced branching rules so that the enumeration tree can be explored effectively in the implicit enumeration algorithm. The proposed solution framework is empirically applied to real-world networks of various sizes. To demonstrate their efficacy and efficiency, the solutions from the procedure are compared with the optimal solutions from a commercial optimization package. The promising results show that the implicit enumeration algorithm can solve real-world problems within a reasonable timeframe and can determine service plans that are at least as satisfactory as the practical plans already in use by the studied railway company.

The remainder of this paper is structured as follows. Section 2 critically overviews the related work in the literature, and Section 3 presents a mathematical model for the passenger service planning problem. The implicit enumeration algorithm used for solving the problem is detailed in Section 4, and the empirical studies are summarized in Section 5. The final section (Section 6) offers conclusions and suggestions for future research.

@&#LITERATURE REVIEW@&#

Railway management typically operates at three levels, including strategic, tactic and operational levels (Assad, 1980). Given the infrastructure determined in strategic-level decisions, the service planning of a railway company prepares a draft plan of the trains’ stopping strategy and can be considered as a tactic-level problem. The tactic decision for selecting a stopping strategy is likely to contain many conflicts between trains, infeasibilities in train times, headways, dwell times, or other problems. Therefore, once the tactical decision is made, the operational planners adjust and revise the draft plan to eliminate all of the conflicts and infeasibilities generated by train pathing (the assignment of trains to links and tracks) and timetabling (the allocation of time slots to trains) (Lee & Chen (2009)). For a passenger railway transport system, a published timetable is at the core of a firm’s daily operation and numerous applications. Train timetabling problem (TTP) has been studied extensively with a comprehensive review of such problem in Cacchiani and Toth (2012). As indicated by Cacchiani and Toth (2012), various approaches have been proposed to solve TTP, including job-shop scheduling-based approaches, branch-and-bound based methods, heuristics, meta-heuristics (e.g., genetic algorithm and tabu search) and Lagrangian-based approaches. Compared to the solution approaches reported in the literature, our solution approach is the first one to integrate the implicit enumeration, Lagrangian relaxation, genetic algorithm and various problem-specific efficiency-improving rules.

Over the last few decades, a wide range of research studies has been devoted to railway transportation problems; in particular, many of these studies have been focused on the development of mathematical formulations and solution algorithms for all three levels of the planning hierarchy. A more general review of line planning in public transportation network has been reported in Schoebel (2012). Various modeling techniques (e.g., cost-oriented, passenger-oriented, game-theoretic and location-based models) have been comprehensively overviewed in Schoebel (2012). However, only a limited number of studies has been conducted on the railway passenger service plan optimization problem. Lee (2012) studied the optimal skip-stop rail transit operation strategy and proposed a genetic algorithm to solve the problem. However, rail transit has different system features (e.g., high speed and rapid acceleration), and its operation has a different focus than that of the intercity, corridor and long-distance passenger rail systems considered in the current research. To the best of our knowledge, the study most similar in focus to our work is the multiobjective model proposed by Chang, Yeh, and Shen (2000) and Jong, Suen, and Chang (2012). However, Chang et al. (2000) and Jong et al. (2012) analyzed the high-speed rail (HSR) line in Taiwan, which is much less complicated than the TRA system. Therefore, the methods proposed by Chang et al. (2000) and Jong et al. (2012) are not directly applicable to the problem considered in the current research. For example, the HSR system in Taiwan does not have multi-level stations and has only one type of train. Furthermore, the timetable of the HSR system is more flexible than that of the TRA because HSR has not yet fully used up its abundant capacity; hence, the HSR timetable is significantly easier to optimize because it has a wider margin for adjustments to its service plan. Finally, the operational scale of the HSR system is significantly smaller than that of the TRA system (e.g., there are 8 train stations in the HSR system, whereas there are over 200 stations in the TRA system), which makes it more critical to develop an efficient solution approach when solving the TRA’s service planning problem.

In this paper, we take into account the different classifications of the stations and train types in creating a situation that is similar to those of a complicated railway system. We construct an integer linear programming (ILP) model based on the concept of mathematical programming. However, the proposed ILP program proves challenging to solve, especially when large-scale, real-world problems are considered. Therefore, an implicit enumeration solution strategy is developed to solve the problem within a reasonable timeframe. We next present the mathematical formulation of the railway service planning problem.

In this section, we present an ILP model for passenger train service planning. The model seeks to maximize the profit made by a train company by determining the optimal train stopping strategy for a given OD demand under various practical constraints.

In a passenger railroad system, the service planning problem determines the train stopping strategy, taking into consideration multiple train capacities and the customer OD demand to maximize the profit made by the rail company. In this problem, a planner needs to determine the stations and the time intervals the dispatched trains have to stop so that the profit of the rail company can be maximized. To concentrate on the in-depth analysis of the underlying problem, we impose certain assumptions. First, we assume that the model considers passenger demand to be deterministic (given), and the demand level does not vary over time. Further, each train has a capacity limit, and the number of boarded passengers cannot exceed that capacity. In reality, a train company may sell more tickets than the train capacity to increase its profit, and not all passengers may have a seat for the entire trip. In this study, we consider the capacity constraint to be a hard constraint that must be obeyed.

Further, the capacity of rail infrastructure is left to be considered in the train timetabling problem (TTP) and later stages of the planning process. While there are methods developed for rail capacity evaluation (e.g., Mussone & Calvo, 2013), some claim that capacity as such does not exist. For instance, UIC 406 claims that rail infrastructure capacity depends on the way it is utilized. In this work we consider the services, but there are other traffic on the tracks, for example deadheadings. These can be fully determined only after rolling stock planning is completed. Without a detailed timetable and rolling stock plan, the framework presented in the current work can determine an upper bound on the number of trains passing any given section, and leave the detailed capacity calculation issue to later stages, if needed. When needed, our model can be easily extended to set this upper bound. While the service plan aims to provide the general guidance of planning, the TTP takes into account infrastructure capacity, eliminates conflicts and infeasibilities and ensures that the resulting timetable is consistent with the planning goal of a railway company. In other words, the service planning can be considered as preprocess of TTP. Combining the service planning problem and TTP could potentially improve the quality of a timetable. However, the resulting problem can be of large-scale and may not be solvable in a reasonable timeframe. Thus, from the optimization standpoint, these two problems are typically considered separately and perhaps integrated in an iterative manner (i.e. feed the initial service plan to timetabling module and check the resulting timetable against the input service plan). In the current research, we primarily focus on the service planning problem and develop the plans that can guide the capacity planning in later stage of the planning process. As maximizing the short-term operational profit is the objective, long-term issues (such as capacity expansion) is not considered in this research. For instance, the number of trains available for dispatching is bounded by the number of trains currently available. In other words, this research attempts to develop a service plan for a railway company to effectively use their available resources (i.e. trains and stations) and to maximize its short-term operational profit.

Furthermore, because the travel times between stations are continuous and the planning horizon is discretized in the formulation, rounding errors could exist potentially. Therefore, we assume that a train can arrive at a station during a time interval and can only depart from a station at the end of that time interval. Dividing the planning horizon into finer slices can reduce the impact of this rounding error. However, the departure time of each train needs to be modeled carefully (e.g. constrain the departure time to be 5 time intervals after a train’s arrival time) and the resulting problem size can grow significantly. Alternatively, we assume these rounding errors can be compensated by the time supplement and buffer time allocated by planners. Finally, we assume that the passengers have no preference regarding the train classes. When a passenger arrives at a station, she/he will board the first train available at the station. Introducing passenger preferences would certainly improve the fidelity of the proposed model, yet preferences would significantly compound the problem complexity because the resulting program may naturally lend the problem to a bi-level structure.

Based on the problem definition and the assumptions, we next introduce the notation that will be used throughout the paper, followed by a detailed description of the model.


                        
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          Sets
                                       
                                    
                                    
                                       
                                          N
                                       
                                       the set of trains. It should be noted that each train can be of any one of the different types that correspond to its service level
                                    
                                    
                                       
                                          N
                                          
                                             SL
                                          
                                       
                                       the subset of trains with service level SL, N
                                          
                                             SL
                                          
                                          ∈
                                          N. In the current practice of TRA, there are primarily three types of train, namely Tzu-Chiang Express (TCE), the Chu-Kuang Express (CKE) and the Local Train (LT). TCE is the express train that provides the highest service level and is followed by CKE. To provide the corresponding service levels, TCE and CKE may choose to skip certain stations with fewer passengers and only stop at major stations. However, LT stops at every station to service the short-distance commuters
                                    
                                    
                                       
                                          S
                                       
                                       the set of train stations
                                    
                                    
                                       
                                          S
                                          
                                             SL
                                          
                                       
                                       the subset of stations a train with service level SL can service, S
                                          
                                             SL
                                          
                                          ∈
                                          S
                                       
                                    
                                    
                                       
                                          S
                                          
                                             O
                                          
                                       
                                       the subset of passengers’ origin stations, S
                                          
                                             O
                                          
                                          ∈
                                          S
                                       
                                    
                                    
                                       
                                          S
                                          
                                             D
                                          
                                       
                                       the subset of passengers’ destination stations, S
                                          
                                             D
                                          
                                          ∈
                                          S
                                       
                                    
                                    
                                       
                                          OT
                                       
                                       the set of time intervals in which passengers arrive at their origin stations
                                    
                                    
                                       
                                          Parameters
                                       
                                    
                                    
                                       
                                          F
                                          
                                             n
                                          
                                       
                                       the fixed cost of dispatching train n
                                       
                                    
                                    
                                       
                                          M
                                       
                                       A large positive number
                                    
                                    
                                       
                                          Ξ
                                       
                                       the planning horizon, which is represented by a list of time intervals. As noted in Schoebel (2012), the planning horizon should be chosen appropriately. For instance, if one is considering all periods of a day, then the horizon should refer to the time spans all day (e.g. 10h)
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       the travel time of train n between stations i and j. It should be noted that this parameter can be obtained from the Automatic Train Protection (ATP) system, which records the time–space trajectory of each train. The difference between the time train n leaves a station (the time it start moving from station i) and the time it arrives at a station (the time it stops completely at station j) is 
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          CAP
                                          
                                             n
                                          
                                       
                                       the capacity (in terms of number of passengers) of train n
                                       
                                    
                                    
                                       
                                          STCAP
                                          
                                             s
                                          
                                       
                                       the maximum number of trains that can stop at station s at the same time
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       the ticket price of boarding train n at station i and disembarking at station j for passengers
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      s
                                                      τ
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       the stopping cost of train n at station s during time interval τ. The parameter has been estimated by Hsiao (2010)
                                       
                                    
                                    
                                       
                                          D
                                          
                                             ijτ
                                          
                                       
                                       the number of passengers who depart at station i during time interval τ and disembark at station j. This parameter can be obtained from the data warehouse (DWH) system provided by the train company
                                    
                                    
                                       
                                          Decision variables
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ij
                                                      τ
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       the number of passengers who board train n at station i during time interval τ and arrive at station j
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      s
                                                      τ
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      s
                                                      ,
                                                      τ
                                                   
                                                   
                                                      n
                                                   
                                                
                                                =
                                                1
                                             
                                          , if train n stops at station s during time interval τ. 
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      s
                                                      ,
                                                      τ
                                                   
                                                   
                                                      n
                                                   
                                                
                                                =
                                                0
                                             
                                           otherwise
                                    
                                    
                                       
                                          Z
                                          
                                             n
                                          
                                       
                                       
                                          Z
                                          
                                             n
                                          
                                          =1, if train n is dispatched, and Z
                                          
                                             n
                                          
                                          =0 otherwise
                                    
                                 
                              
                           
                        
                     


                        
                           
                              (1)
                              
                                 Maximize
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          τ
                                          ∈
                                          Ξ
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                S
                                             
                                             
                                                O
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                S
                                             
                                             
                                                D
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          ∈
                                          N
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       ij
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          ∈
                                          N
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       n
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          τ
                                          ∈
                                          Ξ
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          ∈
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          s
                                          ∈
                                          S
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       s
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       s
                                       τ
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 Subject
                                 
                                 to
                                 
                                 
                                    
                                       My
                                    
                                    
                                       i
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 ⩾
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                S
                                             
                                             
                                                D
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       O
                                    
                                 
                                 ,
                                 
                                 ∀
                                 n
                                 ∈
                                 N
                                 ,
                                 
                                 ∀
                                 τ
                                 ∈
                                 Ξ
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       My
                                    
                                    
                                       j
                                       τ
                                       +
                                       
                                          
                                             T
                                          
                                          
                                             ij
                                          
                                          
                                             n
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 ⩾
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                S
                                             
                                             
                                                O
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 
                                 ∀
                                 j
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       D
                                    
                                 
                                 ,
                                 
                                 ∀
                                 n
                                 ∈
                                 N
                                 ,
                                 
                                 ∀
                                 
                                    
                                       
                                          τ
                                          +
                                          
                                             
                                                T
                                             
                                             
                                                ij
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                                 ∈
                                 Ξ
                                 ,
                                 
                                 ∀
                                 τ
                                 ∈
                                 Ξ
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          ⩽
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          ⩾
                                          i
                                          +
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       mlk
                                    
                                    
                                       n
                                    
                                 
                                 ⩽
                                 
                                    
                                       CAP
                                    
                                    
                                       n
                                    
                                 
                                 
                                 ∀
                                 n
                                 ∈
                                 N
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       O
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 +
                                 1
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       D
                                    
                                 
                                 
                                 where
                                 
                                 k
                                 =
                                 
                                    
                                       
                                          τ
                                          -
                                          
                                             
                                                T
                                             
                                             
                                                mi
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                                 ∈
                                 Ξ
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          ∈
                                          N
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 ⩽
                                 
                                    
                                       D
                                    
                                    
                                       ij
                                       τ
                                    
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       O
                                    
                                 
                                 ,
                                 
                                 ∀
                                 j
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       D
                                    
                                 
                                 ,
                                 
                                 ∀
                                 τ
                                 ∈
                                 OT
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       Z
                                    
                                    
                                       n
                                    
                                 
                                 ⩾
                                 
                                    
                                       y
                                    
                                    
                                       s
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 
                                 ∀
                                 n
                                 ∈
                                 N
                                 ,
                                 
                                 ∀
                                 s
                                 ∈
                                 S
                                 ,
                                 
                                 ∀
                                 τ
                                 ∈
                                 Ξ
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          τ
                                          ∈
                                          Ξ
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       s
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 ⩽
                                 1
                                 
                                 ∀
                                 n
                                 ∈
                                 N
                                 ,
                                 
                                 ∀
                                 s
                                 ∈
                                 S
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          s
                                          ∈
                                          S
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       s
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 ⩽
                                 1
                                 
                                 ∀
                                 n
                                 ∈
                                 N
                                 ,
                                 
                                 ∀
                                 τ
                                 ∈
                                 Ξ
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          ∈
                                          N
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       s
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 ⩽
                                 
                                    
                                       STCAP
                                    
                                    
                                       s
                                    
                                 
                                 
                                 ∀
                                 s
                                 ∈
                                 S
                                 ,
                                 
                                 ∀
                                 τ
                                 ∈
                                 Ξ
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       y
                                    
                                    
                                       i
                                       
                                          
                                             τ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       j
                                       
                                          
                                             τ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 ⩽
                                 1
                                 
                                 ∀
                                 i
                                 ∈
                                 S
                                 ,
                                 
                                 ∀
                                 j
                                 ∈
                                 S
                                 ,
                                 
                                 ∀
                                 n
                                 ∈
                                 N
                                 ,
                                 
                                 ∀
                                 
                                    
                                       τ
                                    
                                    
                                       1
                                    
                                 
                                 ∈
                                 Ξ
                                 ,
                                 
                                 ∀
                                 
                                    
                                       τ
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 Ξ
                                 ,
                                 
                                 ∀
                                 i
                                 <
                                 j
                                 ,
                                 
                                 ∀
                                 
                                    
                                       τ
                                    
                                    
                                       1
                                    
                                 
                                 >
                                 
                                    
                                       τ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       y
                                    
                                    
                                       i
                                       
                                          
                                             τ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       j
                                       
                                          
                                             τ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 ⩽
                                 1
                                 
                                 ∀
                                 i
                                 ∈
                                 S
                                 ,
                                 
                                 ∀
                                 j
                                 ∈
                                 S
                                 ,
                                 
                                 ∀
                                 n
                                 ∈
                                 N
                                 ,
                                 
                                 ∀
                                 
                                    
                                       τ
                                    
                                    
                                       1
                                    
                                 
                                 ∈
                                 Ξ
                                 ,
                                 
                                 ∀
                                 
                                    
                                       τ
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 Ξ
                                 ⧹
                                 
                                    
                                       
                                          
                                             
                                                τ
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                T
                                             
                                             
                                                ij
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 <
                                 j
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       y
                                    
                                    
                                       s
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 0
                                 
                                 ∀
                                 n
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       SL
                                    
                                 
                                 ,
                                 
                                 ∀
                                 s
                                 ∈
                                 S
                                 ⧹
                                 
                                    
                                       S
                                    
                                    
                                       SL
                                    
                                 
                                 ,
                                 
                                 ∀
                                 τ
                                 ∈
                                 Ξ
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 ∈
                                 
                                    
                                       Z
                                    
                                    
                                       +
                                    
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       O
                                    
                                 
                                 ,
                                 
                                 ∀
                                 j
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       D
                                    
                                 
                                 ,
                                 
                                 ∀
                                 n
                                 ∈
                                 N
                                 ,
                                 
                                 ∀
                                 τ
                                 ∈
                                 Ξ
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       y
                                    
                                    
                                       s
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 n
                                 ∈
                                 N
                                 ,
                                 
                                 ∀
                                 s
                                 ∈
                                 S
                                 ,
                                 
                                 ∀
                                 τ
                                 ∈
                                 Ξ
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       Z
                                    
                                    
                                       n
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 n
                                 ∈
                                 N
                              
                           
                        The objective function maximizes the profit earned by the train company. The first term of the function calculates the revenue by multiplying the price of the tickets by the number of passengers who each buy a ticket at the corresponding price. The second and third terms of the functions are, respectively, the dispatching and the stopping cost of the trains departing from their origins and arriving at their destinations. It should be emphasized that the objective function can be replaced with alternative functions (i.e., a function that maximizes the number of passengers serviced, a function that minimizes the waiting time for passengers or a function that maximizes the customer satisfaction rate) to fit the need of the railway company without changing the algorithm structures presented later. Further, as the profit considered is the short-term operational profit, capacity expansion and passenger behavior changes are not incorporated in this work. Constraint (2) states that only if a train n stops at a station i during time interval τ (that is, 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                    τ
                                 
                                 
                                    n
                                 
                              
                              =
                              1
                           
                        ) can the passengers board the train 
                           
                              
                                 
                                    
                                       M
                                       ⩾
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   D
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                             τ
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        . Otherwise, if 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                    τ
                                 
                                 
                                    n
                                 
                              
                              =
                              0
                           
                        , no passenger from station i can board the train 
                           
                              
                                 
                                    
                                       0
                                       ⩾
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   D
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                             τ
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        . Similarly, constraint (3) applies that same condition to the passengers disembarking from trains at their destinations. Only when a train stops at the destination station j at time interval 
                           
                              τ
                              +
                              
                                 
                                    T
                                 
                                 
                                    ij
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             j
                                             ,
                                             τ
                                             +
                                             
                                                
                                                   T
                                                
                                                
                                                   ij
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             n
                                          
                                       
                                       =
                                       1
                                    
                                 
                              
                           
                         can passengers board that train at origin station i at time interval 
                           
                              τ
                              
                                 
                                    
                                       M
                                       ⩾
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   O
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                             τ
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        . Otherwise, if 
                           
                              
                                 
                                    y
                                 
                                 
                                    j
                                    ,
                                    τ
                                    +
                                    
                                       
                                          T
                                       
                                       
                                          ij
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                              =
                              0
                           
                        , no passenger can board the train 
                           
                              
                                 
                                    
                                       0
                                       ⩾
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   O
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                             τ
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        . The capacity constraint of a train between two consecutive stations i and j is enforced by constraint (4). It should be noted that we number the train stations sequentially from 1 to S. Let train n arrive at station i at time τ; then, the passengers able to take the train must board at station m at time intervals 
                           
                              τ
                              -
                              
                                 
                                    T
                                 
                                 
                                    mi
                                 
                                 
                                    n
                                 
                              
                           
                        . The number of passengers boarding train n before station i (m
                        ⩽
                        i) and disembarking after station i
                        +1 (l
                        ⩾
                        i
                        +1) should not exceed the capacity of the train because these passengers stay on train n between stations i and i
                        +1.Constraint (5) bounds the number of boarded passengers below the actual number of passengers whose trips originate from station i at time interval τ and destination station j. It is worth noting that improving service plans can potentially increase the number of passengers. However, the interaction involves complicated passenger behavioral components and deserves dedicated research efforts. Further, it takes time before passengers can adjust their traveling behaviors after a service plan (and resulting timetable) changes. As we considered only the short-term operational profit in this research, we assume that the number of boarded passengers is bounded by the actual number of passengers. The lost customers can be taken into account by introducing a penalty term in the objective function. For the sake of simplicity, we do not consider the case of lost sales. Constraint (6) ensures that a train can only stop at stations if the train is dispatched. The condition that a trainncan only stop at a station sduring one time interval is enforced by constraint (7). Without this constraint, a train can stop at a station during multiple time intervals. Similarly, the condition that a train n can stop during any time interval τ by only one station s is enforced by constraint (8), without which a train can stop at multiple stations during a single time interval. Constraint (9) limits the number of trains that can stop at a given station s. In other words, constraint (9) specifies the station capacity. Because the stations are numbered sequentially, a train cannot arrive at a station with a greater number within an earlier time interval. This type of unreasonable time–space relationship is prohibited by constraint (10). For example, if a train n stops at station i at time interval 
                           
                              
                                 
                                    τ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             i
                                             ,
                                             
                                                
                                                   τ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             n
                                          
                                       
                                       =
                                       1
                                    
                                 
                              
                           
                        , the train cannot stop at a later station j(j
                        >
                        i) at the time intervals earlier than τ
                        1 (
                           
                              
                                 
                                    y
                                 
                                 
                                    j
                                    ,
                                    
                                       
                                          τ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                              =
                              0
                           
                         where τ
                        2
                        <
                        τ
                        1). Constraint (11) ensures that a train can stop at the next station during the correct time interval. For example, if a train n stops at station i at time interval τ
                        1 (i.e., 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                    ,
                                    
                                       
                                          τ
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                              =
                              1
                           
                        ), it can only stop at a later station j at time interval 
                           
                              
                                 
                                    τ
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    T
                                 
                                 
                                    ij
                                 
                                 
                                    n
                                 
                              
                           
                        . In other words, it cannot stop at station jat time intervals other than time interval 
                           
                              
                                 
                                    τ
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    T
                                 
                                 
                                    ij
                                 
                                 
                                    n
                                 
                              
                           
                        . Therefore, 
                           
                              
                                 
                                    y
                                 
                                 
                                    j
                                    ,
                                    
                                       
                                          τ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                              =
                              0
                           
                         for i
                        <
                        j and 
                           
                              ∀
                              
                                 
                                    τ
                                 
                                 
                                    2
                                 
                              
                              ∈
                              Ξ
                              ⧹
                              
                                 
                                    
                                       
                                          
                                             τ
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             T
                                          
                                          
                                             ij
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        . Constraint (12) limits the stations each type of train associated with a service level can service. Constraint (13) indicates that the decision variables 
                           
                              
                                 
                                    x
                                 
                                 
                                    ij
                                    τ
                                 
                                 
                                    n
                                 
                              
                           
                         are positive integers, while constraints (14) and (15) state that, respectively, the decision variables 
                           
                              
                                 
                                    y
                                 
                                 
                                    s
                                    τ
                                 
                                 
                                    n
                                 
                              
                           
                         and Z
                        
                           n
                         are binary variables. The constructed mathematical formulation corresponds to an ILP problem with a significant number of decision variables and constraints. In the realistic empirical experiment conducted in a later section, we must consider a problem with 24 stations, 74 trains and 96 time intervals. The large number of decision variables (in particular, 
                           
                              
                                 
                                    x
                                 
                                 
                                    ij
                                    τ
                                 
                                 
                                    n
                                 
                              
                           
                         and 
                           
                              
                                 
                                    y
                                 
                                 
                                    s
                                    τ
                                 
                                 
                                    n
                                 
                              
                           
                        ) and the complex solution make this a challenging problem to solve. Next, we further analyze the complexity of the passenger service planning problem as follows.
                           Proposition 1
                           
                              The passenger train service planning problem is NP-hard
                           

We use a reduction from the pickup and delivery problem with time windows (PDPTW) to illustrate this proposition. The PDPTW aims to determine a set of optimal routes for a fleet of vehicles to fulfill the transportation requests, and the PDPTW is NP-hard (Mitrovic-Minic, Krishnamurti, & Laporte, 2004). One can construct an example of the passenger train service planning problem as a PDPTW in the following manner. Each train starts at a station and chooses to stop at various stations after being dispatched. If the train stops at a station within the right time window and the train has not reached its capacity limit, it can pick up passengers and gain the potential profit at each station. The goal is to determine the optimal routes (train stoppings) along the rail and to fulfill the passengers’ OD transportation request to maximize the profit made by the rail company. If we consider the passenger train service planning problem in this manner, it collapses into a PDPTW. Therefore, the passenger train service planning problem is at least NP-hard because it introduces additional side constraints (e.g., the capacity of train stations).□

As shown in Proposition 1, the passenger service planning problem corresponds to a difficult ILP with a significant number of decision variables and a complex solution space. An ILP of this scale and complexity typically cannot be solved by most commercial optimization solvers within reasonable timeframe, especially when problems with realistic sizes are of interest. To tackle a difficult problem, we develop an implicit enumeration solution approach. The design of the solution framework, an empirical study of the application of this method and a comparison between the solutions derived from our approach and those from a commercial solver are presented in the next sections.

In this section, we propose an implicit enumeration solution methodology, which explores the problem features so that the service planning problem can be solved efficiently. To evaluate the accuracy and performance of the proposed solution strategy, we compare our solutions with the solutions from a commercial mixed ILP solver in a small-scale test. In large-scale and real-world dataset experiments, the problem complexity increases drastically, and the commonly used solvers are incapable of determining the optimal solutions within reasonable time frames. We, therefore, solve the problems and compare the results with the service plans currently used by the railway company. The design of the solution scheme is detailed in the following.

When considering an implicit enumeration algorithm, an enumeration tree must be constructed before the searching procedure can be developed. We analyze the mathematical formulation and find that the decision variable 
                           
                              
                                 
                                    y
                                 
                                 
                                    s
                                    τ
                                 
                                 
                                    n
                                 
                              
                           
                         plays a key role that can determine the values of other decision variables as well as the objective value. Therefore, we construct the enumeration tree based on the decision variable 
                           
                              
                                 
                                    y
                                 
                                 
                                    s
                                    τ
                                 
                                 
                                    n
                                 
                              
                           
                        . It should be reminded that 
                           
                              
                                 
                                    y
                                 
                                 
                                    s
                                    τ
                                 
                                 
                                    n
                                 
                              
                              =
                              1
                           
                        , if train n stops at station s during time interval τ, and 
                           
                              
                                 
                                    y
                                 
                                 
                                    s
                                    τ
                                 
                                 
                                    n
                                 
                              
                              =
                              0
                           
                         otherwise. Here, let us use n
                        =3, s
                        =4, τ
                        =96 as an example for ease of explanation. As depicted in Fig. 1
                        , each tree level corresponds to one decision variable, and the left branch yields 
                           
                              
                                 
                                    y
                                 
                                 
                                    s
                                    τ
                                 
                                 
                                    n
                                 
                              
                              =
                              1
                           
                         while the right branch corresponds to 
                           
                              
                                 
                                    y
                                 
                                 
                                    s
                                    τ
                                 
                                 
                                    n
                                 
                              
                              =
                              0
                           
                        .

When exploring the enumeration tree, an exhaustive search is not practical because the number of tree nodes that must be examined can grow exponentially. The primary factors for determining the efficiency of an implicit enumeration-based solution strategy are the branching, pruning and bounding procedures. We develop each procedure in the following sections.

In the search of the enumeration tree, we branch to the left of a current tree node by default, if the decision variable associated with that node is not of integer value. For example, in the example depicted in Fig. 2
                        , let us suppose that the subproblem at node 2 has an optimal solution with 
                           
                              
                                 
                                    y
                                 
                                 
                                    1
                                    ,
                                    2
                                 
                                 
                                    1
                                 
                              
                           
                         of non-integer value. We fix the value of 
                           
                              
                                 
                                    y
                                 
                                 
                                    1
                                    ,
                                    2
                                 
                                 
                                    1
                                 
                              
                           
                         to 1 and explore the subsequent decision variables (e.g., 
                           
                              
                                 
                                    y
                                 
                                 
                                    1
                                    ,
                                    3
                                 
                                 
                                    1
                                 
                              
                           
                        ) accordingly.

The simple branching strategy mentioned above is the approach typically used in most general implicit enumeration solution strategies (Nemhauser & Wolsey, 1988). From our preliminary experiments, this branching rule is not efficient enough for solving passenger service planning problems of realistic sizes. Therefore, we further design the enhanced branching rule depicted in Fig. 3
                         and embed it in our implementation.

We observe that the search procedure can skip the exploration of many levels in an enumeration tree, once the particular decision variables are fixed. For example, let us assume that 
                           
                              
                                 
                                    y
                                 
                                 
                                    1
                                    ,
                                    1
                                 
                                 
                                    1
                                 
                              
                           
                         is fixed to 1 at the beginning of the tree, which indicates that train 1 stops at station 1 at time interval 1. In this scenario, the train cannot stop at station 1 at any other time interval. Therefore, the levels representing the other stopping time intervals at station 1 can be fixed to 0 (e.g., 
                           
                              
                                 
                                    y
                                 
                                 
                                    1
                                    ,
                                    2
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    y
                                 
                                 
                                    1
                                    ,
                                    3
                                 
                                 
                                    1
                                 
                              
                              =
                              …
                              =
                              
                                 
                                    y
                                 
                                 
                                    1
                                    ,
                                    96
                                 
                                 
                                    1
                                 
                              
                              =
                              0
                           
                        ), and the algorithm can initiate the search procedure, which starts from variable 
                           
                              
                                 
                                    y
                                 
                                 
                                    2
                                    ,
                                    1
                                 
                                 
                                    1
                                 
                              
                           
                         in this scenario. The branching rule can be considered as a special “cut,” which eliminates the exploration of many unnecessary tree nodes in the enumeration tree and significantly improves the efficiency of the overall solution scheme.

In an implicit enumeration solution algorithm, the effective upper and lower bounds play crucial roles in determining the solution efficiency. We develop two upper bounding techniques and one lower bounding procedure as follows.

We can obtain an UB by relaxing the integer constraints. Essentially, each linear programming relaxation is composed of constraints (1)–(12) with non-negative variables 
                              
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 1
                                 ⩾
                                 
                                    
                                       y
                                    
                                    
                                       s
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 ⩾
                                 0
                              
                            and 1⩾
                           Z
                           
                              n
                           
                           ⩾0. When calculating the UB from LPR, we warm start the solution of each subproblem with the optimal solution from the parent subproblem. It has been reported in the literature that a new optimal solution can typically be found only after carrying out several pivoting iterations with the Simplex method (Borchers & Mitchell, 1992). Therefore, the warm-start mechanism is used to accelerate the solution procedure of the proposed implicit enumeration algorithm. We denote the solution space of a linear relaxation subproblem at tree node k as 
                              
                                 
                                    
                                       S
                                    
                                    
                                       LP
                                    
                                    
                                       k
                                    
                                 
                              
                           .

The basic principle of LR is the dualizing of complicated constraints in a difficult optimization problem to produce a Lagrangian problem, which is easier to solve and whose optimal value provides an upper bound (for maximization problems) of the optimal value of the original problem. It has been reported that the bounds provided by LR methods are significantly improved compared to those generated by solving the LPR of problems in many instances (Fisher, 1981). In fact, when applied to integer optimization programs, LR can determine the bounds that are at least as sharp as the bound obtained by LPR (Theorem 16.9 in Ahuja, Magnanti, & Orlin (1993)). Therefore, we develop an UB using the LR method and embed the bounds obtained in our overall solution framework.

To choose the appropriate constraints in the relaxation scheme, we first relax one constraint at a time, and we verify whether the resulting program is easy to solve. From the preliminary experiments, we observe that the relaxation of constraints (4) and (9) results in a significant decrease of the computational time. Therefore, we choose to dualize these two constraints and introduce two associated vectors of the Lagrangian multipliers, μ and π. The resulting Lagrangian subproblem can be formulated as:
                              
                                 (16)
                                 
                                    L
                                    (
                                    μ
                                    ,
                                    π
                                    )
                                    =
                                    Maximize
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             τ
                                             ∈
                                             Ξ
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   O
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   D
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             ∈
                                             N
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          ij
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ij
                                          τ
                                       
                                       
                                          n
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             ∈
                                             N
                                          
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          Z
                                       
                                       
                                          n
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             τ
                                             ∈
                                             Ξ
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             ∈
                                             N
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             s
                                             ∈
                                             S
                                          
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          s
                                          τ
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          s
                                          τ
                                       
                                       
                                          n
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             ∈
                                             N
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   O
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   D
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          nij
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   CAP
                                                
                                                
                                                   n
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      m
                                                      ⩽
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      l
                                                      ⩾
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   mlk
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             s
                                             ∈
                                             S
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             τ
                                             ∈
                                             Ξ
                                          
                                       
                                    
                                    
                                       
                                          π
                                       
                                       
                                          s
                                          ,
                                          τ
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   STCAP
                                                
                                                
                                                   s
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      n
                                                      ∈
                                                      N
                                                   
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   s
                                                   τ
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                           Subject to
                        

Constraints (1)–(3), constraints (5)–(8) and constraints (10)–(15).

Rearranging the equation and removing the constant terms result in:
                              
                                 (17)
                                 
                                    L
                                    (
                                    μ
                                    ,
                                    π
                                    )
                                    =
                                    Maximize
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             τ
                                             ∈
                                             Ξ
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   O
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   D
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             ∈
                                             N
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          ij
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ij
                                          τ
                                       
                                       
                                          n
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             ∈
                                             N
                                          
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          Z
                                       
                                       
                                          n
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             ∈
                                             N
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   O
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   D
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          nij
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             m
                                             ⩽
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             l
                                             ⩾
                                             i
                                             +
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          mlk
                                       
                                       
                                          n
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             ∈
                                             N
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             s
                                             ∈
                                             S
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             τ
                                             ∈
                                             Ξ
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   s
                                                   τ
                                                
                                                
                                                   n
                                                
                                             
                                             +
                                             
                                                
                                                   π
                                                
                                                
                                                   s
                                                   ,
                                                   τ
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          s
                                          τ
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           
                        

Thus, the Lagrangian dual can be expressed as:
                              
                                 (18)
                                 
                                    Min
                                    
                                    L
                                    (
                                    μ
                                    ,
                                    π
                                    )
                                 
                              
                           
                        


                           S.t.
                           
                              
                                 (19)
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          nij
                                       
                                    
                                    ⩾
                                    0
                                    
                                    ∀
                                    i
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          O
                                       
                                    
                                    ,
                                    
                                    ∀
                                    j
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          D
                                       
                                    
                                    ,
                                    
                                    ∀
                                    n
                                    ∈
                                    N
                                    ,
                                    
                                    ∀
                                    τ
                                    ∈
                                    Ξ
                                 
                              
                           
                           
                              
                                 (20)
                                 
                                    
                                       
                                          π
                                       
                                       
                                          s
                                          τ
                                       
                                    
                                    ⩾
                                    0
                                    
                                    ∀
                                    s
                                    ∈
                                    S
                                    ,
                                    
                                    ∀
                                    τ
                                    ∈
                                    Ξ
                                 
                              
                           To obtain the sharpest possible upper bound, we must determine L
                           ∗
                           =min(μ,π)
                           
                           L(μ,
                           π), which can be solved by the subgradient heuristic (Ahuja et al., 1993).

The solution procedure of the subgradient heuristic can be described as follows:
                              
                                 
                                    Step 0: Initialize the counter of iterations 
                                       
                                          ζ
                                          =
                                          0
                                          ,
                                          
                                             
                                                μ
                                             
                                             
                                                nij
                                             
                                             
                                                ζ
                                             
                                          
                                          =
                                          0
                                          ,
                                          
                                             
                                                π
                                             
                                             
                                                s
                                                τ
                                             
                                             
                                                ζ
                                             
                                          
                                          =
                                          0
                                       
                                     and let MAX_ITER be the maximum number of iterations


                                    Step 1: Solve the LR subproblem


                                    Step 2: Adjust the Lagrangian multipliers according to:
                                       
                                          (21)
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   nij
                                                
                                                
                                                   ζ
                                                   +
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               nij
                                                            
                                                            
                                                               ζ
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               ζ
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        CAP
                                                                     
                                                                     
                                                                        n
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        
                                                                           ∑
                                                                        
                                                                        
                                                                           m
                                                                           ⩽
                                                                           i
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           ∑
                                                                        
                                                                        
                                                                           l
                                                                           ⩾
                                                                           i
                                                                           +
                                                                           1
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           ∑
                                                                        
                                                                        
                                                                           k
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        mlk
                                                                     
                                                                     
                                                                        n
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   +
                                                
                                             
                                             
                                             ∀
                                             i
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   O
                                                
                                             
                                             ,
                                             
                                             ∀
                                             j
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   D
                                                
                                             
                                             ,
                                             
                                             ∀
                                             n
                                             ∈
                                             N
                                          
                                       
                                    
                                    
                                       
                                          (22)
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   s
                                                   τ
                                                
                                                
                                                   ζ
                                                   +
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               π
                                                            
                                                            
                                                               s
                                                               τ
                                                            
                                                            
                                                               ζ
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               ζ
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        STCAP
                                                                     
                                                                     
                                                                        s
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        
                                                                           ∑
                                                                        
                                                                        
                                                                           n
                                                                           ∈
                                                                           N
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                     
                                                                        s
                                                                        τ
                                                                     
                                                                     
                                                                        n
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   +
                                                
                                             
                                             
                                             ∀
                                             s
                                             ∈
                                             S
                                             ,
                                             
                                             ∀
                                             τ
                                             ∈
                                             Ξ
                                          
                                       
                                    
                                    
                                       
                                          (23)
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   ζ
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         ζ
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                            (
                                                            
                                                               
                                                                  μ
                                                               
                                                               
                                                                  ζ
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  π
                                                               
                                                               
                                                                  ζ
                                                               
                                                            
                                                            )
                                                            -
                                                            LB
                                                         
                                                      
                                                   
                                                
                                                
                                                   ‖
                                                   
                                                      
                                                         CAP
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ⩽
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         l
                                                         ⩾
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         mlk
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         ‖
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          (24)
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   ζ
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         ζ
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                            (
                                                            
                                                               
                                                                  μ
                                                               
                                                               
                                                                  ζ
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  π
                                                               
                                                               
                                                                  ζ
                                                               
                                                            
                                                            )
                                                            -
                                                            LB
                                                         
                                                      
                                                   
                                                
                                                
                                                   ‖
                                                   
                                                      
                                                         STCAP
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         ∈
                                                         N
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         s
                                                         τ
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         ‖
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    where LB is the current lower bound (which can be determined by the genetic algorithm given in a later section), θ
                                    
                                       ζ
                                     and δ
                                    
                                       ζ
                                     are the step sizes of iteration ζ and λ
                                    
                                       ζ
                                     is a scalar chosen between 0 and 2. It should be noted that the notation [·]+ sets the values of 
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                nij
                                             
                                             
                                                ζ
                                                +
                                                1
                                             
                                          
                                       
                                     or 
                                       
                                          
                                             
                                                π
                                             
                                             
                                                s
                                                τ
                                             
                                             
                                                ζ
                                                +
                                                1
                                             
                                          
                                       
                                     to zero, if the components calculated in the bracket are negative.

It should also be noted that we reduce the scalar λ
                                    
                                       ζ
                                     by a factor of 2 whenever three successive iterations at a given value of λ
                                    
                                       ζ
                                     have not improved on the best Lagrangian objective function value L(μ,π)


                                    Step 3: If ζ
                                    >
                                    MAX_ITER, terminate the subgradient heuristic and report the incumbent solution. Else ζ
                                    =
                                    ζ
                                    +1 and go to Step 1.

For the ease of explanation in later sections, we denote the solution space to a LR subproblem at tree node 
                              
                                 k
                                 
                                 
                                    
                                       S
                                    
                                    
                                       LR
                                    
                                    
                                       k
                                    
                                 
                              
                           .

To obtain the lower bounds for the passenger service planning problem, we develop a genetic algorithm that employs an integer encoding mechanism so that the resulting chromosomes and genetic operators can represent the solutions in a more compact and effective manner. The details of the genetic algorithm (GA) are provided in appendix. In the numerical experiments, we use the GA parameters with a population size of 100, a crossover rate of 0.6 and a mutation rate of 0.01 for 100 generations. This set of parameters has been calibrated so that the GA can obtain effective LBs within a reasonable timeframe.

Based on the bounds developed in the earlier section, a tree node k and its subsequent leaf nodes can be pruned under the following three conditions:
                           
                              1.
                              The relaxed problem at tree node k is infeasible. Namely, 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             LP
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       ϕ
                                    
                                  or 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             LR
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       ϕ
                                    
                                 .

The current relaxed program subproblem yields an integer solution. Namely, 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             s
                                             τ
                                          
                                          
                                             n
                                          
                                       
                                       ∈
                                       Z
                                    
                                 .

The solution from the current relaxed program subproblem at tree node k results in a worse objective value than the value of a known feasible solution to the ILP. Namely, 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             LP
                                          
                                          
                                             k
                                          
                                       
                                       ⩽
                                       
                                          
                                             Z
                                          
                                          
                                             ILP
                                          
                                       
                                    
                                  or 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             LR
                                          
                                          
                                             k
                                          
                                       
                                       ⩽
                                       
                                          
                                             Z
                                          
                                          
                                             ILP
                                          
                                       
                                    
                                 .

If any of the above conditions is satisfied, the subsequent tree is pruned, and the search procedure is backtracked to the first decision variable that was fixed to the value of 1 in earlier iterations, and instead, its branch value is set to 0. The backtrack mechanism helps with the implicit exploration of the enumeration tree. Let us use Fig. 4
                         as an example. Suppose that the search procedure determines that fixing 
                           
                              
                                 
                                    y
                                 
                                 
                                    1
                                    ,
                                    1
                                 
                                 
                                    1
                                 
                              
                              =
                              1
                           
                         and 
                           
                              
                                 
                                    y
                                 
                                 
                                    2
                                    ,
                                    1
                                 
                                 
                                    1
                                 
                              
                              =
                              0
                           
                         satisfies one of the three pruning criteria; then, the search procedure backtrack to the decision variable 
                           
                              
                                 
                                    y
                                 
                                 
                                    1
                                    ,
                                    1
                                 
                                 
                                    1
                                 
                              
                           
                         and the branch is set to 0.

When determining the value of the UB in LPR or LR, a significant number of decision variables and the resulting large-scale problem make it difficult to obtain the bound values for practical problems. In our preliminary experiments, it is also difficult for commercial optimization packages to read in a complete subproblem due to its size; ultimately, of course, real-world problems are of interest, and these are significantly larger. However, we observe that a set of variable elimination rules can be applied to reduce the problem size so the commercial optimization packages can handle the subproblems. Further, these variable elimination rules can help the commercial optimization package to skip the commonly used preprocessing procedures in many cases. The rules are generated based on the problem features of the service planning problem of a railway company.
                           
                              
                                 Rule
                                 
                                 I
                                 :
                                 
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                y
                                             
                                             
                                                i
                                                τ
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 M
                                 ⩾
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∉
                                          τ
                                          +
                                          
                                             
                                                T
                                             
                                             
                                                ij
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       jk
                                    
                                    
                                       n
                                    
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 S
                                 ,
                                 
                                 ∀
                                 j
                                 ∈
                                 S
                                 ,
                                 
                                 ∀
                                 τ
                                 ∈
                                 Ξ
                                 ,
                                 
                                 ∀
                                 n
                                 ∈
                                 N
                              
                           
                        
                     

We observe that the optimal value of certain variables in a tree node can be determined after some variables from its parent node have been fixed. If a train n is determined to stop at station i at time interval 
                           
                              τ
                              
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             i
                                             τ
                                          
                                          
                                             n
                                          
                                       
                                       =
                                       1
                                    
                                 
                              
                           
                         at a tree node, then it can only stop at subsequent stations at the right time intervals 
                           
                              τ
                              +
                              
                                 
                                    T
                                 
                                 
                                    ij
                                 
                                 
                                    n
                                 
                              
                           
                        . In other words, the decision variables associated with the wrong time intervals should be fixed to zero 
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∉
                                             τ
                                             +
                                             
                                                
                                                   T
                                                
                                                
                                                   ij
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             jk
                                          
                                          
                                             n
                                          
                                       
                                       =
                                       0
                                    
                                 
                              
                           
                        . Thus, we can eliminate the variables 
                           
                              
                                 
                                    y
                                 
                                 
                                    jk
                                 
                                 
                                    n
                                 
                              
                              
                              ∀
                              k
                              
                              ∉
                              
                              τ
                              +
                              
                                 
                                    T
                                 
                                 
                                    ij
                                 
                                 
                                    n
                                 
                              
                              ∀
                              j
                              ∈
                              S
                              ,
                              ∀
                              τ
                              ∈
                              Ξ
                              ,
                              ∀
                              n
                              ∈
                              N
                           
                         from the subproblem, if 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                    τ
                                 
                                 
                                    n
                                 
                              
                              =
                              1
                           
                        , which is based on rule I.
                           
                              
                                 Rule
                                 
                                 II
                                 :
                                 
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                y
                                             
                                             
                                                i
                                                τ
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 M
                                 ⩾
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          Ξ
                                          ⧹
                                          τ
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       jk
                                    
                                    
                                       n
                                    
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 S
                                 ,
                                 
                                 ∀
                                 j
                                 ∈
                                 S
                                 ,
                                 
                                 ∀
                                 τ
                                 ∈
                                 Ξ
                                 ,
                                 
                                 ∀
                                 n
                                 ∈
                                 N
                              
                           
                        
                     

Similarly, a train can stop at a station at exactly one time interval. Therefore, if 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                    τ
                                 
                                 
                                    n
                                 
                              
                              =
                              1
                           
                        , we can eliminate variables 
                           
                              
                                 
                                    y
                                 
                                 
                                    jk
                                 
                                 
                                    n
                                 
                              
                              
                              ∀
                              k
                              ∈
                              Ξ
                              ⧹
                              τ
                              ,
                              ∀
                              j
                              ∈
                              S
                              ,
                              ∀
                              n
                              ∈
                              N
                           
                        .
                           
                              
                                 Rule
                                 
                                 III
                                 :
                                 
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                y
                                             
                                             
                                                i
                                                τ
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 M
                                 ⩾
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          S
                                          ⧹
                                          i
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 S
                                 ,
                                 
                                 ∀
                                 τ
                                 ∈
                                 Ξ
                                 ,
                                 
                                 ∀
                                 n
                                 ∈
                                 N
                              
                           
                        
                     

Once a train stops at a station i at time interval τ 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             i
                                             τ
                                          
                                          
                                             n
                                          
                                       
                                       =
                                       1
                                    
                                 
                              
                           
                        , it cannot stop at any other station at that same time interval. Therefore, 
                           
                              
                                 
                                    y
                                 
                                 
                                    j
                                    τ
                                 
                                 
                                    n
                                 
                              
                              =
                              0
                              
                              ∀
                              j
                              ∈
                              S
                              ⧹
                              i
                              ,
                              ∀
                              τ
                              ∈
                              Ξ
                              ,
                              ∀
                              n
                              ∈
                              N
                           
                        .


                        Rule IV: Let set N
                        1 be the set of trains that stops at station s at time interval τ and N
                        2
                        ∈
                        N⧹N
                        1. Then, the rule can be expressed as 
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             s
                                             τ
                                          
                                          
                                             n
                                          
                                       
                                       -
                                       
                                          
                                             STCAP
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                              
                              ·
                              M
                              ⩾
                              
                                 
                                    ∑
                                 
                                 
                                    n
                                    ∈
                                    
                                       
                                          N
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    s
                                    τ
                                 
                                 
                                    n
                                 
                              
                           
                        .

If the number of trains that stop at a station s at time interval τ reaches the station capacity 
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             s
                                             τ
                                          
                                          
                                             n
                                          
                                       
                                       =
                                       
                                          
                                             STCAP
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                              
                           
                        , then no other train can stop at that station at the same time interval, and therefore, 
                           
                              
                                 
                                    y
                                 
                                 
                                    s
                                    τ
                                 
                                 
                                    n
                                 
                              
                              =
                              0
                              
                              ∀
                              s
                              ∈
                              S
                              ,
                              ∀
                              τ
                              ∈
                              Ξ
                              ,
                              ∀
                              n
                              ∈
                              
                                 
                                    N
                                 
                                 
                                    2
                                 
                              
                           
                        .

The rules described above can be used to reduce the problem size of the subproblems. For example, if a particular decision variable 
                           
                              
                                 
                                    y
                                 
                                 
                                    s
                                    τ
                                 
                                 
                                    n
                                 
                              
                           
                         is fixed to the value zero, we can remove the variable from the mathematical formulation of a subproblem. Because the problem size of a subproblem can be reduced significantly, the algorithmic performance improves drastically. This is particularly evident when applying the LR to obtain the upper bound because the relaxed subproblem can become an integer linear programming problem with a considerably reduced number of decision variables. As shown in a later section, this problem reduction scheme is critical because most commercial optimization packages cannot handle (even read in) the complete problem with all variables and constraints.

The solution procedure of the proposed implicit enumeration algorithm can be summarized as given in Fig. 5
                        . The first step initializes the enumeration tree, which contains all of the potential solutions. The algorithm then solves the subproblem (either LPR or LR) at the current tree node in Step 2. If the subproblem is infeasible or if the subproblem yields an integer solution, branching further from the current tree node will not generate a better solution, and the search procedure can thus prune the subsequent subtree in Step 5. However, if the subproblem is feasible and yields a non-integer solution, the algorithm checks whether the search procedure has reached the bottom of the search tree. If so, the algorithm backtracks using the rule presented in previous section. Otherwise, the algorithm proceeds to Step 8 and branches further.

Step 9 checks whether there exist any tree nodes that should be explored further (e.g., at the boundary of the enumeration tree, cannot branch further or cannot backtrack anymore). If so, the algorithm returns to Step 2. Otherwise, the algorithm terminates and reports the incumbent solution. Because we develop two upper bounding schemes (LPR and LR), we refer to the algorithm with the LPR implicit enumeration with LPR and GA as IELPRGA, and we refer to the algorithm with LR as IELRGA.

The proposed implicit enumeration algorithm was implemented in the ANSI C programming language. The numerical experiments were conducted on a Windows-based machine with an Intel 3.40gigahertz CPU and 16gigabyte of memory. For comparison purposes, we solved the same problem with CPLEX Version 12.2 and compared our solutions with the solutions from CPLEX. The OD matrix is extracted from the data warehouse (DWH) system used in the TRA, and the travel times between stations for each train are the values used by the TRA when preparing the timetable in practice. Currently, there are three primary types of trains in service in the TRA, including the TCE, the CKE and the LT. TCE is the express train that provides the highest service level and is followed by CKE. Service level is defined based on the time required to travel between ODs. To provide the corresponding service levels, TCE and CKE may choose to skip certain stations with fewer passengers and only stop at major stations. Further, TCE and CKE travel faster than LT. LT stops at every station to service the short-distance commuters and typically travels at a lower speed. The parameters corresponding to the three types of trains are summarized in Table 1
                     . The cost is in units of New Taiwan Dollars (NTD).

The cost parameters provided in the table include only the variable costs (e.g., the personnel cost and the service charge) and exclude the fixed cost (e.g., the depreciated and infrastructure costs).

We first use a subset of the network from the TRA as an example to compare the performance of CPLEX with that of the proposed IELPRGA and IELRGA. For CPLEX, we adopt the default settings (i.e. relative optimality gap is 1e-4 and let CPLEX determine the branching variable selected). In this small example, we assume that there are only three trains in service. The network consists of four stations, and the OD demand of this network is shown in Table 2
                        . Note that demand is uniformly distributed over the planning period in this case. Many commonly used distributions (i.e. normal distribution) can result in obvious peak and off-peak hours. In a scenario that has obvious peak and off-peak hours, it is in fact easier to find the optimal solution because the number of decisions can be reduced. For instance, in a normal distribution, the probability of occurrences of extreme values are low and one can ignore these values and focus only on the time slots that have peak demand values without affecting the optimal solutions. Thus, assuming a uniform distribution results in a more difficult problem. Finally, as there is no direct competition in the same railway market, the lost passengers will turn to alternative means of transportation (i.e. bus).

The resulting mathematical formulation has 13,824 decision variables (3460 binary variables and 13,824 integer variables) and 169,337 constraints. The optimal solution results in a profit of 60,049.84 NTD. The computational times required by CPLEX, IELPRGA and IELRGA are 3196.24, 216.72 and 43.29 CPU seconds, respectively. The empirical results show that IELPRGA and IELRGA obtain an identical solution with 6.78% and 1.35% of the computational times, respectively, which demonstrates the efficiency of the proposed solution schemes. To further compare the algorithmic performance, we plot the upper and lower bounds from both solution algorithms in Fig. 6
                        .

As can be observed in Fig. 6, the upper bound (UB) determined by LR is always lower than or equal to the UB determined by LPR. In other words, the UB determined by LR is tighter than that from LPR, which results in the faster convergence of IELRGA. Compared to a pure GA, IELRGA not only converges to the optimal solution faster, but also can tell the optimality gap during the solution process. From our preliminary experiments, IELRGA outperforms IELPRGA in most cases and can obtain identical solutions to those produced by CPLEX. Therefore, we apply IELRGA in the following experiments.

In this section, we perturb the passenger demand levels and investigate the impact of the demand levels on the service plans. The results are summarized in Table 3
                           . When the demand level is reduced to 50%, the stopping cost of the LT is relatively high when compared to the revenue that the demand level creates. Additionally, the LT must stop by stations consecutively. For example, if the LT chooses to stop at station 1, it also must stop by station 2. Therefore, in a low-demand scenario, the LT only stops at stations 3 and 4. When the demand level is increased to 125% and then to 150%, all of the trains reach their capacity limits, and therefore, the stopping strategies do not change.

We next plot the relationship between the profit and the demand level in Fig. 7
                           .

As can be observed, the profit ceases to increase after the demand level reaches a critical point; this point is determined by the time at which the trains meet their capacities.

We next conduct a sensitivity analysis of the train capacity according to the capacity/train formations that the TRA currently uses in the field. The results are summarized in Table 4
                            (Base, TCE136, TCE224, TCE396 and LT204 cases).

When using the minimal TCE formation with TCE capacity 136 (case TCE136), the TRA does not use TCE to service the customers because it is not profitable. When the capacity of TCE increases, the profit made by the TRA increases from 33,433.22 (case TCE136) to 37,033.40 (case TCE224), 52,143.43 (case TCE396) and 60,049.84 (case Base). Compared with the profit using minimal TCE formation, the resulting profit growth rates are 1.11, 1.56 and 1.80, respectively. However, the stopping strategies remain the same for the later cases. If we halve the capacity of LT to 204, the LT is likely to stop by fewer stations, which in turn will increase its profit.

As can be expected, the cost parameters (the dispatching cost F
                           
                              n
                            and the stopping cost 
                              
                                 
                                    
                                       C
                                    
                                    
                                       s
                                       τ
                                    
                                    
                                       n
                                    
                                 
                              
                           ) can be difficult to determine in practice. Although the cost parameters are estimated based on the data provided by the TRA, we believe that these values can vary significantly, and thus, we conduct a sensitivity analysis of the cost parameters. The results are summarized in Fig. 8
                           .

We increase the cost parameters by 10–100% and observe that the stopping cost generally has a greater impact on the profit than the dispatching cost. Further, the relationship between stopping cost and profit may not necessarily be linear. The results show that TRA could skip a station if stopping cost is relatively high and stopping by that station is not profitable. That is, if a station has only a limited number of passengers and the stopping cost of a train is higher than the revenue made by servicing all the passengers from that station, TRA should skip that station. Thus, the relationship between stopping cost and profit may not necessarily be linear. The behavior around 80–90% reveals this phenomenon. However, when the dispatching cost is increased to 200%, the TRA may choose not to dispatch a train and the increase of the dispatching cost has a greater impact than the increase of the stopping cost in this scenario. Further, when the costs are proportionally decreased, the impact of the stopping cost increase could be more significant than the impact of the dispatching costs, especially when the costs are decreased to less than 70%. From this experiment, we can also observe that the impact of the stopping cost on the total profit is non-linear.

The experiments on the subset of the realistic network demonstrate the correctness and efficiency of the proposed solution algorithm. We next apply the proposed solution scheme to a realistic network to examine how it performs in a real-world problem. In this experiment, CPLEX cannot solve the original formulation (Eqs. (1)–(15)) due to the large number of decision variables and constraints. Therefore, we only present the solution from the most efficient algorithm (IELRGA) and compare the results against the current service plan given by the TRA in the following section.

The final network analyzed (depicted in Fig. 9
                        ) is a portion of the network that the TRA currently operates. The study area is located between Chiayi and Kaohsiung in southern Taiwan. The rail network consists of 24 stations of various classifications and currently has 74 trains (15 TCE, 21 CKE and 38 LT). We again consider 96 time intervals as our planning horizon. The OD demand of passengers is obtained from the DWH system of the TRA. For ease of readability and comparison, we critically summarize the assumptions imposed in the current research: (1) The proposed model aims to maximize short-term operation profit. (2) Passenger demand is exogenous, deterministic, and does not vary over time. Furthermore, demand is uniformly distributed over the planning period. (3) Train capacity is a hard constraint. (4) The capacity of rail infrastructure is left to be considered in the train timetabling problem and later stages of the planning process. (5) Capacity expansion and passenger preference regarding the train classes are not considered. (6) It is assumed that a train can arrive at a station during a time interval and can only depart from a station at the end of that time interval.

The empirical results are summarized in Table 5
                        . In the table, we compare the stopping patterns of TCE from our model and the patterns from the TRA. In the table, we do not present the stopping patterns of CKE and LT because the number of trains is substantial, which makes it difficult to observe systematic differences. Further, because TCE and CKE only stop at major stations, Table 5 only lists certain stations (8 stations instead of 24 stations).

For this realistic network, we run the algorithm for 8,512.42 CPU seconds, and the resulting total profit is 6,848,049 NTD. A total of 58 trains are dispatched, rather than the 74 trains specified by the TRA. That is, based on the numerical results, it is possible for the TRA to use a reduced quantity of the available resources to obtain a higher profit, if TRA regards profit maximization as their planning objective. Further, it is evident that stopping at certain stations is not profitable. For example, the passenger numbers originating from Gangshan and Xinzuoying are 550 per day (6 passenger/time interval) and 2880 per day (30 passenger/time interval), respectively, which makes the TCE stop not profitable. Therefore, our algorithm suggests using CKE or LT to service these two stations. For station Xinying (6432 passengers per day), our algorithm suggests stopping one more TCE so that the resulting profit would be higher. Given the same OD matrix, the TRA can increase the profit by 1,361,484 NTD if it uses the stopping patterns suggested by our algorithm. Therefore, to increase its profit, the TRA may consider reducing the number of trains at the non-profitable stations. Except for these minor differences, we obtain the same service plans currently used by TRA but with a higher profit, which demonstrates the practical use of the proposed solution scheme.

The service planning of a passenger railway company determines the train stopping strategy utilized to maximize the profit made by the company. To date, the service plan for the rail system operated by the TRA has been determined primarily through manual coordination under complicated circumstances. As the industry has become increasingly competitive, it has become more critical to introduce a systematic approach to make decisions regarding improvements in the system’s service plan. We present a mathematical optimization model for use in developing the TRA’s passenger service plan, with the objective of maximizing profit. An implicit enumeration algorithm is proposed to solve this problem. The solution strategies are empirically applied to real-world cases and yield encouraging results in both solution quality and computational efficiency. Although promising results can be obtained with the proposed solution scheme, our solution scheme is not without limitations. For example, the assumptions imposed in this study (e.g., a deterministic demand or passenger preferences) can be explored in future research. Different mathematical models should be constructed and explored if any assumption is relaxed. For example, a model that considers the behaviors of the passenger lends itself naturally to being a bi-level program, which can pose considerable challenge both in theory as well as in application. Further, passenger demand elasticity is an important issue that could be incorporated in the future work. Improving service plans can potentially increase the number of passengers. Future work can discuss how an improved service plan affects the number of passengers and embeds this issue into the solution framework proposed in this research. From the modeling perspective, a direction of future improvement is time discretization. As can be observed from the mathematical formulation, discretizing the planning horizon increases the resulting problem size drastically. An alternative modeling technique is to formulate the problem based on the occurrence of events (i.e. the event-activity network presented by Dollevoet, Huisman, Schmidt, & Schöbel (2012)). Passenger rerouting behavior can also be incorporated using the same modeling framework.

The last but not least direction of future research is the rolling stock problem. In a more general scenario, a train can carry out several services within the same planning horizon, which results in an optimization problem of assigning the rolling stocks effectively. Given a service plan determined by the approach presented in the current paper, future research needs to address the rolling stock problem when preparing the optimal timetable for a more complex rail network.

@&#ACKNOWLEDGEMENTS@&#

The authors acknowledge the National Research Council, Taiwan, ROC for providing partial funding support under Contract Number NSC 100-2410-H-006-069-MY3. The contents of the article remain the sole responsibility of the authors.

A GA is a global search heuristic, developed on the principles of evolutionary biology (Holland, 1975), in which the solution spaces with a higher proportion of good solutions are searched more intensely. A GA starts with a group of randomly generated feasible solutions, which are referred to as the populations. The populations evolve over multiple iterations (referred to as the generations or the trials) based on the principle of “survival of the fittest”. The main procedures of a GA include initialization, encoding, functional evaluation, selection, crossover and mutation. In the initialization step, a set of predefined parameters of the GA, including the maximum number of functional evaluations, the population size, the crossover rate and the mutation rate, are initialized. A typical GA then encodes the decision variables into a binary string (referred to as the chromosome) with a lower bound of 0 and an upper bound of 1 to represent the variables. The function evaluation is performed so that each chromosome corresponds to a fitness value that indicates its quality. In the selection stage, a new generation is chosen from the current generation based on the fitness measure. A crossover operator randomly chooses a point in the chromosome structure and exchanges the segments at the crossover point. Mutation is then applied to explore the greater solution space. The mutation probability is a predefined parameter that is usually set to a low value to prevent the search from becoming a random search and to avoid genetic drift. The randomly chosen position of the structure is replaced with a randomly selected number (either 0 or 1) when mutation occurs. Based on the GA principles described above, we develop a GA-based framework based on the work by Lin and Ku (2014) to calculate the lower bounds for the service planning problem. We first introduce the encoding mechanism and the resulting chromosome design (depicted in Fig. 10
                     ).

We divide a chromosome into N sections based on the number of trains. In the example illustrated in Fig. 10, there are three sections that correspond to three trains. Each section is further divided into S subsections according to the number of stations considered (four in this example). In each cell of the subsections, we randomly assign an integer to represent the stopping time of the corresponding train at the associated station. For example, the circled part of the chromosome in Fig. 10 indicates that Train 1 stops at Station 1 at time interval 1. To ensure the feasibility of the chromosome, the integers following the first integer should be generated in a manner so that the constraints described in the mathematical formulation are not violated. For example, the integers following 1 should be greater than 1 (4, 8 and 12 in the example) so that the train does not travel backward in time. Further, the time intervals generated should be based on the travel times between the stations. For example, the travel time between station 1 and station 2 is 3 in this example. Therefore, when generating the stopping time interval for train 1 at station 2, the number generated can only be 4 because the train has already stopped at station 1 at time interval 1. In the chromosome, the value of 0 represents the notion that the train skips that station and does not stop. To further ensure the feasibility of each chromosome, constraint violations are penalized during the fitness evaluation. For example, let M be a large positive number, the fitness value, which corresponds to a chromosome, is decreased by the value of c
                     ×
                     M where c is the number of constraints violated in that chromosome.

The genetic operators (e.g., crossover and mutation) that we use were developed by Deb and Agrawal (1995) and Deb and Goyal (1996). The crossover operator used in the current work is the simulated binary crossover (SBX) developed by Deb and Agrawal (1995). Assume that 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 1
                                 ,
                                 t
                              
                           
                        
                      is the ith location of the first chromosome; then, in performing a crossover operation in generation t, 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 2
                                 ,
                                 t
                              
                           
                        
                      is the corresponding location of the second chromosome in the same generation. 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 1
                                 ,
                                 t
                              
                           
                        
                      and 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 2
                                 ,
                                 t
                              
                           
                        
                      can be updated according to 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 1
                                 ,
                                 t
                                 +
                                 1
                              
                           
                           =
                           0.5
                           
                              
                                 
                                    (
                                    1
                                    +
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                       
                                          1
                                          ,
                                          t
                                       
                                    
                                    +
                                    (
                                    1
                                    -
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                       
                                          2
                                          ,
                                          t
                                       
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 2
                                 ,
                                 t
                                 +
                                 1
                              
                           
                           =
                           0.5
                           
                              
                                 
                                    (
                                    1
                                    -
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                       
                                          1
                                          ,
                                          t
                                       
                                    
                                    +
                                    (
                                    1
                                    +
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                       
                                          2
                                          ,
                                          t
                                       
                                    
                                 
                              
                           
                        
                     . It should be noted that β
                     
                        i
                      is the spread factor defined by the following density function 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   2
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         α
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             if
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                             
                                             ⩽
                                             0.5
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               2
                                                               (
                                                               1
                                                               -
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         α
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             otherwise
                                          
                                       
                                    
                                 
                              
                           
                        
                     , in which α is a user-defined parameter and r
                     
                        i
                      is a random scalar between 0 and 1 generated to calculate β
                     
                        i
                      in each iteration. Deb and Agrawal (1995) have shown that the SBX has a search power similar to that of the single-point crossover employed in most binary-coded genetic algorithms. However, it is possible that the calculated 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 1
                                 ,
                                 t
                                 +
                                 1
                              
                           
                        
                      or 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 2
                                 ,
                                 t
                                 +
                                 1
                              
                           
                        
                      can be fractional after the updates, thus we choose to round 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 1
                                 ,
                                 t
                                 +
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 2
                                 ,
                                 t
                                 +
                                 1
                              
                           
                        
                      to the nearest integer values should that happen.

The mutation operation is the polynomial mutation designed by Deb and Goyal (1996). Assume that 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                        
                      is the i
                     
                        th
                      location of a chromosome selected for performing a mutation operation. Denote 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 U
                              
                           
                        
                      and 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 L
                              
                           
                        
                      as the predefined upper bound and lower bound, respectively, of 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                        
                     . With a randomly generated scalar r
                     
                        i
                      (between 0 and 1) and an η
                     
                        m
                      (typically with a value of 20), we calculate a value δ
                     
                        i
                      by 
                        
                           
                              
                                 δ
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   2
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               η
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             -
                                             1
                                          
                                          
                                             if
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                             
                                             <
                                             0.5
                                          
                                       
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   [
                                                   2
                                                   (
                                                   1
                                                   -
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   ]
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               η
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             otherwise
                                          
                                       
                                    
                                 
                              
                           
                        
                     . The value of δ
                     
                        i
                      then can be used to perform the mutation operation according to 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 t
                                 +
                                 1
                              
                           
                           =
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           +
                           (
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 U
                              
                           
                           -
                           
                              
                                 m
                              
                              
                                 i
                              
                              
                                 L
                              
                           
                           )
                           
                              
                                 δ
                              
                              
                                 i
                              
                           
                        
                     . Similarly, the rounding procedure should be performed as carried out in the crossover operation. Detailed derivations of the crossover and mutation operations are presented by Deb and Agrawal (1995) and Deb and Goyal (1996).

@&#REFERENCES@&#

