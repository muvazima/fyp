@&#MAIN-TITLE@&#A review of segmentation and deformable registration methods applied to adaptive cervical cancer radiation therapy treatment planning

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           This paper reviews the current state-of-the-art segmentation and deformable registration methods applied to cervical cancer adaptive radiation therapy planning.


                        
                        
                           
                           Strength and weaknesses of the registration and the segmentation methods are studied and analyzed.


                        
                        
                           
                           Use of shape prior constraints can significantly reduce segmentation and registration errors.


                        
                        
                           
                           Use of tissue specific classification of tumor may reduce tumor segmentation error.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Cervical cancer radiation therapy

B-spline registration

Statistical shape models

@&#ABSTRACT@&#


               
               
                  Objective
                  Manual contouring and registration for radiotherapy treatment planning and online adaptation for cervical cancer radiation therapy in computed tomography (CT) and magnetic resonance images (MRI) are often necessary. However manual intervention is time consuming and may suffer from inter or intra-rater variability. In recent years a number of computer-guided automatic or semi-automatic segmentation and registration methods have been proposed. Segmentation and registration in CT and MRI for this purpose is a challenging task due to soft tissue deformation, inter-patient shape and appearance variation and anatomical changes over the course of treatment. The objective of this work is to provide a state-of-the-art review of computer-aided methods developed for adaptive treatment planning and radiation therapy planning for cervical cancer radiation therapy.
               
               
                  Methods
                  Segmentation and registration methods published with the goal of cervical cancer treatment planning and adaptation have been identified from the literature (PubMed and Google Scholar). A comprehensive description of each method is provided. Similarities and differences of these methods are highlighted and the strengths and weaknesses of these methods are discussed. A discussion about choice of an appropriate method for a given modality is provided.
               
               
                  Results
                  In the reviewed papers a Dice similarity coefficient of around 0.85 along with mean absolute surface distance of 2–4mm for the clinically treated volume were reported for transfer of contours from planning day to the treatment day.
               
               
                  Conclusions
                  Most segmentation and non-rigid registration methods have been primarily designed for adaptive re-planning for the transfer of contours from planning day to the treatment day. The use of shape priors significantly improved segmentation and registration accuracy compared to other models.
               
            

@&#INTRODUCTION@&#

An estimated 527,000 new cases of cervical cancer were detected worldwide in 2012. Cervical cancer is the third most common cancer among women and accounted for over 265,000 estimated deaths worldwide in the year 2012 [1] and 208 deaths in 2007 in Australia [2]. Factors such as age, stage of the cancer, and tumor type determine the treatment procedure for cervical cancer with the stage of disease being the primary determinant. Radiation therapy or radiotherapy (RT) is recommended for a large group of patients [3]. Primarily RT is indicated for advanced stage cervical cancers (FIGO stage II–IV) and in patients with earlier stage cancers who are not fit enough for surgery. During RT a high dose of radiation is delivered to the cancerous tumor while attempting to minimize the dose to the healthy tissues in the vicinity. The balancing act lies in designing a treatment plan which maximizes damage to cancer cells while minimizing the radiation dose delivered to surrounding healthy tissues. In Fig. 1
                      we observe the radiation dose received by healthy tissues close to the cervix.

Traditionally, in image guided RT (IGRT) treatment planning the cervix and the tumor, uterus, parametrium, vagina, bladder, rectum and pelvic bones are contoured in CT images. Electron density information from the simulation CT scan enables RT dose calculation. The entire framework of CT guided RT is given in Fig. 2
                     .

The radiation dose is delivered in daily sessions typically over five to six weeks to maximize damage to tumor cells while minimizing the damage to healthy tissues. Factors such as the definition of the tumor, uncertainties about organ boundaries, as well as variations between patient setups during planning, treatment and dose delivery, uncertainty regarding biological response to the radiation dose and displacement of the beam shaping device during treatment, all introduce uncertainties in radiation therapy planning.

The gross tumor volume (GTV) delineation is determined from clinical examinations and from the extent of the tumor visible in images. The GTV is often expanded to encompass regions in which the microscopic cancer cells may be present, thus defining the clinical target volume (CTV). The CTV is expanded further with a margin to compensate for patient movement and treatment set-up uncertainties, thereby defining a planning target volume (PTV). Minimizing these uncertainties may aid in reducing the radiation received by healthy tissues [4]. The GTV, CTV and PTV are illustrated in Fig. 3
                     .

MRI provides superior soft tissue contrast compared to CT [5,6] and does not deliver ionizing radiation [7]. Further, MRI might determine physiologic radio-resistant areas which then can be counteracted with an escalated dose of radiation to high risk regions [8]. Delineation of the GTV and CTV from MRI may reduce the uncertainty involved with organ boundaries and allow a smaller margin to be used, lowering the radiation received by the surrounding healthy tissues [9–11]. In recent times, MRI guided radiation therapies have received considerable research interest [12]. In particular, the advantages of MRI in image-guided adaptive brachytherapy for cervix cancer have been well published and are becoming increasingly adopted [13]. In MRI guided radiation therapy planning the MRI and CT scans are aligned by matching the pelvic bones. The tumor, cervix, vagina, parametrium, uterus, bladder and rectum are generally contoured on the MRI. Dose calculation and radiotherapy planning is performed using electron density information from the CT images. The framework for MRI guided radiation therapy planning is given in Fig. 4
                     .

Typically during cervical cancer RT planning the GTV, cervix, vagina, parametria, uterus, bladder and rectum are contoured in MRI. A consensus of guidelines for delineation of the structures and CTV was presented by Lim et al. [15]. According to Lim et al. [15] the CTV is composed of the GTV, cervix, vagina, parametria and uterus. Please refer to [15] for a more comprehensive definition of the contoured structures and the CTV. These structures and their 3D reconstruction as observed in a saggital view are illustrated in Fig. 5
                     .

In recent years Dowling et al. [12] have developed a MRI alone treatment planning and adaptive radiation therapy workflow for prostate cancer. The improved soft tissue contrast with MRI enables more accurate and consistent segmentation of the prostate and hence estimation of the CTV. The approach could also reduce cost of the treatment and reduce the risk of ionizing radiation exposure for the patient by eliminating the CT imaging. A substitute CT image is generated from the MRI of the patient and the segmented contours from MRI [14] are transferred to the pseudo CT images for treatment planning. The dose differences between the pseudo CT and planning CT were quantified and found to be less than 2%. A similar approach could be adopted for cervical cancer treatment.

As observed in Fig. 4, manual segmentations of the GTV, cervix, uterus, parametrium, vagina, bladder and the rectum are necessary in CT or MRI or both for MRI or CT guided RT planning. However manual segmentations of these structures are time consuming and may suffer from inter observer variabilities [15]. In recent years, computer-aided segmentation methods of the cervix have been reported in the literature. The challenges involved in automatic cervix segmentation in CT and MRI are different. In clinical practice, both modalities are actively used in RT treatment planning. Some of the features of the two imaging modalities are summarized in Table 1
                     . In Fig. 6
                      we observe the cervix in CT and MRI and the improved soft tissue contrast in MRI.

Typically in computer vision and medical imaging the goal of image segmentation is to partition a digital image into multiple segments that are more meaningful and easier to analyze. Several approaches are used including graph-cuts [16], level sets [17], pattern recognition based approaches and registration based methods involving atlases [18].

Image registration in computer vision is the process of estimating optimal transformation parameters between two images to bring them into the same coordinate space. The transformation parameters are estimated in a process that involves maximization of an image similarity metric like normalized mutual information or normalized cross correlation between the two images in an energy optimization framework.

Computer-guided segmentation of the structures of interest in MRI and CT is a challenging task. Poor soft tissue contrast in CT images reduces the accuracy of methods working on edge and contrast information. Similarly magnetic bias, anisotropic MRI sequences, different bladder and rectal fillings, soft tissue deformation, patient and organ movement and tumor changes over the course of treatment can reduce the effectiveness of computer-aided segmentation and registration of the cervix. Some of these challenges are illustrated in Fig. 7
                     .

Further challenges in adaptive cervix RT planning involve internal motion of the organs at risk during treatment. Chan et al. [19] recorded large inter-scan movement of the CTV that could be only partially explained by bladder and rectal filling. The authors suggest the use of adaptive re-planning to compensate for internal organ movement between the scans. A generous population-based CTV to PTV margin is required to account for the geometrical uncertainties, resulting in the irradiation of healthy tissues. Estimating the tumor contour in CT images is difficult and results in a significant overestimation of the tumor width, thereby resulting in a significant increase in dose delivered to the CTV, as compared to MRI guided contouring [20,21]. Healthy tissue irradiation could be potentially minimized by using computer-aided segmentation and registration methods during treatment planning and online image guidance systems [22].

This paper presents a summary of segmentation and registration methods that may be applied to online treatment planning and RT planning for cervical cancer radiation therapy. Different approaches developed for segmentation and registration for adaptive treatment planning are detailed and their similarities, differences, strengths and weaknesses are explained to enable the reader to make a knowledgeable decision in the selection of one method over the other. The outline of the paper is as follows: The state-of-the-art computer-aided segmentation and registration procedures for adaptive treatment planning are presented in Section 2. Qualitative evaluations of the methods as reported in the literature are presented in Section 3. In Section 4 we present a comparative discussion.

As illustrated in Section 1 the two imaging modalities present different challenges for cervix segmentation and registration. The methods developed for MRI are described first followed by those for CT images.

Computer-aided segmentation of the cervix in MRI is a relatively new domain. From an exhaustive search of the literature using PubMed and Google Scholar the four papers of van der Put et al. [23], Staring et al. [24], Lu et al. [25] and Berendsen et al. [26] were selected. Most of these methods are validated with a large number of datasets and have shown promising results in a clinical setting. The keyword search of “cervix segmentation’ returned 46 papers in PubMed and 21,000 results in Google Scholar. The keyword “cervix registration” returned 200 papers in PubMed and over 20,000 hits in Google Scholar. Most papers were excluded, however, as they were not related to RT treatment planning in a clinical setting.

Non-rigid registration is often used for segmentation of the organs of interest in medical imaging [18,27,28]. In a registration framework the objective function is to maximize the similarity between two images. The sum of squared distance, normalized cross-correlation and normalized mutual information are frequently used as similarity metrics and used in a optimization framework to achieve the objective. A non-linear mapping from the moving image to the target image is often achieved with mathematical functions including B-spline and thin plate splines. An extensive study of medical image registration methods may be found in these articles [29,30].

B-spline based non-rigid registration is often used for registration and segmentation of the cervix [23,24,26]. To formalize a typical B-spline based image registration with normalized mutual information as a similarity metric, let 
                           Ω
                           =
                           
                              
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                    |
                                    0
                                    ≤
                                    x
                                    <
                                    X
                                    ,
                                    0
                                    ≤
                                    y
                                    <
                                    Y
                                    ,
                                    0
                                    ≤
                                    z
                                    <
                                    Z
                                 
                              
                           
                         represent the image domain. The transformation between the moving and fixed images is given by T
                        :(x, y, z)↦(x′, y′, z′), where any point (x, y, z) of the moving image is mapped onto its corresponding point (x′, y′, z′) on the fixed image. Given a mesh of control points on the moving image with a control point defined as ϕ
                        
                           i,j,k
                         with uniform spacing of δ mm, the nonrigid transformation T is defined by B-spline functions as,


                        
                           
                              (1)
                              
                                 T
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                                 =
                                 
                                    ∑
                                    
                                       l
                                       =
                                       0
                                    
                                    3
                                 
                                 
                                    ∑
                                    
                                       m
                                       =
                                       0
                                    
                                    3
                                 
                                 
                                    ∑
                                    
                                       n
                                       =
                                       0
                                    
                                    3
                                 
                                 
                                    B
                                    l
                                 
                                 (
                                 u
                                 )
                                 
                                    B
                                    m
                                 
                                 (
                                 v
                                 )
                                 
                                    B
                                    n
                                 
                                 (
                                 w
                                 )
                                 
                                    ϕ
                                    
                                       i
                                       +
                                       l
                                       ,
                                       j
                                       +
                                       m
                                       ,
                                       k
                                       +
                                       n
                                    
                                 
                              
                           
                        where 
                           i
                           =
                           
                              
                                 
                                    x
                                    /
                                    δ
                                 
                              
                           
                           −
                           1
                           ,
                           j
                           =
                           
                              
                                 
                                    y
                                    /
                                    δ
                                 
                              
                           
                           −
                           1
                           ,
                           k
                           =
                           
                              
                                 
                                    z
                                    /
                                    δ
                                 
                              
                           
                           −
                           1
                           ,
                           u
                           =
                           x
                           /
                           δ
                           −
                           
                              
                                 
                                    x
                                    /
                                    δ
                                 
                              
                           
                           ,
                           v
                           =
                           y
                           /
                           δ
                           −
                           
                              
                                 
                                    y
                                    /
                                    δ
                                 
                              
                           
                         and 
                           w
                           =
                           z
                           /
                           δ
                           −
                           
                              
                                 
                                    z
                                    /
                                    δ
                                 
                              
                           
                         is the floor function and B
                        
                           l
                         represents the lth basis function of the cubic B-spline functions such that B
                        0(u)=(1−
                        u
                        3)/6, B
                        1(u)=(3u
                        3
                        −6u
                        2
                        +4)/6, B
                        2(u)=(−3u
                        3
                        +3u
                        2
                        +3u
                        +1)/6 and B
                        3(u)=
                        u
                        3/6.

The resulting coordinate transformation T
                        
                           i
                         is applied to the training dataset label L
                        
                           i
                         to produce the resulting label. Normalized mutual information (NMI) [30] as a similarity metric is maximized to achieve the registration. The NMI is an information theoretic measure that tries to reduce the joint entropy of the images and is given by,


                        
                           
                              (2)
                              
                                 NMI
                                 =
                                 
                                    ζ
                                    similarity
                                 
                                 =
                                 
                                    
                                       H
                                       (
                                       M
                                       )
                                       +
                                       H
                                       (
                                       F
                                       )
                                    
                                    
                                       H
                                       (
                                       M
                                       ,
                                       F
                                       )
                                    
                                 
                              
                           
                        where ζ
                        
                           similarity
                         is the similarity measure for B-splines registration that is maximized in the process, H(M) and H(F) are the marginal entropies of the moving (M) and fixed (F) images respectively, and H(M, F) is the joint entropy of the images. H(M, F) can be written using probability theory as,


                        
                           
                              (3)
                              
                                 H
                                 (
                                 M
                                 ,
                                 F
                                 )
                                 =
                                 
                                    ∑
                                    
                                       m
                                       ,
                                       f
                                    
                                 
                                 p
                                 (
                                 m
                                 ,
                                 f
                                 )
                                 log
                                 (
                                 [
                                 p
                                 (
                                 m
                                 ,
                                 f
                                 )
                                 ]
                                 )
                              
                           
                        where, p(m, f) is the joint probability distribution of the images obtained from their joint histogram. The registration framework involving B-spline transformation and mutual information as a similarity metric is illustrated in Fig. 8
                        .

van der Put et al. [23] investigated the accuracies of rigid, non-rigid and a semi-automatic registration of T2 weighted MR images for inter-fractional contour propagation for external beam adaptive RT for cervical cancer. The scans were acquired using a 1.5 T Philips Interra using a phased-array body coil with 4.5mm slice thickness and 0.5mm in plane resolution. Mutual information [31] was used as a similarity metric for registration between the bones. A B-spline based registration transformation was used for the non-rigid methods. A semi-automatic point set registration was performed between manually selected landmarks. The authors concluded that non-rigid registration performed better than rigid registration and the combination of the semi-automatic and non-rigid registration demonstrated improved performance compared to a completely automatic method. The registration time requirement for the procedure was within acceptable limits.

Similar to the framework used by van der Put et al., Staring et al. [24] used mutual information as a similarity metric and a B-spline transformation to register the planning day MRI to the inter-fractional images for adaptive radiotherapy to segment the CTV, bladder and rectum. The T2 weighted MR data were acquired with a Philips 1.5 T Intera scanner with voxel dimension of 0.625mm×0.625mm×4.5mm. Unlike Van der Put et al., Starring et al. proposed to use rotation and translation invariant reliable image features during registration to reduce the effect of imaging artifacts, magnetic bias, and noise in the image. Multi-resolution Gaussian derivatives of the intensities along with spatial derivatives were used to extract reliable edge and texture information of the CTV, bladder and rectum. Mutual information was computed using image features to reduce the effect of noise and improve registration accuracy. The registration time for the procedure was around 31min.

In recent years hybrid methods that combine registration based methods with prior shape information of the CTV, bladder and rectum have been adopted for cervix segmentation [25,26]. Prior shape information obtained from segmented organs are often used to build a shape model for medical image segmentation and analysis for a wide variety of structures [14,32–36]. An extensive review of shape models applied to medical image segmentation and registration may be found in this article [37]. Primarily two different shape models are used in cervix segmentation/registration framework: the active shape model or statistical shape model framework of Cootes et al. [38] and the kernel density estimation of Cremers et al. [39].

The Cootes et al. shape model is characterized by a mean shape and variation of the mean shape in a Gaussian space [38]. The mean shape and Gaussian space are estimated from the segmented contours of the organ of interest. The shape model is built from surface meshes from the training images. The point distribution model [38] is built from the aligned 3D points of the surface meshes. Principal component analysis (PCA) of the aligned point distribution model (PDMs) identifies the principal modes of shape variation. The statistical shape model is given by,


                        
                           
                              (4)
                              
                                 s
                                 =
                                 
                                    
                                       s
                                       ¯
                                    
                                 
                                 +
                                 
                                    Φ
                                    s
                                 
                                 
                                    θ
                                    s
                                 
                              
                           
                        where 
                           
                              s
                              ¯
                           
                         denotes the mean shape, Φ
                           s
                         contains the first p eigenvectors (obtained from 98% of total variations) of the estimated joint dispersion matrix of shape, and θ
                        
                           s
                         represent the corresponding shape eigenvalues. A penalty function depending on the value of the Mahalanobis distance between the mean mesh with principal modes of variations and the reference mesh is introduced to prevent deformations very different from the mean shape. The approach is illustrated with a shape model for the bladder in Fig. 9
                        .

In the kernel density estimation approach, training data generated from manual segmentations are rigidly aligned to minimize pose differences. Each object (e.g., the bladder or the uterus) is embedded as the zero level set given by Ψ1, Ψ2, …, Ψ
                           n
                         to achieve a non-parametric density estimation of the shape space. To formalize, the kernel density estimation of the shape space is given by,


                        
                           
                              (5)
                              
                                 p
                                 (
                                 
                                    Ψ
                                    
                                       
                                          S
                                          d
                                       
                                    
                                 
                                 )
                                 =
                                 
                                    1
                                    n
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 k
                                 (
                                 D
                                 (
                                 
                                    Ψ
                                    
                                       
                                          S
                                          d
                                       
                                    
                                 
                                 ,
                                 
                                    Ψ
                                    i
                                 
                                 )
                                 ,
                                 σ
                                 )
                              
                           
                        where D(.) is the distance metric in implicit shape space and k(., σ) denotes a Gaussian kernel with kernel size σ, i.e.,


                        
                           
                              (6)
                              
                                 k
                                 (
                                 x
                                 ,
                                 σ
                                 )
                                 =
                                 
                                    1
                                    
                                       
                                          
                                             2
                                             π
                                             
                                                σ
                                                2
                                             
                                          
                                       
                                    
                                 
                                 exp
                                 
                                    
                                       −
                                       
                                          x
                                          2
                                       
                                    
                                    
                                       2
                                       
                                          σ
                                          2
                                       
                                    
                                 
                                 ,
                              
                           
                        
                     

The distance between the evolving level set and the kernel density estimation of the shape space is minimized to impose shape restriction. Lu et al. [25] proposed automatic segmentation, tumor detection and non-rigid registration in T2 weighted images to aid IGRT. The T2 weighted fast spin echo (echo time/repetition time 100/500ms) MR data were acquired with a GE Excite 1.5 T scanner with image resolution of 0.625mm×0.625mm×4.5mm. Manually segmented contours of the organs were rigidly registered to a common frame to minimize pose variations. The mean shape and its variations were estimated from registered contours using the model of Cremers et al. [39]. A B-spline based non-rigid registration was employed for the transfer of the planning day contours on the treatment day images. The registration was constrained by the estimated shape model. Large deviations of the organs of interest from their mean shape were restricted to lie within the estimated variations to impose shape constraints. The intensity distribution inside the CTV was modeled as a multiple Gaussian distribution. One Gaussian distribution represented the tumor and the other represented the healthy tissues. The probability of tumor obtained in this framework was used to estimate the GTV and constrain the B-spline based registration. The entire process took around 30min with 8 core 2.83GHz Intel Xeon CPU, 16Gb of RAM in Matlab.

A shape constraint was used inside a registration framework by Berendsen et al. [26]. A shape constrained B-spline based non-rigid registration was used to segment the bladder and the CTV to aid adaptive re-planning. The T2 weighted MR data were acquired with a Philips 1.5 T Intera scanner with voxel dimension of 0.625mm×0.625mm×4.5mm. Unlike [23] and [24], Berendsen et al. performed an inter-patient registration to segment the CTV and the bladder on the treatment day. Inter-patient non-rigid CT to CT registration was followed by intra-patient CT to MR rigid registration, to achieve an inter-patient MRI registration. The mean shape and variation of the shape estimated from the segmented contours was introduced as a penalty to impose shape constraint during registration. The entire registration with the shape model took 3min in a 2.83GHz desktop.

Traditionally CT is used in a clinical setting to contour the CTV and the PTV for RT planning. The work flow of CT based planning is illustrated in Fig. 2. The manually segmented CTV, bladder, rectum and bones are generally transformed to the treatment images with non-rigid registrations to account for organ deformations in adaptive radiotherapy.

Symmetry and inverse consistency in the estimated image alignment is extremely important in medical applications. In general, registration techniques that do not rely on explicit correspondences benefit from the inverse consistency constraint. This is because these techniques often employ maximization/minimization of a similarity measure on image features like intensity, object boundary or shape which has large local maxima/minima due to correspondence ambiguity. Therefore a diffeomorphic (topology preserving) registration without an inverse consistency constraint may not provide a one-to-one, onto transformation, i.e. the inverse of the forward transformation may not provide an exact backward transformation. In mathematics, a diffeomorphism is an isomorphism of smooth manifolds. It is an invertible function that maps one differentiable manifold to another, such that both the function and its inverse are smooth. Christensen and Johnson [40] proposed that a symmetric and inverse-consistent transformation would ensure a diffeomorphic, one-to-one and onto transformation that is continuous and differentiable. To overcome the correspondence ambiguities, [40] proposed a joint estimation of the forward (h(.)) and backward (g(.)) transformations between the moving (M) and fixed (F) images by minimizing or maximizing a cost function of similarity measures. However, the joint estimation of h(.) and g(.) does not guarantee that they the are inverse of each other, since the contributions of the transformations in the cost function are independent. Therefore in order to couple the estimation of h(.) and g(.) an inverse consistency constraint is imposed that minimizes the error between h(.) and g
                        −1(.), g(.) and h
                        −1(.) respectively. The need to use the inverse consistency constraint however, depends on the application and on the correspondence model used for registration. When large variation of deformable organs occurs in clinical data, symmetric and inverse-consistent registration methods provide more accurate transformations.

Bondar et al. [41] proposed to use a landmark guided thin spline based symmetric non-rigid registration to register organs of interest such as the bladder. Two variants of the registration algorithm were developed; symmetric and asymmetric. In the asymmetric version registration was considered in one direction, i.e. from planning CT contours to the treatment day contours, while the symmetric version included the inverse consistency constraint, i.e. from the planning CT to the treatment day and from the treatment day to the planning CT contours. As expected, the inverse-consistent method performed better in the presence of large deformations of the bladder and the organs of interest. The surface registration time for the bladder was 151s and for cervix and uterus was 35s.

Later Bondar et al. [22] proposed to predict the shape and the position of the cervix and uterus as a function of the bladder volume to aid in adaptive re-planning. CT images were acquired with five different bladder volumes. First with an empty bladder, then after drinking 500 and 300ml of water consecutively; and finally after the interval of 20, 40 and 60min with natural filling. The surfaces of the organs of interest were reconstructed from 3D manual segmentations. A linear regression was formulated that predicted the coordinate positions of the cervix and the uterus from the bladder volumes after registration of the treatment image to the planning day CT. The regression based approach facilitated the selection of the most probable deformation of the cervix and the uterus depending on the bladder volume. A symmetric registration [41] between the predicted volume and the treatment day CT was finally performed for adaptive re-planning.

In recent years a plan-of-the-day strategy has been adopted for fast online adaptive radiation therapy [42–44]. Bondar et al. [42] used non rigid registration of [41] and prediction of the position of the cervix and uterus from [22] to design an online adaptive individualized treatment plan. The individualized plans were generated by using a motion model [22] from two pre-treatment CT scans with a full and empty bladder. The plan-of-the-day was selected automatically from the library based on bladder volume. Compared to the population-based margins the individualized plan reduced the CTV-to-PTV volume by 48%±6% sparing the organs at risk. Langerak et al. [43] proposed to use two plans, one with full bladder and the other with empty bladder, for automatic plan selection on treatment day. Multi-atlas based segmentation in cone beam CT (CBCT) images was performed to segment the bladder, rectum and the uterus. The plan with a full bladder was selected if the volume of the bladder was larger than the average of the full and the empty bladder, while the empty bladder plan was selected otherwise. Heijkoop et al. [44] proposed to use CBCT scans for selection of the most appropriate plan from a library containing either one or two IMRT plans and a motion robust 3DCRT backup plan. Two pre-treatment scans with an empty and a full bladder were acquired, aligned with respect to the bones and the bladder. The cervix-uterus CTVs were manually delineated. Non-rigid registration [41] was used to register the bladder and [22] was used to predict the internal target volume. For patients with large cervix-uterus motion, two extra models that predicted internal target volume (MPITV) were used for plan generation. Cervix-uterus shape models for empty-to-half-full bladder and half-full-to-full bladder were used for MPITV. A plan was selected online depending on the position of the markers implanted in the vagina fornix and depending on the position of the uterus inside the PTV.

The effectiveness of automated re-planning to compensate for interfraction organ motion was studied by [45,47–49]. Stewart et al. [45] study explored the limits of a highly adaptive small margin treatment scenario to accommodate internal organ motion. The dosimetric consequences of organ and tumor motion were modeled using a combination of finite element modeling based deformable registration [46] and fractional dose accumulation techniques. The dosimetric impact of interfraction organ and target motion was compared for two hypothetical treatment scenarios: a 3-mm margin plan without re-planning; and an automatic re-plan performed on the updated weekly patient geometry. It was concluded that a weekly re-planning strategy can facilitate PTV margin reduction by improving target coverage and sparing organs at risk.

Two adaptive re-planning strategies were proposed by Lim et al. [47]. Deformable image registration [46] was used to model the accumulated dose for two adaptive re-planning scenarios. In anatomical adaptive intensity modulated radiation therapy (A-IMRT), a single re-plan was created halfway through the treatment for every patient in an effort to correct minor target underdosing and reduce normal tissue dose. In dosimetric adaptive intensity modulated radiation therapy (D-IMRT) re-plans were created only for patients when the final target dose was predicted to be low. Both methods improved accumulated target dosimetry compared to no re-planning. For 30 patients, the clinically relevant target dose threshold failed for 8 patients with 3mm margin without re-planning. AIMRT failed in 3 patients and reduced doses delivered to organs at risks compared to DIMRT.

Oh et al. [48] proposed to use off-line re-planning to improve the quality of radiation delivery affected by substantial organ motion and tumor shrinkage during the course of RT. In an off-line re-planning system, the errors on a certain day are corrected in later treatment fractions. Two methods of image guidance, bone to bone and soft tissue to dose matrix were compared with three frequencies of offline re-planning: none, single and weekly. In a bone to bone matching, pre-treatment and all weekly MRI's were registered to the planning CT images at the pelvic bone, based on correlation maximization. In soft tissue to dose distribution registration, the CTV and the dose voxels were binarized and registered based on correlation maximization. It was found that offline re-planning significantly improved target coverage and reduced dosage to organs at risk, especially in difficult cases. Kerkhof et al. [49] suggested an online planning adaptation by applying a primary and nodal planning target volume margin of 4mm. Online intensity modulated radiation therapy (IMRT) compared to pre-IMRT reduced the volume of healthy tissue irradiated.

Christensen et al. [50] use a deformable registration to register CT serial examinations into a single frame of reference in order to compute cumulative dose calculations during treatment with CT compatible intracavitary applicators. Each serial examination was rigidly registered with respect to the bone followed by a deformable registration that followed a Navier–Stokes viscous fluid flow equation. Compared to the bony landmark-based alignment a better overlap was observed.

Recently Bondar et al. [51] benchmarked several strategies for accurate registration and suggested the use of shape based registration and the use of bladder to cervix and uterus shape regression to improve accuracy in the absence of a fiducial in the fornices of the vagina. The average shape model of the cervix and uterus was created by registration of the pre-treatment delineated scans with the symmetric registration method proposed in [41]. The shape model was deformed towards an attractor point identified from organ specific image features [52]. In the presence of a fiducial in the fornices of the vagina, improved registration accuracy was observed by translation of an average cervix-uterus shape constrained on the fiducials. However identification of the fiducials on the planning and the treatment day is necessary for the registration.


                     Table 2
                      presents the most commonly used evaluation metrics for determining the accuracies of cervix segmentation and registration. Performance is evaluated by comparing the output of the segmentation/registration method with the gold standard generated from manual segmentation by an experienced radiation therapist or radiation oncologist. For quantitative comparison the contours or surfaces from the method are overlaid along with the manual segmentations or registrations. In quantitative evaluation a numerical value of either the overlap or the contour distance is presented. The major contour and volume based quantitative error metrics are presented in Table 2.

A quantitative evaluation of the different methods developed is difficult in the absence of public datasets, software and standardized evaluation metrics. Furthermore a degree of parameter tuning is necessary for all methods developed, which varies depending on the dataset. Nevertheless, to have an overall qualitative estimate of the performance of the methods in the literature we present the reported results in Table 3
                     . The index of the table is expanded below.
                        
                           •
                           The name of the first author has been used as a reference of the paper.

The segmentation and registration method shows the computational method(s) used in the algorithm.

The automation (auto) column specifies the degree of manual interaction (if any) that was necessary.

The performance columns gives the measures and the values.

The validation column gives the number of datasets that were used to validate each algorithm.

Registration performed between the scans of the same patient is given by intra in the inter/intra column. The primary goal of intra patient registration is the transfer of contours and plans from planning day to treatment day for adaptive re-planning. Registration performed with the purpose of automatic segmentation of organs of interest in the planning CT/MRI of a new patient is given by inter in the Inter/ Intra column.

The CTV column describes how the CTV was defined for each paper. (–) indicates no CTV definition was available.

@&#DISCUSSION@&#

The cervix segmentation and registration methods have been primarily developed to expedite radiation therapy planning. The principal aim of these methods is to segment the GTV, CTV and PTV in treatment images, or to transfer the planning day contour to a treatment day image for adaptive radiotherapy. The methods discussed in this paper are dependent on non-rigid registration for the transfer of the planning day plan to the treatment day images for adaptive re-planning [23–26]. The methods that perform an intensity based non-rigid registration [24–26,43] could be used to segment structures of interest in a new MRI. In the near future, a pipeline of MR alone treatment planning [12] may be adopted for radiotherapy planning for the cervix. This would eliminate the need for CT image acquisition during radiotherapy planning.

For adaptive re-planning two different kinds of non-rigid registrations are being used. While some methods [24,26,25,43] used intensity based non-rigid registration, others [41] used a structure based non-rigid approach for registering organs of interest. One advantage of Bondar et al. [41] is that the optimization function minimizes the distance between two structures and theoretically this method would be more accurate compared to an intensity based registration. However the minimization of surface based distance requires the structures to be segmented, a priori.

Different variants of adaptive re-planning have been suggested in recent years [42–45,47,48]. These strategies could be broadly categorized into two groups: a regression based approaches [42–44]; and margin based approaches [45,47,48]. Computational speed during treatment is a major advantage of the regression based approaches. However several plans for the same patients have to be created offline to create a plan dictionary for selection. Offline re-planning is necessary for margin based approaches [45,47,48]. It has been demonstrated however, margin based or regression based re-planning improves sparing of organs at risk.

The registration methods used significantly differ from each other from a theoretical perspective. Intensity based registration methods like B-spline [18] and landmark-based registration using thin plate splines are also used with segmented images [41]. While in intensity based registration mutual information between the two images is used as a similarity metric, in landmark-based registration the least squares distance between two meshes is minimized.

Different strategies have been adopted to improve accuracy in intensity based B-spline registration methods. Staring et al. [24] adopted a robust feature based non-rigid registration with mutual information as the similarity metric in MRI. The robust features comprised translational and rotational invariant spatial derivatives in MRI. These robust features improve the median DSC of the bladder from 0.75 to 0.81 and for the rectum from 0.76 to 0.77. For the bladder, the registration error was reduced from 2–3mm to 1–2mm. In contrast Lu et al. [25] and Berendsen et al. [26] adopted a shape constrained non-rigid registration to improve accuracy in MRI. Berendsen et al. [26] improved DSC for the CTV from 0.43 to 0.57 and DSC for the bladder improved from 0.62 to 0.73 with a shape prior constraint in registration. Lu et al. [25] found that a shape and intensity prior levelset model significantly improved the bladder DSC from 0.62 for to 0.88 and the uterus DSC from 0.53 to 0.83, when compared to the intensity only prior levelset model of Chan and Vese [54].

It has been observed that shape feature based non-rigid registration improves results compared to intensity based non-rigid registration [24]. The use of rotation and translation invariant robust edge based features in the computation of mutual information significantly improves registration accuracy compared to raw intensities. This is because raw intensities are often corrupted by magnetic bias, and imaging artifacts. Therefore these edge features are effective in the extraction of underlying image textures and reliable edge information [33].

The use of a shape model in the later part of the treatment reduced segmentation errors due to ambiguous organ boundaries, as shown by both Lu et al. [25] and Berendsen et al. [26] who used shape constraints in their registration frameworks. The shape constraints used however significantly differed from one another. While Berendsen et al. used a classical statistical shape model as proposed by Cootes et al. [38], Lu et al. used a more recent kernel density estimation of shape representation as proposed by Cremers et al. [39].

In the later stages of the treatment delivery the GTV and the CTVs are often severely deformed and more sophisticated approaches are needed to improve accuracy. Tissue classification as proposed by Staring et al. [24] was adopted by Lu et al. [25]. In this work, a Bayesian estimate of the voxel labels significantly reduced the risk of mis-classification of healthy tissue. When introduced in the registration framework, the prior probability of the GTV improved segmentation accuracies in MRI. Lu et al. [25] improved GTV segmentation accuracy from a DSC of 0.16 to 0.80 in the final week of treatment.

Bondar et al. [41] used a symmetric registration between the cervix, uterus and bladder surfaces obtained from manual segmentation to compensate for large complex deformations of the structures in CT images. Use of symmetric inverse-consistent registration produced a smooth deformation field and improved registration accuracy compared to a non-symmetric version of the algorithm. Residual errors for the landmarks were reduced from 20.7 to 3.5mm for the bladder with symmetric registration compared to non-symmetric version.

The primary advantages and disadvantages of the methods are given in Table 4
                        .

A comparison of the performance of each method is presented in Table 3. For a fair comparison all methods need to be validated on the same dataset with exactly the same definition for the CTV. The CTV definition however varied from one paper to the other. The CTV was not defined by Staring et al. [24]; for Lu et al. [25] only the GTV and uterus were contoured, Berendsen et al.'s [26] CTV comprised the GTV, cervix, uterus, parametria and vagina; for van der Put et al. [23] the CTV was composed of the GTV, uterus, parametria and vagina. For Bondar et al. [51] the cervix and the uterus were used to define the CTV. In such a varied definition of the CTV, the performance evaluation of segmentation and registration methods becomes difficult from a clinical perspective.

The choice of a particular segmentation method depends upon the imaging modality, the clinical objective and computational time required by the process. The use of shape constraints in the segmentation framework improves segmentation accuracy in MRI as demonstrated by [25]. Further, the use of the prior probability of the GTV and tissue clustering may improve the segmentation accuracy of the GTV. The linear relationship between the bladder and the CTV was demonstrated by [22]. The use of predictive modeling in a plan-of-the-day strategy aided online adaptive radiation therapy [42].

Considering the deformable nature of the organs of interest and the potential radical change of shape over the course of treatment it would be difficult to achieve accurate segmentation without incorporating shape information into the model. Furthermore, the use of appearance information along with edge information detected at multiple scales would provide stability for such models. Shape and appearance spaces are often considered to be Gaussian and large scale deviations from the mean shape and appearance model would produce inaccurate segmentations. Hence it would be useful to consider mixture of Gaussian models for both shape and appearance spaces to improve on accuracy. A tissue classification strategy would be extremely important, especially in the advanced stage of the treatment to identify the GTV.

@&#CONCLUSIONS@&#

In clinical practice, both CT and MRI guided radiation therapy planning are performed. Tissue electron density obtained directly from a planning CT is used for dose calculation in radiation therapy. MRI with better soft tissue contrast could significantly improve cervical cancer treatment by ensuring improved organ contours. However, the success of the procedure is dependent on the automated organ segmentation and/or registration algorithm. Further, registration between planning day and treatment day images may be necessary for online adaptation of treatment planning for cervical cancer treatment. This paper has presented the currrent state-of-the-art in segmentation and registration methods developed for adaptive cervical cancer treatment planning and/or radiation therapy planning. We have highlighted the similarities, differences, strengths, and weaknesses of these methods to enable the reader to make a knowledgeable decision in selecting one method over the other.

No author in this paper has any potential conflict of interest.

@&#REFERENCES@&#

