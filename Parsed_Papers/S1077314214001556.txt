@&#MAIN-TITLE@&#Scale filtered Euclidean medial axis and its hierarchy

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a new methodology for Euclidean medial axis filtering.


                        
                        
                           
                           We propose a new methodology for generation of full hierarchy of scale medial axes.


                        
                        
                           
                           We propose a new methodology which allows for a fair comparison of medial axis filtering algorithms.


                        
                        
                           
                           Series of experiments show that our algorithm gives better or similar results, compared to the best related methods.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Filtered medial axis

Discrete scale axis

Shape representation

Image analysis

Stability

Hierarchy

@&#ABSTRACT@&#


               
               
                  We propose an Euclidean medial axis filtering method which generates subsets of the Euclidean medial axis in discrete grids, where filtering rate is controlled by one parameter. The method is inspired by Miklos’, Giesen’s and Pauly’s scale axis method which preserves important features of an input object from shape understanding point of view even if they are at different scales. There is an important difference between the axis produced by our method and the scale axis. Contrarily to ours, the scale axis is not, in general, a subset of the Euclidean medial axis. It is even not necessarily a subset of the original shape. In addition, we propose a new method for the generation of a hierarchy of scale filtered Euclidean medial axes. We prove the correctness of the method. The methods and their properties are presented in 2D space but they can be easily extended to any dimension. Moreover, we propose a new methodology for the experimental comparison of medial axis filtering algorithms, based on five different quality criteria. This methodology allows one to compare algorithms independently on the meaning of their filtering parameter, which ensures a fair confrontation. The results of this confrontation with related previously introduced methods are included and discussed.
               
            

@&#INTRODUCTION@&#

The notion of medial axis has been introduced by Blum in the 60s [1]. The medial axis of an object X is composed by the centres of the balls which are included in X but which are not fully included in any other ball included in X (such balls are called maximal balls or medial balls). The medial axis is, by nature, centred in the object with respect to the distance which is used to define the notion of ball.

In the literature, different methods have been proposed for computing the medial axis approximately or exactly, for instance methods relying on discrete geometry [2–5], digital topology [6,7], mathematical morphology [8], computational geometry [9,10], partial differential equations [11], or level-sets [12]. In this work we focus on the discrete medial axis in 
                        
                           
                              
                                 Z
                              
                              
                                 n
                              
                           
                        
                      based on the Euclidean metric.

The medial axis is a very useful representation of the object and plays a major role in shape analysis in numerous applications, for example object recognition, registration or compression. From the medial points and associated ball radii, one can exactly reconstruct the original shape. However it can be hard or even impossible to use this tool effectively without first dealing with some problems, especially in discrete spaces and with noisy objects.

Firstly, the medial axis in discrete spaces has not, in general, the same topology as the original object. Solutions to this problem have been proposed by several authors, for instance [6,7,13]. They use discrete homotopic transformations guided and constrained by the medial axis, to obtain an homotopic skeleton which contains the medial axis (see Fig. 1
                     ). We do not consider these topological problems in the rest of the paper.

The second problem is the sensitivity of the Euclidean medial axis to small contour perturbations (see, for example, Fig. 1). In other words, the medial axis is not stable under small perturbations of a shape: modifying a shape slightly (for example in terms of Hausdorff distance) can result in substantially different medial axes. This is a major difficulty when the medial axis is used in practical applications (e.g., shape recognition). A recent survey which summarises selected relevant studies dealing with this topic is presented in [14]. This fact, among others, explains why it is usually necessary to add a filtering step (or pruning step) to any method that aims at computing the medial axis and when a nonreversible but simplified description of binary objects is of interest.

The simplest strategy to filter the medial axis is to keep only points which are centres of maximal balls of at least a given diameter. Different criteria can be used to locally threshold and discard spurious medial points or branches: see [15,16], for methods based on the angle formed by the vectors to the closest points on the shape boundary, or the radius of the smallest ball enclosing these closest points [17,3].

In these methods, local information (that is, geometric information extracted from a single medial ball) is compared to a global parameter value to determine the importance of the corresponding medial axis point. However, it is well known that this local filtering can lead to remove small branches which might be important for the shape understanding (see Fig. 2
                     ) especially for shapes with features at different scales [14].

A more complex criterion was proposed by [18]: the authors utilise information about ball covering by the other balls of the medial axis. This information is obtained, for each ball 
                        
                           B
                           (
                           x
                           ,
                           r
                           )
                        
                      of the medial axis, by counting the number of object points inside the cell of x in the power diagram of all medial points. The medial point x is removed if this area is too small.

All these methods are based on a single parameter, furthermore they have the property that any filtered medial axis of a shape X for a parameter value 
                        
                           λ
                        
                      is a subset of any filtered medial axis of X for parameter value 
                        
                           μ
                        
                     , whenever 
                        
                           λ
                           ⩾
                           μ
                        
                     . In other words, the set of all filtered medial axes of a shape forms a hierarchy.

Some medial axis filtering methods (e.g., [17,3]) may not be able to preserve significant details at different scales, as their parameter links to a dimension (e.g., a ball radius) that is set globally, for the whole image. The parameter value must then be adapted to the only scale of details that should be preserved.

In [19], the authors address this scale dependency issue and propose an approach that puts in relation local information and regional information, that is, the status of a ball is only influenced by the one of neighbouring balls. Their method is based on the theory of the scale axis transform [20], which defines a whole family of medial representations at different levels of abstraction, called scale axis representations (see Fig. 3
                     ). For objects or scenes that include parts showing different scales, this method gives good results in many cases. Furthermore, the scale axis enjoys nice mathematical properties related to stability and convergence, with respect to some dense sampling of a manifold.

On the other hand, the scale axis is not necessarily a subset of the Euclidean medial axis (see Fig. 4
                     ), it is even not necessarily a subset of the original shape (see Fig. 6). Thus, the scale axis cannot be used in applications of skeletons where these properties are mandatory.

In this paper we propose a new method for the Euclidean medial axis filtering (see Section 4). Our proposition is inspired by the scale axis method (see Section 3). However, we obtain a filtered Euclidean medial axis, included in the exact one, instead of a set of points that is not necessarily a subset of the latter. Our method produces axes that preserve important features for shape understanding, even if they are at different scales. We propose a new algorithm for the generation of a full hierarchy of medial axes with a proof of its correctness and an analysis of its properties (see Section 5). The new algorithms work in arbitrary dimension. We evaluate experimentally their properties, and compare them with the previously introduced methods [18,16]. In addition, we propose a new methodology for the comparison of medial axis filtering algorithms, which permits to fairly compare algorithms that are based on different strategies, and takes into account five different quality criteria (see Section 6).

This article extends the paper [21], which was limited to the algorithm that computes a single filtered medial axis. Additionally, we introduce here a method for the construction of full medial axes hierarchies, we prove its correctness, we propose a new methodology for the comparison of medial axis filtering algorithms, we report more experiments and discuss some properties of our new methods.

In this section, we recall some basic geometric and topological notions for binary images [22,23].

We denote by 
                        
                           Z
                        
                      the set of integers, by 
                        
                           N
                        
                      the set of nonnegative integers, and by 
                        
                           
                              
                                 N
                              
                              
                                 +
                              
                           
                        
                      the set of positive integers. A point x in 
                        
                           
                              
                                 Z
                              
                              
                                 d
                              
                           
                        
                      is defined by 
                        
                           (
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 d
                              
                           
                           )
                        
                      with 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        
                      in 
                        
                           Z
                        
                     . Let 
                        
                           x
                           ,
                           y
                           ∈
                           
                              
                                 Z
                              
                              
                                 d
                              
                           
                        
                     , we denote by 
                        
                           d
                           (
                           x
                           ,
                           y
                           )
                        
                      the Euclidean distance between x and y, that is, 
                        
                           d
                           (
                           x
                           ,
                           y
                           )
                           =
                           
                              
                                 (
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       -
                                       
                                          
                                             y
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             d
                                          
                                       
                                       -
                                       
                                          
                                             y
                                          
                                          
                                             d
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              
                                 1
                                 /
                                 2
                              
                           
                        
                     .

We denote by 
                        
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                        
                      the set of positive real numbers. Let 
                        
                           Y
                           ⊂
                           
                              
                                 Z
                              
                              
                                 d
                              
                           
                        
                     , we denote by 
                        
                           d
                           (
                           x
                           ,
                           Y
                           )
                        
                      the Euclidean distance between x and the set Y, that is, 
                        
                           d
                           (
                           x
                           ,
                           Y
                           )
                           =
                           
                              
                                 min
                              
                              
                                 y
                                 ∈
                                 Y
                              
                           
                           {
                           d
                           (
                           x
                           ,
                           y
                           )
                           }
                        
                     . Let 
                        
                           X
                           ⊂
                           
                              
                                 Z
                              
                              
                                 d
                              
                           
                        
                      (the “object”), we denote by 
                        
                           
                              
                                 D
                              
                              
                                 X
                              
                           
                        
                      the map from 
                        
                           
                              
                                 Z
                              
                              
                                 d
                              
                           
                        
                      to 
                        
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                           ∪
                           {
                           0
                           }
                        
                      which associates, to each point x of 
                        
                           
                              
                                 Z
                              
                              
                                 d
                              
                           
                        
                     , the value 
                        
                           
                              
                                 D
                              
                              
                                 X
                              
                           
                           (
                           x
                           )
                           =
                           d
                           (
                           x
                           ,
                           
                              
                                 Z
                              
                              
                                 d
                              
                           
                           ⧹
                           X
                           )
                        
                     . The map 
                        
                           
                              
                                 D
                              
                              
                                 X
                              
                           
                        
                      is called the (Euclidean) distance map of X. For 
                        
                           x
                           ∈
                           
                              
                                 Z
                              
                              
                                 d
                              
                           
                        
                      and 
                        
                           r
                           ∈
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                        
                     , we denote by 
                        
                           B
                           (
                           x
                           ,
                           r
                           )
                        
                      the ball of radius r centred on x, defined by 
                        
                           B
                           (
                           x
                           ,
                           r
                           )
                           =
                           {
                           y
                           ∈
                           
                              
                                 Z
                              
                              
                                 d
                              
                           
                           ,
                           d
                           (
                           x
                           ,
                           y
                           )
                           <
                           r
                           }
                        
                     . Notice that, for any point x in X, the value 
                        
                           
                              
                                 D
                              
                              
                                 X
                              
                           
                           (
                           x
                           )
                        
                      is precisely the radius of a ball centred on x and included in X, which is not included in any other ball centred on x and included in X.

Now, let us recall the notion of medial axis (see also [24,7]). Let 
                        
                           X
                           ⊆
                           
                              
                                 Z
                              
                              
                                 d
                              
                           
                        
                     . A ball 
                        
                           B
                           (
                           x
                           ,
                           r
                           )
                           ⊆
                           X
                        
                     , with 
                        
                           x
                           ∈
                           X
                        
                      and 
                        
                           r
                           ∈
                           
                              
                                 N
                              
                              
                                 +
                              
                           
                        
                     , is maximal for X if it is not strictly included in any other ball included in X. The medial axis of X, denoted by 
                        
                           MA
                           (
                           X
                           )
                        
                     , is the set of the all couples 
                        
                           (
                           x
                           ,
                           r
                           )
                        
                      such that 
                        
                           B
                           (
                           x
                           ,
                           r
                           )
                        
                      is a maximal ball for X.

Let 
                        
                           X
                           ⊂
                           
                              
                                 Z
                              
                              
                                 d
                              
                           
                           ,
                           
                           Y
                           ⊂
                           X
                        
                     , we denote by 
                        
                           
                              
                                 REDT
                              
                              
                                 X
                              
                           
                           (
                           Y
                           )
                        
                      the reverse Euclidean distance transform 
                     [18], defined by
                        
                           
                              
                                 
                                    REDT
                                 
                                 
                                    X
                                 
                              
                              (
                              Y
                              )
                              =
                              
                                 
                                    
                                       ⋃
                                    
                                    
                                       y
                                       ∈
                                       Y
                                    
                                 
                              
                              
                              B
                              (
                              y
                              ,
                              
                                 
                                    D
                                 
                                 
                                    X
                                 
                              
                              (
                              y
                              )
                              )
                           
                        
                     
                  

The medial axis permits the exact reconstruction of the original object thanks to 
                        
                           REDT
                        
                     , more precisely we have 
                        
                           X
                           =
                           
                              
                                 REDT
                              
                              
                                 X
                              
                           
                           (
                           MA
                           (
                           X
                           )
                           )
                        
                     .

In this section, we adapt the notion of scale axis (see [19,20]), originally introduced in the continuous space 
                        
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                        
                     , to the case of discrete space 
                        
                           
                              
                                 Z
                              
                              
                                 d
                              
                           
                        
                     . Let 
                        
                           X
                           ⊆
                           
                              
                                 Z
                              
                              
                                 d
                              
                           
                           ,
                           
                           x
                           ∈
                           X
                           ,
                           
                           r
                           ∈
                           
                              
                                 N
                              
                              
                                 +
                              
                           
                        
                      and 
                        
                           s
                           ∈
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                        
                     . The parameter s is called the scale factor. We denote by 
                        
                           
                              
                                 X
                              
                              
                                 s
                              
                           
                        
                      the multiplicatively s-scaled shape, defined by 
                        
                           
                              
                                 X
                              
                              
                                 s
                              
                           
                           =
                           
                              
                                 ⋃
                              
                              
                                 (
                                 x
                                 ,
                                 r
                                 )
                                 ∈
                                 MA
                                 (
                                 X
                                 )
                              
                           
                           B
                           (
                           x
                           ,
                           rs
                           )
                        
                     . For 
                        
                           s
                           ⩾
                           1
                        
                     , we denote by 
                        
                           
                              
                                 SAT
                              
                              
                                 s
                              
                           
                           (
                           X
                           )
                        
                      the s-scale axis transform of X, defined by
                        
                           
                              
                                 
                                    SAT
                                 
                                 
                                    s
                                 
                              
                              (
                              X
                              )
                              =
                              {
                              (
                              x
                              ,
                              r
                              /
                              s
                              )
                              |
                              (
                              x
                              ,
                              r
                              )
                              ∈
                              MA
                              (
                              
                                 
                                    X
                                 
                                 
                                    s
                                 
                              
                              )
                              }
                              .
                           
                        
                     
                  

The algorithm introduced in [19] for computing the scale axes of objects in 
                        
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                        
                      can be adapted to objects in 
                        
                           
                              
                                 Z
                              
                              
                                 d
                              
                           
                        
                      as follows. First, calculate the Euclidean medial axis of X. To do so, we use an efficient algorithm presented in [18]. Then multiply the radius of each medial ball by the chosen scaling factor s.

As a consequence, some small medial balls are covered completely by larger nearby balls since they are not important. On the other hand, small balls without larger balls in their neighbourhood are not covered and will be preserved.

The next step is to reconstruct the object 
                        
                           
                              
                                 X
                              
                              
                                 s
                              
                           
                        
                      based on scaled radius values. This reconstruction can be made efficiently by using the reverse Euclidean distance transform (see Section 2). Then, 
                        
                           MA
                           (
                           
                              
                                 X
                              
                              
                                 s
                              
                           
                           )
                        
                      is computed.

The final step of the algorithm consists in rescaling the medial balls of 
                        
                           MA
                           (
                           
                              
                                 X
                              
                              
                                 s
                              
                           
                           )
                        
                      by a factor 
                        
                           1
                           /
                           s
                        
                      to obtain the scale axis of X.

For 
                        
                           s
                           =
                           1
                        
                     , the scale axis is identical to 
                        
                           MA
                           (
                           X
                           )
                        
                     . With increasing s, the scale axis gradually ignores less important features of X, leading to successive simplifications of 
                        
                           
                              
                                 X
                              
                              
                                 s
                              
                           
                        
                      and the scale axis structure.

Finally, a detailed discrete scale axis algorithm is provided in Algorithm 1.
                        Algorithm 1
                        DiscreteScaleAxis(Input 
                           
                              
                                 X
                                 ,
                                 s
                              
                           ) 
                              
                                 
                                    
                                    
                                       
                                          01.
                                             
                                                
                                                   MA
                                                   (
                                                   X
                                                   )
                                                   ←
                                                
                                              
                                             EuclideanMedialAxis(X)
                                       
                                       
                                          02.
                                             
                                                
                                                   
                                                      
                                                         MA
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                   ←
                                                   {
                                                   (
                                                   x
                                                   ,
                                                   rs
                                                   )
                                                   |
                                                   (
                                                   x
                                                   ,
                                                   r
                                                   )
                                                   ∈
                                                   MA
                                                   (
                                                   X
                                                   )
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          03.
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   ←
                                                
                                              
                                             ReverseEuclideanDT(
                                                
                                                   
                                                      
                                                         MA
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                
                                             )
                                       
                                       
                                          04.
                                             
                                                
                                                   MA
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   )
                                                   ←
                                                
                                              
                                             EuclideanMedialAxis(
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             )
                                       
                                       
                                          05.
                                             
                                                
                                                   
                                                      
                                                         SAT
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                   ←
                                                   {
                                                   (
                                                   x
                                                   ,
                                                   r
                                                   /
                                                   s
                                                   )
                                                   |
                                                   (
                                                   x
                                                   ,
                                                   r
                                                   )
                                                   ∈
                                                   MA
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   )
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          06.
                                             return 
                                             
                                                
                                                   
                                                      
                                                         SAT
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

All steps of DiscreteScaleAxis algorithm can be calculated in linear time with respect to 
                        
                           |
                           X
                           |
                        
                      (line 01), 
                        
                           |
                           MA
                           (
                           X
                           )
                           |
                        
                      (line 2), 
                        
                           |
                           
                              
                                 X
                              
                              
                                 s
                              
                           
                           |
                        
                      (lines 03–04) and 
                        
                           |
                           MA
                           (
                           
                              
                                 X
                              
                              
                                 s
                              
                           
                           )
                           |
                        
                      (line 05) respectively, where 
                        
                           |
                           X
                           |
                        
                      stands for the cardinality of X. Therefore, the computational complexity of the algorithm is 
                        
                           O
                           (
                           |
                           
                              
                                 X
                              
                              
                                 s
                              
                           
                           |
                           )
                        
                     .

The crucial part of the method presented in the previous section, is the reconstruction part after medial balls scaling and the need for generating a new medial axis from the scaled object (see Fig. 4). Because of this, we do not have the property 
                        
                           
                              
                                 SAT
                              
                              
                                 s
                              
                           
                           (
                           X
                           )
                           ⊆
                           MA
                           (
                           X
                           )
                        
                     . On the other hand, at first sight, this is the most important part of the algorithm since the medial axis simplification occurs in this part.

To solve this problem, we remark that an efficient filtration may be obtained by only deciding which 
                        
                           MA
                           (
                           X
                           )
                        
                      points are not important and should be removed, based on the covering of scaled balls by neighbouring scaled balls. Therefore, we do not have to generate a new object 
                        
                           
                              
                                 X
                              
                              
                                 s
                              
                           
                        
                      and its 
                        
                           MA
                           (
                           
                              
                                 X
                              
                              
                                 s
                              
                           
                           )
                        
                     . In this way we can obtain a filtered Euclidean medial axis of X which is a subset of 
                        
                           MA
                           (
                           X
                           )
                        
                     .

This informal discussion motivates the following definition of the Scale Filtered Euclidean Medial Axis (SFEMA).

Let 
                        
                           x
                           ∈
                           X
                           ,
                           
                           r
                           ∈
                           
                              
                                 N
                              
                              
                                 +
                              
                           
                        
                     . We denote by 
                        
                           
                              
                                 B
                              
                              
                                 X
                              
                           
                           (
                           x
                           ,
                           r
                           )
                        
                      the intersection of 
                        
                           B
                           (
                           x
                           ,
                           r
                           )
                        
                      with X, that is, 
                        
                           
                              
                                 B
                              
                              
                                 X
                              
                           
                           (
                           x
                           ,
                           r
                           )
                           =
                           {
                           y
                           ∈
                           X
                           |
                           d
                           (
                           x
                           ,
                           y
                           )
                           <
                           r
                           }
                        
                     .
                        Definition 1
                        Let 
                              
                                 X
                                 ⊆
                                 
                                    
                                       Z
                                    
                                    
                                       d
                                    
                                 
                              
                           , and 
                              
                                 s
                                 ∈
                                 R
                                 ,
                                 
                                 s
                                 ⩾
                                 1
                              
                           . We denote by 
                              
                                 
                                    
                                       SFEMA
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 X
                                 )
                              
                            the Scale Filtered Euclidean Medial Axis of X defined by
                              
                                 
                                    
                                       
                                          SFEMA
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    X
                                    )
                                    =
                                    
                                       
                                          
                                             (
                                             x
                                             ,
                                             r
                                             )
                                             ∈
                                             MA
                                             (
                                             X
                                             )
                                             |
                                             
                                                
                                                   B
                                                
                                                
                                                   X
                                                
                                             
                                             (
                                             x
                                             ,
                                             rs
                                             )
                                             
                                             ⊈
                                             
                                             
                                                
                                                   
                                                      ⋃
                                                   
                                                   
                                                      (
                                                      y
                                                      ,
                                                      t
                                                      )
                                                      ∈
                                                      MA
                                                      (
                                                      X
                                                      )
                                                      ,
                                                      t
                                                      >
                                                      r
                                                   
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   X
                                                
                                             
                                             (
                                             y
                                             ,
                                             ts
                                             )
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

We illustrate this definition in Fig. 5
                     . An object X and its medial axis are depicted in (a). In (b), the smaller ball is not fully covered by the bigger one after scaling. In the scale axis representation both balls will be preserved. However, the scaled bigger ball includes the intersection of the scaled smaller one with X. Therefore, the smaller ball will not exist in 
                        
                           
                              
                                 SFEMA
                              
                              
                                 s
                              
                           
                           (
                           X
                           )
                        
                     . In (c), the scaled smaller ball is included in the scaled bigger one. Therefore, it is neither in the scale axis nor in 
                        
                           
                              
                                 SFEMA
                              
                              
                                 s
                              
                           
                           (
                           X
                           )
                        
                     .

Examples of 
                        
                           
                              
                                 SFEMA
                              
                              
                                 s
                              
                           
                           (
                           X
                           )
                        
                      for different scale factors 
                        
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                        
                     , are shown in Fig. 7.

Let us analyse the properties and the major differences between the s-scale axis [19] and our s-scale filtered Euclidean medial axis. The most important property is that 
                        
                           
                              
                                 SFEMA
                              
                              
                                 s
                              
                           
                           (
                           X
                           )
                        
                      consists of 
                        
                           MA
                           (
                           X
                           )
                        
                      points only, that is, for all 
                        
                           s
                           ⩾
                           1
                           :
                           
                           
                              
                                 SFEMA
                              
                              
                                 s
                              
                           
                           (
                           X
                           )
                           ⊆
                           MA
                           (
                           X
                           )
                        
                     . This property (inclusion property, for short) is essential in some applications of the medial axis. In particular, a hierarchical representation of the family of filtered axes (see Section 5) is not possible without this property. In Fig. 4 we have shown an example of the Miklos et al.’s scale axis where an additional branch even appears after filtering. Fig. 6
                     
                      shows another example. The scale axis loses important features of the object (this might be a desirable behaviour in some applications, though) and is not included in the object. Besides, the s-scale filtered medial axis holds the inclusion property and permits to reconstruct most of the original object.

Notice that, the commonly used strategy based on homotopic thinning that permits to obtain a topologically correct skeleton (see Introduction, text and Fig. 1(b)), is based on the assumption that the filtered medial axis lies inside the original object.

The second interesting property relies on the notion of intersected ball (
                        
                           
                              
                                 B
                              
                              
                                 X
                              
                           
                        
                     ). If we want to simplify the object, using Miklos et al.’s scale axis, for example by removing a medial ball 
                        
                           B
                           (
                           x
                           ,
                           r
                           )
                           ,
                           
                           x
                           ∈
                           X
                        
                     , the scale factor should be big enough in order that ball 
                        
                           B
                           (
                           x
                           ,
                           rs
                           )
                        
                      is included in one of other medial balls, that is, 
                        
                           B
                           (
                           x
                           ,
                           rs
                           )
                           ⊂
                           B
                           (
                           y
                           ,
                           rs
                           )
                           ,
                           
                           y
                           ∈
                           X
                        
                      (see Fig. 5c), or in a union of such balls. In our method, since we use notion of intersected ball, we only test inclusion inside X (see Fig. 5b). This allows us to use a smaller scale factor. Therefore, we have a better ability to control the resulting s-scale filtered Euclidean medial axis. Notice also that the use of intersected balls is essential to design an efficient algorithm.

Below, we give an algorithm for computing 
                        
                           
                              
                                 SFEMA
                              
                              
                                 s
                              
                           
                           (
                           X
                           )
                        
                      for a given object 
                        
                           X
                           ⊆
                           
                              
                                 Z
                              
                              
                                 d
                              
                           
                        
                     .
                        Proposition 1
                        
                           Algorithm SFEMA computes exactly the s-Scale Filtered Euclidean Medial Axis, as defined by Definition 
                           1
                           .
                        

Consider any point p in X (after line 04). The assertion: “for all 
                              
                                 k
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 i
                                 }
                                 ,
                                 
                                 d
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 p
                                 )
                                 >
                                 
                                    
                                       sr
                                    
                                    
                                       k
                                    
                                 
                              
                           ” holds true during the execution of the loop at line 06. After execution of this loop (line 07) we know that for all 
                              
                                 k
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 i
                                 -
                                 1
                                 }
                                 ,
                                 
                                 d
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 p
                                 )
                                 >
                                 
                                    
                                       sr
                                    
                                    
                                       k
                                    
                                 
                              
                           , and 
                              
                                 d
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 p
                                 )
                                 ⩽
                                 
                                    
                                       sr
                                    
                                    
                                       i
                                    
                                 
                              
                           . Thus, at line 08, we know that p belongs to 
                              
                                 
                                    
                                       B
                                    
                                    
                                       X
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 s
                                 )
                              
                            and that it does not belong to any ball 
                              
                                 
                                    
                                       B
                                    
                                    
                                       X
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       k
                                    
                                 
                                 s
                                 )
                              
                           , with 
                              
                                 
                                    
                                       r
                                    
                                    
                                       k
                                    
                                 
                                 >
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                              
                           . From this we deduce that 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            belongs to 
                              
                                 
                                    
                                       SFEMA
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 X
                                 )
                              
                           .

This proves that all detected pairs indeed belong to 
                              
                                 
                                    
                                       SFEMA
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 X
                                 )
                              
                           . Now consider any pair 
                              
                                 (
                                 x
                                 ,
                                 r
                                 )
                              
                            of 
                              
                                 
                                    
                                       SFEMA
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 X
                                 )
                              
                           , there exists at least one point p in 
                              
                                 
                                    
                                       B
                                    
                                    
                                       X
                                    
                                 
                                 (
                                 x
                                 ,
                                 rs
                                 )
                              
                            that is not included in 
                              
                                 
                                    
                                       ⋃
                                    
                                    
                                       (
                                       y
                                       ,
                                       t
                                       )
                                       ∈
                                       MA
                                       (
                                       X
                                       )
                                       ,
                                       t
                                       >
                                       r
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       X
                                    
                                 
                                 (
                                 y
                                 ,
                                 ts
                                 )
                              
                           . As all points p of X are considered by the algorithm (line 04), the pair 
                              
                                 (
                                 x
                                 ,
                                 r
                                 )
                              
                            will be detected.□

The algorithm in line 02 performs a sorting of medial axis elements, in time 
                        
                           O
                           (
                           |
                           MA
                           (
                           X
                           )
                           |
                           log
                           |
                           MA
                           (
                           X
                           )
                           |
                           )
                        
                     . In the following lines the algorithm performs two loops. The first one starts in line 04 and does 
                        
                           |
                           X
                           |
                        
                      iterations. The next, nested loop, starts in line 06 and in the worst case performs 
                        
                           |
                           MA
                           (
                           X
                           )
                           |
                        
                      iterations. Summarizing, computational complexity of SFEMA is 
                        
                           O
                           (
                           |
                           X
                           |
                           |
                           MA
                           (
                           X
                           )
                           |
                           )
                        
                     .
                        Algorithm 2
                        SFEMA(Input 
                           
                              
                                 X
                                 ,
                                 s
                              
                           ) 
                              
                                 
                                    
                                    
                                       
                                          01.
                                             
                                                
                                                   H
                                                   ←
                                                   ∅
                                                
                                             
                                          
                                       
                                       
                                          02.
                                             
                                                
                                                   MA
                                                   (
                                                   X
                                                   )
                                                   ←
                                                
                                              
                                             EuclideanMedialAxis(X)
                                       
                                       
                                          03.L¯et 
                                                
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                   ,
                                                   …
                                                   ,
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   )
                                                
                                              denote the elements of 
                                                
                                                   MA
                                                   (
                                                   X
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             
                                             sorted in decreasing order of radii, that is, 
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ⩾
                                                   ⋯
                                                   ⩾
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          04.
                                             foreach 
                                             
                                                
                                                   p
                                                   ∈
                                                   X
                                                
                                              
                                             do
                                          
                                       
                                       
                                          05.
                                             
                                             
                                                
                                                   i
                                                   ←
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          06.
                                             
                                             while 
                                             
                                                
                                                   d
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   p
                                                   )
                                                   >
                                                   
                                                      
                                                         sr
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                              
                                             do 
                                             
                                                
                                                   i
                                                   ←
                                                   i
                                                   +
                                                   1
                                                
                                              
                                             end
                                          
                                       
                                       
                                          07.
                                             
                                             If 
                                             
                                                
                                                   i
                                                   ⩽
                                                   n
                                                
                                              
                                             then
                                          
                                       
                                       
                                          08.
                                             
                                             
                                             
                                                
                                                   H
                                                   ←
                                                   H
                                                   ∪
                                                   {
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          09.
                                             
                                             end
                                          
                                       
                                       
                                          10.
                                             end
                                          
                                       
                                       
                                          11.
                                             return 
                                             H
                                          
                                       
                                    
                                 
                              
                           
                        

Intuitively, the greater the scale parameter s used in 
                           
                              SFEMA
                           
                        , the smaller the filtered axis. Moreover for each object 
                           
                              X
                              ,
                              
                              SFEMA
                           
                         produces a family of axes that are all subsets of 
                           
                              MA
                              (
                              X
                              )
                           
                        . This suggests that these axes could be nested into each other. In this section, we formalise this property, we show that it is not always true with the axes defined by 
                           
                              SFEMA
                           
                        , and we propose a new algorithm for computing directly a family (hierarchy) of nested filtered axes.

It may be interesting to compute a hierarchy instead of a single filtered skeleton in cases, which are frequent, where there is no trivial way to fix a priori a single parameter value for a set of images. In such cases, the precomputed hierarchy may allow a user to interactively visualise the effect of each parameter value on the filtering. Alternatively, a post-processing algorithm may be applied, in certain applications, to automatically choose a threshold of the hierarchy that satisfies a given criterion (for example, a chosen number of skeleton branches).
                           Definition 2
                           We denote by 
                                 
                                    
                                       
                                          MA
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    X
                                    )
                                 
                               the filtered medial axis of 
                                 
                                    X
                                    ⊂
                                    
                                       
                                          Z
                                       
                                       
                                          n
                                       
                                    
                                 
                               for 
                                 
                                    s
                                    ∈
                                    S
                                    ⊆
                                    
                                       
                                          R
                                       
                                       
                                          +
                                       
                                    
                                 
                              , where S represents the set of all possible values of parameter s of the considered filtering algorithm.

The family 
                                 
                                    H
                                    (
                                    X
                                    )
                                    =
                                    {
                                    
                                       
                                          MA
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    X
                                    )
                                    |
                                    s
                                    ∈
                                    S
                                    }
                                 
                               is a hierarchy if for all 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                    ∈
                                    S
                                    ,
                                    
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                    >
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                 
                               implies 
                                 
                                    
                                       
                                          MA
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    (
                                    X
                                    )
                                    ⊆
                                    
                                       
                                          MA
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    (
                                    X
                                    )
                                    ⊆
                                    MA
                                    (
                                    X
                                    )
                                 
                              .

Unfortunately, given an object 
                           
                              X
                              ⊆
                              
                                 
                                    Z
                                 
                                 
                                    d
                                 
                              
                           
                        , the family 
                           
                              SFEMA
                              (
                              X
                              )
                              =
                              {
                              
                                 
                                    SFEMA
                                 
                                 
                                    s
                                 
                              
                              (
                              X
                              )
                              |
                              s
                              ⩾
                              1
                              }
                           
                         is not necessarily a hierarchy. Fig. 8
                         presents an object X whose associated family of medial axes 
                           
                              SFEMA
                              (
                              X
                              )
                           
                         does not enjoy the hierarchy property. This fact motivates the following definition:
                           Definition 3
                           Let 
                                 
                                    X
                                    ⊂
                                    
                                       
                                          Z
                                       
                                       
                                          n
                                       
                                    
                                 
                               and 
                                 
                                    (
                                    x
                                    ,
                                    r
                                    )
                                    ∈
                                    MA
                                    (
                                    X
                                    )
                                 
                              . We denote by 
                                 
                                    
                                       
                                          Ψ
                                       
                                       
                                          X
                                       
                                    
                                    :
                                    MA
                                    (
                                    X
                                    )
                                    →
                                    [
                                    1
                                    ,
                                    ∞
                                    )
                                    ∪
                                    {
                                    ∞
                                    }
                                 
                               the scale map of X defined by
                                 
                                    
                                       
                                          
                                             Ψ
                                          
                                          
                                             X
                                          
                                       
                                       (
                                       x
                                       ,
                                       r
                                       )
                                       =
                                       
                                          min
                                       
                                       {
                                       t
                                       ⩾
                                       1
                                       |
                                       ∀
                                       s
                                       ⩾
                                       t
                                       ,
                                       (
                                       x
                                       ,
                                       r
                                       )
                                       
                                       ∉
                                       
                                       
                                          
                                             SFEMA
                                          
                                          
                                             s
                                          
                                       
                                       (
                                       X
                                       )
                                       }
                                    
                                 
                              
                           

In words, 
                           
                              
                                 
                                    Ψ
                                 
                                 
                                    X
                                 
                              
                              (
                              x
                              ,
                              r
                              )
                           
                         is the minimal scale at which a given ball disappears from all the following scaled filtered axes.

We see that thresholding the map 
                           
                              
                                 
                                    Ψ
                                 
                                 
                                    X
                                 
                              
                           
                         at a given level s gives us a filtered axis. By construction, all these axes form a hierarchy.

Now, let us introduce Algorithm 3, which calculates the scale map.

The computational complexity of Algorithm 3 is the same as Algorithm 2, that is, 
                           
                              O
                              (
                              |
                              X
                              |
                              |
                              MA
                              (
                              X
                              )
                              |
                              )
                           
                        . The algorithm in line 02 performs a sorting of medial axis elements, in time 
                           
                              O
                              (
                              |
                              MA
                              (
                              X
                              )
                              |
                              log
                              |
                              MA
                              (
                              X
                              )
                              |
                              )
                           
                        . In the following lines the algorithm performs two loops, the second nested in the first. The first one starts in line 04 and does 
                           
                              |
                              X
                              |
                           
                         iterations. The next nested loop starts in line 06 and performs 
                           
                              |
                              MA
                              (
                              X
                              )
                              |
                           
                         iterations, where 
                           
                              |
                              MA
                              (
                              X
                              )
                              |
                              ≪
                              |
                              X
                              |
                           
                         (usually).

Before proving the correctness of Algorithm 3, we illustrate its behaviour based on the simple example of Fig. 9
                        .

Notice that Algorithm 3 could be simplified if we assume that all medial axis ball have distinct radii: line 8 and variable 
                           
                              
                                 
                                    t
                                 
                                 
                                    min
                                 
                                 
                                    r
                                 
                              
                           
                         are only useful in the case of equal radii. For the sake of simplicity, the balls of this example have distinct radii, hence 
                           
                              
                                 
                                    t
                                 
                                 
                                    min
                                 
                                 
                                    r
                                 
                              
                           
                         is always equal to 
                           
                              
                                 
                                    t
                                 
                                 
                                    min
                                 
                              
                           
                        .

In this example we focus on the computation of the scale map value for the medial axis point x, that is, 
                           
                              Ψ
                              (
                              x
                              ,
                              r
                              )
                           
                        .

For point a, the algorithm calculates 
                           
                              
                                 
                                    t
                                 
                                 
                                    min
                                 
                              
                           
                         as a minimum of 
                           
                              d
                              (
                              a
                              ,
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              /
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                           
                         for all balls 
                           
                              B
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         (shortly 
                           
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                           
                        ) greater than 
                           
                              B
                              (
                              x
                              ,
                              r
                              )
                           
                         (shortly B) in lines 06–13. In our example only two maximal balls are greater than 
                           
                              B
                              :
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                           
                        .
                           Algorithm 3
                           ScaleMap(Input 
                              X) 
                                 
                                    
                                       
                                       
                                          
                                             00.
                                                
                                                   
                                                      MA
                                                      (
                                                      X
                                                      )
                                                   
                                                 
                                                
                                                   
                                                      ←
                                                   
                                                 
                                                EuclideanMedialAxis(X)
                                          
                                          
                                             01.
                                                foreach 
                                                
                                                   
                                                      (
                                                      x
                                                      ,
                                                      r
                                                      )
                                                      ∈
                                                      MA
                                                      (
                                                      X
                                                      )
                                                   
                                                 
                                                do 
                                                
                                                   
                                                      
                                                         
                                                            Ψ
                                                         
                                                         
                                                            X
                                                         
                                                      
                                                      (
                                                      x
                                                      ,
                                                      r
                                                      )
                                                      ←
                                                   
                                                 0 end
                                             
                                          
                                          
                                             02.Let 
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      ,
                                                      …
                                                      ,
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      )
                                                   
                                                 be elements in 
                                                   
                                                      MA
                                                      (
                                                      X
                                                      )
                                                   
                                                 sorted
                                          
                                          
                                             03.such that 
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ⩾
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            i
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             04.
                                                foreach 
                                                
                                                   
                                                      p
                                                      ∈
                                                      X
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             05.
                                                
                                                
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                      ←
                                                      +
                                                      ∞
                                                   
                                                
                                             
                                          
                                          
                                             06.
                                                
                                                for 
                                                
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                 
                                                to 
                                                n 
                                                do
                                             
                                          
                                          
                                             07.
                                                
                                                
                                                
                                                   
                                                      t
                                                      ←
                                                      
                                                         
                                                            d
                                                            (
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            p
                                                            )
                                                         
                                                         
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             08.
                                                
                                                
                                                If 
                                                
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                 
                                                or 
                                                
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                      ≠
                                                      
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            i
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                 
                                                then 
                                                
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            min
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             09.
                                                
                                                
                                                If 
                                                
                                                   
                                                      t
                                                      >
                                                      1
                                                   
                                                 
                                                and 
                                                
                                                   
                                                      t
                                                      <
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                   
                                                 
                                                then 
                                                
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                      ←
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             10.
                                                
                                                
                                                If 
                                                
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            min
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      ⩾
                                                      d
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      p
                                                      )
                                                      /
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                 
                                                and 
                                                
                                                   
                                                      
                                                         
                                                            Ψ
                                                         
                                                         
                                                            X
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      <
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            min
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             11 
                                                
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            Ψ
                                                         
                                                         
                                                            X
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      ←
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            min
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             12 
                                                
                                                
                                                end
                                             
                                          
                                          
                                             13.
                                                
                                                end
                                             
                                          
                                          
                                             14.
                                                end
                                             
                                          
                                          
                                             15.
                                                return 
                                                
                                                   
                                                      
                                                         
                                                            Ψ
                                                         
                                                         
                                                            X
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

We have 
                           
                              d
                              (
                              a
                              ,
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                              /
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                           
                         (shortly 
                           
                              
                                 
                                    d
                                 
                                 
                                    a
                                    1
                                 
                              
                           
                        ) greater than 
                           
                              d
                              (
                              a
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              )
                              /
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                           
                         (shortly 
                           
                              
                                 
                                    d
                                 
                                 
                                    a
                                    2
                                 
                              
                           
                        ). So 
                           
                              
                                 
                                    t
                                 
                                 
                                    min
                                 
                              
                              =
                              
                                 
                                    d
                                 
                                 
                                    a
                                    2
                                 
                              
                           
                        . It means that during scaling the ball 
                           
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                           
                         covers the point a as the first of all maximal balls greater than B. Moreover the minimum cover scale s such that 
                           
                              a
                              ∈
                              
                                 
                                    sB
                                 
                                 
                                    2
                                 
                              
                           
                         is equal to 
                           
                              
                                 
                                    d
                                 
                                 
                                    a
                                    2
                                 
                              
                           
                        . Then the algorithm, in line 10, checks if ball B reaches the point a for smaller scaling factor than 
                           
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                           
                         (smaller than 
                           
                              
                                 
                                    t
                                 
                                 
                                    min
                                 
                              
                           
                        ). In our case 
                           
                              
                                 
                                    d
                                 
                                 
                                    a
                                 
                              
                              =
                              d
                              (
                              x
                              ,
                              a
                              )
                              /
                              r
                           
                         is smaller than 
                           
                              
                                 
                                    d
                                 
                                 
                                    a
                                    2
                                 
                              
                           
                        . So point a belongs to a union of balls greater than B for minimum cover scale 
                           
                              s
                              =
                              
                                 
                                    d
                                 
                                 
                                    a
                                    2
                                 
                              
                           
                         and it belongs to the ball 
                           
                              B
                              (
                              x
                              ,
                              r
                              ∗
                              
                                 
                                    d
                                 
                                 
                                    a
                                    2
                                 
                              
                              )
                           
                        , thus if 
                           
                              Ψ
                              (
                              x
                              ,
                              r
                              )
                              <
                              
                                 
                                    d
                                 
                                 
                                    a
                                    2
                                 
                              
                           
                         the algorithm updates 
                           
                              Ψ
                              (
                              x
                              ,
                              r
                              )
                           
                         in line 11.

Similarly for the point b we have 
                           
                              
                                 
                                    d
                                 
                                 
                                    b
                                 
                              
                              <
                              
                                 
                                    d
                                 
                                 
                                    b
                                    2
                                 
                              
                              <
                              
                                 
                                    d
                                 
                                 
                                    b
                                    1
                                 
                              
                           
                        , so 
                           
                              
                                 
                                    t
                                 
                                 
                                    min
                                 
                              
                              =
                              
                                 
                                    d
                                 
                                 
                                    b
                                    2
                                 
                              
                           
                         and 
                           
                              Ψ
                              (
                              x
                              ,
                              r
                              )
                           
                         is set to 
                           
                              
                                 
                                    d
                                 
                                 
                                    b
                                    2
                                 
                              
                           
                         if less than 
                           
                              
                                 
                                    d
                                 
                                 
                                    b
                                    2
                                 
                              
                           
                        .

The situation is different for the point c, for we have 
                           
                              
                                 
                                    d
                                 
                                 
                                    c
                                    2
                                 
                              
                              <
                              
                                 
                                    d
                                 
                                 
                                    c
                                 
                              
                              <
                              
                                 
                                    d
                                 
                                 
                                    c
                                    1
                                 
                              
                           
                        , it means that 
                           
                              
                                 
                                    t
                                 
                                 
                                    min
                                 
                              
                              =
                              
                                 
                                    d
                                 
                                 
                                    c
                                    2
                                 
                              
                              <
                              
                                 
                                    d
                                 
                                 
                                    c
                                 
                              
                           
                         so when the union of balls greater than B scaled by 
                           
                              
                                 
                                    d
                                 
                                 
                                    c
                                    2
                                 
                              
                           
                         reaches point c, it does not belong to 
                           
                              B
                              (
                              x
                              ,
                              r
                              ∗
                              
                                 
                                    d
                                 
                                 
                                    c
                                    2
                                 
                              
                              )
                           
                         so the algorithm does not update 
                           
                              Ψ
                              (
                              x
                              ,
                              r
                              )
                           
                        . The same situation occurs for point d, when reached by scaled 
                           
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                           
                         it does not belong to scaled B so 
                           
                              Ψ
                              (
                              x
                              ,
                              r
                              )
                           
                         is not updated. In the example, 
                           
                              Ψ
                              (
                              x
                              ,
                              r
                              )
                              =
                              
                                 
                                    d
                                 
                                 
                                    c
                                    2
                                 
                              
                           
                        .

Let us first remark that, in the definition of 
                           
                              Ψ
                           
                        , it is not necessary to consider all possible values of t or s, but only the ones of the form 
                           
                              
                                 
                                    d
                                    (
                                    x
                                    ,
                                    p
                                    )
                                 
                                 
                                    r
                                 
                              
                           
                        , with 
                           
                              p
                              ∈
                              X
                           
                         and 
                           
                              (
                              x
                              ,
                              r
                              )
                              ∈
                              MA
                              (
                              X
                              )
                           
                        , and 
                           
                              +
                              ∞
                           
                        . Thus, we define:
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 
                                    
                                       
                                          s
                                          =
                                          
                                             
                                                d
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                p
                                                )
                                             
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          ;
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ∈
                                          MA
                                          (
                                          X
                                          )
                                          
                                          and
                                          
                                          s
                                          >
                                          1
                                       
                                    
                                 
                                 ∪
                                 {
                                 +
                                 ∞
                                 }
                              
                           
                        
                     

That is, 
                           
                              
                                 
                                    S
                                 
                                 
                                    p
                                 
                              
                           
                         is the set of scales such that p lies on the border of a scaled medial axis ball. Then:
                           
                              
                                 S
                                 =
                                 
                                    
                                       
                                          ⋃
                                       
                                       
                                          p
                                          ∈
                                          X
                                       
                                    
                                 
                                 
                                 
                                    
                                       S
                                    
                                    
                                       p
                                    
                                 
                              
                           
                        
                     

And we have:
                           
                              (1)
                              
                                 
                                    
                                       Ψ
                                    
                                    
                                       X
                                    
                                 
                                 (
                                 x
                                 ,
                                 r
                                 )
                                 =
                                 
                                    min
                                 
                                 {
                                 t
                                 ∈
                                 S
                                 |
                                 ∀
                                 s
                                 ∈
                                 S
                                 ,
                                 s
                                 ⩾
                                 t
                                 ,
                                 (
                                 x
                                 ,
                                 r
                                 )
                                 
                                 ∉
                                 
                                 
                                    
                                       SFEMA
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 X
                                 )
                                 }
                              
                           
                        
                     

Let 
                           
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                           
                         be the radius of the biggest ball in 
                           
                              MA
                              (
                              X
                              )
                           
                        , that is, 
                           
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              =
                              max
                              {
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              |
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              )
                              ∈
                              MA
                              (
                              X
                              )
                              }
                           
                        . Now, for any p in X and any 
                           
                              (
                              x
                              ,
                              r
                              )
                              ∈
                              MA
                              (
                              X
                              )
                           
                         let us define
                           
                              (2)
                              
                                 E
                                 (
                                 p
                                 ,
                                 r
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                   
                                                   {
                                                   t
                                                   ∈
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   |
                                                   ∀
                                                   s
                                                   ∈
                                                   S
                                                   ,
                                                   s
                                                   ⩾
                                                   t
                                                   ,
                                                   p
                                                   ∈
                                                   
                                                      
                                                         
                                                            ⋃
                                                         
                                                         
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            >
                                                            r
                                                         
                                                      
                                                   
                                                   
                                                   B
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         sr
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   }
                                                
                                                
                                                   if
                                                   
                                                   r
                                                   <
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   +
                                                   ∞
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

For a point p and a radius 
                           
                              r
                              ,
                              
                              E
                              (
                              p
                              ,
                              r
                              )
                           
                         is the minimum scale for which p is covered by a scaled medial ball of radius greater than r (minimum cover scale).

Moreover let us define:
                           
                              (3)
                              
                                 X
                                 (
                                 x
                                 ,
                                 r
                                 )
                                 =
                                 {
                                 p
                                 ∈
                                 X
                                 :
                                 E
                                 (
                                 p
                                 ,
                                 r
                                 )
                                 ⩾
                                 d
                                 (
                                 p
                                 ,
                                 x
                                 )
                                 /
                                 r
                                 }
                              
                           
                        
                     

For a medial ball 
                           
                              (
                              x
                              ,
                              r
                              )
                           
                        , 
                           
                              X
                              (
                              x
                              ,
                              r
                              )
                           
                         represents the set of all points p of X such that the minimum cover scale 
                           
                              E
                              (
                              p
                              ,
                              r
                              )
                           
                        , applied to the ball 
                           
                              (
                              x
                              ,
                              r
                              )
                           
                        , suffices to cover p.

From the last definition we have:
                           
                              (4)
                              
                                 X
                                 (
                                 x
                                 ,
                                 r
                                 )
                                 =
                                 {
                                 p
                                 ∈
                                 X
                                 :
                                 p
                                 ∈
                                 
                                    
                                       B
                                    
                                    
                                       X
                                    
                                 
                                 (
                                 x
                                 ,
                                 rE
                                 (
                                 p
                                 ,
                                 r
                                 )
                                 )
                                 }
                              
                           
                        
                        
                           Proposition 2
                           
                              For any 
                              
                                 
                                    (
                                    x
                                    ,
                                    r
                                    )
                                 
                               
                              in 
                              
                                 
                                    MA
                                    (
                                    X
                                    )
                                 
                              
                              , we have 
                              
                                 
                                    
                                       
                                          Ψ
                                       
                                       
                                          X
                                       
                                    
                                    (
                                    x
                                    ,
                                    r
                                    )
                                    =
                                    
                                       
                                          max
                                       
                                       
                                          p
                                          ∈
                                          X
                                          (
                                          x
                                          ,
                                          r
                                          )
                                       
                                    
                                    E
                                    (
                                    p
                                    ,
                                    r
                                    )
                                 
                              
                              .
                           

Let 
                                 
                                    r
                                    =
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    max
                                    {
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ∈
                                    MA
                                    (
                                    X
                                    )
                                    }
                                 
                              . Then we have 
                                 
                                    X
                                    (
                                    x
                                    ,
                                    r
                                    )
                                    =
                                    X
                                    ,
                                    
                                    E
                                    (
                                    p
                                    ,
                                    r
                                    )
                                    =
                                    +
                                    ∞
                                 
                               for any 
                                 
                                    p
                                    ∈
                                    X
                                 
                               and 
                                 
                                    
                                       
                                          Ψ
                                       
                                       
                                          X
                                       
                                    
                                    (
                                    x
                                    ,
                                    r
                                    )
                                    =
                                    +
                                    ∞
                                 
                              . From now on, we suppose that 
                                 
                                    r
                                    <
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                 
                              .

Let us set 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ˆ
                                       
                                    
                                    =
                                    
                                       
                                          arg max
                                       
                                       
                                          p
                                          ∈
                                          X
                                          (
                                          x
                                          ,
                                          r
                                          )
                                       
                                    
                                    E
                                    (
                                    p
                                    ,
                                    r
                                    )
                                 
                               and 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ˆ
                                       
                                    
                                    =
                                    E
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    r
                                    )
                                 
                              . Hence, we have 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ˆ
                                       
                                    
                                    =
                                    
                                       
                                          max
                                       
                                       
                                          p
                                          ∈
                                          X
                                          (
                                          x
                                          ,
                                          r
                                          )
                                       
                                    
                                    E
                                    (
                                    p
                                    ,
                                    r
                                    )
                                 
                              . So, directly from (2) we have that 
                                 
                                    ∀
                                    p
                                    ∈
                                    X
                                    (
                                    x
                                    ,
                                    r
                                    )
                                    ,
                                    
                                    p
                                    ∈
                                    
                                       
                                          ⋃
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                j
                                             
                                          
                                          >
                                          r
                                       
                                    
                                    B
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              , thus 
                                 
                                    ∀
                                    s
                                    ∈
                                    S
                                    ,
                                    
                                    s
                                    ⩾
                                    
                                       
                                          t
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                    X
                                    (
                                    x
                                    ,
                                    r
                                    )
                                    ⊆
                                    
                                       
                                          ⋃
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                j
                                             
                                          
                                          >
                                          r
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          X
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          sr
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              . Moreover, by the very definition of 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                    ∀
                                    s
                                    ∈
                                    S
                                    ,
                                    
                                    s
                                    <
                                    
                                       
                                          t
                                       
                                       
                                          ˆ
                                       
                                    
                                    :
                                    
                                       
                                          p
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                    ∉
                                    
                                    
                                       
                                          ⋃
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                j
                                             
                                          
                                          >
                                          r
                                       
                                    
                                    B
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          sr
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              . Thus, combining the last two expressions we obtain:
                                 
                                    (5)
                                    
                                       
                                          
                                             
                                                max
                                             
                                             
                                                p
                                                ∈
                                                X
                                                (
                                                x
                                                ,
                                                r
                                                )
                                             
                                          
                                       
                                       E
                                       (
                                       p
                                       ,
                                       r
                                       )
                                       =
                                       
                                          min
                                       
                                       
                                          
                                             
                                                t
                                                ∈
                                                
                                                   
                                                      
                                                         ⋃
                                                      
                                                      
                                                         p
                                                         ∈
                                                         X
                                                         (
                                                         x
                                                         ,
                                                         r
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      p
                                                   
                                                
                                                |
                                                ∀
                                                s
                                                ∈
                                                S
                                                ,
                                                s
                                                ⩾
                                                t
                                                ,
                                                
                                                X
                                                (
                                                x
                                                ,
                                                r
                                                )
                                                ⊆
                                                
                                                   
                                                      
                                                         ⋃
                                                      
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         >
                                                         r
                                                      
                                                   
                                                
                                                
                                                B
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ,
                                                
                                                   
                                                      sr
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              From (4) the definition of 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              , we have:
                                 
                                    (6)
                                    
                                       ∀
                                       s
                                       ∈
                                       S
                                       ,
                                       s
                                       >
                                       
                                          
                                             t
                                          
                                          
                                             ˆ
                                          
                                       
                                       ,
                                       X
                                       (
                                       x
                                       ,
                                       r
                                       )
                                       ⊆
                                       
                                          
                                             B
                                          
                                          
                                             X
                                          
                                       
                                       (
                                       x
                                       ,
                                       sr
                                       )
                                    
                                 
                              
                           

Now let us take any 
                                 
                                    p
                                    ∈
                                    X
                                    ⧹
                                    X
                                    (
                                    x
                                    ,
                                    r
                                    )
                                 
                              . From (3) we have 
                                 
                                    E
                                    (
                                    p
                                    ,
                                    r
                                    )
                                    <
                                    d
                                    (
                                    p
                                    ,
                                    x
                                    )
                                    /
                                    r
                                 
                              . So, by definition of 
                                 
                                    E
                                    (
                                    p
                                    ,
                                    r
                                    )
                                 
                              , for any 
                                 
                                    s
                                    ∈
                                    S
                                 
                               such that 
                                 
                                    p
                                    ∈
                                    
                                       
                                          B
                                       
                                       
                                          X
                                       
                                    
                                    (
                                    x
                                    ,
                                    rs
                                    )
                                 
                              , we have 
                                 
                                    p
                                    ∈
                                    
                                       
                                          ⋃
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                j
                                             
                                          
                                          >
                                          r
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          X
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          sr
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              . In other words:
                                 
                                    (7)
                                    
                                       ∀
                                       s
                                       ∈
                                       S
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             X
                                          
                                       
                                       (
                                       x
                                       ,
                                       rs
                                       )
                                       ⧹
                                       X
                                       (
                                       x
                                       ,
                                       r
                                       )
                                       ⊆
                                       
                                          
                                             
                                                ⋃
                                             
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      j
                                                   
                                                
                                                >
                                                r
                                             
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             X
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             sr
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                 
                              Finally from (5)–(7) we have:
                                 
                                    (8)
                                    
                                       
                                          
                                             
                                                max
                                             
                                             
                                                p
                                                ∈
                                                X
                                                (
                                                x
                                                ,
                                                r
                                                )
                                             
                                          
                                       
                                       E
                                       (
                                       p
                                       ,
                                       r
                                       )
                                       =
                                       
                                          min
                                       
                                       
                                          
                                             
                                                t
                                                ∈
                                                S
                                                |
                                                ∀
                                                s
                                                ∈
                                                S
                                                ,
                                                s
                                                ⩾
                                                t
                                                ,
                                                
                                                B
                                                (
                                                x
                                                ,
                                                sr
                                                )
                                                ⊆
                                                
                                                   
                                                      
                                                         ⋃
                                                      
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         >
                                                         r
                                                      
                                                   
                                                
                                                B
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ,
                                                
                                                   
                                                      sr
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       =
                                       Ψ
                                       (
                                       x
                                       ,
                                       r
                                       )
                                       
                                       □
                                    
                                 
                              
                           


                              Algorithm ScaleMap applied to X outputs the scale map 
                              
                                 
                                    
                                       
                                          Ψ
                                       
                                       
                                          X
                                       
                                    
                                 
                              
                              , as defined in the Definition 
                              3
                              .
                           

Algorithm ScaleMap, for a medial ball 
                                 
                                    B
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                               and a point 
                                 
                                    p
                                    ∈
                                    X
                                 
                               in lines 06–13, sets 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          min
                                       
                                       
                                          r
                                       
                                    
                                 
                               to 
                                 
                                    E
                                    (
                                    p
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                               defined by Eq. (2).

Then in line 10 it checks whether p belongs to 
                                 
                                    X
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              , see (3). Thus, we have that the algorithm (lines 8–11) calculates 
                                 
                                    
                                       
                                          max
                                       
                                       
                                          p
                                          ∈
                                          X
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    E
                                    (
                                    p
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              .

By Proposition 2, the algorithm calculates correctly 
                                 
                                    Ψ
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              , for each i.□

Let us define a new medial axis family, which enjoys the hierarchy property, based on the scale map calculated by Algorithm 4.
                           Definition 4
                           Let 
                                 
                                    X
                                    ⊂
                                    
                                       
                                          Z
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                    s
                                    >
                                    1
                                 
                               and 
                                 
                                    
                                       
                                          Ψ
                                       
                                       
                                          X
                                       
                                    
                                 
                               is a scale map of X. We define by 
                                 
                                    
                                       
                                          HSMA
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    X
                                    )
                                 
                               the hierarchical scaled medial axis of X by the following formula:
                                 
                                    
                                       
                                          
                                             HSMA
                                          
                                          
                                             s
                                          
                                       
                                       (
                                       X
                                       )
                                       =
                                       {
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       ∈
                                       MA
                                       (
                                       X
                                       )
                                       |
                                       
                                          
                                             Ψ
                                          
                                          
                                             X
                                          
                                       
                                       (
                                       x
                                       ,
                                       r
                                       )
                                       >
                                       s
                                       }
                                    
                                 
                              
                           

In conclusion, we have the following property, which is straightforwardly consequence of Definitions 2 and 4.
                           Theorem 2
                           
                              Let 
                              
                                 
                                    X
                                    ⊂
                                    
                                       
                                          Z
                                       
                                       
                                          d
                                       
                                    
                                 
                              
                              . The family 
                              
                                 
                                    H
                                    (
                                    X
                                    )
                                    =
                                    {
                                    
                                       
                                          HSMA
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    X
                                    )
                                    |
                                    s
                                    >
                                    1
                                    }
                                 
                               
                              is a hierarchy.
                           

In this section, we compare qualitatively and quantitatively properties of five medial axis filtering algorithms. In the comparison we include algorithms that operate in the same framework as ours: discrete 
                        
                           λ
                        
                     -medial axis (DLMA) [5], the Euclidean medial axis filtered with the use of bisector function (BFMA) [16], filtering based on medial ball radius (RFMA) [18], filtering based on ball covering (CFMA) [18] and a filtering method proposed in this work: the hierarchical scaled medial axis (HSMA).

In this study, we do not consider the topology preservation issue, as none of these methods provide a guarantee of preserving topology. A classical way to obtain topologically correct skeletons from a sparse medial axis, consists of performing an homotopic thinning of the shape with the constraint of preserving the medial points [6,7,13].

In our experiments we use six selected shapes from the Kimia’s database [25], that are representative of the whole set. Four of the selected objects: “Ray”, “Elephant”, “Camel” and “Fountain”, have important features at different scales, in contrast to the two other ones: “Classic” and “Misk” (see Fig. 10
                     ).

It is difficult to compare methods, all based on a single filtering parameter, but where the parameter has a different meaning. Due to this fact, comparing the results of two methods for the same parameter value does not make sense. Therefore, we have to find some strategies to ensure a fair comparison between methods, based on criteria that do not depend on their particular way of working. Furthermore, we want these criteria to be related with actual concerns met in real-world applications.

Several criteria have already been proposed in the literature. Chaussard [26] defined the so-called visual quality factor which is a combination of reconstruction error with information derived from the skeleton of the shape, namely, the number of skeleton points. Van Eede et al. [27] propose a solution based on weighted reconstruction error, combined with skeleton complexity defined as the number of skeleton branches. However, the quality of the medial axis depends of the reconstruction weight which need to be set arbitrarily. Setting this parameter properly is not obvious.

In the following subsections, we propose a comparison methodology that is based on five different criteria. In each case, we give both the definition and the intuitive meaning of the criterion, and we report the results of our experiments.

For the exact and unfiltered 
                           
                              MA
                              (
                              X
                              )
                           
                         we have 
                           
                              X
                              =
                              
                                 
                                    REDT
                                 
                                 
                                    X
                                 
                              
                              (
                              MA
                              (
                              X
                              )
                              )
                           
                        . However, this property is no longer true if we consider filtered medial axes e.g., HSMA, DLMA, BFMA, RFMA or CFMA. Therefore, it is interesting to measure how much information about the original object is lost when we perform filtering. We define
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       X
                                    
                                 
                                 (
                                 Y
                                 )
                                 =
                                 
                                    
                                       |
                                       (
                                       X
                                       ∪
                                       
                                          
                                             REDT
                                          
                                          
                                             X
                                          
                                       
                                       (
                                       Y
                                       )
                                       )
                                       ⧹
                                       (
                                       
                                          
                                             REDT
                                          
                                          
                                             X
                                          
                                       
                                       (
                                       Y
                                       )
                                       ∩
                                       X
                                       )
                                       |
                                    
                                    
                                       |
                                       X
                                       ∪
                                       
                                          
                                             REDT
                                          
                                          
                                             X
                                          
                                       
                                       (
                                       Y
                                       )
                                       |
                                    
                                 
                              
                           
                        
                     

We call 
                           
                              
                                 
                                    R
                                 
                                 
                                    X
                                 
                              
                              (
                              Y
                              )
                           
                         the (normalised) residual size of Y. Residual size give us a numerical evaluation of reconstruction error. Now we can set Y to different filtered medial axes, e.g., by using different methods or filtering parameter values, and then evaluate, e.g., visually, which one filtration is the best for a same degree of reconstruction of the object. The result 
                           
                              
                                 
                                    R
                                 
                                 
                                    X
                                 
                              
                              (
                              Y
                              )
                           
                         is a real value between 0 (perfect reconstruction) and 1 (bad reconstruction).


                        Fig. 11
                         presents DLMA, BFMA, HSMA, RFMA and CFMA of a chosen shape, extracted for several values of normalised residual size. Note that we compare the results of methods for approximately equal values of their residual size, rather than for equal values of their parameters. One can observe, in Fig. 11, that DLMA loses representation of the tail even for low values of residual size. On the other hand, BFMA preserves representation of the tail but it also preserves unimportant balls on the border of the object. Such balls may represent noise. HSMA preserves representation of the tail even for high value of residual size. Moreover it successfully removes unimportant balls even for low values of residual size. RFMA loses the tail even for low value of residual size and it preserves many unimportant balls. CFMA successfully removes unimportant balls but loses some representation of the tail for high residual size.

For the sake of paper size we have not included results for other objects from Fig. 10. Interested readers can find the results in [28] and draw similar conclusions as from Fig. 11.

Notice that, this strategy makes sense only if the residual size values are a monotonic, increasing function of the method’s parameter, ensuring a one-to-one correspondence (or one-to-few, in cases of equality) between residuals and parameter values. The inclusion property is a sufficient condition for this function to be increasing.

We denote by 
                           
                              
                                 
                                    NS
                                 
                                 
                                    X
                                 
                              
                              (
                              Y
                              )
                           
                         the normalised medial axis size, defined as the ratio of the number of medial points to the number of object points:
                           
                              
                                 
                                    
                                       NS
                                    
                                    
                                       X
                                    
                                 
                                 (
                                 Y
                                 )
                                 =
                                 |
                                 Y
                                 |
                                 /
                                 |
                                 X
                                 |
                              
                           
                        
                     

Now we can compare the normalised residual size obtained for the same NS, using different methods. Intuitively, this allows us to judge of the importance (on average), with regard to reconstruction, of the medial points that are kept by the filtering method.

In Fig. 12
                         we show the normalised residual size R as a function of normalised medial axis size NS for different shapes and different filtering methods. The results shows that the CFMA obtains the smallest residual size values for the very small normalised sizes of filtered medial axis. When the size of the medial axis is large enough the CFMA behaves similarly to BFMA and HSMA. It means that CFMA, BFMA and HSMA, at the first place remove points that do not affect the reconstruction error very much. In contrast, with RFMA and DLMA, some important (for reconstruction) points are removed even for very large size of medial axes.

From the shape understanding point of view, preserving visually important segments and removing unimportant ones, at the same time, is even more important than achieving very good reconstruction properties. Based on the two previous criteria only, it is hard to take into account the negative impact of the removal of a visually important feature that has a relatively small size. Therefore, in this section, we introduce another comparison criterion which allows us to observe how different filtering strategies preserve visually important features.

Globally, the filtering algorithms will be tested by measuring the “difference” between the border of an object X, and the border of the reconstructed shape after filtering. The “difference” will be measured using the dissimilarity measure commonly used in replacement of the Hausdorff distance, because of its lower sensitivity to outliers, and defined as follows:

Let 
                           
                              X
                              ,
                              
                              Y
                           
                         be two subsets of 
                           
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                        . We set
                           
                              
                                 D
                                 (
                                 X
                                 |
                                 Y
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       |
                                       X
                                       |
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          x
                                          ∈
                                          X
                                       
                                    
                                 
                                 
                                    
                                       min
                                    
                                    
                                       y
                                       ∈
                                       Y
                                    
                                 
                                 {
                                 d
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 }
                              
                           
                        and 
                           
                              d
                              (
                              X
                              |
                              Y
                              )
                              =
                              max
                              {
                              D
                              (
                              X
                              |
                              Y
                              )
                              ,
                              D
                              (
                              Y
                              |
                              X
                              )
                              }
                           
                         is the dissimilarity between X and Y.

In Fig. 13
                         we show the dissimilarity as a function of normalised residual size for different shapes and different filtering methods. Results shows that in all cases BFMA produce lower dissimilarity than other filtering criteria for the same value of normalised residual size. It means that BFMA preserves more visually important features, on the negative side it also preserves some noise. The HSMA produces results comparable to BFMA, but without the same sensitivity to noise. We can also observe a good behaviour of the CFMA up to some value of residual ssize. After reaching this level it starts removing features at low scale which cause dissimilarity to rapidly increase. On the other hand, DLMA and RFMA give comparable results for the objects without features at different scales, and very poor results for the other ones.

To evaluate the skeleton complexity, we have to consider skeletons that have the same topological characteristics as the original objects. In order to guarantee topology preservation, we perform an ultimate homotopic thinning of X with the constraint of retaining the points of its filtered medial axis Y (constraint set), that is, we iteratively remove simple points from X that do not belong to Y (see Fig. 14
                        ). A priority function is needed in order to specify which points must be considered at each step of the thinning. In the general case, the choice of this priority function is not obvious as reported in [16,7]. For example, taking the exact Euclidean distance map as a priority function may cause “extra branches” to appear which change the skeleton complexity and bias the comparison. Taking this fact into consideration we choose the function 
                           
                              
                                 
                                    F
                                 
                                 
                                    X
                                 
                              
                           
                         defined in [5] as priority: intuitively, for each object point x, the value 
                           
                              
                                 
                                    F
                                 
                                 
                                    X
                                 
                              
                              (
                              x
                              )
                           
                         is the radius of the smallest ball that encloses all boundary points of X that are closest to x.

Now, we define the complexity of the skeleton as the number of its end points. Notice that, due to the preservation of the connectivity, any isolated medial point that corresponds to unfiltered noise on the border of the object, will generate a spurious branch of the skeleton (see Fig. 14).

We propose another comparison criterion which relies on this notion of skeleton complexity. Quite often in applications, the desired degree of filtering can be expressed in terms of skeleton complexity (for example, the shape of a human silhouette should be represented by a skeleton of complexity five, with end points in the head, the arms and the legs). To each number of end points of the successive filtered skeletons, corresponds a degree of filtering that we evaluate quantitatively by its reconstruction error.

For a given method we denote by 
                           
                              Y
                              (
                              X
                              ,
                              λ
                              )
                           
                         the filtered medial axis at value 
                           
                              λ
                           
                         of the parameter. To each of the sets 
                           
                              Y
                              (
                              X
                              ,
                              λ
                              )
                           
                         corresponds a homotopic skeleton 
                           
                              S
                              (
                              Y
                              (
                              X
                              ,
                              λ
                              )
                              )
                           
                         that has a certain complexity. Note that, for a given complexity c, there may exist several values of 
                           
                              λ
                           
                        , or none, such that the complexity of 
                           
                              S
                              (
                              Y
                              (
                              X
                              ,
                              λ
                              )
                              )
                           
                         is c.

Now for a given complexity c, we consider the largest (in the sense of the inclusion) set 
                           
                              Y
                              (
                              X
                              ,
                              λ
                              )
                           
                         such that the complexity of 
                           
                              S
                              (
                              Y
                              (
                              X
                              ,
                              λ
                              )
                              )
                           
                         is c. We denote by 
                           
                              
                                 
                                    Y
                                 
                                 
                                    c
                                 
                              
                              (
                              X
                              )
                           
                         this set, or 
                           
                              ∅
                           
                         if it does not exist. The quality of this filtered medial axis will be evaluated by computing 
                           
                              
                                 
                                    R
                                 
                                 
                                    X
                                 
                              
                              (
                              
                                 
                                    Y
                                 
                                 
                                    c
                                 
                              
                              (
                              X
                              )
                              )
                           
                        , that is, the residual size of 
                           
                              
                                 
                                    Y
                                 
                                 
                                    c
                                 
                              
                              (
                              X
                              )
                           
                        .

Now we can simply compare medial axes at each complexity level independently by changing the parameter c without caring about the meaning of the filtering parameter 
                           
                              λ
                           
                        . We could also make a comparison by focusing only on the most suitable level for the shapes of interest. For example if we consider shapes similar to the letters “p”, “b”, “d”, etc., the most interesting complexity level is one, because these shapes have one visually important branch. Therefore, to compare filtered medial axes of such family of shapes we would use the value of 
                           
                              
                                 
                                    R
                                 
                                 
                                    X
                                 
                              
                              (
                              
                                 
                                    Y
                                 
                                 
                                    1
                                 
                              
                              (
                              X
                              )
                              )
                           
                        .


                        Fig. 15
                         shows the minimum residual size at different complexity levels. We can notice that HSMA gives the lowest residual size at the most suitable complexity according to the shape. The HSMA gives poor results only for very low complexity, since the method preserves very well features at different scales. Comparable results are generated by CFMA. The BFMA has the worst behaviour in this experiment, since it preserves many points which are close to the border. Therefore, the BFMA is unable to generate medial axes with low complexity. This strongly limits its practical application.

The last interesting criterion is related to the hierarchy property of the medial axes (see Definition 2 in Section 5). In some applications, one can be more interested in a filtering strategy which cannot only remove large amounts of points at once, but also allows one to produce some intermediate results at different levels of hierarchy. Then, the different methods may be compared on the basis of their ability to propose a rich set of hierarchy levels. This is also an important criterion if, in the end, only one filtered axis is kept, for its choice can be done more finely if the number of possibilities is larger.

Let us denote by 
                           
                              
                                 
                                    MA
                                 
                                 
                                    s
                                 
                              
                              (
                              X
                              )
                           
                         the filtered medial axis of 
                           
                              X
                              ⊂
                              
                                 
                                    Z
                                 
                                 
                                    n
                                 
                              
                           
                         for the value s of the filtering parameter. Since all methods in our comparison enjoy the hierarchy property, we know that 
                           
                              s
                              >
                              t
                           
                         implies 
                           
                              
                                 
                                    MA
                                 
                                 
                                    s
                                 
                              
                              (
                              X
                              )
                              ⊆
                              
                                 
                                    MA
                                 
                                 
                                    t
                                 
                              
                              (
                              X
                              )
                           
                        . However, due to the discrete nature of the object X, there exists only a finite set of values 
                           
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    s
                                 
                                 
                                    k
                                 
                              
                           
                         yielding distinct filtered axes. More precisely, we consider the set 
                           
                              
                                 
                                    {
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    k
                                 
                              
                           
                         of positive real numbers such that:
                           
                              (i)
                              
                                 
                                    
                                       
                                          
                                             MA
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       (
                                       X
                                       )
                                       =
                                       X
                                    
                                 , and


                                 
                                    
                                       
                                          
                                             MA
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       (
                                       X
                                       )
                                       
                                       ≠
                                       
                                       
                                          
                                             MA
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                       (
                                       X
                                       )
                                    
                                 , for any 
                                    
                                       i
                                       ∈
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       k
                                       }
                                    
                                 , and


                                 
                                    
                                       
                                          
                                             MA
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       (
                                       X
                                       )
                                       =
                                       
                                          
                                             MA
                                          
                                          
                                             s
                                          
                                       
                                       (
                                       X
                                       )
                                    
                                 , for any 
                                    
                                       i
                                       ∈
                                       {
                                       0
                                       ,
                                       …
                                       ,
                                       k
                                       -
                                       1
                                       }
                                    
                                  and any 
                                    
                                       s
                                       ∈
                                       [
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       [
                                    
                                 .

In the following, the indices i are called the hierarchy levels.

Then, we can evaluate the reconstruction error at each hierarchy level independently. When we increase the hierarchy level, the filtering algorithm removes a set of medial points with the same “importance”. The “importance” of the point depends on the filtering criterion. The filtering method which removes a smaller amount of points at each change of hierarchy level, can produce more different representations of the object.

In Fig. 16
                        , we show achieved values of normalised residual size at each hierarchy level for all tested filtering methods and for different shapes. Based on these results, we can observe how many different medial axes can be produced by manipulating the filtering parameter and how the reconstruction error evolves.

For the first four objects which have features at different scales, the HSMA generates the highest number of multiscale representations of the object. For the last two classes of objects HSMA gives globally the best result. In contrast, the CFMA yields globally the smallest number of hierarchy levels. RFMA and DLMA also generate a relatively small number of medial axes. Indeed, the number of different filtered medial axes generated with CFMA, RFMA and DLMA might be not enough in some applications.

@&#DISCUSSION@&#

The usefulness of each filtering method is strongly application dependent. Each of the presented experiments gives us some information about which filtering method is best with respect to the evaluated property. However, each experiment alone is not sufficient to clearly show which one filtering method is the best one at a global scope. In addition, some of the evaluated properties are not compatible. For example, at the same time we would like to minimise the reconstruction error, which at the extreme leads to keep most of the medial axis points, but we also would like to get skeletons with a low complexity, and get rid of points that correspond to noise or useless details. Such incompatibility is clearly visible on the results achieved by BFMA, where for medial axes of small size BFMA gives the lowest dissimilarity. Unfortunately, the complexity of the skeletons induced by BFMA is very high.

To compare different filtering criteria at a global scope, we need to look at results of all experiments at the same time. We can see that HSMA yields the best or comparable results to the best one in all experiments. Moreover, HSMA permits to produce a large set of hierarchy levels, which makes it very flexible. We can say that HSMA gives us the best balance between the reconstruction error, the size of medial axis, the complexity, the richness of the multiscale representation, and allows one to preserve features at different scales. Therefore, HSMA can be considered, globally, as the best method in our comparison.

We can also notice the good behaviour of the CFMA. Only the lowest number of possible hierarchy levels, and high dissimilarity for larger residual size can limit its application. If such features are irrelevant according to application, then CFMA is a good choice.

In our comparison, DLMA and RFMA give the worst results in our experiments. This is not surprising for both methods, since the filtering parameter is defined and acts globally. However, in contrast to RFMA, which is the simplest method and in practice is used only as a supplementary criterion, DLMA holds other interesting properties which are out of scope of this comparison. For example, stability to noise or rotation, makes DLMA very useful in certain practical applications (see [26,5] for a comprehensive evaluation of different DLMA properties).

@&#CONCLUSIONS@&#

This paper has three main contributions. The first contribution is a new method for Euclidean medial axis filtering which possesses the following properties:
                        
                           –
                           it generates subsets of the Euclidean medial axis,

the filtering is based on only one parameter,

it generates filtered medial axes which preserve important parts of an input object at different scales,

it allows for a better reconstruction of the input object, compared to other related medial axis filtering algorithms,

the computation complexity of the algorithm is 
                                 
                                    O
                                    (
                                    |
                                    X
                                    |
                                    |
                                    MA
                                    (
                                    X
                                    )
                                    |
                                    )
                                 
                              ,

it extends trivially to any finite dimension.

The second and the most important contribution, is an algorithm which, for any 
                        
                           X
                           ⊆
                           
                              
                                 Z
                              
                              
                                 2
                              
                           
                        
                     , generates a full hierarchy of scale filtered medial axes (HSMA) in time 
                        
                           O
                           (
                           |
                           X
                           |
                           |
                           MA
                           (
                           X
                           )
                           |
                           )
                        
                     . This algorithm also trivially extends for the case of 
                        
                           
                              
                                 Z
                              
                              
                                 n
                              
                           
                        
                     . We prove that the algorithm indeed computes the HSMA as we defined it.

The third contribution consists of a new methodology which allows for a fair comparison of medial axis filtering algorithms. The methodology is based on five different quality criteria. Using this new methodology, one can compare quantitatively properties of algorithms, independently of the meaning of specific algorithm parameters. Following this methodology, we made a series of experiments that show that HSMA gives better or similar results, compared to the best related methods.

@&#ACKNOWLEDGMENTS@&#

This work has been partially supported by the “ANR-2010-BLAN-0205 KIDICO” Project.

@&#REFERENCES@&#

