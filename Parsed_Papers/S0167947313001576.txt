@&#MAIN-TITLE@&#Bayesian dynamic probit models for the analysis of longitudinal data

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           A dynamic probit model with a first order Markov process was developed.


                        
                        
                           
                           Gibbs sampler using data augmentation approach and forward filtering backward sampling algorithm were presented.


                        
                        
                           
                           The discussion was extended to propose models to generalized models including Student 
                                 t
                              -link function.


                        
                        
                           
                           Model fit was compared between static and dynamic probit models.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Markov models

Bayesian inference

Longitudinal data

Dynamic linear models

Model selection

@&#ABSTRACT@&#


               
               
                  The authors consider a dynamic probit model where the coefficients follow a first-order Markov process. An exact Gibbs sampler for Bayesian analysis is presented for the model using the data augmentation approach and the forward filtering backward sampling algorithm for dynamic linear models. The authors discuss how our approach can be used for dynamic probit models as well as its generalizations including Markov regressions and models with Student link functions. An approach is presented to compare static and dynamic probit models as well as for Markov order selection in these classes of dynamic models. The developed approach is implemented to some actual data.
               
            

Time varying coefficient models for categorical longitudinal data have been considered by authors such as Carlin and Polson (1992), Shephard and Pitt (1997), Gamerman (1998), Kauermann (2000), and more recently by Fruhwirth-Schnatter and Fruhwirth (2007). Most of the previous works have considered logit-type state-space models. As noted by Fruhwirth-Schnatter and Fruhwirth (2007), Markov chain Monte Carlo (MCMC) approaches proposed by Shephard and Pitt (1997) and Gamerman (1998) for the analysis of these models are based on the Metropolis–Hastings algorithm which requires specification of a proposal density in high dimensions. To alleviate this, the authors proposed a data augmentation based MCMC method for analysis of dynamic logit models. A simple version of a dynamic probit model has been considered by Andrieu and Daucet (2002) where the authors used particle filtering for Bayesian analysis.

In what follows, we consider probit-type state-space models and develop an exact Gibbs sampler for Bayesian analysis of this class of models. Our approach is an extension of the data augmentation approach of Albert and Chib (1993) to dynamic probit models where we implement the forward filtering backward sampling algorithm of Fruhwirth-Schnatter (1994). Our approach can be easily generalized to consider 
                        t
                      distribution link functions that can be used to consider logit type dynamic models as well as Markov regression models.

We consider a binary time series 
                        
                           
                              X
                           
                           
                              t
                           
                        
                      and we define a dynamic probit model similar to that considered by Andrieu and Daucet (2002) as 
                        
                           (1.1)
                           
                              Pr
                              
                                 {
                                 
                                    
                                       X
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 1
                                 ∣
                                 
                                    
                                       π
                                    
                                    
                                       t
                                    
                                 
                                 }
                              
                              =
                              
                                 
                                    π
                                 
                                 
                                    t
                                 
                              
                              
                              with  
                              
                                 
                                    π
                                 
                                 
                                    t
                                 
                              
                              =
                              Φ
                              
                                 (
                                 
                                    
                                       
                                          F
                                       
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       t
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      where 
                        
                           
                              
                                 F
                              
                           
                           
                              t
                           
                        
                      is a 
                        1
                        ×
                        K
                      covariate vector and 
                        
                           
                              
                                 θ
                              
                           
                           
                              t
                           
                        
                      is a 
                        K
                        ×
                        1
                      vector of regression parameters. We define the dynamic nature of the model via a state equation for 
                        
                           
                              
                                 θ
                              
                           
                           
                              t
                           
                        
                      as 
                        
                           (1.2)
                           
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 G
                              
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    t
                                    −
                                    1
                                 
                              
                              +
                              
                                 
                                    
                                       w
                                    
                                 
                                 
                                    t
                                 
                              
                           
                        
                      with 
                        
                           
                              
                                 w
                              
                           
                           
                              t
                           
                        
                     ’s are uncorrelated multivariate normal error vectors with mean 0 and covariance matrix 
                        
                           
                              
                                 W
                              
                           
                           
                              θ
                           
                        
                      and 
                        
                           G
                        
                      is the specified transition matrix of the model. It is most common to assume that 
                        
                           G
                        
                      is an identity matrix implying a steady model in the sense of West and Harrison (1997). Thus, in our development we consider 
                        
                           (1.3)
                           
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    t
                                    −
                                    1
                                 
                              
                              +
                              
                                 
                                    
                                       w
                                    
                                 
                                 
                                    t
                                 
                              
                              .
                           
                        
                      The procedure can be easily extended for a general known transition 
                        
                           G
                        
                      as well as for certain cases where 
                        
                           G
                        
                      is unknown.

We can extend this for longitudinal data for individuals 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        M
                     . In this case we write the above model as 
                        
                           (1.4)
                           
                              Pr
                              
                                 {
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 =
                                 1
                                 ∣
                                 
                                    
                                       π
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 }
                              
                              =
                              
                                 
                                    π
                                 
                                 
                                    i
                                    t
                                 
                              
                              
                              with  
                              
                                 
                                    π
                                 
                                 
                                    i
                                    t
                                 
                              
                              =
                              Φ
                              
                                 (
                                 
                                    
                                       
                                          F
                                       
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       t
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      and assume the same state equation (1.3) for all individuals.

In Section  2, we introduce Bayesian inference for dynamic probit models and illustrate how an exact Gibbs sampler can be used. Extensions to Markov regression models and Student-
                        t
                      link functions are considered in Section  3. We illustrate how marginal likelihoods can be obtained and used to compare static versus dynamic probit models in Section  4. We also discuss how the marginal likelihood computations can be easily extended for Student-
                        t
                      link function case and thus can be used for selecting degrees of freedom. Implementation of our approach is illustrated in Section  5 using real data from the Great Smoky Mountains Study of Costello et al. (1996).

We first consider the case for the 
                        i
                     th individual Following Albert and Chib (1993), we can define the above model by using independent latent variables 
                        
                           
                              Z
                           
                           
                              i
                              t
                           
                        
                      such that 
                        
                           (2.1)
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                    t
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          1
                                          
                                          if  
                                          
                                             
                                                Z
                                             
                                             
                                                i
                                                t
                                             
                                          
                                          >
                                          0
                                       
                                    
                                    
                                       
                                          0
                                          
                                          Otherwise .
                                       
                                    
                                 
                              
                           
                        
                      If we assume that 
                        
                           
                              Z
                           
                           
                              i
                              t
                           
                        
                     ’s are normally distributed with mean 
                        
                           
                              
                                 F
                              
                           
                           
                              i
                              t
                           
                        
                        
                           
                              
                                 θ
                              
                           
                           
                              t
                           
                        
                      and variance 1, that is, 
                        
                           
                              Z
                           
                           
                              i
                              t
                           
                        
                        ∼
                        N
                        
                           (
                           
                              
                                 
                                    F
                                 
                              
                              
                                 i
                                 t
                              
                           
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 t
                              
                           
                           ,
                           1
                           )
                        
                     , then we have the probit model 
                        
                           (2.2)
                           
                              
                                 
                                    π
                                 
                                 
                                    i
                                    t
                                 
                              
                              =
                              Φ
                              
                                 (
                                 
                                    
                                       
                                          F
                                       
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       t
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

Given the above setup, we can develop a Gibbs sampler for the inference using the data augmentation algorithm of Albert and Chib (1993) with the algorithm proposed by Fruhwirth-Schnatter (1994) for dynamic linear models.

Given observed data 
                        D
                        =
                        
                           {
                           
                              
                                 X
                              
                              
                                 i
                                 t
                              
                           
                           ;
                           
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                           }
                        
                     , we can design a Gibbs sampler using full posterior conditional distributions 
                        p
                        
                           (
                           Θ
                           ∣
                           D
                           ,
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 
                                    i
                                 
                              
                              
                                 
                                    T
                                 
                              
                           
                           )
                        
                      and 
                        p
                        
                           (
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 
                                    i
                                 
                              
                              
                                 
                                    T
                                 
                              
                           
                           ∣
                           D
                           ,
                           Θ
                           )
                        
                      with vectors 
                        Θ
                        =
                        
                           (
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 T
                              
                           
                           )
                        
                      and 
                        
                           
                              
                                 Z
                              
                           
                           
                              
                                 i
                              
                           
                           
                              
                                 T
                              
                           
                        
                        =
                        
                           (
                           
                              
                                 Z
                              
                              
                                 i
                                 1
                              
                           
                           
                           
                              
                                 Z
                              
                              
                                 i
                                 2
                              
                           
                           
                           ⋯
                           
                           
                              
                                 Z
                              
                              
                                 i
                                 T
                              
                           
                           )
                        
                     . In obtaining 
                        p
                        
                           (
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 
                                    i
                                 
                              
                              
                                 
                                    T
                                 
                              
                           
                           ∣
                           D
                           ,
                           Θ
                           )
                        
                     , we note that 
                        
                           
                              Z
                           
                           
                              i
                              t
                           
                        
                     ’s are independent random variables and use 
                        
                           
                              
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 =
                                 1
                                 )
                              
                              ∼
                              N
                              
                                 (
                                 
                                    
                                       
                                          F
                                       
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 1
                                 )
                              
                              I
                              
                              
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 >
                                 0
                                 )
                              
                              ,
                           
                        
                      and 
                        
                           
                              
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 =
                                 0
                                 )
                              
                              ∼
                              N
                              
                                 (
                                 
                                    
                                       
                                          F
                                       
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 1
                                 )
                              
                              I
                              
                              
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 ≤
                                 0
                                 )
                              
                              .
                           
                        
                     
                  

In the implementation of the Gibbs sampler, we can directly draw from the joint posterior distribution of 
                        p
                        
                           (
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 T
                              
                           
                           ∣
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 
                                    i
                                 
                              
                              
                                 
                                    T
                                 
                              
                           
                           )
                        
                      using the forward filtering backward sampling algorithm of Fruhwirth-Schnatter (1994) which is given in West and Harrison (1997) for Kalman filter type models. It is possible to adopt the algorithm for our case as will be discussed next.

We define 
                        
                           
                              
                                 Z
                              
                           
                           
                              
                                 i
                              
                           
                           
                              
                                 t
                              
                           
                        
                        =
                        
                           (
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 i
                              
                              
                                 
                                    t
                                 
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 Z
                              
                              
                                 i
                                 t
                              
                           
                           )
                        
                        ,
                        
                        t
                        =
                        1
                        ,
                        …
                        ,
                        T
                      and note that, similar to the Bayesian dynamic linear models of West and Harrison (1997), using the Markov structure of our model we can write 
                        p
                        
                           (
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 T
                              
                           
                           ∣
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 
                                    i
                                 
                              
                              
                                 
                                    T
                                 
                              
                           
                           )
                        
                      as 
                        
                           (2.3)
                           
                              p
                              
                                 (
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 )
                              
                              p
                              
                                 (
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       T
                                       −
                                       1
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       i
                                    
                                    
                                       T
                                       −
                                       1
                                    
                                 
                                 )
                              
                              ⋯
                              p
                              
                                 (
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      where the first term 
                        p
                        
                           (
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 T
                              
                           
                           ∣
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 
                                    i
                                 
                              
                              
                                 
                                    T
                                 
                              
                           
                           )
                        
                      is available from standard DLM updating. We can start the sampling from 
                        
                           
                              
                                 θ
                              
                           
                           
                              T
                           
                        
                      and then sequentially sample 
                        
                           
                              
                                 θ
                              
                           
                           
                              T
                              −
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              
                                 θ
                              
                           
                           
                              1
                           
                        
                      using densities 
                        p
                        
                           (
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 t
                                 −
                                 1
                              
                           
                           ∣
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 i
                              
                              
                                 
                                    t
                                 
                                 −
                                 1
                              
                           
                           )
                        
                      for 
                        t
                        =
                        T
                        −
                        1
                        ,
                        …
                        ,
                        2
                     . The required distributions can be obtained using the state equation of the DLM. It follows from the DLM setup that 
                        
                           (2.4)
                           
                              
                                 (
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       i
                                    
                                    
                                       
                                          t
                                       
                                       −
                                       1
                                    
                                 
                                 )
                              
                              ∼
                              
                                 Normal
                              
                              
                                 (
                                 
                                    
                                       
                                          h
                                       
                                    
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          H
                                       
                                    
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      where 
                        
                           
                              (2.5)
                              
                                 
                                    
                                       
                                          h
                                       
                                    
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          m
                                       
                                    
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          R
                                       
                                    
                                    
                                       t
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          t
                                       
                                    
                                    −
                                    
                                       
                                          
                                             m
                                          
                                       
                                       
                                          t
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              (2.6)
                              
                                 
                                    
                                       
                                          H
                                       
                                    
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          R
                                       
                                    
                                    
                                       t
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 ,
                              
                           
                           
                              (2.7)
                              
                                 
                                    
                                       
                                          m
                                       
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          m
                                       
                                    
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       
                                          R
                                       
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          F
                                       
                                    
                                    
                                       i
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          (
                                          1
                                          +
                                          
                                             
                                                
                                                   F
                                                
                                             
                                             
                                                i
                                                t
                                             
                                          
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                
                                                   F
                                                
                                             
                                             
                                                i
                                                t
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       t
                                    
                                 
                                 ,
                              
                           
                        
                      and 
                        
                           (2.8)
                           
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    
                                       R
                                    
                                 
                                 
                                    t
                                 
                              
                              −
                              
                                 
                                    
                                       R
                                    
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       F
                                    
                                 
                                 
                                    i
                                    t
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    
                                       (
                                       1
                                       +
                                       
                                          
                                             
                                                F
                                             
                                          
                                          
                                             i
                                             t
                                          
                                       
                                       
                                          
                                             
                                                R
                                             
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             
                                                F
                                             
                                          
                                          
                                             i
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    
                                       F
                                    
                                 
                                 
                                    i
                                    t
                                 
                              
                              
                                 
                                    
                                       R
                                    
                                 
                                 
                                    t
                                 
                              
                              .
                           
                        
                      In the above setup, 
                        
                           
                              e
                           
                           
                              t
                           
                        
                        =
                        
                           
                              Z
                           
                           
                              i
                              t
                           
                        
                        −
                        
                           
                              
                                 F
                              
                           
                           
                              i
                              t
                           
                        
                        
                           
                              
                                 m
                              
                           
                           
                              t
                              −
                              1
                           
                        
                      is a scalar, and 
                        
                           
                              
                                 R
                              
                           
                           
                              t
                           
                        
                        =
                        
                           
                              
                                 C
                              
                           
                           
                              t
                              −
                              1
                           
                        
                        +
                        
                           
                              
                                 W
                              
                           
                           
                              θ
                           
                        
                     .

In the case where we have a prior on 
                        
                           
                              
                                 W
                              
                           
                           
                              θ
                           
                        
                      which is an inverse Wishart form given by 
                        
                           (2.9)
                           
                              
                                 
                                    
                                       W
                                    
                                 
                                 
                                    θ
                                 
                                 
                                    −
                                    1
                                 
                              
                              ∣
                              
                                 Σ
                              
                              ,
                              r
                              ∼
                              
                                 Wish
                              
                              
                                 (
                                 
                                    Σ
                                 
                                 ,
                                 r
                                 )
                              
                              ,
                           
                        
                      where the scale matrix 
                        
                           Σ
                        
                      and degrees of freedom 
                        r
                        >
                        K
                      are known quantities, the above results will be all conditional on 
                        
                           
                              
                                 W
                              
                           
                           
                              θ
                           
                        
                     . The full conditional of 
                        
                           
                              
                                 W
                              
                           
                           
                              θ
                           
                        
                      is again a Wishart density with degrees of freedom, 
                        
                           (
                           r
                           +
                           T
                           )
                        
                     , and scale matrix 
                        
                           (
                           
                              Σ
                           
                           +
                           
                              
                                 ∑
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                           
                              (
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    t
                                 
                              
                              −
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    t
                                    −
                                    1
                                 
                              
                              )
                           
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          t
                                       
                                    
                                    −
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          t
                                          −
                                          1
                                       
                                    
                                    )
                                 
                              
                              
                                 ′
                              
                           
                           )
                        
                     .

When we consider data from 
                        M
                      individuals for 
                        T
                      time periods given by 
                        D
                        =
                        
                           {
                           
                              
                                 X
                              
                              
                                 i
                                 t
                              
                           
                           ;
                           
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                           ;
                           
                           i
                           =
                           1
                           ,
                           …
                           ,
                           M
                           }
                        
                      where 
                        
                           
                              X
                           
                           
                              i
                              t
                           
                        
                     ’s are conditionally independent across the individuals as well as time, we define 
                        
                           
                              
                                 Z
                              
                           
                           
                              t
                           
                        
                      as a 
                        M
                        ×
                        1
                      vector of latent variables 
                        
                           
                              Z
                           
                           
                              i
                              t
                           
                        
                     . We now assume that 
                        
                           
                              
                                 Z
                              
                           
                           
                              t
                           
                        
                      has a multivariate normal distribution with independent components denoted as 
                        
                           
                              
                                 Z
                              
                           
                           
                              t
                           
                        
                        ∼
                        N
                        
                           (
                           
                              
                                 
                                    F
                                 
                              
                              
                                 t
                              
                           
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 
                                    I
                                 
                              
                              
                                 M
                              
                           
                           )
                        
                      where 
                        
                           
                              
                                 F
                              
                           
                           
                              t
                           
                        
                      is a 
                        M
                        ×
                        K
                      matrix of covariates and 
                        
                           
                              
                                 I
                              
                           
                           
                              M
                           
                        
                      is an 
                        M
                        ×
                        M
                      identity matrix. Since 
                        
                           
                              Z
                           
                           
                              i
                              t
                           
                        
                     ’s are conditionally independent random quantities, their full conditionals will stay the same. In updating 
                        
                           
                              
                                 θ
                              
                           
                           
                              t
                           
                        
                     ’s we will have 
                        
                           (2.10)
                           
                              
                                 
                                    
                                       m
                                    
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    
                                       m
                                    
                                 
                                 
                                    t
                                    −
                                    1
                                 
                              
                              +
                              
                                 
                                    
                                       R
                                    
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       F
                                    
                                 
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                I
                                             
                                          
                                          
                                             M
                                          
                                       
                                       +
                                       
                                          
                                             
                                                F
                                             
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             
                                                R
                                             
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             
                                                F
                                             
                                          
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    
                                       e
                                    
                                 
                                 
                                    t
                                 
                              
                           
                        
                      with 
                        
                           
                              
                                 e
                              
                           
                           
                              t
                           
                        
                        =
                        
                           
                              
                                 Z
                              
                           
                           
                              t
                           
                        
                        −
                        
                           
                              
                                 F
                              
                           
                           
                              t
                           
                        
                        
                           
                              
                                 m
                              
                           
                           
                              t
                              −
                              1
                           
                        
                        ,
                        
                           
                              
                                 R
                              
                           
                           
                              t
                           
                        
                        =
                        
                           
                              
                                 C
                              
                           
                           
                              t
                              −
                              1
                           
                        
                        +
                        
                           
                              
                                 W
                              
                           
                           
                              θ
                           
                        
                      and 
                        
                           (2.11)
                           
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    
                                       R
                                    
                                 
                                 
                                    t
                                 
                              
                              −
                              
                                 
                                    
                                       R
                                    
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       F
                                    
                                 
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                I
                                             
                                          
                                          
                                             M
                                          
                                       
                                       +
                                       
                                          
                                             
                                                F
                                             
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             
                                                R
                                             
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             
                                                F
                                             
                                          
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    
                                       F
                                    
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       R
                                    
                                 
                                 
                                    t
                                 
                              
                           
                        
                      where 
                        
                           
                              
                                 e
                              
                           
                           
                              t
                           
                        
                      is a 
                        M
                        ×
                        1
                      vector. Updating of 
                        
                           
                              
                                 W
                              
                           
                           
                              θ
                           
                        
                      will stay the same. Thus, the proposed approach provides an exact Gibbs sampler for Bayesian inference in the dynamic probit model (1.1) with evolution equation (1.2).

In the sequel, we consider two extensions of the dynamic model and the Bayesian inference introduced in the above. More specifically, we first illustrate how Markov regression models, including nonhomogeneous Markov chains, can be represented using the dynamic setup. Next, we discuss how a student-
                        t
                      link function can be used instead of a normal link function in our development.

We consider a 
                           q
                        -th order nonhomogeneous Markov chain model defined as 
                           
                              (3.1)
                              
                                 Pr
                                 
                                    {
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          t
                                       
                                    
                                    =
                                    1
                                    ∣
                                    
                                       
                                          π
                                       
                                       
                                          i
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          ,
                                          t
                                          −
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          ,
                                          t
                                          −
                                          q
                                       
                                    
                                    }
                                 
                                 =
                                 
                                    
                                       π
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 
                                 with  
                                 
                                    
                                       π
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 =
                                 Φ
                                 
                                    (
                                    
                                       
                                          
                                             F
                                          
                                       
                                       
                                          i
                                          t
                                       
                                    
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 =
                                 
                                    (
                                    1
                                    
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          ,
                                          t
                                          −
                                          1
                                       
                                    
                                    ⋯
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          ,
                                          t
                                          −
                                          q
                                       
                                    
                                    )
                                 
                                 
                                 and
                                 
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                0
                                                t
                                             
                                          
                                          
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                                t
                                             
                                          
                                          ⋯
                                          
                                             
                                                θ
                                             
                                             
                                                q
                                                t
                                             
                                          
                                          )
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 .
                              
                           
                         Thus, the transition probability 
                           
                              
                                 π
                              
                              
                                 i
                                 t
                              
                           
                         is given by 
                           
                              (3.2)
                              
                                 
                                    
                                       π
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 =
                                 Φ
                                 
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          0
                                          t
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          q
                                       
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          j
                                          ,
                                          t
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          ,
                                          t
                                          −
                                          j
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         For 
                           q
                           =
                           1
                         we obtain the first-order chain model 
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 =
                                 Φ
                                 
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          0
                                          t
                                       
                                    
                                    +
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                          ,
                                          t
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          ,
                                          t
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         implying a transition matrix 
                           
                              (3.3)
                              
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             Φ
                                             
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      0
                                                      t
                                                   
                                                
                                                +
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                      ,
                                                      t
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                      ,
                                                      t
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             1
                                             −
                                             Φ
                                             
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      0
                                                      t
                                                   
                                                
                                                +
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                      ,
                                                      t
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                      ,
                                                      t
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             Φ
                                             
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      0
                                                      t
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             1
                                             −
                                             Φ
                                             
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      0
                                                      t
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                         The above model provides a nonhomogeneous extension of Bayesian Markov regression models of Erkanli et al. (2001) who used logistic link functions. It also gives an alternative class of Bayesian nonhomogeneous Markov chain models considered in Sung et al. (2007).

We note that the transition probabilities can also be dependent on covariates and such dependence can be easily incorporated by defining components of 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 i
                                 t
                              
                           
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 t
                              
                           
                         accordingly. The Bayesian inference results presented in the previous section can be easily used for analysis of the model.

The dynamic probit model setup can be easily generalized to consider a 
                           t
                        -distribution link function in (2.2). To achieve this, following Albert and Chib (1993), we can assume in (2.1) that 
                           
                              
                                 Z
                              
                              
                                 i
                                 t
                              
                           
                        ’s are student-
                           t
                         distributed independent random variables with location 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 i
                                 t
                              
                           
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 t
                              
                           
                        , scale 1, and degrees of freedom 
                           η
                        . Thus, we can write (2.2) as 
                           
                              (3.4)
                              
                                 
                                    
                                       π
                                    
                                    
                                       i
                                       t
                                    
                                 
                                 =
                                 T
                                 
                                    (
                                    
                                       
                                          
                                             F
                                          
                                       
                                       
                                          i
                                          t
                                       
                                    
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           T
                           
                              (
                              ⋅
                              )
                           
                         denotes the student-
                           t
                         cdf. As noted by the authors, the above can be equivalently obtained as a scale mixtures of normal distributions by assuming unknown scale parameters 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                        ’s for 
                           
                              
                                 Z
                              
                              
                                 i
                                 t
                              
                           
                        ’s such that 
                           
                              (3.5)
                              
                                 
                                    (
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                          t
                                       
                                    
                                    ∣
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 ∼
                                 N
                                 
                                    (
                                    
                                       
                                          
                                             F
                                          
                                       
                                       
                                          i
                                          t
                                       
                                    
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                        ’s are independent Gamma random variables with shape 
                           η
                           /
                           2
                         and scale 
                           η
                           /
                           2
                        , denoted as 
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              ∣
                              η
                              )
                           
                           ∼
                           
                              Gamma
                           
                           
                              (
                              η
                              /
                              2
                              ,
                              η
                              /
                              2
                              )
                           
                        .

Under the above setup the Gibbs sampler of Section  2 can be easily modified. More specifically, now, in obtaining the full posterior conditional distributions of 
                           
                              
                                 Z
                              
                              
                                 i
                                 t
                              
                           
                        ’s, which are conditional on 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                        ’s, we use 
                           
                              
                                 
                                    (
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                          t
                                       
                                    
                                    ∣
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          t
                                       
                                    
                                    =
                                    1
                                    )
                                 
                                 ∼
                                 N
                                 
                                    (
                                    
                                       
                                          
                                             F
                                          
                                       
                                       
                                          i
                                          t
                                       
                                    
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 I
                                 
                                 
                                    (
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                          t
                                       
                                    
                                    >
                                    0
                                    )
                                 
                                 ,
                              
                           
                         and 
                           
                              
                                 
                                    (
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                          t
                                       
                                    
                                    ∣
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          t
                                       
                                    
                                    =
                                    0
                                    )
                                 
                                 ∼
                                 N
                                 
                                    (
                                    
                                       
                                          
                                             F
                                          
                                       
                                       
                                          i
                                          t
                                       
                                    
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 I
                                 
                                 
                                    (
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                          t
                                       
                                    
                                    ≤
                                    0
                                    )
                                 
                                 ,
                              
                           
                         for 
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                           ;
                           
                           i
                           =
                           1
                           ,
                           …
                           ,
                           M
                        .

The full conditional distribution of 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 t
                              
                           
                        ’s, now conditional on 
                           λ
                           =
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    M
                                 
                              
                              )
                           
                         as well, will be normal distributions with mean vector and covariance matrix (2.10) and (2.11), respectively, where 
                           
                              
                                 
                                    I
                                 
                              
                              
                                 M
                              
                           
                         is replaced by the 
                           M
                           ×
                           M
                         diagonal matrix 
                           
                              (3.6)
                              
                                 
                                    V
                                 
                                 =
                                 
                                    diag
                                 
                                 
                                    [
                                    1
                                    /
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    1
                                    /
                                    
                                       
                                          λ
                                       
                                       
                                          M
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                         The full conditional 
                           
                              
                                 
                                    W
                                 
                              
                              
                                 θ
                              
                           
                         will still be the Wishart distribution as in Section  2.

In obtaining the full conditional of 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                        ’s, we note that given 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 t
                              
                           
                        ’s and 
                           
                              (
                              T
                              ×
                              1
                              )
                           
                         vectors 
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 i
                              
                           
                           =
                           
                              (
                              
                                 
                                    Z
                                 
                                 
                                    i
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    i
                                    T
                                 
                              
                              )
                           
                           ,
                           
                           i
                           =
                           1
                           ,
                           …
                           ,
                           M
                           ,
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                        ’s are independent of each other. It can be easily shown that the full conditional of 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                         is given by the Gamma distribution 
                           
                              Gamma
                           
                           
                              (
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         where 
                           
                              (3.7)
                              
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    (
                                    η
                                    +
                                    T
                                    )
                                 
                                 /
                                 2
                                 
                                 and
                                 
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    [
                                    η
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                   t
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      F
                                                   
                                                
                                                
                                                   i
                                                   t
                                                
                                             
                                             
                                                
                                                   
                                                      θ
                                                   
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                         for 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           M
                        .

It is possible to learn about 
                           η
                         as discussed in Albert and Chib (1993). If we use a discrete prior for 
                           η
                        , say 
                           p
                           
                              (
                              η
                              )
                           
                        , then it can be easily shown that the full conditional posterior distribution of 
                           η
                         is proportional to the discrete distribution 
                           
                              (3.8)
                              
                                 p
                                 
                                    (
                                    η
                                    )
                                 
                                 
                                    
                                       
                                          
                                             
                                                (
                                                η
                                                /
                                                2
                                                )
                                             
                                          
                                          
                                             η
                                             /
                                             2
                                          
                                       
                                    
                                    
                                       Γ
                                       
                                          (
                                          η
                                          /
                                          2
                                          )
                                       
                                    
                                 
                                 
                                    
                                       ∏
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                    
                                       η
                                       /
                                       2
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       η
                                       /
                                       2
                                    
                                 
                                 .
                              
                           
                         The posterior distribution of 
                           η
                         enables us to infer about different link functions. For example, concentration of the posterior distribution at larger values of 
                           η
                         suggests the appropriateness of probit link. On the other hand, if it concentrates around degrees of freedom 8 or 9 then it suggests a logistic link function.

Note that alternatively, we can compute the marginal likelihood for different values of 
                           η
                         and compare different models. This will be discussed in Section  4.

As pointed by Kass and Raftery (1995), Bayesian model comparison/selection is made using Bayes factors which are obtained as the ratio of marginal likelihoods 
                        p
                        
                           (
                           D
                           ∣
                           i
                           )
                        
                      under two competing models 
                        i
                        =
                        1
                        ,
                        2
                     . In many problems 
                        p
                        
                           (
                           D
                           ∣
                           i
                           )
                        
                      is not available in an analytical form and its evaluation using posterior Monte Carlo samples is not a trivial task. Thus, various alternatives to marginal likelihoods have been suggested for model selection using Monte Carlo samples; see for example Gelfand (1996).

However, in certain problems where a Gibbs sampler is used and all the full conditional distributions are known, it is possible to approximate the marginal likelihoods from the posterior samples using a method introduced by Chib (1995). For example, Chib (1995) showed how marginal likelihood 
                        p
                        
                           (
                           D
                           ∣
                           i
                           )
                        
                      can be obtained for the static probit regression model 
                        i
                      with a given set of independent variables. In so doing, Chib (1995) used the data augmentation approach of Albert and Chib (1993) and discussed the computation of 
                        p
                        
                           (
                           D
                           ∣
                           i
                           )
                        
                      from the Gibbs sampler output. In what follows we will illustrate how the approach by Chib (1995) can be extended for the dynamic probit model and discuss how the approach can be used for Markov regression model order selection. Thus, we present a Bayesian approach for order selection in nonhomogeneous Markov chains which have not been considered by Sung et al. (2007).

Note that suppressing dependence on model 
                        i
                      the marginal likelihood for a particular model is expressed as 
                        
                           (4.1)
                           
                              p
                              
                                 (
                                 D
                                 )
                              
                              =
                              
                                 
                                    p
                                    
                                       (
                                       D
                                       ∣
                                       Θ
                                       )
                                    
                                    p
                                    
                                       (
                                       Θ
                                       )
                                    
                                 
                                 
                                    p
                                    
                                       (
                                       Θ
                                       ∣
                                       D
                                       )
                                    
                                 
                              
                              ,
                           
                        
                      where 
                        Θ
                      is a vector of parameters. As pointed out by Chib (1995) the above holds for any value of 
                        Θ
                     , say 
                        
                           
                              Θ
                           
                           
                              ∗
                           
                        
                     , and the value of posterior density 
                        p
                        
                           (
                           
                              
                                 Θ
                              
                              
                                 ∗
                              
                           
                           ∣
                           D
                           )
                        
                      can be estimated by 
                        
                           
                              p
                           
                           
                              ˆ
                           
                        
                        
                           (
                           
                              
                                 Θ
                              
                              
                                 ∗
                              
                           
                           ∣
                           D
                           )
                        
                      using Monte Carlo samples. Since 
                        p
                        
                           (
                           D
                           ∣
                           
                              
                                 Θ
                              
                              
                                 ∗
                              
                           
                           )
                        
                      and 
                        p
                        
                           (
                           
                              
                                 Θ
                              
                              
                                 ∗
                              
                           
                           )
                        
                      can be evaluated at 
                        
                           
                              Θ
                           
                           
                              ∗
                           
                        
                     , the log marginal likelihood can be estimated as 
                        
                           (4.2)
                           
                              ln
                              
                                 
                                    p
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 D
                                 )
                              
                              =
                              ln
                              p
                              
                                 (
                                 D
                                 ∣
                                 
                                    
                                       Θ
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                              
                              +
                              ln
                              p
                              
                                 (
                                 
                                    
                                       Θ
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                              
                              −
                              ln
                              
                                 
                                    p
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 
                                    
                                       Θ
                                    
                                    
                                       ∗
                                    
                                 
                                 ∣
                                 D
                                 )
                              
                              .
                           
                        
                      In evaluating (4.2), the only term which is not readily available is 
                        
                           
                              p
                           
                           
                              ˆ
                           
                        
                        
                           (
                           
                              
                                 Θ
                              
                              
                                 ∗
                              
                           
                           ∣
                           D
                           )
                        
                     , but as shown in Chib (1995) this can be obtained using the outputs from the Gibbs sampler.

In our case, we also have the latent variables 
                        
                           
                              
                                 Z
                              
                           
                           
                              T
                           
                        
                        =
                        
                           (
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 j
                              
                              
                                 T
                              
                           
                           ;
                           
                           j
                           =
                           1
                           ,
                           …
                           ,
                           M
                           )
                        
                      and the parameter vector 
                        Θ
                        =
                        
                           (
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 T
                              
                           
                           ,
                           
                              
                                 
                                    W
                                 
                              
                              
                                 θ
                              
                              
                                 −
                                 1
                              
                           
                           )
                        
                     . To estimate 
                        p
                        
                           (
                           
                              
                                 Θ
                              
                              
                                 ∗
                              
                           
                           ∣
                           D
                           )
                        
                      we need the full conditionals 
                        p
                        
                           (
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 T
                              
                           
                           ∣
                           Θ
                           ,
                           D
                           )
                        
                      and 
                        p
                        
                           (
                           Θ
                           ∣
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 T
                              
                           
                           ,
                           D
                           )
                        
                     , that are available to us. We can write 
                        
                           (4.3)
                           
                              p
                              
                                 (
                                 
                                    
                                       Θ
                                    
                                    
                                       ∗
                                    
                                 
                                 ∣
                                 D
                                 )
                              
                              =
                              ∫
                              p
                              
                                 (
                                 
                                    
                                       Θ
                                    
                                    
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 D
                                 )
                              
                              p
                              
                                 (
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ∣
                                 D
                                 )
                              
                              d
                              
                                 
                                    
                                       Z
                                    
                                 
                                 
                                    T
                                 
                              
                              ,
                           
                        
                      and note that we have samples available from 
                        p
                        
                           (
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 T
                              
                           
                           ∣
                           D
                           )
                        
                      via the Gibbs sampler. Thus, (4.3) can be approximated as 
                        
                           (4.4)
                           
                              p
                              
                                 (
                                 
                                    
                                       Θ
                                    
                                    
                                       ∗
                                    
                                 
                                 ∣
                                 D
                                 )
                              
                              ≈
                              
                                 
                                    1
                                 
                                 
                                    G
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    g
                                    =
                                    1
                                 
                                 
                                    G
                                 
                              
                              p
                              
                                 (
                                 
                                    
                                       Θ
                                    
                                    
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   Z
                                                
                                             
                                             
                                                T
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          (
                                          g
                                          )
                                       
                                    
                                 
                                 ,
                                 D
                                 )
                              
                              ,
                           
                        
                      where 
                        
                           
                              
                                 (
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                           
                           
                              
                                 (
                                 g
                                 )
                              
                           
                        
                      are samples from the posterior distribution 
                        p
                        
                           (
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 T
                              
                           
                           ∣
                           D
                           )
                        
                     . Note that 
                        p
                        
                           (
                           
                              
                                 Θ
                              
                              
                                 ∗
                              
                           
                           ∣
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 T
                              
                           
                           ,
                           D
                           )
                        
                      can be written as 
                        
                           (4.5)
                           
                              p
                              
                                 (
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          W
                                       
                                    
                                    
                                       θ
                                    
                                    
                                       −
                                       1
                                       ∗
                                    
                                 
                                 )
                              
                              p
                              
                                 (
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       T
                                       −
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                    
                                       Z
                                    
                                    
                                       T
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          W
                                       
                                    
                                    
                                       θ
                                    
                                    
                                       −
                                       1
                                       ∗
                                    
                                 
                                 )
                              
                              ⋯
                              p
                              
                                 (
                                 
                                    
                                       
                                          W
                                       
                                    
                                    
                                       θ
                                    
                                    
                                       −
                                       1
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              .
                           
                        
                      In (4.5) all terms are immediately available except the last one, that is, 
                        p
                        
                           (
                           
                              
                                 
                                    W
                                 
                              
                              
                                 θ
                              
                              
                                 −
                                 1
                                 ∗
                              
                           
                           ∣
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 T
                              
                           
                           )
                        
                     . We can obtain this term as 
                        
                           (4.6)
                           
                              p
                              
                                 (
                                 
                                    
                                       
                                          W
                                       
                                    
                                    
                                       θ
                                    
                                    
                                       −
                                       1
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              =
                              ∫
                              p
                              
                                 (
                                 
                                    
                                       
                                          W
                                       
                                    
                                    
                                       θ
                                    
                                    
                                       −
                                       1
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              p
                              
                                 (
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              d
                              
                                 
                                    
                                       Z
                                    
                                 
                                 
                                    T
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              
                                 θ
                              
                           
                           
                              T
                           
                        
                        =
                        
                           (
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 T
                              
                           
                           )
                        
                     . The above can be approximated as 
                        
                           (4.7)
                           
                              p
                              
                                 (
                                 
                                    
                                       
                                          W
                                       
                                    
                                    
                                       θ
                                    
                                    
                                       −
                                       1
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              ≈
                              
                                 
                                    1
                                 
                                 
                                    G
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    g
                                    =
                                    1
                                 
                                 
                                    G
                                 
                              
                              p
                              
                                 (
                                 
                                    
                                       
                                          W
                                       
                                    
                                    
                                       θ
                                    
                                    
                                       −
                                       1
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       1
                                    
                                    
                                       
                                          (
                                          g
                                          )
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       T
                                    
                                    
                                       
                                          (
                                          g
                                          )
                                       
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      where 
                        
                           
                              
                                 θ
                              
                           
                           
                              1
                           
                           
                              
                                 (
                                 g
                                 )
                              
                           
                        
                        ,
                        …
                        ,
                        
                           
                              
                                 θ
                              
                           
                           
                              T
                           
                           
                              
                                 (
                                 g
                                 )
                              
                           
                        
                      are samples from the posterior 
                        p
                        
                           (
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 T
                              
                           
                           ∣
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 T
                              
                           
                           )
                        
                     . Note that 
                        p
                        
                           (
                           
                              
                                 
                                    W
                                 
                              
                              
                                 θ
                              
                              
                                 −
                                 1
                                 ∗
                              
                           
                           ∣
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 T
                              
                           
                           )
                        
                      is the full conditional which is a Wishart density.

Thus, all components of (4.2) are now available and we can evaluate 
                        ln
                        
                           
                              p
                           
                           
                              ˆ
                           
                        
                        
                           (
                           D
                           )
                        
                      for a given model as reflected by the order of the Markov process and/or by the variables included in (3.1).

The marginal likelihood computation can be easily adopted for the Student-
                        t
                      link function case considered in Section  3.2. In fact, 
                        ln
                        
                           
                              p
                           
                           
                              ˆ
                           
                        
                        
                           (
                           D
                           )
                        
                      can be computed for different degrees of freedom values, 
                        η
                     . In this case, the only additional number of parameters is 
                        
                           λ
                        
                        =
                        
                           (
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 λ
                              
                              
                                 M
                              
                           
                           )
                        
                     , that is, we have 
                        Θ
                        =
                        
                           (
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 T
                              
                           
                           ,
                           
                              λ
                           
                           ,
                           
                              
                                 
                                    W
                                 
                              
                              
                                 θ
                              
                              
                                 −
                                 1
                              
                           
                           )
                        
                     . Thus, (4.5) will be given by 
                        
                           (4.8)
                           
                              p
                              
                                 (
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          λ
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          W
                                       
                                    
                                    
                                       θ
                                    
                                    
                                       −
                                       1
                                       ∗
                                    
                                 
                                 )
                              
                              ⋯
                              p
                              
                                 (
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       2
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          λ
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          W
                                       
                                    
                                    
                                       θ
                                    
                                    
                                       −
                                       1
                                       ∗
                                    
                                 
                                 )
                              
                              p
                              
                                 (
                                 
                                    
                                       
                                          W
                                       
                                    
                                    
                                       θ
                                    
                                    
                                       −
                                       1
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              p
                              
                                 (
                                 
                                    
                                       
                                          λ
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      where the first 
                        T
                      terms of 
                        
                           
                              
                                 θ
                              
                           
                           
                              T
                           
                           
                              ∗
                           
                        
                     ’s will still be available as normal densities, 
                        p
                        
                           (
                           
                              
                                 
                                    W
                                 
                              
                              
                                 θ
                              
                              
                                 −
                                 1
                                 ∗
                              
                           
                           ∣
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 T
                              
                           
                           )
                        
                      can still be obtained via (4.7). In order to evaluate 
                        p
                        
                           (
                           
                              
                                 
                                    λ
                                 
                              
                              
                                 ∗
                              
                           
                           ∣
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 T
                              
                           
                           )
                        
                      we can use 
                        
                           (4.9)
                           
                              p
                              
                                 (
                                 
                                    
                                       
                                          λ
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              =
                              ∫
                              p
                              
                                 (
                                 
                                    
                                       
                                          λ
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              p
                              
                                 (
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              d
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    T
                                 
                              
                              ,
                           
                        
                      which reduces to 
                        
                           (4.10)
                           
                              p
                              
                                 (
                                 
                                    
                                       
                                          λ
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              =
                              ∫
                              
                                 
                                    ∏
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    M
                                 
                              
                              p
                              
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                    
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              p
                              
                                 (
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              d
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    T
                                 
                              
                              ,
                           
                        
                      where 
                        p
                        
                           (
                           
                              
                                 λ
                              
                              
                                 i
                              
                              
                                 ∗
                              
                           
                           ∣
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 T
                              
                           
                           )
                        
                      is a Gamma density with parameters 
                        
                           
                              a
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              b
                           
                           
                              i
                           
                        
                      given by (3.7). Note that (4.10) can be approximated as 
                        
                           (4.11)
                           
                              p
                              
                                 (
                                 
                                    
                                       
                                          λ
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              ≈
                              
                                 
                                    ∏
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    M
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    G
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    g
                                    =
                                    1
                                 
                                 
                                    G
                                 
                              
                              p
                              
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                    
                                       ∗
                                    
                                 
                                 ∣
                                 
                                    
                                       
                                          Z
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       1
                                    
                                    
                                       
                                          (
                                          g
                                          )
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       T
                                    
                                    
                                       
                                          (
                                          g
                                          )
                                       
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      where 
                        
                           
                              
                                 θ
                              
                           
                           
                              1
                           
                           
                              
                                 (
                                 g
                                 )
                              
                           
                        
                        ,
                        …
                        ,
                        
                           
                              
                                 θ
                              
                           
                           
                              T
                           
                           
                              
                                 (
                                 g
                                 )
                              
                           
                        
                      are samples from the posterior distribution 
                        p
                        
                           (
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 T
                              
                           
                           ∣
                           
                              
                                 
                                    Z
                                 
                              
                              
                                 T
                              
                           
                           )
                        
                      as before.

As pointed out by one of the reviewers, an alternative way of estimating the marginal likelihood (4.1) using Chib’s (1995) approach is to marginalize over the state variables. In this case, the term 
                        p
                        
                           (
                           
                              
                                 Θ
                              
                              
                                 ∗
                              
                           
                           ∣
                           D
                           )
                        
                      in the denominator of (4.1) will not depend on the values of 
                        
                           
                              
                                 θ
                              
                           
                           
                              t
                           
                        
                     ’s. Since we do not have a Gaussian likelihood, this would require computation of the likelihood of the model by the particle filtering methods. Even though this might lead to a more efficient estimate of the marginal likelihood, it is not obvious in our problem that the Monte Carlo error accumulated by the particle filter would be small. This would require further investigation which is outside the scope of our paper.

Implementation of the proposed exact Gibbs sampler for the dynamic probit models and the order selection approach are illustrated using real life longitudinal data in Section  5.

In this section, dynamic probit model and Markov regression model representations, discussed in previous sections, are applied to real data from the Great Smoky Mountains Study (GSMS) (Costello et al., 1996), which is a population based study of youth from western North Carolina counties. The data consists of 
                        M
                        =
                        257
                      subjects who entered the study at age 11 for six annual waves. The binary response variable 
                        
                           
                              X
                           
                           
                              i
                              t
                           
                        
                      takes the value 1 if the 
                        i
                     -th subject reported any use of substances including tobacco, alcohol, and other drugs in the last 3 months of interview conducted yearly around the subject’s birthday for 
                        t
                        =
                        1
                        ,
                        …
                        ,
                        6
                     . Our primary concern here is to assess the gender difference on the progression of substance use over a span of six years.

We consider two classes of models in analyzing the data. More specifically, we use probit and Markov regression models to analyze the data. In so doing, in both cases we consider dynamic and static versions of these models and compare their performances.

In the dynamic probit model for the probability of substance use at time 
                           t
                         we specify 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 i
                                 t
                              
                           
                           =
                           
                              (
                              1
                              
                              
                                 
                                    
                                       Sex
                                    
                                 
                                 
                                    i
                                 
                              
                              
                              
                                 
                                    
                                       Age
                                    
                                 
                                 
                                    i
                                    t
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                          t
                                       
                                    
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          2
                                          t
                                       
                                    
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          3
                                          t
                                       
                                    
                                    )
                                 
                              
                              
                                 ′
                              
                           
                        . In the model, 
                           
                              
                                 θ
                              
                              
                                 2
                                 t
                              
                           
                         and 
                           
                              
                                 θ
                              
                              
                                 3
                                 t
                              
                           
                         represent the effect of sex (coded 1 for male and 0 otherwise) and age, respectively, on the probability of substance use. In the case of the static probit model, we set 
                           
                              
                                 
                                    W
                                 
                              
                              
                                 θ
                              
                           
                           =
                           
                              0
                           
                         in (1.3) and obtain 
                           
                              
                                 θ
                              
                              
                                 t
                              
                           
                           =
                           θ
                         for all 
                           t
                        . Thus, in the static model, we have 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                       
                                    
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                              
                              
                                 ′
                              
                           
                         for all 
                           t
                        .

In the dynamic probit model, we set the prior mean and variance matrix of 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 0
                              
                           
                         in standard DLM, 
                           
                              
                                 
                                    m
                                 
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 
                                    (
                                    0
                                    ,
                                    …
                                    ,
                                    0
                                    )
                                 
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 
                                    C
                                 
                              
                              
                                 0
                              
                           
                           =
                           
                              diag
                           
                           
                              (
                              10
                              ,
                              …
                              ,
                              10
                              )
                           
                         whose dimensions are 
                           K
                           ×
                           1
                         and 
                           K
                           ×
                           K
                         respectively. The Wishart prior on 
                           
                              
                                 
                                    W
                                 
                              
                              
                                 θ
                              
                              
                                 −
                                 1
                              
                           
                         has 
                           r
                           =
                           K
                         degrees of freedom and 
                           R
                           =
                           
                              diag
                           
                           
                              (
                              0.1
                              ,
                              …
                              ,
                              0.1
                              )
                           
                         is of 
                           K
                           ×
                           K
                         dimension. Note that in our case 
                           K
                           =
                           3
                        .

Both the dynamic and static models were estimated using the approach presented in Section  2. The approach was implemented in R version 2.12.1 (2005). The inferences were made based on 50,000 posterior samples after 5000 burn-in iterations.


                        Table 1
                         presents the summary statistics for posterior distributions of the mean of continuous latent variable 
                           
                              
                                 Z
                              
                              
                                 i
                                 t
                              
                           
                         that is, 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 i
                                 t
                              
                           
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 t
                              
                           
                        , for the dynamic probit model. While the posterior mean values are higher in general for boys than girls except for 
                           t
                           =
                           4
                           –
                           5
                         (ages 14 and 15), the values are increasing with time thus resulting in a higher probability of using substances for higher ages.

The posterior distributions of 
                           
                              
                                 π
                              
                              
                                 i
                                 t
                              
                           
                        ’s for the dynamic probit model are illustrated in Fig. 1
                        . As indicated in Table 1, the risk of using substances increased with age but the rate of increase showed quite different pattern before and after 
                           t
                           =
                           5
                         (age 15). In comparison between boys and girls, boys had higher risk than girls overall except ages 14 and 15. When the actual data were overlaid on top of box plots of posterior distributions for 
                           
                              
                                 π
                              
                              
                                 i
                                 t
                              
                           
                        ’s, we can visually see that the posterior distributions quite well represent actual patterns of probability over time for both boys and girls. However, as illustrated in Fig. 2
                         where the patterns of 
                           
                              
                                 π
                              
                              
                                 i
                                 t
                              
                           
                        ’s, are monotonic, the fit of the static model to the actual data did not seem to be as good as that of the dynamic model. Later in this section the static and dynamic models will be compared using Bayes factors.

We next consider dynamic and static forms of the Markov regression models. More specifically, we consider a first order dynamic Markov model with 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 i
                                 t
                              
                           
                           =
                           
                              (
                              1
                              
                              
                                 
                                    
                                       Sex
                                    
                                 
                                 
                                    i
                                 
                              
                              
                              
                                 
                                    
                                       Age
                                    
                                 
                                 
                                    i
                                    t
                                 
                              
                              
                              
                                 
                                    X
                                 
                                 
                                    i
                                    ,
                                    t
                                    −
                                    1
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                          t
                                       
                                    
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          2
                                          t
                                       
                                    
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          3
                                          t
                                       
                                    
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          4
                                          t
                                       
                                    
                                    )
                                 
                              
                              
                                 ′
                              
                           
                         where the sex and age effects are defined the same as before. In this case 
                           
                              
                                 θ
                              
                              
                                 4
                                 t
                              
                           
                         represents the dependence of current substance use, 
                           
                              
                                 X
                              
                              
                                 i
                                 t
                              
                           
                        , on past substance use 
                           
                              
                                 X
                              
                              
                                 i
                                 ,
                                 t
                                 −
                                 1
                              
                           
                        . The static first order Markov regression model is similarly defined as 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 i
                                 t
                              
                           
                           =
                           
                              (
                              1
                              
                              
                                 
                                    
                                       Sex
                                    
                                 
                                 
                                    i
                                 
                              
                              
                              
                                 
                                    
                                       Age
                                    
                                 
                                 
                                    i
                                    t
                                 
                              
                              
                              
                                 
                                    X
                                 
                                 
                                    i
                                    ,
                                    t
                                    −
                                    1
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                       
                                    
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          3
                                       
                                    
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          4
                                       
                                    
                                    )
                                 
                              
                              
                                 ′
                              
                           
                        .


                        Fig. 3
                         illustrates how the transition probabilities change over time given the previous status of substance use. For illustrational purposes, only the results for boys are presented. The posterior mean of transition probabilities over time given no previous substance use (state 0) is represented by a solid line and the transition probabilities given previous substance use (state 1) is represented by a dashed line. Dotted lines show 95% posterior credible intervals for each group. We can infer that while the probability of using substances is considerably higher for the group of previous users than nonusers, the risk is increasing with age.


                        Fig. 4
                         compares transition probabilities of using substances for previous users and nonusers using the static Markov regression model. Again, we just show the results for boys. As in the dynamic Markov regression model, the risk of using substances increases with age and the previous substance use. However, the model shows more of a monotonic increase in risk by age and does not show the dynamic change of effect of age on the risk of substance use.

To implement a dynamic model with 
                           t
                        -distribution link function, we assume that the prior for the scale parameter 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                         in (3.5) follows a Gamma distribution with shape 
                           η
                           /
                           2
                         and scale 
                           η
                           /
                           2
                         parameters. The prior for degrees of freedom 
                           η
                         is assumed to follow a uniform discrete distribution with a finite set {4, 8, 16}. The mode of the posterior degrees of freedom was at the largest value 16. We also fitted several models of the 
                           t
                        -distribution link function with specified degrees of freedom of 4, 8, and 16. Posterior means of the probability of substance use are compared to those from the probit link model in Fig. 5
                        . For ease of comparison, the posterior means of probabilities are transformed into logit and the differences in the logits between 
                           t
                        -link and probit models against probit model probabilities are shown in Fig. 5. The differences between 
                           t
                        -link with 4 degrees of freedom are marked with a square for given probit probabilities. Similarly, circle and triangle are used for 
                           t
                        -link with 8 degrees of freedom and with 16 degrees of freedom respectively. As we can see from the figure, as expected, the 
                           t
                        -link with small values of degrees of freedom has larger absolute differences from the probit model than the model with high values of degrees of freedom.

The mixing of the sampling algorithm developed in the present study is evaluated by the simulation inefficiency factors (SIF) as used in Kim et al. (1998). SIF is estimated as the variance of the sample mean divided by the variance of the sample mean from a hypothetical sampler that draws independent random observations from the posterior distribution. (See Meyer and Yu, 2000 for the computation of SIF.) SIF is interpreted as the number of successive iterations needed to obtain near independent draws, thus lower is better. Table 2
                         shows SIF’s for the parameter of sex effect, 
                           
                              
                                 θ
                              
                              
                                 2
                                 t
                              
                           
                         for 
                           t
                           =
                           1
                           ,
                           …
                           ,
                           6
                        , and 
                           1
                           j
                        -th entry of 
                           
                              
                                 
                                    W
                                 
                              
                              
                                 θ
                              
                              
                                 −
                                 1
                              
                           
                         matrix for 
                           j
                           =
                           1
                           ,
                           2
                           ,
                           3
                        . Overall SIF values are small and indicate that the chains mix well. Static models show better mixing than dynamic models. Models with a 
                           t
                        -link function are less efficient than probit models for posterior sampling. The values of SIF for other parameters also showed similar patterns indicating fast mixing.

Then, sensitivity analysis was conducted to evaluate the effects of different priors on the posterior inferences of parameters. We consider the two different priors for prior mean and variance matrix 
                           
                              
                                 
                                    m
                                 
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 
                                    C
                                 
                              
                              
                                 0
                              
                           
                        , and the Wishart prior 
                           
                              R
                           
                        . 
                           
                              Prior 1:
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             0
                                             ,
                                             …
                                             ,
                                             0
                                             )
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             C
                                          
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       diag
                                    
                                    
                                       (
                                       10
                                       ,
                                       …
                                       ,
                                       10
                                       )
                                    
                                    ,
                                    R
                                    =
                                    
                                       diag
                                    
                                    
                                       (
                                       0.1
                                       ,
                                       …
                                       ,
                                       0.1
                                       )
                                    
                                 .


                                 
                                    
                                       
                                          
                                             m
                                          
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             0.5
                                             ,
                                             …
                                             ,
                                             0.5
                                             )
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             C
                                          
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       diag
                                    
                                    
                                       (
                                       20
                                       ,
                                       …
                                       ,
                                       20
                                       )
                                    
                                    ,
                                    R
                                    =
                                    
                                       diag
                                    
                                    
                                       (
                                       0.05
                                       ,
                                       …
                                       ,
                                       0.05
                                       )
                                    
                                 .

We computed marginal likelihoods 
                           ln
                           
                              
                                 p
                              
                              
                                 ˆ
                              
                           
                           
                              (
                              D
                              ∣
                              
                                 
                                    
                                       Model
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         using our development in Section  4 to obtain Bayes factors among the proposed models. The estimated marginal likelihoods for the static and dynamic models are shown Table 4
                        . We note that the log of the Bayes factor in favor of dynamic probit model is around 37.3 implying very strong support for the dynamic model.

Such a comparison was also made using the first order Markov regression models. This is shown in Table 5
                        . Again we see from the table that the dynamic Markov regression model is supported very strongly by the data as implied by the Bayes factor of 336.97 to 1 in favor of the dynamic model against the static model.

Furthermore, if we compare Tables 4 and 5, we note that the inclusion of the previous period’s substance use in the Markov regression model improves the model fit relative to the dynamic probit model.

For comparison of the dynamic probit model with 
                           t
                        -link function, 
                           Φ
                           
                              (
                              
                                 
                                    
                                       F
                                    
                                 
                                 
                                    i
                                    t
                                 
                              
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    t
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                         in (2.2) was replaced with 
                           T
                           
                              (
                              
                                 
                                    
                                       F
                                    
                                 
                                 
                                    i
                                    t
                                 
                              
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    t
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                         with 
                           η
                         degrees of freedom. We considered dynamic models with degrees of freedom 
                           η
                           =
                           
                              {
                              4
                              ,
                              8
                              ,
                              16
                              ,
                              64
                              ,
                              200
                              }
                           
                         and obtained the marginal likelihoods. These are shown in Table 6
                        . As can be seen from the table, the model with 
                           η
                           =
                           200
                         degrees of freedom had the most support of the data. We note that as the degree of freedom 
                           η
                         becomes large, the log likelihood is getting closer to the value of −840.79 of the probit dynamic model in Table 4. Thus, our analysis suggests that the dynamic probit model is more appropriate for the data than the dynamic models with 
                           t
                        -link functions. For example, the log Bayes factors in favor of the dynamic probit model against the dynamic logistic (that is, 
                           η
                           =
                           8
                        ) is about 61.75.

In this paper, we presented an exact Gibbs sampler for Bayesian analysis of the models using the data augmentation approach of Albert and Chib (1993) and the forward filtering backward sampling algorithm of Fruhwirth-Schnatter (1994) for dynamic linear models. We discussed how the marginal likelihoods of these models can be approximated using the approach of Chib (1995). As extensions, we considered Markov regression models where the previous states were given, and estimated transition probabilities. In addition, we generalized the dynamic probit model with 
                        t
                     -distribution link function. The models were implemented using real binary data on substance use over time. The models were compared using marginal likelihoods computed from the posterior samples. Our analysis showed that while dynamic models had a better fit than the static models, the dynamic probit models performed a lot better than the dynamic models 
                        t
                     -distribution link functions.

@&#ACKNOWLEDGMENTS@&#

Refik Soyer’s research was supported by the National Science Foundation under Grant DMS-0915156 with the George Washington University. Minje Sung’s work was supported by a faculty research fund from Ajou University.

@&#REFERENCES@&#

