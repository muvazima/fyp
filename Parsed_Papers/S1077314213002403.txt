@&#MAIN-TITLE@&#Efficient and robust multi-template tracking using multi-start interactive hybrid search

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present an efficient and robust multi-template based visual object tracking method.


                        
                        
                           
                           The target is represented by two heterogeneous time-varying templates using Gaussian functions.


                        
                        
                           
                           The template is adaptively updated so that it can address both short- and long-term appearance variations.


                        
                        
                           
                           Target is located by an interactive multi-start hybrid search.


                        
                        
                           
                           Localization method consists of a sampling- and gradient-based algorithm in a unified probabilistic framework.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Adaptive template

Gaussian-based appearance model

Multi-model representation

Parallel optimization

Non-rigid object

@&#ABSTRACT@&#


               
               
                  This paper presents an efficient, accurate, and robust template-based visual tracker. In this method, the target is represented by two heterogeneous and adaptive Gaussian-based templates which can model both short- and long-term changes in the target appearance. The proposed localization algorithm features an interactive multi-start optimization process that takes into account generic transformations using a combination of sampling- and gradient-based techniques in a unified probabilistic framework. Both the short- and long-term templates are used to find the best location of the target, simultaneously. This approach further increased both the efficiency and accuracy of the proposed tracker. The contributions of the proposed tracking method include: (1) Flexible multi-model target representation which in general can accurately and robustly handle challenging situations such as significant appearance and shape changes, (2) Robust template updating algorithm where a combination of tracking time step, a forgetting factor, and an uncertainty margin are used to update the mean and variance of the Gaussian functions, and (3) Efficient and interactive multi-start optimization which can improve the accuracy, robustness, and efficiency of the target localization by parallel searching in different time-varying templates. Several challenging and publicly available videos have been used to both demonstrate and quantify the superiority of the proposed tracking method in comparison with other state-of-the-art trackers.
               
            

@&#INTRODUCTION@&#

Efficiency and reliability of many computer vision applications such as automated visual surveillance systems [1], motion analysis and activity recognition [2,3], vehicle navigation and tracking [4], and intelligent preventive safety systems [5] highly depend on their visual object tracking algorithm. In spite of extensive research, object tracking is still challenging generally due to the inevitable object appearance changes, scale variations, different lighting conditions, noise and outliers, complex motion, and cluttered environments. Specifically, the main difficulty in tracking non-rigid objects – which has been emphasized in this work – is related to the high dimensional complexity and uncertainty in real-world applications [6].

In its simplest form, visual tracking can be viewed as the problem of locating and corresponding one or more image regions to a specific object in an image sequence. Visual trackers are roughly classified as either direct (image-based) methods or indirect (feature-based) methods. In the latter approach, different feature descriptors including silhouette [7], contour [8], texture [9], local invariant features [10], Haar-like features [11], and histograms [12,13] are used to model the object appearance. Feature descriptors can – to some degree – handle illumination changes, scale and appearance variations, and outliers. However, their suitability and robustness may significantly change from one application to another depending on the appropriateness of the feature descriptors used. Moreover, those descriptors such as SIFT [10], which can suitably handle the object non-rigidity and scale variations in many cases, are hampered in real-world applications due to the high computational cost of feature extraction and matching algorithms. On the other hand, in direct methods, the object appearance is modeled by one or more sub-images, known as templates, which consist of the image pixel values. Object regions are composed of both appearance and spatial information so that direct methods can track objects more accurately and robustly.

Template matching is a well-studied computer vision problem which has been introduced by [14] for the task of visual tracking. In this method, the target region is considered as the template 
                        
                           T
                           (
                           X
                           )
                        
                      where 
                        
                           X
                           =
                           (
                           x
                           ,
                           y
                           )
                        
                      is the pixel coordinate, and the goal is to find the best corresponding match in the next image 
                        
                           
                              
                                 I
                              
                              
                                 n
                              
                           
                        
                      based on the target dynamical model 
                        
                           W
                           (
                           X
                           ;
                           Θ
                           )
                        
                      where 
                        
                           Θ
                           =
                           {
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 θ
                              
                              
                                 k
                              
                           
                           }
                        
                      are the template transformation parameters. By minimizing the equation:
                        
                           (1)
                           
                              
                                 
                                    Θ
                                 
                                 
                                    n
                                 
                              
                              =
                              arg
                              
                                 
                                    
                                       min
                                    
                                    
                                       Θ
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       X
                                       ∈
                                       T
                                    
                                 
                              
                              
                                 
                                    [
                                    
                                       
                                          I
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    W
                                    (
                                    X
                                    ;
                                    Θ
                                    )
                                    )
                                    -
                                    T
                                    (
                                    X
                                    )
                                    ]
                                 
                                 
                                    2
                                 
                              
                           
                        
                     which is the sum of squared differences (SSD) between the template 
                        
                           T
                           (
                           X
                           )
                        
                      and the candidate sub-image 
                        
                           
                              
                                 I
                              
                              
                                 n
                              
                           
                           (
                           W
                           (
                           X
                           ;
                           Θ
                           )
                           )
                        
                      we can find the best match transformation parameters 
                        
                           
                              
                                 Θ
                              
                              
                                 n
                              
                           
                        
                     . A gradient-based algorithm to optimize Eq. (1) was introduced in [14]. However, conventional template trackers are not generally robust to significant appearance and scale variations, occlusion, and illumination changes.

To address the shortcomings of template matching, in this paper a robust template tracking method based on the Sum of Gaussian Errors (SGE) between the object template and the candidate sub-image is proposed. The object template is modeled by several Gaussian functions which are adaptively updated to handle both the object appearance changes and the “drift” problem.
                        1
                        The problem of gradually updating the object appearance model with irrelevant information such as background pixel values [15].
                     
                     
                        1
                      At every tracking step, a certain number of probabilistic optimization processes with different starting points are performed in parallel to estimate the object location. The proposed method is capable of tracking non-rigid objects with variable appearance, shape, and scale in cluttered environments. It is assumed that the object location is specified either manually or automatically (by any existing object detection method) at the beginning and the main goal is to track the object without any prior knowledge about the object appearance and motion dynamic.

The rest of this paper is organized as follows. Related work is reviewed in Section 2. In Section 3, the proposed multi-model target representation is defined. The formulation and algorithm of the proposed multi-start Gaussian-based template tracking method are explained in details in Section 4. In Section 5, the proposed tracker is applied on five challenging image sequences and subsequently the results are compared with four state-of-the-art methods as well as the ground truth data. Concluding discussions and potential extensions for future work will be provided in Section 6.

@&#RELATED WORK@&#

Since early template-based tracking methods [14], different algorithms have been proposed to improve the accuracy and efficiency of the tracking; Bergen et al. [16] used a more general motion model e.g., affine transformation, Black and Jepson [17] improved the robustness of the template matching against appearance changes by employing a linear appearance variation, Hager and Belhumeur [18] increased the tracking efficiency by a real-time implementation, and Cootes et al. [19] modeled the object appearance by Active Appearance Models (AAMs) to handle non-rigid objects. Matthews et al. [15] proposed a method based on an adaptive appearance template which does not suffer from the “drift” problem. Instead of using previous update strategies which involve either no update (
                        
                           
                              
                                 T
                              
                              
                                 n
                                 +
                                 1
                              
                           
                           =
                           
                              
                                 T
                              
                              
                                 1
                              
                           
                        
                      for all 
                        
                           n
                           ⩾
                           1
                        
                     ) or a naive template update (
                        
                           
                              
                                 T
                              
                              
                                 n
                                 +
                                 1
                              
                           
                           =
                           
                              
                                 I
                              
                              
                                 n
                              
                           
                           (
                           W
                           (
                           X
                           ;
                           
                              
                                 Θ
                              
                              
                                 n
                              
                           
                           )
                           )
                        
                      for all 
                        
                           n
                           ⩾
                           1
                        
                     ), they first estimate new transformation parameters 
                        
                           
                              
                                 Θ
                              
                              
                                 n
                                 +
                                 1
                              
                           
                        
                      based on the naive template update, and then the estimated parameters are used as a starting point to align template 
                        
                           
                              
                                 T
                              
                              
                                 n
                                 +
                                 1
                              
                           
                        
                      with 
                        
                           
                              
                                 T
                              
                              
                                 1
                              
                           
                        
                     . This method is relatively stable to the local minimum by reinitializing the gradient-based search. However, the method proposed in [15] cannot handle the occlusion and outliers, and it also fails when tracks non-rigid objects, especially when the object shape is changing over time. Schreiber [20] presented a robust template matching algorithm to handle partial occlusion and outliers. Unlike other robust template trackers such as [18,21], in this method the robust weights are adaptively updated only after finding the transformation parameters for a new image to improve the computational efficiency. However, according to the experimental results, this method is mainly robust to track rigid objects under different lighting conditions and partial occlusion. Silveira and Malis [22] used several image transformation models to improve the template-based tracking performance against illumination changes. They proposed a new illumination model which can be used to track a deformable target with illumination change. In this method, a general image formation model which covers both geometric and photometric deformations is defined to track a rigid or deformable object. Although the proposed method is robust to illumination change and general object deformation, it cannot handle large and unpredicted pose and appearance changes due to the gradient-based optimization and a large number of parameters estimated. Also this method is not stable when the target image is not sufficiently textured and unable to track non-rigid objects with variant shape and structure.

Recently Firouzi and Najjaran [23] presented a component-based template tracking method using a multi-start EM-like localization algorithm. Building on their ideas, this paper describes an overhaul of the approach in [23] to improve its performance and robustness for real-time applications. The contributions and differences of the present work in comparison with the work published in [23] include:
                        
                           •
                           
                              Target representation model: In the method presented in [23], the image region of the target object is initially partitioned into several sub-regions, and subsequently each sub-region is represented by two Gaussian-based templates namely immediate and delayed templates. Similarly, the proposed representation model consists of two time-varying templates which can model both short-term and long-term changes in the target appearance. However, other appearance models such as Local Binary Pattern (i.e., a texture descriptor insensible to illumination changes) can be efficiently integrated into the proposed multi-model target representation which is not possible in [23]. Considering the structural differences, the current target model can be customized suitably to obtain a more satisfactory result in comparison with the model presented in [23].


                              Representation model learning: The mean and variance of the templates used in [23] are updated separately based on an updating ratio and the tracking time step, respectively. On the other hand, both the mean and variance of the templates in the current work are adaptively updated based on a forgetting factor, uncertainty margin, and the tracking time step. Therefore, in comparison with the method presented in [23] the proposed template update strategy is not only more adaptive to new appearance changes because of the use of a forgetting factor and the tracking time step, but also more robust against noise and occlusion due to the uncertainty margin used in the learning algorithm.


                              Target localization algorithm: The method presented in [23] uses a predefined multi-start Gradient-based search to estimate the preliminary location of the target sub-regions based on a translational transformation and immediate template. Consequently, the delayed template is employed to correct the preliminary estimation. At the end of this two-step optimization, the target is tracked by fusion of the new sub-region locations. In contrast, the target localization in the current work features an interactive multi-start hybrid search that takes into account generic transformations using a combination of sampling- and gradient-based algorithms in a unified probabilistic framework. Unlike the two-step optimization used in [23], in the current method all appearance models (i.e., the short- and long-term templates) are used to find the best location of the target, simultaneously. This approach further increased both the efficiency and accuracy of the proposed tracker.

In the proposed method, the object appearance is represented by two adaptive templates
                        2
                        In general, the proposed representation model can be composed of several appearance models such as different time-varying temples.
                     
                     
                        2
                      called short-term (
                        
                           
                              
                                 T
                              
                              
                                 S
                              
                           
                        
                     ) and long-term (
                        
                           
                              
                                 T
                              
                              
                                 L
                              
                           
                        
                     ) templates. Every point 
                        
                           X
                           =
                           {
                           x
                           ,
                           y
                           }
                        
                      inside each template is modeled by a Gaussian function 
                        
                           
                              
                                 G
                              
                              
                                 k
                                 (
                                 X
                                 )
                              
                           
                           ∼
                           N
                           (
                           
                              
                                 μ
                              
                              
                                 k
                                 (
                                 X
                                 )
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 k
                                 (
                                 X
                                 )
                              
                           
                           )
                        
                      where 
                        
                           
                              
                                 μ
                              
                              
                                 k
                                 (
                                 X
                                 )
                              
                           
                        
                      and 
                        
                           
                              
                                 σ
                              
                              
                                 k
                                 (
                                 X
                                 )
                              
                           
                        
                      are the mean and variance of the point X at time step k respectively. Also a 5-DOF
                        3
                        Degree of freedom.
                     
                     
                        3
                      transformation function:
                        
                           (2)
                           
                              W
                              (
                              X
                              ;
                              Θ
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                cos
                                                (
                                                β
                                                )
                                             
                                             
                                                -
                                                sin
                                                (
                                                β
                                                )
                                             
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                sin
                                                (
                                                β
                                                )
                                             
                                             
                                                cos
                                                (
                                                β
                                                )
                                             
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      x
                                                   
                                                
                                                ×
                                                x
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      y
                                                   
                                                
                                                ×
                                                y
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     is used to map the point X in the coordinate frame of the template to the point located at 
                        
                           Y
                           =
                           W
                           (
                           X
                           ;
                           Θ
                           )
                        
                      in the coordinate frame of the image. The transformation function is composed of translation (
                        
                           
                              
                                 d
                              
                              
                                 x
                              
                           
                        
                      and 
                        
                           
                              
                                 d
                              
                              
                                 y
                              
                           
                        
                      are the object translation along the x and y axes), rotation (
                        
                           β
                        
                      is the object rotation in the image plane), and scale transformations (
                        
                           
                              
                                 s
                              
                              
                                 x
                              
                           
                        
                      and 
                        
                           
                              
                                 s
                              
                              
                                 y
                              
                           
                        
                      are the scale factors along the x and y axes).


                     Fig. 1
                      shows the object region, which is specified by a deformable bounding box. This box is defined by five parameters 
                        
                           R
                           =
                           {
                           
                              
                                 x
                              
                              
                                 c
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 c
                              
                           
                           ,
                           w
                           ,
                           h
                           ,
                           β
                           }
                        
                      where 
                        
                           
                              
                                 x
                              
                              
                                 c
                              
                           
                        
                      and 
                        
                           
                              
                                 y
                              
                              
                                 c
                              
                           
                        
                      are the center pixel coordinates of the object, w and h are the width and height of the region, and 
                        
                           β
                        
                      is the object rotation.

The parameters of the Gaussian functions are initialized using the first object image as follows:

The mean values are set as 
                        
                           
                              
                                 μ
                              
                              
                                 0
                                 (
                                 X
                                 )
                              
                           
                           =
                           
                              
                                 I
                              
                              
                                 0
                              
                           
                           (
                           
                              
                                 Y
                              
                              
                                 0
                              
                           
                           )
                        
                      where 
                        
                           
                              
                                 Y
                              
                              
                                 0
                              
                           
                           =
                           W
                           (
                           X
                           ,
                           
                              
                                 Θ
                              
                              
                                 0
                              
                           
                           )
                        
                      and 
                        
                           
                              
                                 Θ
                              
                              
                                 0
                              
                           
                        
                      is the transformation parameters given at the first image frame, and the variance values are 
                        
                           
                              
                                 σ
                              
                              
                                 0
                                 (
                                 X
                                 )
                              
                              
                                 2
                              
                           
                           =
                           1
                        
                     .

At time step k, the mean and variance of the Gaussian functions are updated as:
                        
                           
                              
                                 
                                    μ
                                 
                                 
                                    k
                                    (
                                    X
                                    )
                                 
                              
                              =
                              
                                 
                                    γ
                                    ×
                                    n
                                    ×
                                    
                                       
                                          μ
                                       
                                       
                                          k
                                          -
                                          1
                                          (
                                          X
                                          )
                                       
                                    
                                    +
                                    m
                                    ×
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          m
                                          (
                                          X
                                          )
                                       
                                    
                                 
                                 
                                    γ
                                    ×
                                    n
                                    +
                                    m
                                 
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    σ
                                 
                                 
                                    k
                                    (
                                    X
                                    )
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    γ
                                    ×
                                    n
                                    ×
                                    
                                       
                                          σ
                                       
                                       
                                          k
                                          -
                                          1
                                          (
                                          X
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    m
                                    ×
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          m
                                          (
                                          X
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    γ
                                    ×
                                    n
                                    +
                                    m
                                 
                              
                           
                        
                     where 
                        
                           γ
                        
                      and 
                        
                           
                              
                                 σ
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                        
                      are forgetting factor and uncertainty margin. Also 
                        
                           
                              
                                 
                                    
                                       μ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 m
                                 (
                                 X
                                 )
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       μ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 m
                                 (
                                 X
                                 )
                              
                           
                        
                      are the approximate mean and variance of the m previous data which are calculated as:
                        
                           (4)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                m
                                                (
                                                X
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   k
                                                   -
                                                   m
                                                   +
                                                   1
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                I
                                             
                                             
                                                i
                                                (
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                m
                                                (
                                                X
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            k
                                                            -
                                                            m
                                                            +
                                                            1
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               i
                                                               (
                                                               
                                                                  
                                                                     Y
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               k
                                                               (
                                                               X
                                                               )
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                0
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

In this work, for the short-term and long-term template the following parameters have been used.

Shown in Table 1
                     , the forgetting factor parameter is smaller for the short-term template to quickly adapt to the target appearance changes whereas the long-term template is designed to be robust against the outliers, sudden appearance changes, and occlusion. In addition, the short-term template uses a smaller uncertainty margin (
                        
                           
                              
                                 σ
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                        
                     ) and batch size (m) to allow a quicker update in comparison with that of the long-term template. In the proposed template update strategy, the variance of each Gaussian 
                        
                           
                              
                                 σ
                              
                              
                                 k
                                 (
                                 X
                                 )
                              
                              
                                 2
                              
                           
                        
                      is empirically estimated from the error between the template and the new images. Therefore, those points with comparably higher variance are more likely labeled as outliers in the localization algorithm which will be elaborated in Section 4.1.

In general, visual tracking consists of two different processes which are (1) Target Representation and Localization (TRL), and (2) Filtering and Data Association (FDA). The latter refers to tracking an object through the estimation of its motion dynamics whereas the former refers to locating the object based on the object appearance and shape. These two processes may be combined with different importance factors depending on the application. For instance in the case of face tracking [24] in a crowded environment, the tracking method is mostly based on TRL rather than FDA because modeling the target appearance is more reliable than predicting the target dynamics. On the other hand, for the applications such as aerial video surveillance where the target motion can be accurately estimated [25], the FDA process is often preferable for target tracking.

In the proposed method, at each localization step, first a certain number of guess points is randomly chosen according to the object motion history. These guess points then initialize several gradient-based optimization processes which interactively find the new transformation parameter to minimize the sum of Gaussian errors between the template and the candidate sub-image. In the following subsections, the proposed localization method is explained in detail. Also for the sake of clarity, the time instant is omitted in the equations.

The localization problem can be viewed as an optimization task. Since the proposed object template is composed of Gaussian functions, at every time step k we estimate the changes in the target transformation parameters 
                           
                              Δ
                              
                                 
                                    Θ
                                 
                                 
                                    k
                                 
                              
                           
                         by optimizing the Sum of Gaussian Errors (SGE) between the target representation model and the received image 
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                           
                         as:
                           
                              (5)
                              
                                 Δ
                                 
                                    
                                       Θ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          arg
                                          
                                          max
                                       
                                       
                                          Δ
                                          
                                             
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   X
                                                   ∈
                                                   R
                                                
                                             
                                          
                                          exp
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        
                                                                           I
                                                                        
                                                                        
                                                                           k
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 Y
                                                                              
                                                                              
                                                                                 ^
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           k
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     
                                                                        
                                                                           μ
                                                                        
                                                                        
                                                                           ˆ
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     k
                                                                     (
                                                                     X
                                                                     )
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         -
                                                         2
                                                         
                                                            
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     ˆ
                                                                  
                                                               
                                                            
                                                            
                                                               k
                                                               (
                                                               X
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              =
                              W
                              (
                              X
                              ;
                              
                                 
                                    Θ
                                 
                                 
                                    k
                                    -
                                    1
                                 
                              
                              +
                              Δ
                              
                                 
                                    
                                       
                                          Θ
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              )
                           
                        , also, 
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                           
                         are the prediction of the mean and variance of the Gaussians at time step k. In this work, 
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    μ
                                 
                                 
                                    k
                                    -
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    k
                                    -
                                    1
                                 
                              
                           
                        . Among commonly used error functions including log-likelihood, SGE has certain advantages that makes it more suitable for our proposed method. First, the use of Gaussian functions allows us to manage the uncertain and incomplete data in a Bayesian framework. Second, SGE as a smooth function, will guarantee the convergence of a gradient-based optimization that is the basis of our proposed tracker.

Using the Taylor series, we can expand the transformed image as:
                           
                              (6)
                              
                                 
                                    
                                       I
                                    
                                    
                                       W
                                       (
                                       X
                                       ;
                                       
                                          
                                             Θ
                                          
                                          
                                             k
                                             -
                                             1
                                          
                                       
                                       +
                                       Δ
                                       
                                          
                                             
                                                
                                                   Θ
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       I
                                    
                                    
                                       W
                                       (
                                       X
                                       ;
                                       
                                          
                                             Θ
                                          
                                          
                                             k
                                             -
                                             1
                                          
                                       
                                       )
                                    
                                 
                                 +
                                 ∇
                                 
                                    
                                       I
                                    
                                    
                                       W
                                       (
                                       X
                                       ;
                                       
                                          
                                             Θ
                                          
                                          
                                             k
                                             -
                                             1
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             W
                                          
                                          
                                             (
                                             X
                                             ;
                                             
                                                
                                                   Θ
                                                
                                                
                                                   k
                                                   -
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       ∂
                                       Θ
                                    
                                 
                                 Δ
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        where 
                           
                              ∇
                              
                                 
                                    I
                                 
                                 
                                    W
                                    (
                                    X
                                    ;
                                    
                                       
                                          Θ
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                    )
                                 
                              
                           
                         is the image gradient and taking the derivative of the transformation function W with respect to its parameters 
                           
                              Θ
                           
                        , we obtain:
                           
                              (7)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             W
                                          
                                          
                                             (
                                             X
                                             ;
                                             
                                                
                                                   Θ
                                                
                                                
                                                   k
                                                   -
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       ∂
                                       Θ
                                    
                                 
                                 =
                                 
                                    
                                       ∂
                                       
                                          
                                             Y
                                          
                                          
                                             k
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       ∂
                                       Θ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   -
                                                   
                                                      
                                                         xs
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         β
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         ys
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         β
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         xC
                                                      
                                                      
                                                         β
                                                      
                                                   
                                                
                                                
                                                   -
                                                   
                                                      
                                                         yS
                                                      
                                                      
                                                         β
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         xs
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         β
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         ys
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         β
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         xS
                                                      
                                                      
                                                         β
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         yC
                                                      
                                                      
                                                         β
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    Y
                                 
                                 
                                    k
                                    -
                                    1
                                 
                              
                              =
                              W
                              (
                              X
                              ;
                              
                                 
                                    Θ
                                 
                                 
                                    k
                                    -
                                    1
                                 
                              
                              )
                              ,
                              
                                 
                                    S
                                 
                                 
                                    β
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    β
                                 
                              
                           
                         denote 
                           
                              sin
                              (
                              β
                              )
                           
                         and 
                           
                              cos
                              (
                              β
                              )
                           
                        , respectively.

As a result, by substituting Eq. (6) into Eq. (5), we obtain:
                           
                              (8)
                              
                                 Δ
                                 
                                    
                                       Θ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          arg
                                          
                                          max
                                       
                                       
                                          Δ
                                          
                                             
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   X
                                                   ∈
                                                   R
                                                
                                             
                                          
                                          exp
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     k
                                                                     (
                                                                     
                                                                        
                                                                           Y
                                                                        
                                                                        
                                                                           k
                                                                           -
                                                                           1
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               +
                                                               ∇
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     k
                                                                     (
                                                                     
                                                                        
                                                                           Y
                                                                        
                                                                        
                                                                           k
                                                                           -
                                                                           1
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  
                                                                     ∂
                                                                     
                                                                        
                                                                           Y
                                                                        
                                                                        
                                                                           k
                                                                           -
                                                                           1
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     ∂
                                                                     Θ
                                                                  
                                                               
                                                               Δ
                                                               
                                                                  
                                                                     
                                                                        
                                                                           Θ
                                                                        
                                                                        
                                                                           ^
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     
                                                                        
                                                                           μ
                                                                        
                                                                        
                                                                           ˆ
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     k
                                                                     (
                                                                     X
                                                                     )
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         -
                                                         2
                                                         
                                                            
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     ˆ
                                                                  
                                                               
                                                            
                                                            
                                                               k
                                                               (
                                                               X
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

One solution for estimating 
                           
                              Δ
                              
                                 
                                    Θ
                                 
                                 
                                    k
                                 
                              
                           
                         is taking the derivative of Eq. (8) with respect to 
                           
                              Δ
                              Θ
                           
                         and set the equation to zero as:
                           
                              (9)
                              
                                 Δ
                                 
                                    
                                       Θ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       H
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          X
                                          ∈
                                          R
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ∇
                                             
                                                
                                                   I
                                                
                                                
                                                   k
                                                   (
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         k
                                                         -
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         k
                                                         -
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   Θ
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                k
                                                (
                                                X
                                                )
                                             
                                          
                                          -
                                          
                                             
                                                I
                                             
                                             
                                                k
                                                (
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      k
                                                      -
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where the Hessian matrix is:
                           
                              (10)
                              
                                 H
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          X
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ∇
                                             
                                                
                                                   I
                                                
                                                
                                                   k
                                                   (
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         k
                                                         -
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         k
                                                         -
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   Θ
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          ∇
                                          
                                             
                                                I
                                             
                                             
                                                k
                                                (
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      k
                                                      -
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                ∂
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      k
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                ∂
                                                Θ
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       (
                                       X
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                     

According to Eq. (10), the Hessian matrix needs to be calculated in every image frame, which is not possible in many real-time applications. Nevertheless, under the independency assumption we can calculate the transformation parameters as:
                           
                              (11)
                              
                                 Δ
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             X
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         k
                                                         (
                                                         
                                                            
                                                               Y
                                                            
                                                            
                                                               k
                                                               -
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         ∂
                                                         
                                                            
                                                               Y
                                                            
                                                            
                                                               k
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                      (
                                                      X
                                                      )
                                                   
                                                
                                                -
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      k
                                                      (
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            k
                                                            -
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             X
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         k
                                                         (
                                                         
                                                            
                                                               Y
                                                            
                                                            
                                                               k
                                                               -
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         ∂
                                                         
                                                            
                                                               Y
                                                            
                                                            
                                                               k
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                ∇
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      k
                                                      (
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            k
                                                            -
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            k
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            (
                                                            i
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             k
                                             (
                                             X
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              Δ
                              
                                 
                                    Θ
                                 
                                 
                                    k
                                 
                              
                              =
                              {
                              Δ
                              
                                 
                                    θ
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                              }
                              ;
                              
                              i
                              ∈
                              [
                              1
                              ,
                              
                                 
                                    N
                                 
                                 
                                    Θ
                                 
                              
                              ]
                           
                        .

Note that in Eq. (11), 
                           
                              
                                 
                                    ∂
                                    
                                       
                                          Y
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         and 
                           
                              ∇
                              
                                 
                                    I
                                 
                                 
                                    k
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                    )
                                 
                              
                           
                         are 
                           
                              [
                              2
                              ×
                              1
                              ]
                           
                         and 
                           
                              [
                              1
                              ×
                              2
                              ]
                           
                         vectors; therefore, no matrix inversion is required, i. e., a significant improvement in the efficiency of the localization task.

In the following subsection, an interactive multi-start EM-like optimization is proposed to estimate the new transformation parameters. In addition to the fact that EM is a powerful optimization algorithm which can manage incomplete data in a Bayesian framework, different starting points increases the robustness of the optimization algorithm against local minima and outliers. In the following subsections, the proposed optimization algorithm is explained in detail.

Given L starting points at every tracking step as 
                           
                              Δ
                              
                                 
                                    
                                       
                                          Θ
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                              ;
                              
                              l
                              ∈
                              [
                              1
                              ,
                              L
                              ]
                           
                        , we can compute the conditional error density function of the object location using the starting point 
                           
                              Δ
                              
                                 
                                    
                                       
                                          Θ
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                           
                         as:
                           
                              (12)
                              
                                 
                                    
                                       P
                                    
                                    
                                       l
                                    
                                 
                                 (
                                 X
                                 |
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       k
                                       ,
                                       l
                                    
                                 
                                 )
                                 =
                                 exp
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  k
                                                                  (
                                                                  
                                                                     
                                                                        Y
                                                                     
                                                                     
                                                                        k
                                                                        -
                                                                        1
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            +
                                                            ∇
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  k
                                                                  (
                                                                  
                                                                     
                                                                        Y
                                                                     
                                                                     
                                                                        k
                                                                        -
                                                                        1
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  ∂
                                                                  
                                                                     
                                                                        Y
                                                                     
                                                                     
                                                                        k
                                                                        -
                                                                        1
                                                                     
                                                                  
                                                               
                                                               
                                                                  ∂
                                                                  Θ
                                                               
                                                            
                                                            Δ
                                                            
                                                               
                                                                  
                                                                     
                                                                        Θ
                                                                     
                                                                     
                                                                        ^
                                                                     
                                                                  
                                                               
                                                               
                                                                  k
                                                                  ,
                                                                  l
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  
                                                                     
                                                                        μ
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  k
                                                                  (
                                                                  X
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                -
                                                2
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                      (
                                                      X
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Accordingly the conditional error density function of the object location can be defined as a mixture model:
                           
                              (13)
                              
                                 P
                                 (
                                 X
                                 |
                                 Φ
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          L
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       l
                                    
                                 
                                 (
                                 X
                                 |
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       k
                                       ,
                                       l
                                    
                                 
                                 )
                                 ,
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          L
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 1
                              
                           
                        where 
                           
                              
                                 
                                    α
                                 
                                 
                                    l
                                 
                              
                              ;
                              
                              l
                              ∈
                              [
                              1
                              ,
                              L
                              ]
                           
                         are the contributing weights and 
                           
                              Φ
                              =
                              {
                              
                                 
                                    
                                       
                                          Θ
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                              ,
                              
                                 
                                    α
                                 
                                 
                                    l
                                 
                              
                              }
                           
                         is the parameter set of the mixture model.

Also based on the Bayes’s rule we obtain:
                           
                              (14)
                              
                                 P
                                 (
                                 l
                                 |
                                 X
                                 ,
                                 Φ
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             l
                                          
                                       
                                       (
                                       X
                                       |
                                       
                                          
                                             
                                                
                                                   Θ
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             k
                                             ,
                                             l
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             L
                                          
                                       
                                       
                                          
                                             α
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       X
                                       |
                                       
                                          
                                             
                                                
                                                   Θ
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             k
                                             ,
                                             j
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

Similar to the EM algorithm used in [26] for estimating a mixture densities, the multi-start localization problem can be viewed as maximizing the following function:
                           
                              (15)
                              
                                 Q
                                 (
                                 Φ
                                 ,
                                 
                                    
                                       Φ
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          L
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          X
                                          ∈
                                          R
                                       
                                    
                                 
                                 
                                    
                                       
                                          log
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                l
                                             
                                          
                                          )
                                          +
                                          log
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   (
                                                   X
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               Θ
                                                            
                                                            
                                                               ^
                                                            
                                                         
                                                      
                                                      
                                                         k
                                                         ,
                                                         l
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 P
                                 (
                                 l
                                 |
                                 X
                                 ,
                                 
                                    
                                       Φ
                                    
                                    
                                       -
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    -
                                 
                              
                           
                         is the parameter set obtained from the previous optimization iteration.

Taking the derivative of Eq. (15) with respect to 
                           
                              
                                 
                                    α
                                 
                                 
                                    l
                                 
                              
                           
                         and considering the constrain 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    l
                                    =
                                    1
                                 
                                 
                                    L
                                 
                              
                              
                                 
                                    α
                                 
                                 
                                    l
                                 
                              
                              =
                              1
                           
                        , we obtain:
                           
                              (16)
                              
                                 
                                    
                                       ∂
                                       Q
                                       (
                                       Φ
                                       ,
                                       
                                          
                                             Φ
                                          
                                          
                                             -
                                          
                                       
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             α
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                                 =
                                 0
                                 →
                                 
                                    
                                       α
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             R
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          X
                                          ∈
                                          R
                                       
                                    
                                 
                                 P
                                 (
                                 l
                                 |
                                 X
                                 ,
                                 
                                    
                                       Φ
                                    
                                    
                                       -
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    N
                                 
                                 
                                    R
                                 
                              
                           
                         is the area of the object region R.

Using Eq. (12) and taking the derivative of Eq. (15) with respect to 
                           
                              Δ
                              
                                 
                                    Θ
                                 
                                 
                                    l
                                 
                              
                           
                        , we obtain:
                           
                              (17)
                              
                                 
                                    
                                       ∂
                                    
                                    
                                       ∂
                                       Δ
                                       
                                          
                                             
                                                
                                                   Θ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             k
                                             ,
                                             l
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   X
                                                   ∈
                                                   R
                                                
                                             
                                          
                                          log
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   (
                                                   X
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               Θ
                                                            
                                                            
                                                               ^
                                                            
                                                         
                                                      
                                                      
                                                         k
                                                         ,
                                                         l
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          P
                                          (
                                          l
                                          |
                                          X
                                          ,
                                          
                                             
                                                Φ
                                             
                                             
                                                -
                                             
                                          
                                          )
                                       
                                    
                                 
                                 =
                                 0
                              
                           
                        
                     

Similar to Eq. (11), the changes in transformation parameters 
                           
                              Δ
                              
                                 
                                    
                                       
                                          Θ
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                              =
                              {
                              Δ
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                              }
                              ;
                              
                              i
                              ∈
                              [
                              1
                              ,
                              
                                 
                                    N
                                 
                                 
                                    Θ
                                 
                              
                              ]
                           
                         are computed as the following equation:
                           
                              (18)
                              
                                 Δ
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       ,
                                       l
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             X
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         k
                                                         (
                                                         
                                                            
                                                               Y
                                                            
                                                            
                                                               k
                                                               -
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         ∂
                                                         
                                                            
                                                               Y
                                                            
                                                            
                                                               k
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                      (
                                                      X
                                                      )
                                                   
                                                
                                                -
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      k
                                                      (
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            k
                                                            -
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       P
                                       (
                                       l
                                       |
                                       X
                                       ,
                                       
                                          
                                             Φ
                                          
                                          
                                             -
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             X
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∇
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         k
                                                         (
                                                         
                                                            
                                                               Y
                                                            
                                                            
                                                               k
                                                               -
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         ∂
                                                         
                                                            
                                                               Y
                                                            
                                                            
                                                               k
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                ∇
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      k
                                                      (
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            k
                                                            -
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            k
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            (
                                                            i
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             k
                                             (
                                             X
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       P
                                       
                                          
                                             
                                                l
                                                |
                                                X
                                                ,
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      -
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

As a result the transformation parameters are obtained as:
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       k
                                       ,
                                       l
                                    
                                 
                                 ←
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       k
                                       ,
                                       l
                                    
                                 
                                 +
                                 Δ
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       k
                                       ,
                                       l
                                    
                                 
                              
                           
                        
                     

According to the formulation provided in the previous sections, at every tracking step, first a set of L different transformation vectors 
                           
                              
                                 
                                    
                                       
                                          Θ
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                           
                         is randomly generated based on a Gaussian distribution around the previous transformation parameters with a diagonal variance matrix 
                           
                              
                                 
                                    σ
                                 
                                 
                                    Θ
                                 
                              
                              =
                              diag
                              (
                              
                                 
                                    σ
                                 
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          K
                                       
                                    
                                 
                              
                              )
                           
                        . Then the optimization parameters 
                           
                              Φ
                              =
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                Θ
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          k
                                          ,
                                          l
                                       
                                    
                                    ,
                                    
                                       
                                          α
                                       
                                       
                                          l
                                       
                                    
                                    }
                                 
                                 
                                    l
                                    ∈
                                    [
                                    1
                                    ,
                                    L
                                    ]
                                 
                              
                           
                         are iteratively estimated based on Eqs. (16) and (18) to find the best transformation vector.

In the proposed tracking algorithm, both short-term and long-term templates are optimized simultaneously to find the best transformation parameters. In fact the proposed multi-start search method is capable of efficiently optimizing any arbitrary number of templates at the same time. In this work, the short-term and long-term templates are considered as a 
                           
                              N
                              ×
                              1
                           
                         vector where N is the number of points inside the template and the mean 
                           
                              
                                 
                                    μ
                                 
                                 
                                    k
                                 
                              
                           
                         and variance 
                           
                              
                                 
                                    σ
                                 
                                 
                                    k
                                 
                              
                           
                         are 
                           
                              (
                              2
                              N
                              )
                              ×
                              1
                           
                         vectors which are the concatenate of the short-term and long-term vectors.

The optimization process is terminated if either it has been performed for a certain number of iterations (
                           
                              
                                 
                                    it
                                 
                                 
                                    max
                                 
                              
                           
                        ) or the inequality:
                           
                              (20)
                              
                                 
                                    max
                                 
                                 
                                    
                                       
                                          
                                             
                                                α
                                             
                                             
                                                l
                                             
                                          
                                          ×
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         Θ
                                                      
                                                   
                                                
                                             
                                          
                                          |
                                          Δ
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                k
                                                ,
                                                l
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                          |
                                       
                                    
                                 
                                 <
                                 
                                    
                                       opt
                                    
                                    
                                       max
                                       _
                                       err
                                    
                                 
                              
                           
                        is satisfied where 
                           
                              
                                 
                                    opt
                                 
                                 
                                    max
                                    _
                                    err
                                 
                              
                           
                         is the maximum acceptable error.
                           Algorithm 1
                           Multi-start Adaptive Multi-Template Tracking 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Require: 
                                                object region at the first frame (
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      =
                                                      {
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            c
                                                            0
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            c
                                                            0
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      }
                                                   
                                                )
                                          
                                          
                                             1: 
                                                   
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      ←
                                                      {
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            x
                                                            0
                                                         
                                                      
                                                      =
                                                      1
                                                      ,
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            y
                                                            0
                                                         
                                                      
                                                      =
                                                      1
                                                      ,
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            x
                                                            0
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            c
                                                            0
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      /
                                                      2
                                                      ,
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            y
                                                            0
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            c
                                                            0
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      /
                                                      2
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             2: 
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            X
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      W
                                                      (
                                                      X
                                                      ;
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      )
                                                   
                                                 , 
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            X
                                                         
                                                      
                                                      ←
                                                      {
                                                      1
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             3: for 
                                                
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                : end of image sequence do
                                             
                                          
                                          
                                             4: 
                                                for all 
                                                
                                                   
                                                      l
                                                      ∈
                                                      [
                                                      1
                                                      ,
                                                      L
                                                      ]
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             5: 
                                                
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            L
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             6: 
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  Θ
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                            ,
                                                            l
                                                         
                                                      
                                                      ←
                                                   
                                                 a random sample from distribution 
                                                   
                                                      N
                                                      (
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            k
                                                            -
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            Θ
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             7: 
                                                end for
                                             
                                          
                                          
                                             8: 
                                                for 
                                                
                                                
                                                   
                                                      
                                                         
                                                            it
                                                         
                                                         
                                                            opt
                                                         
                                                      
                                                      =
                                                      1
                                                      :
                                                      
                                                         
                                                            it
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             9: 
                                                for all 
                                                
                                                   
                                                      l
                                                      ∈
                                                      [
                                                      1
                                                      ,
                                                      L
                                                      ]
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             10: 
                                                estimate 
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                      (
                                                      X
                                                      |
                                                      
                                                         
                                                            
                                                               
                                                                  Θ
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                            ,
                                                            l
                                                         
                                                      
                                                      )
                                                      ,
                                                      P
                                                      (
                                                      l
                                                      |
                                                      X
                                                      ,
                                                      Φ
                                                      )
                                                      ,
                                                      Δ
                                                      
                                                         
                                                            
                                                               
                                                                  Θ
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                            ,
                                                            l
                                                         
                                                      
                                                   
                                                , and 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  Θ
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                            ,
                                                            l
                                                         
                                                      
                                                   
                                                 using Eqs. (12), (14), (18), and (19) respectively
                                          
                                          
                                             11: 
                                                estimate 
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                   
                                                 using Eq. (16)
                                             
                                          
                                          
                                             12: 
                                                end for
                                             
                                          
                                          
                                             13: break if inequality (20) is satisfied
                                          
                                          
                                             14: 
                                                end for
                                             
                                          
                                          
                                             15: 
                                                
                                                   
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            
                                                               
                                                                  Θ
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                            ,
                                                            
                                                               
                                                                  l
                                                               
                                                               
                                                                  ∗
                                                               
                                                            
                                                         
                                                      
                                                   
                                                 where 
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            
                                                               arg max
                                                            
                                                            
                                                               l
                                                               ∈
                                                               [
                                                               1
                                                               ,
                                                               L
                                                               ]
                                                            
                                                         
                                                      
                                                      [
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                      ]
                                                   
                                                
                                             
                                          
                                          
                                             16: for each template, update 
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            k
                                                            (
                                                            X
                                                            )
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            k
                                                            (
                                                            X
                                                            )
                                                         
                                                      
                                                   
                                                 using Eq. (3)
                                             
                                          
                                          
                                             17: end 
                                                
                                                for
                                             
                                          
                                       
                                    
                                 
                              
                           

A schematic algorithm of the proposed tracking method is illustrated in Algorithm 1. Based on this algorithm, the proposed parallel optimization using multiple templates and starting points can outperform a sequentially execution of an optimization algorithm with different templates or initialization points. Indeed, parallel optimization can improve the accuracy and convergence speed of the overall optimization process by comparing the results as each iteration.

@&#EXPERIMENTAL RESULTS@&#

In this section, the robustness and accuracy of the proposed tracking method have been experimentally evaluated using five publicly available gray-scale image sequences that contain different challenging situations including significant object pose, appearance, and scale variations, partial and full occlusion, illumination changes and noise, complex and unpredicted motion, and cluttered scene. Also the pixel values in our implementation are normalized to real values in the range [0 1]. The target object region (R) can be initially specified manually or by any object detector. In the following experiments, the maximum error of the localization optimization (
                        
                           
                              
                                 opt
                              
                              
                                 max
                                 _
                                 err
                              
                           
                        
                     ), the maximum number of optimization iterations, and the number of starting points (L) are set to 0.1, 5, and 50 respectively. Also the object template size is the actual object regions size divided by two and the variance matrix 
                        
                           
                              
                                 σ
                              
                              
                                 Θ
                              
                           
                        
                      is empirically set to 
                        
                           {
                           
                              
                                 σ
                              
                              
                                 β
                                 =
                                 0.01
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       x
                                    
                                 
                              
                           
                           =
                           0.01
                           ,
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       y
                                    
                                 
                              
                           
                           =
                           0.01
                           ,
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       d
                                    
                                    
                                       x
                                    
                                 
                              
                           
                           =
                           5
                           ,
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       d
                                    
                                    
                                       y
                                    
                                 
                              
                           
                           =
                           5
                           }
                        
                     . These parameters are fixed for all experiments. It will be shown in Section 5 that this selection of parameters provides satisfactory results in term of both accuracy and computational efficiency.

For each experiment, the result of the proposed tracking method called ERTM (bold dashed red box) has been compared with five of the state-of-the-art trackers including: (1) TLD tracker [27] (dashed green box), (2) Incremental Visual Tracking [28] (solid blue box), (3) Decentralized Template Tracking [23] (dashed black box), (4) Mean-shift [12] (dash-dot cyan box), and (5) Fragment-based Tracker [29] (solid magenta box), as well as the manually labeled ground truth data (bold dotted yellow box) to validate the comparison. Also to establish a quantified comparison, the mean value of the long-term and short-term templates are shown at the top-right of each figure respectively. Moreover, for each image sequence two separate chronological list of images are provided to show the change of the adaptive templates over time.

In addition to the qualitative comparison shown in Figs. 3, 6, 9, 12, and 15
                        
                        
                        
                        
                        , the “ground truth” data has been used to evaluate the precision of the proposed tracking method in comparison with the other methods. According to Figs. 4, 7, 10, 13, and 16
                        
                        
                        
                        
                        , the root mean square (RMS) of the difference between the ground truth center point and the estimated location obtained from the proposed method is for the most part less than that of the other trackers. In these Figures, the average RMS error indicates the average of the RMS error from the beginning up to each time step (see Fig.3).


                        Sequence 
                        
                           dudek.
                         The first image sequence,
                           4
                           
                              http://www.cs.toronto.edu/vis/projects/dudekfaceSequence.html.
                        
                        
                           4
                         illustrated in Fig. 2
                        , shows a face subject to different challenging situations including appearance and pose variations, camera movement, partial and full occlusion, scale changes, rotation, and light changes.

Shown in Fig. 2, the proposed tracker is suitably robust to handle various challenging situations such as different object poses (e.g., frames #2, #189, #1134), scales (e.g., frames #2, #575, #1134), illumination changes (e.g., #836, #920), and temporary occlusion (e.g., frames #208, #211, #367) whereas MS and FT ultimately failed to track the target. Based on Fig. 4, from frame around #700 to #900, Mean-shift, and Fragment-based trackers started to drift from the target location mostly due to the significant changes in the object appearance and unpredicted motion. Although TLD tracker managed to successfully track the target to the end, it is not robust to occlusion and sudden appearance changes (e.g., frames #226, #920).


                        Sequence 
                        
                           david.
                         The second sequence
                           5
                           
                              http://www.cs.toronto.edu/dross/ivt/.
                        
                        
                           5
                         contains illumination, scale, pose, and appearance changes as well as partial occlusion and out of plane rotation (e.g., #137, #156, #376 #390).

Shown in Fig. 5
                        , the proposed tracking method can robustly track the target object against pose changes (e.g., frames #137, #156, #171, #376), scale and appearance changes (e.g., frames #137, #456), and partial occlusion (e.g., frames #156, #171, #390) (see Fig.6). Based on the tracking result error illustrated in Fig. 7, among other tracking methods, only ERTM (the proposed method), TLD, and IVT tracked the target accurately from the beginning to the end. However TLD failed to locate the target from frame about #110 to #220 mainly because of partial occlusion and out of plane rotation.


                        Sequence 
                        
                           cube.
                         The third sequence
                           6
                           
                              http://acis.ok.ubc.ca/hfirouzi/RDMMATT.html.
                        
                        
                           6
                         shows a cubic object which is moved randomly by a person’s hands. This video is challenging due to the low object image contrast, having just a few unique image features, and unpredicted object motion. Shown in Fig. 8
                        , at some frames (e.g., #80, #169, #290) the cube is mixed with the person’s hand and passing from one hand to the other; however, the proposed method is capable of tracking the object in the low-contrast scene where the object scale is also changing over time (e.g., #32, #270) (see Fig. 9).

In comparison with the other methods shown in Fig. 10, the proposed method is capable of tracking and locating the target object with more precision and accuracy.


                        Sequence 
                        
                           car.
                         The forth video
                           7
                           
                              http://www.cs.toronto.edu/dross/ivt/.
                        
                        
                           7
                         is a low-contrast image sequence of a moving car in a cluttered and dynamic street. Illustrated in Fig. 11
                        , the proposed method is capable of tracking the target object which is very similar and mixed with the background (e.g., frames #55, #28, #390), whereas, according to Fig. 13, other tracking methods could not track the target completely because it is poorly textured and very cluttered by the background (see Fig. 12).


                        Sequence 
                        
                           dog.
                         The last image sequence
                           8
                           
                              http://www.cs.toronto.edu/dross/ivt/.
                        
                        
                           8
                         shows a doll dog which is moved randomly by a person’s hand. Although the object appearance, pose, and scale is significantly changed over time (e.g., frames #927, #1028, #1270), the proposed method can accurately track the target. Other tracking methods are not robust against significant scaling e.g., frames #927, #1028.

@&#DISCUSSION@&#

Based on the experimental results, the proposed tracking method acquired the least RMS error in the image sequences cube and car. and in the other ones its performance is comparable with the best tracker i.e., IVT (which has obtained the least RMS error).

In general, both Mean-shift and Scale Adaptive Mean-shift can poorly track objects whose appearance and scale are significantly changing during time (e.g., in Fig. 7 after frame around #40). They are also not robust against illumination changes and outliers. Similarly, Fragment-based tracker cannot handle pose, scale, and illumination changes. TLD tracker, on the other hand, is robust to appearance and pose variations, illumination changes, and non-rigidity. However, it fails when there is either an occlusion, out of plane rotation, or rapid appearance change (e.g., in Fig. 4 from frame about #250 to #380, in Fig. 7 from frame about #200 to #220, or in Fig. 13
                         after frame about #200). Also, DRTT performed well comparably in the sequences dudek, cube, car, and dog, but it is not robust to significant appearance changes and occlusion (Fig. 7 after frame about #70) (see Fig. 15).

In addition, it is verified that the proposed tracker can more efficiently be used in real-time applications in comparison with the other methods. A Matlab (R) implementation of the proposed method can process in average 31.76
                           9
                           The number of processed frames in a second for the sequences dudek, david, cube, car, and dog are 20.5, 8.8, 33.7, 73.7, and 21.1 respectively.
                        
                        
                           9
                         frames per second (fps) on a laptop with a 2.27Ghz Intel (R) Core (TM) i3 CPU. However, a Matlab (R)/Mex implementation of the IVT and a matlab implementation of DRTT can only process in average 8.3 and 8.2 frames per second respectively. Low computational cost of the proposed tracker is mainly due to the parallel and interactive optimization algorithm described in Section 4.2. Based on our experiment, the average number of optimization iteration is about 1.1 when the number of starting points is set to 50 (
                           
                              L
                              =
                              50
                           
                        ). Consequently, the required particles to find the best target location is about 55 which is significantly less than that of a typical particle filter-based visual tracker.
                           10
                           In general, particle filter-based methods require a minimum 100 samples (i.e., 
                                 
                                    5
                                    ×
                                    100
                                    =
                                    500
                                 
                              ) for each estimating parameter to obtain a satisfactory tracking result.
                        
                        
                           10
                         Moreover, the proposed object localization algorithm consists of multiple simultaneous optimization steps which can be run in parallel on a multi-thread processor.

The videos corresponding to the experimental results can all be found at http://www.acis.ok.ubc.ca/hfirouzi.

@&#CONCLUSIONS@&#

An efficient template-based, or direct, tracking method is presented in this paper. The proposed tracker is robust against object appearance, scale, and illumination changes as well as occlusion and cluttered environments. The representation model (i.e., object template) is defined by two heterogeneous adaptive templates consisting of Gaussian functions. A forgetting factor (
                        
                           γ
                        
                     ) and an uncertainty margin (
                        
                           
                              
                                 σ
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                        
                     ) are used to update the Gaussian functions to increase the robustness and adaptability of the appearance model against both long-term and short-term changes over time. In addition, the variance values of the Gaussian functions are updated so that they can reject outliers such as background pixels. At every tracking step, a mixture of Gaussian errors between the object templates and a set of candidate sub-images are minimized using several Gradient-based optimization processes. Each optimization process is initialized with a different starting point to avoid trapping in local minimum and resolve the drift problem. Moreover, the parallel optimization algorithm is designed to improve the overall computational cost of tracking by interactively comparing the solutions. It is shown experimentally that a non-optimized Matlab (R) implementation of the proposed tracker can on average process 31.76 frames per second and hence meets the demand of typical real-time applications.

Shown in Table 2
                     , the proposed method performed well in different challenging situations including appearance and pose changes, scale variations, different illumination, and occlusion, however, it occasionally drifted from the target particularly when the target appearance is significantly changed and it is occluded as well. For instance, in Fig. 7 around frame #300,

Moreover, it has been observed that the accuracy and robustness of the proposed tracker do not significantly depend on its parameter values (the tracking parameters are the same in all experiments, we have observed that the tracking result is fairly robust with different choice of parameters). However, different parameter values may change the overall performance of the proposed tracker. For instance, a smaller value for the maximum error of the localization optimization (
                        
                           
                              
                                 opt
                              
                              
                                 max
                                 _
                                 err
                              
                           
                        
                     ) or a greater number of starting points can improve the accuracy of the tracking in the expense of an increased computational cost. In general, the tracking parameters constitute a trade-off between accuracy and efficiency.

As a limitation of the proposed tracker, only region-based models can be integrated into the proposed multi-model target representation. However, a modification of the parallel optimization process can be effectively used for both region-based and feature-based multi-model representations. Moreover, it has been observed that this method may fail to re-track the target which has been fully occluded for a long time. To solve this problem, another adaptive template which is robust against the long-term changes can be added to the proposed representation model. As a result, the target can also be tracked under long-term and full occlusion.

@&#ACKNOWLEDGMENT@&#

The authors are thankful to the anonymous reviewers for their insightful comments, which have helped us to greatly improve this article.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.cviu.2013.12.009.


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

