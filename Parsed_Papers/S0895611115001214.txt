@&#MAIN-TITLE@&#Automatic white matter lesion segmentation using contrast enhanced FLAIR intensity and Markov Random Field

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           An automatic method for white matter lesion segmentation (WML).


                        
                        
                           
                           A novel filter is used to enhance the contrast of WML.


                        
                        
                           
                           A robust Markov Random Field is used to remove false positive WMLs.


                        
                        
                           
                           Evaluated with respect to the grading of two expert graders.


                        
                        
                           
                           Compared with state of the art methods in two datasets.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

White matter lesions (WMLs)

Magnetic resonance imaging (MRI)

Random forest (RF)

Markov Random Field (MRF)

Cerebrovascular diseases

@&#ABSTRACT@&#


               
               
                  White matter lesions (WMLs) are small groups of dead cells that clump together in the white matter of brain. In this paper, we propose a reliable method to automatically segment WMLs. Our method uses a novel filter to enhance the intensity of WMLs. Then a feature set containing enhanced intensity, anatomical and spatial information is used to train a random forest classifier for the initial segmentation of WMLs. Following that a reliable and robust edge potential function based Markov Random Field (MRF) is proposed to obtain the final segmentation by removing false positive WMLs. Quantitative evaluation of the proposed method is performed on 24 subjects of ENVISion study. The segmentation results are validated against the manual segmentation, performed under the supervision of an expert neuroradiologist. The results show a dice similarity index of 0.76 for severe lesion load, 0.73 for moderate lesion load and 0.61 for mild lesion load. In addition to that we have compared our method with three state of the art methods on 20 subjects of Medical Image Computing and Computer Aided Intervention Society's (MICCAI's) MS lesion challenge dataset, where our method shows better segmentation accuracy compare to the state of the art methods. These results indicate that the proposed method can assist the neuroradiologists in assessing the WMLs in clinical practice.
               
            

@&#INTRODUCTION@&#

White matter lesions (WMLs) have been associated with various diseases such as stroke [1], Alzheimer's disease [2,3], late life depression [4] and impairment of gait [5] etc. Different studies have shown a strong relationship between increased WMLs volume and cognitive decline [6,7]. Magnetic resonance imaging (MRI) is used for the visualization of WMLs. WMLs appear as hyperintense signal in T2-weighted and fluid attenuated inversion recovery (FLAIR) MRI images. Manual segmentation and quantification of white matter lesion is time consuming, expensive, subjective and impractical for large scale longitudinal studies. Several supervised and unsupervised algorithms are proposed in the literature for the automatic segmentation of white matter lesions [8–13,9]. Among the many existing segmentation methods, the accurate segmentation of white matter lesions remains a challenging task.

Low contrast and intensity inhomogeneity are the major challenges of automatic WMLs segmentation in brain MRI images. Histogram equalization [14] and adaptive histogram equalization [14] are two well known contrast enhancement methods in image processing. Since the pathology is not evenly distributed in the medical images therefore global stretching of the histogram as proposed in histogram equlization can suppress the pathology, on the contrary local stretching of the histogram as proposed in adaptive histogram equalization can over-amplify the intensity with false identification of pathology [14]. Presently in medical image processing, contrast enhancement filters are developed considering the properties of the corresponding image modality [15]. FLAIR MRI is the commonly used MRI modality for white matter lesion segmentation [16]. But a few methods have been proposed for the contrast enhancement of FLAIR intensity. Khademi et al. [9] have proposed a method to enhance the contrast of the FLAIR intensity using gradient information. In most of the cases white matter lesions have fuzzy edges thus gradient information based intensity enhancement does not work for all cases. The spatial distribution of the white matter lesion can be useful information for the contrast enhancement of FLAIR intensity. As we know, the ratio of the number of white matter lesion pixel is very low compared to the number of healthy pixel, therefore if we select a set of non-overlapping pixels from the brain area then majority of them have the high probability of being a member of healthy region. Based on this assumption we hypothesize that a lesion pixel will show high contrast with respect to a set of non-overlapping pixels.

Apart from intensity information, anatomical and textural information are also used to segment white matter lesions (WMLs) [8,10–13]. Geremia et al. [17] proposed a method where a random forest classifier [18] is used to segment WMLs. The random forest classifier is trained by using multichannel MRI intensity and long range contextual features. But in their method pixel neighbourhood information are not considered for the final segmentation. Since Markov Random Field (MRF) models spatial dependency between neighbouring pixels. Hence it is used widely in white matter lesion segmentation [19,20]. In those methods image properties such as intensity, gradient, texture, etc. are not included in the neighbourhood model; they only consider the initial labelling information of neighbourhood pixels for final segmentation. As a result, they might show over-smoothing when the number of lesion is small. We hypothesize that incorporation of image properties into the neighbourhood structure of MRF can improve the segmentation accuracy when the number of lesions is small.

In this paper, we have proposed a novel method to enhance the contrast of WMLs in the FLAIR MRI images. Then the enhanced intensity is used with the spatial location and anatomical information to train a random forest classifier to obtain the initial segmentation. Following that a reliable and robust MRF is proposed for obtaining final segmentation by removing false positive WMLs. Our proposed MRF maximizes the segmentation accuracy by using a novel edge function.

The rest of the paper is organized as follows: in Section 2, the details of our method is described. The results and discussions are presented in Section 3. Finally, Section 4 concludes the paper.

We primarily investigated a dataset of ENVISion study [21]. The dataset consist of 24 MRI images, selected from a larger cohort of elderly subjects with hypertension. In order to include a wide variety of WMLs severity, subjects are selected based on the severity of WMLs. Monash university health and research ethics committee have approved the study and all subjects gave written informed consent prior to participation. ENVISion dataset contains two modalities of MRI named as T1-weighted and fluid attenuated inversion recovery (FLAIR). The size of each subject's voxel set is 256×256×36 and the resolution is 0.94mm×0.94mm×4mm. MRI imaging was performed on a 1.5T GE machine. The ground truth for evaluating the proposed method was generated by manual delineation of the WMLs by an expert grader (a neuroradiologist) and a grader working more than three years in this filed using the ITK-SNAP [22].

@&#METHODS@&#

The flow diagram of our method is shown in Fig. 1
                        . We use two different MRI modalities: T1 MRI and fluid attenuated inversion recovery (FLAIR) MRI as input in our method. In the preprocessing step image artefacts are reduced and brain skull is removed. Then a set of features are extracted from the brain pixels in the feature extraction step. Following this, the extracted features are used to train a random forest (RF) classifier to generate lesion probability score for each pixel in the brain region. Finally the probability scores are integrated into a Markov Random Field (MRF) cost function to obtain the final segmentation by removing false positives. These different stages are discussed in the following sections.

In our patient database, the resolution of T1 and FLAIR images are not same. Therefore, co-registration of these modalities is required. We use SPM8 [23] to co-register T1 and FLAIR images. Rigid body transformation is used to perform this co-registration (using the ‘coreg’ function of SPM8). Then non brain tissue is removed from the T1 image using the FMRIB software library (FSL) brain extraction tool (BET), using standardized parameters for brain extraction, including bias field correction and robust brain center estimation as recommended by Popescu et al. [24]. Resulting brain mask is applied to the FLAIR image. Finally, radio frequency field inhomogeneity correction is performed on both images using the N3 algorithms [25]. Intensity in MRI images variates among the patients. Therefore we normalized the intensity by using the method proposed in Nyul et al. [26].

Our feature set is a combination of 9 features as shown in Table 1
                        . The first eight features contain multi-modal (T1 and FLAIR) intensity, anatomical and spatial information and the last feature is our proposed global reference points based contrast feature. The details of the features are presented in the following subsections.

White matter lesions (WMLs) look hyper-intensed on the FLAIR MRI and anatomical informations are represented by T1 MRI. Therefore, we include intensity information from these two MRI modalities in our feature set.

White matter lesions (WMLs) are located in the white matter area of the brain. Thus prior knowledge of anatomical information plays an important rule in the segmentation of white matter lesion (WML). Intensity of WML and gray matter tissue overlap with each other therefore in the presence of WML; intensity based tissue segmentation is very difficult. To overcome this challenge we adopted multi atlas level fusion (MALF) [27] to compute probability map for each tissue. Our MALF based tissue probability map creation algorithm has three main steps as follows:
                              
                                 1.
                                 
                                    Atlas creation: We select n healthy T1 MRI images from the ENVISion study as our atlas image. Following this each atlas image is segmented into white matter (WM), gray matter (GM) and cerebral spinal fluid (CSF) using FSL-FMRIB's automated segmentation tool (FAST) [28]. The FMRIB automated segmentation tool (FAST) is part of the FMRIB Software Library (FSL). FAST focuses on segmenting normal brains without apparent diseases into three tissues: WM, GM and CSF. FAST initializes the segmentation parameters of the brain tissues by using the registered Montreal Neurological Institute (MNI) brain template. Following that a three-step expectation maximization (EM) process is used which updates the class labels, tissue parameters and bias field iteratively. During the iterations, a Markov Random Filed (MRF)- Maximum a posteriori (MAP) approach is used to estimate class labels, MAP is applied to estimate the bias field, and the tissue parameters are estimated by maximum likelihood (ML). After applying the FAST on each atlas image we have segmented label for their WM, GM and CSF.


                                    Registration: Each atlas image is non-linearly registered to the target subject T1 MRI using Elastix software package [29]. Then corresponding atlas label is warped with the target subject by applying the transformation matrix.


                                    Label fusion: The labels from each atlas are then combined by applying label fusion. The probability of each pixel being a member of WM, GM and CSF is obtained by computing the frequency of respective tissue classes in the registered altas label. The probability of i
                                    
                                       th
                                     pixel as a member of tissue class k; where K
                                    ∈{WM, GM, CSF} is computed as follows:
                                       
                                          
                                             
                                                p
                                                i
                                             
                                             (
                                             k
                                             )
                                             =
                                             
                                                1
                                                n
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             ψ
                                             (
                                             
                                                A
                                                j
                                                i
                                             
                                             ,
                                             k
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             ψ
                                             (
                                             
                                                A
                                                j
                                                i
                                             
                                             ,
                                             k
                                             )
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               if
                                                               
                                                               
                                                                  A
                                                                  j
                                                                  i
                                                               
                                                               =
                                                               =
                                                               k
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               Otherwise
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 

Here 
                                       
                                          A
                                          j
                                          i
                                       
                                     represents the label of the i
                                    
                                       th
                                     pixel in j
                                    
                                       th
                                     atlas and n is the number of atlases. In our method we use 15 atlases.

Shape of the brain varies among the patients. Therefore, we adopted the method proposed in Steenwijk et al. [10] to normalize the spatial variation among the patients. Target patient's T1 MRI is first registered with the Montreal Neurological Institute (MNI) brain template. Then voxel wise corresponding MNI space is warped back to the target patient's space using inverse transformation. This resulted in normalized X, Y and Z coordinate for the target patient with respect to MNI brain template.

Intensity variation of the WMLs even in the same patient makes WML segmentation a challenging task; this variation makes it very difficult to detect WMLs using only local intensity information. In FLAIR MRI images, WML are brighter than the adjacent normal white matter. Radiologists use this criterion to detect WMLs quantitatively. In our proposed feature, we follow a conceptually similar procedure. For each candidate pixel (Fig. 3(a)) in the brain area, we compute a set of equal distance reference points (as shown in Fig. 3(b)) using Algorithm 1.


                           
                              Algorithm 1
                              Algorithm to obtain a set of equal distance neighbour points for a candidate point.


                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

After computing a set of equal distance reference points we use pWM (Fig. 2
                           (b)) to discard those points which are located outside of the white matter region (Fig. 3
                           (c)). Let c is a candidate pixel and its global reference points are denoted by G, where G
                           ∈{g
                           1, g
                           2, …, g
                           
                              n
                           }. We apply a median filter of size 5×5 centred on each candidate and it's corresponding global reference pixels to smooth their intensity. Then for each candidate pixel c the normalized mean contrast is computed by using Eq. (1).
                              
                                 (1)
                                 
                                    
                                       E
                                       c
                                    
                                    =
                                    
                                       1
                                       n
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                   c
                                                
                                             
                                             ¯
                                          
                                          −
                                          
                                             
                                                
                                                   I
                                                   
                                                      
                                                         g
                                                         i
                                                      
                                                   
                                                
                                             
                                             ¯
                                          
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                   c
                                                
                                             
                                             ¯
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       I
                                       c
                                    
                                 
                                 ¯
                              
                            denotes the smoothed intensity of c
                           
                              th
                            pixel and 
                              
                                 
                                    
                                       I
                                       
                                          
                                             g
                                             i
                                          
                                       
                                    
                                 
                                 ¯
                              
                            denotes smoothed intensity of 
                              
                                 g
                                 
                                    
                                       i
                                       th
                                    
                                 
                              
                            pixel and n is the number of global reference points. For each candidate pixel inside the brain region we compute normalized mean contrast as shown in Fig. 3(d). In our method, we set r
                           =25 pixels because in our dataset maximum diameter of a lesion is 25 pixels. By setting r
                           =25 we avoid to choose multiple global reference points from the same lesion. Our proposed global reference points based contrast feature works for all lesion load categories. Hot colour maps of the proposed feature for high, medium and low lesion load are shown in Fig. 4
                           .

For normalization of the features, we determine the distribution mean and standard deviation for each feature. Next we subtract the mean from each feature. Then we divide the values (mean is already subtracted) of each feature by its standard deviation. Let a feature component x is transformed to a random variable with zero mean and unit variance as:
                              
                                 
                                    
                                       
                                          x
                                          ˜
                                       
                                    
                                    =
                                    
                                       
                                          x
                                          −
                                          μ
                                       
                                       σ
                                    
                                 
                              
                           where μ and σ are the sample mean and the sample standard deviation of that feature, respectively.

We use random forest (RF) classifier to compute the prior probability of each voxel belonging to the lesion and background classes. RF [18] is one of the most successful ensemble learning techniques and has been proven to be a robust and powerful technique in pattern recognition and machine learning for high-dimensional classification [30] and skewed problems [18]. It is a collection of decision trees [31]. The decision tree induction algorithm proceeds by partitioning a training set of labelled records based on their attributes or features. The partition has been carried out to obtain subsets which are as pure as possible with respect to the given target class. The best partitioning is selected in accordance with a splitting criterion that gives maximum information gain. A collection of such decision trees are used because it has been proven that an ensemble of such classification techniques can improve the accuracy of the classification [32]. Breiman et al. [18] has proposed an ensemble of decision trees where each base classifier is trained by using a randomly chosen subset of training data. In addition, each split is selected by evaluating a smaller subset of the features, which are randomly chosen from the original feature set. These steps are taken to reduce the chance of overfitting.

Let T be our training dataset: then T
                           
                              R
                            represents the randomly chosen samples from T where T
                           
                              R
                           
                           ⊂
                           T. In our method, parameters of each split node are optimized only over a randomly sampled subset Θ of all possible features θ 
                           
                              
                                 
                                    Here,
                                    |
                                    Θ
                                    |
                                    =
                                    
                                       
                                          |
                                          θ
                                          |
                                       
                                    
                                 
                              
                           . During the optimization of each split node, all available features θ
                           
                              i
                           
                           ∈Θ are tried one after the other in combination with different cut-off values. The combination of optimal cut-off value and corresponding feature is selected based on the maximum information gain for that node. The expansion of the node is stopped when information gain is below a certain threshold. At the end of the training phase, each leaf node l
                           
                              t
                            of each tree t receives a partition of the 
                              
                                 T
                                 
                                    (
                                    
                                       l
                                       t
                                    
                                    )
                                 
                              
                            of the training data. The partition 
                              
                                 T
                                 
                                    (
                                    
                                       l
                                       t
                                    
                                    )
                                 
                              
                            can be divided into two classes: in this case lesion and background. Finally, the posterior probability in each leaf node for each class can be defined as 
                              
                                 p
                                 
                                    
                                       l
                                       t
                                    
                                 
                              
                              (
                              Class
                              =
                              b
                              )
                              =
                              
                                 
                                    |
                                    
                                       T
                                       
                                          
                                             l
                                             t
                                          
                                       
                                       b
                                    
                                    |
                                 
                                 /
                                 
                                    |
                                    
                                       T
                                       
                                          
                                             l
                                             t
                                          
                                       
                                    
                                    |
                                 
                              
                           , where b
                           ∈(lesion, background).

During the testing phase, each sample of the test data is simultaneously traversed through each of the trees until it reaches a leaf node l
                           
                              t
                           . Thus, each test sample will end up in different leaf nodes of n different trees with different posterior probability. For a particular sample k, the output of the forest is the mean of the posterior probability of all trees.


                           
                              
                                 (2)
                                 
                                    
                                       P
                                       k
                                    
                                    (
                                    class
                                    =
                                    b
                                    )
                                    =
                                    
                                       1
                                       n
                                    
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       p
                                       
                                          
                                             l
                                             t
                                          
                                       
                                    
                                    (
                                    Class
                                    =
                                    b
                                    )
                                 
                              
                           
                        

The number of trees and their depth characterize the generalization power and the complexity of the non-parametric model learned by the forest. Here we use minimum leaf size to control the depth of the tree. When the number minimum size of leaf for a node increases the depth of the tree decreases. We use out of bag error to select the optimum leaf size and tree numbers.

We observe that, (1) for a fixed minimum leaf size, increasing the number of tree leads to better generalization; (2) for a fixed number of trees, low minimum leaf size leads to over-fitting and high minimum leaf size leads to under-fitting and (3) here over fitting is reduced by increasing the number of trees.

We use out of bag error for the optimum selection of tree number and min leaf size. From our experiment we find minimum out of bag error when number of trees=400 and Min leaf size=10.

Random forest classifier is used to compute probability for each pixel as a member of lesion class. However, classification of pixels at the boundary of healthy tissues and lesion tissues often requires structural information in addition to the individual voxel-based features. For this reason, we propose a novel Markov Random Field (MRF) based segmentation to achieve high accuracy in white matter lesion (WML) segmentation by removing false positive lesions. Each voxel has two probability values corresponding to lesion class and healthy class. The probability maps serve as penalty costs in a second order MRF cost function.

The final segmentation is obtained by optimizing a second order Markov Random Field (MRF) energy function which is written as:


                        
                           
                              
                                 
                                    
                                       y
                                       ˆ
                                    
                                 
                                 =
                                 
                                    
                                       arg
                                       max
                                    
                                    y
                                 
                                 
                                    1
                                    Z
                                 
                                 
                                    ∏
                                    
                                       i
                                       ∈
                                       Θ
                                    
                                 
                                 ϕ
                                 (
                                 
                                    x
                                    i
                                 
                                 ,
                                 
                                    y
                                    i
                                 
                                 )
                                 
                                    ∏
                                    
                                       j
                                       ∈
                                       N
                                       {
                                       i
                                       }
                                    
                                 
                                 ψ
                                 (
                                 
                                    y
                                    i
                                 
                                 ,
                                 
                                    y
                                    j
                                 
                                 )
                              
                           
                        where Z is a normalizing constant, N{i} is the set of neighbouring nodes to the i
                        
                           th
                         voxel, x
                        
                           i
                         is the extracted feature set of i
                        
                           th
                         voxel and y
                        
                           i
                         is the label of i
                        
                           th
                         voxel. The node and edge potentials are denoted as ϕ(.) and ψ(.) respectively. In the proposed method, the node potential ϕ(.) is the probability score of each lesion and non-lesion class given by the random forest classifier. The edge potentials ψ(.) measure the compatibility of the neighbouring nodes based on their intensities and probability of being located inside the white matter. ψ(.) ensures a smooth solution by penalizing the spatial discontinuities. The edge potentials ψ(.) can be written as:


                        
                           
                              
                                 ψ
                                 (
                                 
                                    y
                                    i
                                 
                                 ,
                                 
                                    y
                                    j
                                 
                                 )
                                 =
                                 α
                                 *
                                 
                                    ψ
                                    I
                                 
                                 (
                                 
                                    y
                                    i
                                 
                                 ,
                                 
                                    y
                                    j
                                 
                                 )
                                 +
                                 β
                                 *
                                 
                                    ψ
                                    pWM
                                 
                                 (
                                 
                                    y
                                    i
                                 
                                 ,
                                 
                                    y
                                    j
                                 
                                 )
                              
                           
                        
                        
                           
                              
                                 
                                    ψ
                                    I
                                 
                                 (
                                 
                                    y
                                    i
                                 
                                 ,
                                 
                                    y
                                    j
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      e
                                                      
                                                         −
                                                         
                                                            
                                                               (
                                                               
                                                                  I
                                                                  i
                                                               
                                                               −
                                                               
                                                                  I
                                                                  j
                                                               
                                                               )
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      y
                                                      i
                                                   
                                                   ≠
                                                   
                                                      y
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   else
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    ψ
                                    pWM
                                 
                                 (
                                 
                                    y
                                    i
                                 
                                 ,
                                 
                                    y
                                    j
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      e
                                                      
                                                         −
                                                         
                                                            
                                                               (
                                                               1
                                                               −
                                                               
                                                                  P
                                                                  j
                                                               
                                                               )
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      y
                                                      i
                                                   
                                                   ≠
                                                   
                                                      y
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   else
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Here, I
                        
                           i
                         and I
                        
                           j
                         represents the FLAIR MRI intensity of i
                        
                           th
                         and j
                        
                           th
                         pixel and P
                        
                           j
                         represents the probability of j
                        
                           th
                         pixel being located in the white matter region. Loopy belief propagation (LBP) [33] is used to infer the outcome of MRF. Fig. 5
                         shows the final segmentation result after applying MRF.

MRF reduces the number of false positive lesions because it updates the prior knowledge-based segmentation obtained using neighbourhood intensity and anatomical information from the test image. To set the value of α and β we choose a separate group of 12 patients and perform segmentation using different values of α and β. Maximum dice similarity index was obtained for α
                        =0.4 and β
                        =0.6 on that patient group. Note that these 12 patients are not part of the test dataset used for evaluating the algorithm.

@&#EVALUATION@&#

The performance of our method was evaluated by using a free-response receiver-operating characteristic (FROC) curve and dice similarity index [34]. The FROC curve was determined by changing the threshold value for the Random forest output based on the four-fold cross validation test. The dice similarity index (DSI) is calculated by the following equation, which denotes the degree of coincidence between the candidate region C obtained by our method and the ground truth region T by the manual method:
                           
                              (3)
                              
                                 DSI
                                 =
                                 
                                    
                                       2
                                       *
                                       
                                          
                                             n
                                             (
                                             C
                                             ∩
                                             T
                                             )
                                          
                                          
                                             n
                                             (
                                             C
                                             ∪
                                             T
                                             )
                                             )
                                          
                                       
                                    
                                    
                                       1
                                       +
                                       
                                          
                                             n
                                             (
                                             C
                                             ∩
                                             T
                                             )
                                          
                                          
                                             n
                                             (
                                             C
                                             ∪
                                             T
                                             )
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        where T is the ground truth region manually determined by an experienced neuroradiologists, C is the true positive region automatically determined by using our method, n(T
                        ∩
                        C) is the number of logical AND pixels between T and C, and n(T
                        ∪
                        C) is the number of logical OR pixels regions between T and C. All candidate regions were classified into true positives and false positives based on the following criteria: if a true region included at least one pixel of a candidate region, the candidate region was classified as a true positive. Otherwise, the candidate region was considered as a false positive [34]. For the evaluation of our method we use four fold cross validation, sequentially one fold is used for testing and remaining three folds are used for training.

@&#RESULTS AND DISCUSSION@&#

White matter lesion (WML) loads are typically divided into three groups: severe lesion load (>10ml), moderate lesion load (between 6ml to 10ml) and mild lesion load (0ml to 5ml) [35]. In our method, random forest (RF) classifier is used for the initial segmentation of white matter lesions as mentioned in Section 2.5. Then Markov Random Field (MRF) is used to remove false positive lesions and obtain the final segmentation. We have compared four state of the art classifiers which are random forest (RF), neural network (NN), support vector machine (SVM) and Naive Bayes (NB) in our dataset. In case of RF, the number of tree is set to 400 and minimum leaf size is set to 10. In case of NN, we use a feed forward neural network where hidden layer number is set to 3. The Levenberg Marquardt algorithm (LMA) [36] based mean square error minimization is used as the training function. In case of SVM, we use linear kernel where C is set to 1 and γ is set to 0.25. For Naive Bayes classifier we assume the distribution of the feature set as normal distribution. The area under the curve for each of these classifiers are shown in Fig. 6
                     . The RF classifier is showing the maximum area under the ROC curve compared to the other three classifiers. Therefore we select RF classifier for initial classification of WML. In addition, parameter estimation for random forest is comparatively easier than for other state of the art classifiers.

We first evaluate our method with respect to the manual grading of the expert grader (neuroradiologist, having more than 30 years of experience in this field), where the expert grader given pixel label is used to train and test our method. To evaluate the accuracy of our RF based initial white matter lesion segmentation, free-response receiver operating characteristic (FROC) curve is determined by changing the threshold value for the random forest given probability score. FROC for severe lesion load, moderate lesion load and mild lesion load is shown in Fig. 7
                     . The optimal operating point for the FROC curve for severe, moderate and mild lesion load is respectively: 79% sensitivity with 1.27 false positives per slice, 77% sensitivity with 1.60 false positives per slice and 76% sensitivity with 1.32 false positives per slice.

Table. 2
                      shows the performance of random forest given initial segmentation and MRF given final segmentation for severe, moderate and mild lesion load category. For severe lesion load category, at the RF given initial segmentation step, Our method detected 79% of the lesions with 1.27 false positives per slice. Incorporation of MRF based false positive removal method shows a significant decrement in false positives per slice which is 36% (1.27–0.80) with a slight decrease in the sensitivity which is 8.45% (79–73%). In the case of overall segmentation accuracy, incorporation of MRF based false positive removal method increases the dice similarity index from 0.75 to 0.76. For moderate lesion load category, at the RF given initial segmentation step, Our method detected 77% of the lesions with 1.60 false positives per slice. Incorporation of MRF based false positive removal method shows a significant decrement in false positives per slice which is 31% (1.60–1.09) with a slight decrease in the sensitivity which is 6.86% (77–72%). In case of overall segmentation accuracy, incorporation of MRF based false positive removal method increases the dice similarity index from 0.71 to 0.73. For mild lesion load category, at the RF given initial segmentation step, Our method detected 76% of the lesions with 1.32 false positives per slice. Incorporation of MRF based false positive removal method shows a significant decrement in false positives per slice which is 31% (1.32–0.77) with a slight decrease in the sensitivity which is 6.5% (76–71%). In case of overall segmentation accuracy, incorporation of MRF based false positive removal method increases the dice similarity index from 0.52 to 0.61. Our method is compared with three state of the art methods: Schmidt et al. [20], Steenwijk et al. [10] and Khayati et al. [19] on 24 subjects of ENVISion dataset. We obtain two manual gradings of the WMLs for each subject in ENVISion dataset, they were graded by an expert grader and a grader who is working on this domain for more than 3 years. The manual grading of the expert grader is used to train our method. Table 3
                      shows the dice similarity index between the segmented WMLs obtained by each of these methods and the manual segmentation of the WMLs made by two graders for three WML load categories.

Our method outperforms Steenwijk et al. [10] and Schmidt et al. [20] in severe, moderate, and mild lesion load category. To compute the statistical significance of the comparisons we have performed an independent sample t-test between the dice similarity index (DSI) obtained by our method and the DSI obtained by [10] and [20]. For both of these methods the computed p-value in all lesion load categories in the t-test is ≤0.01, which justify the statistical significance of the comparison. Our method is showing higher mean dice similarity index compared to Khayati et al. [19] for all lesion load categories. Since we have only eight subjects for each category therefore the p-value of the t-test on the DSI obtained by our method and Khayati et al. [19] is greater than 0.05 for severe and moderate lesion load. But in mild lesion load category, inspite of the low number subjects (8 subjects) our method is showing statistically significant improvement (p≤0.02) in DSI compared to Khayati et al. [19] with respect to the ground truth made by both graders.


                     Table 3 shows that the mean dice similarity index (DSI) slightly varies when the ground truth or training data changes. We compute independent sample t-test between the DSI of our method obtained with respect to the ground truth made by grader 1 and grader 2, the results of the t-test show a p-value of 0.14, 0.06 and 0.34 respectively for severe, moderate and mild lesion load category, which indicate that the segmentation accuracy does not significantly changes with the changes in the training data.

In addition we shuffle the subjects data randomly to produce 100 different permutations of the subjects. For each random permutation we run four fold cross validation resulting 400 evaluations. The mean and variance in the dice similarity index for the mild, medium and severe lesion load category obtained in these 100 permutations are reported in Table 4
                     . Table 4 shows that inspite of 100 different permutations of the subjects our method shows little variance in the segmentation accuracy for severe, moderate and mild lesion load categories.

We use multi atlas label fusion for the creation of tissue probability masks. In multi atlas label fusion atlas images are registered with the target image, therefore it is not necessary that the target images and the atlas images come from the same imager. Table 5
                      represents the impact of the tissue probability masks in the segmentation accuracy. Table 5 shows that after the inclusion of tissue probability masks in the feature set dice similarity index increases for all lesion load categories.

To demonstrate the robustness of our proposed method and to justify the applicability of the proposed method in a different neurological disease, we use a benchmark dataset made available by Medical Image Computing and Computer Aided Intervention Society's (MICCAI's) [37] MS Lesion Segmentation Challenge 2008. The dataset consists of 20 subjects acquired at the Children Hospital Boston(CHB) and University of North Carolina (UNC). CHB and UNC both site contains 10 subjects. The dataset has three modalities such as T1, T2 and FLAIR with dimension of 512×512×512 and resliced at 0.5mm×0.5mm×0.5mm resolution using cubic spline interpolation. We use leave one out cross validation for the evaluation of our method. For the random forest based initial segmentation, number of trees are set to 400 and minimum leaf size is set to 10. For the evaluation we compute dice similarity coefficient DSC
                     =(2×
                     TP)/(FP
                     +
                     FN
                     +2×
                     TP) with the number of true positive (TP), false positive (FP) and false negative (FN) pixels. The DSC rewards a method for its ability to detect lesions and to reject healthy tissue. We also calculate the true positive rate TPR
                     =(TP)/(TP
                     +
                     FN), and the positive predictive value PPV
                     =(TP)/(TP
                     +
                     FP). This allows us to compare our results with those of Souplet et al. [38], Geremia et al. [17] and Weiss et al. [39]. Across the whole MICCAI dataset, the proposed method achieved a mean (standard deviation) TPR of 0.55 (0.19), PPV of 0.38 (0.15) and DSC of 0.42 (0.15). This is higher than the TPR of 0.20 (0.13), PPV of 30 (0.17) and DSC of 0.21 (0.10) provided by Souplet et al. [38], TPR of 0.39 (0.18), PPV of 0.40 (0.20) and DSC of 0.36 (0.14) provided by Geremia et al. [17] and TPR of 0.34 (0.16), PPV of 0.35 (0.18) and DSC of 0.32 (0.14) provided by Weiss et al. [17]. To compute the statistical significance of the comparisons we have performed an independent sample t-test between the DSC, TPR and PPV obtained by our method and the DSC, TPR and PPV obtained by [38,17,39]. Table 6
                      shows that our method has achieved statistically significant improvement in TPR and DSC compared to all these method. In case of PPV, p-value is higher (0.31) for [17,39]. DSC is refereed as a measurement of over-all segmentation accuracy [39] and in case of DSC our method is showing statistically significant improvement compared to the methods proposed in [38,17,39].

@&#CONCLUSION@&#

We have developed a fully automated method for the detection of white matter lesions (WMLs) in brain MR images using enhanced intensity, anatomical and spatial feature based random forest and Markov Random Field (MRF). Our proposed MRF is based on a novel edge potential function that uses spatial and intensity interaction in a local neighbourhood to obtain the optimal segmentation outcome. The proposed method is evaluated on two distinct datasets (ENVISion dataset with WMLs and MICCAI dataset with MS Lesions) where it shows significant improvement over the state of the art methods. Our future goal is to apply our method on a large scale longitudinal dataset to increase understanding of the underlying relationship of the size and location of WML with biomarkers for white matter ischaemia such as hypertension, diabetes, smoking and age.

@&#REFERENCES@&#

