@&#MAIN-TITLE@&#Detection of Lagrangian Coherent Structures in the SPH framework

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Algorithms for the detection of Lagrangian Coherent Structures (LCSs) are presented.


                        
                        
                           
                           Formulae for the Finite-Time Lyapunov Exponent (FTLE) are derived for SPH models.


                        
                        
                           
                           The FTLE dependence on the use of enhanced SPH models is discussed.


                        
                        
                           
                           Post-processing and nested in time implementations are discussed.


                        
                        
                           
                           Some test-cases are considered giving a proof of concept for different conditions.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Smoothed Particle Hydrodynamics

Finite-Time Lyapunov Exponent

Lagrangian Coherent Structures

Vortex visualization

Breaking bow wave

@&#ABSTRACT@&#


               
               
                  The present work is dedicated to the detection of Lagrangian Coherent Structures (LCSs) in viscous flows through the Finite-Time Lyapunov Exponents (FTLEs) which have been addressed by several works in the recent literature. Here, a novel numerical technique is presented in the context of the Smoothed Particle Hydrodynamics (SPH) models. Thanks to the Lagrangian character of SPH, the trajectory of each fluid particle is explicitly tracked over the whole simulation. This allows for a direct evaluation of the FTLE field supplying a new way for the data analysis of complex flows. The evaluation of FTLE can be either implemented as a post-processing or nested into the SPH scheme conveniently. In the numerical results, three test-cases are presented giving a proof of concept for different conditions. The last test-case regards a naval engineering problem for which the present algorithm is successfully used to capture the submerged vortical tunnels caused by the splashing bow wave.
               
            

@&#INTRODUCTION@&#

When analysing a complex flow field the use of the primary variables, like pressure and velocity, can be not sufficient for a deep understanding of the considered phenomena. For example the identification of fluid regions concerned by vortical structures, and more generally by Coherent Structures (CSs), can be particularly challenging. In order to identify the CSs in the flow field, different criteria based on derived quantities of the velocity gradient tensor have been developed so far: iso-vorticity surfaces, 
                        Q
                     -criterion  [1], 
                        Δ
                     -criterion  [2]
                     
                        
                           
                              λ
                           
                           
                              2
                           
                        
                     -criterion (or swirling strength criterion  [3]), Eigen helicity density field  [4], etc. However, as discussed in the pioneering work by Haller (2005)  [5], under certain conditions most of the definitions of a vortex cannot be objective or not so suitable for an analysis of the flow-data (especially in a 3D context).

In the SPH literature for instance there are many 3D studies that bring insights into flow physics through identification of CSs thanks to the above cited quantities. For example, in Marrone et al.  [6] and  [7] both Lagrangian trackers and 
                        Q
                     -criterion are used to study ship bow breaking waves. Conversely, in Farahani and Dalrymple  [8] a solitary wave breaking is simulated with the Smoothed Particle Hydrodynamics (SPH) and the 
                        
                           
                              λ
                           
                           
                              2
                           
                        
                     -criterion is used to identify vortex structures beneath the free surface. The above examples point out that there is not a universal rule for extracting the CSs. However, for different kind of applications the proper criteria should be wisely selected in order to detect in an optimal way the desired flow features. For this reason in the recent literature new algorithms have been proposed for the identification of Coherent Structures through a Lagrangian framework.

The so-called Lagrangian Coherent Structures (LCSs) can be seen as an alternative way with some specific advantages for drawing the CSs from a given flow field. LCSs can be found through algorithms based on the identification of the skeletons of the most repelling/attracting material surfaces in a flow (see  [9–12]). These skeletons act as inner boundaries that organize the main flow structures. LCSs can clearly show up the flow features like: vortex motion, material transportation, exchanging and mixing, etc., which supply a practical way to explore and understand the underlying mechanisms  [13].

In order to identify the LCSs with an objective diagnostic quantity Haller identified the Finite-time Lyapunov Exponent (FTLE) as a suitable measure (see e.g.  [14,15,12]). Indeed, the FTLE represents the rate of separation of the nearby fluid particles over a finite time interval, defining a scalar field where an LCS can then be sought as an extremizing surface (a ridge or a trench). A ridge is here defined as in  [12]: “a hypersurface along which one sees a smaller change in the value of the scalar than in directions transverse to the ridge. A trench can then be defined as a ridge of the negative of the scalar field”. FTLEs can be evaluated both in forward and backward time directions. In the former the ridges visualize the LCSs formed by the most repelling material surfaces while going backward in time the ridges reveal the LCSs formed by the most attracting material surfaces (see Section  2). For the above reasons FTLEs are also used for studying the behaviour of suspended particulates in complex turbulent flows to identify regions of strong inhomogeneities in their spatial distribution  [16].

The main advantages of the FTLE with respect to other quantities as vorticity, Q-surfaces, 
                        
                           
                              λ
                           
                           
                              2
                           
                        
                     -surfaces, etc. can be summarized in: 
                        
                           (i)
                           FTLE is a quantity integrated in time and therefore local fluctuations of the velocity field do not induce much numerical noise on it. This is not the case for vorticity or other derived velocity quantities.

FTLE is formulated in the Lagrangian frameworks allowing for a better identification of the LCSs with respect to quantities derived from the velocity gradient.

FTLE is able to identify LCSs with an accuracy that in some cases resemble the one obtained by using advanced experimental technique. For example the streaklines given by the electrolytic precipitation used in  [17] for the visualization of unsteady separated flow around bodies.

Top plot of Fig. 1
                      shows an example of the use of attracting FTLE contour plot for capturing the LCSs of a von Kármán street shed by a flow past a circular cylinder at 
                        
                           Re
                        
                        =
                        105
                     . The SPH FTLE field has been calculated with the algorithm proposed in Section  3. On the bottom plot of the same figure a photo from experiments conducted by Taneda  [17] is depicted. One may find that the shape of the attracting LCSs resembles the experimental streaklines which are shown by electrolytic precipitation in water.

In the literature FTLEs are mainly applied in the analysis of the velocity fields from: (i) mathematical modelling of dynamic systems (see e.g.  [10]), (ii) experimental data (see e.g.  [13]) or (iii) computational data from Eulerian mesh-based solvers (see e.g.  [18]). In the latter, the FTLEs are more often evaluated using passive tracers inside the flow field. In this case two important steps are needed: (i) interpolate the velocities on these tracers based on the background velocity field; (ii) integrate in time according to the equation of motion to update their positions. The above two steps are repeated and FTLEs can be calculated through the tracer trajectories. This process needs particular care when the flow evolves within complex boundaries (e.g. moving or deforming boundaries, folding or fragmentation of material interfaces, etc.); furthermore, in such a condition the algorithm can become also CPU demanding (see e.g.  [19]).

The above procedure is significantly simplified when using Particle models, such as the SPH, since the domain is already discretized in fluid particles that are advected according to the flow equations. In this way, one can evaluate the FTLE field without considerable modification of the code and avoiding significant extra computational costs.

A first SPH application on the FTLE field for the detection of Lagrangian coherent flow structures can be found in  [20]. In the that work the evaluation of the FTLE is carried out by simply measuring the relative position of initially nearby particles which are paired to form a set of couples. Conversely in the present article a more accurate algorithm is presented based on the so-called Polar Decomposition. Through this decomposition it is possible to define a stretching tensor whose eigenvalues allow the FTLE evaluation. Two different methods are derived within this framework. In the first one the particle positions are directly used along with a meshless interpolation formula for the evaluation of spatial gradients. The second one is based on the time integration of an ODE for the FTLE. The different methods present advantages and drawbacks. In particular we show that the first one is more suitable for standard SPH models while the second one requires more enhanced schemes.

The paper is organized as follows: in Section  2, basic principles of FTLE are described; Section  3 is dedicated to the evaluation of FTLE within the SPH framework. Section  4 briefly recalls the SPH scheme used in the present study. Finally, in Section  5 FTLEs are applied to detect the repelling or attracting LCSs in specific numerical test cases. It is demonstrated that FTLEs are fairly suitable in SPH to reveal the main flow features. Conclusions and further development will wrap up the paper.

In the present section the theory of continuum mechanics is considered in order to define the deformation of elementary fluid volumes when evolving through a flow field. With the notation: 
                           
                              
                                 
                                    x
                                 
                                 
                                    (
                                    t
                                    ;
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       X
                                    
                                    )
                                 
                              
                           
                         we identify the position at time 
                           t
                         of a generic material point which at a past time 
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           
                           <
                           
                           t
                         has spatial position 
                           
                              X
                           
                         in a defined reference frame. We can therefore define a flow map 
                           ϕ
                         that links in a biunique way the two sets of points 
                           
                              x
                           
                         and 
                           
                              X
                           
                        : 
                           
                              (1)
                              
                                 
                                    x
                                 
                                 
                                    (
                                    t
                                    ;
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       X
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       X
                                    
                                    )
                                 
                                 .
                              
                           
                         Due to the properties of the flow map, this function can always be reversed, so that: 
                           
                              (2)
                              
                                 
                                    X
                                 
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    ;
                                    t
                                    ,
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       φ
                                    
                                    
                                       t
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          [
                                          
                                             
                                                ϕ
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                t
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

Besides the past and the present time configurations, for the following analysis, we introduce also a future time configuration at 
                           
                              
                                 t
                              
                              
                                 f
                              
                           
                           >
                           t
                         with positions 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 f
                              
                           
                        . Using the map 
                           ϕ
                         we get that: 
                           
                              (3)
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       f
                                    
                                 
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          f
                                       
                                    
                                    ;
                                    t
                                    ,
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       t
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             f
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

Left plot of Fig. 2
                         sketches two pathlines that attract in the time interval 
                           
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ,
                              t
                              )
                           
                         indicating an attracting motion of the flow in the forward time 
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           →
                           t
                        . Using the inverse flow map 
                           φ
                         the pathlines are repelling in backward time direction. The right plot of the same figure shows a repelling motion in the forward time where two neighbour particles, 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 j
                              
                           
                        , at the present time 
                           t
                         are separating by the action of the flow map 
                           ϕ
                        .

Through the analysis of the properties of the spatial gradient of the flow map 
                           ϕ
                         it is possible to identify univocally these pathlines configurations. To this purpose the deformation gradient 
                           F
                         is defined as: 
                           
                              (4)
                              
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       X
                                    
                                    )
                                 
                                 ≔
                                 
                                    
                                       ∂
                                       
                                          x
                                       
                                    
                                    
                                       ∂
                                       
                                          X
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∂
                                       
                                          
                                             ϕ
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             t
                                          
                                       
                                       
                                          (
                                          
                                             X
                                          
                                          )
                                       
                                    
                                    
                                       ∂
                                       
                                          X
                                       
                                    
                                 
                              
                           
                         the first property of this tensor can be derived through its determinant. Indeed this Jacobian measures the ratio between the elementary volumes 
                           d
                           
                              
                                 V
                              
                              
                                 0
                              
                           
                         at times 
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                         and 
                           d
                           V
                         at time 
                           t
                         related to the material point having a past position 
                           
                              X
                           
                        : 
                           
                              (5)
                              
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       X
                                    
                                    )
                                 
                                 ≔
                                 det
                                 
                                    (
                                    
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          t
                                       
                                    
                                    
                                       (
                                       
                                          X
                                       
                                       )
                                    
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       d
                                       V
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                    
                                    
                                       d
                                       
                                          
                                             V
                                          
                                          
                                             0
                                          
                                       
                                       
                                          (
                                          
                                             X
                                          
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                         If the flow map 
                           ϕ
                         describes an incompressible flow, 
                           J
                         is always equal to 1 for each time 
                           t
                         and for each material point (i.e.  
                           ∀
                           
                              X
                           
                        ).

The so-called forward-in-time Right-Cauchy–Green strain tensor can be evaluated through the relation: 
                           
                              (6)
                              
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       X
                                    
                                    )
                                 
                                 ≔
                                 
                                    
                                       
                                          [
                                          
                                             
                                                F
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                t
                                             
                                          
                                          
                                             (
                                             
                                                X
                                             
                                             )
                                          
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       X
                                    
                                    )
                                 
                              
                           
                         being 
                           
                              
                                 
                                    [
                                    ]
                                 
                              
                              
                                 T
                              
                           
                         the transpose operation. The determinant of 
                           C
                         is equal to 
                           
                              
                                 J
                              
                              
                                 2
                              
                           
                        .

In a similar way the above equations can be used to define forward-in-time tensors using the configuration 
                           
                              x
                           
                         and 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 f
                              
                           
                         at time 
                           t
                         and 
                           
                              
                                 t
                              
                              
                                 f
                              
                           
                        .

Because of the properties of the map 
                           ϕ
                        , it is always possible to invert the tensor 
                           
                              
                                 F
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 t
                              
                           
                         defining a backward-in-time deformation gradient: 
                           
                              (7)
                              
                                 
                                    
                                       F
                                    
                                    
                                       t
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 ≔
                                 
                                    
                                       ∂
                                       
                                          X
                                       
                                    
                                    
                                       ∂
                                       
                                          x
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∂
                                       
                                          
                                             φ
                                          
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                    
                                    
                                       ∂
                                       
                                          x
                                       
                                    
                                 
                              
                           
                         and the following relation holds: 
                           
                              (8)
                              
                                 
                                    
                                       F
                                    
                                    
                                       t
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       X
                                    
                                    )
                                 
                                 =
                                 I
                                 .
                              
                           
                        
                     

The backward-in-time Right-Cauchy–Green strain tensor can be evaluated as: 
                           
                              (9)
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 ≔
                                 
                                    
                                       
                                          [
                                          
                                             
                                                F
                                             
                                             
                                                t
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                 
                                    
                                       F
                                    
                                    
                                       t
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                              
                           
                         and it is worth to note that, differently from the tensor 
                           F
                        , the relation between forward and backward-in-time tensors 
                           C
                         is: 
                           
                              (10)
                              
                                 
                                    
                                       
                                          [
                                          
                                             
                                                C
                                             
                                             
                                                t
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          ]
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       X
                                    
                                    )
                                 
                                 
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       X
                                    
                                    )
                                 
                                 
                                 
                                    
                                       F
                                    
                                    
                                       t
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       X
                                    
                                    )
                                 
                                 
                                    
                                       
                                          [
                                          
                                             
                                                F
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                t
                                             
                                          
                                          
                                             (
                                             
                                                X
                                             
                                             )
                                          
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ≕
                                 
                                    
                                       B
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       X
                                    
                                    )
                                 
                              
                           
                         where the tensor 
                           
                              
                                 B
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 t
                              
                           
                           
                              (
                              
                                 X
                              
                              )
                           
                         is the forward-in-time Left-Cauchy–Green strain tensor.

In order to better understand the physical meaning of the tensors 
                              C
                            and 
                              B
                           , the polar decomposition (see e.g.  [21]) of the tensor 
                              F
                            is used in the following. The latter consists in the definition of two new tensors 
                              R
                            and 
                              U
                            such that: 
                              
                                 (11)
                                 
                                    F
                                    =
                                    R
                                    
                                    U
                                    
                                    
                                    R
                                    ∈
                                    Orth
                                    ,
                                    
                                    U
                                    ∈
                                    Sym
                                 
                              
                            being 
                              R
                            the rotation tensor, 
                              U
                            the right stretching tensor, 
                              Orth
                            the set of the rotation tensors and 
                              Sym
                            the set of the symmetric tensors.

Using Eq. (11) on the definition of the Right-Cauchy–Green strain tensor (6) together with the properties of the tensor 
                              R
                            and 
                              U
                            we get: 
                              
                                 (12)
                                 
                                    C
                                    =
                                    
                                       
                                          F
                                       
                                       
                                          T
                                       
                                    
                                    
                                    F
                                    =
                                    
                                       
                                          U
                                       
                                       
                                          T
                                       
                                    
                                    
                                    
                                       
                                          R
                                       
                                       
                                          T
                                       
                                    
                                    
                                    R
                                    
                                    U
                                    =
                                    
                                       
                                          
                                             [
                                             U
                                             ]
                                          
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                            Therefore the tensor 
                              C
                            is linked just to the stretching deformation of the fluid elementary volumes under the action of the considered flow 
                              ϕ
                           . From Eq. (12) results that the tensor 
                              C
                            is symmetric (like 
                              U
                           ) and positive defined, (i.e.  
                              C
                              ∈
                              
                                 
                                    Sym
                                 
                                 
                                    +
                                 
                              
                           ) therefore its eigenvalues are always positive real numbers. The multiplication of the three eigenvalues (in a 3D framework) of 
                              C
                            gives: 
                              
                                 (13)
                                 
                                    
                                       
                                          Λ
                                       
                                       
                                          min
                                       
                                    
                                    
                                    
                                       
                                          Λ
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                       
                                          Λ
                                       
                                       
                                          Max
                                       
                                    
                                    =
                                    det
                                    C
                                    =
                                    
                                       
                                          J
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            being 
                              
                                 
                                    Λ
                                 
                                 
                                    min
                                 
                              
                            and 
                              
                                 
                                    Λ
                                 
                                 
                                    Max
                                 
                              
                            the smallest and largest eigenvalues of the tensor 
                              C
                            respectively. If an incompressible flow is considered the above relation becomes: 
                              
                                 
                                    
                                       
                                          
                                       
                                    
                                 
                              
                            therefore 
                              
                                 
                                    Λ
                                 
                                 
                                    Max
                                 
                              
                            is always a number greater than or equal to 1 measuring an elongation of the fluid volume in the specific direction identified by the related eigenvector. Similarly 
                              
                                 
                                    Λ
                                 
                                 
                                    min
                                 
                              
                            is always less than or equal to 1 measuring the contraction of the fluid volume.

In analogous way the polar decomposition can be defined using the left stretching tensor 
                              V
                           : 
                              
                                 
                                    F
                                    =
                                    V
                                    
                                    R
                                    
                                    
                                    R
                                    ∈
                                    Orth
                                    ,
                                    
                                    V
                                    ∈
                                    Sym
                                 
                              
                            and the Left-Cauchy–Green strain tensor 
                              B
                            will be: 
                              
                                 
                                    B
                                    =
                                    F
                                    
                                    
                                       
                                          F
                                       
                                       
                                          T
                                       
                                    
                                    =
                                    V
                                    
                                    R
                                    
                                    
                                       
                                          R
                                       
                                       
                                          T
                                       
                                    
                                    
                                    
                                       
                                          V
                                       
                                       
                                          T
                                       
                                    
                                    =
                                    
                                       
                                          
                                             [
                                             V
                                             ]
                                          
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        

Thanks to the above properties the forward-in-time FTLE, 
                           
                              
                                 λ
                              
                              
                                 t
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       f
                                    
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                        , in the time range 
                           
                              (
                              t
                              ,
                              
                                 
                                    t
                                 
                                 
                                    f
                                 
                              
                              )
                           
                        , can be evaluated as (see e.g.  [5]): 
                           
                              (14)
                              
                                 
                                    
                                       
                                    
                                 
                              
                           
                         The physical meaning of 
                           
                              
                                 λ
                              
                              
                                 t
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       f
                                    
                                 
                              
                           
                         is the rate of separation of the trajectories of nearby material points in the present reference positions 
                           
                              x
                           
                        . Indeed, the field 
                           
                              
                                 Λ
                              
                              
                                 Max
                              
                           
                           
                              [
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          f
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              ]
                           
                         identifies material points subjected to large volume elongations. Thus, for a given time 
                           t
                        , the material points in 
                           
                              x
                           
                         that present high values of 
                           
                              
                                 λ
                              
                              
                                 t
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       f
                                    
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         is expected to lie on strong “repellent” pathlines.

Conversely, using the backward-in-time deformation gradient, 
                           
                              
                                 F
                              
                              
                                 t
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         and the related backward-in-time Right-Cauchy–Green 
                           
                              
                                 C
                              
                              
                                 t
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        , a backward-in-time FTLE, 
                           
                              
                                 λ
                              
                              
                                 t
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         in the time range 
                           
                              (
                              t
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                           
                         can be evaluated through: 
                           
                              (15)
                              
                                 
                                    
                                       
                                    
                                 
                              
                           
                         The physical meaning of 
                           
                              
                                 λ
                              
                              
                                 t
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         is the rate of separation of the trajectories of nearby material points in the present reference positions 
                           
                              x
                           
                         when moving backward in time. The material points in 
                           
                              x
                           
                         at time 
                           t
                         that present high values of 
                           
                              
                                 λ
                              
                              
                                 t
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                         as expected to lies on strong “attracting” pathlines when moving from 
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                         to 
                           t
                         (i.e. from 
                           
                              X
                           
                         to 
                           
                              x
                           
                        ).

Eqs. (14) and (15) are the key points for the identification of the LCSs as already shown and discussed in the recent literature (see e.g.  [15]).

Thanks to the use of a future and a past configuration references, both 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    +
                                    )
                                 
                              
                           
                        , the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         have been defined on the material points 
                           
                              x
                           
                         at the time 
                           t
                        . This aspect becomes crucial when problems with moving boundaries are considered as shown in Section  5.1.

Regarding the eigenvalues of Right-Cauchy–Green strain tensor, using the relation (10) it is easy to show that: 
                           
                              (16)
                              
                                 
                                    
                                       Λ
                                    
                                    
                                       Max
                                    
                                 
                                 
                                    [
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    ]
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             Λ
                                          
                                          
                                             min
                                          
                                       
                                       
                                          [
                                          
                                             
                                                C
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                t
                                             
                                          
                                          
                                             (
                                             
                                                X
                                             
                                             )
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                         which in other words express that the most repellent pathlines in backward time identified by the 
                           
                              
                                 Λ
                              
                              
                                 Max
                              
                           
                           
                              [
                              
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              
                              ]
                           
                        , are the most attracting pathlines (minimum eigenvalue) in forward time (see sketches in Fig. 2 and for details  [22]).

Using the above relation in (15) the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         can be evaluated also as: 
                           
                              (17)
                              
                                 
                                    
                                       
                                    
                                 
                              
                           
                         which is a hybrid way to get the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         using the forward-in-time Right-Cauchy–Green strain tensor. This formula can be useful for the evaluation of the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                        s when forward-in-time deformation gradients are available by a time integration, as discussed in the next section.

Furthermore, if a 2D incompressible flow is considered a further relation holds (see Eq. (13)): 
                           
                              (18)
                              
                                 
                                    
                                       
                                    
                                 
                              
                           
                         and Eq. (17) becomes: 
                           
                              (19)
                              
                                 
                                    
                                       
                                    
                                 
                              
                           
                         which is a surprisingly simple result as stressed by Haller and Sapsis  [22]. Indeed in a 2D incompressible flow if a point 
                           
                              X
                           
                         at time 
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                         is in a most repelling region, at time 
                           t
                         it will be in the 
                           
                              x
                           
                         position belonging to a most attracting region. The sketch proposed in Fig. 3
                         gives a clarification of this properties showing that the tensor 
                           C
                         identifies the most stretched fluid volume and in a 2D incompressible framework attracting and repelling pathlines are linked to this deformation motion.

Summarizing in the present section we showed that the FTLE can be evaluated using different equations. For example the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         can be calculated with: (15), (17) and (19). Even if these equations are equivalent at continuous level, these may be not the case when using a discrete scheme. In particular in Section  3 we show that using the above equations different methods with different accuracy can be derived within the SPH framework.

In the previous section the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         relations refer to two different spatial configurations: the first one at 
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                         where material points have positions 
                           
                              X
                           
                         and the second one at time 
                           t
                         where the material points have settled to position 
                           
                              x
                           
                        . Hence, the derived formulae do not involve any time derivative of the flow quantities.

Here, similarly to the method proposed by  [23], the evaluation of tensors 
                           F
                         is based on a time integration of an ODE for the forward-in-time deformation gradient. To this purpose we start defining the velocity field, 
                           
                              u
                           
                           
                              (
                              
                                 x
                              
                              ,
                              t
                              )
                           
                         associated to the material points as: 
                           
                              (20)
                              
                                 
                                    u
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    ,
                                    t
                                    )
                                 
                                 ≔
                                 
                                    
                                       d
                                       
                                       
                                          x
                                       
                                       
                                          (
                                          t
                                          ;
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             X
                                          
                                          )
                                       
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 .
                              
                           
                        
                     

Second step concerns the derivation in time of the deformation gradient which can be expressed combining Eqs. (4) and (20) as: 
                           
                              (21)
                              
                                 
                                    
                                       d
                                       F
                                       
                                          (
                                          
                                             X
                                          
                                          )
                                       
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 =
                                 ∇
                                 
                                    u
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 
                                 F
                                 
                                    (
                                    
                                       X
                                    
                                    )
                                 
                                 .
                              
                           
                         The above equation can be discretized in time for example with a second order finite difference formula: 
                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             F
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                    
                                       2
                                       Δ
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          [
                                          ∇
                                          
                                             u
                                          
                                          
                                          F
                                          ]
                                       
                                    
                                    
                                       n
                                    
                                 
                              
                           
                         and therefore the tensor 
                           F
                         can be evaluated through: 
                           
                              (23)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   F
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   F
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             +
                                             2
                                             Δ
                                             t
                                             
                                             
                                                
                                                   
                                                      [
                                                      ∇
                                                      
                                                         u
                                                      
                                                      
                                                      F
                                                      ]
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   F
                                                
                                                
                                                   0
                                                
                                             
                                             =
                                             I
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   F
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             I
                                             +
                                             Δ
                                             t
                                             
                                             ∇
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         being 
                           I
                         the identity tensor. The solution of (23) gives at each time 
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                         the forward-in-time deformation gradient 
                           
                              
                                 F
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        . Therefore it is possible to evaluate the forward-in-time Right-Cauchy–Green strain tensor 
                           
                              
                                 C
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        , and to get the FTLE. Obviously, different integration schemes can be used to integrate Eq. (21) also depending on the specific scheme adopted in the SPH code.

With this method it is not necessary anymore to use the spatial relation between points 
                           
                              x
                           
                         and 
                           
                              X
                           
                        . Therefore, this procedure seems more suitable for Eulerian solvers where, differently from Lagrangian ones, the positions 
                           
                              x
                           
                         are not primary unknowns.

From a numerical point of view, it is important to note that Eq. (23) depends on the velocity gradients which need to be evaluated accurately to avoid accumulation errors. In Section  3 a discussion on how we can deal with this method when using an SPH model is presented. Indeed, the evaluation of 
                           ∇
                           
                              u
                           
                         within the SPH is generally very critical because of the interpolation errors linked to the disorder of the particle distributions (see e.g.  [24,25]).

The velocity gradient 
                           ∇
                           
                              u
                           
                         can be decomposed into symmetric and antisymmetric components: 
                           
                              
                                 ∇
                                 
                                    u
                                 
                                 =
                                 W
                                 +
                                 D
                                 ,
                                 
                                 W
                                 ∈
                                 AntiSym
                                 ,
                                 
                                 D
                                 ∈
                                 Sym
                              
                           
                         being 
                           W
                         the spin tensor containing the vorticity components (see e.g.  [21]), 
                           D
                         the rate of strain tensor and 
                           AntiSym
                         the set of the antisymmetric tensors. The two tensors 
                           W
                         and 
                           D
                         are orthogonal, i.e. 
                        
                           W
                           :
                           D
                           
                           =
                           0
                        . Most of the techniques to identify vortex structures involve the tensor 
                           W
                         or a combination of 
                           W
                         and 
                           D
                         tensors, as for example the 
                           Q
                        -criterion: 
                           
                              (24)
                              
                                 Q
                                 ≔
                                 
                                    
                                       W
                                       :
                                       W
                                       −
                                       D
                                       :
                                       D
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         where 
                           Q
                         is the second invariant of the velocity gradient and a vortex region is identified as “a connected fluid region with a positive 
                           Q
                        ”. In other words a vortex is here defined as an area where the vorticity magnitude, 
                           W
                           :
                           W
                         is greater than the magnitude of rate-of-strain 
                           D
                           :
                           D
                        . In Section  5 the comparison between 
                           Q
                           −
                           c
                           r
                           i
                           t
                           e
                           r
                           i
                           a
                         and the use of the Lyapunov exponents is performed when using the SPH method.

Combining Eqs. (5) and (21) the time evolution of the Jacobian can be derived: 
                           
                              (25)
                              
                                 
                                    
                                       d
                                       J
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 =
                                 J
                                 
                                 tr
                                 
                                    (
                                    ∇
                                    
                                       u
                                    
                                    )
                                 
                                 =
                                 J
                                 
                                 Div
                                 
                                    (
                                    
                                       u
                                    
                                    )
                                 
                              
                           
                         which represents the continuity equation once a density field 
                           
                              
                                 ρ
                              
                              
                                 0
                              
                           
                           
                              (
                              
                                 X
                              
                              )
                           
                         is associated to the material points in the reference configuration. Indeed, the mass conservation prescribes that: 
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    
                                       X
                                    
                                    )
                                 
                                 
                                 d
                                 
                                    
                                       V
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    
                                       X
                                    
                                    )
                                 
                                 =
                                 ρ
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 
                                 d
                                 V
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 ⇒
                                 J
                                 =
                                 
                                    
                                       d
                                       V
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                    
                                    
                                       d
                                       
                                          
                                             V
                                          
                                          
                                             0
                                          
                                       
                                       
                                          (
                                          
                                             X
                                          
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          (
                                          
                                             X
                                          
                                          )
                                       
                                    
                                    
                                       ρ
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                    
                                 
                              
                           
                         hence Eq. (25) allows for the estimation of the time evolution of density.

In most of the SPH schemes the continuity equation is integrated in time allowing for an accurate estimation of 
                           J
                        . Conversely if Eq. (5) is used an unbounded error accumulation is observed. This can be an indication that also the evaluation of the tensor 
                           F
                        , and consequently the corresponding FTLE, through a time integration can offer numerical advantages with respect to direct evaluation using the particle positions 
                           
                              x
                           
                         and 
                           
                              X
                           
                        . This numerical aspect will be further discussed in Section  5.

In the SPH method, the fluid domain 
                           Ω
                         is discretized in a finite number of particles, 
                           
                              
                                 N
                              
                              
                                 p
                                 a
                                 r
                                 t
                              
                           
                        , representing elementary fluid volumes 
                           Δ
                           
                              
                                 V
                              
                              
                                 j
                              
                           
                        , each one with its own local mass 
                           
                              
                                 m
                              
                              
                                 j
                              
                           
                         and other physical properties, being 
                           j
                         the index of the generic 
                           j
                        th particle. In this context, a generic field 
                           f
                         at the generic position 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                         can be approximated through the convolution sum: 
                           
                              (26)
                              
                                 
                                    〈
                                    f
                                    〉
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                                 
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                 
                                 
                                 W
                                 
                                    (
                                    
                                       |
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       |
                                    
                                    ;
                                    h
                                    )
                                 
                                 
                                 Δ
                                 
                                    
                                       V
                                    
                                    
                                       j
                                    
                                 
                              
                           
                         where 
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                         is the value of 
                           f
                         associated to the generic particle 
                           j
                        , 
                           Δ
                           
                              
                                 V
                              
                              
                                 j
                              
                           
                         is its volume and finally 
                           W
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              −
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    j
                                 
                              
                              |
                              ,
                              h
                              )
                           
                         is a kernel function with a finite support. The symbol 
                           h
                         is a reference length of this support and is generally called smoothing length. When 
                           h
                         goes to zero the kernel function W tends to a delta Dirac function. For the ease of notation, hereinafter we denote the kernel simply through 
                           
                              
                                 W
                              
                              
                                 i
                                 j
                              
                           
                        . In this work a Wendland C2 kernel function is used with a compact support with a radius equal to 
                           2
                           
                           h
                         which remains constant in space and time. The particles are initially set on a given distribution of point 
                           
                              
                                 
                                    X
                                 
                              
                              
                                 j
                              
                           
                         each one associated with a given volume 
                           Δ
                           
                              
                                 V
                              
                              
                                 0
                                 j
                              
                           
                        . For instance if a regular Cartesian lattice is used with a characteristic spacing 
                           Δ
                           x
                        , the initial volume of the particle can be set with 
                           Δ
                           
                              
                                 V
                              
                              
                                 0
                              
                           
                           
                              (
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           =
                           Δ
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                         for all the 
                           j
                         particles. The ratio 
                           h
                           /
                           Δ
                           x
                         is set equal to 2, corresponding to a number of interacting neighbours, 
                           N
                        , equal to 50 in a 2D framework.

Knowing the initial density field 
                           
                              
                                 ρ
                              
                              
                                 0
                              
                           
                           
                              (
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         the mass of the particle is evaluated as: 
                           
                              
                                 
                                    
                                       m
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             X
                                          
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                 Δ
                                 
                                    
                                       V
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             X
                                          
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         The particle masses, unlike densities and volumes, do not change in time, thus ensuring the mass conservation of the whole particles system.

The spatial derivatives of the primary variables (i.e. velocity and pressure) are evaluated through the formulae: 
                           
                              (27)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      〈
                                                      ∇
                                                      
                                                         u
                                                      
                                                      〉
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         u
                                                      
                                                   
                                                   
                                                      j
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         u
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             ⊗
                                             
                                                
                                                   ∇
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   W
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                             Δ
                                             
                                                
                                                   V
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      〈
                                                      ∇
                                                      p
                                                      〉
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                
                                             
                                             
                                             
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                   
                                                
                                                +
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                             
                                                
                                                   ∇
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   W
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                             Δ
                                             
                                                
                                                   V
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         which guarantee conservation/consistency properties to the SPH scheme (for details see e.g.  [26–28]).

For secondary variables a more accurate interpolation can be used, for example in this work the following formula is adopted: 
                           
                              (28)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      〈
                                                      ∇
                                                      f
                                                      〉
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             ≔
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      j
                                                   
                                                
                                                −
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             
                                             
                                                
                                                   ∇
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   W
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                             Δ
                                             
                                                
                                                   V
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             ≔
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                      ⊗
                                                      
                                                         
                                                            ∇
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                      Δ
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         which guarantees the first order completeness (see e.g   [29]) independently by the level of disorder of the particle distribution. On a Cartesian lattice 
                           L
                         is practically equal to 
                           I
                         if the ratio 
                           h
                           /
                           Δ
                           x
                         is enough large (order of one in 2D). In the following only uniform particle spatial resolution is considered, even if the above relations can be re-shaped for a variable resolution framework (see e.g.  [30,31]).

The first method proposed for the evaluation of the FTLE is based on the calculation of the deformation gradient 
                           F
                         using the sets of the fluid particles, 
                           
                              X
                           
                        , 
                           
                              x
                           
                         and 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 f
                              
                           
                        . The tensor 
                           F
                         can be discretized using the formulae presented in the previous section. For example, the forward-in-time deformation gradient 
                           
                              〈
                              
                                 
                                    F
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              〉
                           
                         can be derived as: 
                           
                              (29)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                〈
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      t
                                                   
                                                
                                                〉
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         X
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             ≔
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      j
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             ⊗
                                             L
                                             
                                                (
                                                
                                                   
                                                      
                                                         X
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                             
                                                
                                                   ∇
                                                
                                                
                                                   i
                                                
                                             
                                             W
                                             
                                                (
                                                
                                                   |
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                
                                                )
                                             
                                             Δ
                                             
                                                
                                                   V
                                                
                                                
                                                   0
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             L
                                             
                                                (
                                                
                                                   
                                                      
                                                         X
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             ≔
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                      ⊗
                                                      
                                                         
                                                            ∇
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                      W
                                                      
                                                         (
                                                         
                                                            |
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            |
                                                         
                                                         )
                                                      
                                                      Δ
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            0
                                                            j
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         In this equation the kernel derivation is calculated on the reference configuration using the particle positions 
                           
                              X
                           
                         and the related volumes 
                           Δ
                           
                              
                                 V
                              
                              
                                 0
                              
                           
                        . It is worth noting that 
                           
                              [
                              L
                              
                                 (
                                 
                                    
                                       
                                          X
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                              
                                 
                                    ∇
                                 
                                 
                                    i
                                 
                              
                              W
                              
                                 (
                                 
                                    |
                                    
                                       
                                          
                                             X
                                          
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          
                                             X
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                 
                                 )
                              
                              
                              Δ
                              
                                 
                                    V
                                 
                                 
                                    0
                                    j
                                 
                              
                              ]
                           
                         does not change during the time evolution and it can be stored at the beginning of the simulation. Therefore, 
                           
                              〈
                              
                                 
                                    F
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              〉
                           
                           
                              (
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         can be evaluated runtime during the simulation.

Regarding the backward-in-time deformation gradient, this can be evaluated as: 
                           
                              (30)
                              
                                 
                                    〈
                                    
                                       
                                          F
                                       
                                       
                                          t
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    〉
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 ≔
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                                 
                                 
                                    (
                                    
                                       
                                          
                                             X
                                          
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          
                                             X
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 ⊗
                                 
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       ∇
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                 Δ
                                 
                                    
                                       V
                                    
                                    
                                       j
                                    
                                 
                                 ,
                              
                           
                         here the kernel derivation is performed using the particle position 
                           
                              x
                           
                         at time 
                           t
                         as for the other SPH equations like (27) and (28). On the other hand it is necessary to store the initial particle positions 
                           
                              
                                 
                                    X
                                 
                              
                              
                                 j
                              
                           
                         to evaluate 
                           
                              〈
                              
                                 
                                    F
                                 
                                 
                                    t
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              〉
                           
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         runtime.

The formula (29) has lower CPU costs since it does not involve the evaluation at each time iteration of the tensor 
                           
                              
                                 L
                              
                              
                                 i
                              
                           
                         and its multiplication with the kernel gradient. Both Eqs. (29) and (30) can be implemented in an SPH solver or in a post-processing code giving as inputs the two configurations 
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    j
                                 
                              
                              ,
                              Δ
                              
                                 
                                    V
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         and 
                           
                              (
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    j
                                 
                              
                              ,
                              Δ
                              
                                 
                                    V
                                 
                                 
                                    0
                                    j
                                 
                              
                              )
                           
                        .

It is worth noting that, besides the time direction used for the tensor 
                           F
                        , both Eqs. (29) and (30) can be used for the evaluation of 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         (as already explained in Section  2). However, while at the continuous level the relation (8) holds, this in not true anymore at discrete level: 
                           
                              
                                 
                                    〈
                                    
                                       
                                          F
                                       
                                       
                                          t
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    〉
                                 
                                 
                                 
                                    〈
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          t
                                       
                                    
                                    〉
                                 
                                 ≠
                                 I
                              
                           
                         and therefore the two Eqs. (29), (30) are not equivalent for the evaluation of the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                        . Numerically we found that better results for 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         are obtained using (30) than using (29).

Considering the time range 
                           
                              [
                              t
                              ,
                              
                                 
                                    t
                                 
                                 
                                    f
                                 
                              
                              ]
                           
                        , the forward-in-time deformation gradient can be expressed as: 
                           
                              (31)
                              
                                 
                                    〈
                                    
                                       
                                          F
                                       
                                       
                                          t
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                f
                                             
                                          
                                       
                                    
                                    〉
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 ≔
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          f
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          f
                                          i
                                       
                                    
                                    )
                                 
                                 ⊗
                                 
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       ∇
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                 Δ
                                 
                                    
                                       V
                                    
                                    
                                       j
                                    
                                 
                                 .
                              
                           
                         This equation is similar to (30) but it can be used only in a post-processing, since the configuration 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 f
                                 j
                              
                           
                         is known only at the end of the simulation. In the following Eq. (31) is used for the evaluation of the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    +
                                    )
                                 
                              
                           
                        .

Up to here we have discussed the evaluation of FTLE within the SPH framework using the Method 1 described in Section  2.2. Concerning the Method 2 (see Section  2.3), as already stated the key point becomes the evaluation of the velocity gradient. For this reason the formula (27) is replaced by: 
                           
                              (32)
                              
                                 
                                    
                                       
                                          〈
                                          ∇
                                          
                                             u
                                          
                                          〉
                                       
                                    
                                    
                                       i
                                    
                                    
                                       C1
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 ⊗
                                 
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       ∇
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                 Δ
                                 
                                    
                                       V
                                    
                                    
                                       j
                                    
                                 
                              
                           
                         which guarantee the first order completeness. Once the velocity gradient is calculated, the forward-in-time deformation gradient 
                           
                              
                                 
                                    〈
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          t
                                       
                                    
                                    〉
                                 
                              
                              
                                 i
                              
                           
                         is integrated in time for each particle: 
                           
                              (33)
                              
                                 
                                    〈
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          t
                                          +
                                          Δ
                                          t
                                       
                                    
                                    〉
                                 
                                 
                                    (
                                    
                                       
                                          
                                             X
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    〈
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          t
                                          −
                                          Δ
                                          t
                                       
                                    
                                    〉
                                 
                                 
                                    (
                                    
                                       
                                          
                                             X
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 +
                                 2
                                 Δ
                                 t
                                 
                                 
                                    [
                                    
                                       
                                          
                                             〈
                                             ∇
                                             
                                                u
                                             
                                             〉
                                          
                                       
                                       
                                          i
                                       
                                       
                                          C1
                                       
                                    
                                    
                                    
                                    
                                       〈
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             t
                                          
                                       
                                       〉
                                    
                                    
                                       (
                                       
                                          
                                             
                                                X
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 .
                              
                           
                         Since in this paper we consider just a 2D framework for weakly compressible flow, the calculation of the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         with Method 2 is performed using Eq. (19) because of the better results obtained in the benchmark test-cases with respect to Eq. (17).

Inflow and outflow boundary conditions can be easily implemented in Eulerian CFD solvers; conversely, in Lagrangian methods they need to be treated through specific algorithms. For example in  [32], a general inflow and outflow boundary condition for handling open channel flows in SPH is introduced. That method is also adopted in the following.

Further, in this framework the adoption of the FTLE formulae of Method 1 (see Section  2.2) need to be carefully handled, since the 
                           i
                        th particle generated at the inflow has not a reference position 
                           
                              
                                 
                                    X
                                 
                              
                              
                                 i
                              
                           
                        . To solve this problem, we consider that the inflow current has a given time law: 
                           
                              
                                 
                                    
                                       U
                                    
                                    
                                       i
                                       n
                                       f
                                       l
                                       o
                                       w
                                    
                                 
                                 =
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                                 .
                              
                           
                         For a new generated 
                           i
                        th inflow particle having a position 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                         in the inflow buffer zone, it is possible to define its 
                           
                              
                                 
                                    X
                                 
                              
                              
                                 i
                              
                           
                         position as (see Fig. 4
                        ): 
                           
                              (34)
                              
                                 
                                    
                                       
                                          X
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 
                                    
                                       ∫
                                    
                                    
                                       t
                                       0
                                    
                                    
                                       t
                                    
                                 
                                 
                                 
                                    
                                       U
                                    
                                    
                                       i
                                       n
                                       f
                                       l
                                       o
                                       w
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 
                                 d
                                 t
                                 .
                              
                           
                         In this way all the inflow particles have their reference position 
                           
                              X
                           
                         and when they enter in the fluid domain this relation is maintained allowing the evaluation of the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         at each time.

On the other hand the presence of an outflow region imposes a limit on the evaluation of the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    +
                                    )
                                 
                              
                           
                         for a given time 
                           t
                        . Indeed, there are particles in the domain having configuration 
                           
                              x
                           
                           
                              (
                              t
                              )
                           
                         that, at time 
                           
                              
                                 t
                              
                              
                                 f
                              
                           
                        , are out of the domain with an unknown position 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 f
                              
                           
                        . Therefore, for those particles the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    +
                                    )
                                 
                              
                           
                         calculation is not possible.

Concerning the Method 2, since the particle positions are never used in the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         calculation, we only need to initialize the deformation gradients 
                           
                              
                                 F
                              
                              
                                 t
                                 0
                              
                              
                                 t
                              
                           
                           
                              (
                              
                                 X
                              
                              )
                           
                         to unit matrices for the particles created in the inflow buffer zone.

The algorithm proposed in the previous section can be used for all the SPH models as well as other particle methods like the MPS (Moving Particle Semi-implicit) (see e.g.  [33,34]). and it can be also extended to other particle methods since it is simply based on the particle positions: 
                        
                           
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ⇒
                              
                                 (
                                 
                                    
                                       
                                          X
                                       
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 Δ
                                 
                                    
                                       V
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              
                              t
                              ⇒
                              
                                 (
                                 
                                    x
                                 
                                 ,
                                 Δ
                                 V
                                 )
                              
                              
                              
                                 
                                    t
                                 
                                 
                                    f
                                 
                              
                              ⇒
                              
                                 (
                                 
                                    
                                       
                                          X
                                       
                                    
                                    
                                       f
                                    
                                 
                                 ,
                                 Δ
                                 
                                    
                                       V
                                    
                                    
                                       f
                                    
                                 
                                 )
                              
                              .
                           
                        
                      In order to present some applications in this section a brief description of the adopted SPH model (
                        δ
                     -SPH) is reported below.

The 
                        δ
                     -SPH is a weakly compressible SPH model characterized by the addition of a specific diffusive term inside the continuity equation which helps reducing the spurious high-frequency noise that generally affect the density/pressure fields. Similarly to the standard SPH, it preserves the mass and the linear/angular momenta. It reads: 
                        
                           (35)
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                d
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                d
                                                t
                                             
                                          
                                          =
                                          −
                                          
                                             
                                                ρ
                                             
                                             
                                                i
                                             
                                          
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          ⋅
                                          
                                             
                                                ∇
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                W
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          Δ
                                          
                                             
                                                V
                                             
                                             
                                                j
                                             
                                          
                                          +
                                          δ
                                          
                                          h
                                          
                                          
                                             
                                                c
                                             
                                             
                                                0
                                             
                                          
                                          
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                d
                                                
                                                   
                                                      
                                                         u
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                d
                                                t
                                             
                                          
                                          =
                                          −
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                
                                             
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                          
                                             
                                                ∇
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                W
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          Δ
                                          
                                             
                                                V
                                             
                                             
                                                j
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   f
                                                
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          
                                             
                                                ∇
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                W
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          Δ
                                          
                                             
                                                V
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                d
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                d
                                                t
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   u
                                                
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                c
                                             
                                             
                                                0
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   ρ
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   ρ
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                          ,
                                          
                                          Δ
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                          /
                                          
                                             
                                                ρ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                      being 
                        μ
                      and 
                        
                           
                              c
                           
                           
                              0
                           
                        
                      respectively the dynamical viscosity and the speed of sound selected. All the remaining quantities are already defined in Section  3. The diffusive terms are given by: 
                        
                           (36)
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                π
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          ≔
                                          K
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                ⋅
                                                
                                                   
                                                      
                                                         r
                                                      
                                                   
                                                   
                                                      j
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ‖
                                                         
                                                            
                                                               
                                                                  r
                                                               
                                                            
                                                            
                                                               j
                                                               i
                                                            
                                                         
                                                         ‖
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                          ≔
                                          2
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                             
                                          
                                          
                                          
                                             
                                                ψ
                                             
                                             
                                                j
                                                i
                                             
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      j
                                                      i
                                                   
                                                
                                                ⋅
                                                
                                                   
                                                      ∇
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ‖
                                                         
                                                            
                                                               
                                                                  r
                                                               
                                                            
                                                            
                                                               j
                                                               i
                                                            
                                                         
                                                         ‖
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                          Δ
                                          
                                             
                                                V
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                j
                                                i
                                             
                                          
                                          ≔
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                j
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ψ
                                             
                                             
                                                j
                                                i
                                             
                                          
                                          ≔
                                          
                                             {
                                             
                                                (
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      j
                                                   
                                                
                                                −
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         〈
                                                         ∇
                                                         ρ
                                                         〉
                                                      
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      L
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         〈
                                                         ∇
                                                         ρ
                                                         〉
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      L
                                                   
                                                
                                                )
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   j
                                                   i
                                                
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                      where 
                        K
                        =
                        2
                        
                        
                           (
                           n
                           +
                           2
                           )
                        
                      and 
                        n
                      is the number of spatial dimensions and the symbol 
                        
                           
                              
                                 〈
                                 ∇
                                 ρ
                                 〉
                              
                           
                           
                              i
                           
                           
                              L
                           
                        
                      indicates the renormalized density gradient (see  [35] for more details). As shown in  [36], the parameter 
                        δ
                      is not problem-dependent while its range of variation is quite narrow and only varies with 
                        h
                        /
                        Δ
                        x
                      (where 
                        Δ
                        x
                      is the mean particle distance). Then, for a given value of 
                        h
                        /
                        Δ
                        x
                     , there is practically no need for a tuning. Specifically, in the present work it has been set equal to 0.1 in all the simulations. The system (35) is integrated in time by using a fourth-order Runge–Kutta scheme with frozen diffusion as described in  [37].

In the following sections, we assume that the interaction with eventual solid structures is modelled through the use of ghost particles (see for details  [38,39]).

For some of the simulations presented in the following, the 
                           δ
                        -SPH scheme is modified using the particle-shifting technique. The latter has been proposed in Xu et al.  [40] in the context of the incompressible flow modelling and further developed in  [41] using a more flexible formulation. The technique is modified in the context of weakly-compressible SPH in  [42] and generalized for incompressible free surface flows in  [43] where the particle-shifting is suppressed on the particles belonging to the air–water interface in order to fulfil the kinematic boundary condition.

Following the formulation proposed in Lind et al.  [43] the particle positions are modified during the time integration of the last equation of (35) adding to the generic position 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                         the field displacement: 
                           
                              (37)
                              
                                 Δ
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                                 
                                    [
                                    1
                                    +
                                    0.2
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                
                                                   W
                                                   
                                                      (
                                                      Δ
                                                      x
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          4
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       ∇
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                 Δ
                                 
                                    
                                       V
                                    
                                    
                                       j
                                    
                                 
                                 .
                              
                           
                         Thanks to this shifting the particles are forced to remain on regular spatial distributions limiting the particle disorder and increasing the accuracy of the adopted interpolation formulae (see  [24]). This feature is mainly due to the action of the kernel gradient summation 
                           
                              
                                 ∑
                              
                              
                                 i
                              
                           
                           
                              
                                 ∇
                              
                              
                                 i
                              
                           
                           
                              
                                 W
                              
                              
                                 i
                                 j
                              
                           
                         which forces isotropic particle distributions, as discussed in  [44] and in  [28].

The modification on the particle positions 
                           Δ
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                         in principle can cause errors on the FTLE evaluation when using Method 1 (see Section  2.2). However, in the next section we show that the particle-shifting largely improves the evaluation of the velocity gradients enhancing the calculation of the FTLE using the Method 2 (see Section  2.3). The use of the particle-shifting within the 
                           δ
                        -SPH model has never been presented before in literature, and in the next section we show that Eq. (37) can be directly added to the system (35) without the necessity of changing other parts of the scheme, including the time integration.

However, it is important to underline that this additional enhancement of the 
                           δ
                        -SPH scheme can be used only in problems where no body forces are present. For instance, in a conservative force field the arbitrary displacement of a particle induces a change on its potential energy. In such a condition the particles-shifting can cause non-negligible effects on the system dynamics, possibly resulting in non-physical outcomes. This problem does not arise for ISPH models thanks to the solution of the Poisson problem for the pressure field. Further investigations on this topic, that goes beyond the study of the FTLE, are left for future work.

The first test-case concerns an ellipse with axis ratio 0.4 moving forward with angle of attack 
                           α
                           =
                           20
                         in a viscous fluid inside a rectangular box. The rectangular box is 
                           40
                           c
                         long and 
                           5
                           c
                         wide where 
                           c
                         is the major axis of the ellipse. After a short-time acceleration, the ellipse is moving in straight line with a constant velocity 
                           U
                        . The Reynolds number of the problem is 
                           Re
                           =
                           U
                           
                           c
                           /
                           ν
                           =
                           500
                        . No-slip boundary condition is applied on the ellipse while simple free-slip boundary condition is applied on the rectangular wall. The fluid domain is discretized with the resolution 
                           c
                           /
                           Δ
                           x
                           =
                           150
                         in order to accurately resolve the boundary layer region. An overall number of 4,500,000 particles is used.

The aim of this case is to show the detection of the so-called “repelling” and “attracting” LCSs (see  [12]) using respectively the ridges of 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    +
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         behind the moving ellipse. Three different time instants are therefore considered: 
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           =
                           0
                         the initial time of the simulation, 
                           t
                         a generic time, and 
                           
                              
                                 t
                              
                              
                                 f
                              
                           
                           =
                           30
                           c
                           /
                           U
                         seconds the final time of the simulation.

We start using the Method 1 presented in Sections  2.2 and 3.2 and the equation used for the forward and backward FLTEs are: 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                FTLE
                                             
                                             
                                                
                                                   (
                                                   +
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             〈
                                             
                                                
                                                   λ
                                                
                                                
                                                   t
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         f
                                                      
                                                   
                                                
                                             
                                             〉
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   |
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         f
                                                      
                                                   
                                                   −
                                                   t
                                                   |
                                                
                                             
                                          
                                          ln
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         Max
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         〈
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               t
                                                            
                                                            
                                                               
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     f
                                                                  
                                                               
                                                            
                                                         
                                                         〉
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                FTLE
                                             
                                             
                                                
                                                   (
                                                   −
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             〈
                                             
                                                
                                                   λ
                                                
                                                
                                                   t
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             〉
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   |
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   −
                                                   t
                                                   |
                                                
                                             
                                          
                                          ln
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         Max
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         〈
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               t
                                                            
                                                            
                                                               
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                         〉
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                             
                                             }
                                          
                                          .
                                       
                                    
                                 
                              
                           
                         Using the three different configurations at times 
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           ,
                           t
                           ,
                           
                              
                                 t
                              
                              
                                 f
                              
                           
                        , both 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    +
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         are evaluated as a function of the particle positions 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                        . The two different 
                           λ
                         fields at time 
                           t
                         give the loci for the most repelling and attracting LCSs.

As explained in the previous sections 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         can be evaluated runtime during the simulation while 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    +
                                    )
                                 
                              
                           
                         can be evaluated only when the simulation is finished using a post-processing code. In all the results presented the Lyapunov exponent is made non-dimensional using the time range 
                           T
                           =
                           
                              |
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              −
                              t
                              |
                           
                         for the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         and 
                           T
                           =
                           
                              |
                              t
                              −
                              
                                 
                                    t
                                 
                                 
                                    f
                                 
                              
                              |
                           
                         for the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    +
                                    )
                                 
                              
                           
                        . For the sake of the simplicity both 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    +
                                    )
                                 
                              
                           
                         are indicated with 
                           λ
                           
                           T
                         in the figure.

In Fig. 5
                         contour plots of the FTLE fields for four different time instants 
                           t
                           U
                           /
                           c
                           =
                           15
                           ,
                           20
                           ,
                           25
                         and 30 are depicted. For the first time 
                           t
                           U
                           /
                           c
                           =
                           15
                         the LCSs behind the ellipse are still irregular because of the transitory due the acceleration stage. As the ellipse moves forward (
                           t
                           U
                           /
                           c
                           >
                           25
                        ) the flow becomes more regular and the distribution of LCSs reflects the shedding of a classical von Kármán Vortex Street. The latter is well captured by the attracting LCSs shown in the right column of Fig. 5. These contour plots resemble the one obtained with numerical streaklines by  [45].

The FTLE ridges of Fig. 5 are the positions of the fluid material most subjected to the stretching deformation. In the left column of Fig. 5 one can observe that the repelling LCSs are present in front of the moving ellipse even though at the current time the fluid is not disturbed here. This is because the reference configuration for calculation of the repelling LCSs is in the forward time 
                           
                              
                                 t
                              
                              
                                 f
                              
                           
                        ; which means that the fluid in this region will be stretched (repelled) in the future time.

The Method 2 (see Sections  2.3 and 3.3) is then applied for the same test-case and the equation used for the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         is: 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                FTLE
                                             
                                             
                                                
                                                   (
                                                   −
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             〈
                                             
                                                
                                                   λ
                                                
                                                
                                                   t
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             〉
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   |
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   −
                                                   t
                                                   |
                                                
                                             
                                          
                                          ln
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         Max
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         〈
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         〉
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                         where the forward-in-time tensor 
                           
                              〈
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              〉
                           
                           
                              (
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         for the generic 
                           i
                        th particle is evaluated using the integrated in time deformation gradient according to Eqs. (23) and (33).


                        Fig. 6
                         shows the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         field evaluated with the two different Method: Method 1 on the top picture and Method 2 on the middle one. As already stated, for the Method 2 the 
                           δ
                        -SPH scheme has been modified adding a particle-shifting (see Section  4.1) in order to improve the evaluation of the velocity gradient needed for the Method 2. Bottom plot of Fig. 6 shows the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         field obtained with Method 1 and particle-shifting. The latter, by improving the overall numerical solution, gives benefits also for the Method 1, even if some noise is visible because of the small-scale alteration of the particle positions. It is important to note that the differences induced by the particle-shifting procedure do not affect significantly the global quantities as the forces acting on the body. For the test-case presented in this section the differences on the drag and lift forces are within the 3%.


                        Fig. 7
                         shows the vorticity and the 
                           Q
                         fields at the time 
                           t
                           U
                           /
                           c
                           =
                           18
                        . Comparing those results with the one of Fig. 6 it is possible to appreciate how the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         allows for a better visualization of the LCSs with respect to the vorticity or iso-
                           Q
                         which identify only the position of vortical regions. From a practical point of view another advantage of the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                        s is the possibility to easily perform a data reduction based on the extraction of the sole ridges for a post-processing analysis of the LCSs, as discussed in Section  5.3.

In this section the flow past a circular cylinder close to a free surface is investigated numerically through the use of FTLEs. The diameter is 
                           D
                        , the velocity of the current is 
                           U
                         and the Reynolds and Froude numbers are set equal to, respectively, 
                           Re
                           =
                           U
                           ν
                           /
                           D
                           =
                           180
                         and 
                           Fr
                           =
                           U
                           /
                           
                              
                                 g
                                 D
                              
                           
                           =
                           2
                        . The cylinder is located at 
                           h
                           =
                           D
                        , where 
                           h
                         is the distance between the top of the cylinder and the undisturbed free surface. This problem has been recently studied in  [46,47]. In this Froude regime the von Kármán street induces strong perturbation on the free-surface motion and breaking wave events.

In order to capture this complex flow behaviour in the SPH simulation the particle resolution adopted is 
                           D
                           /
                           Δ
                           x
                           =
                           100
                         with about 4,850,000 particles used. Furthermore, a simulation of 
                           t
                           =
                           100
                           
                           D
                           /
                           U
                         seconds is necessary to reach an almost periodic regime.

The distributions of the attracting LCSs at different time instants are shown in Fig. 8
                        . In order to get the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         field the Method 1 (see Section  2.2) is here adopted and, as already pointed out, the particle-shifting is not used inside the 
                           δ
                        -SPH scheme. The time range 
                           T
                           =
                           
                              (
                              t
                              −
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                           
                         is equal to 
                           T
                           =
                           50
                           
                              
                                 D
                                 /
                                 g
                              
                           
                         seconds. Near the cylinder, in the region 
                           x
                           /
                           D
                           <
                           8
                        , the vortex street is still similar to the traditional Kármán Vortex Street. However, as the wake propagates further and expands in the vertical direction, the free surface yields a repelling effect on the vortices, which finally pair forming a horizontal pattern (see in the region 
                           x
                           /
                           D
                           >
                           8
                        ). Furthermore, because the fast current originated above the cylinder, plunging breaking are forced in the upstream direction. The breaking events are quite intense and in the splash-up stage also plunging in the downstream direction are formed. Consequently dipole structures are generated close to the free surface with the same mechanism explained in  [48] for the breaking bores evolution. The dipole structures caused by the breaking of the free surface interact with the underlying von Kármán street because of their downward motion, as shown in sketches (d) and (e) of Fig. 8. Also for such a case FTLEs supply an effective way to reveal these vortex structures and show the interesting process of their mutual interactions.


                        Fig. 9
                         depicts an enlarged view of the wake shed by the cylinder. Here the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         fields are obtained with both Method 1 (top plot) and Method 2 (bottom plot). Both the results identify the same LCSs, but the Method 1 is more accurate for the evaluation of the Lyapunov exponents. This is in contrast with the results presented in Section  5.1 where the particle shifting is adopted, improving the evaluation of the velocity gradients and, consequently, providing better results with Method 2.

The last test-case studied is the breaking and splashing of bow waves for high speed ships. The ship considered is the one used also in  [49] which is the Athena research vessel of the US Navy. In  [49] the breaking wave pattern of this ship has been studied in detail for different forward ship speeds. In that work a 2D+t SPH model has been used and the vortical structures due to plunging of the bow wave are tracked using passive markers initially positioned on the undisturbed free surface. The same technique has been also adopted in  [50] combining with vorticity contour plots.

In the present work one of the case studied in  [49] is considered again using the same 2D+t SPH model in order to show the benefits of using the FTLEs for capturing the bow breaking wave features. In this section the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         is calculated using the Method 1 to detect the submerged vortical tunnels entrapped by the breaking phenomena. This test-case is an attempt to extend the detection of LCSs from a 2D to a 3D framework and to show its potential application in naval engineering. The ship Froude number considered is, 
                           Fr
                           =
                           U
                           /
                           
                              
                                 g
                                 L
                              
                           
                           =
                           0.64
                         with 
                           L
                         the ship length and 
                           U
                         the forward ship speed. For this case an intense plunging breaking is generated by the bow wave with the entrapment of two vortex tubes running along the whole ship length.

Top plot of Fig. 10
                         depicts a rear view of the Athena vessel. The particle belonging to the free surface are identified through the algorithm presented in  [51] and plotted in blue. The other particles are plotted with a colour contour plot of the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         indicated with 
                           λ
                        . Only the particles having a 
                           λ
                           T
                         larger than 5 (with 
                           T
                           =
                           2.35
                           
                           L
                           /
                           U
                        ), which detect the LCSs related to the two submerged vortex tubes, are plotted. This clearly shows that through the 
                           
                              
                                 
                                    FTLE
                                 
                              
                              
                                 
                                    (
                                    −
                                    )
                                 
                              
                           
                         it is possible to reduce the amount of data for representing the LCSs, which is a remarkable advantage for the analysis and for the storing of 3D data. In bottom plot of Fig. 10 a detail of the flow in the bow region is depicted; the four main flow features are highlighted through labels and arrows.

@&#CONCLUSIONS@&#

In this work the Finite-Time Lyapunov Exponents (FTLEs) are formulated in the SPH framework for the detection of Lagrangian Coherent Structures (LCSs). From the continuum mechanics theory and using the Polar Decomposition it is shown that the FTLEs represent a measure of attraction and repulsion of pathlines during the flow evolution. Then, the theory of the Lyapunov Exponents has been introduced in the Smoothed Particle Hydrodynamics context, where the trajectory of each fluid particle is explicitly tracked over the whole simulation allowing for a direct evaluation of the FTLE fields.

Different numerical formulae are proposed for the calculation of the FTLEs within the SPH method. In a first method the FTLEs are evaluated directly through the particle positions (Method 1), while in a second method the FTLEs are calculated using a time integration of an ordinary differential equation (Method 2). This second method presents some advantages in terms of accuracy provided that the velocity gradient is evaluated with sufficient precision. This is a quite critical point for the SPH method which in the present work has been overcome including a particle-shifting procedure on the particle displacements.

The novel formulations introduced for the FTLEs calculation within the SPH method have been finally tested on three different test-cases of increasing complexity. The first problem concerns the viscous wake shed by a moving inclined ellipse. In this case both forward and backward-in-time FTLEs have been used to identify LCSs showing that the 
                        
                           
                              
                                 FTLE
                              
                           
                           
                              
                                 (
                                 −
                                 )
                              
                           
                        
                     s are able to correctly track the von Kármán street vortex. On this problem the 
                        
                           
                              
                                 FTLE
                              
                           
                           
                              
                                 (
                                 −
                                 )
                              
                           
                        
                     s has been evaluated through Method 1 and 2. It has been shown that in the latter case the particle-shifting technique has to be used to enhance accuracy on FTLEs evaluation. The flow past a circular cylinder beneath a free surface has been then considered. In this case the presence of breaking waves increases the complexity of the LCSs and it has been demonstrated how the FTLE can be a powerful methodology for analysing interesting flow features. The last test-case regards the wave pattern generated by a fast ship. For this naval engineering problem the proposed algorithm has been successfully applied to capture the submerged vortical tunnels caused by the splashing bow wave.

In future the present technique will be extended to the 3D framework. Indeed, it is generally not straightforward to extract the details of the flow features from 3D particle data because of the large amount of memory required and the difficulties related to the scattered nature of the particle data. The algorithm presented in this work can provide a way to reduce the amount of stored data and to ease the post-processing analysis. The method will be then used for the analysis of complex 3D flows like the one related to the splashing bow waves and to the wake pattern generated behind a ship.

@&#ACKNOWLEDGEMENTS@&#

This work is funded by: CNR-INSEAN within the Project PANdA: PArticle methods for Naval Applications, protocol number N. 3263, 21 October 2014, the International Exchange Program of Harbin Engineering University for Innovation-oriented Talents Cultivation, the China Scholarship Council (CSC, Grant No. 201506680004) and the National Program for Support of Top-notch Young Professionals.

The work was supported also by Flagship Project RITMARE–Italian Research for the Sea–coordinated by Italian National Research Council and funded by Italian Ministry of Education, University and Research within Nat. Res. Program 2015–2016, and partially supported by the Project ENSiS: ENhanced Sph Schemes for complex free-surface flows, funded by the Ecole Centrale de Nantes (ECN).

@&#REFERENCES@&#

