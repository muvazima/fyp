@&#MAIN-TITLE@&#Solving real-world cutting stock-problems in the paper industry: Mathematical approaches, experience and challenges

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We bridge research in optimization to real world cutting stock problems (CSPs).


                        
                        
                           
                           We develop two advanced column generation algorithms for 1D CSPs.


                        
                        
                           
                           We develop an Exhaustion Method for 1-CSPs with two criteria.


                        
                        
                           
                           We develop a sophisticated solution method for 2D-trim-loss minimization problems.


                        
                        
                           
                           We assemble a benchmark data set of 25 real world 1D cutting stock instances.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Paper industry

Cutting stock

Roll production

Format production

Column generation

@&#ABSTRACT@&#


               
               
                  We discuss cutting stock problems (CSPs) from the perspective of the paper industry and the financial impact they make. Exact solution approaches and heuristics have been used for decades to support cutting stock decisions in that industry. We have developed polylithic solution techniques integrated in our ERP system to solve a variety of cutting stock problems occurring in real world problems. Among them is the simultaneous minimization of the number of rolls and the number of patterns while not allowing any overproduction. For two cases, CSPs minimizing underproduction and CSPs with master rolls of different widths and availability, we have developed new column generation approaches. The methods are numerically tested using real world data instances. An assembly of current solved and unsolved standard and non-standard CSPs at the forefront of research are put in perspective.
               
            

@&#INTRODUCTION@&#

The pulp and paper industry plays an important role worldwide. There are in the order of 3000 paper mills, which produced a total of 394million tons of paper and paperboard, in 2010. Europe (including Russia) has approximately 900 paper mills, while Germany has about 180. The largest producer in the world is the Finnish UPM group with an annual tonnage of 12.7million tonnes, followed by Stora Enso with 11.8million tons and by International Paper with 9.7million tonnes per year. Santos and Almada-Lobo (2012) report that in Portugal the pulp and paper industry contributes over 4% of the GDP and 5% of the active employees. As it is subject of both local and global environmental discussions, effective planning and cutting stock techniques lies at the very heart of the operational performance of its manufacturing organizations.

Exact solution approaches and heuristics have been used for decades to support cutting stock decisions in the paper industry. In the standard cutting stock problem (CSP), the problem input is given by a set of item sizes and demands, and by a set of master rolls of given widths; the simplest case consists of only one type of master rolls. The task is to decide on how many master rolls are cut to a certain pattern in order to minimize the total number of master rolls used.

The pattern minimization problem (PMP) is a strongly NP-hard cutting problem, which seeks a cutting plan with the minimum number of different patterns, cf. 
                     McDiarmid (1999). This objective, relevant when changing from one pattern to another, involves a cost for setting up the cutting machine, i.e., adjusting the cutting knifes. When the minimization of the number of different patterns is done by assuming that no more than the minimum number of rolls can be used, the problem is also referred to as the cutting stock problem with setup costs.

The international working group SICUP (Special Interest Group on Cutting and Packing) founded by Gerhard Wäscher in 1988, focuses on cutting stock and packing problems and is a platform for more than 200 practitioners and scientists to exchange ideas on these topics. In 2004, SICUP became the EUROworking group ESICUP (EURO Special Interest Group on Cutting and Packing).

The main contributions of this paper can be classified into two categories:
                        
                           
                              Mathematical optimization:
                           
                           For 1D CSPs with two criteria, minimizing the number of rolls and the number of patterns, we develop an Exhaustion Method (Section 3.4), a column generation approach allowing underproduction (Section 3.5.4) and column generation approach incorporating master rolls with different widths and limited availability (Section 3.5.5). We present a novel polylithic
                                 1
                                 The term polylithic has been coined by Kallrath (2009a) and explained in greater detail in Kallrath (2011); it refers to modeling and solution approaches in which mixed integer or nonconvex nonlinear optimization problems are solved by tailor-made methods involving several models and/or solve statements or algorithmic components.
                              
                              
                                 1
                               solution method towards 2D trim-loss minimization (Section 4). Furthermore, we share real data in a 1D cutting stock benchmark data set (Section 3.6.1). For software products, it is not untypical to combine various basic algorithms to consistently provide solutions in acceptable time, with many empirical rules, or even rules of thumb, to decide which algorithms to use in each circumstance. We disclose this information instead of keeping it as a commercial secret, to provide evidence that there is more exact optimization and less heuristics involved as one might expect.

We present real-world aspects relevant to the paper industry, which have seen only little treatment in the scientific literature (Section 3.5). We assemble current cutting-edge standard and non-standard cutting stock problems relevant to the paper industry (Section 5) and illuminate at length the variants and issues present in real-world problems. We discuss the financial impact mathematical programming-based solutions to cutting stock problems have in the paper industry (Section 6).

The remainder of the paper is structured as follows: After a literature review in Section 2, we discuss the 1D CSP and its variants in Section 3 along with different solution techniques. A presentation of 2D polylithic solution methods in Section 4 is followed by a discussion of current-edge CSPs in Section 5 and our views on optimization in the paper industry in Section 6. Conclusions are in Section 7. Two appendices, post-processing (Appendix A) and and guidelines on how to derive the pricing problems (Appendix B) complete this paper.

@&#LITERATURE REVIEW@&#

There is a rich body of literature available on CSPs; cf. 
                     Haessler and Sweeney (1991) and Haessler (1992) for reviews on 1D cutting stock problems and solution procedures. We find heuristic solution approaches (cf. 
                     Haessler (1971)), exact MILP-models (cf. 
                     Johnston & Sadinlija (2004)), column generation approaches, among them the classical paper by Gilmore and Gomory (1961), Branch&Price algorithms (cf. 
                     Belov & Scheithauer (2006)), reviews as by Amor (2005) who put column generation and Branch&Price algorithms in perspective, and classification papers (cf. 
                     Dyckhoff (1990) and Wäscher, Haußner, & Schumann (2007)).

Most of the approaches described in the literature for solving the PMPare based on heuristics. As the PMP has been proven strongly NP-hard by McDiarmid (1999), it is not a surprise that solving the problem exactly has been a real challenge, and only very few exact solution methods have been reported so far in the literature; among them Vanderbeck (2000). Alves, Macedo, and de Carvalho (2009) explore an integer programming model that can be solved using column generation, and they describe different strategies to strengthen it, among which are constraint programming and new families of valid inequalities. Lower bounds for the pattern minimization problem are derived from the new integer programming model, and also from a constraint programming model.

Beyond a vast body of literature on the standard CSP, there are a few publications on a generalized CSP with great practical significance: The multiple-width CSP with master rolls of different widths (and equal lengths assumed to be infinite). An early work on this topic is by Holthaus (2002), who solves the relaxation of the CSP by the column generation technique and uses three procedures for rounding the solution, leading in a final residual problem, which is solved by an ILP-solver. Although his technique is suitable for solving medium-size and large instances of the one-dimensional CSP, the paper does not consider supply limitation on the different stock lengths availability. Alves and de Carvalho (2007) developed strategies to stabilize and accelerate the column generation method by introducing dual-optimal inequalities, reducing the number of column generation iterations and run time. Finally, Poldi and Arenales (2009) provide a heuristic to solve the CSP with multiple stock lengths with limited availability.

Although production planning or scheduling and CSPs are usually treated separately, we find early articles in which both aspects are combined; cf. 
                     Haessler and Talbot (1983) or Li (1996) who provide LP-based and non-LP-based heuristics to solve 2D multi-job cutting stock problems with due dates and release dates. The combined cutting stock and lot-sizing problem in industrial processes has attracted several authors in the last decade, among them Arbib and Marinelli (2005), Gramani and França (2006), Yanasse and Pinto Lamosa (2007), Trkman and Gradisar (2007), Poltroniere, Poldi, Toledo, and Arenales (2008), Gramani, França, and Arenales (2009) and most recently Reinertsen and Vossen, 2010 who treat the 1D CSP with due dates. Trkman, Erjavec, and Gradisar (2009) treat cutting stock as a continuous business process which is incorporated into an entire supply chain.

General cutting and packing problems are related to CSPs. The most important difference between cutting and packing problems is that in cutting problems, the number of objects are given and the task is to minimize trim-loss or area, while packing problems aim to fit as many objects as possible in a predefined area or volume. For example, one may want to cut orientation free polygons (Kallrath, 2009b) or ellipses (Kallrath & Rebennack, 2013) into one rectangle, or circles into several rectangles (Rebennack, Kallrath, & Pardalos, 2009). A significant difference between these cutting problems cited and the 2D cutting problems described in Section 4 is that the latter allow only a horizontal or vertical orientation of the objects to be cut.

We conclude our literature review by pointing the reader to a few articles which give some excellent insights into the field: Rodríguez and Vecchietti (2008) for practical application with very good illustrations, and similarities to our 2D problem described in Section 4, Harjunkoski, Westerlund, Pörn, and Skrifvars (1998) and Pörn, Harjunkoski, and Westerlund (1999) for exact MILP and MINLP approaches, and also, a very recent paper on heuristics by Cui and Zhao (2013).

Our discussion of the one-dimensional cutting stock problem starts with the standard problem formulation in Section 3.1, followed by three solution methods: the widely used approach by Gilmore and Gomory (Section 3.2), a column enumeration (Section 3.3), and an Exhaustion Method (Section 3.4). We summarize important practical aspects for one-dimensional CSPs for the paper industry and present extensions to the column generation approach addressing these practical aspects (Section 3.5). We conclude this section with some computational benchmarking (Section 3.6).

The mathematical model for minimizing the number of rolls or trim-loss in the standard problem with one master roll of width B is characterized by the following indices, data and variables.


                           
                              
                                 
                                    
                                       
                                          p
                                          ∈
                                          P
                                          
                                          ≔
                                          
                                          {
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      P
                                                   
                                                
                                             
                                          
                                          }
                                       
                                     cutting patterns; 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                P
                                             
                                          
                                       
                                     is the number of patterns in 
                                       
                                          P
                                       
                                    . If 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                P
                                             
                                          
                                       
                                     is not known, as it happens in the Gilmore and Gomory approach, we set 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                P
                                             
                                          
                                       
                                     to a sufficiently large number.


                                    
                                       
                                          i
                                          ∈
                                          I
                                          
                                          ≔
                                          
                                          {
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                i
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      I
                                                   
                                                
                                             
                                          
                                          }
                                       
                                     given orders or widths; 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                I
                                             
                                          
                                       
                                     is the number of (orders) widths in 
                                       
                                          I
                                       
                                    .


                           
                              
                                 
                                    
                                       
                                          B
                                       
                                    
                                    [L] width of the master rolls (raw material rolls).


                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    [–] demand; the requested number of pieces of width i.


                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    [L] width of order type i.


                           
                              
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                p
                                             
                                          
                                          ∈
                                          
                                             
                                                IN
                                             
                                             
                                                0
                                             
                                          
                                          
                                          ≔
                                          
                                          {
                                          0
                                          ,
                                          1
                                          ,
                                          2
                                          ,
                                          3
                                          ,
                                          …
                                          }
                                       
                                    
                                    [–] indicates how often pattern p is used; 
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                p
                                             
                                          
                                          =
                                          0
                                       
                                     if p is not used.


                                    
                                       
                                          
                                             
                                                α
                                             
                                             
                                                ip
                                             
                                          
                                          ∈
                                          
                                             
                                                IN
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    [–] indicates how often order type i is contained in pattern 
                                       
                                          p
                                          ;
                                          
                                          0
                                          ⩽
                                          
                                             
                                                α
                                             
                                             
                                                ip
                                             
                                          
                                          ⩽
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                       
                                    .

A suitable objective function
                              
                                 (1)
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                    ≔
                                    
                                    
                                       
                                          
                                             min
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ip
                                                
                                             
                                             ,
                                             
                                                
                                                   μ
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             P
                                          
                                       
                                    
                                    f
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          ip
                                       
                                    
                                    ,
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    )
                                    ,
                                 
                              
                           is subject to the restrictions (fulfillment of the demand)
                              
                                 (2)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             P
                                          
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          ip
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                    ∀
                                    i
                                    ,
                                 
                              
                           feasibility of pattern p
                           
                              
                                 (3)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                    
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          ip
                                       
                                    
                                    ⩽
                                    B
                                    ,
                                    
                                    ∀
                                    p
                                    ,
                                 
                              
                           and the integrality constraints
                              
                                 (4)
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ip
                                       
                                    
                                    ∈
                                    
                                       
                                          IN
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                    ∀
                                    {
                                    ip
                                    }
                                 
                              
                           and
                              
                                 (5)
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    ∈
                                    
                                       
                                          IN
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                    ∀
                                    p
                                    .
                                 
                              
                           Formulated via (1)–(5), the standard CSP is a mixed integer nonlinear (nonconvex) optimization problem (MINLP), a problem class which is difficult in itself. As the problem may easily encounter several million variables 
                              
                                 
                                    
                                       α
                                    
                                    
                                       ip
                                    
                                 
                              
                           , it cannot be solved efficiently in this form. Another complication results from Eq. (2) with exact demand fulfillment, as it is rare to find feasible solutions to the CSP. Therefore, in practical situations, (2) is relaxed to
                              
                                 (6)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                       
                                          L
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             P
                                          
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          ip
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    ⩽
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                       
                                          U
                                       
                                    
                                    ,
                                    
                                    ∀
                                    i
                                    ,
                                 
                              
                           with lower and upper bounds, 
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                    
                                       L
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                    
                                       U
                                    
                                 
                              
                           , on the demand 
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                              
                           . Usually, underproduction is less accepted as light overproduction; see also the discussion in Section 3.5.4.

The idea of column generation by Gilmore and Gomory (1961) is to dynamically add variables (“columns”) which are good candidates to be included in an optimal solution. This is achieved by decomposing the CSP into a master problem (MP) and a sub-problem (SP), also called pricing problem. For a predefined set of patterns 
                           
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                              ⊆
                              P
                           
                        , the MP decides how often each pattern has to be used and provides input data for the SP via dual information. It minimizes the number of rolls
                           
                              (7)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       p
                                    
                                 
                                 ,
                              
                           
                        with the demand-fulfill inequalities (note that it is allowed to produce more than requested)
                           
                              (8)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       ip
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       p
                                    
                                 
                                 ⩾
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    N
                                 
                                 
                                    ip
                                 
                              
                           
                         is the number of times order i is contained in pattern 
                           
                              p
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                           
                        . The integrality constraints
                           
                              (9)
                              
                                 
                                    
                                       μ
                                    
                                    
                                       p
                                    
                                 
                                 ∈
                                 
                                    
                                       IN
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                 ∀
                                 p
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                              
                           
                        complete the model. Replacing the integrality requirement (9) on 
                           
                              
                                 
                                    μ
                                 
                                 
                                    p
                                 
                              
                           
                         by a non-negative constraint, we obtain the so-called relaxed master problem (RMP).

In the SP, new patterns (variables 
                           
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                           
                        , the multiplicity of width i) are calculated by exploiting the dual values 
                           
                              
                                 
                                    π
                                 
                                 
                                    i
                                 
                              
                           
                         (pricing information) of the RMP associated with (8). The objective function
                           
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                α
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        involves the integer variables 
                           
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                           
                        . To ensure that, in the new pattern, the roll width, B, and the number, K, of knives are not exceeded we add the knapsack inequalities
                           
                              (10)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 B
                                 ,
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 K
                                 .
                              
                           
                        Numerical experiments without the knife constraint are indicated by 
                           
                              K
                              =
                              ∞
                           
                        . For completeness, we note the integrality conditions
                           
                              (11)
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       IN
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 .
                              
                           
                        The 
                           
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                           
                         become the 
                           
                              
                                 
                                    N
                                 
                                 
                                    ip
                                 
                              
                           
                         coefficients of the new pattern in (8). In some cases, 
                           
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                           
                         could be additionally bounded, for instance, by the number, K, of available knives, or by the demand, 
                           
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                           
                        .

Once the optimal objective function value of the SP is non-negative, then the RMP for pattern set 
                           
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                           
                         has been solved to optimality over all possible patterns. The optimal objective function value of the RMP provides a lower bound on 
                           
                              
                                 
                                    z
                                 
                                 
                                    ∗
                                 
                              
                           
                        ; solving the MP for the available set of patterns 
                           
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                           
                         yields an upper bound on 
                           
                              
                                 
                                    z
                                 
                                 
                                    ∗
                                 
                              
                           
                        .

In this context, the absolute difference (i.e., gap) between the RMP and the MP, once GGA converges, is of great interest. A well known conjecture states that the 1D cutting stock problem (when minimizing the number of patterns used) has the so-called modified round-up property, i.e., the gap is at most 2, cf. 
                        Scheithauer and Terno (1995). No instance of the 1D cutting stock problem has been reported so far which has a greater gap. To the best knowledge of the authors, the conjecture has not been proven, yet.

As the expression “column enumeration” (CE) suggests, the set of possible columns (e.g., patterns) is enumerated. As such, CE is a special variant of column generation and is applicable when a small number of columns is sufficient. For instance, this is the case in real-world cutting stock problems when it is known that the optimal solutions have only a small amount of trim-loss, eliminating most of the patterns. CE naturally leads to a type of selecting columns or partitioning models: problem (7) 
                        (8) and (9) with 
                           
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                           
                         being the set of all generated columns. Despite the limitations with respect to the number of columns, CE has some advantages: No pricing problem, easily applicable to MILP problems, much easier to implement (compared to column generation), and allows the straight forward incorporation of demand stochasticities (cf. Section 5.1). In the context of cutting stock problems, we sometimes can use the maximum permissible trim-loss to restrict the number of patterns to be considered in CE (cf. Section 3.5).

This method combines a constructive heuristic with exact MILP techniques. We illustrate the exhausting method by the CSP described in Section 3.1; assigning orders in a scheduling problem would be another example of an exhaustion approach. The elegant GGA is known for producing minimal trim-loss solutions with many patterns. Often this corresponds to setup changes on the machine and therefore is not desirable. A solution with a minimal number of patterns minimizes the machine setup costs of the cutter. Minimizing simultaneously trim-loss and the number of patterns is possible for small cases of a few orders only, exploiting the MILP model by Johnston and Sadinlija (2004). It contains two conflicting objective functions. Therefore one could resort to goal programming. Alternatively, we produce a pool of several parameterized solutions leading to different number of rolls to be used and patterns to be cut from. It is up to the user to choose the best solution from that pool; cf. Section 3.6.4.

Note that the Branch&Price algorithm described in Vanderbeck (2000) or Belov and Scheithauer (2006) can be used to solve the 1D CSP with minimal numbers of patterns. However, these methods are not easy to implement. Therefore, depending on the number of orders, we use the following approaches:
                           
                              •
                              V1: Direct usage of the model by Johnston and Sadinlija (2004), for a small number of orders, e.g., 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             I
                                          
                                       
                                       ⩽
                                       14
                                    
                                  and 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             max
                                          
                                       
                                       ⩽
                                       10
                                    
                                 , to minimize the number of patterns or the number of rolls. In a preprocessing step, we compute valid inequalities as well as tight lower and upper bounds on the variables.

V2: Exhaustion procedure in which we cover the orders and their demands by generating successively new patterns with maximal multiplicities (phase V2-1). If only a small number of orders is left over, we use V1 to minimize the number of rolls (phase V2-2). In phase V2-3, we exploit the MIPSTART
                                 feature of CPLEX and start with the best solution found (smallest number of patterns) and use again V1 to minimize the number of patterns with the aim to compute an improved lower bound, 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             2
                                             -
                                          
                                          
                                             P
                                          
                                       
                                    
                                 , smaller than our initial lower bound, 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             1
                                             -
                                          
                                          
                                             P
                                          
                                       
                                    
                                 , which we obtained by solving the corresponding bin packing problem (BPP, resulting from setting all CSP demands to 1), and to find a better solution.

In this model, we use the indices listed in Johnston and Sadinlija (2004):
                              
                                 
                                    
                                       
                                          i
                                          ∈
                                          I
                                          
                                          ≔
                                          
                                          {
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                i
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      I
                                                   
                                                
                                             
                                          
                                          }
                                       
                                     the index set of (order) widths.


                                    
                                       
                                          p
                                          ∈
                                          P
                                          
                                          ≔
                                          
                                          {
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      P
                                                   
                                                
                                             
                                          
                                          }
                                       
                                     the set of all possible patterns; 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                P
                                             
                                          
                                          ⩽
                                          
                                             
                                                N
                                             
                                             
                                                I
                                             
                                          
                                       
                                    .

The patterns are generated by V1, or dynamically by maximizing the multiplicities of a pattern used. Note that in Johnston and Sadinlija (2004), the index j is used instead of p.


                                    
                                       
                                          k
                                          ∈
                                          K
                                          
                                          ≔
                                          
                                          {
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      K
                                                   
                                                
                                             
                                          
                                          }
                                       
                                     the multiplicity index to indicate how often a width is used in a pattern.

The multiplicity index can be bounded by the ratio of the widths of the orders and given rolls.

The following integer or binary variables are used:
                              
                                 
                                    
                                       
                                          
                                             
                                                α
                                             
                                             
                                                ip
                                             
                                          
                                          ∈
                                          IN
                                       
                                    
                                    [–] specifies how often width i occurs in pattern 
                                       
                                          p
                                          ;
                                          0
                                          ⩽
                                          
                                             
                                                α
                                             
                                             
                                                ip
                                             
                                          
                                          ⩽
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                       
                                     (item-in-pattern multiplicity).


                                    
                                       
                                          
                                             
                                                α
                                             
                                             
                                                ipk
                                             
                                          
                                          ∈
                                          IN
                                       
                                    
                                    [–] auxiliary variable connected to 
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                ipk
                                             
                                          
                                          ;
                                          0
                                          ⩽
                                          
                                             
                                                α
                                             
                                             
                                                ipk
                                             
                                          
                                          ⩽
                                          
                                             
                                                D
                                             
                                             
                                                max
                                             
                                          
                                          
                                          ≔
                                          
                                          
                                             
                                                max
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                       
                                    .


                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                p
                                             
                                             
                                                A
                                             
                                          
                                          ∈
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                    
                                    [–] indicates whether pattern p is used at all.


                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                ipk
                                             
                                          
                                          ∈
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                    
                                    [–] indicates whether width i appears in pattern p at level 
                                       
                                          k
                                          ;
                                          
                                             
                                                δ
                                             
                                             
                                                ipk
                                             
                                          
                                          =
                                          0
                                       
                                     implies 
                                       
                                          
                                             
                                                a
                                             
                                             
                                                ipk
                                             
                                          
                                          =
                                          0
                                       
                                    .


                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                p
                                             
                                          
                                          ∈
                                          IN
                                       
                                    
                                    [–] specifies how often pattern p is used. If pattern p is not used, we have 
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                p
                                             
                                          
                                          =
                                          
                                             
                                                δ
                                             
                                             
                                                p
                                             
                                             
                                                A
                                             
                                          
                                          =
                                          0
                                       
                                    .

In our exhaustion procedure, we cover the orders and their demands by generating successively new patterns with maximal multiplicities. If only a small number of orders is left over, we switch to V1. This method is parameterized by the initial permissible percentage waste 
                              
                                 
                                    
                                       W
                                    
                                    
                                       max
                                    
                                 
                                 ,
                                 1
                                 ⩽
                                 
                                    
                                       W
                                    
                                    
                                       max
                                    
                                 
                                 ⩽
                                 99
                              
                           . To populate the pool, we use six parameterizations with the following values: 
                              
                                 
                                    
                                       W
                                    
                                    
                                       max
                                    
                                 
                                 =
                                 20
                                 ,
                                 15
                                 ,
                                 10
                                 ,
                                 8
                              
                           , 6 and 4. The usage of different parametrizations is motivated by the hope to obtain different solutions. This allows the user to select the best combination of number of rolls and number of patterns.

We start with iteration 
                              
                                 m
                                 =
                                 0
                              
                           . In each iteration m, we generate at most 2 new patterns by maximizing the multiplicities of these patterns allowing no more than a maximum percentage waste, 
                              
                                 
                                    
                                       W
                                    
                                    
                                       max
                                    
                                 
                              
                           , relative to the width of the master roll. The solution generated in iteration m is preserved in iteration 
                              
                                 m
                                 +
                                 1
                              
                            by fixing the appropriate variables. If the problem turns out to be infeasible (this may happen if 
                              
                                 
                                    
                                       W
                                    
                                    
                                       max
                                    
                                 
                              
                            turns out to be restrictive;we observed this to happen occasionally for 
                              
                                 
                                    
                                       W
                                    
                                    
                                       max
                                    
                                 
                                 <
                                 8
                              
                           ), we increase the permissible waste by 10% and proceed to the next iteration. If only a few orders remain, we switch to V1 to cover the remaining unsatisfied orders;note that V1 works without the 
                              
                                 
                                    
                                       W
                                    
                                    
                                       max
                                    
                                 
                              
                            restriction.

Our model is based on the MILP model developed by Johnston and Sadinlija for solving the 1D-CSPproblem, especially on their inequalities (1, 2, 3, 5–8). Their main idea is to replace the nonlinear terms in (2) by binary variables 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       ipk
                                    
                                 
                              
                           , which take value 1 if item i occurs in pattern p with multiplicity k. Similar transformations have been presented before by Harjunkoski et al. (1998). The model by Johnston and Sadinlija can work efficiently, if we expect to have only reasonably small item-in-pattern multiplicities k and not too many items and patterns.

It helps, and is also necessary, to provide lower and upper bounds, 
                              
                                 
                                    
                                       N
                                    
                                    
                                       -
                                    
                                    
                                       P
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       N
                                    
                                    
                                       +
                                    
                                    
                                       P
                                    
                                 
                              
                           , on the number of patterns expected to be used in an optimal solution. If 
                              
                                 
                                    
                                       N
                                    
                                    
                                       I
                                    
                                 
                              
                            is the number of items (order widths), then 
                              
                                 
                                    
                                       N
                                    
                                    
                                       1
                                       +
                                    
                                    
                                       P
                                    
                                 
                                 
                                 ≔
                                 
                                 
                                    
                                       N
                                    
                                    
                                       I
                                    
                                 
                              
                            is a weak upper bound. We compute a weak lower bound, 
                              
                                 
                                    
                                       N
                                    
                                    
                                       1
                                       -
                                    
                                    
                                       P
                                    
                                 
                              
                           , by applying the GGA towards a BPP associated with the CSPproblem.

The great strength of the model by Johnston and Sadinlija is that it allow us to implement different objective functions and constraints much easier than in a MINLPmodel or in column generation approaches. Therefore, it even allows for sequencing production by exploiting a one-to-one correspondence between pattern and manufacturing sequence. We briefly summarize the relevant relations we implemented in our exhaustion;note that we partially adjusted the nomenclature used by Johnston and Sadinlija to be consistent with our paper.

Let binary variable 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       p
                                    
                                    
                                       A
                                    
                                 
                              
                            indicating whether or not pattern 
                              
                                 p
                                 ∈
                                 P
                              
                            is used in the optimal solution. The pattern multiplicity, 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       p
                                    
                                 
                              
                           , is subject to lower and upper bounds, 
                              
                                 
                                    
                                       M
                                    
                                    
                                       L
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       M
                                    
                                    
                                       U
                                    
                                 
                              
                           , i.e.,
                              
                                 (12)
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    ⩾
                                    
                                       
                                          M
                                       
                                       
                                          L
                                       
                                    
                                    ,
                                    
                                    p
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          act
                                       
                                    
                                    
                                    ≔
                                    
                                    
                                       
                                          
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   N
                                                
                                                
                                                   -
                                                
                                                
                                                   P
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           and 
                              
                                 
                                    
                                       
                                          p
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                pot
                                             
                                          
                                          
                                          ≔
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         -
                                                      
                                                      
                                                         P
                                                      
                                                   
                                                   +
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         +
                                                      
                                                      
                                                         P
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (13)
                                 
                                    
                                       
                                          M
                                       
                                       
                                          L
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          p
                                       
                                       
                                          A
                                       
                                    
                                    ⩽
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    ⩽
                                    
                                       
                                          M
                                       
                                       
                                          U
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          p
                                       
                                       
                                          A
                                       
                                    
                                    .
                                 
                              
                           Johnston and Sadinlija leave it to the user to set 
                              
                                 
                                    
                                       M
                                    
                                    
                                       L
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       M
                                    
                                    
                                       U
                                    
                                 
                              
                           . Setting 
                              
                                 
                                    
                                       M
                                    
                                    
                                       L
                                    
                                 
                                 =
                                 1
                              
                            is the easiest choice; we use 
                              
                                 
                                    
                                       M
                                    
                                    
                                       U
                                    
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       i
                                    
                                 
                                 {
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                           .

The binary variables 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       ipk
                                    
                                 
                              
                           
                           are accompanied by integer variables 
                              
                                 
                                    
                                       α
                                    
                                    
                                       ipk
                                    
                                 
                              
                            which are constructed in such a way that 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       ipk
                                    
                                 
                                 =
                                 1
                              
                            implies 
                              
                                 
                                    
                                       α
                                    
                                    
                                       ipk
                                    
                                 
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       p
                                    
                                 
                              
                           . Instead of a fixed demand 
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                              
                           , Johnston and Sadinlija allow for bounded under- and overproduction, i.e., 
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                    
                                       L
                                    
                                 
                                 ⩽
                              
                           
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                    
                                       U
                                    
                                 
                              
                           , and thus
                              
                                 (14)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                       
                                          L
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                          
                                       
                                    
                                    k
                                    
                                       
                                          α
                                       
                                       
                                          ipk
                                       
                                    
                                    ⩽
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                       
                                          U
                                       
                                    
                                    ,
                                    
                                    ∀
                                    i
                                    .
                                 
                              
                           The various binary and integer variables 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       ipk
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       ipk
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       p
                                    
                                 
                              
                            are connected by
                              
                                 (15)
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ipk
                                       
                                    
                                    ⩽
                                    
                                       
                                          M
                                       
                                       
                                          U
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          ipk
                                       
                                    
                                    ,
                                    
                                    ∀
                                    {
                                    ipk
                                    }
                                    ,
                                 
                              
                           
                           
                              
                                 (16)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          ipk
                                       
                                    
                                    ⩽
                                    1
                                    ,
                                    
                                    ∀
                                    {
                                    ip
                                    }
                                    ,
                                 
                              
                           
                           
                              
                                 (17)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          ipk
                                       
                                    
                                    ⩽
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                    ∀
                                    {
                                    ip
                                    }
                                    ,
                                 
                              
                           and
                              
                                 (18)
                                 
                                    
                                       
                                          M
                                       
                                       
                                          U
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          ipk
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          ipk
                                       
                                    
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    ⩽
                                    
                                       
                                          M
                                       
                                       
                                          U
                                       
                                    
                                    ,
                                    
                                    ∀
                                    {
                                    ip
                                    }
                                    .
                                 
                              
                           Inequalities (15) and (16) guarantee that only one 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       ipk
                                    
                                 
                              
                            and its corresponding 
                              
                                 
                                    
                                       α
                                    
                                    
                                       ipk
                                    
                                 
                              
                            can be selected for each pair (ip). Inequalities (17) and (18) guarantee that 
                              
                                 
                                    
                                       α
                                    
                                    
                                       ipk
                                    
                                 
                              
                            
                           
                              
                                 >
                                 0
                              
                            implies 
                              
                                 
                                    
                                       α
                                    
                                    
                                       ipk
                                    
                                 
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       p
                                    
                                 
                              
                           .

The proper design of the patterns is ruled by the knapsack inequalities
                              
                                 (19)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                    
                                    k
                                    
                                       
                                          δ
                                       
                                       
                                          ipk
                                       
                                    
                                    ⩽
                                    B
                                    ,
                                    
                                    ∀
                                    p
                                    ,
                                 
                              
                           and
                              
                                 (20)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                    
                                    k
                                    
                                       
                                          δ
                                       
                                       
                                          ipk
                                       
                                    
                                    ⩾
                                    
                                       
                                          100
                                          -
                                          
                                             
                                                W
                                             
                                             
                                                max
                                             
                                          
                                       
                                       
                                          100
                                       
                                    
                                    B
                                    
                                    ,
                                    
                                    ∀
                                    p
                                    .
                                 
                              
                           We add additional constraints to the model, e.g., the symmetry breaking inequality
                              
                                 (21)
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          p
                                       
                                       
                                          A
                                       
                                    
                                    ⩾
                                    
                                       
                                          δ
                                       
                                       
                                          p
                                          +
                                          1
                                       
                                       
                                          A
                                       
                                    
                                    ,
                                    
                                    ∀
                                    p
                                    ,
                                 
                              
                           which ensures that pattern 
                              
                                 p
                                 +
                                 1
                              
                            can only be used if p is used. The symmetry breaking inequality
                              
                                 (22)
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    ⩾
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                    ∀
                                    p
                                    ,
                                 
                              
                           orders the patterns according to their multiplicities.

We exploit the Johnston and Sadinlija model by three objective functions.In V2-1, we maximize the multiplicities of the patterns generated
                              
                                 
                                    
                                       
                                          
                                             max
                                          
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   pot
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                 
                              
                           while in (14) we set 
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                    
                                       L
                                    
                                 
                                 =
                                 0
                              
                            and 
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                    
                                       U
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           , where 
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                            is the number of remaining orders of width index i. In V1, we minimize the number of patterns
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          P
                                       
                                    
                                    
                                    ≔
                                    
                                    
                                       
                                          
                                             min
                                          
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          p
                                       
                                    
                                    =
                                    
                                       
                                          P
                                       
                                       
                                          L
                                       
                                    
                                    +
                                    
                                       
                                          
                                             min
                                          
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   p
                                                
                                                
                                                   A
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   pot
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          p
                                       
                                       
                                          A
                                       
                                    
                                    ,
                                 
                              
                           subject to 
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                    
                                       L
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                    
                                       U
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                              
                           , and in V2-2, we minimize the number of rolls
                              
                                 (23)
                                 
                                    
                                       
                                          
                                             min
                                          
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   pot
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                           subject to 
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                    
                                       L
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                    
                                       U
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                              
                           . The model is completed by the integrality conditions (
                              
                                 ∀
                                 {
                                 ik
                                 }
                              
                            and 
                              
                                 p
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       pot
                                    
                                 
                              
                           )
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          α
                                       
                                       
                                          ipk
                                       
                                    
                                    ∈
                                    
                                       
                                          IN
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          p
                                       
                                       
                                          A
                                       
                                    
                                    ,
                                    
                                       
                                          δ
                                       
                                       
                                          ipk
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    .
                                 
                              
                           The model is applied several times with 
                              
                                 
                                    
                                       α
                                    
                                    
                                       ipk
                                    
                                 
                                 ⩽
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           . Especially, the model has to fulfill the relationships (
                              
                                 ∀
                                 {
                                 ik
                                 }
                              
                            and 
                              
                                 p
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                              
                           )
                              
                                 
                                    k
                                    
                                       
                                          α
                                       
                                       
                                          ipk
                                       
                                    
                                    >
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    
                                    ⇒
                                    
                                    
                                       
                                          α
                                       
                                       
                                          ipk
                                       
                                    
                                    =
                                    0
                                    
                                    ∧
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          ipk
                                       
                                    
                                    =
                                    0
                                 
                              
                           as well as (
                              
                                 ∀
                                 {
                                 ik
                                 }
                              
                            and 
                              
                                 p
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       pot
                                    
                                 
                              
                           )
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ipk
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          α
                                       
                                       
                                          ipk
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                              
                            denotes the permissible overproduction.

This Exhaustion Method provides an improved upper bound, 
                              
                                 
                                    
                                       N
                                    
                                    
                                       2
                                       +
                                    
                                    
                                       P
                                    
                                 
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       min
                                    
                                    
                                       P
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       N
                                    
                                    
                                       2
                                       +
                                    
                                    
                                       P
                                    
                                 
                                 ⩽
                                 
                                    
                                       N
                                    
                                    
                                       1
                                       +
                                    
                                    
                                       P
                                    
                                 
                              
                           , on the number of patterns, where 
                              
                                 
                                    
                                       N
                                    
                                    
                                       min
                                    
                                    
                                       P
                                    
                                 
                              
                            is the number of patterns in the best solution (smallest number of patterns) of the pool.

To compute a lower bound on 
                              
                                 
                                    
                                       N
                                    
                                    
                                       -
                                    
                                    
                                       P
                                    
                                 
                              
                           , we apply two methods. The first method is to solve a BPP which is equivalent to minimizing the number of rolls in the original cutting stock problem described in Section 3.1 for equal demands 
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                              
                           . If solved with the column generation approach, this method is fast and cheap (for the cases we are interested in with up to 80 orders), but the lower bound, 
                              
                                 
                                    
                                       N
                                    
                                    
                                       1
                                       -
                                    
                                    
                                       P
                                    
                                 
                              
                           , obtained is often weak for the PMP, cf. 
                           Vanderbeck (2000). The second method, used in phase V2-3, is to exploit the 
                              
                                 
                                    
                                       N
                                    
                                    
                                       min
                                    
                                    
                                       P
                                    
                                 
                              
                            solution to use the exact model V1 for minimizing the number of patterns. This enables us to work with a smaller set of potential patterns 
                              
                                 
                                    
                                       P
                                    
                                    
                                       pot
                                    
                                 
                                 =
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       min
                                    
                                    
                                       P
                                    
                                 
                                 }
                              
                           . It is impressive to see how quickly the commercial solvers CPLEX
                           and XpressMP improve upon the lower bound yielding 
                              
                                 
                                    
                                       N
                                    
                                    
                                       2
                                       -
                                    
                                    
                                       P
                                    
                                 
                              
                           , when we utilize the MIPSTART feature. For most examples with up to 50 orders we obtain 
                              
                                 
                                    
                                       N
                                    
                                    
                                       2
                                       +
                                    
                                    
                                       P
                                    
                                 
                                 -
                                 
                                    
                                       N
                                    
                                    
                                       2
                                       -
                                    
                                    
                                       P
                                    
                                 
                                 ⩽
                                 2
                              
                           , but in many cases 
                              
                                 
                                    
                                       N
                                    
                                    
                                       2
                                       +
                                    
                                    
                                       P
                                    
                                 
                                 -
                                 
                                    
                                       N
                                    
                                    
                                       2
                                       -
                                    
                                    
                                       P
                                    
                                 
                                 =
                                 1
                              
                            or even 
                              
                                 
                                    
                                       N
                                    
                                    
                                       2
                                       +
                                    
                                    
                                       P
                                    
                                 
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       2
                                       -
                                    
                                    
                                       P
                                    
                                 
                              
                           . Sometimes, in step V2-3, we even find a better solution, i.e., a solution with fewer patterns than 
                              
                                 
                                    
                                       N
                                    
                                    
                                       min
                                    
                                    
                                       P
                                    
                                 
                              
                           .

Production in the paper industry is closely connected to the cutting machines and their properties, e.g., the number of available knifes, or the minimal distance to the edges of the master rolls. The production philosophy in each company differs. Usually, the production planning problem and the cutting stock problem are not treated in one consistent MILP or MINLP model. As these two problems are inseparable, they must be solved somehow hand-in-hand, if not in one algorithm then at least iteratively. In some production planning heuristics, groups of orders are constructed, which become the input of a CSP. However, it is not unusual to find people working out the cutting stock patterns to leave out a few orders as they do not ideally fit into the patterns constructed or lead to patterns with too much trim-loss. These missing orders are considered in later production runs. In the strict sense, this means that underproduction is allowed. While the GGA in its standard form assumes that overproduction is allowed, in many practical instances, the planners are not amused about overproduction and do not really know what to do with the additional items. Efficient patterns with only a few percent trim-loss are an important issue which can easily conflict with other objectives, e.g., to minimize the number of patterns used. All these practical issues require us to apply modifications to the GGA or to resort to other techniques.

The GGA requires a few modifications to avoid the production of unnecessarily many orders:
                              
                                 •
                                 Generation of the initial patterns (by solving a separate knapsack problem which maximizes the number of used widths in the pattern while ensuring that each width is used at most twice i.e., 
                                       
                                          
                                             
                                                α
                                             
                                             
                                                i
                                             
                                          
                                          ⩽
                                          2
                                          ,
                                          ∀
                                          i
                                       
                                    ). If it is desirable to work primarily with efficient patterns, then it is better not to restrict 
                                       
                                          
                                             
                                                α
                                             
                                             
                                                i
                                             
                                          
                                       
                                     artificially but only use the demand, 
                                       
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                       
                                    , for item i, in the inequality 
                                       
                                          
                                             
                                                α
                                             
                                             
                                                i
                                             
                                          
                                          ⩽
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                          ∀
                                          i
                                       
                                    , in order to fill the patterns to the maximum. The initial knapsack problem is solved 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                I
                                             
                                          
                                       
                                     times. To guarantee feasibility of the initial master problem, we enforce for the i-th problem that width 
                                       
                                          
                                             
                                                W
                                             
                                             
                                                i
                                             
                                          
                                       
                                     is contained at least once in the pattern.

When dynamically generating new patterns, we ensure that each width is not contained more often than it is ordered. However, this restriction cannot be used when only efficient patterns with the minimum waste are considered.

Post-processing: Elimination of surplus items generated by the GGA as described in Appendix A.

Additional constraints lead to an extension of the GGA approach, which we refer generally to as column generation approach (CGA). These constraints may enter the master problems and/or the pricing problems. Constraints which influence the pattern design show up in the pricing problem. The restriction of the number of knives is one example. Another example is the requirement that very small strips need to be embedded by normal order widths. As long as such constraints do not require substantially more effort to solve the pricing problems they are harmless, i.e., the additional constraints do not destroy the structure of the pricing problems. Constraints showing up in the master problem tend to produce more difficulties. An example are constraints counting and restricting the number of patterns used in the optimal minimal trim-loss solution. We discuss two additional examples and their mathematics in Sections 3.5.4 and 3.5.5.

In general, we observe that the pattern space generated by the GGA is not complete. Thus, using the generated patterns by the GGA approach and changing the objective function or imposing additional constraints may lead to sub-optimal solutions or an infeasible problem.

If the CGA, due to additional constraints or a modified objective function, does not work efficiently anymore, we resort to complete or partial column enumeration in which we construct reasonable patterns explicitly. Afterwards, a set partitioning problem is solved for a different objective function. However, this approach works only if not too many patterns are generated (in the order of 
                              
                                 
                                    
                                       10
                                    
                                    
                                       4
                                    
                                 
                              
                            to 
                              
                                 5
                                 ·
                                 
                                    
                                       10
                                    
                                    
                                       4
                                    
                                 
                              
                           ); otherwise, it may become too difficult to solve the partitioning problem.

The paper producers very often want to accept only efficient patterns which do not have more than a certain trim-loss, 
                              
                                 
                                    
                                       W
                                    
                                    
                                       max
                                    
                                 
                              
                           , derived from the tolerable percent trim-loss, 
                              
                                 
                                    
                                       W
                                    
                                    
                                       max
                                    
                                    
                                       %
                                    
                                 
                              
                           . Depending on the order situation, this constraint may lead to infeasible situations. This is illustrated by the following example (all data carry the same units): A master roll with width of 
                              
                                 W
                                 =
                                 266
                              
                           , and order widths 
                              
                                 
                                    
                                       W
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 140
                                 ,
                                 
                                 
                                    
                                       W
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 138
                              
                           , and 
                              
                                 
                                    
                                       W
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 136
                              
                            lead to patterns with only one order width. This in turn produces an unacceptable large strip-loss of 
                              
                                 (
                                 266
                                 -
                                 140
                                 )
                                 /
                                 266
                                 =
                                 47.36
                              
                           %. Thus, for 
                              
                                 
                                    
                                       W
                                    
                                    
                                       max
                                    
                                    
                                       %
                                    
                                 
                                 <
                                 47.36
                              
                           %, the problem becomes infeasible.

In such cases, it is helpful to derive the smallest value, 
                              
                                 
                                    
                                       W
                                    
                                    
                                       min
                                    
                                    
                                       %
                                    
                                 
                              
                           , of 
                              
                                 
                                    
                                       W
                                    
                                    
                                       max
                                    
                                    
                                       %
                                    
                                 
                              
                            for which a feasible solution exists at all. What happens in real life is that the planner changes the order spectrum to leave out one or several critical orders. Again, this selection can be supported by appropriate auxiliary models. We allow underproduction with respect to the given orders but our objective function is to minimize this underproduction. In order to achieve this, we generate the patterns by the GGA, followed by a master problem in which we minimize the underproduction. Aconceptual problem with this approach is that we cannot be sure that we really produced all relevant patterns. Thus, we only obtain an upper bound on underproduction.

The demand is usually not met exactly with the GGA, as the column generation can lead to overproduction. In cases, in which we apply the GGA, we eliminate superfluous orders where possible with the heuristics described in Appendix A. However, these simple heuristics cannot always eliminate overproduction. In these cases, we resort to the MILP model of Johnston and Sadinlija to compute exact demand solutions.

The simple inequality (
                              
                                 ∀
                                 i
                              
                            and 
                              
                                 p
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                              
                           )
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          ip
                                       
                                    
                                    ⩽
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           in the pricing problem can avoid some overproduction problems. If the initial patterns also obey this inequality, at least, it is impossible that the usage of a single pattern p with 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 1
                              
                            exceeds demand.

Partitioning models adhere to the following upper bound on 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       p
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             max
                                          
                                          
                                             i
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   ip
                                                
                                             
                                             >
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  ip
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    p
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          ′
                                       
                                    
                                    .
                                 
                              
                           This is, however, rather a numerical improvement when solving the master problem and does not strictly avoid overproduction. Adding the following upper bound on 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       p
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             min
                                          
                                          
                                             i
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   ip
                                                
                                             
                                             >
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  ip
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    p
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           to the partitioning model may help, but can easily lead to infeasibility.

One might feel tempted to avoid overproduction by solving the CGA master problem with the exact demand constraint
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          pi
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                    ∀
                                    i
                                    ,
                                 
                              
                           replacing (8). Unfortunately, this may also lead to an infeasible partitioning problem as the pattern space does not allow for this. The resulting GGA still converges theoretically. However, besides feasibility issues when solving the master problem, the gap might no longer be small.

The fundamental problem with exact demand fulfillment is to generate the correct pattern space. A Branch&Price procedure is able to achieve this but at significant effort, computationally as well as implementation wise. For completeness, we note that if overproduction is allowed, then (
                              
                                 p
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                              
                           )
                              
                                 
                                    B
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          ip
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             min
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    .
                                 
                              
                           
                        

In real-world CSPs, we experience at least two reasons for allowing or dealing with underproduction. The first reason is, that the group of orders could lead to patterns which are not easily accepted due to large trim-loss. People prefer to leave out some complicating orders or to fulfill them only partially. The second reason may occur in situations where overproduction is strictly forbidden. This may lead to additional patterns or patterns with large trim-loss. Again, in such situations it may be better to underfill demand.

However, conceptually, it is not trivial to model underproduction because it leads to conflicting objective functions. If we allow one pattern for each item and pattern multiplicity is not restricted, we can avoid underproduction completely. This example illustrates that we somehow need to balance underproduction versus the number of rolls we are willing to use, or equivalently, we need to balance underproduction versus trim-loss. Therefore, the objective function (24) contains a term which maximizes the production or cutting of items and minimizes the number of rolls weighted by their individuals waste. The weighting factor 
                              
                                 ρ
                              
                            balances both aspects.

The objective of the master problem is now to maximize a weighted total production function
                              
                                 (24)
                                 
                                    
                                       max
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                             
                                             
                                                
                                                   W
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   N
                                                
                                                
                                                   ip
                                                
                                             
                                             -
                                             ρ
                                             
                                                
                                                   W
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                 
                              
                           with factor 
                              
                                 ρ
                              
                            and pattern waste 
                              
                                 
                                    
                                       W
                                    
                                    
                                       p
                                    
                                 
                              
                           , subject to the demand inequalities allowing underproduction
                              
                                 (25)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          ip
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    ⩽
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                    ∀
                                    i
                                    ,
                                 
                              
                           as well as the integrality constraints (9).

The sub-problem remains structurally a knapsack-constrained MILP with objective function
                              
                                 
                                    
                                       
                                          
                                             max
                                          
                                          
                                             α
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   π
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    ρ
                                    
                                       
                                          
                                             B
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                             
                                             
                                                
                                                   W
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       π
                                    
                                    
                                       i
                                    
                                 
                              
                            are the dual values of the demand inequality (25), subject to constraints (10) and (11). The term
                              
                                 
                                    B
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                    
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              
                           defines the waste 
                              
                                 
                                    
                                       W
                                    
                                    
                                       p
                                    
                                 
                              
                            of the newly generated pattern p, corresponding to optimal solution 
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                    
                                       ∗
                                    
                                 
                              
                           .

Instead of one roll type with width B and infinite length, we now consider 
                              
                                 
                                    
                                       N
                                    
                                    
                                       R
                                    
                                 
                              
                            types of rolls with width 
                              
                                 
                                    
                                       B
                                    
                                    
                                       r
                                    
                                 
                                 ,
                                 
                                 r
                                 ∈
                                 R
                                 =
                                 {
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             R
                                          
                                       
                                    
                                 
                                 }
                              
                           . Further, we assume that there are 
                              
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                 
                                 ∈
                                 
                                    
                                       IN
                                    
                                    
                                       0
                                    
                                 
                              
                            rolls of type r available on stock.

We modify the GGA as follows: The master problem contains the information of the limited availability of the rolls while the subproblems generate new patterns for each roll type. The subproblems separate with roll type r. This approach is similar to the work by Holthaus (2002). However, we consider a more involved objective function (leading to different pricing problems) and we limit the number of available master rolls.

If only one type of master rolls is available and if overproduction counts as waste, minimizing waste or number of rolls is equivalent. However, this is not true any longer for master rolls of different widths. When minimizing the number of rolls, the optimal solution is to use the master roll of largest width as often as possible. Therefore, we select as the objective function for the master problem the waste per pattern multiplied by the pattern multiplicity plus the overproduction:
                              
                                 (26)
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             R
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   r
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   r
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                             
                                             
                                                
                                                   W
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   N
                                                
                                                
                                                   ip
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      p
                                                      ∈
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   N
                                                
                                                
                                                   ip
                                                
                                             
                                             
                                                
                                                   μ
                                                
                                                
                                                   p
                                                
                                             
                                             -
                                             
                                                
                                                   D
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (27)
                                 
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             R
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   r
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   r
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   N
                                                
                                                
                                                   ip
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                    
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    .
                                 
                              
                           The master problem (7)–(9) gets extended by the following constraints
                              
                                 (28)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   r
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                       
                                    
                                    ⩽
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    ,
                                    
                                    ∀
                                    r
                                    ,
                                 
                              
                           where p is member of subset 
                              
                                 
                                    
                                       P
                                    
                                    
                                       r
                                    
                                    
                                       ′
                                    
                                 
                                 ⊂
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                              
                           , if pattern p is generated for roll type r; e.g., 
                              
                                 
                                    
                                       ∪
                                    
                                    
                                       r
                                       ∈
                                       R
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       r
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                              
                           .

We obtain one knapsack-type subproblem for each roll type r with objective function
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          r
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                    ≔
                                    
                                    
                                       min
                                    
                                    
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   r
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   π
                                                
                                                
                                                   r
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                             
                                             
                                                
                                                   π
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       min
                                    
                                    
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   r
                                                
                                             
                                             -
                                             
                                                
                                                   π
                                                
                                                
                                                   r
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      -
                                                      1
                                                      +
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           with dual variable 
                              
                                 
                                    
                                       π
                                    
                                    
                                       r
                                    
                                 
                              
                            associated with constraints (28). The slightly modified feasibility constraint for a new pattern for each master roll type r reads
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                    
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                    ⩽
                                    
                                       
                                          B
                                       
                                       
                                          r
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    
                                       
                                          IN
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                    ∀
                                    {
                                    r
                                    }
                                    .
                                 
                              
                           The column generation procedure converges, if
                              
                                 
                                    ∀
                                    r
                                    :
                                    
                                    
                                       
                                          z
                                       
                                       
                                          r
                                       
                                       
                                          ∗
                                       
                                    
                                    ⩾
                                    0
                                    ,
                                 
                              
                           otherwise, for each 
                              
                                 
                                    
                                       z
                                    
                                    
                                       r
                                    
                                    
                                       ∗
                                    
                                 
                                 <
                                 0
                              
                           , one new pattern p for roll type r is generated (this yields 
                              
                                 
                                    
                                       N
                                    
                                    
                                       ip
                                    
                                 
                              
                            and pattern p is included in 
                              
                                 
                                    
                                       P
                                    
                                    
                                       r
                                    
                                    
                                       ′
                                    
                                 
                              
                           ). Note that the computational effort is only linearly higher than in the column generation approach for the standard CSP. Instead of one pricing problem, we have to solve 
                              
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                 
                              
                            of them. However, with the objective function change, we lose the nice modified rounding-up property. Therefore, we need to watch the gap between the objective function values of the last relaxed master problem and the final MILP master problem.

Two examples of alternative objective functions are: (1) to minimize the number of patterns used and (2) to minimize the number of rolls subject to the constraints that at most a certain number of patterns could be used.

A change of objective function (or problem structure) may lead to a large gap between the relaxed master problem and the master problem, because the pattern space generated by a CGA is not complete. In this case, one can implement a Branch&Price algorithm or resort to the model by Johnston and Sadinlija (2004).

Using mathematical optimization algorithms and software in industrials environments for daily operational decision support, puts severe requirements of robustness on the algorithms, in the sense of solution quality, running time, and code stability. The user expects a certain time behavior and will be very irritated if one time a solution appears, for instance, after 20seconds, another time after 12minutes, and then again after 2minutes. The user interface may capture very incorrect data. Beyond this, production strategies and, thus, the number and size of order widths may change over the years. This could lead to different behavior of the algorithm resulting in different running times or quality of results. Therefore, in all our implementations, we put a strong effort on optimality, strong bounds and structural independence on the ratio of typical order widths versus the widths of the master roll. This also leads to our preference for clean, simple and robust algorithms. Therefore, we have not tried to implement Branch&Price algorithms, e.g., those excellent scientific pieces of work by Vanderbeck (2000) or Belov and Scheithauer (2006), which appear to us much harder to deliver in such an industrial quality.

We have implemented the algorithms in GAMS (v. 23.9.1) and use CPLEX (v. 12.4) to solve the resulting LP and MILP problems. The computational tests are performed on a standard laptop computer (Intel (R) i7 (dual core) with 3.3gigahertz and 12.0gigabytes RAM) running a 64-bit Windows 7 operating system. We stop our CGA iterations when the pricing problem satisfies the stopping criteria with an absolute tolerance of 0.001. The purpose of these numerical test runs is to demonstrate that the algorithms work and produce good or optimal results in reasonable time. Although, we did not find column generation approaches in the literature, it is not our claim that our algorithms and methods are the best or most appropriate. Therefore, our computational experiments run on a set of real world test instances with no comparisons against other authors and techniques. We rather want to present solutions to relevant real world cutting stock problems, which can be implemented in relatively short project time, which are well balanced between exact optimality and heuristics, and are easy to maintain.

The following abbreviations are used in Tables 1–3
                        
                        
                        :
                           
                              
                                 
                                 
                                 
                                    
                                       IT
                                       number of iterations (number of relaxed master problems solved)
                                    
                                    
                                       RMP
                                       relaxed master problem optimal objective function value
                                    
                                    
                                       IMP
                                       (integer) master problem optimal objective function value
                                    
                                    
                                       %G
                                       GAP between IMP and RMP in percent, i.e., (IMP – RMP)/ IMP
                                    
                                    
                                       DS
                                       demand satisfaction (E=equality, O=overproduction)
                                    
                                    
                                       nR
                                       number of rolls
                                    
                                    
                                       nP
                                       number of patterns
                                    
                                    
                                       nR∗
                                       
                                       number of rolls obtained with standard CGA
                                    
                                    
                                       nP∗
                                       
                                       number of patterns obtained with standard CGA
                                    
                                    
                                       LnP
                                       lower bound on minimum number of patterns
                                    
                                    
                                       MnP
                                       minimum number of patterns (proven)
                                    
                                    
                                       P∗
                                       
                                       solution uses minimal number of patterns
                                    
                                    
                                       R∗
                                       
                                       solution uses minimal number of rolls
                                    
                                    
                                       T∗
                                       
                                       solution uses minimal amount of trim-loss
                                    
                                    
                                       B
                                       best solution found: the solution contains the least number of patterns among all solutions found
                                    
                                    
                                       %Underprod
                                       total underproduction in percent
                                    
                                    
                                       %W
                                       total waste in percent
                                    
                                    
                                       Seconds
                                       computational time in seconds
                                    
                                 
                              
                           
                        
                     

For the 1D CSPs, we use 25 real-world problem instances from various customers, ranging from 1 to 50 different orders. The instances are characterized by the master roll width, the number of orders, the order widths, and the number of requested pieces. The instances are available in the online supplement of “EJOR.”
                        

In the weighted objective function, the parameter 
                              
                                 ρ
                              
                            crucially effects the computed solution. The results in Table 1 reflect the delicate role of 
                              
                                 ρ
                              
                           . For 
                              
                                 ρ
                                 =
                                 0
                              
                           , we obtain exact fulfillment of demand in almost all cases. Deviation, as for case 7 with one piece underfulfilled, can be explained by the difference between the solution of the restricted master problem (0.371 in this case) to the MILPmaster problem (84 in this case). However, the price to reach exact demand fulfillment is high, which is reflected in the large number of rolls. If we start with large values of 
                              
                                 ρ
                              
                           , minimizing the number of rolls is preferred and thus we are not surprised to see substantial underproduction. If we decrease 
                              
                                 ρ
                              
                           , at some value, we exactly meet demand for the first time. Usually, the number of rolls needed to fulfill demand exactly is identical to, or does not deviate too much from, the value obtained by the standard GGA. If we further decrease 
                              
                                 ρ
                              
                           , the number of rolls increases in most cases.

What is now the conclusion about the value of 
                              
                                 ρ
                              
                           ? For our problem instances, 
                              
                                 ρ
                                 =
                                 0.000001
                              
                            turned out to be the best value, yielding good results in almost all situations which occurred at our customer. However, this might be different in other situations. Thus, our advise is to experiment and analyze the results.

We modified the benchmark instances from Section 3.6.1 as follows: All data sets contain 3 master rolls of different widths. The width of the master rolls were selected as follows: roll 2 has width, 
                              
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                              
                           , of the benchmark data set. The width of roll 1 was reduced by about 30%, 
                              
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 max
                                 {
                                 ⌊
                                 0.7
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 ⌋
                                 ,
                                 
                                    
                                       max
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                            allowing that the largest width can be produced, while the width of roll 3 was set to 
                              
                                 
                                    
                                       B
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 ⌊
                                 1.2
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 ⌋
                              
                           .


                           Table 2 summarizes the computational results for 
                              
                                 K
                                 =
                                 ∞
                              
                           , i.e., the knife constraint has not been considered, and for master rolls with different widths and availability (equal to N for the three types); N1, N2 and N3 denote the number of rolls used. Solutions computed with the exact demand constraint are indicated by an “E” in column “DS”. If no solutions existed with the exact demand constraint or if the relative gap was larger than 20%, we allowed overproduction (“G” in column “DS”). However, in this case, the relative waste (“%W”) does not count overproduction as waste and is, thus, only of limited use.

Note that: (1) the CGA converges after a few iterations (“IT”) leading to running times of a few seconds. (2) Forcing exact demand satisfaction in the master problem (MILP) for the patterns computed leads to relatively large GAPs. Allowing overproduction results generally in smaller GAPs, but the modified round-up property does not hold (cf. Section 3.2). (3) The percentage waste (“%W”), when forcing exact demand satisfaction, is for most instances (except for “C01,” “C02,” “C03,” “C07,” “C49,” and “C50”) competitive and acceptable by practitioners. The percentage waste for the cases of overproduction excludes the overproduced pieces.

The limits, 
                              
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                 
                              
                           , on the number of available master rolls requires us to think about the computation of an initially feasible set, 
                              
                                 
                                    
                                       P
                                    
                                    
                                       0
                                    
                                 
                              
                           , of patterns. To generate 
                              
                                 
                                    
                                       P
                                    
                                    
                                       0
                                    
                                 
                              
                           , we solve the unlimited CSPs for each master roll width 
                              
                                 
                                    
                                       B
                                    
                                    
                                       r
                                    
                                 
                              
                            separately by the GGA. If 
                              
                                 
                                    
                                       P
                                    
                                    
                                       r
                                    
                                    
                                       ∗
                                    
                                 
                              
                            denotes the set of patterns in the optimal solution obtained for width 
                              
                                 
                                    
                                       B
                                    
                                    
                                       r
                                    
                                 
                              
                           , we obtain 
                              
                                 
                                    
                                       P
                                    
                                    
                                       0
                                    
                                 
                              
                            as the union 
                              
                                 
                                    
                                       P
                                    
                                    
                                       0
                                    
                                 
                                 
                                 ≔
                                 
                                 
                                    
                                       ∪
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       r
                                    
                                    
                                       ∗
                                    
                                 
                              
                           . If 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                 
                              
                            is not too small, 
                              
                                 
                                    
                                       P
                                    
                                    
                                       0
                                    
                                 
                              
                            allows us to compute an initial feasible solution to the overall problem. Columns 3–5 in Table 2 shows that, in most cases, the larger master rolls are used up to their limits.

The Exhaustion Method is designed to overcome the two main drawbacks of the GGA: The number of patterns required tends to be too large and we have overproduction. Table 3 summarizes the results of the Exhaustion Method. We report on the solution computed by the GGA; GGA provides an upper bound both on the minimal number of rolls and on the minimal number of patterns. Theoretical lower bounds on the number of patterns derived from the bin packing problem (the number of rolls is not restricted) are reported in column “LnP” while the minimal number of patterns required is given in column “MnP” for the cases where the Exhaustion Method was able to prove them.

For the 25 real data instances tested, we observe that the Exhaustion Method finds a solution with
                              
                                 (1)
                                 proven minimal number of rolls and proven minimal number of patterns in 10 cases (“C01,” “C02,” “C03,” “C04,” “C06,” “C13,” “C14,” “C15,” “C17,” “C19”),

proven minimal number of rolls while reducing the number of patterns used by at least 1 compared to the GGA in 14 cases.

The computational times never exceed 3min, even for the largest instances with 50 orders.

In this section, we derive optimal patterns to satisfy demand for orders consisting of rectangles to be cut from rolls. Note that general 2D cutting (or packing) problems require completely different methods; cf. 
                     Vanderbeck (2001) or Lodi, Martello, and Monaci (2002). However, in the current case we need to minimize the total trim-loss, resulting from horizontal and vertical cuts. Therefore, in our solution method we exploit the order of the cuts and solve a multi-step cutting stock problem with guillotine-cuts, which enables us to avoid the general 2D case and instead rather resort to solving the standard CSP as a subproblem. Fig. 1
                      shows the geometry and structure of that problem. We want to cut rectangles, also called formats, from master rolls of different widths. In order to cut these rectangles, a sufficient number of sheets, whose lengths has to be determined, is cut from the selected master roll. The sheets have the same width as the master rolls, but they may not use up the whole length of the master rolls. Sheets host longitudinal stripes (longitudinal patterns), and the stripes hosts the formats (rectangles) for which we have to satisfy demand. Thus, the sequence of cuts is: vertical guillotine cuts from the master roll to produce the sheets, longitudinal guillotine cuts in the sheets, and again vertical guillotine cuts in the strips. The longitudinal patterns are subject to a practical restrictions that they should not have more than S% strip-loss.

We use the following indices:
                           
                              
                                 
                                    
                                       a
                                       ∈
                                       A
                                       
                                       ≔
                                       
                                       {
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   I
                                                
                                             
                                          
                                       
                                       }
                                    
                                  the given order rectangles; 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             A
                                          
                                       
                                       ⩽
                                       25
                                    
                                 .

The rectangles (also called, formats) are given in a generic way with respect to their orientation in the longitudinal strip. We denote this by 
                                    
                                       [
                                       
                                          
                                             A
                                          
                                          
                                             a
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             a
                                          
                                       
                                       ]
                                    
                                 , we do not distinguish the ordering, i.e., 
                                    
                                       [
                                       
                                          
                                             A
                                          
                                          
                                             a
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             a
                                          
                                       
                                       ]
                                       =
                                       [
                                       
                                          
                                             B
                                          
                                          
                                             a
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             a
                                          
                                       
                                       ]
                                    
                                 . Thus, the notation 
                                    
                                       [
                                       
                                          
                                             A
                                          
                                          
                                             a
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             a
                                          
                                       
                                       ]
                                    
                                  or 
                                    
                                       [
                                       
                                          
                                             B
                                          
                                          
                                             a
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             a
                                          
                                       
                                       ]
                                    
                                  just refers to the rectangles with sides 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             a
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             a
                                          
                                       
                                    
                                  without paying attention to the specific length and width. An additional attribute signals whether the rectangles should be considered as oriented (1) or whether they could be rotated (2).


                                 
                                    
                                       i
                                       ∈
                                       I
                                       
                                       ≔
                                       
                                       {
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   I
                                                
                                             
                                          
                                       
                                       }
                                    
                                  the given, oriented order rectangles; 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             I
                                          
                                       
                                       ⩽
                                       50
                                    
                                 . Here, the orientation is fixed. The oriented order rectangles are obtained by duplicating the unordered order rectangles. The side 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             i
                                          
                                       
                                    
                                  is measured parallel to the width 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             r
                                          
                                       
                                    
                                  of a sheet; the side 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                    
                                  is parallel to the longitudinal stripe. We denote this by 
                                    
                                       [
                                       
                                          
                                             A
                                          
                                          
                                             i
                                          
                                       
                                       ×
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       ]
                                    
                                  where the ordering is important.


                                 
                                    
                                       j
                                       ∈
                                       J
                                       
                                       ≔
                                       
                                       {
                                       
                                          
                                             j
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             j
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   J
                                                
                                             
                                          
                                       
                                       }
                                    
                                  longitudinal patterns of sheets; 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             J
                                          
                                       
                                       =
                                       4000
                                    
                                  – 
                                    
                                       J
                                    
                                  generated via CE. The value 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             J
                                          
                                       
                                       =
                                       4000
                                    
                                  was sufficient for a particular customer case; it might be adjusted in other situations.


                                 
                                    
                                       r
                                       ∈
                                       R
                                       
                                       ≔
                                       
                                       {
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   R
                                                
                                             
                                          
                                       
                                       }
                                    
                                  roll types; 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             R
                                          
                                       
                                       =
                                       10
                                    
                                 .

The master rolls are given by their width 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             r
                                          
                                       
                                    
                                  and their inventory stock 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             r
                                          
                                       
                                    
                                  not modeled initially.

Note that as the longitudinal patterns should not have more than S% strip-loss (S
                        =2), for a specific customer project and the size of the rectangles to be cut, 
                           
                              
                                 
                                    N
                                 
                                 
                                    J
                                 
                              
                           
                         was sufficient, and larger than the number of longitudinal patterns.

These are the relevant input data used:
                           
                              
                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             r
                                          
                                       
                                    
                                 
                                 [L] the width of the master rolls.


                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             min
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             B
                                          
                                          
                                             max
                                          
                                       
                                    
                                 
                                 [cm] minimal and maximal width of the sheets; 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             max
                                          
                                       
                                       =
                                       
                                          
                                             max
                                          
                                          
                                             r
                                          
                                       
                                       {
                                       
                                          
                                             B
                                          
                                          
                                             r
                                          
                                       
                                       }
                                    
                                 .


                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             a
                                          
                                       
                                    
                                  [–] requested number of orders (demand) for order rectangle a.


                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             a
                                          
                                          
                                             R
                                          
                                       
                                    
                                  [–] indicator, whether (
                                    
                                       
                                          
                                             I
                                          
                                          
                                             a
                                          
                                          
                                             R
                                          
                                       
                                       =
                                       2
                                    
                                 ) or not (
                                    
                                       
                                          
                                             I
                                          
                                          
                                             a
                                          
                                          
                                             R
                                          
                                       
                                       =
                                       1
                                    
                                 ) order rectangle a can be rotated.


                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             min
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             L
                                          
                                          
                                             max
                                          
                                       
                                    
                                  [L] minimal and maximal length of the sheets.


                                 
                                    
                                       M
                                    
                                  [–] the number of available knives.

We use the following – mostly integer – variables:
                           
                              
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             rj
                                          
                                       
                                       ∈
                                       
                                          
                                             IN
                                          
                                          
                                             0
                                          
                                       
                                    
                                  [–] states how often the sheet j can be cut from roll r; only used in the master problem.


                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             rij
                                          
                                       
                                       ∈
                                       
                                          
                                             IN
                                          
                                          
                                             0
                                          
                                       
                                    
                                  [–] states how often the rectangle 
                                    
                                       [
                                       
                                          
                                             A
                                          
                                          
                                             i
                                          
                                       
                                       ×
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       ]
                                    
                                  is contained in the sheet j of roll r.

This variable is used in the subproblem and is the only independent variable of the subproblem and can be obtained explicitly.


                                 
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             rj
                                          
                                       
                                       ∈
                                       
                                          
                                             IN
                                          
                                          
                                             0
                                          
                                       
                                    
                                  [mm] specifies the length of the sheet j of roll 
                                    
                                       r
                                       ;
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             rj
                                          
                                       
                                    
                                  depends on all 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             rij
                                          
                                       
                                    
                                 .


                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             p
                                          
                                       
                                       ⩾
                                       0
                                    
                                  [–] states the trim-loss of pattern 
                                    
                                       p
                                       ;
                                       
                                       0
                                       ⩽
                                       
                                          
                                             w
                                          
                                          
                                             p
                                          
                                       
                                       ⩽
                                       B
                                    
                                 .

The algorithm is structured as follows:
                           
                              1.
                              The order rectangles 
                                    
                                       [
                                       
                                          
                                             A
                                          
                                          
                                             a
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             a
                                          
                                       
                                       ]
                                    
                                 , given through their length and width, are duplicated and yield the oriented rectangles 
                                    
                                       [
                                       
                                          
                                             A
                                          
                                          
                                             i
                                          
                                       
                                       ×
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       ]
                                    
                                 . The indices i and a are connected as follows
                                    
                                       
                                          a
                                          (
                                          i
                                          )
                                          
                                          ≔
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ,
                                                            
                                                            1
                                                            ⩽
                                                            i
                                                            ⩽
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  A
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            i
                                                            -
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  A
                                                               
                                                            
                                                         
                                                         
                                                            ,
                                                            
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  A
                                                               
                                                            
                                                            +
                                                            1
                                                            ⩽
                                                            i
                                                            ⩽
                                                            2
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  A
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

which yields
                                    
                                       
                                          [
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                          ×
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                          ]
                                          
                                          ≔
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            [
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  a
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            ×
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  a
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            ]
                                                         
                                                         
                                                            ,
                                                            
                                                            1
                                                            ⩽
                                                            i
                                                            ⩽
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  A
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            [
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  a
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            ×
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  a
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                            ]
                                                         
                                                         
                                                            ,
                                                            
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  A
                                                               
                                                            
                                                            +
                                                            1
                                                            ⩽
                                                            i
                                                            ⩽
                                                            2
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  A
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

or (
                                    
                                       ∀
                                       {
                                       i
                                       |
                                       1
                                       ⩽
                                       i
                                       ⩽
                                       
                                          
                                             N
                                          
                                          
                                             A
                                          
                                       
                                       }
                                    
                                 )
                                    
                                       
                                          [
                                          
                                             
                                                B
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          ×
                                          
                                             
                                                A
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          ]
                                          =
                                          [
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                          ×
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                          ]
                                          ,
                                          
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          
                                          ≔
                                          
                                          i
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                A
                                             
                                          
                                          .
                                       
                                    
                                 
                              

The demand for order rectangle 
                                    
                                       [
                                       
                                          
                                             A
                                          
                                          
                                             a
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             a
                                          
                                       
                                       ]
                                    
                                  can thus be fulfilled the by orientated rectangles i and 
                                    
                                       
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 .

For each master roll r with width 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             r
                                          
                                       
                                    
                                 , enumeration is used to
                                    
                                       (a)
                                       generate up to 
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      J
                                                   
                                                
                                             
                                           stripe partitions (longitudinal patterns) which are compatible to 
                                             
                                                {
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      i
                                                   
                                                
                                                }
                                             
                                           (the width of the stripes correspond to the width 
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          ) – thus, the strip-loss and the width of each longitudinal strip are known – and

solve the corresponding subproblem (minimization of the vertical trim-loss of a stripe partition, see Section 3.2) – thus, the vertical trim-loss and the total trim-loss of each roll as well as its length 
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                   
                                                      rj
                                                   
                                                
                                             
                                           are known. In addition, the solution of the subproblem gives us the number, 
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      raj
                                                   
                                                   
                                                      tot
                                                   
                                                
                                             
                                          , of order rectangles 
                                             
                                                [
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      a
                                                   
                                                
                                                ,
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      a
                                                   
                                                
                                                ]
                                             
                                           covered by sheet rj.

The master problem is a partitioning problem. This MILP problem calculates how many sheets of length 
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             rj
                                          
                                       
                                    
                                  are required in order to meet the demand for order rectangles 
                                    
                                       [
                                       
                                          
                                             A
                                          
                                          
                                             a
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             a
                                          
                                       
                                       ]
                                    
                                 .

The master problem minimizes the total trim-loss, i.e., the model makes use of the following objective function
                              
                                 (29)
                                 
                                    
                                       min
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             R
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             J
                                          
                                       
                                    
                                    
                                       
                                          W
                                       
                                       
                                          rj
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          rj
                                       
                                    
                                    ,
                                 
                              
                           with trim-loss 
                              
                                 
                                    
                                       W
                                    
                                    
                                       rj
                                    
                                 
                              
                            for the sheet rj; the integer variable 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       rj
                                    
                                 
                              
                            denotes its multiplicity. The demand equation reads
                              
                                 (30)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          a
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             R
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             J
                                          
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          raj
                                       
                                       
                                          tot
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          rj
                                       
                                    
                                    ⩽
                                    
                                       
                                          D
                                       
                                       
                                          a
                                       
                                    
                                    +
                                    
                                       
                                          D
                                       
                                       
                                          a
                                       
                                       
                                          over
                                       
                                    
                                    ,
                                    
                                    ∀
                                    a
                                 
                              
                           or
                              
                                 (31)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             R
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             J
                                          
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          rij
                                       
                                       
                                          tot
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          rj
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             R
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             J
                                          
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          r
                                          ,
                                          i
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                A
                                             
                                          
                                          ,
                                          j
                                       
                                       
                                          tot
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          rj
                                       
                                    
                                    ⩽
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                       
                                          over
                                       
                                    
                                    ,
                                    
                                    ∀
                                    {
                                    i
                                    |
                                    1
                                    ⩽
                                    i
                                    ⩽
                                    
                                       
                                          N
                                       
                                       
                                          A
                                       
                                    
                                    }
                                    .
                                 
                              
                           The multiplicity variables can be bounded by
                              
                                 (32)
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          rj
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             max
                                          
                                          
                                             a
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  a
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  a
                                                               
                                                               
                                                                  over
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               max
                                                            
                                                            {
                                                            1
                                                            ,
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  raj
                                                               
                                                               
                                                                  tot
                                                               
                                                            
                                                            }
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    {
                                    rj
                                    }
                                    .
                                 
                              
                           The integrality constraints are given by
                              
                                 (33)
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          rj
                                       
                                    
                                    ∈
                                    
                                       
                                          IN
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                    ∀
                                    {
                                    rj
                                    }
                                    .
                                 
                              
                           For operative reasons, it might be useful to use only rolls of a particular width 
                              
                                 
                                    
                                       r
                                    
                                    
                                       ∗
                                    
                                 
                              
                           , because several of such rolls might be cut on top of each other simultaneously (e.g., up to four rolls can be cut at the same time in our case). In this case, model (29)–(33) is substituted by a sequence of 
                              
                                 
                                    
                                       N
                                    
                                    
                                       R
                                    
                                 
                              
                            models, where each time only one of the 
                              
                                 
                                    
                                       N
                                    
                                    
                                       R
                                    
                                 
                              
                            roll widths is used; the user can then select the appropriate solution. Care has to be taken when restricting overproduction; this can lead to infeasibilities when considering a single roll width. It might be useful to consider a goal programming approach which first minimizes the overproduction and second the trim-loss, or vice versa.

Alternatively, we introduce the binary variables 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       r
                                    
                                 
                              
                            which is 1 if a roll of width r is used and 0 otherwise. The following equation
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             R
                                          
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          r
                                       
                                    
                                    =
                                    1
                                 
                              
                           and inequalities
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          rj
                                       
                                    
                                    ⩽
                                    
                                       
                                          δ
                                       
                                       
                                          r
                                       
                                    
                                    ,
                                    
                                    ∀
                                    {
                                    rj
                                    }
                                 
                              
                           need to be added to the model.

The inventory stock can be modeled with the following approach: Each individual master roll t by its roll type r (width) and its (remaining) length 
                              
                                 
                                    
                                       L
                                    
                                    
                                       t
                                    
                                 
                              
                           . Then, the following constraints
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          rj
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             |
                                             
                                                
                                                   R
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             ord
                                             (
                                             r
                                             )
                                          
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          rjt
                                       
                                    
                                    ,
                                    
                                    ∀
                                    {
                                    rj
                                    }
                                 
                              
                           and
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             |
                                             
                                                
                                                   R
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             ord
                                             (
                                             r
                                             )
                                          
                                       
                                    
                                    
                                       
                                          L
                                       
                                       
                                          rj
                                       
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          rjt
                                       
                                    
                                    ⩽
                                    
                                       
                                          L
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                    ∀
                                    {
                                    rjt
                                    }
                                 
                              
                           need to be satisfied. The integer variable 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       rjt
                                    
                                 
                              
                            describes, how many sheets of type rj are to be cut from master roll t.

For a given distribution of longitudinal cuts for a sheet rj – i.e., a system of values 
                              
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 1
                                 ⩽
                                 i
                                 ⩽
                                 2
                                 
                                    
                                       N
                                    
                                    
                                       A
                                    
                                 
                              
                            – the task is to decide on the lengths 
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       rj
                                    
                                 
                              
                            of the sheet such that the vertical trim-loss 
                              
                                 
                                    
                                       w
                                    
                                    
                                       rj
                                    
                                    
                                       ver
                                    
                                 
                              
                           , the total trim-loss 
                              
                                 
                                    
                                       w
                                    
                                    
                                       rj
                                    
                                    
                                       tot
                                    
                                 
                              
                           , or the 
                              
                                 
                                    
                                       w
                                    
                                    
                                       rj
                                    
                                    
                                       rel
                                    
                                 
                              
                            striploss is minimized. The integer variable 
                              
                                 
                                    
                                       α
                                    
                                    
                                       rij
                                    
                                 
                              
                            defines the amount of times the oriented rectangle 
                              
                                 [
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 ×
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 ]
                              
                            is contained in the longitudinal stripe i (defined through 
                              
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                              
                           ) with multiplicity 
                              
                                 
                                    
                                       N
                                    
                                    
                                       rij
                                    
                                    
                                       pat
                                    
                                 
                              
                           . This enables us to express the vertical trim-loss as
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      rj
                                                   
                                                   
                                                      ver
                                                   
                                                
                                                
                                                ≔
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         |
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               rij
                                                            
                                                            
                                                               pat
                                                            
                                                         
                                                         >
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               rij
                                                            
                                                            
                                                               pat
                                                            
                                                         
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      rij
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      rij
                                                   
                                                
                                                
                                                ≔
                                                
                                                
                                                   
                                                      ℓ
                                                   
                                                   
                                                      rj
                                                   
                                                
                                                -
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      rij
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           The absolute and relative trim-loss – the latter leading to a MINLP problem – are given through
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          rj
                                       
                                       
                                          tot
                                       
                                    
                                    
                                    ≔
                                    
                                    
                                       
                                          W
                                       
                                       
                                          r
                                       
                                    
                                    
                                       
                                          ℓ
                                       
                                       
                                          rj
                                       
                                    
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          rj
                                       
                                       
                                          ver
                                       
                                    
                                 
                              
                           and
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          rj
                                       
                                       
                                          rel
                                       
                                    
                                    
                                    ≔
                                    
                                    
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   r
                                                
                                             
                                             +
                                             
                                                
                                                   w
                                                
                                                
                                                   rj
                                                
                                                
                                                   ver
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          ℓ
                                       
                                       
                                          rj
                                       
                                    
                                    .
                                 
                              
                           The relative trim-loss measure for the objective function leads to more large sheets close to the limit 
                              
                                 
                                    
                                       L
                                    
                                    
                                       max
                                    
                                 
                              
                           . However, they will contain more formats.

The model is restricted by
                              
                                 
                                    
                                       
                                          L
                                       
                                       
                                          min
                                       
                                    
                                    ⩽
                                    
                                       
                                          ℓ
                                       
                                       
                                          rj
                                       
                                    
                                    ⩽
                                    
                                       
                                          L
                                       
                                       
                                          max
                                       
                                    
                                 
                              
                           and (
                              
                                 ∀
                                 {
                                 rij
                                 |
                                 
                                    
                                       N
                                    
                                    
                                       rij
                                    
                                    
                                       pat
                                    
                                 
                                 =
                                 0
                                 }
                              
                           )
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      rij
                                                   
                                                
                                                =
                                                0
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      rij
                                                   
                                                   
                                                      min
                                                   
                                                
                                                
                                                ≔
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     min
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     B
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      rij
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     max
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     B
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                =
                                                :
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      rij
                                                   
                                                   
                                                      max
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

For computational efficiency, we suggest to calculate the solution of the subproblems and all derived data 
                              
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       rij
                                    
                                 
                                 ,
                                 
                                    
                                       ℓ
                                    
                                    
                                       rj
                                    
                                 
                                 )
                              
                            simultaneously with CE. The structure of the subproblem allows us to compute the optimal values of 
                              
                                 
                                    
                                       α
                                    
                                    
                                       rij
                                    
                                 
                              
                            analytically. The flowchart for the explicit calculation of 
                              
                                 
                                    
                                       α
                                    
                                    
                                       rij
                                    
                                 
                              
                            for sheet rj is summarized in Algorithm 4.1.
                              Algorithm 4.1
                              Explicit solution of the subproblem. 
                                    
                                       
                                          
                                          
                                             
                                                1: 
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               min
                                                            
                                                         
                                                         
                                                         ≔
                                                         
                                                         +
                                                         ∞
                                                      
                                                    // Initialization of the trim-loss
                                             
                                             
                                                2: for all 
                                                   
                                                      
                                                         i
                                                         =
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               W
                                                            
                                                         
                                                         =
                                                         2
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               A
                                                            
                                                         
                                                      
                                                    
                                                   do
                                                
                                             
                                             
                                                3: if 
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               ij
                                                            
                                                            
                                                               pat
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                    goto line 26
                                             
                                             
                                                4: 
                                                   
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               min
                                                            
                                                         
                                                         
                                                         ≔
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              L
                                                                           
                                                                           
                                                                              min
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              B
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   , 
                                                   
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               max
                                                            
                                                         
                                                         
                                                         ≔
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              L
                                                                           
                                                                           
                                                                              max
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              B
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                5: // loop over all feasible 
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                6: 
                                                   for all 
                                                   
                                                      
                                                         k
                                                         =
                                                         max
                                                         {
                                                         1
                                                         ,
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               min
                                                            
                                                         
                                                         }
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               max
                                                            
                                                         
                                                      
                                                    
                                                   do
                                                
                                             
                                             
                                                7: 
                                                   
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                         ≔
                                                         
                                                         k
                                                      
                                                   , 
                                                   
                                                      
                                                         ℓ
                                                         
                                                         ≔
                                                         
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         k
                                                      
                                                   , 
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               strip
                                                            
                                                         
                                                         
                                                         ≔
                                                         
                                                         W
                                                         ℓ
                                                      
                                                   , 
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               ver
                                                            
                                                         
                                                         
                                                         ≔
                                                         
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                8: // inner loop over all 
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         
                                                         ≠
                                                         
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                9: 
                                                   for all 
                                                   
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         =
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         2
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               A
                                                            
                                                         
                                                      
                                                    
                                                   do
                                                
                                             
                                             
                                                10: 
                                                   if 
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               
                                                                  
                                                                     ri
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               j
                                                            
                                                            
                                                               pat
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                    or 
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         =
                                                         i
                                                      
                                                    goto line 15
                                             
                                             
                                                11: 
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                         ≔
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ℓ
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              B
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    i
                                                                                 
                                                                                 
                                                                                    ′
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   , 
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                            
                                                               ver
                                                            
                                                         
                                                         
                                                         ≔
                                                         
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               ij
                                                            
                                                            
                                                               pat
                                                            
                                                         
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ℓ
                                                                  -
                                                                  
                                                                     
                                                                        B
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              ′
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        α
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              ′
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   , 
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               ver
                                                            
                                                         
                                                         
                                                         ≔
                                                         
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               ver
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                            
                                                               ver
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                12: 
                                                   end for
                                                
                                             
                                             
                                                13: 
                                                   
                                                      
                                                         z
                                                         
                                                         ≔
                                                         
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               strip
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               ver
                                                            
                                                         
                                                      
                                                    
                                                   
                                                   // absolute trim-loss
                                             
                                             
                                                14: 
                                                   
                                                      
                                                         z
                                                         
                                                         ≔
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     strip
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     ver
                                                                  
                                                               
                                                            
                                                            
                                                               ℓ
                                                            
                                                         
                                                      
                                                    
                                                   
                                                   // relative trim-loss
                                             
                                             
                                                15: // check, whether or not z leads to an improvement compared to 
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               min
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                16: 
                                                   if 
                                                   
                                                      
                                                         z
                                                         <
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               min
                                                            
                                                         
                                                      
                                                    
                                                   then
                                                
                                             
                                             
                                                17: 
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ℓ
                                                            
                                                            
                                                               ∗
                                                            
                                                         
                                                         
                                                         ≔
                                                         
                                                         ℓ
                                                      
                                                   , 
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               ∗
                                                            
                                                            
                                                               strip
                                                            
                                                         
                                                         
                                                         ≔
                                                         
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               strip
                                                            
                                                         
                                                      
                                                   , 
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               ∗
                                                            
                                                            
                                                               ver
                                                            
                                                         
                                                         
                                                         ≔
                                                         
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               ver
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                18: 
                                                   
                                                   for all 
                                                   
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               ″
                                                            
                                                         
                                                         =
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         2
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               A
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     ″
                                                                  
                                                               
                                                               j
                                                            
                                                            
                                                               pat
                                                            
                                                         
                                                         >
                                                         0
                                                      
                                                    
                                                   do
                                                
                                             
                                             
                                                19: 
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     ″
                                                                  
                                                               
                                                            
                                                            
                                                               ∗
                                                            
                                                         
                                                         
                                                         ≔
                                                         
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     ″
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   , 
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     ″
                                                                  
                                                               
                                                            
                                                            
                                                               ver
                                                            
                                                         
                                                         
                                                         ≔
                                                         
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               
                                                                  
                                                                     ri
                                                                  
                                                                  
                                                                     ″
                                                                  
                                                               
                                                               j
                                                            
                                                            
                                                               pat
                                                            
                                                         
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     ″
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ℓ
                                                                     
                                                                     
                                                                        ∗
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        B
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              ″
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       ℓ
                                                                                    
                                                                                    
                                                                                       ∗
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 
                                                                                    
                                                                                       B
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             i
                                                                                          
                                                                                          
                                                                                             ″
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                20: 
                                                   
                                                   end for
                                                
                                             
                                             
                                                21: 
                                                   end if
                                                
                                             
                                             
                                                22: 
                                                   end for
                                                
                                             
                                             
                                                23: end for
                                                
                                             
                                             
                                                24: return 
                                                   
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               ∗
                                                            
                                                         
                                                      
                                                    and 
                                                      
                                                         
                                                            
                                                               ℓ
                                                            
                                                            
                                                               ∗
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

Note that this explicit solution method works for the absolute as well as the relative trim-loss.

If rolls and sheets are treated as individuals, a result such as
                              
                                 
                                    
                                    
                                       
                                          
                                             Order A25022007 is satisfied by:
                                          
                                       
                                       
                                          
                                             
                                             Sheet 1-433 of roll R102-stock0017
                                          
                                       
                                       
                                          
                                             
                                             Sheet 22-40 of roll R152-stock0002
                                          
                                       
                                    
                                 
                              
                           enables us to know how the orders are satisfied. Further, we might be interested what happens with each rectangle cut from a roll and sheet, i.e., for which order it is intended.

The assignment of rectangles in the sheets to the original orders is done after optimizing the trim-loss. The algorithm does not require any additional data or results other than the ones provided for the trim-loss minimization problems. However, the following derived data are necessary:
                              
                                 
                                    
                                       
                                          i
                                          =
                                          i
                                          (
                                          a
                                          )
                                       
                                     [–] rectangle i, corresponding to order a [derived entry date].


                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          a
                                          )
                                       
                                     [–] rectangle 
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    , obtained through rotation of rectangle i and corresponding to order a [derived entry date].


                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                a
                                             
                                          
                                       
                                     [–] the order quantity for order a [derived entry date].


                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                rji
                                             
                                          
                                       
                                     [–] the quantity how often rectangle i is contained in sheet rj.


                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                
                                                   
                                                      rji
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                     [–] the quantity, how often rectangle i associated with rectangle 
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                       
                                     is contained in sheet rj.


                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                rj
                                             
                                          
                                       
                                     [–] the quantity, how often sheet rj is used.


                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                rja
                                             
                                          
                                          
                                          ≔
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                rj
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         rji
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         
                                                            
                                                               rji
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                     [–] the quantity, how often the order a corresponding to rectangles i and 
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                       
                                     are produced by sheet rj.

The model and algorithm requires the following variables:
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                arj
                                             
                                          
                                          ∈
                                          IN
                                       
                                     [–] the number of rectangles, cut from the sheet rj, used for order a.

The variables can assume values between 0 and 
                                       
                                          
                                             
                                                X
                                             
                                             
                                                rj
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         rji
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         
                                                            
                                                               rji
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    .


                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                arj
                                             
                                          
                                          ∈
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                     [–] indicates, whether (1) or not (0) order a is served by sheet rj.

The goal is to minimize the sum over all quantities 
                              
                                 
                                    
                                       s
                                    
                                    
                                       a
                                    
                                 
                                 
                                 ≔
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       rj
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       arj
                                    
                                 
                              
                           , which measures how many sheets serve order a, i.e.,
                              
                                 
                                    
                                       min
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             a
                                             ∈
                                             A
                                          
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          a
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             a
                                             ∈
                                             A
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             rj
                                          
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          arj
                                       
                                    
                                    .
                                 
                              
                           The demand satisfaction is a constraint
                              
                                 
                                    
                                       min
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             rj
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          arj
                                       
                                    
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          a
                                       
                                    
                                    .
                                 
                              
                           The variables 
                              
                                 
                                    
                                       x
                                    
                                    
                                       arj
                                    
                                 
                              
                            are restricted by
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          arj
                                       
                                    
                                    ⩽
                                    
                                       min
                                    
                                    {
                                    
                                       
                                          X
                                       
                                       
                                          arj
                                       
                                    
                                    ,
                                    
                                       
                                          D
                                       
                                       
                                          a
                                       
                                    
                                    }
                                    
                                       
                                          y
                                       
                                       
                                          arj
                                       
                                    
                                    ;
                                    
                                    ∀
                                    {
                                    arj
                                    }
                                    .
                                 
                              
                           
                        


                           Note: This assignment problem is solved after the minimization problem. The quality of the results with respect to trim-loss and the quantity of sheets is not affected.

We use the same computational framework as for the 1D case (cf. Section 3.6). The details of the 12 test instances used are summarized in Table 4
                        . Each 2D instance is characterized by the number of orders, 
                           
                              
                                 
                                    N
                                 
                                 
                                    A
                                 
                              
                           
                        , and the size of the rectangles to be cut (i.e., length and width), quantity of requested pieces, number of different-size master rolls, 
                           
                              
                                 
                                    N
                                 
                                 
                                    R
                                 
                              
                           
                        , and their widths. Each master roll is assumed to have infinite length.

The results for the 2D test instances are summarized in Table 5
                        . For the reported optimal solution, 
                           
                              
                                 
                                    N
                                 
                                 
                                    S
                                 
                              
                           
                         is the number of different sheets required, “S” (surplus) indicates the number of overproduced pieces, “%W” is the relative waste in percent and “T” shows the time in milliseconds. The interpretation of the “Optimal Solution” is illustrated by the example 
                           
                              1213
                              ×
                              [
                              4
                              A
                              2
                              ·
                              3
                           
                        
                        +A1r
                           
                              ·
                              5
                              ]
                              →
                              2
                           
                        : The “
                           
                              →
                           
                        2” indicates that this sheet is cut from roll type 2 with multiplicity 1213. “4A2
                           
                              ·
                              3
                           
                        ” expresses that order A2 enters 
                           
                              
                                 
                                    N
                                 
                                 
                                    rij
                                 
                                 
                                    pat
                                 
                              
                              =
                              3
                           
                         times and that 
                           
                              
                                 
                                    α
                                 
                                 
                                    rij
                                 
                              
                              =
                              4
                           
                        ; the total contribution of that sheet to order A2 is thus 
                           
                              1213
                              ·
                              4
                              ·
                              3
                              =
                              14556
                           
                         pieces. The term “A1r
                           
                              ·
                              5
                           
                        ” indicates that the sheet contains order A1 in rotated placement and contributes 
                           
                              1213
                              ·
                              1
                              ·
                              5
                              =
                              6065
                           
                         pieces.

The table shows that the model and algorithm can handle various different situations regarding size of the rectangles and from small demand numbers to large ones reaching up to 1000000. All results were obtained in fractions of one second. From a practical point, sheets which are used only once or with small multiplicity, are not desirable. As they do not contribute many pieces, they are usually neglected – little underproduction is not a problem.

We assemble various CSPs which are at the fore-front of research or cannot be found in the literature.

An important practical challenge is how to deal with variations in demand. We follow the spirit by Beraldi, Bruni, and Conforti (2009) and treat the demand stochastically: In the first stage, decisions on the choice of patterns have to be made to satisfy first stage demand (
                           
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                           
                        ) while their multiplicity can be adjusted in a second-stage when the stochastic second-stage demand (
                           
                              
                                 
                                    D
                                 
                                 
                                    is
                                 
                              
                           
                        ) unfolds. The task is then to minimize the total expected number of patterns used.

The column enumeration procedure (cf. Section 3.3) can be adjusted in a straight forward manner to deal with demand uncertainty. Once the columns (collected in set 
                           
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                           
                        ) have been enumerated, we solve the following MILP:
                           
                              
                                 
                                    min
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                p
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   s
                                                   ∈
                                                   S
                                                
                                             
                                          
                                          
                                             
                                                p
                                             
                                             
                                                s
                                             
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                ps
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        with probability 
                           
                              
                                 
                                    p
                                 
                                 
                                    s
                                 
                              
                           
                         of scenario s occurring, subject to the first-stage demand-fulfill inequalities (8), the second-stage demand constraints
                           
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       ip
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       ps
                                    
                                 
                                 ⩾
                                 
                                    
                                       D
                                    
                                    
                                       is
                                    
                                 
                                 ,
                                 
                                 ∀
                                 {
                                 is
                                 }
                                 ,
                              
                           
                        and the connection of the first-stage and second-stage pattern
                           
                              
                                 
                                    
                                       δ
                                    
                                    
                                       p
                                    
                                 
                                 ⩽
                                 
                                    
                                       μ
                                    
                                    
                                       p
                                    
                                 
                                 ⩽
                                 
                                    
                                       M
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 
                                 ∀
                                 p
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        and
                           
                              
                                 
                                    
                                       μ
                                    
                                    
                                       ps
                                    
                                 
                                 ⩽
                                 
                                    
                                       M
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 
                                 ∀
                                 p
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 ∀
                                 s
                                 ,
                              
                           
                        where binary variable 
                           
                              
                                 
                                    δ
                                 
                                 
                                    p
                                 
                              
                           
                         indicates whether or not patter p is used in the first stage or not and 
                           
                              
                                 
                                    M
                                 
                                 
                                    p
                                 
                              
                           
                         is a sufficiently large constant. We require integrality on the decision variables
                           
                              
                                 
                                    
                                       μ
                                    
                                    
                                       ps
                                    
                                 
                                 ∈
                                 
                                    
                                       IN
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                 ∀
                                 p
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 ∀
                                 s
                              
                           
                        and
                           
                              
                                 
                                    
                                       δ
                                    
                                    
                                       p
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 ∀
                                 p
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                              
                           
                        as well as integrality constraint (9).


                        Alem, Munari, Arenales, and Ferreira (2010) also consider stochastic demand for CSPs. However, the first stage decision is on the multiplicity and pattern choice where the recourse decisions determine over- or under-production of the stochastic demand realized. The objective is then to minimize the cutting cost plus penalty cost for over- and under-production. The resulting problem structure allows us to apply a column generation approach.

In the literature, cutting stock problems appear with certain number of order rolls demanded. However, in reality, the orders are often specified in weight. If one has master rolls of different lengths (!) available, the total weight ordered is subject to different number of rolls cut to a certain pattern. Both, the ordered weights and widths, are subject to tolerances.

In Section 3.5.5 we have provided a CGA for the simplest case of master rolls with different widths and limited stock availability, but under the assumption that all have the same length (usually, infinity). However, on stock may imply, that the rolls on stock have also finite and different lengths. This case may occur under certain production philosophies and forces us to treat rolls as individuals.

These problems are really hard as we have to deliver at certain due dates but there are already examples in the literature as outlined in Section 2. Here we find make-to-stock versus make-to-order (and mixed strategies). This class of problems is challenging as cutting procedures and production scheduling vary from case to case.

In recent times, the paper industry has vigorously cut back their capacity, rising the prices. Rising energy and raw material costs pressure the manufacturers. Many machines were shut down worldwide. Also, the concentration process has continued.

The use of automated, software-based waste optimization provides great benefits to all producers of rolls or formats such as paper mills, film producers and steelmakers.

A manually performed cut plan by a production planner, even though s/he might have significant experience and knowledge, is, depending on the complexity, very time consuming and reaches, as opposed to a software-based plan, usually not the optimum. This becomes even more significant for producers with very different widths or format sizes and different machines.

Our customers use the trim optimization both when determining the optimal width of the parent rolls and when planning secondary production processes. Waste optimization, integrated into the planning process, is an essential, indispensable element of the short- and long-term production planning. Depending on the complexity of the process, using the integrated waste optimization, even an automated production planning is possible, e.g., a weekly schedule.

For paper factories, which produce only standard or simple cutting patterns, mathematical optimization may not be beneficial. Manual results are hard to beat for plants with very standardized product portfolio. In contrast, for plants which encounter a broad spectrum of products, our experience is a follows. Depending on the complexity of their production structure, our customers confirmed 3–6% reduced trim-loss, comparing mathematical optimization based cutting stock solutions to their manual procedures.

Let us inspect this in detail for a typical customer producing special paper: For an annual production of 50000 tons a trim-loss reduction of 3% saves 1500tons per year. Even if the trim loss is used in a recycling mill as raw material, the total saving is 285000Euro production costs at the paper machine if we apply typical production cost of 190Euro per ton of produced paper, not considering the raw material price. Those paper factories which cannot recycle the savings are significantly higher. The one-time purchase cost for our computer-based solution is about 30000–40000Euro. Under the conditions of this example, the Return of Investment (ROI) is reached after only two months. A further advantage is the decrease of dependence on employees with many years of knowledge and experience in the creation of manual cutting plans.

On a global scale, the financial benefit of optimization tools in the cutting paper industry varies, e.g., dependent on the machine type and order variety. In our experience, manual plans exhibit an average waste of between 3–5%, while optimization yields in less than 2% waste, often below 1%. One percentage waste minimization may lead to an annual saving of one million Euro per paper machine.

In our experience, the diversification of our clients’ products and the industry as a whole increases steadily, so that the use of a software-supported, automated production planning with integrated cutting stock optimization becomes more and more a necessity. Solving cutting stock problems is not an isolated activity any longer.

@&#CONCLUSIONS@&#

Motivated by challenges arising in the paper industry, we have presented various polylithic solution approaches to model and solve a testbed of 1D and 2D real-world cutting problems. The methods are implemented in GSE’s ERP system. We have developed new column generation approaches to treat problems with different master roll widths, limited number of master rolls on stock, or problems in which underproduction is allowed but to be minimized. Numerical experiments demonstrate the value of these approaches and in some data instances also suggest either the use of Branch&Price techniques or other solution methods like the Exhaustion Method, which is very efficient and produces near optimal solutions for minimizing the number of patterns. The presented polylithic solution methods yield practically superior solutions compared to the standard GGA, with practically feasible computational times.

As each paper producing company has its own production processes specific cutting machines, the mapping of reality and abstraction into a mathematical model and algorithm has, to our experience, the highest priority to receive the appreciation of our clients. Besides this, future research and efficient mathematical techniques on the integration of CSPs into the production planning process and the incorporation of uncertainty would be very welcome.

The GGA/CGA produces solutions which are minimal in the number of rolls but are occasionally lead to overproduction exceeding the demand 
                        
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                        
                      by 
                        
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                        
                      pieces. We have developed three heuristics to eliminate overproduction: The first one just modifies patterns, the second one modifies patterns and generates new ones, and the third one is a combination of both.

In Case 1, for a given 
                        
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                        
                     , we can find a pattern p used with multiplicity 
                        
                           
                              
                                 M
                              
                              
                                 p
                              
                           
                        
                      and 
                        
                           
                              
                                 N
                              
                              
                                 ip
                              
                           
                           >
                           0
                        
                      subject to
                        
                           (A.1)
                           
                              ∃
                              κ
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       κ
                                       
                                          
                                             M
                                          
                                          
                                             p
                                          
                                       
                                       
                                       ∧
                                       
                                       κ
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       
                                          
                                             N
                                          
                                          
                                             ip
                                          
                                       
                                       ∈
                                       IN
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           κ
                        
                      is an integer number. In this simple case, we modify pattern p as follows:
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    ip
                                 
                              
                              
                              ≔
                              
                              
                                 
                                    N
                                 
                                 
                                    ip
                                 
                              
                              -
                              κ
                              
                              and
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              
                              ≔
                              
                              
                                 
                                    w
                                 
                                 
                                    p
                                 
                              
                              +
                              κ
                              
                                 
                                    W
                                 
                                 
                                    i
                                 
                              
                              .
                           
                        
                     This implies that the number of pieces i, produced by using pattern p 
                     
                        
                           
                              
                                 M
                              
                              
                                 p
                              
                           
                        
                      times, is reduced by 
                        
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           =
                           κ
                           
                              
                                 M
                              
                              
                                 p
                              
                           
                        
                     .


                     Case 2 is more complicated. Let 
                        
                           
                              
                                 R
                              
                              
                                 ip
                              
                           
                           
                           ≔
                           
                           
                              
                                 N
                              
                              
                                 ip
                              
                           
                           
                              
                                 M
                              
                              
                                 p
                              
                           
                        
                      denote the number of pieces i produced by using pattern p 
                     
                        
                           
                              
                                 M
                              
                              
                                 p
                              
                           
                        
                      times. If we allow a new pattern 
                        
                           
                              
                                 p
                              
                              
                                 ′
                              
                           
                        
                     , in which item i occurs 
                        
                           μ
                        
                      times, to be used 
                        
                           π
                        
                      times, the reduction condition reads now
                        
                           
                              
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             ip
                                          
                                       
                                       -
                                       κ
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             p
                                          
                                       
                                       -
                                       π
                                    
                                 
                              
                              +
                              μ
                              π
                              =
                              
                                 
                                    R
                                 
                                 
                                    ip
                                 
                              
                              -
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                           
                        
                     or
                        
                           (A.2)
                           
                              
                                 
                                    
                                       κ
                                       +
                                       μ
                                       -
                                       
                                          
                                             N
                                          
                                          
                                             ip
                                          
                                       
                                    
                                 
                              
                              π
                              =
                              κ
                              
                                 
                                    M
                                 
                                 
                                    p
                                 
                              
                              -
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              ,
                           
                        
                     where 
                        
                           π
                        
                      reduces the number of rolls cut to pattern p. The term 
                        
                           μ
                           π
                        
                      considers the number of pieces of type i produced by using the new pattern 
                        
                           π
                        
                      times. Depending on the solution of (A.2), 
                        
                           
                              
                                 p
                              
                              
                                 ′
                              
                           
                        
                      does not contain item i at all 
                        
                           
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ′
                                             
                                          
                                          i
                                       
                                    
                                    =
                                    0
                                 
                              
                           
                        
                      or has a reduced number of it 
                        
                           
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ′
                                             
                                          
                                          i
                                       
                                    
                                    <
                                    
                                       
                                          N
                                       
                                       
                                          ip
                                       
                                    
                                 
                              
                           
                        
                      while others items 
                        
                           
                              
                                 i
                              
                              
                                 ′
                              
                           
                        
                      remain unchanged 
                        
                           
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                p
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          N
                                       
                                       
                                          ip
                                       
                                    
                                 
                              
                           
                        
                     . For 
                        
                           π
                           =
                           0
                        
                      we obtain the simple case (A.1) above; it suffices to modify just one pattern.

We solve the diophantine Eq. (A.2) by tests in three nested loops:
                        
                           
                              
                                 
                                    
                                    
                                       
                                          π
                                          =
                                          0
                                          ,
                                          1
                                          ,
                                          …
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          k
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          
                                             
                                                N
                                             
                                             
                                                pi
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          μ
                                          =
                                          0
                                          ,
                                          1
                                          ,
                                          …
                                          .
                                       
                                    
                                 
                              
                           
                        
                     The existing pattern p is modified by
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    ip
                                 
                              
                              →
                              
                                 
                                    N
                                 
                                 
                                    ip
                                 
                              
                              -
                              κ
                              
                              and
                              
                              
                                 
                                    M
                                 
                                 
                                    p
                                 
                              
                              →
                              
                                 
                                    M
                                 
                                 
                                    p
                                 
                              
                              -
                              π
                              .
                           
                        
                     
                  

For 
                        
                           
                              
                                 p
                              
                              
                                 ′
                              
                           
                        
                     , item i and all other items 
                        
                           
                              
                                 i
                              
                              
                                 ′
                              
                           
                           
                           ≠
                           
                           i
                        
                      we apply
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          →
                                          
                                             
                                                N
                                             
                                             
                                                ip
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                
                                                   
                                                      ip
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          →
                                          μ
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                M
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          →
                                          π
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Unfortunately, there are still situations not covered by Case 1 and Case 2. Let us illustrate this for item 
                        
                           i
                           =
                           14
                        
                      (also called A14) by the following example with 
                        
                           
                              
                                 D
                              
                              
                                 14
                              
                           
                           =
                           1
                        
                     :
                        
                           
                              
                                 
                                    
                                    
                                       item
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             ip
                                          
                                       
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             p
                                          
                                       
                                    
                                    
                                 
                                 
                                    
                                       p
                                       11
                                    
                                    
                                       A
                                       14
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                    
                                 
                                 
                                    
                                       p
                                       12
                                    
                                    
                                       A
                                       14
                                    
                                    
                                       1
                                    
                                    
                                       5
                                    
                                    
                                 
                                 
                                    
                                       p
                                       23
                                    
                                    
                                       A
                                       14
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                    
                                 
                              
                           
                        
                     We have 
                        
                           
                              
                                 S
                              
                              
                                 14
                              
                           
                           =
                           7
                        
                      surplus items. The patterns 
                        
                           
                              
                                 p
                              
                              
                                 11
                              
                           
                           ,
                           
                           
                              
                                 p
                              
                              
                                 12
                              
                           
                        
                      and 
                        
                           
                              
                                 p
                              
                              
                                 23
                              
                           
                        
                      contain other items not relevant here. The equality (A.1) 
                     
                        
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           =
                           κ
                           
                              
                                 M
                              
                              
                                 p
                              
                           
                        
                      does not have a solution for 
                        
                           κ
                           ⩽
                           1
                        
                     ;similarly, (A.2) does not have a solution. The best we could do is to eliminate A14 in 
                        
                           
                              
                                 p
                              
                              
                                 23
                              
                           
                        
                      which leaves a surplus of 
                        
                           
                              
                                 S
                              
                              
                                 14
                              
                              
                                 ′
                              
                           
                           =
                           6
                        
                      .

Therefore, we add Case 3. For those widths i with 
                        
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           >
                           0
                        
                      we generate a list 
                        
                           
                              
                                 L
                              
                              
                                 i
                              
                           
                           
                           ≔
                           
                           {
                           
                              
                                 p
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           ,
                           
                           
                              
                                 p
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                           ,
                           
                           
                              
                                 p
                              
                              
                                 3
                              
                              
                                 ′
                              
                           
                           ,
                           …
                           }
                        
                     , which contains those patterns in which item i occurs, i.e., for all elements 
                        
                           
                              
                                 p
                              
                              
                                 m
                              
                              
                                 ′
                              
                           
                           ∈
                           
                              
                                 L
                              
                              
                                 i
                              
                           
                        
                      we have: 
                        
                           
                              
                                 N
                              
                              
                                 
                                    
                                       ip
                                    
                                    
                                       m
                                    
                                 
                              
                           
                           >
                           0
                        
                      with 
                        
                           
                              
                                 p
                              
                              
                                 m
                              
                           
                           =
                           p
                           (
                           
                              
                                 p
                              
                              
                                 m
                              
                              
                                 ′
                              
                           
                           )
                        
                      for all m. Now we check for all m, whether 
                        
                           κ
                           ⩾
                           1
                        
                      exists with 
                        
                           κ
                           
                              
                                 M
                              
                              
                                 p
                              
                           
                           ⩽
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                        
                     . If it exists, item i in pattern 
                        
                           
                              
                                 p
                              
                              
                                 m
                              
                           
                        
                      is eliminated k times and we obtain 
                        
                           
                              
                                 S
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                           
                           ≔
                           
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           -
                           κ
                           
                              
                                 M
                              
                              
                                 p
                              
                           
                        
                     . If 
                        
                           
                              
                                 S
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                           >
                           0
                        
                     , we continue the test for the next m and pattern 
                        
                           
                              
                                 p
                              
                              
                                 m
                              
                           
                        
                      until all patterns in 
                        
                           
                              
                                 L
                              
                              
                                 i
                              
                           
                        
                      have been tested. If after this, we still have 
                        
                           
                              
                                 S
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                           >
                           0
                        
                     , we continue with Case 2.

In this section, we briefly describe how the pricing problems of the cutting stock problem are derived.

Let the master problem (minimization problem) contain all possible patterns 
                        
                           P
                        
                     ; the restricted master problem the patterns 
                        
                           
                              
                                 P
                              
                              
                                 ′
                              
                           
                           ⊆
                           P
                        
                     . An optimal solution of restricted master problem defines also an optimal solution for the master problem, if all the reduced cost
                        
                           (B.1)
                           
                              
                                 
                                    c
                                 
                                 
                                    p
                                 
                              
                              -
                              π
                              
                                 
                                    A
                                 
                                 
                                    p
                                 
                              
                              ⩾
                              0
                              
                              ∀
                              p
                              ∈
                              P
                           
                        
                     with objective function coefficient 
                        
                           
                              
                                 c
                              
                              
                                 p
                              
                           
                        
                      for variable 
                        
                           
                              
                                 μ
                              
                              
                                 p
                              
                           
                        
                     , (vector of) dual variables 
                        
                           π
                        
                      of all functional constraints and 
                        
                           
                              
                                 A
                              
                              
                                 p
                              
                           
                        
                      being the constraint coefficient matrix of variable 
                        
                           
                              
                                 μ
                              
                              
                                 p
                              
                           
                        
                     .

Thus the pricing problem is obtained my minimizing (B.1) over all p. Naturally, the constraints of the pricing problem ensure that the newly computed pattern is feasible, i.e., is part of the set 
                        
                           P
                        
                     .

Let us illustrate this by the objective function term
                        
                           (B.2)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       r
                                       ∈
                                       R
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             r
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             r
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                1
                                             
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             ip
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    p
                                 
                              
                           
                        
                     occurring in (27). From this term and the inequalities (28)
                     
                        
                           (B.3)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             r
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    p
                                 
                              
                              ⩽
                              
                                 
                                    N
                                 
                                 
                                    r
                                 
                              
                              ,
                              
                              ∀
                              r
                              ,
                           
                        
                     and (8)
                     
                        
                           (B.4)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    ip
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    p
                                 
                              
                              ⩾
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              ∀
                              i
                              ,
                           
                        
                     we had derived the pricing problem
                        
                           (B.5)
                           
                              
                                 
                                    z
                                 
                                 
                                    r
                                 
                                 
                                    ∗
                                 
                              
                              
                              ≔
                              
                              
                                 min
                              
                              
                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             r
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                1
                                             
                                          
                                       
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             π
                                          
                                          
                                             r
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                       
                                       
                                          
                                             π
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     We note in (B.5) that the 
                        
                           
                              
                                 ∑
                              
                              
                                 p
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       r
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      has disappeared, and that all occurrences of 
                        
                           
                              
                                 N
                              
                              
                                 ip
                              
                           
                        
                      have been replaced by 
                        
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                        
                     . Instead of 
                        
                           
                              
                                 ∑
                              
                              
                                 r
                                 ∈
                                 R
                              
                           
                        
                      we have to deal with r independent pricing problems to be solved. The coefficients appearing with the Lagrange multipliers 
                        
                           
                              
                                 π
                              
                              
                                 r
                              
                           
                        
                      and 
                        
                           
                              
                                 π
                              
                              
                                 i
                              
                           
                        
                      are those in (28) and (8) appearing with the 
                        
                           
                              
                                 μ
                              
                              
                                 p
                              
                           
                        
                      variables.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.ejor.2014.03.027.


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

