@&#MAIN-TITLE@&#Scheduling policies for multi-period services

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A new multi-period service problem is introduced and scheduling policies studied.


                        
                        
                           
                           Integer programming formulations are proposed and analyzed.


                        
                        
                           
                           A heuristic solution algorithm is presented.


                        
                        
                           
                           Numerical results from extensive computational tests are presented and analyzed.


                        
                        
                           
                           Computational experiments underline the quality and effectiveness of the heuristic.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Combinatorial optimization

Multi-period problems

Service scheduling

Heuristics

@&#ABSTRACT@&#


               
               
                  This paper discusses a multi-period service scheduling problem. In this problem, a set of customers is given who periodically require service over a finite time horizon. To satisfy the service demands, a set of operators is given, each with a fixed capacity in terms of the number of customers an operator can serve per period. The task is to determine for each customer the periods in which he will be visited by an operator such that the periodic service requests of the customers are adhered to and the total number of operators used over the time horizon is minimal. Two alternative policies for scheduling customer visits are considered. In the first one, a customer is visited just on time, i.e., in the period where he or she has a demand for service. The second policy allows service visits ahead of time. The rationale behind this policy is that allowing irregular visits may reduce the overall number of operators needed throughout the time horizon. To solve the problem, integer linear programming formulations are proposed for both policies and numerical experiments are presented that show the reduction in the number of operators used when visits ahead of time are allowed. As only small instances can be solved optimally, a heuristic algorithm is introduced in order to obtain good quality solutions and shorter computing times.
               
            

@&#INTRODUCTION@&#

In this paper we discuss a problem that is derived from an application arising in the context of collection and recycling of waste electrical and electronic equipment (WEEE). According to EU regulations, inhabitants can return their WEEE free of charge at collection stations which are run by the local municipalities. Once a storage container at a station is full, one of the companies selling electrical or electronic products is responsible for picking up the container and recycling its contents, see for example Fernández, Kalcsics, Nickel, and Ríos-Mercado (2010); Queiruga, Walther, González-Benito, and Spengler (2008). As most companies do not want or do not have the capabilities to do this themselves, they commission logistics providers to carry out these tasks. At the stations, different product categories are collected in different types of containers, e.g., household appliances are collected in iron-barred boxes. As 5–10 boxes fit on a truck, the logistics provider can schedule a truck to visit several collection stations on a day. As the filling rate of these boxes differs between stations, one should organize individual schedules that allow for irregular visits to stations and aim at maximizing vehicle utilizations. Thus, the task is to decide for each collection station in which periods a box should be picked such that no box overflows and as few trucks as possible have to be deployed. Focussing on the tactical modeling aspects of reducing the number of used vehicles and, hence, maximizing the utilization of vehicles coincides with the current trend in vehicle routing problems, not only for economic savings but also due the environmental benefits, see Sbihi and Eglese (2007).

The rest of the paper is organized as follows. In the next section we formally describe our problem and its modeling assumptions. In Section 3, we review the relevant literature. In Section 4 we propose mathematical formulations for two different collection policies. The effect of each policy is analyzed in Section 5 where we derive some insights into the modeling aspects of the problem. As we can only solve small instances optimally within a reasonable amount of time, we introduce in Section 6 a heuristic for the problem. In Section 7 we present computational results to underline the efficiency of the heuristic. The paper ends with some conclusions.

The collection problem described above falls within a more general class of multi-period service scheduling problems (MSSP). In the following, we briefly outline the main components of the latter to obtain a generic, application independent description of our problem. We are given a set of customers (e.g., collection stations) who have periodically recurring demand for some type of service (e.g., emptying boxes), a set of operators (e.g., trucks) who can deliver this service, and a planning horizon that is partitioned into a set of time periods of equal length (e.g., days). The index set of customers, operators, and time periods is denoted by I, K, and T, respectively. Each time a customer has demand for service, we call this a service request. Typically, no request spans more than one period and no customer has more than one request per period. The periods in which customers have service requests can either be given a priori or they can be generated dynamically based on satisfied requests, that is, each time a customer receives service in a period this triggers a new request. Such a dynamically generated request can either be open-ended or have a due date until which it has to be satisfied. In the latter case, the request can be satisfied exactly in the period where it is due, but may also be serviced in a period prior to the due date. The operators or servers can provide the service at the customer or the operator location, or remotely. If a customer is serviced by an operator in a given period, we call this a service period for the customer and we say that the operator carries out a service visit. Every operator has a fixed capacity per time period and each service visit consumes a certain amount of the capacity. Moreover, a fixed cost may be charged whenever an operator attends to one or more customers in a period. Additionally, the satisfaction of a request may incur a fixed and/or variable cost, for example depending on the time elapsed since the last service period. The task is then to decide for each customer in which periods to schedule a service visit such that all customers receive their desired service, possibly meeting the due dates , and the operator capacities are adhered to. Concerning the optimization goals, typically a schedule is sought that minimizes the overall costs or the maximal number of operators required in a period or maximizes the regularity of the service schedules.

In our problem, service requests are generated dynamically with due dates. The due date for the next request is hereby derived from the current service period and the expected number of periods 
                        
                           
                              s
                              i
                           
                           ∈
                           N
                        
                      it takes for a box to be filled (which is known for each customer and independent from time). si
                      is also called the service interval of i. For each customer, the first service request is generated immediately before the start of the planning horizon, i.e., in time period 0. A service cluster consists of a set of customers visited by the same operator in the same period. Because different customers may have different service intervals and we do not assume that regular schedules should apply, the number of operators to be used along the time horizon is established on a per period basis. Hence, a specific service cluster may be formed just once throughout the time horizon and service clusters may be different for each period of the time horizon.

The maximal number of customers Q an operator can serve per period is fixed and identical for each operator, i.e., operators have capacity Q and each service visit consumes one unit of capacity. Each service request can be satisfied by any operator and a customer can be visited by a different operator each time. Whenever an operator is used in a period, a fixed cost is incurred which is identical for each operator and period. Moreover, no fixed or variable costs are charged for service visits.

We consider two different scheduling policies. In the first one, we schedule the next service visit as late as possible, i.e., in the period where the current request is due. We call this an on time visit and the corresponding strategy a Periodic Service policy (PS). The rationale behind this policy is that it will result in regular visiting schedules for customers (provided that the maximum duration does not change over time). The goal is then to minimize the total number of operators used over all periods of the time horizon. We call this the Periodic Multi-period Service Scheduling Problem, for short Periodic MSSP or P-MSSP. An ordered set of service periods 
                        
                           
                              C
                              i
                           
                           =
                           
                              {
                              
                                 t
                                 i
                                 1
                              
                              ,
                              …
                              ,
                              
                                 t
                                 i
                                 
                                    
                                       |
                                    
                                    
                                       C
                                       i
                                    
                                    
                                       |
                                    
                                 
                              
                              }
                           
                           ⊆
                           T
                        
                      is called a periodic calendar for customer i if 
                        
                           
                              t
                              i
                              1
                           
                           ≤
                           
                              s
                              i
                           
                        
                      and the number of periods between any two consecutive elements in Ci
                      equals the service interval si
                     . Even if the first service period of a customer uniquely determines all subsequent service periods, this policy still does not necessarily produce identical service clusters because customers may have differing service intervals. In the second policy, we assume that a customer may be visited ahead of time, i.e., before the due date of the service request. We call this an Aperiodic Service policy (AS). In this policy, the number of periods between consecutive service periods 
                        
                           t
                           i
                           k
                        
                      and 
                        
                           t
                           i
                           
                              k
                              +
                              1
                           
                        
                      for customer i may vary from time to time. Even if this might increase the total number of visits and result in irregular visiting schedules, it will often allow planners to determine more efficient and better utilized service schedules. An ordered set of service periods 
                        
                           
                              C
                              i
                           
                           =
                           
                              {
                              
                                 t
                                 i
                                 1
                              
                              ,
                              …
                              ,
                              
                                 t
                                 i
                                 
                                    
                                       |
                                    
                                    
                                       C
                                       i
                                    
                                    
                                       |
                                    
                                 
                              
                              }
                           
                           ⊆
                           T
                        
                      is called an aperiodic calendar for customer i if 
                        
                           
                              t
                              i
                              1
                           
                           ≤
                           
                              s
                              i
                           
                        
                      and the number of periods between any two consecutive elements in Ci
                      does not exceed the service interval si
                     . If 
                        
                           
                              t
                              i
                              
                                 k
                                 +
                                 1
                              
                           
                           −
                           
                              t
                              i
                              k
                           
                        
                      is smaller than si
                      we call 
                        
                           
                              s
                              i
                           
                           −
                           
                              (
                              
                                 t
                                 i
                                 
                                    k
                                    +
                                    1
                                 
                              
                              −
                              
                                 t
                                 i
                                 k
                              
                              )
                           
                        
                      the earliness of the visit. The earliness of an aperiodic calendar Ci
                      is the total earliness of all visits scheduled in the calendar, i.e., 
                        
                           
                              ∑
                              
                                 k
                                 =
                                 1
                              
                              
                                 
                                    |
                                 
                                 
                                    C
                                    i
                                 
                                 
                                    |
                                    −
                                    1
                                 
                              
                           
                           
                              (
                              
                                 s
                                 i
                              
                              −
                              
                                 t
                                 i
                                 
                                    k
                                    +
                                    1
                                 
                              
                              +
                              
                                 t
                                 i
                                 k
                              
                              )
                           
                           =
                           
                              (
                              |
                           
                           
                              C
                              i
                           
                           
                              |
                              −
                              1
                              )
                           
                           
                           
                              s
                              i
                           
                           −
                           
                              t
                              i
                              
                                 
                                    |
                                 
                                 
                                    C
                                    i
                                 
                                 
                                    |
                                 
                              
                           
                           +
                           
                              t
                              i
                              1
                           
                           ,
                        
                      and the earliness of a customer is the earliness of his calendar. The goal is then to minimize a weighted sum of the total number of periods in which each operator is used and the total earliness of all customers. We call this the Aperiodic Multi-period Service Scheduling Problem, for short Aperiodic MSSP or A-MSSP. Note that the earliness of a service visit can be interpreted as a variable cost for satisfying the service request.

In the remainder, we assume T to be finite. Moreover, we assume that all customers have been serviced just before the start of the planning horizon and that these service visits do not influence the periodic calendars. Next, we illustrate the differences between the policies and highlight the utility of the AS policy.

                        Example 1
                        Suppose there are four customers 
                              
                                 I
                                 =
                                 {
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 }
                              
                            to be visited in a time horizon of 
                              
                                 |
                                 T
                                 |
                                 =
                                 12
                              
                            periods. The service intervals of the customers are 
                              
                                 
                                    s
                                    1
                                 
                                 =
                                 2
                                 ,
                              
                           
                           
                              
                                 
                                    s
                                    2
                                 
                                 =
                                 3
                                 ,
                              
                           
                           
                              
                                 
                                    s
                                    3
                                 
                                 =
                                 4
                              
                            and 
                              
                                 
                                    s
                                    4
                                 
                                 =
                                 3
                              
                            periods, respectively. An operator can serve 
                              
                                 Q
                                 =
                                 3
                              
                            customers per period. Fig. 1
                            displays the schedule of an optimal solution if the PS policy is applied. For example, we have 
                              
                                 
                                    C
                                    4
                                 
                                 =
                                 
                                    {
                                    3
                                    ,
                                    6
                                    ,
                                    9
                                    ,
                                    12
                                    }
                                 
                              
                           . We need one operator for each of the periods 2, 3, 4, 6, 8, 9, and 10, and two operators for period 12. Hence, we need in total nine operators over the twelve weeks.

However, under the AS policy we just need eight operators instead of nine, see Fig. 2
                           . We can save an entire operator by moving the service period of customer 1 from period 10 to period 9. Hence, we visit customer 1 one period before its next designated service period.

A main aim of this paper is to compare the two different service policies. We are especially interested in the trade off between efficiency, measured as the total number of operators needed, and regularity, measured as a function of the total number of periods that visits are scheduled ahead of time. To that end we propose mathematical programming formulations to solve the problems optimally and we develop a heuristic solution approach.

@&#LITERATURE REVIEW@&#

In the following we only review literature on problems where scheduling services is the one and only decision. There are many other applications from very diverse fields where service scheduling appears as a component, e.g., in periodic vehicle routing problems (Campbell & Wilson, 2014) or inventory routing problems (Coelho, Cordeau, & Laporte, 2013) when flexible visit frequencies are allowed. However, the additional decisions to be made in these applications typically result in considerably different problems, requiring different modeling approaches, and result in different solutions. For example minimizing the length of vehicle tours does not necessarily minimize the total number of tours, i.e., the number of operators, as can be seen with small examples.

A closely related application deals with inspections of technical equipment, like machines or airplanes, where technicians regularly carry out preventive service and maintenance. There is a fixed cost for carrying out an inspection and a variable operating cost per period that is proportional to the number of periods since the last inspection. The goal is to determine an inspection schedule minimizing the total average costs over an infinite planning horizon (Anily, Glass, & Hassin, 1998; Bar-Noy, Bhatia, Naor, & Schieber, 2002; Grigoriev, van de Klundert, & Spieksma, 2006). In our terminology, customers coincide with machines and operators with technicians where each technician can maintain only one machine per period. Service requests are generated dynamically but usually without due dates. The operating costs per period can be equivalently modeled by means of the variable costs for service requests. Bar-Noy et al. (2002) show that the problem is NP-hard and present several approximation algorithms for the case where a fixed number of machines can be inspected in each period. Anily et al. (1998) and Grigoriev et al. (2006) consider instead the case of just a single operator. The former derive conditions for the existence of optimal solutions and propose an exact, but non-polynomial solution method. They also derive lower bounds and a bounded error heuristic. The latter present different linear and non-linear programming formulations for the problem as well as an exact solution approach using column generation. Similar problems occur in machine replacement (McClurg & Chand, 2002) and sensor scheduling (Yavuz & Jeffcoat, 2007). Instead of minimizing costs, some authors try to derive regular schedules by minimizing the variability between consecutive service periods for customers. Corominas, Kubiak, and Pastor (2010) present a linear programming formulation and introduce several improvements for it. In subsequent papers, García-Villoria et al. (2013) and Corominas, Kubiak, and Pastor (2012) present a specially tailored branch-and-bound algorithm and various heuristics, respectively. The same objective is employed in Herrmann (2011) in the context of periodically collecting waste from rooms in a health care facility. Apart from these “physical” applications, there are also scheduling problems referring to maintenance and backups of computer systems.

Another related problem occurs in broadcasting environments where transmissions of information pages have to be periodically scheduled in channels. For each page a maximum time between two consecutive transmissions is given and each channel may broadcast only one page per time unit. The goal is to schedule the transmissions of all pages on a minimum number of channels (Bar-Noy & Ladner, 2003; Bar-Noy, Ladner, & Tamir, 2007; Bar-Noy, Ladner, Tamir, & Van De Grift, 2012). This problem is called windows scheduling. Operators coincide with channels, pages with customers, and page transmissions with service requests. The latter are generated dynamically with due dates. Capacities and consumption rates are identical to one. There are no costs involved and the objective is to minimize the maximum number of operators used in a period. Bar-Noy and Ladner (2003) present an algorithm to construct asymptotically close to optimal schedules where each page has a unit transmission time. Bar-Noy et al. (2012) introduce a constant approximation scheme for the case of integer length transmission times of pages. They also present a greedy method based on classical bin packing algorithms. Finally, Bar-Noy et al. (2007) establishes a relation between window scheduling and bin packing. Similar problems occur in media-on-demand systems.

Also related are replenishment problems in vendor managed inventory systems under the assumption of direct deliveries. Each retailer faces a constant demand and no shortages are allowed. Inventory is replenished from a central distribution center and a vehicle can just visit one retailer per period. In our context, customers correspond to retailers, operators to vehicles, and service requests to stock replenishment. The latter are generated dynamically with due dates. Capacities and consumption rates are identical to one. Campbell and Hardin (2005) assume that all visits have to be on time and try to minimize the maximal number of vehicles needed over all periods. They derive several complexity results and propose a greedy heuristic. They also look at the cases where just one vehicle is available and where the capacity consumption is strictly smaller than one, i.e., more than one retailer can be replenished by a vehicle per period. The same restrictions and goals are used in Xu, Yu, Liu, and Tang (2011), except that service visits can also be ahead of time. They derive an approximation algorithm to solve the problem. Instead of minimizing the fleet size, Bertazzi (2008); Gallego and Simchi-Levi (1990) consider the total inventory holding, transportation, and fixed ordering costs. They compare delivery tours versus direct deliveries and the effect of different replenishment policies under direct deliveries, respectively.

Other related problems occur in task scheduling and periodic assignment problems. Han, Lin, and Hou (1996) consider the problem of scheduling tasks on a single machine or processor where distance constraints specify the maximal time between to consecutive executions of a task, i.e., service request are generated dynamically with a maximum duration. They derive feasibility aspects and schedulability conditions. Korst, Aarts, Lenstra, and Wessels (1994) discuss the problem of assigning periodic operations to processors. A processor can just work on one job per period. Service requests are again generated dynamically with a maximum duration, but no ahead of time processing is allowed. The goal is to minimize the maximum number of processors needed. There are also applications where customers do not receive their service on-the-spot but have to travel to the operators; mainly in the public sector. For example public libraries or banks mounted on a truck traveling from community to community, which are still common in rural areas, or medical teams that organize and carry out blood donation sessions. These trucks or teams periodically visit communities and a reasonable goal is to minimize the total number of in the field periods of trucks or teams (cf. Jeffries & O’Hanley, 2012). In its most general form, this problem can also be viewed as a multi-period bin packing problem in which items (customers) must be assigned to bins (operators) where each bin refers to a certain time period. The goal is then to minimize the number of bins.

While all of the above mentioned problems share common components with our multi-period service scheduling problem, neither of them matches exactly. They either differ in the objective function, in the way service requests have to be satisfied, or in the definition of operator capacities/consumption rates.

In this section we present mixed integer linear programming formulations for the two service policies. In the MSSP the following decisions must be made:

                        
                           •
                           Determine a (periodic/aperiodic) calendar for each customer, i.e., the set of periods when he will be served.

Assign each service period of a customer to an operator taking into account the operator capacities.

To that end, we define the following sets of decision variables for i ∈ I, k ∈ K, and t ∈ T:

                        
                           
                              
                                 
                                    
                                       
                                          z
                                          
                                             k
                                          
                                          t
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      if
                                                      
                                                      operator
                                                      
                                                      k
                                                      
                                                      is
                                                      
                                                      used
                                                      
                                                      in
                                                      
                                                      period
                                                      
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          x
                                          
                                             i
                                          
                                          t
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      if
                                                      
                                                      customer
                                                      
                                                      i
                                                      
                                                      is
                                                      
                                                      served
                                                      
                                                      in
                                                      
                                                      period
                                                      
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          y
                                          
                                             i
                                             k
                                          
                                          t
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      if
                                                      
                                                      customer
                                                      
                                                      i
                                                      
                                                      is
                                                      
                                                      served
                                                      
                                                      by
                                                      
                                                      operator
                                                      
                                                      k
                                                      
                                                      in
                                                      
                                                      period
                                                      
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Before we present the formulations for the periodic and aperiodic MSSP, recall our assumption that all customers have been serviced just before the start of the planning horizon and that these service visits do not influence the periodic calendars.

The P-MSSP can be formulated as:

                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             (
                                             P
                                             S
                                             )
                                             
                                             min
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                z
                                                k
                                                t
                                             
                                          
                                       
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                             s
                                             .
                                             t
                                             .
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   s
                                                   i
                                                
                                             
                                             
                                                x
                                                i
                                                t
                                             
                                             =
                                             1
                                             
                                             
                                             
                                             i
                                             ∈
                                             I
                                          
                                       
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                x
                                                i
                                                t
                                             
                                             =
                                             
                                                x
                                                i
                                                
                                                   t
                                                   +
                                                   
                                                      s
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                       
                                          
                                             
                                             
                                             i
                                             ∈
                                             I
                                             ,
                                             t
                                             ∈
                                             {
                                             1
                                             ,
                                             …
                                             ,
                                             |
                                             T
                                             |
                                             −
                                             
                                                s
                                                i
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                x
                                                i
                                                t
                                             
                                             =
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   k
                                                
                                                t
                                             
                                             
                                             
                                             
                                             
                                             
                                             i
                                             ∈
                                             I
                                             ,
                                             t
                                             ∈
                                             T
                                          
                                       
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   k
                                                
                                                t
                                             
                                             ≤
                                             Q
                                             
                                                z
                                                k
                                                t
                                             
                                             
                                             
                                             
                                             k
                                             ∈
                                             K
                                             ,
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             Q
                                             
                                                z
                                                k
                                                t
                                             
                                             ≤
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   ,
                                                   k
                                                   −
                                                   1
                                                
                                                t
                                             
                                             
                                             
                                             
                                             k
                                             ∈
                                             K
                                             ∖
                                             
                                                {
                                                1
                                                }
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                x
                                                i
                                                t
                                             
                                             ,
                                             
                                                z
                                                k
                                                t
                                             
                                             ,
                                             
                                                y
                                                
                                                   i
                                                   k
                                                
                                                t
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             
                                             i
                                             ∈
                                             I
                                             ,
                                             k
                                             ∈
                                             K
                                             ,
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Objective (1) minimizes the total number of operators used in each period of the time horizon. The first service period for each customer is established by Constraints (2), whereas consecutive service periods throughout the time horizon are determined by Constraints (3). Constraints (4) guarantee that if a customer is served in period t, then he is assigned to some operator in that period. Constraints (5) are capacity constraints that ensure that the number of customers assigned to each operator must not exceed her capacity. Constraints (6) are symmetry breaking constraints imposing that in each period operator k is not used unless operators 
                           
                              1
                              ,
                              …
                              ,
                              k
                              −
                              1
                           
                         are full, i.e., each of them has Q assigned customers. Note that although these constraints restrict the feasible domain, they have no effect on the optimal solution because we minimize the total number of operators. Finally, Constraints (7) enforce variables to be binary.

In the AS policy, the first service period of a customer is not enough to determine his subsequent service periods over the time horizon. In particular, if customer i is visited in period 
                           
                              t
                              ≤
                              
                                 |
                                 T
                                 |
                              
                              −
                              
                                 s
                                 i
                              
                              ,
                           
                         we know that he must be visited again no more than si
                         periods later, but we do not know the specific period when he will be serviced again within the time interval 
                           
                              [
                              t
                              +
                              1
                              ,
                              t
                              +
                              
                                 s
                                 i
                              
                              ]
                           
                        . We introduce variables that identify the number of periods between two consecutive service visits for a given customer. In particular, for i ∈ I, 
                           
                              t
                              ∈
                              {
                              0
                              ,
                              …
                              ,
                              |
                              T
                              |
                              −
                              
                                 s
                                 i
                              
                              }
                              ,
                           
                        
                        
                           
                              h
                              ∈
                              {
                              1
                              ,
                              ⋯
                              ,
                              
                                 s
                                 i
                              
                              }
                           
                         we define

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                                
                                                   i
                                                
                                                th
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            t
                                                            
                                                            and
                                                            
                                                            t
                                                            +
                                                            h
                                                            
                                                            are
                                                            
                                                            consecutive
                                                            
                                                            service
                                                            
                                                            periods
                                                            
                                                            for
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            customer
                                                            
                                                            i
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         otherwise
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Due to the fixed time horizon, we assume that service visits scheduled after period 
                           
                              
                                 |
                                 T
                                 |
                              
                              −
                              
                                 s
                                 i
                              
                           
                         will not generate new requests.

To reduce the negative effect that ahead of time visits may cause, we minimize not only the total number of operators used but also the total earliness of all customers using a convex combination with parameter β ∈ [0, 1]. A first formulation that we propose for the A-MSSP is the following:

                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             (
                                             A
                                             
                                                S
                                                0
                                             
                                             )
                                             
                                             min
                                             
                                             
                                          
                                       
                                       
                                          
                                             β
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                z
                                                k
                                                t
                                             
                                             +
                                             
                                                (
                                                1
                                                −
                                                β
                                                )
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      |
                                                      T
                                                      |
                                                   
                                                   −
                                                   
                                                      s
                                                      i
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   h
                                                   =
                                                   1
                                                
                                                
                                                   s
                                                   i
                                                
                                             
                                          
                                       
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   s
                                                   i
                                                
                                                −
                                                h
                                                )
                                             
                                             
                                                f
                                                
                                                   i
                                                
                                                th
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             s
                                             .
                                             t
                                             .
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   h
                                                   =
                                                   1
                                                
                                                
                                                   s
                                                   i
                                                
                                             
                                             
                                                f
                                                
                                                   i
                                                
                                                
                                                   0
                                                   h
                                                
                                             
                                             ≥
                                             1
                                             
                                             
                                          
                                       
                                       
                                       
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                x
                                                i
                                                t
                                             
                                             ≤
                                             
                                                ∑
                                                
                                                   h
                                                   =
                                                   1
                                                
                                                
                                                   s
                                                   i
                                                
                                             
                                             
                                                x
                                                i
                                                
                                                   t
                                                   +
                                                   h
                                                
                                             
                                             
                                          
                                       
                                       
                                       
                                          
                                             i
                                             ∈
                                             I
                                             ,
                                             t
                                             ∈
                                             {
                                             0
                                             ,
                                             …
                                             ,
                                             |
                                             T
                                             |
                                             −
                                             
                                                s
                                                i
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                x
                                                i
                                                t
                                             
                                             =
                                             
                                                ∑
                                                
                                                   h
                                                   =
                                                   1
                                                
                                                
                                                   s
                                                   i
                                                
                                             
                                             
                                                f
                                                
                                                   i
                                                
                                                th
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                       
                                          
                                             i
                                             ∈
                                             I
                                             ,
                                             t
                                             ∈
                                             {
                                             0
                                             ,
                                             …
                                             ,
                                             |
                                             T
                                             |
                                             −
                                             
                                                s
                                                i
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                             
                                                x
                                                i
                                                t
                                             
                                             +
                                             
                                                x
                                                i
                                                
                                                   t
                                                   +
                                                   h
                                                
                                             
                                             ≤
                                             
                                                ∑
                                                
                                                   s
                                                   =
                                                   1
                                                
                                                
                                                   h
                                                   −
                                                   1
                                                
                                             
                                             
                                                x
                                                i
                                                
                                                   t
                                                   +
                                                   s
                                                
                                             
                                             +
                                             
                                                f
                                                i
                                                th
                                             
                                             +
                                             1
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             i
                                             ∈
                                             I
                                             ,
                                             t
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                …
                                                ,
                                                |
                                                T
                                                |
                                             
                                             −
                                             
                                                s
                                                i
                                             
                                             
                                                }
                                                ,
                                                h
                                                ∈
                                             
                                             
                                                {
                                                1
                                                ,
                                                …
                                                ,
                                                
                                                   s
                                                   i
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                z
                                                k
                                                t
                                             
                                             ≤
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   k
                                                
                                                t
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                x
                                                i
                                                t
                                             
                                             =
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   k
                                                
                                                t
                                             
                                             
                                             
                                          
                                       
                                       
                                       
                                          
                                             i
                                             ∈
                                             I
                                             ,
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   k
                                                
                                                t
                                             
                                             ≤
                                             Q
                                             
                                                z
                                                k
                                                t
                                             
                                             
                                          
                                       
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             Q
                                             
                                                z
                                                k
                                                t
                                             
                                             ≤
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   ,
                                                   k
                                                   −
                                                   1
                                                
                                                t
                                             
                                             
                                          
                                       
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ∖
                                             {
                                             1
                                             }
                                             ,
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                z
                                                k
                                                t
                                             
                                             ,
                                             
                                                y
                                                
                                                   i
                                                   k
                                                
                                                t
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                       
                                          
                                             i
                                             ∈
                                             I
                                             ,
                                             k
                                             ∈
                                             K
                                             ,
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                x
                                                i
                                                t
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                       
                                          
                                             i
                                             ∈
                                             I
                                             ,
                                             t
                                             ∈
                                             {
                                             0
                                             ,
                                             …
                                             ,
                                             |
                                             T
                                             |
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                f
                                                
                                                   i
                                                
                                                th
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                       
                                          
                                             i
                                             ∈
                                             I
                                             ,
                                             t
                                             ∈
                                             {
                                             1
                                             ,
                                             …
                                             ,
                                             |
                                             T
                                             |
                                             −
                                             
                                                s
                                                i
                                             
                                             }
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                       
                                          
                                             h
                                             ∈
                                             {
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                s
                                                i
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Objective (8) minimizes a weighted sum of the total number of operators used over the time horizon and the total earliness. By assigning different values to β ∈ [0, 1], both criteria can be considered within different scenarios. Constraints (9) guarantee that the first service period for each customer occurs within his service interval. Constraints (10) are scheduling constraints, which ensure that the number of periods between two consecutive service periods for the same customer never exceeds his service interval. Constraints (11) and (12) relate the x and f variables, where the latter force the variable 
                           
                              f
                              i
                              th
                           
                         to one, if customer i has been visited at periods t and 
                           
                              t
                              +
                              h
                           
                         and there is no other service period for i between t and 
                           
                              t
                              +
                              h
                           
                        . Because we have a minimization problem, the variable 
                           
                              f
                              i
                              th
                           
                         will be zero whenever possible. Hence, we do not have to enforce this. Note that by combining (9) and (11) we always have 
                           
                              
                                 x
                                 i
                                 0
                              
                              =
                              1
                           
                        . In contrast to the P-MSSP, we have to explicitly model the initial service request generated in period 0. Constraints (13) relate the z and y variables, ensuring that customers will only be assigned to active operators. Constraints (14)–(16) have the same meaning as Constraints (4)–(6) in formulation PS. Finally, Constraints (17)–(19) enforce variables to be binary.

In this section we formalize several statements which are quite intuitive but not always straightforward to prove. In particular, we observe that the following constraints are also valid for AS
                        0:

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                f
                                                i
                                                
                                                   t
                                                   −
                                                   h
                                                   ,
                                                   h
                                                
                                             
                                             
                                             ≤
                                             
                                             
                                                x
                                                i
                                                t
                                             
                                             
                                             i
                                             ∈
                                             I
                                             ,
                                             
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             h
                                             =
                                             
                                                max
                                                {
                                                1
                                                ,
                                                t
                                                −
                                                (
                                                |
                                                T
                                                |
                                                −
                                             
                                             
                                                s
                                                i
                                             
                                             
                                                )
                                                }
                                             
                                             ,
                                             …
                                             ,
                                             min
                                             
                                                {
                                                
                                                   s
                                                   i
                                                
                                                ,
                                                t
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        That is, if we schedule the next service period after period 
                           
                              t
                              −
                              h
                           
                         to be in period 
                           
                              t
                              −
                              h
                              +
                              h
                              =
                              t
                              ,
                           
                         then the corresponding 
                           
                              x
                              −
                           
                        variable has to be one. The domain of h ensures that 
                           
                              0
                              ≤
                              t
                              −
                              h
                              ≤
                              
                                 |
                                 T
                                 |
                              
                              −
                              
                                 s
                                 i
                              
                           
                         and thus that the corresponding 
                           
                              f
                              −
                           
                        variable is defined. A tighter form of these constraints is

                           
                              (20)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   h
                                                   =
                                                   
                                                      max
                                                      {
                                                      1
                                                      ,
                                                      t
                                                      −
                                                      (
                                                      |
                                                      T
                                                      |
                                                      −
                                                   
                                                   
                                                      s
                                                      i
                                                   
                                                   
                                                      )
                                                      }
                                                   
                                                
                                                
                                                   min
                                                   {
                                                   
                                                      s
                                                      i
                                                   
                                                   ,
                                                   t
                                                   }
                                                
                                             
                                             
                                                f
                                                i
                                                
                                                   t
                                                   −
                                                   h
                                                   ,
                                                   h
                                                
                                             
                                             =
                                             
                                                x
                                                i
                                                t
                                             
                                             
                                          
                                       
                                       
                                       
                                          
                                             i
                                             ∈
                                             I
                                             ,
                                             
                                             t
                                             ∈
                                             T
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We denote by Ω
                        0 the domain defined by constraints (9)–(19) and by Ω
                        1 the domain defined by (9), (11)–(20). Let also 
                           
                              
                                 Ω
                                 ¯
                              
                              0
                           
                         and 
                           
                              
                                 Ω
                                 ¯
                              
                              1
                           
                         denote the respective domains when the binary conditions on the variables are replaced by non-negativity constraints. That is:

                           
                              
                                 
                                    
                                       
                                          
                                             Ω
                                             0
                                          
                                       
                                       
                                          
                                             =
                                             {
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             f
                                             )
                                             :
                                             
                                             satisfying
                                             
                                             (
                                             9
                                             )
                                             −
                                             (
                                             19
                                             )
                                             }
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             Ω
                                             1
                                          
                                       
                                       
                                          
                                             =
                                             {
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             f
                                             )
                                             :
                                             
                                             satisfying
                                             
                                             (
                                             9
                                             )
                                             ,
                                             (
                                             11
                                             )
                                             −
                                             (
                                             20
                                             )
                                             }
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                Ω
                                                ¯
                                             
                                             0
                                          
                                       
                                       
                                          
                                             =
                                             {
                                             0
                                             ≤
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             f
                                             )
                                             ≤
                                             1
                                             :
                                             
                                             satisfying
                                             
                                             (
                                             9
                                             )
                                             −
                                             (
                                             16
                                             )
                                             }
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                Ω
                                                ¯
                                             
                                             1
                                          
                                       
                                       
                                          
                                             =
                                             {
                                             0
                                             ≤
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             ,
                                             f
                                             )
                                             ≤
                                             1
                                             :
                                             
                                             satisfying
                                             
                                             (
                                             9
                                             )
                                             ,
                                             (
                                             11
                                             )
                                             −
                                             (
                                             16
                                             )
                                             ,
                                             (
                                             20
                                             )
                                             }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           0
                         and 
                           1
                         are vectors of appropriate dimensions with 0’s and 1’s, respectively. Next we see that both Ω
                        0 and Ω
                        1 give equivalent formulations for the A-MSSP. In particular, the following statements hold (the proofs can be found in Appendix A):

                           Proposition 1
                           
                              
                                 
                                    
                                       Ω
                                       0
                                    
                                    =
                                    
                                       Ω
                                       1
                                    
                                 
                              
                              .
                           


                              
                                 
                                    
                                       
                                          Ω
                                          ¯
                                       
                                       1
                                    
                                    ⊆
                                    
                                       
                                          Ω
                                          ¯
                                       
                                       0
                                    
                                 
                              
                              .
                           

The reverse of Proposition 2 is not true. Table 1
                               gives an example to illustrate that 
                                 
                                    
                                       
                                          Ω
                                          ¯
                                       
                                       0
                                    
                                    ⊈
                                    
                                       
                                          Ω
                                          ¯
                                       
                                       1
                                    
                                 
                              . In particular, Table 1 displays the values of the x and f variables for the solution of the LP-relaxation of AS
                              0 for the instance with 
                                 
                                    |
                                    I
                                    |
                                    =
                                    1
                                    ,
                                 
                              
                              
                                 
                                    |
                                    T
                                    |
                                    =
                                    13
                                    ,
                                 
                              
                              
                                 
                                    |
                                    K
                                    |
                                    =
                                    1
                                    ,
                                 
                              
                              
                                 
                                    |
                                    Q
                                    |
                                    =
                                    3
                                    ,
                                 
                              
                              
                                 
                                    
                                       s
                                       1
                                    
                                    =
                                    3
                                 
                               and 
                                 
                                    β
                                    =
                                    0.3
                                 
                              . We observe that 
                                 
                                    
                                       f
                                       1
                                       
                                          0
                                          ,
                                          3
                                       
                                    
                                    >
                                    
                                       x
                                       1
                                       3
                                    
                                 
                              . In fact, 
                                 
                                    
                                       f
                                       i
                                       th
                                    
                                    >
                                    
                                       x
                                       i
                                       
                                          t
                                          +
                                          h
                                       
                                    
                                 
                               for 
                                 
                                    i
                                    =
                                    1
                                    ,
                                 
                              
                              
                                 
                                    t
                                    =
                                    {
                                    3
                                    ,
                                    6
                                    ,
                                    7
                                    ,
                                    8
                                    ,
                                    9
                                    ,
                                    10
                                    }
                                 
                               and 
                                 
                                    h
                                    =
                                    3
                                 
                              . Therefore, (20) is not satisfied. This implies that a solution in 
                                 
                                    
                                       Ω
                                       ¯
                                    
                                    0
                                 
                               is not necessarily contained in 
                                 
                                    
                                       Ω
                                       ¯
                                    
                                    1
                                 
                              .

From now on, we will use the following formulation for the A-MSSP:

                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             A
                                             S
                                             )
                                             
                                             min
                                             
                                             
                                          
                                       
                                       
                                          
                                             β
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                z
                                                k
                                                t
                                             
                                             +
                                             
                                                (
                                                1
                                                −
                                                β
                                                )
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      |
                                                      T
                                                      |
                                                   
                                                   −
                                                   
                                                      s
                                                      i
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   h
                                                   =
                                                   1
                                                
                                                
                                                   s
                                                   i
                                                
                                             
                                             
                                                (
                                                
                                                   s
                                                   i
                                                
                                                −
                                                h
                                                )
                                             
                                             
                                                f
                                                
                                                   i
                                                
                                                th
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                (
                                                x
                                                ,
                                                y
                                                ,
                                                z
                                                ,
                                                f
                                                )
                                             
                                             ∈
                                             
                                                Ω
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

As a consequence of Proposition 2 and Remark 1 we have:

                           Corollary 1
                           
                              The LP-relaxation of AS is tighter than the LP-relaxation of AS
                              0
                              .
                           

Computational tests show that the LP-relaxation of AS provides lower bounds that are on average 72 percent tighter than those of formulation AS
                        0. Similarly, the CPU times using AS are 94 percent shorter than those for AS
                        0.

In this section we focus on the effect of the PS and AS policies and on the performance of the formulations presented in Section 4. All experiments have been run on an Intel Core i7-2600 3.4 GHz with 8 GB Ram and operating system Windows 7, 64 bit. Both formulations were coded in C++ and solved with IBM ILOG CPLEX 12.5 with a CPU time limit of one hour.

Since we are not aware of any benchmark instances for the MSSP, we randomly generated 90 problem instances with the following characteristics. For the number of customers we chose |I| ∈ {10, 30, 50}. The respective instances are denoted as “I10”, “I30”, and “I50”. The number of periods is related to a time horizon of one month, i.e., 
                           
                              |
                              T
                              |
                              =
                              30
                           
                        . For the possible service intervals si
                         of the customers, we considered two different settings. The first one relates the service intervals to the number of visits per month: si
                         ∈ {4, 7, 15} (eight times, four times, and twice per month, respectively). The second one considers the intervals 
                           
                              
                                 s
                                 i
                              
                              ∈
                              
                                 {
                                 4
                                 ,
                                 5
                                 ,
                                 …
                                 ,
                                 15
                                 }
                              
                           
                        . We abbreviate the two settings by D and U, respectively. In view of the “physical” services mentioned in the beginning, the capacity Q of the operators is 5 or 10. Moreover, to reflect the “virtual” services, we also consider the uncapacitated version of the problem, i.e., 
                           
                              Q
                              =
                              |
                              I
                              |
                           
                        . Finally, the number of operators |K| is chosen such that all problems are feasible.

For each combination of values for |I| and Q and for the two different settings for the service intervals, we generated five different problem instances by randomly determining service intervals for the customers according to a discrete uniform distribution over the respective set of service intervals. The resulting instances are denoted as “{D,U}_I<|I|>_Q<Q>_C<#instance>”. For example, the first instance with 10 customers, an operator capacity of 5, and service intervals taken from {4, 7, 15} is denoted “D_I10_Q5_C1”.

For the aperiodic policy, we consider four different values for β ∈ {0.2, 0.5, 0.8, 1.0}. The extreme value of 
                           
                              β
                              =
                              1.0
                           
                         was considered to analyze the effect of minimizing the total number of operators used over all periods without penalizing earliness. This yields a total of 450 instances, 90 for the PS policy and 360 for the AS policy.

For each |I| and Q, Table 2
                         shows the aggregated results obtained by CPLEX for the formulations PS and AS for the D- and U-instances. For AS, the results are presented for every value of β. The detailed results can be found in Tables B.1 and B.2 in Appendix B. Each table displays the total number of operators used and the total earliness over the five instances of the best solutions found (z and e, respectively). Columns labeled Gap show the average relative deviations in percent of the best-known solutions with respect to lower bounds at termination. The average CPU times in seconds and the number of optimally solved instances are given in columns Time and Opt, respectively. CPLEX was able to find at least one feasible solution for all instances within the time limit of one hour.

For formulation PS, optimal solutions were obtained for 85 percent and 93 percent of the D-instances and U-instances, respectively. For formulation AS, the number of optimal solutions found depends on the selection of the parameter β. For 
                           
                              β
                              =
                              0.2
                              ,
                           
                         optimality of the best solution found could be proven for 78 percent and 93 percent of the instances. As the value of β increases, the harder it becomes to obtain proven optimal solutions, especially for the D-instances. The lowest percentage of optimally solved instances occurs for 
                           
                              β
                              =
                              0.8
                              ,
                           
                         for which optimality was proven for only 60 percent and 65 percent of the D-instances and U-instances, respectively. Observe, however, that the percentage of optimally solved instances for 
                           
                              β
                              =
                              1.0
                           
                         is higher than for 
                           
                              β
                              =
                              0.8
                           
                        . In fact, the percentage of optimally solved instances for 
                           
                              β
                              =
                              1.0
                           
                         is the highest for all values of β and even higher than for formulation PS.

The computing times reinforce this situation. For formulation PS, the average values for the CPU time are 821.7 and 381.9 seconds for the D- and U-instances, respectively. For formulation AS, this average value also depends on the selection of the parameter β. For 
                           
                              β
                              =
                              0.2
                              ,
                           
                         the average values for the computing time are 1110.1 and 557.1 seconds. As the value of β increases, the higher the CPU time. The highest average values of CPU time correspond to 
                           
                              β
                              =
                              0.8
                           
                         with 1521.5 and 1699.0 seconds. Observe, however, that the average computing time for 
                           
                              β
                              =
                              1.0
                           
                         is substantially lower than for 
                           
                              β
                              =
                              0.8
                           
                        . The fact that 
                           
                              β
                              =
                              1.0
                           
                         does neither yield the lowest percentage of optimally solved instances nor the highest average of CPU time might be due to the fact that we do not penalize earliness in the objective function for 
                           
                              β
                              =
                              1.0
                           
                         in contrast to 
                           
                              β
                              =
                              0.8
                           
                        .

As the earliness has no impact on the objective function for 
                           
                              β
                              =
                              1.0
                              ,
                           
                         the total earliness of the solutions is uncharacteristically high. To obtain a better picture on the amount of earliness and to make the numbers comparable to the cases β < 1.0, we have run a second round of experiments, called phase II, with the following characteristics. We solved each instance again but set 
                           
                              β
                              =
                              0
                           
                         and added the constraint 
                           
                              
                                 ∑
                                 
                                    t
                                    ∈
                                    T
                                 
                              
                              
                                 ∑
                                 
                                    k
                                    ∈
                                    K
                                 
                              
                              
                                 z
                                 k
                                 t
                              
                              =
                              
                                 z
                                 
                                    β
                                    =
                                    1
                                 
                              
                           
                         which fixes the total number of operators to be used to the number of operators, 
                           
                              
                                 z
                                 
                                    β
                                    =
                                    1
                                 
                              
                              ,
                           
                         previously obtained for 
                           
                              β
                              =
                              1.0
                           
                        . The results are shown in Table 3
                        
                        
                        . Although the amount of earliness increases very much from 
                           
                              β
                              =
                              0.8
                           
                         to 
                           
                              β
                              =
                              1.0
                              ,
                           
                         the total number of required operators often decreases considerably. Concerning the CPU times for phase II, we observe a similar pattern as for β < 1.0.

The optimality gap also underlines the difficulty of the problem. For formulation PS, the average values of the gap are 0.8 percent and 0.2 percent for the D- and U-instances, respectively. For formulation AS, they again depend on the selection of the parameter β and exhibit the same behavior as for the percentage of optimally solved instances and the computing times. In general, the average gaps increase as the value of β increases, with the exception of 
                           
                              β
                              =
                              1.0
                           
                         which has the lowest average gaps.

The hardness of the problem also depends on the size of the instances and the value of the Q. Instances of “I10” are optimally solved for formulations PS and AS for every value of β and Q. For instances of “I30”, optimality becomes more difficult to achieve for larger values of β and smaller values of Q. For the “I50” instances, optimality is almost unreachable already for values of Q < |I|. In general, the smaller the value of Q and the larger value of β, the more difficult to solve the problem.

In general, D-instances are more difficult to solve than U-instances. This suggests that the difficulty of the instances increases as the variety of service intervals (si
                        ) decreases.

As observed before, for formulation AS, parameter β has a crucial impact on the solutions obtained. To better perceive the effect of this parameter, Fig. 3 displays the frequency chart that shows for which value of β we first obtain a solution for an instance that uses earliness. The frequencies are split into two subsets, proven optimal solutions and solutions with a positive Gap. We observe that for 
                              
                                 β
                                 =
                                 0.2
                              
                            earliness is not applied at all in any of the best solutions found. Ahead of time visits first appear in solutions for 
                              
                                 β
                                 =
                                 0.5
                              
                           . Therefore, the computational experience suggests that earliness is only worth if the cost per operator is at least the same as the penalty for ahead of time visits. The average value for this “earliness breakpoint” is 
                              
                                 
                                    
                                       β
                                       ¯
                                    
                                    
                                       b
                                       p
                                    
                                 
                                 =
                                 0.88
                              
                            for all best solutions found, and 
                              
                                 
                                    
                                       β
                                       ¯
                                    
                                    
                                       b
                                       p
                                    
                                 
                                 =
                                 0.93
                              
                            and 
                              
                                 
                                    
                                       β
                                       ¯
                                    
                                    
                                       b
                                       p
                                    
                                 
                                 =
                                 0.84
                              
                            for optimal solutions, for the D- and U-instances, respectively.


                           Fig. 4 shows the number of operators used over all periods for the sets of instances in which all best-found solutions were optimal. For formulation AS, the values are displayed for each value of β. This figure shows a clear decrease in the total number of operators used over all periods as the parameter β increases. Fig. 5
                            highlights the trade off between a reduction in the total number of operators and an increase in the total number of service visits. Finally, Fig. 6
                            displays the average values of Time for the best solutions found with formulations PS and AS. For formulation AS, the average computing times are depicted for every value of β. The figure supports the hardness of the problem, especially for higher values of β (except for 
                              
                                 β
                                 =
                                 1.0
                              
                           ).

Under the evidence of the reduction in the number of operators used over all periods by applying the aperiodic service policy and the difficulty regarding the value of Q, the challenge is to find an efficient way to solve the P-MSSP and the A-MSSP for all possible values of β and Q.

As we have seen in the previous section, a general purpose solver is only able to solve small and medium instances for formulation PS and small instances for formulation AS optimally within a reasonable amount of time. Therefore, we next present a heuristic solution algorithm for the P-MSSP and the A-MSSP. The heuristic first constructs an initial solution using a greedy procedure. Afterwards, a local search procedure is applied to improve the quality of the greedy solution. To diversify the search, this procedure is also applied to a series of perturbed solutions obtained from the initial greedy solution. All phases are described below.

In the greedy procedure we successively build a solution by selecting in each iteration first a calender-less customer and then finding the best calendar for him. Customers are selected by non-decreasing values of their service intervals si
                        . The best calendar Ci
                         for a selected customer i ∈ I is then a calendar with the minimal increase in the total number of operators used over all periods. In each iteration we have a partial solution in which the calendars of a set of customers have already been determined. For t ∈ T, we denote by Qt
                         the number of customers that receive service in period t. Operator 
                           
                              k
                              =
                              
                                 k
                                 t
                                 
                                    m
                                    a
                                    x
                                 
                              
                           
                         is referred to as the last operator in period t and the number of customers assigned to her in period t ∈ T is denoted by 
                           
                              Q
                              
                                 k
                                 t
                                 
                                    m
                                    a
                                    x
                                 
                              
                           
                        . 
                           
                              
                                 Q
                                 
                                    k
                                    t
                                    
                                       m
                                       a
                                       x
                                    
                                 
                              
                              =
                              Q
                           
                         indicates that an additional operator is needed if one more customer should receive service in this period t. Periods where the last operator is completely full are called saturated, and the set of such periods is denoted by 
                           
                              S
                              =
                              {
                              t
                              ∈
                              T
                              :
                              
                                 Q
                                 
                                    k
                                    t
                                    
                                       m
                                       a
                                       x
                                    
                                 
                              
                              =
                              Q
                              }
                           
                        . A saturated period t ∈ S with 
                           
                              
                                 k
                                 t
                                 
                                    m
                                    a
                                    x
                                 
                              
                              =
                              
                                 |
                                 K
                                 |
                              
                           
                         is called exhausted, because it is not possible to allocate any more customers to it. The set of exhausted periods is denoted by 
                           
                              E
                              =
                              {
                              t
                              ∈
                              S
                              :
                              
                                 k
                                 t
                                 
                                    m
                                    a
                                    x
                                 
                              
                              =
                              |
                              K
                              |
                              }
                           
                        .

Initially, no customer has a calendar and no operator is used. Thus, we set 
                           
                              
                                 Q
                                 t
                              
                              =
                              
                                 k
                                 t
                                 
                                    m
                                    a
                                    x
                                 
                              
                              =
                              
                                 Q
                                 
                                    k
                                    t
                                    
                                       m
                                       a
                                       x
                                    
                                 
                              
                              =
                              0
                              ,
                           
                         for all t ∈ T, and 
                           
                              S
                              =
                              E
                              =
                              ∅
                           
                        . In iteration p, we first select a calender-less customer ip
                         and then determine the best calendar 
                           
                              
                                 C
                                 
                                    i
                                    p
                                 
                              
                              ⊆
                              T
                           
                         for him (in the next section, we show how to do that efficiently). Before the next iteration, the values Qt
                        , 
                           
                              
                                 k
                                 t
                                 
                                    m
                                    a
                                    x
                                 
                              
                              ,
                           
                        
                        
                           
                              
                                 Q
                                 
                                    k
                                    t
                                    
                                       m
                                       a
                                       x
                                    
                                 
                              
                              ,
                           
                         and the sets S and E are updated for all t ∈ T. The heuristic terminates when calendars have been determined for all customers. Algorithm 1
                         gives an outline of the greedy procedure. Without loss of generality, we assume that the index set of customers is sorted by non increasing values of their service intervals, i.e., 
                           
                              I
                              =
                              {
                              
                                 i
                                 1
                              
                              ,
                              …
                              ,
                              
                                 i
                                 
                                    |
                                    I
                                    |
                                 
                              
                              }
                           
                         with 
                           
                              
                                 s
                                 
                                    i
                                    1
                                 
                              
                              ≤
                              
                                 s
                                 
                                    i
                                    2
                                 
                              
                              ≤
                              ⋯
                              ≤
                              
                                 s
                                 
                                    i
                                    
                                       |
                                       I
                                       |
                                    
                                 
                              
                           
                        .

Next, we show how to efficiently determine the best calendar for a customer by formulating it as a shortest path problem in an auxiliary network. Hereby, we have to distinguish between the periodic and aperiodic policy.

Next, we formulate the search for the best calendar for a selected customer 
                              
                                 i
                                 =
                                 
                                    i
                                    p
                                 
                              
                            in iteration p as a shortest path problem. To that end we define an auxiliary network 
                              
                                 N
                                 =
                                 (
                                 V
                                 ,
                                 A
                                 )
                              
                            as follows. Let 
                              
                                 V
                                 =
                                 
                                    {
                                    
                                       v
                                       t
                                    
                                    :
                                    t
                                    ∈
                                    T
                                    ∖
                                    E
                                    }
                                 
                                 ∪
                                 
                                    {
                                    
                                       v
                                       0
                                    
                                    ,
                                    
                                       v
                                       
                                          |
                                          T
                                          |
                                          +
                                          1
                                       
                                    
                                    }
                                 
                              
                           . V contains a node associated with each non-exhausted period t, plus two pseudo nodes, v
                           0 and 
                              
                                 v
                                 
                                    |
                                    T
                                    |
                                    +
                                    1
                                 
                              
                           . Moreover, A contains three types of arcs: (a) (v
                           0, vt
                           ), with 
                              
                                 t
                                 ∈
                                 
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       s
                                       i
                                    
                                    }
                                 
                                 ∖
                                 E
                              
                           ; (b) 
                              
                                 (
                                 
                                    v
                                    t
                                 
                                 ,
                                 
                                    v
                                    
                                       t
                                       ′
                                    
                                 
                                 )
                              
                            with 
                              
                                 
                                    t
                                    ′
                                 
                                 =
                                 t
                                 +
                                 
                                    s
                                    i
                                 
                                 ,
                              
                            
                           t′, t ∈ T∖E; and, (c) 
                              
                                 (
                                 
                                    v
                                    t
                                 
                                 ,
                                 
                                    v
                                    
                                       |
                                       T
                                       |
                                       +
                                       1
                                    
                                 
                                 )
                              
                            with t ∈ T∖E, 
                              
                                 
                                    t
                                    >
                                    |
                                    T
                                    |
                                 
                                 −
                                 
                                    s
                                    i
                                 
                              
                           . Fig. 7 depicts the network. A node vt
                            ∈ V with t ∈ S is called saturated. Then, we define the following costs associated with the arcs
                            of A for types (a) and (b):

                              
                                 
                                    
                                       c
                                       
                                          (
                                          
                                             v
                                             t
                                          
                                          ,
                                          
                                             v
                                             
                                                t
                                                ′
                                             
                                          
                                          )
                                       
                                       
                                       =
                                       
                                       
                                          {
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      if
                                                      
                                                      node
                                                      
                                                      
                                                         v
                                                         
                                                            t
                                                            ′
                                                         
                                                      
                                                      
                                                      is
                                                      
                                                      saturated
                                                      ;
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Q
                                                         
                                                            k
                                                            t
                                                            
                                                               m
                                                               a
                                                               x
                                                            
                                                         
                                                      
                                                      
                                                         |
                                                         T
                                                         |
                                                         
                                                         Q
                                                      
                                                   
                                                
                                                
                                                   
                                                      otherwise
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           The rationale behind the costs for arcs entering unsaturated vertices is that we want to favor calendars where operators are well utilized. The costs are chosen such that they are dominated by the cost of adding a new operator, i.e., the overall utilization of operators is less important than the number of additional operators. For arcs of type (c), 
                              
                                 c
                                 (
                                 
                                    v
                                    t
                                 
                                 ,
                                 
                                    v
                                    
                                       |
                                       T
                                       |
                                       +
                                       1
                                    
                                 
                                 )
                                 =
                                 0
                              
                           . Any path from v
                           0 to 
                              
                                 v
                                 
                                    |
                                    T
                                    |
                                    +
                                    1
                                 
                              
                            in the above network corresponds to a feasible calendar for customer i: 
                              
                                 
                                    C
                                    i
                                 
                                 =
                                 
                                    {
                                    t
                                    ∈
                                    T
                                    ∖
                                    E
                                    :
                                    
                                       v
                                       t
                                    
                                    
                                    is
                                    
                                    in
                                    
                                    the
                                    
                                    path
                                    
                                    from
                                    
                                    
                                       v
                                       0
                                    
                                    
                                    to
                                    
                                    
                                       v
                                       
                                          |
                                          T
                                          |
                                          +
                                          1
                                       
                                    
                                    }
                                 
                              
                           . And a shortest path yields a best calendar for customer i, i.e., one with the smallest increase in the objective function value.

The set of nodes of the auxiliary network for the aperiodic service policy is identical to the one for the periodic policy. Concerning the arcs, A now contains three types of arcs: (a) (v
                           0, vt
                           ), with 
                              
                                 t
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    s
                                    i
                                 
                                 }
                                 ∖
                                 E
                              
                           ; (b) 
                              
                                 (
                                 
                                    v
                                    t
                                 
                                 ,
                                 
                                    v
                                    
                                       t
                                       ′
                                    
                                 
                                 )
                              
                            with t, t′ ∈ T∖E where 
                              
                                 
                                    t
                                    ′
                                 
                                 =
                                 t
                                 +
                                 h
                                 ,
                              
                           
                           
                              
                                 h
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    s
                                    i
                                 
                                 }
                              
                           ; and, (c) 
                              
                                 (
                                 
                                    v
                                    t
                                 
                                 ,
                                 
                                    v
                                    
                                       |
                                       T
                                       |
                                       +
                                       1
                                    
                                 
                                 )
                              
                            with t ∈ T∖E, 
                              
                                 
                                    t
                                    >
                                    |
                                    T
                                    |
                                 
                                 −
                                 
                                    s
                                    i
                                 
                              
                           . Fig. 8 visualizes the network. For the costs associated with the arcs of A, we now also need to calculate the total earliness of a calendar for customer i. Thus, we define the following costs associated with the arcs of A for type (a):

                              
                                 
                                    
                                       c
                                       
                                          (
                                          
                                             v
                                             0
                                          
                                          ,
                                          
                                             v
                                             t
                                          
                                          )
                                       
                                       
                                       =
                                       
                                       
                                          {
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   
                                                      if
                                                      
                                                      node
                                                      
                                                      
                                                         v
                                                         t
                                                      
                                                      
                                                      is
                                                      
                                                      saturated
                                                      ;
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      β
                                                      
                                                         
                                                            Q
                                                            
                                                               k
                                                               t
                                                               
                                                                  m
                                                                  a
                                                                  x
                                                               
                                                            
                                                         
                                                         
                                                            |
                                                            T
                                                            |
                                                            
                                                            Q
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      otherwise
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           The rationale behind the costs for arcs entering unsaturated vertices is the same as for the periodic policy; we just have to ensure that these costs are now also dominated by the costs of earliness. For arcs of type (b), the cost of an arc 
                              
                                 (
                                 
                                    v
                                    t
                                 
                                 ,
                                 
                                    v
                                    
                                       t
                                       ′
                                    
                                 
                                 )
                              
                            must now take into account not only if the destination node t′ is saturated, but also the earliness between periods t and t′, which is 
                              
                                 
                                    s
                                    i
                                 
                                 −
                                 
                                    (
                                    
                                       t
                                       ′
                                    
                                    −
                                    t
                                    )
                                 
                              
                           . Thus,

                              
                                 
                                    
                                       c
                                       
                                          (
                                          
                                             v
                                             t
                                          
                                          ,
                                          
                                             v
                                             
                                                t
                                                ′
                                             
                                          
                                          )
                                       
                                       
                                       =
                                       
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         1
                                                         −
                                                         β
                                                         )
                                                      
                                                      
                                                         [
                                                         
                                                            s
                                                            i
                                                         
                                                         −
                                                         
                                                            t
                                                            ′
                                                         
                                                         +
                                                         t
                                                         ]
                                                      
                                                      +
                                                      β
                                                   
                                                
                                                
                                                   
                                                      if
                                                      
                                                      node
                                                      
                                                      
                                                         v
                                                         
                                                            t
                                                            ′
                                                         
                                                      
                                                      
                                                      is
                                                      
                                                      saturated
                                                      ;
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         1
                                                         −
                                                         β
                                                         )
                                                      
                                                      
                                                         [
                                                         
                                                            s
                                                            i
                                                         
                                                         −
                                                         
                                                            t
                                                            ′
                                                         
                                                         +
                                                         t
                                                         ]
                                                      
                                                      +
                                                      β
                                                      
                                                         
                                                            Q
                                                            
                                                               k
                                                               t
                                                               
                                                                  m
                                                                  a
                                                                  x
                                                               
                                                            
                                                         
                                                         
                                                            |
                                                            T
                                                            |
                                                            
                                                            Q
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      otherwise
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

For arcs of type (c), 
                              
                                 c
                                 (
                                 
                                    v
                                    t
                                 
                                 ,
                                 
                                    v
                                    
                                       |
                                       T
                                       |
                                       +
                                       1
                                    
                                 
                                 )
                                 =
                                 0
                              
                           . Again, any path from v
                           0 to 
                              
                                 v
                                 
                                    |
                                    T
                                    |
                                    +
                                    1
                                 
                              
                            in the above network yields a calendar for customer i: 
                              
                                 
                                    C
                                    i
                                 
                                 =
                                 
                                    {
                                    t
                                    ∈
                                    T
                                    :
                                    
                                       v
                                       t
                                    
                                    
                                    is
                                    
                                    in
                                    
                                    the
                                    
                                    path
                                    
                                    from
                                    
                                    
                                       v
                                       0
                                    
                                    
                                    to
                                    
                                    
                                       v
                                       
                                          |
                                          T
                                          |
                                          +
                                          1
                                       
                                    
                                    }
                                 
                              
                           . The cost of a path reflects the increment in the objective function value of the current partial solution when incorporating calendar Ci
                           , ignoring the utilization term 
                              
                                 β
                                 
                                    
                                       Q
                                       
                                          k
                                          t
                                          
                                             m
                                             a
                                             x
                                          
                                       
                                    
                                    
                                       |
                                       T
                                       |
                                       
                                       Q
                                    
                                 
                              
                           . Indeed this increment takes into account not only the number of additional operators used over all periods but also the earliness of the new partial solution. A shortest path again yields a calendar Ci
                            for customer i with the smallest increase in costs.

In the local search procedure we try to improve the solution obtained by the greedy procedure. To that end, two different neighborhoods are explored. The first one considers changing the calendar of a single customer. The second one contemplates simultaneous changes in the calendars of a pair of customers. For both policies, the goal is to change the calendars of customers in such a way that we either decrease the number of operators used over all periods (and/or the earliness for the AS policy) or, if this is not possible, decrease the utilization of the least utilized operator in a period. The motivation for the latter is that it might be possible to get rid of this operator in subsequent iterations of the local search.

The single-customer neighborhood, or simply N
                           1, explores solutions in which the calendars of all customers remain unchanged, except for a fixed customer i ∈ I. For this customer we want to find out if the solution would improve by using a different calendar. To that end, we first delete his calender Ci
                            and then compute the sets S and E, and the values Qt
                           , 
                              
                                 
                                    k
                                    t
                                    
                                       m
                                       a
                                       x
                                    
                                 
                                 ,
                              
                            and 
                              
                                 Q
                                 
                                    k
                                    t
                                    
                                       m
                                       a
                                       x
                                    
                                 
                              
                            for all t ∈ T. Afterwards, we determine the best calendar for i using the same approach as in Section 6.1.

Since considering the change of the calendar of a single customer may be short-sighted, we also take into account the simultaneous change of the calendar of pairs of customers. The two-customers neighborhood, or simply N
                           2, explores solutions in which all calendars remain unchanged, except for a pair of customers i, j ∈ I. In this case we want to find out if the solution would improve if the calendars of customers i and j were different.

For the PS policy, this requires to identify the first service periods of customers i and j, and then to change all their subsequent service periods accordingly. Similarly to N
                           1, we can formulate the simultaneous search for the best calendars for i and j as a shortest path problem. To that end, we define the auxiliary directed network 
                              
                                 N
                                 =
                                 (
                                 V
                                 ×
                                 V
                                 ,
                                 A
                                 )
                                 ,
                              
                            where 
                              
                                 V
                                 =
                                 
                                    {
                                    
                                       v
                                       t
                                    
                                    :
                                    t
                                    ∈
                                    T
                                    ∖
                                    E
                                    }
                                 
                                 ∪
                                 
                                    {
                                    
                                       v
                                       0
                                    
                                    ,
                                    
                                       v
                                       
                                          |
                                          T
                                          |
                                          +
                                          1
                                       
                                    
                                    }
                                 
                              
                            is defined as in Section 6.1.1. Nodes (vt, vr
                           ) ∈ V × V are of three types: (V
                           1) t and r are equal to 0; (V
                           2) t, r ∈ T∖E; (V
                           3) at least one of t and r is equal to 
                              
                                 |
                                 T
                                 |
                                 +
                                 1
                              
                            and 
                              
                                 
                                    t
                                    >
                                    |
                                    T
                                    |
                                 
                                 −
                                 
                                    s
                                    i
                                 
                              
                            or 
                              
                                 
                                    r
                                    >
                                    |
                                    T
                                    |
                                 
                                 −
                                 
                                    s
                                    j
                                 
                              
                           . Moreover, arcs 
                              
                                 {
                                 
                                    (
                                    
                                       v
                                       t
                                    
                                    ,
                                    
                                       v
                                       r
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       v
                                       
                                          t
                                          ′
                                       
                                    
                                    ,
                                    
                                       v
                                       
                                          r
                                          ′
                                       
                                    
                                    )
                                 
                                 }
                                 ∈
                                 A
                              
                            are of three types: (A
                           1) (vt, vr
                           ) is a node of type (V
                           1) and 
                              
                                 (
                                 
                                    v
                                    
                                       t
                                       ′
                                    
                                 
                                 ,
                                 
                                    v
                                    
                                       r
                                       ′
                                    
                                 
                                 )
                              
                            is a node of type (V
                           2), with 
                              
                                 
                                    t
                                    ′
                                 
                                 ∈
                                 
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       s
                                       i
                                    
                                    }
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    r
                                    ′
                                 
                                 ∈
                                 
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       s
                                       j
                                    
                                    }
                                 
                              
                           ; (A
                           2) both nodes are of type (V
                           2) with 
                              
                                 
                                    t
                                    ′
                                 
                                 =
                                 t
                                 +
                                 
                                    s
                                    i
                                 
                              
                            and 
                              
                                 
                                    r
                                    ′
                                 
                                 =
                                 r
                                 +
                                 
                                    s
                                    j
                                 
                              
                           ; and (A
                           3) (vt, vr
                           ) is a node of type (V
                           2) and 
                              
                                 (
                                 
                                    v
                                    
                                       t
                                       ′
                                    
                                 
                                 ,
                                 
                                    v
                                    
                                       r
                                       ′
                                    
                                 
                                 )
                              
                            is a node of type (V
                           3). The costs of the arcs are then defined accordingly and a shortest path through this network from node (v
                           0, v
                           0) to 
                              
                                 (
                                 
                                    v
                                    
                                       |
                                       T
                                       |
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    v
                                    
                                       |
                                       T
                                       |
                                       +
                                       1
                                    
                                 
                                 )
                              
                            yields the best calenders for customers i and j.
                        

Unfortunately, the move for the AS policy is much more involved because earliness is allowed. As a result, we can no longer re-formulate the simultaneous search for the best calendars of i and j as a shortest path problem. Thus, we consider the two-customers neighborhood only for the PC policy.

The neighborhoods described above are used within several strategies which differ from each other on how the customers are selected. The strategies that explore neighborhood N
                           1 are the following:

                              
                                 
                                    SA
                                    :
                                 explores N
                                    1 for every customer i ∈ I. The sequence in which a customer is selected is random.

first detects the operator with the minimum number of assigned customers. Then, N
                                    1 is explored for every customer served by this operator. If there exists more than one customer, they are selected by increasing index.

The strategy that explores neighborhood N
                           2 is the following:

                              
                                 
                                    SC
                                    :
                                 explores neighborhood N
                                    2 for every pair of customers i, j ∈ I. The sequence in which the customers are selected is random.

The local search procedure uses two distinct combinations of strategies:

                              
                                 
                                    SAC
                                    :
                                 strategies SA
                                     and SC
                                     are sequentially applied.

strategies SA
                                     and SB
                                     are sequentially applied.

To diversify the search, we apply the local search not only to the solution produced by the greedy procedure but as well to a set of perturbed solutions. We obtain the latter with a destroy & repair procedure applied to the initial greedy solution, which modifies the calendar of a randomly selected subset of customers, S ⊆ I, with |S| ∼ U(2, |I|). First, we remove the calendar of every customer in S. Then, we repair the resulting partial solution. For this we obtain for each customer i ∈ S a feasible calendar by solving the auxiliary shortest path problem described in Section 6.1. The order in which customers in S are selected for repairing their calendars is random.

We stop the local search procedure for every perturbed solution when no improvement has been found after exploring a complete sequence of the search strategy.


                           Algorithm 2
                            gives the general outline of the heuristic previously described. The input MaxDiv is the number of diversification iterations, whereas F( · ) denotes the value of the objective function for a given solution. Initially, the greedy algorithm is applied and then local search followed by the destroy & repair procedure are applied for MaxDiv iterations.

To asses the effectiveness of the heuristic algorithm described above, we ran a second series of computational experiments, using the same benchmark instances as in Section 5. We tried all search strategies described in Section 6.2.2 and chose the best one for the PS and, respectively, the AS policy. The algorithm was coded in C++. Recall that we randomly generated five problem instances for each combination of values for |I| and Q.

For each |I| and Q, Table 4 shows the summary of the results of the best strategy for the PS and AS policy for the D- and U-instances. The detailed results can be found in Tables C.1 and C.2 in Appendix C. Columns z and e display the total number of operators used and the total earliness, respectively, over the five instances. Columns HGap denote the relative difference between the best solution found by CPLEX and the value of the best solution found by the heuristic, averaged over the five instances. Negative values indicate that the heuristic yields better solutions than the time constrained CPLEX. We use columns Time to display the average computing time (in seconds) needed by the heuristic.

For the PS policy, the best results are obtained after applying the local search procedure using the search strategy SAC
                      described in Section 6.2.2 over 100 perturbed solutions. The heuristic obtains optimal solutions for all instances in which CPLEX does. For instances not optimally solved by CPLEX, the heuristic produces the same (or a better) upper bound with considerable less time (see Table 2 for comparison). On average, the heuristic solutions are 0.06 percent better than those of CPLEX.

For the AS policy, best results have been obtained using the search strategy SAB
                      (see Section 6.2.2) over 100 perturbed solutions. Table 4 displays the results for each value of β and for each series of instances. On average, the heuristic solutions are 0.14 percent and 0.34 percent worse than those of CPLEX, with a maximum relative deviation of 5.00 percent and 5.36 percent for the D- and U-instances, respectively.

As for the different values of β, for 
                        
                           β
                           =
                           1.0
                        
                      the heuristic finds the same solutions as CPLEX, 92.5 percent and 100 percent of which were proven to be optimal, for the D- and U-instances, respectively. The same results are obtained for the U-instances and 
                        
                           β
                           =
                           0.5
                           ,
                        
                      in which 95 percent of the instances were proven to be optimal. For the D-instances with β ∈ {0.2, 0.5} and the U-instances with 
                        
                           β
                           =
                           0.2
                           ,
                        
                      the heuristic algorithm outperforms CPLEX on average because we have negative HGaps. The worst outcome of the heuristic is observed for 
                        
                           β
                           =
                           0.8
                           ,
                        
                      with average HGaps of 0.74 and 1.41 for the D- and U-instances, respectively. Observe however that for instances “I30”, the heuristic finds the same solutions as CPLEX for all instances that were solved optimally. Moreover, for instances “I50”, the heuristic outperforms CPLEX for 13.33 percent and 26.67 percent of the cases for the U- and D-instances, respectively.

Regarding CPU times, it can be observed that the heuristic CPU times are shorter than those of CPLEX. Excluding the instances with trivial capacities, i.e., 
                        
                           Q
                           =
                           |
                           I
                           |
                           ,
                        
                      the average computing times for the heuristic are significantly smaller than those of CPLEX. For the rest of the instances, the differences in CPU times are not significant.

Finally, for each I and Q, Table 5 summarizes for the PS and AS policy the contribution of each ingredient of the heuristic to its overall performance over each group of D- and U-instances. The detailed results can be found in Tables C.3 and C.4 in Appendix C. Columns HGG, HGLS
                     , and HGP
                      denote the averages over the five instances in each group of the relative difference between the best solution found by CPLEX and the value of the best solution found by the greedy procedure, the local search applied to the solution of the greedy procedure, and at the end of the heuristic when the local search has been applied over the 100 perturbed solutions. As can be seen the local search produces a considerable improvement over the greedy solution, particularly for 
                        
                           β
                           =
                           0.8
                        
                      when the greedy solution is usually not very good. However, the repetition over the perturbed solutions is significant for closing the gaps.

@&#CONCLUSIONS@&#

We have presented a novel problem for multi-period service scheduling. The objective is to reduce the total number of operators while ensuring that two consecutive visits to a customer do not exceed its service interval. Two different service policies have been addressed. While the PS policy imposes a visiting activity with a fixed time interval, the AS policy allows visits before the end of the service interval. Two mathematical formulation have been presented, one for each service policy. The one for AS policy introduces a second term in the objective function to penalize ahead of time visits. This allows to model several scenarios, depending on the penalty weight. Computational results indicate that allowing for ahead of time visits reduces the number of operators for an appropriate trade-off of the objective function terms. Moreover, we have developed a heuristic algorithm that obtains good solutions within a noticeable short time.

@&#ACKNOWLEDGMENTS@&#

This research has been partially supported by the Spanish Ministry of Economy and Competitiveness through grant MTM2012-36-163-C06-05 and EDRF funds, and by grant NI 521/6-1 of the German Research Foundation (DFG). The research of the first author has been partially through of the Mexican National Council for Science and Technology (CONACyT) through grant 310857. This support is gratefully acknowledged.


                     
                        Proposition 1
                        
                           
                              
                                 
                                    Ω
                                    0
                                 
                                 =
                                 
                                    Ω
                                    1
                                 
                              
                           
                           .
                        


                           
                              
                                 (a)
                                 
                                    Ω
                                    1 ⊆ Ω
                                    0. Let us suppose there exists (x, y, z, f) ∈ Ω
                                    1 such that (x, y, z, f) ∉ Ω
                                    0. Then, there exist indices i ∈ I and 
                                       
                                          t
                                          ∈
                                          {
                                          0
                                          ,
                                          …
                                          ,
                                          |
                                          T
                                          |
                                          −
                                          
                                             s
                                             i
                                          
                                          }
                                       
                                     with 
                                       
                                          
                                             x
                                             i
                                             t
                                          
                                          >
                                          
                                             ∑
                                             
                                                h
                                                =
                                                1
                                             
                                             
                                                s
                                                i
                                             
                                          
                                          
                                             x
                                             i
                                             
                                                t
                                                +
                                                h
                                             
                                          
                                       
                                    . By definition, 
                                       
                                          
                                             x
                                             i
                                             t
                                          
                                          =
                                          1
                                       
                                     and 
                                       
                                          
                                             x
                                             i
                                             
                                                t
                                                +
                                                h
                                             
                                          
                                          =
                                          0
                                       
                                     for all 
                                       
                                          h
                                          ∈
                                          {
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             s
                                             i
                                          
                                          }
                                       
                                    . By (11), 
                                       
                                          
                                             ∑
                                             
                                                h
                                                =
                                                1
                                             
                                             
                                                s
                                                i
                                             
                                          
                                          
                                             f
                                             i
                                             th
                                          
                                          =
                                          1
                                          ,
                                       
                                     so 
                                       
                                          
                                             f
                                             i
                                             
                                                th
                                                ′
                                             
                                          
                                          =
                                          1
                                       
                                     for some 
                                       
                                          
                                             h
                                             ′
                                          
                                          ∈
                                          
                                             {
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                s
                                                i
                                             
                                             }
                                          
                                       
                                    . But then,

                                       
                                          
                                             
                                                0
                                                
                                                =
                                                
                                                
                                                   x
                                                   i
                                                   
                                                      t
                                                      +
                                                      
                                                         h
                                                         ′
                                                      
                                                   
                                                
                                                
                                                =
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         h
                                                         =
                                                         max
                                                         {
                                                         1
                                                         ,
                                                         t
                                                         +
                                                      
                                                      
                                                         h
                                                         ′
                                                      
                                                      −
                                                      
                                                         (
                                                         |
                                                         T
                                                         |
                                                      
                                                      −
                                                      
                                                         s
                                                         i
                                                      
                                                      
                                                         )
                                                         }
                                                      
                                                   
                                                   
                                                      min
                                                      {
                                                      
                                                         s
                                                         i
                                                      
                                                      ,
                                                      t
                                                      +
                                                      
                                                         h
                                                         ′
                                                      
                                                      }
                                                   
                                                
                                                
                                                   f
                                                   i
                                                   
                                                      t
                                                      +
                                                      
                                                         h
                                                         ′
                                                      
                                                      −
                                                      h
                                                      ,
                                                      h
                                                   
                                                
                                                
                                                ≥
                                                
                                                
                                                   f
                                                   i
                                                   
                                                      th
                                                      ′
                                                   
                                                
                                                
                                                =
                                                
                                                1
                                                
                                                ,
                                             
                                          
                                       
                                    as 
                                       
                                          
                                             h
                                             ′
                                          
                                          ∈
                                          
                                             [
                                             max
                                             {
                                             1
                                             ,
                                             t
                                          
                                          +
                                          
                                             h
                                             ′
                                          
                                          −
                                          
                                             (
                                             |
                                             T
                                             |
                                          
                                          −
                                          
                                             s
                                             i
                                          
                                          
                                             )
                                             }
                                             ,
                                             min
                                          
                                          
                                             {
                                             
                                                s
                                                i
                                             
                                             ,
                                             t
                                             +
                                             
                                                h
                                                ′
                                             
                                             }
                                          
                                          
                                             ]
                                          
                                       
                                    .


                                    Ω
                                    0 ⊆ Ω
                                    1. Let us suppose there exists (x, y, z, f) ∈ Ω
                                    0 such that (x, y, z, f) ∉ Ω
                                    1. Therefore, 
                                       
                                          
                                             ∑
                                             
                                                
                                                   h
                                                   =
                                                   max
                                                   {
                                                   1
                                                   ,
                                                
                                                
                                                   t
                                                   ′
                                                
                                                −
                                                
                                                   (
                                                   |
                                                   T
                                                   |
                                                
                                                −
                                                
                                                   s
                                                   i
                                                
                                                
                                                   )
                                                   }
                                                
                                             
                                             
                                                min
                                                {
                                                
                                                   s
                                                   i
                                                
                                                ,
                                                
                                                   t
                                                   ′
                                                
                                                }
                                             
                                          
                                          
                                             f
                                             i
                                             
                                                
                                                   t
                                                   ′
                                                
                                                −
                                                h
                                                ,
                                                h
                                             
                                          
                                          ≠
                                          
                                             x
                                             i
                                             
                                                t
                                                ′
                                             
                                          
                                       
                                     for some t′ ∈ T.

We first consider the case that 
                              
                                 
                                    ∑
                                    
                                       
                                          h
                                          =
                                          max
                                          {
                                          1
                                          ,
                                       
                                       
                                          t
                                          ′
                                       
                                       −
                                       
                                          (
                                          |
                                          T
                                          |
                                       
                                       −
                                       
                                          s
                                          i
                                       
                                       
                                          )
                                          }
                                       
                                    
                                    
                                       min
                                       {
                                       
                                          s
                                          i
                                       
                                       ,
                                       
                                          t
                                          ′
                                       
                                       }
                                    
                                 
                                 
                                    f
                                    i
                                    
                                       
                                          t
                                          ′
                                       
                                       −
                                       h
                                       ,
                                       h
                                    
                                 
                                 <
                                 
                                    x
                                    i
                                    
                                       t
                                       ′
                                    
                                 
                              
                           . By definition, 
                              
                                 
                                    x
                                    i
                                    
                                       t
                                       ′
                                    
                                 
                                 =
                                 1
                              
                            and 
                              
                                 
                                    f
                                    i
                                    
                                       
                                          t
                                          ′
                                       
                                       −
                                       h
                                       ,
                                       h
                                    
                                 
                                 =
                                 0
                              
                            for 
                              
                                 
                                    h
                                    =
                                    max
                                    {
                                    1
                                    ,
                                 
                                 
                                    t
                                    ′
                                 
                                 −
                                 
                                    (
                                    |
                                    T
                                    |
                                 
                                 −
                                 
                                    s
                                    i
                                 
                                 
                                    )
                                    }
                                 
                                 ,
                                 …
                                 ,
                                 min
                                 
                                    {
                                    
                                       s
                                       i
                                    
                                    ,
                                    
                                       t
                                       ′
                                    
                                    }
                                 
                              
                           . If t′ ≥ 1 is the first service period for customer i, then t′ ≤ si
                           . Setting 
                              
                                 t
                                 =
                                 0
                              
                            and 
                              
                                 h
                                 =
                                 
                                    t
                                    ′
                                 
                              
                            in (12), we get

                              
                                 
                                    
                                       2
                                       
                                       =
                                       
                                       
                                          x
                                          i
                                          0
                                       
                                       +
                                       
                                          x
                                          i
                                          
                                             t
                                             ′
                                          
                                       
                                       
                                       ≤
                                       
                                       
                                          ∑
                                          
                                             s
                                             =
                                             1
                                          
                                          
                                             
                                                t
                                                ′
                                             
                                             −
                                             1
                                          
                                       
                                       
                                          x
                                          i
                                          s
                                       
                                       +
                                       
                                          f
                                          i
                                          
                                             0
                                             ,
                                             
                                                t
                                                ′
                                             
                                          
                                       
                                       +
                                       1
                                       
                                       =
                                       
                                       1
                                       
                                       ,
                                    
                                 
                              
                           as 
                              
                                 
                                    t
                                    ′
                                 
                                 ∈
                                 
                                    {
                                    max
                                    {
                                    1
                                    ,
                                 
                                 
                                    t
                                    ′
                                 
                                 −
                                 
                                    (
                                    |
                                    T
                                    |
                                 
                                 −
                                 
                                    s
                                    i
                                 
                                 
                                    )
                                    }
                                    ,
                                    …
                                    ,
                                    min
                                 
                                 
                                    {
                                    
                                       s
                                       i
                                    
                                    ,
                                    
                                       t
                                       ′
                                    
                                    }
                                 
                                 
                                    }
                                 
                              
                           . If t′ is not the first service period for i, then let h′ ≥ 1 be minimal with 
                              
                                 
                                    x
                                    i
                                    
                                       
                                          t
                                          ′
                                       
                                       −
                                       
                                          h
                                          ′
                                       
                                    
                                 
                                 =
                                 1
                                 ,
                              
                            i.e., 
                              
                                 
                                    t
                                    ′
                                 
                                 −
                                 
                                    h
                                    ′
                                 
                                 ≥
                                 1
                              
                            is the service period immediately preceding t′. By (10), h′ ≤ si
                           . Thus, setting 
                              
                                 t
                                 =
                                 
                                    t
                                    ′
                                 
                                 −
                                 
                                    h
                                    ′
                                 
                              
                            and 
                              
                                 h
                                 =
                                 
                                    h
                                    ′
                                 
                              
                            in (12), we again obtain a contradiction.

Next, we consider the case that 
                              
                                 
                                    ∑
                                    
                                       
                                          h
                                          =
                                          max
                                          {
                                          1
                                          ,
                                       
                                       
                                          t
                                          ′
                                       
                                       −
                                       
                                          (
                                          |
                                          T
                                          |
                                       
                                       −
                                       
                                          s
                                          i
                                       
                                       
                                          )
                                          }
                                       
                                    
                                    
                                       min
                                       {
                                       
                                          s
                                          i
                                       
                                       ,
                                       
                                          t
                                          ′
                                       
                                       }
                                    
                                 
                                 
                                    f
                                    i
                                    
                                       
                                          t
                                          ′
                                       
                                       −
                                       h
                                       ,
                                       h
                                    
                                 
                                 >
                                 
                                    x
                                    i
                                    
                                       t
                                       ′
                                    
                                 
                              
                           . First, we assume that 
                              
                                 
                                    x
                                    i
                                    
                                       t
                                       ′
                                    
                                 
                                 =
                                 0
                              
                           . Then, there exists at least one 
                              
                                 
                                    h
                                    ′
                                 
                                 ∈
                                 
                                    {
                                    max
                                    {
                                    1
                                    ,
                                 
                                 
                                    t
                                    ′
                                 
                                 −
                                 
                                    (
                                    |
                                    T
                                    |
                                 
                                 −
                                 
                                    s
                                    i
                                 
                                 
                                    )
                                    }
                                    ,
                                    …
                                    ,
                                    min
                                 
                                 
                                    {
                                    
                                       s
                                       i
                                    
                                    ,
                                    
                                       t
                                       ′
                                    
                                    }
                                 
                                 
                                    }
                                 
                              
                            with 
                              
                                 
                                    f
                                    i
                                    
                                       
                                          t
                                          ′
                                       
                                       −
                                       
                                          h
                                          ′
                                       
                                       ,
                                       
                                          h
                                          ′
                                       
                                    
                                 
                                 =
                                 1
                              
                           . From (11) we get 
                              
                                 
                                    x
                                    i
                                    
                                       
                                          t
                                          ′
                                       
                                       −
                                       
                                          h
                                          ′
                                       
                                    
                                 
                                 =
                                 1
                              
                            and, subsequently, from (10) that there exists 
                              
                                 h
                                 ˜
                              
                            with 
                              
                                 
                                    x
                                    i
                                    
                                       
                                          t
                                          ′
                                       
                                       −
                                       
                                          h
                                          ′
                                       
                                       +
                                       
                                          h
                                          ˜
                                       
                                    
                                 
                                 =
                                 1
                              
                            (
                              
                                 
                                    t
                                    ′
                                 
                                 −
                                 
                                    h
                                    ′
                                 
                                 ≤
                                 
                                    |
                                    T
                                    |
                                 
                                 −
                                 
                                    s
                                    i
                                 
                              
                            by definition of h′). Without loss of generality, assume that 
                              
                                 1
                                 ≤
                                 
                                    h
                                    ˜
                                 
                                 ≤
                                 
                                    s
                                    i
                                 
                              
                            is minimal with respect to this property. By assumption, 
                              
                                 
                                    h
                                    ′
                                 
                                 ≠
                                 
                                    h
                                    ˜
                                 
                              
                           . Setting 
                              
                                 t
                                 =
                                 
                                    t
                                    ′
                                 
                                 −
                                 
                                    h
                                    ′
                                 
                                 ≥
                                 1
                              
                            and 
                              
                                 h
                                 =
                                 
                                    h
                                    ˜
                                 
                              
                            in (12), we must have 
                              
                                 
                                    f
                                    i
                                    
                                       
                                          t
                                          ′
                                       
                                       −
                                       
                                          h
                                          ′
                                       
                                       ,
                                       
                                          h
                                          ˜
                                       
                                    
                                 
                                 =
                                 1
                              
                           . But this contradicts (11) as 
                              
                                 
                                    h
                                    ′
                                 
                                 ≠
                                 
                                    h
                                    ˜
                                 
                              
                           . Next, we assume that 
                              
                                 
                                    x
                                    i
                                    
                                       t
                                       ′
                                    
                                 
                                 =
                                 1
                              
                           . Then, there exist 
                              
                                 
                                    h
                                    1
                                 
                                 ,
                                 
                                    h
                                    2
                                 
                                 ∈
                                 
                                    {
                                    max
                                    {
                                    1
                                    ,
                                 
                                 
                                    t
                                    ′
                                 
                                 −
                                 
                                    (
                                    |
                                    T
                                    |
                                 
                                 −
                                 
                                    s
                                    i
                                 
                                 
                                    )
                                    }
                                    ,
                                    …
                                    ,
                                    min
                                 
                                 
                                    {
                                    
                                       s
                                       i
                                    
                                    ,
                                    
                                       t
                                       ′
                                    
                                    }
                                 
                                 
                                    }
                                 
                              
                            with h
                           1 ≠ h
                           2 and 
                              
                                 
                                    f
                                    i
                                    
                                       
                                          t
                                          ′
                                       
                                       −
                                       
                                          h
                                          1
                                       
                                       ,
                                       
                                          h
                                          1
                                       
                                    
                                 
                                 =
                                 
                                    f
                                    i
                                    
                                       
                                          t
                                          ′
                                       
                                       −
                                       
                                          h
                                          2
                                       
                                       ,
                                       
                                          h
                                          2
                                       
                                    
                                 
                                 =
                                 1
                              
                           . Without loss of generality, let h
                           1 > h
                           2. If there are more than two such values, we pick two successive ones. From (11) we get 
                              
                                 
                                    x
                                    i
                                    
                                       
                                          t
                                          ′
                                       
                                       −
                                       
                                          h
                                          1
                                       
                                    
                                 
                                 =
                                 
                                    x
                                    i
                                    
                                       
                                          t
                                          ′
                                       
                                       −
                                       
                                          h
                                          2
                                       
                                    
                                 
                                 =
                                 1
                              
                            as 
                              
                                 
                                    t
                                    ′
                                 
                                 −
                                 
                                    h
                                    1
                                 
                                 ,
                                 
                                    t
                                    ′
                                 
                                 −
                                 
                                    h
                                    2
                                 
                                 ≤
                                 
                                    |
                                    T
                                    |
                                 
                                 −
                                 
                                    s
                                    i
                                 
                              
                           . Setting 
                              
                                 t
                                 =
                                 
                                    t
                                    ′
                                 
                                 −
                                 
                                    h
                                    1
                                 
                              
                            and 
                              
                                 h
                                 =
                                 
                                    h
                                    1
                                 
                                 −
                                 
                                    h
                                    2
                                 
                              
                            in (12), we must have 
                              
                                 
                                    f
                                    i
                                    
                                       
                                          t
                                          ′
                                       
                                       −
                                       
                                          h
                                          1
                                       
                                       ,
                                       
                                          h
                                          1
                                       
                                       −
                                       
                                          h
                                          2
                                       
                                    
                                 
                                 =
                                 1
                              
                           . But this contradicts (11) as h
                           2 > 0.□


                           
                              
                                 
                                    
                                       Ω
                                       ¯
                                    
                                    1
                                 
                                 ⊆
                                 
                                    
                                       Ω
                                       ¯
                                    
                                    0
                                 
                              
                           
                           .
                        

Consider 
                              
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    ,
                                    f
                                    )
                                 
                                 ∈
                                 
                                    
                                       Ω
                                       ¯
                                    
                                    1
                                 
                              
                            and let i ∈ I. From (20) follows that 
                              
                                 
                                    f
                                    i
                                    
                                       t
                                       −
                                       h
                                       ,
                                       h
                                    
                                 
                                 ≤
                                 
                                    x
                                    i
                                    t
                                 
                              
                            for all t ∈ T and 
                              
                                 h
                                 ∈
                                 
                                    {
                                    max
                                    {
                                    1
                                    ,
                                    t
                                 
                                 −
                                 
                                    (
                                    |
                                    T
                                    |
                                 
                                 −
                                 
                                    s
                                    i
                                 
                                 
                                    )
                                    }
                                    ,
                                    …
                                    ,
                                    min
                                 
                                 
                                    {
                                    
                                       s
                                       i
                                    
                                    ,
                                    t
                                    }
                                 
                                 
                                    }
                                 
                              
                           . This is equivalent to 
                              
                                 
                                    f
                                    i
                                    th
                                 
                                 ≤
                                 
                                    x
                                    i
                                    
                                       t
                                       +
                                       h
                                    
                                 
                              
                            for all 
                              
                                 t
                                 ∈
                                 {
                                 0
                                 ,
                                 …
                                 ,
                                 |
                                 T
                                 |
                                 −
                                 
                                    s
                                    i
                                 
                                 }
                              
                            and 
                              
                                 h
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    s
                                    i
                                 
                                 }
                              
                           . Thus, for any 
                              
                                 t
                                 ∈
                                 {
                                 0
                                 ,
                                 …
                                 ,
                                 |
                                 T
                                 |
                                 −
                                 
                                    s
                                    i
                                 
                                 }
                                 ,
                              
                            we have 
                              
                                 
                                    ∑
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       s
                                       i
                                    
                                 
                                 
                                    f
                                    i
                                    th
                                 
                                 ≤
                                 
                                    ∑
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       s
                                       i
                                    
                                 
                                 
                                    x
                                    i
                                    
                                       t
                                       +
                                       h
                                    
                                 
                              
                           . In addition, by (11), 
                              
                                 
                                    x
                                    i
                                    t
                                 
                                 =
                                 
                                    ∑
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       s
                                       i
                                    
                                 
                                 
                                    f
                                    
                                       i
                                    
                                    th
                                 
                              
                           . Thus, 
                              
                                 
                                    x
                                    i
                                    t
                                 
                                 ≤
                                 
                                    ∑
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       s
                                       i
                                    
                                 
                                 
                                    x
                                    i
                                    
                                       t
                                       +
                                       h
                                    
                                 
                                 ,
                              
                            which is in fact (10) and therefore 
                              
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    ,
                                    f
                                    )
                                 
                                 ∈
                                 
                                    
                                       Ω
                                       ¯
                                    
                                    0
                                 
                              
                           .□

​
                     
                  

​
                     
                     
                     
                  

@&#REFERENCES@&#

