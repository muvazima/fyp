@&#MAIN-TITLE@&#Statistical image reconstruction for low-dose CT using nonlocal means-based regularization. Part II: An adaptive approach

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Introduce spatial adaptivity in the NLM-based regularization.


                        
                        
                           
                           Demonstrate necessity and efficacy of introducing the spatial adaptivity.


                        
                        
                           
                           Achieve superior reconstruction for low-contrast objects and subtle structures.


                        
                        
                           
                           Systematic validation of the strategy with phantoms and clinical patient data.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

X-ray CT

Low-dose

Adaptive nonlocal means

Statistical image reconstruction

@&#ABSTRACT@&#


               
               
                  To reduce radiation dose in X-ray computed tomography (CT) imaging, one common strategy is to lower the tube current and exposure time settings during projection data acquisition. However, this strategy would inevitably increase the projection data noise, and the resulting image by the conventional filtered back-projection (FBP) method may suffer from excessive noise and streak artifacts. The well-known edge-preserving nonlocal means (NLM) filtering can reduce the noise-induced artifacts in the FBP reconstructed image, but it sometimes cannot completely eliminate the artifacts, especially under the very low-dose circumstance when the image is severely degraded. Instead of taking NLM filtering, we proposed a NLM-regularized statistical image reconstruction scheme, which can effectively suppress the noise-induced artifacts and significantly improve the reconstructed image quality. From our previous investigation on NLM-based strategy, we noted that using a spatially invariant filtering parameter in the regularization was rarely optimal for the entire field of view (FOV). Therefore, in this study we developed a novel strategy for designing spatially variant filtering parameters which are adaptive to the local characteristics of the image to be reconstructed. This adaptive NLM-regularized statistical image reconstruction method was evaluated with low-contrast phantoms and clinical patient data to show (1) the necessity in introducing the spatial adaptivity and (2) the efficacy of the adaptivity in achieving superiority in reconstructing CT images from low-dose acquisitions.
               
            

@&#INTRODUCTION@&#

The usage of X-ray computed tomography (CT) has increased dramatically since its introduction in the 1970s. It was estimated that 76 million CT scans were performed across the hospitals and clinics of the United States in 2013 [1]. The consequential radiation dose is significant and the potential radiation risks are receiving growing concerns [2]. Since the radiation risks typically decrease with the reduced radiation dose, many techniques and strategies have been proposed for dose reduction on the CT examinations [3–5]. One cost-effective and commonly used way is to acquire CT projection data with a lower milliampere-second (mAs) protocol [6]. However, the use of the standard filtered backprojection (FBP) method (equipped on most of commercial CT scanners) to reconstruct the low-dose acquisitions frequently produces inferior results with excessive noise and streak artifacts. Many projection or image domain denoising methods were proposed to improve the quality of the FBP-reconstructed low-dose CT images. The low-pass filters have the drawback that while removing the noise, they may also blur other high-frequency components including edges and fine structures, which could be critical in clinical assessment. Some more sophisticated edge-preserving filters can mitigate this drawback to some extent. For instance, the nonlocal means (NLM) filter was successfully applied to FBP-reconstructed low-dose CT images for noise reduction [7]. Based on the success, several strategies were proposed to achieve further improvement, such as using large-scale neighborhood [8], considering local noise level [9], and exploiting a previous normal-dose CT image [10]. Despite all these efforts, it is still observed that the NLM filtering strategies sometimes cannot completely remove the noise and streak artifacts, especially under the desired circumstance for as low as possible on the radiation dose.

On the other hand, many statistical image reconstruction (SIR) methods [11], which take into account the statistical properties of the low-dose projection data and accommodate the imaging geometry, have been shown to be superior in suppressing the noise and streak artifacts as compared to the NLM filtering strategies. The SIR strategy has recently become an endeavor for almost all major vendors of clinical CT systems [12–14]. The SIR approach is typically formulated by an objective function consisting of a data-fidelity term and a regularization (or equivalently, penalty) term where the penalized weighted least-squares (PWLS) is one of the commonly used objective function [11]. The penalty (or regularization) in the PWLS criterion plays a critical role for successful image reconstruction [15–28]. Among these studies, several explored the NLM-based regularization for PWLS image reconstruction of low-dose CT [24–28]. For instance, Ma et al. [24] proposed a previous normal-dose scan induced NLM regularization to improve the follow-up low-dose CT scans reconstruction. A temporal NLM regularization [25,26] was also investigated for four-dimensional CT and cone-beam CT reconstruction, where the reconstruction of current frame image utilizing two neighboring frame images. However, the previous normal-dose CT image or neighboring frame images may not be readily available for some applications. Therefore, in our previous study [27,28], a NLM-based generic regularization was explored using the currently available low-dose scan, wherein the regularization exploits a one-step-late (OSL) strategy to estimate the associated weighting coefficients. The NLM-regularized statistical image reconstruction scheme demonstrated promising reconstructions from low-dose data of relatively high-contrast phantoms [27,28]. For clinical applications where the CT images contain not only high-contrast objects but also low-contrast objects and subtle structures, the reconstruction scheme could be problematic due to the use of a spatially invariant filtering parameter h in the regularization. A spatially invariant denoising may be too strong for some regions (blurring much) while too weak for other regions (filtering little) across the entire field of view (FOV) [8]. To address this issue, in this study we developed a novel strategy in designing adaptive filtering parameters for the NLM-based regularization by considering local characteristics of the to-be-reconstructed image, and the resulting new name is called adaptive NLM-based regularization.

The remainder of this paper is presented as follows. Section 2 explicitly illustrates the framework of the proposed adaptive NLM-regularized statistical image reconstruction algorithm, and further describes the associated issues about the algorithm implementation and performance evaluation. Section 3 reports the experimental results using both phantom and patient datasets. Finally, discussions on and conclusions from the experimental results are presented in Section 4.

The NLM method was proposed as a non-iterative and edge-preserving filter for image de-noising [29,30]. It reduces image noise by replacing each pixel's intensity with a weighted average of its neighbors according to similarity. Although the similarity comparison could be performed between any two pixels within the entire image, it is typically limited to a fixed neighboring window area (called search-window (SW), e.g., 17×17, in 2D case) of target pixel in practice for computation efficiency. Mathematically, the NLM method can be describes as [29,30]:
                           
                              (1)
                              
                                 
                                    N
                                    L
                                    M
                                    (
                                    
                                       
                                          μ
                                          ˆ
                                       
                                       j
                                    
                                    )
                                    =
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          S
                                          
                                             W
                                             j
                                          
                                       
                                    
                                    
                                       
                                          w
                                          
                                             j
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             μ
                                          
                                          ˆ
                                       
                                       )
                                       
                                          
                                             μ
                                             ˆ
                                          
                                          k
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    μ
                                 
                                 ˆ
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          μ
                                          ˆ
                                       
                                       1
                                    
                                    ,
                                     
                                    …
                                    ,
                                     
                                    
                                       
                                          μ
                                          ˆ
                                       
                                       J
                                    
                                    )
                                 
                                 T
                              
                           
                         represents the noisy image to be smoothed, and 
                           
                              N
                              L
                              M
                              (
                              
                                 
                                    μ
                                    ˆ
                                 
                                 j
                              
                              )
                           
                         is the intensity value of pixel j after the NLM filtering.

However, different from the previous neighborhood filters, the NLM calculates the similarity based on patch instead of a single pixel. A patch of a pixel can be defined as a squared region centered at that pixel (called patch-window (PW), e.g., 5×5, in 2D case). Let 
                           
                              
                                 P
                              
                              (
                              
                                 
                                    μ
                                    ˆ
                                 
                                 j
                              
                              )
                           
                         denote the patch centered at pixel j and 
                           
                              
                                 P
                              
                              (
                              
                                 
                                    μ
                                    ˆ
                                 
                                 k
                              
                              )
                           
                         denote the patch centered at pixel k. The similarity between pixels j and k depends on the weighted Euclidean distance of their patches 
                           
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          (
                                          
                                             
                                                μ
                                                ˆ
                                             
                                             j
                                          
                                          )
                                          −
                                          
                                             P
                                          
                                          (
                                          
                                             
                                                μ
                                                ˆ
                                             
                                             k
                                          
                                          )
                                       
                                    
                                 
                                 
                                    2
                                    ,
                                    a
                                 
                                 2
                              
                           
                        . The exponential function converts the similarity to weighting coefficient which indicates the interaction degree between two pixels. Specifically, the weighting coefficient is given as:
                           
                              (2)
                              
                                 
                                    
                                       w
                                       
                                          j
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          μ
                                       
                                       ˆ
                                    
                                    )
                                    =
                                    
                                       
                                          exp
                                          (
                                          −
                                          |
                                          |
                                          
                                             P
                                          
                                          (
                                          
                                             
                                                μ
                                                ˆ
                                             
                                             j
                                          
                                          )
                                          −
                                          
                                             P
                                          
                                          (
                                          
                                             
                                                μ
                                                ˆ
                                             
                                             k
                                          
                                          )
                                          |
                                          
                                             |
                                             
                                                2
                                                ,
                                                a
                                             
                                             2
                                          
                                          /
                                          
                                             h
                                             2
                                          
                                          )
                                       
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                S
                                                
                                                   W
                                                   j
                                                
                                             
                                          
                                          
                                             exp
                                             (
                                             −
                                             |
                                             |
                                             
                                                P
                                             
                                             (
                                             
                                                
                                                   μ
                                                   ˆ
                                                
                                                j
                                             
                                             )
                                             −
                                             
                                                P
                                             
                                             (
                                             
                                                
                                                   μ
                                                   ˆ
                                                
                                                k
                                             
                                             )
                                             |
                                             
                                                |
                                                
                                                   2
                                                   ,
                                                   a
                                                
                                                2
                                             
                                             /
                                             
                                                h
                                                2
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The parameter h in Eq. (2) controls the decay of the exponential function as well as the weighting coefficient. When h is small, the image tends to be weakly smoothed, and vice versa. For simplicity, h is called filtering parameter hereafter. According to [29,30], the filtering parameter h is a function of the standard deviation of the image noise. And if we further consider the size of the patch-window, the parameter h can be given as [31]:
                           
                              (3)
                              
                                 
                                    
                                       h
                                       2
                                    
                                    =
                                    τ
                                    
                                       σ
                                       2
                                    
                                    =
                                    2
                                    η
                                    
                                       σ
                                       2
                                    
                                    |
                                    P
                                    
                                       W
                                       j
                                    
                                    |
                                 
                              
                           
                        where τ and η are free scalar parameters, σ is the standard deviation of the image noise, and |PW
                        
                           j
                        | denotes the size of the patch-window. However, it is well known that the noise distribution of low-dose CT images is non-stationary, so determining the standard deviation σ is not a trivial task. In the past, the parameter h has been simply set to be a global constant for the entire FOV, e.g., in [7,8,10], although such a practice may result in suboptimal filtering result. Besides, the NLM filter usually cannot effectively suppress the streak artifacts of low-dose CT images. The experimental results in Section 3 illustrate the limitations of the traditional NLM filtering with a spatial-invariant constant filtering parameter h.

Mathematically, low-dose CT image reconstruction is an ill-posed problem due to the presence of significant noise and other inconsistencies in the projection data. Therefore, it is usually formulated as the maximum a posterior (MAP) estimation by posing a regularization (or equivalently, penalty) term to regularize the solution. One common choice for low-dose CT image reconstruction is to minimize a PWLS objective function, and a non-negative constraint is usually added considering the physical meaning of the attenuation coefficients [11,15]:
                              
                                 (4)
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          *
                                       
                                       =
                                       
                                          
                                             
                                                arg
                                                min
                                                {
                                             
                                          
                                          
                                             μ
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             (
                                             
                                                y
                                             
                                             −
                                             
                                                A
                                             
                                             
                                                μ
                                             
                                             )
                                          
                                          T
                                       
                                       
                                          Σ
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          y
                                       
                                       −
                                       
                                          A
                                       
                                       
                                          μ
                                       
                                       )
                                       +
                                       β
                                       U
                                       (
                                       
                                          μ
                                       
                                       )
                                       }
                                    
                                 
                              
                           where 
                              
                                 
                                    y
                                 
                                 ∈
                                 
                                    ℝ
                                    
                                       I
                                       ×
                                       1
                                    
                                 
                              
                            is the vector of measured line integrals, and I is the total number of line integral measurements; 
                              
                                 
                                    μ
                                 
                                 ∈
                                 
                                    ℝ
                                    
                                       J
                                       ×
                                       1
                                    
                                 
                              
                            is the vector of attenuation coefficients of the object to be reconstructed, and J is the number of image pixels; 
                              
                                 
                                    A
                                 
                                 ∈
                                 
                                    ℝ
                                    
                                       I
                                       ×
                                       J
                                    
                                 
                              
                            is the system or projection matrix and its element A
                           
                              ij
                            is typically calculated as the intersection length of projection ray i with voxel j; 
                              
                                 
                                    Σ
                                 
                                 ∈
                                 
                                    ℝ
                                    
                                       I
                                       ×
                                       I
                                    
                                 
                              
                            is the covariance matrix, and since the measurement among different detector bins are assumed to be independent, it is diagonal and 
                              
                                 
                                    Σ
                                 
                                 =
                                 d
                                 i
                                 a
                                 g
                                 {
                                 
                                    σ
                                    
                                       
                                          y
                                          i
                                       
                                    
                                    2
                                 
                                 }
                              
                           ; U(μ) denotes the penalty term; β
                           >0 is a scalar control parameter that balances the data fidelity and the penalty; the symbols T and −1 herein are transpose and inverse operators, respectively.

The variance of the noise in line integral measurements can be determined by the following mean-variance relationship in consideration of X-ray quanta noise and system electronic noise [11,32,33]:
                              
                                 (5)
                                 
                                    
                                       var
                                       (
                                       
                                          y
                                          i
                                       
                                       )
                                       =
                                       
                                          σ
                                          
                                             
                                                y
                                                i
                                             
                                          
                                          2
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   N
                                                   ¯
                                                
                                                i
                                             
                                             +
                                             
                                                σ
                                                e
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         N
                                                         ¯
                                                      
                                                      i
                                                   
                                                
                                                2
                                             
                                          
                                       
                                       =
                                       
                                          1
                                          
                                             
                                                
                                                   N
                                                   ¯
                                                
                                                
                                                   0
                                                   i
                                                
                                             
                                          
                                       
                                       exp
                                       (
                                       
                                          
                                             y
                                             ¯
                                          
                                          i
                                       
                                       )
                                       
                                          
                                             1
                                             +
                                             
                                                
                                                   
                                                      σ
                                                      e
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         N
                                                         ¯
                                                      
                                                      
                                                         0
                                                         i
                                                      
                                                   
                                                
                                             
                                             exp
                                             (
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                i
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       N
                                       ¯
                                    
                                    
                                       0
                                       i
                                    
                                 
                              
                            represents the mean number of X-ray photons just before entering the patient and going toward the detector bin i, and can be measured by system calibration, e.g., by air scans; 
                              
                                 
                                    
                                       y
                                       ¯
                                    
                                    i
                                 
                              
                            and 
                              
                                 
                                    σ
                                    
                                       
                                          y
                                          i
                                       
                                    
                                    2
                                 
                              
                            are the mean and variance of the line integral measurements in detector bin i for repeated acquisitions; and 
                              
                                 
                                    σ
                                    e
                                    2
                                 
                              
                            is the variance of the electronic noise.

The NLM-based generic regularization can be described as [27,28]:
                              
                                 (6)
                                 
                                    
                                       U
                                       (
                                       
                                          μ
                                       
                                       )
                                       =
                                       
                                          ∑
                                          j
                                       
                                       
                                          ϕ
                                          
                                             
                                                
                                                   μ
                                                   j
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      k
                                                      ∈
                                                      S
                                                      
                                                         W
                                                         j
                                                      
                                                   
                                                
                                                
                                                   
                                                      w
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                   (
                                                   
                                                      μ
                                                   
                                                   )
                                                   
                                                      μ
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                        
                                       and
                                        
                                       
                                          w
                                          
                                             j
                                             k
                                          
                                       
                                       (
                                       
                                          μ
                                       
                                       )
                                       =
                                       
                                          
                                             exp
                                             (
                                             −
                                             |
                                             |
                                             
                                                P
                                             
                                             (
                                             
                                                μ
                                                j
                                             
                                             )
                                             −
                                             
                                                P
                                             
                                             (
                                             
                                                μ
                                                k
                                             
                                             )
                                             |
                                             
                                                |
                                                
                                                   2
                                                   ,
                                                   a
                                                
                                                2
                                             
                                             /
                                             
                                                h
                                                2
                                             
                                             )
                                          
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   S
                                                   
                                                      W
                                                      j
                                                   
                                                
                                             
                                             
                                                exp
                                                (
                                                −
                                                |
                                                |
                                                
                                                   P
                                                
                                                (
                                                
                                                   μ
                                                   j
                                                
                                                )
                                                −
                                                
                                                   P
                                                
                                                (
                                                
                                                   μ
                                                   k
                                                
                                                )
                                                |
                                                
                                                   |
                                                   
                                                      2
                                                      ,
                                                      a
                                                   
                                                   2
                                                
                                                /
                                                
                                                   h
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           where ϕ denotes a positive potential function and can be chosen as 
                              
                                 ϕ
                                 (
                                 Δ
                                 )
                                 =
                                 
                                    
                                       
                                          Δ
                                       
                                    
                                    p
                                 
                                 (
                                 1
                                 ≤
                                 p
                                 ≤
                                 2
                                 )
                              
                           . It should be noted that the weighting coefficients 
                              
                                 
                                    w
                                    
                                       j
                                       k
                                    
                                 
                                 (
                                 
                                    μ
                                 
                                 )
                              
                            in Eq. (6) are computed on the image μ, rather than a reference image such as in [24,34]. Thus, we call it as NLM-based generic regularization to differentiate it from those needing a reference image. However, using the generic regularization in Eq. (6) may cause difficulty in optimizing the objective function in Eq. (4), because the weighting coefficients are actually computed on the unknown image μ. To address this issue, an empirical one-step-late (OSL) implementation is employed for the optimization task, where the weighting coefficients are computed on current image estimate and then are assumed to be constants when updating the image. Such an OSL iteration scheme has been demonstrated to be feasible and effective in the previous studies [28,35].

The filtering parameter h determines the smoothness of the resulting image, where larger h results in more smoothing and smaller h results in less smoothing. In the previous studies, the h in the NLM-based regularizations was often set to be a constant across the entire FOV [24–28,34,35]. However, when the local characteristics of the image differ significantly across the entire FOV, a constant h may result in inferior/suboptimal reconstruction result, since it may be too large for some regions (blurring edges and subtle structures) while too small (filtering little) for other regions within the image domain. To mitigate this issue, in this study, we propose a novel locally adaptive estimation of the filtering parameter h at pixel j as:
                              
                                 (7)
                                 
                                    
                                       
                                          h
                                          j
                                          2
                                       
                                       =
                                       s
                                       ⋅
                                       m
                                       e
                                       a
                                       n
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         (
                                                         
                                                            μ
                                                            j
                                                         
                                                         )
                                                         −
                                                         
                                                            P
                                                         
                                                         (
                                                         
                                                            μ
                                                            k
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   2
                                                   ,
                                                   a
                                                
                                             
                                             ,
                                              
                                             k
                                             ∈
                                             S
                                             
                                                W
                                                j
                                             
                                          
                                       
                                       +
                                       t
                                    
                                 
                              
                           where s and t are two constants, and can be determined through experiments.

The rationale behind the mathematical expression of Eq. (7) is that the value of h should depend on the similarity between the patch of target pixel and the patches within the corresponding SW. That is, when SW contains many similar patches to P(μ
                           
                              j
                           ), h needs to be decreased to reduce the influence of the other patches. On the contrary, when very few similar patches exist in SW for P(μ
                           
                              j
                           ), h needs to be increased to relax the selection [36]. To achieve robust implementation of the similarity dependence in Eq. (7), the constant t is introduced to ensure numerical stability and adequate filtering for uniform regions, and the constant s is introduced to control the relative filtering strength for non-uniform regions in the image domain.

There are five parameters related to the proposed adaptive NLM-based regularization (size of SW, size of PW, standard deviation a of the Gaussian kernel, and constants t and s). Determining the optimal values for these five parameters for the adaptive NLM-based regularization is not a trivial task. Extensive experiments revealed that the sizes of SW and PW as well as the standard deviation a do not have noticeable effects on the reconstructed image when they are set in a reasonable range. Therefore, a typical selection of SW=17×17, PW=5×5 and a
                           =5 was used for all the cases in this study. As for the constants t and s in Eq. (7), it was found that t
                           =4×10−6 was good for all the datasets, and the optimal value for s differed slightly within a small range for different datasets, e.g., from 4×10−4 to 1×10−3.

The hyper-parameter β controls the tradeoff between the data fidelity term and the regularization term in the PWLS objective function. The selection of optimal β value for the SIR methods remains an open question. Generally, a larger β value produces a more smoothed reconstruction with lower noise level but also lower spatial resolution, and vice versa.

According to our experiments, too small s value may introduce artifacts and too small β value cannot effectively suppress the noise, while too large value of either parameter may blur the image edges. In this study, we set the two parameters in a reasonable range and performed a grid search for different combinations of them, and then determined the optimal combination through visual inspection and quantitative measures of corresponding reconstruction result.

A computer simulated clock phantom was utilized in this study, which is modified from the reported one in [37]. The clock phantom consists of a water background and eight circular inserts with different contrasts (C1: −100%, C2: +150%, C3: +7%, C4: −50%, C5: +85%, C6: −15%, C7: −7%, C8: +30%). The low-dose sinogram data of the clock phantom was acquired using the simulation method in [38]. After calculating the noise-free line integral, the noisy measurement N
                           
                              i
                            at detector bin i was generated according to the statistical model:
                              
                                 (8)
                                 
                                    
                                       
                                          N
                                          i
                                       
                                       ∼
                                       Poisson
                                       (
                                       
                                          
                                             N
                                             ¯
                                          
                                          
                                             0
                                             i
                                          
                                       
                                       exp
                                       (
                                       −
                                       
                                          
                                             y
                                             ¯
                                          
                                          i
                                       
                                       )
                                       )
                                       +
                                       Gaussian
                                       (
                                       0
                                       ,
                                       
                                          σ
                                          e
                                          2
                                       
                                       )
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       N
                                       ¯
                                    
                                    
                                       0
                                       i
                                    
                                 
                              
                            was set to be 3×104 and 
                              
                                 
                                    σ
                                    e
                                    2
                                 
                              
                            was set to be 10 in this study [38]. Then the corresponding noisy line integrals were calculated by the logarithm transform. The scanning geometry was the same as the Siemens Somatom Sensation 16 CT scanner (Siemens Healthcare, Forchheim, Germany), which is illustrated in Table 1
                           .

To evaluate the above presented reconstruction algorithm in a more realistic situation, an anthropomorphic torso phantom (Radiology Support Devices, Inc., Long Beach, CA) was used for experimental projection data acquisition. The phantom was scanned by the same clinical Siemens scanner (as described in Table 1) in a cine mode at a fixed bed position. The X-ray tube voltage was set to be 120kVp and the mAs level was set to be 40mAs. The CT scanner was rotated 150 times around the torso phantom.

The central slice sinogram data of one scan was extracted and regarded as the low-dose scan. The averaged sinogram data of that slice from 150 repeated scans was reconstructed by the FBP method to serve as the ground truth image for evaluation purpose.

The projection data of a patient were acquired using the same Siemens scanner after obtaining informed consent from the patient, and this clinical data serve as a pilot clinical study. The patient was scheduled for CT scan for medical reasons. The X-ray tube voltage was 120kVp, and the mAs level was 20mAs, which was considered as ultra low-dose scan in clinic.

@&#PERFORMANCE EVALUATION@&#

Two quantitative metrics, peak signal-to-noise ratio (PSNR) and normalized mean square error (NMSE), were utilized to evaluate the noise reduction performance of different reconstruction methods. Let μ
                           
                              r
                           
                           =(μ
                           
                              r,1, ..., μ
                           
                              r,J
                           )
                              T
                            denote the vector of reconstructed image and μ
                           0
                           =(μ
                           0,1, ..., μ
                           0,J
                           )
                              T
                            be the vector of the ground truth image, the two metrics are defined as:
                              
                                 (9)
                                 
                                    
                                       PSNR
                                       =
                                       10
                                       
                                          
                                             log
                                          
                                          
                                             10
                                          
                                       
                                       
                                          
                                             
                                                
                                                   max
                                                
                                                2
                                             
                                             (
                                             
                                                
                                                   μ
                                                
                                                0
                                             
                                             )
                                          
                                          
                                             
                                                ∑
                                                j
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         μ
                                                         
                                                            r
                                                            ,
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         μ
                                                         
                                                            0
                                                            ,
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                /
                                                J
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (10)
                                 
                                    
                                       NMSE
                                       =
                                       
                                          
                                             
                                                ∑
                                                j
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         μ
                                                         
                                                            r
                                                            ,
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         μ
                                                         
                                                            0
                                                            ,
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                ∑
                                                j
                                             
                                             
                                                
                                                   μ
                                                   
                                                      0
                                                      ,
                                                      j
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In order to assess the image quality of regions of interest (ROIs) by different reconstruction methods, the root mean squared error (RMSE) which indicates the difference between reconstructed image and the ground truth image, and the universal quality index (UQI) [39] which measures the similarity, were utilized to evaluate the quality performance of different methods in terms of detailed ROIs reconstruction.

Mathematically, the two metrics are defined as (where Q is the number of pixels in the ROI):
                              
                                 (11)
                                 
                                    
                                       RMSE
                                       =
                                       
                                          
                                             
                                                1
                                                Q
                                             
                                             
                                                ∑
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                Q
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         μ
                                                         
                                                            r
                                                            ,
                                                            n
                                                         
                                                         
                                                            l
                                                            o
                                                            c
                                                            a
                                                            l
                                                         
                                                      
                                                      −
                                                      
                                                         μ
                                                         
                                                            0
                                                            ,
                                                            n
                                                         
                                                         
                                                            l
                                                            o
                                                            c
                                                            a
                                                            l
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (12)
                                 
                                    
                                       UQI
                                       =
                                       
                                          
                                             4
                                             cov
                                             {
                                             
                                                
                                                   μ
                                                
                                                r
                                                
                                                   l
                                                   o
                                                   c
                                                   a
                                                   l
                                                
                                             
                                             ,
                                             
                                                
                                                   μ
                                                
                                                0
                                                
                                                   l
                                                   o
                                                   c
                                                   a
                                                   l
                                                
                                             
                                             }
                                          
                                          
                                             var
                                             {
                                             
                                                
                                                   μ
                                                
                                                r
                                                
                                                   l
                                                   o
                                                   c
                                                   a
                                                   l
                                                
                                             
                                             }
                                             +
                                             var
                                             {
                                             
                                                
                                                   μ
                                                
                                                0
                                                
                                                   l
                                                   o
                                                   c
                                                   a
                                                   l
                                                
                                             
                                             }
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   μ
                                                   ¯
                                                
                                                r
                                                
                                                   l
                                                   o
                                                   c
                                                   a
                                                   l
                                                
                                             
                                             ⋅
                                             
                                                
                                                   μ
                                                   ¯
                                                
                                                0
                                                
                                                   l
                                                   o
                                                   c
                                                   a
                                                   l
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         μ
                                                         ¯
                                                      
                                                      r
                                                      
                                                         l
                                                         o
                                                         c
                                                         a
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         μ
                                                         ¯
                                                      
                                                      0
                                                      
                                                         l
                                                         o
                                                         c
                                                         a
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       μ
                                       ¯
                                    
                                    r
                                    
                                       l
                                       o
                                       c
                                       a
                                       l
                                    
                                 
                                 =
                                 1
                                 /
                                 Q
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    Q
                                 
                                 
                                    
                                       μ
                                       
                                          r
                                          ,
                                          n
                                       
                                       
                                          l
                                          o
                                          c
                                          a
                                          l
                                       
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       μ
                                       ¯
                                    
                                    0
                                    
                                       l
                                       o
                                       c
                                       a
                                       l
                                    
                                 
                                 =
                                 1
                                 /
                                 Q
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    Q
                                 
                                 
                                    
                                       μ
                                       
                                          0
                                          ,
                                          n
                                       
                                       
                                          l
                                          o
                                          c
                                          a
                                          l
                                       
                                    
                                 
                              
                           , 
                              
                                 var
                                 {
                                 
                                    
                                       μ
                                    
                                    r
                                    
                                       l
                                       o
                                       c
                                       a
                                       l
                                    
                                 
                                 }
                                 =
                                 (
                                 1
                                 /
                                 Q
                                 −
                                 1
                                 )
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    Q
                                 
                                 
                                    
                                       
                                          (
                                          
                                             μ
                                             
                                                r
                                                ,
                                                n
                                             
                                             
                                                l
                                                o
                                                c
                                                a
                                                l
                                             
                                          
                                          −
                                          
                                             
                                                μ
                                                ¯
                                             
                                             r
                                             
                                                l
                                                o
                                                c
                                                a
                                                l
                                             
                                          
                                          )
                                       
                                       2
                                    
                                 
                              
                           , 
                              
                                 var
                                 {
                                 
                                    
                                       μ
                                    
                                    0
                                    
                                       l
                                       o
                                       c
                                       a
                                       l
                                    
                                 
                                 }
                                 =
                                 (
                                 1
                                 /
                                 Q
                                 −
                                 1
                                 )
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    Q
                                 
                                 
                                    
                                       
                                          (
                                          
                                             μ
                                             
                                                0
                                                ,
                                                n
                                             
                                             
                                                l
                                                o
                                                c
                                                a
                                                l
                                             
                                          
                                          −
                                          
                                             
                                                μ
                                                ¯
                                             
                                             0
                                             
                                                l
                                                o
                                                c
                                                a
                                                l
                                             
                                          
                                          )
                                       
                                       2
                                    
                                 
                              
                           , 
                              
                                 cov
                                 {
                                 
                                    
                                       μ
                                    
                                    r
                                    
                                       l
                                       o
                                       c
                                       a
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       μ
                                    
                                    0
                                    
                                       l
                                       o
                                       c
                                       a
                                       l
                                    
                                 
                                 }
                                 =
                                 (
                                 1
                                 /
                                 Q
                                 −
                                 1
                                 )
                                 
                                    ∑
                                    
                                       n
                                       =
                                       1
                                    
                                    Q
                                 
                                 
                                    (
                                    
                                       μ
                                       
                                          r
                                          ,
                                          n
                                       
                                       
                                          l
                                          o
                                          c
                                          a
                                          l
                                       
                                    
                                    −
                                    
                                       
                                          μ
                                          ¯
                                       
                                       r
                                       
                                          l
                                          o
                                          c
                                          a
                                          l
                                       
                                    
                                    )
                                    (
                                    
                                       μ
                                       
                                          0
                                          ,
                                          n
                                       
                                       
                                          l
                                          o
                                          c
                                          a
                                          l
                                       
                                    
                                    −
                                    
                                       
                                          μ
                                          ¯
                                       
                                       0
                                       
                                          l
                                          o
                                          c
                                          a
                                          l
                                       
                                    
                                    )
                                 
                              
                           .

The UQI quantifies the noise, spatial resolution, and texture correlation between two images, and has been widely used in CT image quality evaluation during past years.

@&#RESULTS@&#

In this work, three categories of projection data were utilized to validate the performance of the proposed adaptive NLM-regularized statistical image reconstruction method (referred to as PWLS-adaptiveNLM) for X-ray CT imaging from low-dose acquisitions. For comparison purpose, the standard FBP reconstruction, the FBP reconstruction followed by NLM filtering (referred to as FBP+NLM filtering), the NLM-regularized statistical image reconstruction with constant filtering parameter (referred to as PWLS-NLM), and the total variation regularized statistical image reconstruction (referred to as PWLS-TV) were also implemented in a similar fashion as the implementation of the proposed method. To ensure the fairness of comparison, the parameters for each method were carefully tuned to obtain the best image quality.

The reconstructed images by the FBP, FBP+NLM filtering, PWLS-NLM, PWLS-adaptiveNLM and PWLS-TV from the simulated low-dose sinogram are shown in Fig. 1(b)–(f). The zoom-in views of three low-contrast inserts (C3: +7%, C6: −15%, C7: −7%) by different reconstruction methods are also illustrated. We can see that the FBP+NLM filtering can suppress the noise in the FBP reconstructed image to a large extent, but it is still not comparable to the PWLS-NLM reconstructed image. However, since these two methods use a constant filtering parameter, their outcomes seem to blur the low-contrast inserts substantially. In contrast, the PWLS-adaptiveNLM method can effectively suppress the noise while retaining the low-contrast objects. Finally, the PWLS-TV reconstructed image slightly suffers from patchy artifacts in the uniform region, and the low-contrast inserts are also considerably distorted.

To evaluate the noise reduction performance of the different reconstruction methods, two quantitative metrics were employed. According to Table 2
                           , the proposed PWLS-adaptiveNLM method offers the highest PSNR and lowest NMSE, and therefore outperforms other methods in term of noise reduction, which is consistent with the visual inspection.

In order to evaluate the performance of different methods on the reconstruction of fine structures, we chose eight ROIs in the clock phantom, as labeled by the red rectangles in Fig. 1(b). Since the FBP reconstructed image was obviously worse than those by the other four methods due to the excessive noise, we excluded it and only compared the local image quality by the other four methods. The quantitative results with RMSE and UQI are illustrated in Fig. 2
                           . Still, the proposed PWLS-adaptiveNLM has the best local image quality for the eight detailed ROIs with the lowest RMSE and highest UQI. The UQI quantifies the noise, spatial resolution, and texture correlation. From Fig. 2(b), it is noted that the UQI values of the high-contrast ROIs (including C1: −100%, C2: +150%, C4: −50%, C5: +85%, C8: +30%) by the four different methods are relatively high and comparable, while the UQI values of the low-contrast ROIs (including C3: +7%, C6: −15%, C7: −7%) by the four different methods are relatively low and differ substantially. These results suggest that the low-contrast objects are more difficult to recover but the PWLS-adaptiveNLM method performed well in recovering them. The merit is significant, since we know that the low-contrast objects reconstruction can be very critical in clinic.


                           Fig. 3(a) shows one transverse image of the anthropomorphic torso phantom reconstructed by the FBP method from the averaged sinogram of 150 repeated scans, which serves as the ground truth image for evaluation. Fig. 3(b)–(f) illustrates the reconstructed images by the FBP, FBP+NLM filtering, PWLS-NLM, PWLS-adaptiveNLM and PWLS-TV from a low-dose 40mAs sinogram. The FBP+NLM filtering method can suppress the noise pretty well, but there are still tiny streak artifacts in the image. The three PWLS methods outperform the FBP+NLM in terms of streak artifacts suppression, which can be attributed to the statistical modeling of the sinogram data. From the zoom-in views of the detailed regions, we can observe that the PWLS-adaptiveNLM method is superior to the PWLS-NLM and PWLS-TV on the reconstruction of the fine structures.


                           Table 3
                            lists the quantitative results of the five different reconstruction methods on the anthropomorphic torso phantom with PSNR and NMSE metrics. The proposed PWLS-adaptiveNLM method also demonstrates better performance than the other four methods on image noise reduction.

To quantitatively demonstrate the benefits of the proposed PWLS-adaptiveNLM method, we compare the performance of the four methods on the reconstruction of ROIs with fine structures, which are labeled with red rectangles in Fig. 3(b). The corresponding quantitative results based on the RMSE and UQI metrics are shown in Fig. 4
                           . Again, the PWLS-adaptiveNLM method yielded the lowest RMSE and the highest UQI for all the five detailed ROIs.

The reconstructed images by the FBP, FBP+NLM filtering, PWLS-NLM, PWLS-adaptiveNLM and PWLS-TV from the ultra low-dose 20mAs sinogram of the patient are shown in Fig. 5(a)–(e). We can see that the FBP+NLM filtering method cannot eliminate the streak artifacts in the image, while the three PWLS methods do not have such problem due to the statistical modeling of the sinogram data. However, the PWLS-TV exhibits slight patchy artifacts in the region indicated by the arrow, which is also reported in [17,20]. From the zoom-in views of the three detailed regions, we can also see that the PWLS-adaptiveNLM method outperforms the other methods on the reconstruction of the fine structures.

However, for the patient study, we cannot implement the quantitative evaluations as the phantom studies due to the lack of ground truth image. Still, we observe that the patient study exhibits the same trend as the phantom studies through visual inspection.

In this study, we proposed and validated an adaptive NLM-regularized statistical image reconstruction method for X-ray CT from low-dose acquisitions. One motivation of this work is that the traditional NLM filtering methods sometimes cannot completely remove the noise and streak artifacts in the low-dose CT images, especially when the streak artifacts are very severe. The NLM-regularized statistical image reconstruction method can mitigate this problem, partially due to the explicit statistical modeling of the projection data. However, the choice of the associated filtering parameter h as a spatially invariant global constant in the NLM-based regularization may not be optimal for the reconstruction of the entire image. To further improve the reconstruction results, we proposed a novel strategy to determine locally optimal filtering parameter by considering local characteristics of the image, which made the NLM-based regularization to be adaptive. The experimental results with the PWLS-NLM and PWLS-adaptiveNLM methods proved that it is indeed necessary and beneficial to introduce the spatial adaptivity of the filtering parameter.

It is noted that the adaptive NLM-based regularization in this study is implemented in 2D domain. The implementation can be expanded to 3D space by setting the search-window and patch window to, for instance, 17×17×17 and 5×5×5 respectively for isotropic data. This may further improve the performance of the proposed method, although it would also increase the computation burden.

Also, it is noted that the proposed adaptive NLM regularization shares similar idea with the edge-preserving TV [40] and adaptive-weighted TV [41,42] regularization. Although using different mechanism to incorporate the spatial adaptivity, they essentially both consider local characteristics of the image to be reconstructed. However, the NLM-based regularization may have the advantage of better eliminating the patchy artifacts sometimes appearing in the TV-based regularization, due to the use of a larger neighborhood.

As any other proposed method, the presented PWLS-adaptiveNLM method also has some potential limitations. The first one is the parameters tuning. While the sizes of search-window and patch-window (also the standard deviation of the Gaussian kernel) do not show noticeable effects on the reconstructed image when they are set in a reasonable range and the parameter setting t
                     =4×10−6 in Eq. (7) works well, the strength parameter s in Eq. (7) seems need more manual tuning than the others. In this study, a typical range for s was found from 4×10−4 to 1×10−3. Further investigation on the strength parameter is needed. This is another topic in our future research plan.

Sharing the same challenges as other iterative reconstruction methods do, the proposed method also faces the limitation in computation efficiency due to the multiple re-projection and back-projection operation cycles between the projection data domain and image domain as well as the weighting coefficients calculation in each iterative circle. With constant improvement in fast computation via dedicated hardware and software, the computational efficiency could not be a major challenge in the future.

No conflict of interest was declared by the authors.

@&#ACKNOWLEDGEMENTS@&#

This work was partly supported by the NIH/NCI under grants #CA082402 and #CA143111. JM was partially supported by the NSF of China under grants # 81371544, #81000613 and #81101046. JW was supported in part by grants from the Cancer Prevention and Research Institute of Texas (RP110562-P2 and RP130109), a grant from the American Cancer Society (RSG-13-326-01-CCE) and a grant from NIH (R01EB020366). HL was supported in part by the NSF of China grants #81230035 and #81071220.

@&#REFERENCES@&#

