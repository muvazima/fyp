@&#MAIN-TITLE@&#Using local lexicalized rules to identify heart disease risk factors in clinical notes

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We created a set of task-specific dictionaries related to heart disease.


                        
                        
                           
                           We designed generic rules for risk factors identification.


                        
                        
                           
                           The results are aggregated at the document level.


                        
                        
                           
                           Temporal attributes are assigned class-specific defaults.


                        
                        
                           
                           Rule-based risk factor extraction is feasible and reliable.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Text mining

Risk factors

Heart disease

Vocabularies

Rule-based modelling

@&#ABSTRACT@&#


               
               
                  Heart disease is the leading cause of death globally and a significant part of the human population lives with it. A number of risk factors have been recognized as contributing to the disease, including obesity, coronary artery disease (CAD), hypertension, hyperlipidemia, diabetes, smoking, and family history of premature CAD. This paper describes and evaluates a methodology to extract mentions of such risk factors from diabetic clinical notes, which was a task of the i2b2/UTHealth 2014 Challenge in Natural Language Processing for Clinical Data. The methodology is knowledge-driven and the system implements local lexicalized rules (based on syntactical patterns observed in notes) combined with manually constructed dictionaries that characterize the domain. A part of the task was also to detect the time interval in which the risk factors were present in a patient.
                  The system was applied to an evaluation set of 514 unseen notes and achieved a micro-average F-score of 88% (with 86% precision and 90% recall). While the identification of CAD family history, medication and some of the related disease factors (e.g. hypertension, diabetes, hyperlipidemia) showed quite good results, the identification of CAD-specific indicators proved to be more challenging (F-score of 74%). Overall, the results are encouraging and suggested that automated text mining methods can be used to process clinical notes to identify risk factors and monitor progression of heart disease on a large-scale, providing necessary data for clinical and epidemiological studies.
               
            

@&#INTRODUCTION@&#

Heart disease is the leading cause of death globally [1]: in the UK, for example, about one in six men and one in ten women die from heart disease [2]. Furthermore, a significant part of the human population lives with it (e.g., 2.3million people in the UK alone). Many studies have been conducted to improve treatment and identify possible risk factors and life-style habits that may make a person more likely to develop heart disease. For example, obesity, coronary artery disease (CAD), hypertension, hyperlipidemia, diabetes, smoking, family history of premature CAD, unhealthy diet and age above 55 have been acknowledged as important risk factors [3]. The ability to identify such risk factors for individual patients is important for both disease prevention and treatment; furthermore, extraction of such information on a large-scale (e.g., from electronic health records (EHRs)) is key for epidemiological studies and understanding the development of the disease.

While EHRs contain coded (structured) information that is undoubtedly useful for such studies, clinical narratives (e.g., letters, doctor notes) are in an unstructured, free-text form and often include rich, contextual information that is not present elsewhere. Processing of such information has been a focus of clinical text mining for over 30years [4–7], with notable results in harvesting important clinical concepts and events. Efforts have focused on the identification of various concepts, combining a variety of approaches. For example, Goryachev et al. [8] recognized family history from discharge summaries and outpatient clinic notes through a rule-based approach with an F-score of 95%, while Wang [9] extracted findings and medical procedures in clinical progress notes by applying both a rule-based system and modelling a conditional random field classifier, with F-scores of 49% and 82% respectively. Several approaches have been developed for identification of medication information from clinical notes. Patrick et al. [10], for example, applied a hybrid approach of supervised learning and rules, while Spasic et al. [11] used a rule-based methodology and Yang [12] mainly relied on a dictionary-based method. Other work has focused on the extraction of medical problems, treatments and tests from clinical narratives with relatively good results, typically with an F-score of around 80%. For example, Rink et al. [13] and Jonnalagadda et al. [14] applied machine learning, whereas Xu et al. [15] combined machine learning and rules for that task. Finally, there has been previous work on extracting risk factors for certain conditions: for example, Fiszman and colleagues [16] used a semantic processor that recognized predications to extract metabolic syndrome risk factors (such as obesity, high density lipoprotein, elevated blood pressure) from MEDLINE abstracts, with an overall F-score of 59%.

Several community challenges in clinical text processing have been organized to assess the state-of-the-art for specific tasks, including, for example, medication identification [17–19], extraction of co-morbidities [20], etc. One of the tasks in the 2014 i2b2/UThealth Challenge in Natural Language Processing for Clinical Data aimed to identify potential risk factors for heart disease from clinical notes of diabetic patients [3]. The task focused on eight classes, including mentions of CAD or factors that are associated with its onset (diabetes, obesity, hyperlipidemia, hypertension, smoking status, family history of CAD and related medications). In this paper we describe and evaluate our approach to the task, which uses local lexicalized rules combined with manually constructed dictionaries that characterize the domain. We demonstrate that the rule-based approach is feasible and can be used for reliable large-scale data harvesting.

The task focused on document-level extraction of the eight classes listed above, where each class is characterized by attributes (see Table 1
                        ). The five disease classes (CAD, diabetes, obesity, hyperlipidemia, hypertension) are recognized through either explicit presence (mention) of the disease or the progression of clinical markers suggesting the targeted disease (e.g., “hemoglobin levels above 6.5” and “glucose levels over 126” are indicators for diabetes). Different diseases have a different number of indicators: for example, CAD has four (a mention of the disease or its symptom – e.g., angina, event – e.g., heart catheterization, or test – e.g., stress test), obesity has three (mention, body mass index (BMI) and waist circumference (WC)), while hypertension has two (mention and high blood pressure).

The medication class has two attributes: type 1 is the drug category to which the medication belongs (a total of 22, e.g., “sulfonylureas”, “meglitinides”) and type 2 indicates drugs that can be included in more than one category (e.g., “zestoretic” has type 1 of “ACE inhibitor” and type 2 of “diuretic”).

The time attribute refers to the temporal interval in which a risk factor was present in the patient’s medical history: before the Document Creation Time (DCT, i.e. the time when the clinical note was created), during DCT and/or after DCT. DCT is considered as an attribute in all of the disease factors and in the medication class. We note that a specific risk factor can be present before, during and after DCT, or in any combination of these.

The smoker class has a status attribute that indicates whether the person is a “current”, “past”, “ever”, or “never” smoker, or if their smoking status is “unknown”. Finally, the family history contains the “present” or “not present” indicator that specifies whether the patient has first degree relatives (e.g., parents, siblings) who were diagnosed prematurely with CAD.

The overall task was to indicate the presence of these risk factors at the document level. Specifically, for the five disease factors, the task included a binary, document-level classification (present/absent) for each of the associated indicators and also for the explicit disease mentions. The time attribute further specifies the timeframe(s) (before, during, after). Medication information includes the two types and time (3 values), whereas family history of CAD is a binary classification task (present/absent). Finally, the smoking status needs to be instantiated with one of the five possible values. The task organizers provided a training set (790 clinical notes) and 514 notes as an evaluation set, all fully annotated at the document level [3]. The data are available at the following link https://www.i2b2.org/NLP/DataSets.

After an initial analysis of the training set where we observed common lexical patterns that indicate the presence of the targeted factors (e.g., “male with hypertension”, “pmh: diabetes, hypertension”), we designed and implemented a lexicalized rule-based approach for their recognition. Our methodology consists of four steps:
                           
                              
                                 Step 1: creation of specific vocabularies for each class.


                                 Step 2: design and implementation of rules to capture risk factors of interest at the mention level.


                                 Step 3: integration of the mention-level results at the document level.


                                 Step 4: designating the time value to the identified factors.

In the first step, a number of task-specific semantic groups have been identified and lexicalized through a set of custom-made vocabularies that were engineered from open clinical resources (see Table 2
                        ). The dictionaries were manually tailored by observing the training set for the usage of terms describing the associated risk factors and expressions related to their indicators (e.g., “blood pressure”, “high blood pressure”, “systolic blood pressure”, etc.), and by adding clinical synonyms and acronyms from the Unified Medical Language System [21] (UMLS) for specific terms of interest.

In the second step, these dictionaries are used to anchor and constrain a generic set of local rules for identification of disease and risk factor mentions by using:
                           
                              •
                              specific semantic groups, recognized by the vocabularies and/or regular expressions,

semi-frozen lexical expressions (e.g. “the patient was diagnosed with”) that are used as anchors for specific entity and attribute types.

We note that the vocabularies used are task-specific, whereas the general rule patterns are focused on the identification of disease risk factors, which are then used to “infer” the mention of a specific disease type (e.g., based on the specific indicators). Generally speaking, the rules were based on structured patterns consisting of semi-frozen syntactic chunks (e.g. noun phrases, verbs and prepositions) and/or semantic place holders (through dictionary mentions), either suggesting the presence of a disease or associated event (e.g., “history of present illnesses include 
                        hypertension”, “underwent catheterization”, “stress test 
                        was positive”) or specific indicators (e.g., via specific measurements implemented through regular expressions (e.g., “BMI: NUMBER”, “blood pressure: NUMBER/NUMBER”). For example, a rule that captures mentions of CAD-specific surgery would have two parts: a semi-frozen verbal expression (e.g. various forms of “undergo”) followed by a mention matched by the surgery dictionary (as mentioned in Table 2). We have also implemented concept enumeration as it appears quite frequently in the training data, particularly for disease and medication mentions (e.g., “pmhx: dm, htn, dementia”, “Medications: Lisinopril Pravachol”). Table 3
                         presents examples of rules for some risk factors. The number of rules for specific entity types (see Table 4
                        ) roughly indicates the complexity of the targeted information i.e., the number of associated indicator types. For the design and implementation of the rules we used MinorThird [22], an information extraction development environment that we have previously used for clinical text mining [11].

We note that a document in this task was a set of clinical notes for a given patient and that we are interested whether a risk factor is mentioned or not within the document. Therefore, in the third step, we have integrated the data identified at the mention level to the document level. For example, if we have detected any high blood pressure indicators (e.g., “bp 150/90 mm/hg” or “blood pressure: 160/90 mm/hg”) in a note, we consider that the patient has “hypertension”, with an indicator of “high blood pressure” tagged at the document level.

This approach was followed for all entity types and attributes apart from the time dimension. As the clinical notes were longitudinal, there was a high chance that patients have a number of diseases (and indicators) before, during and after the DCT. This is also likely to be the case with the (majority of) administered medications. This hypothesis was confirmed by the training set: from 1223 disease mentions (at the document level), only 15 (1.23%) did not have all three time attributes values (i.e. before DCT, during DCT, after DCT); for medication mentions, from a total of 2191, only 203 (9.26%) had either one or two time attributes. Therefore, we decided to set, as a default, all three values for the time attribute for all the disease and medication mentions, and aim to identify only explicit localized expressions (e.g., “stop drug”, “start on drug”) to alter these if necessary. Specific disease indicators were treated by different defaults. For example, body mass index and high blood pressure are typically recorded during the creation of the narrative and rarely denote past or future values; we therefore decided to assign the default value of “during DCT” to their time attribute. Other tests (e.g. levels of hemoglobin, glucose, high LDL, high cholesterol, CAD test, CAD symptom, CAD event) typically happen before the date of the current note and hence were set to the default value of “before DCT”. This was also supported by the data in the training corpus.

@&#RESULTS@&#

The system was formally evaluated as part of the i2b2 challenge. Table 5
                      displays the summarized results across all data sets (training, development and evaluation). The overall micro precision was 85.57% with recall of 90.07% and a micro F-score of 87.76%. We note that there was only a marginal drop in the performance compared to the training data, suggesting that the lexicalized rules managed to generalize the risk factor identification quite well. Table 6
                      shows the results per entity class for the evaluation set. The highest F-score was returned for family history (95.91%), with the highest recall of 96.97% for medication. With the exception of CAD which proved to be the most challenging class to recognize (F-score of 73.63%), all other classes were identified with an F-score above 85% indicating that the approach we followed was effective in the identification of several components of CAD risk factors in clinical narratives.

@&#DISCUSSION@&#

The system’s micro F-score of 87.76% ranked the system 9th out of the 48 submissions (up to 3 submissions per a team). We note that the performance of the rule-based approach was well above the challenge mean (81.5%) and 5% less than the highest ranking system. This suggests that a rule-based approach for the recognition of heart disease risk factors and the assignment of a time indicator regarding their progression (or not) is worthwhile. To perform an analysis of false positives (FPs) and negatives (FNs), we took a random sample of ten documents for each class from the evaluation set and observed the common types of error that the system generated.

A quarter (10/48) of FPs originated from disease mentions that are either related to the family of the patient (e.g., “family history: diabetes, fh: – 
                        
                           dm
                        
                        : father”), are negated (e.g., “no history of 
                        
                           hypertension
                        ”) or refer to allergies (e.g. “Allergies: 
                        
                           sulfa
                         
                        drugs”). It is interesting that negation was not that frequent, contributing to only 6% of cases. Another quarter of FPs (11/48) were ambiguous cues: for example, “lipids” and “ht” are often used to describe the diagnosis and the status of hyperlipidemia and hypertension respectively, but they can also be used in a different context (e.g., “
                           lipids
                         
                        will be checked”, “ht 
                        1.82 cm”). “Insulin” was another frequent example, as it refers to both disease mentions (e.g., “insulin dependent diabetes mellitus”) and a medication. We note that over half of FPs (27/48) are risk factors possibly missed in the annotation process (e.g. “hemoglobin a1c 7.7” was not annotated as an indicator for CAD; similarly “abd: 
                        
                           obese
                        
                        , non-protuberant”, “
                           hbalc
                         
                        09/20/2065 
                        
                           6.50
                        ”, “glu 200-265”, “
                           obese
                         
                        older gentleman”, “medications: baclofen, atenolol, lactulose and 
                        
                           lasix
                        ”).

In a number of cases, the system ignored disease mentions in particular. For example, CAD attributes (event, test, mention, and symptom) were much more variable compared to other classes (e.g., hypertension or hyperlipidemia) and a number of mentions were missed as the rules (although the largest in number) were not flexible enough (25 out of 65 cases) or lexical/variation coverage was limited (e.g. unknown abbreviations, 16/65 cases: for example, “3 vessel coronary artery bypass surgery” has appeared in a number of variants, including “3-vessel ca bypass surgery”, “3-v ca bypass surgery” or “3v bypass surgery”). This suggests that an extension of the vocabularies could lead to an improvement towards the system’s performance. Furthermore, some of the rules used enumerations of diseases (e.g., “medical issues include 
                        list-of-diseases”), but the cases where a mention was not recognized (e.g., “diverticulosis”, “seronegative ra”) would trigger a termination of the enumerated list (and thus the end of the rule match) and as a result a number of mentions were missed. Finally, some particular indicators required clinical background knowledge (e.g., “LDL 111” as a high LDL indicator for hyperlipidemia), which was not encoded.

The implementation of the time attribute default values for the medication and disease mentions has also contributed to some FPs and FNs. As expected, due to the application of the default rule (assigning all three time attribute values to disease and medication mentions), we found FP time attribute values for disease mentions only in nine out of 514 notes (1.75%). In addition, for medication mentions, we detected 144 documents containing FPs, resulting in a lower precision for medications (82%) when compared to the other classes. Although we have implemented some exceptions (e.g., “stop drug”, “start on drug”), there were cases where these further required handling medication enumerations (e.g., in “Patient was immediately told to stop both her Roxicet and 
                        Monopril” we correctly time-framed Roxicet but Monopril was on the default rule, making both [Monopril, during DCT] and [Monopril, after DCT] false positives). Still, this approach contributed to the highest recall (97%) for the medication mentions. Overall, the decision to implement default rules for the time attribute appears to be justified. Although the number of errors generated was not large, more sophisticated temporal information [23] could have contributed to the increase of the system’s performance.

While the design and implementation of rule-based systems is known to be time consuming, in this case the whole system was engineered within ∼6weeks FTE (full-time equivalent), with the system fully operational within a month with further tests aiming to improve its efficiency in the remaining time. We have combined different expertise within the team, covering both clinical aspects and text mining experience, which allowed for a rapid domain-driven development of lexicalized rules. We purposely separated designing the common syntactical patterns for the identification of risk factors from the lexical modelling; therefore, the system can be tailored for the recognition of other targeted mentions by providing the necessary vocabularies, possibly from the existing clinical terminologies. Nonetheless, a significant number of rules involved the identification and “interpretation” of specific (measured) indicators (e.g. “LDL 111” is an indicator of high cholesterol); such rules will require redevelopment in case of a new task and potential linking to a clinical knowledge base.

@&#CONCLUSIONS@&#

The objective of the i2b2 2014 task was to recognize heart disease risk factors from clinical narratives of diabetic patients and assign the respective time intervals. In this paper we have described a methodology that is based on local rules lexicalized with extensive vocabularies that represent specific classes. The mention-level results were aggregated at the document level. The time attribute for each class relied on a number of specific default values. The overall performance of 88% F-score suggests that a lexicalized rule-based approach combined with default values can be used to process clinical notes to identify risk factors and monitor progression of heart disease on a large-scale, providing necessary data for clinical and epidemiological studies.

Future work includes the implementation of temporal extraction that will assist in the assignment of time values. Identification of a wider context of a disease or medication mention (e.g. relevant section (history, directions, course of treatment, allergies) and whether the mention refers to an event that is questionable/planned/negated are other areas that can contribute to better system performance. Finally, adding a clinical knowledge base and, in a real-world settings, the use of structured data (e.g. test/laboratory results) that appear in EHRs is a potential approach that can be used for data integration, validation and consolidation.

The resources developed as part of the system are available at http://gnode1.mib.man.ac.uk/tools/i2b2-2014-task2/.

The authors declare no conflict of interest.

@&#ACKNOWLEDGMENTS@&#

This work has been supported by Health e-Research Centre (HeRC), The Christie Hospital NHS Foundation Trust, the Kidscan charity, the Royal Manchester Children’s Hospital and the Serbian Ministry of Education and Science (projects III44006; IIII47003).

@&#REFERENCES@&#

