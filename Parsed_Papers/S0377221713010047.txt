@&#MAIN-TITLE@&#Adjusting a railway timetable in case of partial or complete blockades

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present models to adjust a timetable in case of partial and complete blockades.


                        
                        
                           
                           The integer programming models are solved to optimality.


                        
                        
                           
                           Results on numerical real-world instances are presented.


                        
                        
                           
                           The models offer a trade-off between different objectives of the railway operator.


                        
                        
                           
                           We consider rolling stock rescheduling by including inventory constraints.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Transportation

Railways

Disruption management

Timetabling

Integer programming

@&#ABSTRACT@&#


               
               
                  Unexpected events, such as accidents or track damages, can have a significant impact on the railway system so that trains need to be canceled and delayed. In case of a disruption it is important that dispatchers quickly present a good solution in order to minimize the nuisance for the passengers. In this paper, we focus on adjusting the timetable of a passenger railway operator in case of major disruptions. Both a partial and a complete blockade of a railway line are considered. Given a disrupted infrastructure situation and a forecast of the characteristics of the disruption, our goal is to determine a disposition timetable, specifying which trains will still be operated during the disruption and determining the timetable of these trains. Without explicitly taking the rolling stock rescheduling problem into account, we develop our models such that the probability that feasible solutions to this problem exist, is high. The main objective is to maximize the service level offered to the passengers. We present integer programming formulations and test our models using instances from Netherlands Railways.
               
            

Due to unexpected events, trains do not always run on time. Examples of such events are accidents, rolling stock breakdowns, track damages and bad weather conditions. When a disruption occurs, the timetable, rolling stock schedule and crew roster are not feasible anymore and need to be adjusted. The goal of the models developed in this research is to decide which trains of the normal timetable are still operated during the disruption and to determine the timetable of these trains.

Train delays, such as longer dwell times at stations in peak hours, and large disruptions, such as partial or complete blockades of a track segment, have a different impact on the timetable and require a different solution approach. Literature on disruption management is more scarce than literature on train rescheduling and delay management (see for instance Corman, D’Ariano, Pacciarelli, & Pranzo (2009) and Dollevoet, Huisman, Schmidt, & Schöbel (2012) for models that deal with small timetable deviations). We focus on large disruptions, which we define as the situation in which all or half of the tracks of a segment are blocked for at least one hour. Large disruptions occur on average about three times a day in the Netherlands.

We denote with a complete blockade the situation in which all tracks of a segment are blocked and no trains can be operated on this segment. Trains at either side of the blocked segment need to reverse at a station before the blockade and take over a train in the opposite direction. If only some of the tracks are blocked, the situation is denoted as a partial blockade and limited traffic is still possible. As a consequence of a complete or a partial blockade trains cannot be operated anymore according to the normal timetable and a rescheduled disposition timetable needs to be determined.


                     Jespersen-Groth et al. (2009) describe the general disruption management process of passenger railway transportation companies in Europe. The three main subproblems of the disruption process (timetable adjustment, rolling stock rescheduling and crew rescheduling) are discussed in detail. The current practice at Netherlands Railways, the main passenger railway operator in the Netherlands, is that modifying the timetable, rescheduling the rolling stock and rescheduling the crew are done consecutively. Fig. 1
                      shows a graphical representation of the current solution approach.

Currently, algorithmic support tools to reschedule the rolling stock (Nielsen, 2011) and crew (Potthoff, Huisman, & Desaulniers, 2010) according to the disposition timetable are tested and implemented. Tests with these tools in different settings have shown that they can provide good solutions within a short computation time. The aim of this paper is to develop models for the timetable adjustment. We will compare the results with disruption scenarios that are currently used in practice. Scenarios exist for different segments of the railway network. The scenarios specify which trains are canceled and how the timetable is adjusted accordingly. In general, they do not allow train delays. A scenario exactly corresponding to the disrupted situation can be implemented immediately. However, it is not possible to design a scenario for each potential disruption. Different scenarios may need to be combined or a scenario needs to be adjusted to correspond to the current situation. Hence, the disruption scenarios are not optimal for most situations and we expect that by dynamically computing the disposition timetable the service offered to the passengers during large disruptions can be improved.

The contribution of this paper is fourfold. First, we formulate integer programming models for adjusting a timetable in case of partial and complete blockades. By using these models a trade-off can be made between different objectives of the railway operator, namely canceling and delaying trains. Second, we solve these formulations to optimality and we present numerical results on real-world instances. Third, we show that by delaying some trains with a few minutes, the number of cancelations can be significantly reduced compared to current practice. Finally, we introduce inventory constraints in the model to determine the disposition timetable.

By introducing these inventory constraints, we take the first step towards an alternative solution approach by taking aspects of the rolling stock rescheduling problem into account when determining a disposition timetable. This alternative solution approach is shown in Fig. 2
                     . An advantage of this approach is that modifications to the timetable can already be communicated to the passengers once the basic plan is determined.

The remainder of this paper is organized as follows. Section 2 provides a more detailed description of the problem we consider. Some literature on related topics is discussed in Section 3. In Section 4 the integer programming formulations for a partial blockade and a complete blockade are presented. We test our models using real-world data from NS. The computational results are given in Section 5. Section 6 gives some conclusions and ideas for further research.

The railway disruption process consists of three phases. In the first phase the transition from the normal timetable to the disposition timetable takes place, in phase two the disposition timetable is operated, and phase three is the transition phase from the disposition timetable back to the normal timetable.

Let the utilization of the network be defined as the amount of trains running at a specific moment. Fig. 3
                      shows the utilization of the railway network during the different phases. Before the disruption occurs the utilization is at the normal level. In the first phase the utilization needs to be decreased to attain an utilization level that can be retained during the disruption. During phase two the disposition timetable is operated and, though at a lower level than in the normal timetable, the utilization level is stable again. Phase three covers the recovery from the utilization level of the disposition timetable to the utilization level of the normal timetable.

The first phase is more complex than the third phase because trains start to queue up immediately when a disruption occurs. In the first phase, decisions need to be taken quickly while a high level of uncertainty is involved. Moreover, the decisions taken in this phase can be crucial in the remainder of the disruption process. The transition phase from the disposition timetable back to the normal timetable is relatively easy as more time is available to make the decisions and less uncertainty is involved.

In this research, we focus on the second phase. As input for our models, we use the normal timetable and a forecast of the impact and the duration of the disruption. The output is a disposition timetable, denoting which trains are operated and determining their arrival and departure times.

The type and duration of the disruption are important factors when determining the time horizon and the problem area that we take into account. It involves a trade-off between solution quality and computation time. If the problem area considered is small, feasibility of the timetable outside the problem area is not ensured. However, if the problem area is large, the computation time might be too long. The same reasoning holds for the time horizon. We define a core problem and limit the time horizon and problem area. Note that because of the uncertainty of the duration of the disruption longer time horizons do not yield strictly better solutions. Similarly, because we do not want to deviate too much from the normal schedule, it is not preferred to change the timetable of trains running in another part of the country.

We focus on determining a static disposition timetable for the second phase of the disruption process. The disruption measures we include are canceling trains, delaying trains and reversing trains at stations adjacent to the blockade. These disruption measures influence the order of the trains and the passing times of the trains at the stations. In highly occupied railway networks, such as the Dutch railway network, canceling trains is necessary to obtain a feasible disposition timetable. In case of a complete blockade, we also have to determine at which stations the trains reverse and which trains at these stations are taken over by trains in the opposite direction.

We consider two train types: long distance trains, which stop only at major stations, and regional trains, which stop at all stations. Operating regional trains means that all stations along a route are served on a regular basis. However, long distance trains usually have a larger capacity and long-distance passengers face a large delay if only regional trains are operated. Because we want to distribute the effects of the disruption evenly over the different passenger groups, we aim to operate both long distance and regional trains in the disposition timetable.

In the normal timetable, several train series are operated per hour. Each train series connects an origin station to a destination station with a certain frequency and stopping pattern. We divide train series into train sub series. Each train sub series contains all trains of a train series that run in the same direction and leave the stations at the same minute of every hour (for instance, a train series with two trains per hour in each direction is divided into four train sub series).

We consider canceling train sub series instead of trains, because the former results in a cyclic disposition timetable that is easier to communicate to the passengers. Besides, canceling trains of different train series adds to the complexity of the rolling stock rescheduling problem, because usually the same rolling stock type is used for trains of the same train series. For that reason, we also want to balance the number of trains in each direction. We prefer the situation in which in both directions some trains are canceled to the situation where half of the trains in one direction is canceled and no trains in the other direction are canceled. Moreover, we want to distribute the number of canceled trains in each direction evenly over time.

At the moment the second phase starts only a limited number of rolling stock units are available at the stations. This means that at the start of the planning horizon the number of trains that can leave the station is restricted, and that additional trains can only leave once trains coming from the other direction have arrived. Inventory constraints are formulated to take this into account.

From a practical point of view a solution in which trains run regularly may be required. This means that the time between each pair of two consecutive trains of the same type and in the same direction needs to be equal. The deviations from the normal timetable may be larger, but it results in a disposition timetable that is easy to communicate to the passengers. In Section 4, we present both the standard models for a partial and a complete blockade and the modifications needed to obtain regular disposition timetables. A comparison of the solutions obtained with these models is provided in Section 5.

The main objective of our models is to maximize the service level offered to the passengers. This means minimizing the number of canceled trains and the delays of the operated trains. Besides, passengers prefer a timetable in which the operated trains are distributed evenly over time and in each direction. We use a weighted objective function to take these criteria into account.

@&#LITERATURE REVIEW@&#

In the last decades, the growing demand for passenger railway transportation and the increased level of competition among railway companies have led to more interest in the problem of generating good railway timetables from scratch. We refer to Lusby, Larsen, Ehrgott, and Ryan (2011) and Cacchiani and Toth (2012) for recent surveys on train timetabling problems.


                     Caprara, Fischetti, and Toth (2002) focus on the timetable problem for a single, one-way track linking two major stations, with a number of intermediate stations in between and a timetable that is repeated on a daily basis. They formulate the problem as a directed multigraph and present an arc based multicommodity flow formulation. Based on this, Cacchiani, Caprara, and Toth (2008) present a formulation in which each variable corresponds to a full timetable for a train. Cacchiani, Caprara, and Toth (2010) study the problem of scheduling additional freight trains for a given fixed timetable of passenger trains that cannot be changed.

In most European countries cyclic timetables are operated. In a cyclic timetable a train for a certain destination leaves each station at the same time every hour. The Periodic Event Scheduling Problem (PESP), introduced by Ukovich and Serafini (1989), is generally used to construct cyclic timetables from scratch. Kroon and Peeters (2003) and Liebchen and Möhring (2007) extent the general model with variable trip times, line planning and vehicle scheduling.

PESP models work on a macroscopic level. They focus on the most important properties of the timetable and do not take large amounts of detailed information that is only locally relevant into account. In microscopic models a large number of possible train paths for each train have to be considered simultaneously, which makes such models computationally intractable. Caimi, Chudak, Fuchsberger, Laumanns, and Zenklusen (2011) present a new model for the problem of generating conflict-free timetables on a microscopic level that drastically reduces the computation time for solving such problems to optimality.

Most literature that studies railway timetable rescheduling deals with disturbances that cause (small) delays of several trains in the network. D’Ariano, Corman, Pacciarelli, and Pranzo (2008) and Corman et al. (2009) consider a model which decides on a detailed level about rerouting and reordering of trains when conflicts occur in the timetable. The sequences and routes of trains are consecutively determined by a branch-and-bound and a local search algorithm. In Törnquist and Persson (2007) rescheduling trains during disturbances is considered. The authors take track sections consisting of multiple parallel tracks into account. A MIP formulation is presented that decides about the tracks the trains use and the order of the trains, while minimizing the total final delay.

Delay management models decide about the connections that are maintained in case of small delays. Schöbel (2007) present a graph based integer programming formulation of this problem which minimizes passenger delay. Schachtebeck and Schöbel (2010) include headway and capacity constraints, and use reduction techniques and heuristic solution procedures to solve the model. An extension of the classical delay management model taking re-routing of passengers into account is described in Dollevoet et al. (2012).

The literature on timetable adjustment during large disruptions is limited. The situation of a partial blockade is considered in Brucker, Heitmann, and Knust (2002). A rescheduling problem is presented for the situation where one track of a two track segment is closed due to construction work. Given fixed subsequences of trains for each direction outside the construction site, a polynomial algorithm is used to find a joint feasible sequence. A local search algorithm is used to obtain an optimal schedule for all trains with minimal lateness. However, a model for timetable adjustment in case of partial and complete blockades, which applies both canceling and delaying of trains and takes aspects of the rolling stock rescheduling problem into account has not been considered yet.

In this section we first present the integer programming formulations for a partial blockade and a complete blockade. Next, we describe the modifications that are needed to obtain a regular disposition timetable. The formulations we present in this section consider straight railway lines with trains passing all stations along the line. The model can be applied to more general network topologies if some small adjustments are made.

The model for a partial blockade decides which trains are canceled in case one track of a two track segment is blocked, and how many minutes non-canceled trains are delayed. Two disruption measures are applied: canceling trains and delaying trains. Non-blocked segments can have multiple tracks and we assume that the track allocation of the trains in the disposition timetable is the same as the track allocation in the normal timetable.

We consider a number of stations at each side of the blocked segment. Let the two directions in which the trains can run between these stations be denoted by A and B, and the two stations at the end of the blocked segment by 
                           
                              
                                 
                                    s
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    s
                                 
                                 
                                    B
                                 
                              
                           
                         (station 
                           
                              
                                 
                                    s
                                 
                                 
                                    A
                                 
                              
                           
                         is the first station at the blocked segment trains in direction A pass, and 
                           
                              
                                 
                                    s
                                 
                                 
                                    B
                                 
                              
                           
                         is the first station at the blocked segment trains in direction B pass).

The problem can be formulated using an event-activity network (see Schachtebeck & Schöbel (2010) for an application of such a network in delay management). An event-activity network is a directed graph 
                           
                              N
                              =
                              (
                              E
                              ,
                              A
                              )
                           
                        . The set of events consists of the arrival and departure events of the trains at the stations 
                           
                              e
                              ∈
                              E
                           
                         and of two inventory events 
                           
                              
                                 
                                    I
                                 
                                 
                                    0
                                 
                                 
                                    A
                                 
                              
                           
                         and 
                           
                              
                                 
                                    I
                                 
                                 
                                    0
                                 
                                 
                                    B
                                 
                              
                           
                        , one for each station at the border of the problem area. The inventory events denote the number of trains available at the start of the second phase. The activity types 
                           
                              a
                              ∈
                              A
                           
                         of the network are listed below.
                           
                              •
                              Train activities 
                                    
                                       a
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             train
                                          
                                       
                                    
                                  can either be driving activities between departure events from stations and the arrival events at successor stations, or dwell activities between arrival and departure events at the same station.

Headway activities 
                                    
                                       a
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             head
                                          
                                       
                                    
                                  represent the limited capacity of the track segments and the stations. They model the minimum safety time between two trains running on the same track, either for two trains in the same direction or for two trains in the opposite direction, and the minimum headway time between two trains that dwell at the same platform of a station.

Inventory activities 
                                    
                                       a
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             inv
                                          
                                       
                                    
                                  connect an inventory event with the departure events from this station, and the arrival events of trains at stations at the border of the problem area with the departure events of other trains from the same stations. The former are used to decide for each departing train whether it takes its units from the inventory. The latter determine for each train that arrives at its last station whether it takes over the service of a train in the opposite direction.

An example of an event-activity network for the situation of a partial blockade is shown in Fig. 4
                        . The boxes represent the arrival and departure events and the gray area represents the partially blocked segment. Train activities are represented by solid arcs, headway activities by dashed arcs and inventory activities by dash dotted arcs. For two trains in the same direction, the figure shows only the headway activities at the stations. The headway activities at the track segments are similar. They are defined between two departure or two arrival events. In case the trains use the same track and cannot pass each other, the order in which the trains depart from a station needs to be the same as the order in which they arrive at the successor station.

For each event 
                           
                              e
                              ∈
                              E
                              ,
                              
                                 
                                    q
                                 
                                 
                                    e
                                 
                              
                           
                         denotes the time assigned to event e in the normal timetable and the variable 
                           
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                              
                           
                         the time of event e in the disposition timetable. A maximum on the delay of each event in the disposition timetable is specified by d. The minimum duration of activity 
                           
                              a
                              ∈
                              A
                           
                         is denoted by 
                           
                              
                                 
                                    L
                                 
                                 
                                    a
                                 
                              
                           
                        .

To model the limited track capacity, we use for the headway activities 
                           
                              (
                              e
                              ,
                              f
                              )
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    head
                                 
                              
                           
                         the binary variables
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ef
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   if event
                                                   
                                                   e
                                                   
                                                   takes place before event
                                                   
                                                   f
                                                   ;
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Restricting the number of events and activities in the network can shorten the computation times. In Fig. 4, the trains have both an arrival and a departure event at each station. However, if a train does not have a scheduled stop at a station in the timetable or the dwell time has to be very short (i.e. in the timetable the arrival and departure time at this station are the same), we create only one event at this station. This reduces the number of events in the network considerably. Similarly, we limit the number of activities by only defining headway and inventory activities between two trains that are not too far apart from each other in the normal timetable. Headway activities are defined between two events if the time between these events does not exceed the minimum headway time plus the maximum allowable delay. This means that no headway activities are defined if 
                           
                              d
                              =
                              0
                           
                        . An inventory activity between two trains is defined if the departure time of the departing train plus the maximum allowable delay is at least 
                           
                              
                                 
                                    L
                                 
                                 
                                    a
                                 
                              
                           
                         minutes later than the arrival time of the arriving train, and does not exceed 
                           
                              
                                 
                                    L
                                 
                                 
                                    a
                                 
                              
                              +
                              60
                           
                        . Besides, inventory events are constructed between the inventory event and the departing events of the first two trains of each train sub series.

Next, we introduce the additional notation needed to formulate the problem. The set of train sub series is given by 
                           
                              v
                              ∈
                              V
                           
                         and ordered by increasing departure time of the trains from the first station in the problem area. The train sub series to which event e belongs is denoted by 
                           
                              
                                 
                                    π
                                 
                                 
                                    e
                                 
                              
                              ∈
                              V
                           
                        . We introduce 
                           
                              
                                 
                                    η
                                 
                                 
                                    in
                                 
                              
                              (
                              e
                              )
                           
                         and 
                           
                              
                                 
                                    η
                                 
                                 
                                    out
                                 
                              
                              (
                              e
                              )
                           
                         as the sets of arcs into node e and out of node e. Besides, 
                           
                              V
                              =
                              
                                 
                                    V
                                 
                                 
                                    A
                                 
                              
                              ∪
                              
                                 
                                    V
                                 
                                 
                                    B
                                 
                              
                           
                         with 
                           
                              
                                 
                                    V
                                 
                                 
                                    A
                                 
                              
                           
                         the subset consisting of all train sub series in direction A and 
                           
                              
                                 
                                    V
                                 
                                 
                                    B
                                 
                              
                           
                         the subset consisting of all train sub series in direction B.

To decide whether all or no trains of a train sub series are canceled, we introduce for each train sub series 
                           
                              v
                              ∈
                              V
                           
                         the binary variable
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   if train sub series
                                                   
                                                   v
                                                   
                                                   is canceled;
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

To balance the number of trains in both directions the integer variable 
                           
                              δ
                           
                        , specifying the absolute difference between the number of canceled train sub series in each direction, is used. The variable 
                           
                              μ
                           
                        , specifying the maximum time between two operated trains in the same direction, is used to balance the trains over time. To assign the correct value to this variable, we need for each train sub series the event representing the start of the first train in the problem horizon that belongs to this sub series, denoted by 
                           
                              
                                 
                                    ε
                                 
                                 
                                    v
                                 
                              
                           
                        . Constraints are defined to determine the time between each pair of departing train sub series in the same direction. The integer programming formulation of the event-activity network is presented below.
                           
                              (1)
                              
                                 
                                    min
                                 
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          V
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          ∈
                                          E
                                       
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       e
                                    
                                 
                                 -
                                 
                                    
                                       q
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       3
                                    
                                 
                                 μ
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       4
                                    
                                 
                                 δ
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       x
                                    
                                    
                                       e
                                    
                                 
                                 -
                                 
                                    
                                       q
                                    
                                    
                                       e
                                    
                                 
                                 ⩾
                                 0
                                 
                                 ∀
                                 e
                                 ∈
                                 E
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       x
                                    
                                    
                                       e
                                    
                                 
                                 -
                                 
                                    
                                       q
                                    
                                    
                                       e
                                    
                                 
                                 ⩽
                                 d
                                 
                                 ∀
                                 e
                                 ∈
                                 E
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       x
                                    
                                    
                                       f
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       e
                                    
                                 
                                 ⩾
                                 
                                    
                                       L
                                    
                                    
                                       a
                                    
                                 
                                 
                                 ∀
                                 a
                                 =
                                 (
                                 e
                                 ,
                                 f
                                 )
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       train
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       x
                                    
                                    
                                       f
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       e
                                    
                                 
                                 +
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       λ
                                    
                                    
                                       ef
                                    
                                 
                                 )
                                 ⩾
                                 
                                    
                                       L
                                    
                                    
                                       a
                                    
                                 
                                 
                                 ∀
                                 a
                                 =
                                 (
                                 e
                                 ,
                                 f
                                 )
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       head
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ef
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       fe
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       
                                          
                                             π
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       
                                          
                                             π
                                          
                                          
                                             f
                                          
                                       
                                    
                                 
                                 ⩾
                                 1
                                 
                                 ∀
                                 (
                                 e
                                 ,
                                 f
                                 )
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       head
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             w
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             v
                                          
                                       
                                    
                                 
                                 -
                                 M
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       w
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                   ∈
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   v
                                                   <
                                                   u
                                                   <
                                                   w
                                                
                                             
                                          
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       u
                                    
                                 
                                 )
                                 )
                                 ⩽
                                 μ
                                 
                                 ∀
                                 v
                                 ,
                                 w
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       A
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             w
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             v
                                          
                                       
                                    
                                 
                                 -
                                 M
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       w
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                   ∈
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   v
                                                   <
                                                   u
                                                   <
                                                   w
                                                
                                             
                                          
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       u
                                    
                                 
                                 )
                                 )
                                 ⩽
                                 μ
                                 
                                 ∀
                                 v
                                 ,
                                 w
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       B
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   v
                                                   ∈
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                v
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   v
                                                   ∈
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 δ
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       y
                                    
                                    
                                       v
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 v
                                 ∈
                                 V
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ef
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 (
                                 e
                                 ,
                                 f
                                 )
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       head
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       x
                                    
                                    
                                       e
                                    
                                 
                                 ∈
                                 N
                                 
                                 ∀
                                 e
                                 ∈
                                 E
                              
                           
                        
                        
                           
                              (13)
                              
                                 δ
                                 ,
                                 μ
                                 ∈
                                 N
                              
                           
                        
                     

The objective function (1) is a weighted objective function that minimizes the number of canceled train sub series and the train delays, that balances the number of trains in both directions and that distributes the operated trains evenly over time. Constraints (2) and (3) ensure that the time assigned to an event in the disposition timetable cannot be earlier than the time assigned to it in the normal timetable and that the delay of an event does not exceed the maximum allowable delay. Constraints (4) make sure that the duration of the train activities is respected. Constraints (5) and (6) are the headway constraints. They specify that either at least one of the events has to be canceled, or that one train has to precede the other while respecting the safety time. Constraints (7) and (8) are used to balance the number of non-canceled trains over time, and constraint (9) is used to balance them in each direction.

For constraints (7) and (8) we use the order in which trains depart from the first station in the normal timetable, because this reduces the complexity of the model considerably. In our experiments this order is the same as the order in which the trains depart from the first station in the disposition timetable (only in a few cases, if the track layout allows so, a (fast) long distance train overtakes a (slow) regional train along the way). Because we set a maximum on the delay of each event, the order of two trains can only change if their start times in the normal timetable are close to each other. In general, for such pairs constraints (7) and (8) are non-binding.

Constraint (9) is a non-linear constraint. Because we want to solve an IP model, we replace it by constraints (14) and (15).
                           
                              (14)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                A
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       v
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                B
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       v
                                    
                                 
                                 ⩽
                                 δ
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                B
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       v
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                A
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       v
                                    
                                 
                                 ⩽
                                 δ
                              
                           
                        We add constraints to model (1)–(13) that specify that both long distance and regional trains need to be operated. Let 
                           
                              k
                              ∈
                              K
                           
                         denote the set of train types, and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    v
                                 
                              
                              ∈
                              K
                           
                         the train type of train sub series v. Constraints (16) and (17) describe that in both directions at least one train of each train type is operated per hour.
                           
                              (16)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                A
                                             
                                          
                                          ,
                                          
                                             
                                                σ
                                             
                                             
                                                v
                                             
                                          
                                          =
                                          k
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       v
                                    
                                 
                                 )
                                 ⩾
                                 1
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                B
                                             
                                          
                                          ,
                                          
                                             
                                                σ
                                             
                                             
                                                v
                                             
                                          
                                          =
                                          k
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       v
                                    
                                 
                                 )
                                 ⩾
                                 1
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                              
                           
                        Inventory constraints are defined for the limited number of rolling stock units available at the start of the second phase. The minimum time between an arrival from one direction and a departure in the other direction is denoted by t. Let 
                           
                              
                                 
                                    E
                                 
                                 
                                    orig
                                 
                              
                              ⊂
                              E
                           
                         contain all origin events denoting the departure of trains from the first station in the problem area and 
                           
                              
                                 
                                    E
                                 
                                 
                                    dest
                                 
                              
                              ⊂
                              E
                           
                         all destination events denoting the arrival of trains at the last station in the problem area. A departing train can get its rolling stock either from the inventory or from a train that has arrived at least t minutes before the time this train needs to depart. We introduce for all inventory activities 
                           
                              a
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    inv
                                 
                              
                           
                         the binary variables
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       a
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   if
                                                   
                                                   activity
                                                   
                                                   a
                                                   
                                                   is
                                                   
                                                   canceled
                                                   ;
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Constraints (18)–(21) are the inventory constraints.
                           
                              (18)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          a
                                          ∈
                                          
                                             
                                                η
                                             
                                             
                                                out
                                             
                                          
                                          (
                                          e
                                          )
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 ⩽
                                 
                                    
                                       I
                                    
                                    
                                       0
                                    
                                 
                                 
                                 ∀
                                 e
                                 =
                                 
                                    
                                       I
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          a
                                          ∈
                                          
                                             
                                                η
                                             
                                             
                                                in
                                             
                                          
                                          (
                                          e
                                          )
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 =
                                 1
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       
                                          
                                             π
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                 ∀
                                 e
                                 ∈
                                 
                                    
                                       E
                                    
                                    
                                       orig
                                    
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          a
                                          ∈
                                          
                                             
                                                η
                                             
                                             
                                                out
                                             
                                          
                                          (
                                          e
                                          )
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 ⩽
                                 1
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       
                                          
                                             π
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                 ∀
                                 e
                                 ∈
                                 
                                    
                                       E
                                    
                                    
                                       dest
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       x
                                    
                                    
                                       f
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       e
                                    
                                 
                                 +
                                 
                                    
                                       Mz
                                    
                                    
                                       a
                                    
                                 
                                 ⩾
                                 
                                    
                                       L
                                    
                                    
                                       a
                                    
                                 
                                 
                                 ∀
                                 a
                                 =
                                 (
                                 e
                                 ,
                                 f
                                 )
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       inv
                                    
                                 
                              
                           
                        
                     

Constraints (18) concern the limited start inventories. Constraints (19) connect each departing train either to the inventory or to an arriving train. Constraints (20) specify that each arriving train can take over the service of at most one departing train. The minimum turn around time is modeled by constraints (21). In case of a strict distinction between the rolling stock unit types that can be used for each train type, an inventory event has to be constructed for each train type. These events represent the number of units available for the different train types, and inventory activities are only defined for two trains of the same type.

Note that the inventory constraints and the variables 
                           
                              μ
                           
                         and 
                           
                              δ
                           
                         are not necessary to obtain a feasible disposition timetable but are included to increase the probability that a feasible solution to the rolling stock rescheduling problem exists.

The model presented in this section decides which trains are canceled in case of a complete blockade and determines the delays of the non-canceled trains. In case of a complete blockade no traffic is possible on the blocked segments, and we can consider the situation at each side of the blocked segment separately. Below, the model for side A of the blockade is presented. The model for side B of the blockade is similar.

No traffic is possible on the blocked segment and trains need to reverse at station 
                           
                              
                                 
                                    s
                                 
                                 
                                    A
                                 
                              
                           
                        , the last station before the blockade at side A. We create pairs of trains, each pair containing one train in direction A and one train in direction B. The train in direction A takes over the service of the train in direction B once it has arrived at station 
                           
                              
                                 
                                    s
                                 
                                 
                                    A
                                 
                              
                           
                         and waited at least the minimum turn around time t.

We introduce an additional type of activities as compared to the network presented in the previous section: turn around activities 
                           
                              a
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    turn
                                 
                              
                           
                        . Turn around activities connect two events at the blocked segment. Arcs originate at events that represent an arrival of a train at station 
                           
                              
                                 
                                    s
                                 
                                 
                                    A
                                 
                              
                           
                         and terminate at events that represent a departure of a train from station 
                           
                              
                                 
                                    s
                                 
                                 
                                    A
                                 
                              
                           
                        . Because different rolling stock types are used for long distance and regional trains, trains of one train type can usually not take over the service of a train of a different train type. Therefore, we only define pairs consisting of two trains of the same type.

To obtain a cyclic disposition timetable, we specify turn around activity types. Two turn around activities are of the same type if the trains in direction A belong to the same train sub series and the trains in direction B belong to the same train sub series. Let 
                           
                              w
                              ∈
                              W
                           
                         denote the set of activity types and 
                           
                              
                                 
                                    γ
                                 
                                 
                                    a
                                 
                              
                              ∈
                              W
                           
                         the activity type to which turn around activity a belongs.

Trains that turn around at a station adjacent to the blockade and take over the service of a train in the other direction have to use the same track until the first station at which trains can change track. Let the number of available tracks between this station and the blockade be given by c. To model the limited capacity at the turn around station we define a capacity event 
                           
                              
                                 
                                    I
                                 
                                 
                                    c
                                 
                              
                           
                        , capacity activities 
                           
                              a
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    cap
                                 
                              
                           
                         between this event and the arrival events of trains at the first station at which trains can change track, and capacity activities between two trains in the opposite direction at the first station at which trains can change tracks.

No constraints are added to model the capacity of the stations at the border of the problem area (i.e. the stations at which the inventory activities have to hold). This could be done with constraints similar to the ones described above for the limited capacity of the turn around station but would result in an increase in the size of the event-activity network and computation time. Besides, the limited start inventories and the requirement that trains needs to be balanced equally over time ensure that the number of trains that are at these stations at the same time is limited. Hence, the limited capacity is implicitly taken into account in the model.

An example of an event-activity network for this model is shown in Fig. 5
                        . Station 3 is the last station before the blockade and station 2 is the first station at which trains can change track. The solid arcs represent train activities, the dashed arcs headway activities, the dotted arcs turn around activities, the dash dotted arcs inventory activities, and the dash dot dotted arcs capacity activities. To limit the number of turn around and capacity activities we use rules similar to the ones described in the previous section for the inventory constraints.

A balance in the number of trains in each direction is ensured by the definition of train pairs and does not have to be included in the objective function. As before, the variable 
                           
                              μ
                           
                         denotes the maximum time interval between two trains departing in the same direction. The objective function of the integer programming formulation of the event-activity network for a complete blockade is defined as
                           
                              (22)
                              
                                 
                                    min
                                 
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          w
                                          ∈
                                          W
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       w
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          ∈
                                          E
                                       
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       e
                                    
                                 
                                 -
                                 
                                    
                                       q
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       3
                                    
                                 
                                 μ
                                 .
                              
                           
                        
                     

Constraints similar to constraints (2)–(13) and (16)–(21) are used to define the train, headway and inventory activities, assign the correct value to the parameter 
                           
                              μ
                           
                         and ensure that of each type one train is operated per hour. In addition, we define constraints for the turn around and capacity activities. With 
                           
                              
                                 
                                    E
                                 
                                 
                                    turn
                                 
                              
                              ⊂
                              E
                           
                         we denote all events representing an arrival or a departure at station 
                           
                              
                                 
                                    s
                                 
                                 
                                    A
                                 
                              
                           
                         (in Fig. 5 these are all events at Station 3). To decide which turn around activities are canceled, we use for all turn around activity types 
                           
                              w
                              ∈
                              W
                           
                         the binary variables
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       w
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   if
                                                   
                                                   turn
                                                   
                                                   around
                                                   
                                                   activities
                                                   
                                                   of
                                                   
                                                   type
                                                   
                                                   w
                                                   
                                                   are
                                                   
                                                   canceled
                                                   ;
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Constraints (23) and (24) ensure that each train belongs to at most one operated turn around activity, and constraints (25) concern the minimum time of the turn around activities.
                           
                              (23)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          a
                                          ∈
                                          
                                             
                                                η
                                             
                                             
                                                in
                                             
                                          
                                          (
                                          e
                                          )
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             a
                                          
                                       
                                    
                                 
                                 )
                                 ⩽
                                 1
                                 
                                 ∀
                                 e
                                 ∈
                                 
                                    
                                       E
                                    
                                    
                                       turn
                                    
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          a
                                          ∈
                                          
                                             
                                                η
                                             
                                             
                                                out
                                             
                                          
                                          (
                                          e
                                          )
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             a
                                          
                                       
                                    
                                 
                                 )
                                 ⩽
                                 1
                                 
                                 ∀
                                 e
                                 ∈
                                 
                                    
                                       E
                                    
                                    
                                       turn
                                    
                                 
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       x
                                    
                                    
                                       f
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       e
                                    
                                 
                                 +
                                 
                                    
                                       Mz
                                    
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             a
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       L
                                    
                                    
                                       a
                                    
                                 
                                 
                                 ∀
                                 a
                                 =
                                 (
                                 e
                                 ,
                                 f
                                 )
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       turn
                                    
                                 
                              
                           
                        
                     

The events representing an arrival or departure at the stations at which trains can change track are denoted by 
                           
                              
                                 
                                    E
                                 
                                 
                                    cap
                                 
                              
                              ⊂
                              E
                           
                        . Constraints (26)–(29) are used for the limited capacity at the blocked segment. These constraints are similar to the inventory constraints (18)–(21). At the start of the second phase at most c trains can enter the segments between the station at which trains can change track and the station at the blockade, thereafter trains can only enter when another train has left.
                           
                              (26)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          a
                                          ∈
                                          
                                             
                                                η
                                             
                                             
                                                out
                                             
                                          
                                          (
                                          e
                                          )
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 ⩽
                                 c
                                 
                                 ∀
                                 e
                                 =
                                 
                                    
                                       I
                                    
                                    
                                       c
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          a
                                          ∈
                                          
                                             
                                                η
                                             
                                             
                                                in
                                             
                                          
                                          (
                                          e
                                          )
                                          ∩
                                          
                                             
                                                A
                                             
                                             
                                                cap
                                             
                                          
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 =
                                 1
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       
                                          
                                             π
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                 ∀
                                 e
                                 ∈
                                 
                                    
                                       E
                                    
                                    
                                       cap
                                    
                                 
                              
                           
                        
                        
                           
                              (28)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          a
                                          ∈
                                          
                                             
                                                η
                                             
                                             
                                                out
                                             
                                          
                                          (
                                          e
                                          )
                                          ∩
                                          
                                             
                                                A
                                             
                                             
                                                cap
                                             
                                          
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 ⩽
                                 1
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       
                                          
                                             π
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                 ∀
                                 e
                                 ∈
                                 
                                    
                                       E
                                    
                                    
                                       cap
                                    
                                 
                              
                           
                        
                        
                           
                              (29)
                              
                                 
                                    
                                       x
                                    
                                    
                                       f
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       e
                                    
                                 
                                 +
                                 
                                    
                                       Mz
                                    
                                    
                                       a
                                    
                                 
                                 ⩾
                                 
                                    
                                       L
                                    
                                    
                                       a
                                    
                                 
                                 
                                 ∀
                                 a
                                 =
                                 (
                                 e
                                 ,
                                 f
                                 )
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       cap
                                    
                                 
                              
                           
                        
                     

Good passenger service can also be defined in terms of regular train connections: in both directions regional trains run two, three or four times per hour and pass each station at equal time intervals. To obtain a regular disposition timetable, we do not define a delay for each event but a delay for each train sub series (
                           
                              
                                 
                                    x
                                 
                                 
                                    v
                                 
                              
                           
                        ) and consider only regional trains. Besides, instead of the maximum time between two operated trains in the same direction 
                           
                              μ
                           
                         we use the exact time between each two operated trains 
                           
                              
                                 
                                    μ
                                 
                                 
                                    ‾
                                 
                              
                           
                        . In addition to constraints (7) and (8), the following constraints are added to model (1)–(13) to ensure that the variable 
                           
                              
                                 
                                    μ
                                 
                                 
                                    ‾
                                 
                              
                           
                         takes the correct value.
                           
                              (30)
                              
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             w
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             v
                                          
                                       
                                    
                                 
                                 +
                                 M
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       w
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                   ∈
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   v
                                                   <
                                                   u
                                                   <
                                                   w
                                                
                                             
                                          
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       u
                                    
                                 
                                 )
                                 )
                                 ⩾
                                 
                                    
                                       μ
                                    
                                    
                                       ‾
                                    
                                 
                                 
                                 ∀
                                 v
                                 ,
                                 w
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       A
                                    
                                 
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             w
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             v
                                          
                                       
                                    
                                 
                                 +
                                 M
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       w
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                   ∈
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                                
                                                   v
                                                   <
                                                   u
                                                   <
                                                   w
                                                
                                             
                                          
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       u
                                    
                                 
                                 )
                                 )
                                 ⩾
                                 
                                    
                                       μ
                                    
                                    
                                       ‾
                                    
                                 
                                 
                                 ∀
                                 v
                                 ,
                                 w
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       B
                                    
                                 
                              
                           
                        The model can easily be extended to the case where both long distance and regional trains are operated by defining variables 
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                           
                         for each train type 
                           
                              k
                              ∈
                              K
                           
                        . The main objective of the model is to minimize 
                           
                              
                                 
                                    μ
                                 
                                 
                                    ‾
                                 
                              
                           
                        . The second, less important term in the objective function minimizes the train delays. Minimizing the number of canceled trains and balancing the operated trains in both directions are not included in the objective function. The former is implicitly taken into account by minimizing 
                           
                              
                                 
                                    μ
                                 
                                 
                                    ‾
                                 
                              
                           
                         and by the definition of 
                           
                              
                                 
                                    μ
                                 
                                 
                                    ‾
                                 
                              
                           
                         the difference between the number of operated trains in each direction is always zero.

Regular disposition timetables are easy to communicate to the passengers. However, they deviate more from the normal timetable because only regional trains are operated and delays are penalized less. This has two disadvantages. First, it is more difficult to work with such timetables when we want to take aspects of the rolling stock rescheduling problem into account. Second, the impact of the disruption outside the problem area increases.

We use two real-world cases of NS to test the formulations presented in the previous section. The cases concern track segments in the western part of the Netherlands. Fig. 6
                      shows the stations and junctions that we consider, the tracks between the stations and the important track changes. Case I considers a large disruption on a track segment between stations Rotterdam (Rtd) and Gouda Goverwelle (Gdg) and case II a large disruption on a track segment between stations The Hague (Gvc) and Gouda Goverwelle. For both cases we consider a partial and a complete blockade. The disposition timetable needs to be operated from 16:00hour to 18:00hour on a weekday. In the normal timetables, long distance and regional trains are each operated with a frequency of four trains per hour in both directions. The long distance trains stop only at the major stations (Rtd, Rta, Gvc and Gd), the regional trains also stop at all intermediate stations. For both cases, the number of events in the event-activity network is about 130 for a partial blockade and about 65 for a complete blockade. The number of activities ranges from about 900–2100 and from about 450–2000, depending on the maximum allowable delay (ranging between 0 and 60).

We use a minimum headway time for two trains in the same direction of 2minute, a minimum headway time for two trains in the opposite direction of three minutes and a minimum turn around time of four minutes. Based on several experiments the weights in the objective function are set to 
                        
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           =
                           1
                           ,
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                           =
                           0.001
                           ,
                           
                              
                                 α
                              
                              
                                 3
                              
                           
                           =
                           0.1
                        
                      and 
                        
                           
                              
                                 α
                              
                              
                                 4
                              
                           
                           =
                           0.5
                        
                     . These values resulted in solutions that were most desirable from a practical point of view.

For each case, we first ignore the inventory constraints and show the effect of the maximum allowable delay on the number of trains that can be operated in the disposition timetable and their spread over time. Second, we keep the maximum allowable delay fixed and investigate the effect of the inventory constraints. To evaluate our approach, the solutions are compared with the disruption scenarios that are currently used by NS. CPLEX 12.4 is used to solve the models. We set a time limit of 30minute to solve the IP model.

Consider the situation in which one of the two tracks between Nieuwerkerk (Nwk) and Moordrecht (Mdo) is blocked from 16:00hour to 18:00hour. The disruption scenario that is currently used by NS states that half of the trains is canceled: both long distance and regional trains are operated with a frequency of two trains per hour in each direction. The maximum time between two trains in the same direction is 26minute. The disposition timetable is shown as a time–space diagram in Fig. 7
                           . The horizontal axis represents the time and the vertical axis represents the stations. The gray area between stations Nieuwerkerk and Moordrecht denotes the disrupted track segments and the lines represent the trains that are operated: black lines represent long distance trains and gray lines regional trains.

The disposition timetable computed by our model with the maximum allowable delay equal to zero has the same characteristics as the disposition timetable defined by the disruption scenario. At first, we do not take the inventory constraints into account. If we allow trains to be delayed, it is possible to increase the number of trains that can be operated. Table 1
                            shows for different values of the maximum allowable delay the number of operated train sub series in each direction and in total per hour, the percentage of operated events that is delayed, the average delay of these events, the maximum interval between two operated trains in the same direction, the optimal solutions of the LP-relaxation and the IP model, and the computation time of the IP model. For increasing maximum allowable delay the number of train sub series that can be operated increases, the optimal solution values of the LP and IP models decrease, and the computation time increases. The increase in computation time can be explained by an increase in the size of the problem. Compared to the model without delays, the number of variables is about fifty percent higher and the number of constraints has almost tripled for the model with a maximum delay of 60minute.

To be able to operate one additional train sub series a delay of four minutes is needed for some events. By delaying half of the long distance trains with five minutes it is possible to operate all long distance trains and half of the regional trains in each direction, see Fig. 8
                           . This solution is an improvement over the disposition timetable of Fig. 7 from the point of view that the maximum time between two trains in the same direction (
                              
                                 μ
                              
                           ) is decreased from 26 to 16minute. About one quarter of the events is delayed, but on average only with 3.3minute which seems acceptable. If we increase the maximum allowable delay to 15minute it is possible to operate all train sub series. However, this requires that several trains in one direction are operated shortly after each other and results in an increase in μ. Hence, this solution is not preferred from an operational point of view. Increasing the maximum allowable delay even further does not result in better solutions, because in the normal timetable both long distance and regional trains are operated every 15minute. The computation times of all instances are within a few minutes.

A start inventory of more than four units at station Rotterdam and more than two units at station Gouda Goverwelle at the start of phase two is unlikely. Table 2
                            shows the number of operated train sub series, the maximum interval between two operated trains in the same direction, the optimal solution value of the IP model, and the computation time of the IP model for smaller start inventories with a maximum allowable delay of zero. If the start inventories are not sufficient, the disposition timetable of Fig. 7 is not feasible, and a disposition timetable in which less train sub series are operated or which is less regular, is obtained. A total start inventory of one or two units is only possible if the constraints which state that of each train type at least one train should be operated in each direction is relaxed.


                           Table 3
                            shows how the complexity increases for longer durations of the disruption. The first column shows the time horizon of the blockade. The second column shows the number of trains that is operated in the normal timetable. The computation times of the IP model with a maximum allowable delay of 15minute are shown in the last column. Even if the blockade lasts for almost a full day, the optimal IP solution can be found within one minute. The solutions of all instances are the same (see the solution with maximum delay 15 in Table 1).

In the regular disposition timetable all regional trains are operated. Hence, the total number of operated train sub series is eight, four in direction A and four in direction B, and the time interval between each two trains is 15minute. To obtain this timetable only a slight modification is needed: in direction A the trains run according to the normal timetable, in direction B they are delayed with one minute. Whether the regular timetable is preferred to the timetable of Fig. 8 needs to be judged by the dispatchers. For all regular disposition timetables presented in this section, the computation time is less than one second.

We consider a partial blockade between stations Zoetermeer (Ztmo) and Moordrecht (Mdaz) for two hours. In the disposition timetable defined by the disruption scenario that is currently used by NS, two regional trains are operated per hour in each direction, with a maximum time between two trains of 45minute. In the solution computed by our model (allowing no delays and without inventory constraints) in both directions one additional long distance train can be operated per hour. Although the number of operated train sub series increases, the maximum time between two trains in the same direction does not decrease.


                           Table 4
                            shows the characteristics of the disposition timetables for different values of the maximum allowable delay. Four trains need to be delayed with five minutes to operate one additional train sub series in each direction. In this solution, passengers still may need to wait more than half an hour for the next train. To get a solution in which the operated trains are more evenly distributed over time, the maximum delay has to be increased to ten minutes. In both directions, every half an hour a regional and a long distance train are operated. As for Case I, higher values of the maximum allowable delay result in an increase in the number of train sub series that can be operated, but induce large train delays and in each direction all trains being operated one after another.

The instances with the largest maximum delay value could not be solved to optimality within the time limit. For these instances, Table 4 shows the best IP solution that was found after 30minute and the optimality gap of the IP model. Because in the Netherlands intercity and regional trains are usually operated with a frequency of 15 or 30minute, solving instances with a maximum allowable delay of more than 30minute is not interesting from a practical point of view. For this case, all instances with a maximum allowable delay up to 30minute could be solved within 3minute.

To operate the timetable defined by the disruption scenarios, the start inventory at The Hague should be at least three units, and the start inventory at Gouda Goverwelle should be at least one unit. In some situations the available start inventories can be insufficient. A disposition timetable with one long distance and one regional train per hour is possible, if there is a start inventory of two units at both stations. With smaller start inventories, the constraints that at least one long distance and one regional train need to be operated per hour cannot be satisfied.

In the regular disposition timetable three train sub series are operated in each direction, with 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       ‾
                                    
                                 
                              
                            equal to twenty. The trains in direction A are delayed with zero, five and ten minutes, the train in direction B with two, seven and twelve minutes. Of the operated events, 83% is delayed with on average 7.2minute which means that the deviations from the normal timetable are larger.

If both tracks between Nieuwerkerk and Moordrecht are blocked, trains can drive up to the stations adjacent to the blockade, turn around and take over the service of a train in the other direction. For this case we only present the solution at side A of the blockade because in the disruption scenario for side B the long distance trains are either canceled or rerouted via The Hague. As rerouting is not a disruption measure that is included in our model, we are not able to compare the solutions. Fig. 6 shows that at side A of the blockade the trains can change track at station Rotterdam Alexander, at which two tracks are available. Buses are operated between Rotterdam Alexander and Gouda to transport the passengers that want to travel further than the blocked segment.

According to the disruption scenario used by NS, two regional trains are operated between Rotterdam and Nieuwerkerk, with a maximum interval of thirty minutes (see Fig. 9
                           ). In the disposition timetable computed by our model without delays and inventory constraints two pairs consisting of long distance trains and one pair consisting of regional trains are operated per hour. The number of operated pairs increases from two to three, but the maximum interval does not decrease.

The results for the situation of a complete blockade are shown in Table 5
                           . For different maximum delay values it shows the number of operated pairs per hour, the percentage of delayed events, the average delay of the delayed events, the maximum interval between two operated trains in the same direction, the solutions of the LP-relaxation and the IP model, and the computation time. For better interpretation of the results we present the objective values in terms of the number of canceled train sub series. By delaying the long distance trains with one minute the number of operated pairs can be increased to four: two pairs consisting of long distance trains and two pairs consisting of regional trains, see Fig. 10
                           . Increasing the maximum delay to ten minutes, the number of operated pairs can be increased to five and the maximum interval is reduced to 14minute. The computation times of the instances with a maximum allowable delay up to 30minute are again small. Note that because of the additional capacity restrictions as compared to the model for a partial blockade, it is not possible to operate all trains of the normal timetable, even not when a 60minute delay is allowed.

To be able to operate the timetable with one minute delay, the start inventory at Rotterdam has to be at least four. Table 6
                            shows the characteristics of the disposition timetable for smaller start inventories if the maximum allowable delay is one minute. The table shows that every one unit decrease of the start inventory has an immediate effect on the number of pairs that can be operated.


                           Table 7
                            shows the computation times for of the model for instances with longer time horizons, and hence larger number of trains that are operated in the normal timetable. For all these instances, the computation times are small.

In the regular disposition timetable all regional trains are operated, the trains in direction A with a delay of two minutes. Hence, the total number of pairs is equal to the number operated in the disposition timetable with maximum one minute delay (Fig. 10) and the interval between two trains is only 15minute. Because the trains are only operated over a short distance, the fact that no long distance trains are operated might not be a disadvantage.

For the same reason as for Case I, we only present the model at side A of the blockade. Fig. 6 shows that trains can change track at Ypenburg (Ypb), at which two tracks are available, and that trains need to turn around at station Zoetermeer. In the disposition timetable defined by the disruption scenario of NS two pairs consisting of regional trains are operated per hour. Our model without delays and no inventory constraints results in a disposition timetable in which two pairs consisting of long distance trains and one pair consisting of regional trains are operated.


                           Table 8
                            shows that for small delay values the number of operated pairs cannot be increased. We have omitted the results of the instances with larger delay values because these results are similar to the results for Case I. All instances with maximum delay of up to 15 could be solved within one second, and all instances with maximum 30minute delay within one minute. In the regular disposition timetable four pairs of regional trains are operated. The delays of the trains in direction A is six minutes.

In this research, we consider the problem of adjusting a railway timetable in case of large disruptions. We present integer programming formulations based on event-activity networks for the situations of a partial and a complete blockade. The disruption measures we include to convert the normal timetable into a disposition timetable are delaying trains, canceling trains and reversing trains at stations adjacent to the blockade. The models determine which trains need to be canceled and define the disposition timetable of the trains that are not canceled. Besides, we present how the models can be modified in case a regular disposition timetable is preferred.

Two real-world cases of NS are used to test our models. The results show a balance between the number of trains that can be operated in the disposition timetable and the maximum delay that is allowed. Besides, we show the effect of limited start inventories on the number of trains that can be operated. By presenting also the regular disposition timetable, a trade-off is offered between a disposition timetable that is more regular or one that deviates less from the normal timetable. For all instances, the time needed to compute the disposition timetable is at most a few seconds, which is acceptable in realtime disruption management.

We propose some directions for further research. In our models, we take some aspects of the rolling stock rescheduling problem into account by canceling all trains that belong to the same train sub series, by defining inventory constraints, and by balancing the number of trains in each direction and over time. It has to be investigated whether a further integration of the rolling stock rescheduling problem is possible and whether the most important aspects of the crew rescheduling problem can be taken into account as well.

In this research, we present models for the second phase of the disruption management process in which the disposition timetable is operated. A possible extension is to take other disruption measures, such as rerouting of trains, into account. Moreover, the model can be extended to cover also the first and third phase of the disruption process.

The results in the previous section show that for the two cases presented the computation time is small. However, for more complex cases or when we extend the model the computations times can increase considerably and can be too long to be acceptable in realtime disruption management. Therefore, as a final direction of further research, we propose to consider other solution methods.

@&#REFERENCES@&#

