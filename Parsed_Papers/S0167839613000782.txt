@&#MAIN-TITLE@&#Modified T-splines

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a variant of T-splines called Modified T-splines. A set of basis functions are constructed for a given T-mesh.


                        
                        
                           
                           These bases have nice properties: non-negativity, linear independence, partition of unity and compact support.


                        
                        
                           
                           Modified T-splines are favorable both in adaptive geometric modeling and isogeometric analysis.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

T-mesh

T-spline

Knot deletion

Surface fitting

Surface simplification

@&#ABSTRACT@&#


               
               
                  T-splines are a generalization of NURBS surfaces, the control meshes of which allow T-junctions. T-splines can significantly reduce the number of superfluous control points in NURBS surfaces, and provide valuable operations such as local refinement and merging of several B-splines surfaces in a consistent framework. In this paper, we propose a variant of T-splines called Modified T-splines. The basic idea is to construct a set of basis functions for a given T-mesh that have the following nice properties: non-negativity, linear independence, partition of unity and compact support. Due to the good properties of the basis functions, the Modified T-splines are favorable both in adaptive geometric modeling and isogeometric analysis.
               
            

@&#INTRODUCTION@&#

T-splines were introduced by Sederberg et al. (2003, 2004) and have been studied extensively in the last ten years. T-splines are a generalization of NURBS surfaces, the control meshes of which permit T-junctions. Unlike NURBS, T-junctions allow T-splines to be locally refinable without propagating entire columns or rows. This property makes T-splines an ideal technology for removing superfluous control points in NURBS surfaces and for adaptive isogeometric analysis (Hughes et al., 2005; Cottrell et al., 2009). Initial investigations using T-splines as a basis for isogeometric analysis demonstrate that T-splines possess similar convergence properties as NURBS with far fewer degrees of freedom (Dörfel et al., 2009; Bazilevs et al., 2010). However, the blending functions of T-splines are not always linearly independent. Buffa et al. (2010) gave an example of a T-spline with linearly dependent blending functions. This causes concerns about the linear independence of T-splines. A solution to this problem is the so-called analysis-suitable T-splines (AST-splines for short) (Li et al., 2012; Scott et al., 2012). AST-splines are a subset of T-splines defined over a restricted T-mesh whose T-junction extensions do not intersect, and the blending functions are always linearly independent and thus are suitable for isogeometric analysis. However, the topology of the meshes of AST-splines is relatively restrict. For example, the mesh for common local refinement in isogeometric analysis as shown in Fig. 1
                      is not an AST-mesh. Algorithm exists for modifying a non-AST-mesh into an AST-mesh (Scott et al., 2012).

In Deng et al. (2008), the authors introduced the concept of splines over T-meshes, and specifically PHT-splines were proposed. PHT-splines are polynomial splines defined over a hierarchical T-mesh, and the basis functions of PHT-splines are linearly independent, form a partition of unity and have compact supports. The local refinement algorithm of PHT-splines is local and very simple. Furthermore, since a PHT-spline is a polynomial (instead of a piecewise polynomial) over each cell of the T-mesh, it holds a good approximation property. These properties make PHT-splines an ideal tool for isogeometric analysis (Nguyen-Thanh et al., 2011a, 2011b). However, PHT-splines are only 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      continuous, which is a disadvantage for geometric modeling.

Another type of local refinement splines is LR-splines introduced by Dokken et al. (2013). LR-splines are defined on a μ-extended LR-mesh which is constructed by inserting line segments starting from a tensor product mesh according to certain rules. LR-spline also forms a non-negative partition of unity and spans the complete piecewise polynomial space on the mesh when the mesh construction follows certain rules. Different strategies can be employed to construct linearly independent LR B-splines by mesh modification. However, unlike T-splines and tensor product B-splines, there is no one-to-one correspondence between the 3D control mesh and the LR B-spline functions.

Hierarchical B-splines were introduced by Forsey and Bartels (1988), which have been recently further elaborated by Giannelli et al. (2012). The idea is to suitably truncate hierarchical B-spline functions according to finer levels in the hierarchy, which are called THB-splines. A THB-spline is a linear combination of B-splines, and THB-splines form a partition of unity and are linearly independent.

In this paper, we introduce a new type of local refinement splines called Modified T-splines, which inherit some good properties of the above splines while preventing some undesirable properties. The intuitive idea is to construct a set of basis functions which have good properties, such as non-negativity, partition of unity, linear independence and compact support. With the help of an auxiliary T-mesh 
                        
                           
                              T
                           
                           
                              ′
                           
                        
                      (defined in Lemma 3.2), the basis functions are constructed as a linear combination of T-splines defined over 
                        
                           
                              T
                           
                           
                              ′
                           
                        
                     . In this sense, Modified T-splines have some similarity with THB-splines.

The remainder of the current paper is organized as follows. In Section 2, we recall some preliminary knowledge about knot deletion of B-splines and T-splines. In Section 3, the construction details of Modified T-splines are described, and some properties, especially approximation property of Modified T-splines are discussed. Section 4 demonstrates some applications of Modified T-splines in surface fitting. Section 5 concludes the paper with a summary and future work.

In this section, we recall some preliminary knowledge about knot deletion of B-splines in one dimension which is useful in the construction of Modified T-splines. Then the basic concepts about T-meshes and T-splines are reviewed.

For simplicity, we only consider degree one and degree three B-splines for illustration.

Given a knot vector 
                           t
                           =
                           [
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           ]
                         with 
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           ⩽
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ⩽
                           ⋯
                           ⩽
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                        , the associated B-spline basis functions are defined recursively as follows
                           
                              (1)
                              
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                             ,
                                          
                                          
                                             t
                                             ∈
                                             [
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             )
                                             ,
                                          
                                       
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             otherwise
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       t
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             k
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             k
                                             +
                                             1
                                          
                                       
                                       −
                                       t
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             k
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 
                                 k
                                 ⩾
                                 1
                                 .
                              
                           
                        
                     

We use 
                           
                              
                                 N
                              
                              
                                 1
                              
                           
                           [
                           
                              
                                 t
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           ]
                           (
                           t
                           )
                         to denote the degree one B-spline basis function 
                           
                              
                                 N
                              
                              
                                 i
                                 −
                                 1
                              
                              
                                 1
                              
                           
                           (
                           t
                           )
                         and call it the linear B-spline basis function at knot 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                        . Similarly, for cubic B-spline functions, 
                           
                              
                                 N
                              
                              
                                 3
                              
                           
                           [
                           
                              
                                 t
                              
                              
                                 i
                                 −
                                 2
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 i
                                 +
                                 2
                              
                           
                           ]
                           (
                           t
                           )
                           =
                           
                              
                                 N
                              
                              
                                 i
                                 −
                                 2
                              
                              
                                 3
                              
                           
                           (
                           t
                           )
                         is called the cubic B-spline basis function at knot 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                        .

Now insert a knot 
                           
                              t
                              ˆ
                           
                         into the knot vector t to get a new knot vector 
                           
                              t
                              ˜
                           
                        . Without loss of generality, we assume 
                           
                              t
                              ˆ
                           
                           ∈
                           [
                           
                              
                                 t
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 4
                              
                           
                           )
                        . Then the B-spline basis functions associated with t either can be written as a linear combination of the B-spline basis functions associated with 
                           
                              t
                              ˜
                           
                         or remain unchanged. The relationship between these basis functions can be written as
                           
                              (3)
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   1
                                                
                                             
                                             [
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   4
                                                
                                             
                                             ]
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   1
                                                
                                             
                                             [
                                             
                                                
                                                   t
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   4
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   5
                                                
                                             
                                             ]
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   −
                                                   
                                                      t
                                                      ˆ
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   
                                                      t
                                                      ˆ
                                                   
                                                   −
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   1
                                                
                                             
                                             [
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                t
                                                ˆ
                                             
                                             ]
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   1
                                                
                                             
                                             [
                                             
                                                
                                                   t
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                t
                                                ˆ
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   4
                                                
                                             
                                             ]
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   1
                                                
                                             
                                             [
                                             
                                                t
                                                ˆ
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   4
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   5
                                                
                                             
                                             ]
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   3
                                                
                                             
                                             [
                                             
                                                
                                                   t
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   4
                                                
                                             
                                             ]
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   3
                                                
                                             
                                             [
                                             
                                                
                                                   t
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   4
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   5
                                                
                                             
                                             ]
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   3
                                                
                                             
                                             [
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   4
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   5
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   6
                                                
                                             
                                             ]
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   3
                                                
                                             
                                             [
                                             
                                                
                                                   t
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   4
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   5
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   6
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   7
                                                
                                             
                                             ]
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   −
                                                   
                                                      t
                                                      ˆ
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   
                                                      t
                                                      ˆ
                                                   
                                                   −
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         5
                                                      
                                                   
                                                   −
                                                   
                                                      t
                                                      ˆ
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         5
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   
                                                      t
                                                      ˆ
                                                   
                                                   −
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         5
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                   −
                                                   
                                                      t
                                                      ˆ
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   
                                                      t
                                                      ˆ
                                                   
                                                   −
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   3
                                                
                                             
                                             [
                                             
                                                
                                                   t
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                t
                                                ˆ
                                             
                                             ]
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   3
                                                
                                             
                                             [
                                             
                                                
                                                   t
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                t
                                                ˆ
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   4
                                                
                                             
                                             ]
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   3
                                                
                                             
                                             [
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                t
                                                ˆ
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   4
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   5
                                                
                                             
                                             ]
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   3
                                                
                                             
                                             [
                                             
                                                
                                                   t
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                t
                                                ˆ
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   4
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   5
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   6
                                                
                                             
                                             ]
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   3
                                                
                                             
                                             [
                                             
                                                t
                                                ˆ
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   4
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   5
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   6
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   7
                                                
                                             
                                             ]
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

Alternatively, the knot vector t can be considered as deleting a knot 
                           
                              t
                              ˆ
                           
                         from the knot vector 
                           
                              t
                              ˜
                           
                        . After knot deletion, the B-spline basis function at 
                           
                              t
                              ˆ
                           
                         is distributed to the B-spline basis functions at the neighboring knots of 
                           
                              t
                              ˆ
                           
                        . The distribution process is demonstrated in Fig. 2
                        . Fig. 2(a) illustrates the distribution process of degree one B-splines for knot deletion. The B-spline basis function at knot 
                           
                              t
                              ˆ
                           
                         is distributed to the B-spline basis functions at the knots 
                           
                              
                                 t
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 4
                              
                           
                         with a ratio of μ and 
                           1
                           −
                           μ
                         respectively, where 
                           μ
                           =
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       4
                                    
                                 
                                 −
                                 
                                    t
                                    ˆ
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       4
                                    
                                 
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       3
                                    
                                 
                              
                           
                        . Fig. 2(b) shows the distribution process of cubic B-splines. There are two levels of distribution in this case. The distribution indicated by the orange arrows is firstly carried out. Then the distribution indicated by the purple arrows is performed, where the distribution coefficients are 
                           α
                           =
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       4
                                    
                                 
                                 −
                                 
                                    t
                                    ˆ
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       4
                                    
                                 
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                              
                           
                        , 
                           β
                           =
                           
                              
                                 
                                    t
                                    ˆ
                                 
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       3
                                    
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       6
                                    
                                 
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       3
                                    
                                 
                              
                           
                         and 
                           λ
                           =
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       5
                                    
                                 
                                 −
                                 
                                    t
                                    ˆ
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       5
                                    
                                 
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        .

Note that the coefficient matrices in formulas (3) and (4) have the following nice properties: the column sums of each matrix are equal to one, the elements of each matrix are non-negative and each matrix has full rank. These properties induce the following important result.


                        
                           Lemma 2.1
                           
                              Let 
                              
                                 
                                    
                                       {
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                               
                              be a set of non-negative and linearly independent B-spline functions which are assumed to form a partition of unity in the defined domain 
                              
                                 D
                                 ,
                                 D
                                 ⊆
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                              
                              . Let 
                              
                                 
                                    
                                       {
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                       
                                       }
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                               
                              be a set of functions, each of which is a linear combination of 
                              
                                 
                                    
                                       {
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                              
                              , or in matrix form
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       M
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                               
                              where M is an 
                              
                                 n
                                 ×
                                 m
                               
                              matrix with 
                              
                                 n
                                 <
                                 m
                              
                              . If the matrix M has full rank, then 
                              
                                 
                                    
                                       {
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                       
                                       }
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                               
                              are linearly independent. Furthermore, if the column sums of M are all equal to one and the elements of M are all non-negative, then 
                              
                                 
                                    
                                       {
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                       
                                       }
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                               
                              are non-negative and form a partition of unity over D.
                           


                        
                           Proof
                           Suppose there exist constants 
                                 
                                    
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                               such that
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             n
                                          
                                       
                                       )
                                       
                                          
                                             (
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   B
                                                
                                                
                                                   n
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       ≡
                                       0
                                       .
                                    
                                 
                               Since 
                                 
                                    
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 M
                                 
                                    
                                       (
                                       
                                          
                                             N
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             N
                                          
                                          
                                             m
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                              , then
                                 
                                    
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             n
                                          
                                       
                                       )
                                       M
                                       
                                          
                                             (
                                             
                                                
                                                   N
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   N
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       =
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             d
                                          
                                          
                                             m
                                          
                                       
                                       )
                                       
                                          
                                             (
                                             
                                                
                                                   N
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   N
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       ≡
                                       0
                                       ,
                                    
                                 
                               where 
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       m
                                    
                                 
                                 )
                                 =
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 M
                              . Because of the linear independence of 
                                 
                                    
                                       {
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                              , we have 
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                              , 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 m
                              . Therefore 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                              , 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              , follows as the matrix M has full rank.

For the next part, notice that
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       (
                                       1
                                       ,
                                       …
                                       ,
                                       1
                                       )
                                       
                                          
                                             (
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   B
                                                
                                                
                                                   n
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       =
                                       (
                                       1
                                       ,
                                       …
                                       ,
                                       1
                                       )
                                       M
                                       
                                          
                                             (
                                             
                                                
                                                   N
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   N
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       .
                                    
                                 
                               Since the column sums of the matrix M are all one, 
                                 (
                                 1
                                 ,
                                 …
                                 ,
                                 1
                                 )
                                 M
                                 =
                                 (
                                 1
                                 ,
                                 …
                                 ,
                                 1
                                 )
                              . Therefore
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       (
                                       1
                                       ,
                                       …
                                       ,
                                       1
                                       )
                                       
                                          
                                             (
                                             
                                                
                                                   N
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   N
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                       ≡
                                       1
                                       .
                                    
                                 
                              
                           

The non-negativity of 
                                 
                                    
                                       {
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                       
                                       }
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                               is obviously true. The lemma is thus proved. □

A T-mesh is a rectangular grid that allows T-junctions. It is assumed that the end points of each grid line in the T-mesh must be on two other grid lines and each cell or facet in the grid must be a rectangle. If a T-junction on one edge of a face can be connected to a T-junction on an opposing edge of the face thereby splitting the face into two rectangles, that edge must be included in the T-mesh. Fig. 3
                        (a) illustrates a T-mesh while the mesh in Fig. 3(b) is not a T-mesh. A T-mesh can lie either in a 2D plane or in a 3D space. Generally, a 2D T-mesh is served as the parametric space of T-splines while a 3D T-mesh is served as the control grid of T-splines. For a 3D T-mesh, each facet doesnʼt have to be a rectangle or planar.

A grid point in a T-mesh is called a vertex of the T-mesh. If the vertex is on the boundary grid line, then it is called a boundary vertex, otherwise it is called an interior vertex. For example, 
                           
                              
                                 b
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 b
                              
                              
                                 12
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 13
                              
                           
                         in Fig. 3(a) are boundary vertices, while 
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 v
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 5
                              
                           
                         are interior vertices. Interior vertices have two types: one is crossing vertices, for example, 
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 5
                              
                           
                         in Fig. 3(a); and the other one is T-vertices, for example, 
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 4
                              
                           
                         in Fig. 3(a). T-vertices are classified into two classes: horizontal T-vertices, for example, 
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                         in Fig. 3(a) and vertical T-vertices, for example, 
                           
                              
                                 v
                              
                              
                                 4
                              
                           
                         in Fig. 3(a).

A T-vertex can be extended by inserting edges starting from this T-vertex, in the direction of a missing edge. A T-vertex can be extended as far as to the mesh boundary. All the edges created by such extension are called T-vertex extensions. Fig. 4
                         shows an example where dotted purple line segments are T-vertex extensions. For a given T-mesh T, let 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                         be the new mesh produced by some T-vertex extensions. Those vertices produced by the T-vertex extensions are called new vertices relative to the mesh T, that is, new vertices are the vertices that are in 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                         but not in the origin mesh T. The vertices in T are called old vertices. There are three types of new vertices: one is H-type, if the new vertex is produced by the extension of horizontal T-vertex; one is V-type, if the new vertex is produced by the extension of vertical T-vertex; the last one is C-type, if the new vertex is produced by both extensions of horizontal T-vertex and vertical T-vertex. As illustrated in Fig. 4, A is H-type produced by 
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                        , B is V-type produced by 
                           
                              
                                 v
                              
                              
                                 4
                              
                           
                         and C is C-type produced by 
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 v
                              
                              
                                 3
                              
                           
                        .

Alternatively, one can delete vertices from a T-mesh to create a new T-mesh. When a vertex is deleted, we mean the edges connecting the vertex in a specific direction are also deleted. This will be made clear in later context.

Given a control T-mesh in 3D space with control points 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                        , a T-spline is defined as
                           
                              (5)
                              
                                 T
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                 
                                 ,
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 ∈
                                 Ω
                                 ,
                              
                           
                         where 
                           
                              
                                 T
                              
                              
                                 i
                              
                           
                           (
                           s
                           ,
                           t
                           )
                         is the blending function
                           
                              (6)
                              
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 s
                                 )
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 t
                                 )
                              
                           
                         with 
                           
                              
                                 N
                              
                              
                                 i
                              
                              
                                 3
                              
                           
                           (
                           s
                           )
                        , 
                           
                              
                                 N
                              
                              
                                 i
                              
                              
                                 3
                              
                           
                           (
                           t
                           )
                         being the cubic B-spline basis functions associated with two local knot vectors 
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                         respectively. The two local knot vectors 
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                         come from two global knot vectors 
                           s
                           =
                           [
                           
                              
                                 s
                              
                              
                                 −
                                 2
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 s
                              
                              
                                 p
                                 +
                                 2
                              
                           
                           ]
                         and 
                           t
                           =
                           [
                           
                              
                                 t
                              
                              
                                 −
                                 2
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 q
                                 +
                                 2
                              
                           
                           ]
                         which are inferred from the control T-mesh. Let T be the preimage of the control mesh, which is a T-mesh in 2D parametric space. Ω is the 2D rectangular domain that is occupied by T.

To each control point 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         corresponds a blending function 
                           
                              
                                 T
                              
                              
                                 i
                              
                           
                           (
                           s
                           ,
                           t
                           )
                           =
                           
                              
                                 N
                              
                              
                                 i
                              
                              
                                 3
                              
                           
                           (
                           s
                           )
                           
                              
                                 N
                              
                              
                                 i
                              
                              
                                 3
                              
                           
                           (
                           t
                           )
                         defined in terms of knot vectors 
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                           =
                           [
                           
                              
                                 s
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       4
                                    
                                 
                              
                           
                           ]
                         and 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           =
                           [
                           
                              
                                 t
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       4
                                    
                                 
                              
                           
                           ]
                        . The local knot vectors 
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                         are inferred as follows. Assume that the parameter coordinates of the preimage 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                         of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         are 
                           (
                           
                              
                                 s
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           )
                        . The knots 
                           
                              
                                 s
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                              
                           
                         and 
                           
                              
                                 s
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       4
                                    
                                 
                              
                           
                         are found by considering a ray in parameter space 
                           R
                           (
                           α
                           )
                           =
                           (
                           
                              
                                 s
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           +
                           α
                           ,
                           
                              
                                 t
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           )
                        . Then 
                           
                              
                                 s
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                              
                           
                         and 
                           
                              
                                 s
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       4
                                    
                                 
                              
                           
                         are the s coordinates of the first two vertical edges (which are called s-edges) intersected by the ray (not including the initial 
                           (
                           
                              
                                 s
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           )
                        ). The other knots in 
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                         are found in like manner. For the details, the reader is referred to Sederberg et al. (2003).


                        Figs. 5
                        (a) and (b) illustrate a T-mesh in 
                           (
                           s
                           ,
                           t
                           )
                         parameter space. For the vertex 
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                        , the associated knot vectors are 
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           =
                           [
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 6
                              
                           
                           ]
                         and 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           =
                           [
                           
                              
                                 t
                              
                              
                                 6
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 8
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 9
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 10
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 12
                              
                           
                           ]
                        ; likewise for 
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 s
                              
                              
                                 2
                              
                           
                           =
                           [
                           
                              
                                 s
                              
                              
                                 5
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 6
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 8
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 10
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 12
                              
                           
                           ]
                         and 
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                           =
                           [
                           
                              
                                 t
                              
                              
                                 5
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 6
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 8
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 10
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 12
                              
                           
                           ]
                        .

Specifically, when the control T-mesh is a tensor product mesh, T-splines reduce to tensor product B-splines.

Note that the blending functions of T-splines may be linearly dependent, and they generally do not form a partition of unity, i.e., 
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                           
                              
                                 T
                              
                              
                                 i
                              
                           
                           (
                           s
                           ,
                           t
                           )
                           ≢
                           1
                         (see Fig. 5(c)). However, by imposing some conditions on the T-mesh (for example, AST-mesh), the blending functions of the corresponding T-splines form a partition of unity. Unfortunately, most common T-meshes in local refinement are not AST-meshes, and generally it is not a trivial task to modify an existing T-mesh to an AST-mesh.

In this section, we are going to construct a new type of local refinement splines over T-meshes which inherit the major properties of current local refinement splines. We call such splines Modified T-splines. We start with an outline of the construction process. Then the detailed construction approach is described, and the properties of Modified T-splines are presented.

Given a T-mesh T in 2D parametric space, let 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                        , be its vertices. For each vertex 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        , we are going to construct a piecewise bicubic basis function 
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           (
                           s
                           ,
                           t
                           )
                         over T with the following good properties:
                           
                              •
                              Non-negativity: 
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    s
                                    ,
                                    t
                                    )
                                    ⩾
                                    0
                                 , 
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    n
                                 .

Partition of unity: 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    s
                                    ,
                                    t
                                    )
                                    ≡
                                    1
                                 .

Linear independence: 
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    s
                                    ,
                                    t
                                    )
                                 , 
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    n
                                 , are linearly independent.

Compact support: 
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    s
                                    ,
                                    t
                                    )
                                  has a compact support.

Then a Modified T-spline is defined
                           
                              (7)
                              
                                 P
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 ,
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 ∈
                                 Ω
                                 ,
                              
                           
                         where 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                        , are the control points which form a 3D control T-mesh. Ω is the 2D parametric domain that is occupied by T. Note that there is a one-to-one correspondence between the 3D control mesh and the mesh T in 2D parametric space.

The construction of the basis functions 
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           (
                           s
                           ,
                           t
                           )
                         consists of the following two major steps (see Fig. 6
                        ).

For the first step, we extend T to a new mesh 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                         by T-vertex extensions such that a set of basis functions 
                           
                              
                                 N
                              
                              
                                 i
                              
                           
                           (
                           s
                           ,
                           t
                           )
                         over 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                         with the above good properties can be easily constructed. The new mesh 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                         is called the extended T-mesh of T. For example, we can extend all the T-vertices of T to the mesh boundaries to form a tensor product mesh 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                        . Then we choose 
                           
                              
                                 N
                              
                              
                                 i
                              
                           
                           (
                           s
                           ,
                           t
                           )
                         to be the tensor product B-spline basis functions which of course satisfy the above properties. Fig. 6(b) demonstrates another choice of 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                         which is a T-mesh, and the corresponding basis functions are defined over 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                         as shown in Fig. 6(c).

For the second step, let 
                           
                              
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 l
                              
                           
                         be the new vertices generated by the T-vertex extensions. We distribute the basis function 
                           
                              
                                 N
                              
                              
                                 i
                              
                           
                           (
                           s
                           ,
                           t
                           )
                         at 
                           
                              
                                 v
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                         to the basis functions at the neighboring old vertices of 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                        . In Fig. 6(d), the basis function at 
                           
                              
                                 v
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                         is distributed to the basis functions at 
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 v
                              
                              
                                 5
                              
                           
                        , and the basis function at 
                           
                              
                                 v
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                         is distributed to the basis functions at 
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 v
                              
                              
                                 6
                              
                           
                        . Finally, the basis function 
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           (
                           s
                           ,
                           t
                           )
                         over T is constructed as a linear combination of the basis functions 
                           
                              
                                 N
                              
                              
                                 i
                              
                           
                           (
                           s
                           ,
                           t
                           )
                         at the neighboring vertices of 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        . Fig. 6(e) illustrates the basis function at 
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                        .

The distribution of a basis function at a new vertex is composed of two steps: finding receiving vertices in T and computing distribution coefficients. Each new vertex is one of the three types: H-type, V-type and C-type. For H-type and V-type new vertices, the rule of distribution is simple: we distribute the basis function along one direction and perform the distribution as knot deletion in one dimension. However, for C-type new vertices, the situation is much harder. In our construction, we will avoid such situation.

For example, as illustrated in Fig. 6(d), 
                           
                              
                                 v
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                         is a H-type vertex, the basis function at 
                           
                              
                                 v
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                         is distributed along t (vertical) direction, and the distribution coefficients are computed by knot deletion in t direction as shown in formula (3). That is 
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 v
                              
                              
                                 5
                              
                           
                         are the receiving vertices of 
                           
                              
                                 v
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                        . The distribution coefficient of 
                           
                              
                                 v
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                         to 
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                         is the ratio of distance 
                           
                              
                                 v
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           
                              
                                 v
                              
                              
                                 5
                              
                           
                         over 
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           
                              
                                 v
                              
                              
                                 5
                              
                           
                         
                        
                           (
                           =
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       10
                                    
                                 
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       9
                                    
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       10
                                    
                                 
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       8
                                    
                                 
                              
                           
                           )
                        , and the one of 
                           
                              
                                 v
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                         to 
                           
                              
                                 v
                              
                              
                                 5
                              
                           
                         is the ratio of distance 
                           
                              
                                 v
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                         over 
                           
                              
                                 v
                              
                              
                                 5
                              
                           
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                         
                        
                           (
                           =
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       9
                                    
                                 
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       8
                                    
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       10
                                    
                                 
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       8
                                    
                                 
                              
                           
                           )
                        . Fig. 7
                         illustrates the distribution process of 
                           
                              
                                 v
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                         by formula (3).

In this section, we present details to construct bicubic Modified T-splines.

Given an original T-mesh T, we extend all the horizontal (or vertical) T-vertices to the boundary of T to obtain a new T-mesh. Now the new T-mesh has only vertical (or horizontal) T-vertices. For such T-meshes, we have the following important observation.


                        
                           Lemma 3.1
                           
                              If there are only vertical (horizontal) T-vertices in a mesh T, then the blending functions of the T-splines defined over T are linearly independent and form a partition of unity.
                           


                        
                           Proof
                           Without loss of generality, we assume T has only vertical T-vertices. Let 
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                               be the tensor product mesh by extending all the T-vertices in T to the boundary of T. Because there are only vertical T-vertices in T, all the new vertices in 
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                               are V-type. Let 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 s
                                 )
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 t
                                 )
                               be the tensor product B-spline basis function at each vertex 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                               of 
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                              , 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 m
                              . Let 
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                               be the T-spline blending function at the vertex of T, 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              . We are going to show that: (1) 
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                               is a linear combination of 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                              , that is, there exists a matrix 
                                 
                                    
                                       M
                                    
                                    
                                       n
                                       ×
                                       m
                                    
                                 
                               such that
                                 
                                    (8)
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       M
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                               (2) the matrix M has full rank and the column sums of the matrix M are all one. Then by Lemma 2.1, the assertion of the lemma follows.

Assume there are p horizontal grid lines and q vertical grid lines in 
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                              . For each horizontal grid line 
                                 t
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                              , there are q vertices on the grid line, among which we assume 
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                               vertices (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 q
                              ) are old vertices. Since the T-splines at all the vertices on the grid line have the same local knot vector 
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       −
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       2
                                    
                                 
                                 ]
                               in t direction, by the knot insertion algorithm of univariate cubic B-splines, the T-spline blending function 
                                 
                                    
                                       T
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                               at each old vertex on the grid line is a linear combination of the blending functions 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                               at all the vertices on the grid line, that is,
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         i
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         i
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         i
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         i
                                                         q
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                               where the matrix 
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                               has full rank and the column sums of 
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                               are all one by the property of knot insertion. Now (8) follows with 
                                 M
                                 =
                                 diag
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       p
                                    
                                 
                                 )
                              . Obviously, M has full rank and the column sums of M are all one.  □

For a given T-mesh T, let 
                           
                              
                                 T
                              
                              
                                 H
                              
                           
                         be the mesh by extending all the horizontal T-vertices of T to the mesh boundary. 
                           
                              
                                 T
                              
                              
                                 H
                              
                           
                         is called the horizontal extension mesh of T. Similarly, let 
                           
                              
                                 T
                              
                              
                                 V
                              
                           
                         be the mesh by extending all the vertical T-vertices of T to the mesh boundary, and 
                           
                              
                                 T
                              
                              
                                 V
                              
                           
                         is called the vertical extension mesh of T. Obviously 
                           
                              
                                 T
                              
                              
                                 H
                              
                           
                         and 
                           
                              
                                 T
                              
                              
                                 V
                              
                           
                         satisfy the condition of Lemma 3.1. If 
                           
                              
                                 T
                              
                              
                                 H
                              
                           
                         is taken as the extended T-mesh of T, then there are only H-type new vertices which are needed to be distributed. Similarly, if we take 
                           
                              
                                 T
                              
                              
                                 V
                              
                           
                         to be the extended T-mesh, then only V-type new vertices need to be distributed.

Before outlining the detailed algorithm to construct Modified T-splines, we can make some further simplification for extended T-meshes. In fact, among all the new vertices in 
                           
                              
                                 T
                              
                              
                                 H
                              
                           
                         or 
                           
                              
                                 T
                              
                              
                                 V
                              
                           
                        , many can be deleted without distribution process. We call such vertices deletable vertices. The key observation is as follows.

Assume 
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                         is a H-type vertex on a vertical grid line 
                           s
                           =
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                         in 
                           
                              
                                 T
                              
                              
                                 H
                              
                           
                        , and its 2-neighboring vertices on the grid line (two above 
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                         and two beneath 
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                        ) are denoted as 
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 4
                              
                           
                         (see Fig. 8
                        (a) as a reference). Now suppose that the T-spline blending functions at 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           4
                        , possess the same s local knot vector 
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                        . When 
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                         (and the corresponding edge) is deleted from 
                           
                              
                                 T
                              
                              
                                 H
                              
                           
                        , the blending function at 
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                         is distributed to the blending functions at the four neighboring vertices 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           1
                           ,
                           2
                           ,
                           3
                           ,
                           4
                        , by knot deletion of univariate cubic B-splines, and thus a T-spline is obtained over a new T-mesh 
                           
                              T
                              ˜
                           
                         after deleting 
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                         (and the corresponding edge) from 
                           
                              
                                 T
                              
                              
                                 H
                              
                           
                        , see Fig. 8(b). It is easy to see that the blending functions of the T-spline over 
                           
                              T
                              ˜
                           
                         are linearly independent and form a partition of unity. We conclude this in the following definition.


                        
                           Definition 3.1
                           Let 
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                               be a H-type new vertex on a vertical grid line in T, and let 
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       4
                                    
                                 
                               be the 2-neighboring vertices of 
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                               on the grid line. If the T-spline blending functions at 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                              , 
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 4
                              , have the same local s knot vector, then 
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                               is called a h-deletable vertex. Similarly, one can define v-deletable vertex. Both h-deletable vertex and v-deletable vertex are called deletable vertex.

Similar to the proof of Lemma 3.1, we have


                        
                           Lemma 3.2
                           
                              Let 
                              
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                               
                              be the T-mesh after deleting all the deletable vertices of 
                              
                                 
                                    
                                       T
                                    
                                    
                                       H
                                    
                                 
                               (or 
                              
                                 
                                    
                                       T
                                    
                                    
                                       V
                                    
                                 
                              ). Then the T-spline blending functions over 
                              
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                               
                              are linearly independent and form a partition of unity. 
                              
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                               
                              is called the extended T-mesh of T.
                           

Now we are ready to describe the details of the algorithm to construct Modified T-splines. 
                           Input
                           
                              A T-mesh T in a 2D parametric plane.

A set of basis functions 
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    s
                                    ,
                                    t
                                    )
                                  over T.

Extend all the horizontal T-vertices to the mesh boundary of T and denote the mesh by 
                                    
                                       
                                          T
                                       
                                       
                                          H
                                       
                                    
                                 .

Find all the h-deletable vertices in 
                                    
                                       
                                          T
                                       
                                       
                                          H
                                       
                                    
                                  and delete them (and the corresponding edges), and the result T-mesh is denoted by 
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                 .

Construct T-spline blending functions 
                                    {
                                    
                                       
                                          T
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    s
                                    ,
                                    t
                                    )
                                    }
                                  over 
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                 .

Scan each vertical grid line, and for each new vertex on the grid line, distribute the blending function at the new vertex to the blending functions at the neighboring old vertices on the grid line. This can be accomplished by knot deletion of univariate B-splines.

Let 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                  be a vertex in T. Assume 
                                    
                                       
                                          {
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          }
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          l
                                       
                                    
                                  are all the new vertices whose blending functions are distributed to 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                 , and 
                                    {
                                    
                                       
                                          c
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    }
                                  are the corresponding distribution coefficients, then the basis function at 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                  is constructed as 
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    s
                                    ,
                                    t
                                    )
                                    =
                                    
                                       
                                          T
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    s
                                    ,
                                    t
                                    )
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          l
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                          T
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    s
                                    ,
                                    t
                                    )
                                 .

Now we illustrate an example to explain the above algorithm. The origin T-mesh T is shown in Fig. 9
                        (a), and 
                           
                              
                                 T
                              
                              
                                 H
                              
                           
                         is shown in Fig. 9(b), where the purple circles are marked for H-type new vertices. According to Lemma 3.1, the blending functions of the T-spline defined over 
                           
                              
                                 T
                              
                              
                                 H
                              
                           
                         are linearly independent and form a partition of unity. Scan every vertical grid line segments, find all h-deletable vertices, as marked by green circles in Fig. 9(c). Fig. 9(d) is the extended T-mesh 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                         after removing the h-deletable vertices from 
                           
                              
                                 T
                              
                              
                                 H
                              
                           
                        . The blending functions at the remaining vertices (purple circles) are distributed as univariate knot deletion of B-spline to the neighboring old vertices.

We can also start with 
                           
                              
                                 T
                              
                              
                                 V
                              
                           
                        . Fig. 9(e) is the 
                           
                              
                                 T
                              
                              
                                 V
                              
                           
                         mesh, where purple circles are V-type new vertices needed to be distributed and green circles are v-deletable vertices.


                        Fig. 10
                         shows the comparison between the basis functions of Modified T-splines and T-splines, and how a basis function changes after knot deletion. From the examples, one can see that while the supports of Modified T-spline basis functions enlarge after knot deletion, they are comparable with the supports of T-spline basis functions.

We would like to make some remarks about the above construction method.


                        
                           Remark 3.1
                           
                              
                                 
                                    1.
                                    Instead of using 
                                          
                                             
                                                T
                                             
                                             
                                                H
                                             
                                          
                                       , we can also use 
                                          
                                             
                                                T
                                             
                                             
                                                V
                                             
                                          
                                        as the starting mesh. The algorithm is similar, and one only has to change horizontal to vertical, and vertical to horizontal. In practice, we choose 
                                          
                                             
                                                T
                                             
                                             
                                                H
                                             
                                          
                                        or 
                                          
                                             
                                                T
                                             
                                             
                                                V
                                             
                                          
                                        based on which mesh would result in less number of vertices that need to be distributed.

In step 4, the blending functions at the new vertices are distributed to the blending functions at the old vertices by knot deletion of univariate cubic B-splines. However, it is favorable to simply distribute the blending functions at the new vertices by knot deletion of degree one B-splines, since knot deletion of linear B-splines makes the support of the basis functions smaller.

The extended T-mesh 
                                          
                                             
                                                T
                                             
                                             
                                                ′
                                             
                                          
                                        in our algorithm is an AST-mesh. The spline space spanned by Modified T-splines is a subspace of the spline space spanned by AST-splines over 
                                          
                                             
                                                T
                                             
                                             
                                                ′
                                             
                                          
                                       . The local refinement algorithm in Scott et al. (2012) can be applied to obtain an AST-mesh from a given T-mesh, so AST-mesh can be used as a starting point instead of 
                                          
                                             
                                                T
                                             
                                             
                                                H
                                             
                                          
                                        or 
                                          
                                             
                                                T
                                             
                                             
                                                V
                                             
                                          
                                       . But as stated previously, it may introduce C-type new vertices which is hard to handle.

The construction algorithm involves three T-meshes: the origin T-mesh T and two auxiliary T-meshes: 
                                          
                                             
                                                T
                                             
                                             
                                                H
                                             
                                          
                                        and the extended T-mesh 
                                          
                                             
                                                T
                                             
                                             
                                                ′
                                             
                                          
                                       . 
                                          
                                             
                                                T
                                             
                                             
                                                H
                                             
                                          
                                        is served for constructing 
                                          
                                             
                                                T
                                             
                                             
                                                ′
                                             
                                          
                                        and 
                                          
                                             
                                                T
                                             
                                             
                                                ′
                                             
                                          
                                        is served for defining the T-splines, from which Modified T-splines are defined on T. At every vertex in T, a Modified T-spline basis function is defined as a linear combination of T-spline basis functions on 
                                          
                                             
                                                T
                                             
                                             
                                                ′
                                             
                                          
                                       , and thus the knot vectors and the distribution coefficients at the new vertices in 
                                          
                                             
                                                T
                                             
                                             
                                                ′
                                             
                                          
                                        are enough for further use. So it is not necessary to store the whole information of 
                                          
                                             
                                                T
                                             
                                             
                                                ′
                                             
                                          
                                        along with the original T-mesh. Both 
                                          
                                             
                                                T
                                             
                                             
                                                H
                                             
                                          
                                        and 
                                          
                                             
                                                T
                                             
                                             
                                                ′
                                             
                                          
                                        are discarded after the algorithm.

While it is generally very hard to give a complete analysis of the algorithm complexity for constructing Modified T-splines, we present several typical examples of meshes to get a hint about the algorithm complexity.

The construction algorithm in Section 3.2 mainly includes two parts: extended T-mesh 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                         construction and non-deletable vertices distribution. Let 
                           R
                           =
                           
                              N
                              M
                           
                        , where N is the total number of new vertices in 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                        , and M is the total number of old vertices in 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                         (i.e., M is the total number of vertices in T). The ratio R gives a rough idea about the computational complexity of the algorithm.


                        Fig. 11
                         shows four typical hierarchical T-meshes. Denote the maximum level of hierarchy by k and the refinement domain at level i by 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                        . The refinement domain 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                         in Fig. 11(a) is a rectangle with 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                           ⊂
                           
                              
                                 Ω
                              
                              
                                 i
                                 −
                                 1
                              
                           
                         (assume that the boundaries of 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 Ω
                              
                              
                                 i
                                 −
                                 1
                              
                           
                         do not overlap). There are 4k non-deletable vertices in 
                           
                              
                                 T
                              
                              
                                 H
                              
                           
                         and at least 
                           25
                           +
                           16
                           k
                         old vertices in 
                           
                              
                                 T
                              
                              
                                 H
                              
                           
                        . So the ratio 
                           R
                           ⩽
                           
                              
                                 4
                                 k
                              
                              
                                 25
                                 +
                                 16
                                 k
                              
                           
                           <
                           1
                           /
                           4
                        . The T-mesh in Fig. 11(b) is similar to the one in Fig. 11(a), where the refinement domains are polygons. In this case, there are 
                           7
                           k
                           −
                           1
                         non-deletable vertices in 
                           
                              
                                 T
                              
                              
                                 H
                              
                           
                         and 
                           30
                           k
                           +
                           36
                         old vertices in 
                           
                              
                                 T
                              
                              
                                 H
                              
                           
                        . So the ratio 
                           R
                           =
                           
                              
                                 7
                                 k
                                 −
                                 1
                              
                              
                                 30
                                 k
                                 +
                                 36
                              
                           
                           <
                           
                              7
                              30
                           
                        .

For the mesh in Fig. 11(c), suppose that there are 
                           2
                           (
                           n
                           +
                           2
                           )
                         vertical T-vertices at level 1. Then there are 
                           
                              
                                 n
                              
                              
                                 l
                              
                           
                           =
                           
                              
                                 2
                              
                              
                                 l
                              
                           
                           n
                           +
                           4
                         vertical T-vertices and 
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 0.5
                                 
                                    
                                       n
                                    
                                    
                                       l
                                    
                                 
                              
                           
                           6
                           j
                           +
                           3
                         old vertices at level l, 
                           l
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           k
                        . We assume that 
                           k
                           ⩾
                           3
                        . A vertical T-vertex at level l 
                        
                           (
                           1
                           ⩽
                           l
                           ⩽
                           k
                           −
                           2
                           )
                         produces 13 non-deletable vertices at most, and produces 11 non-deletable vertices at most at level 
                           k
                           −
                           1
                        . At level k there are about half of vertical T-vertices, each of which produces one non-deletable vertex. So the total number of new vertices in 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                         is less than 
                           
                              
                                 ∑
                              
                              
                                 l
                                 =
                                 1
                              
                              
                                 k
                                 −
                                 2
                              
                           
                           13
                           (
                           
                              
                                 2
                              
                              
                                 l
                              
                           
                           n
                           +
                           4
                           )
                           +
                           11
                           (
                           
                              
                                 2
                              
                              
                                 k
                                 −
                                 1
                              
                           
                           n
                           +
                           4
                           )
                           +
                           0.5
                           (
                           
                              
                                 2
                              
                              
                                 k
                              
                           
                           n
                           +
                           4
                           )
                           ≈
                           12.5
                           n
                           ⋅
                           
                              
                                 2
                              
                              
                                 k
                              
                           
                           +
                           52
                           k
                        . Since there are about 
                           
                              
                                 ∑
                              
                              
                                 l
                                 =
                                 1
                              
                              
                                 k
                              
                           
                           6
                           
                              
                                 n
                              
                              
                                 l
                              
                           
                           +
                           3
                           
                              
                                 n
                              
                              
                                 l
                              
                              
                                 2
                              
                           
                           ≈
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           ⋅
                           
                              
                                 4
                              
                              
                                 k
                              
                           
                           +
                           18
                           n
                           ⋅
                           
                              
                                 2
                              
                              
                                 k
                              
                           
                           +
                           24
                           k
                         old vertices, we get an estimate for the ratio 
                           R
                           ≈
                           
                              
                                 12.5
                                 n
                                 ⋅
                                 
                                    
                                       2
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 52
                                 k
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 ⋅
                                 
                                    
                                       4
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 18
                                 n
                                 ⋅
                                 
                                    
                                       2
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 24
                                 k
                              
                           
                        . It is easy to see that R decreases as k increases, and R tends to zero when k is large enough.

The final example illustrates the worst case – a T-mesh which refines along a diagonal as shown in Fig. 11(d), where the band width of the refinement domain 
                           
                              
                                 Ω
                              
                              
                                 i
                              
                           
                         is 3. Suppose the starting mesh is an 
                           n
                           ×
                           n
                         TP-mesh and 
                           k
                           ⩾
                           3
                        . Then there are 
                           
                              
                                 2
                              
                              
                                 l
                              
                           
                           n
                           −
                           4
                         vertical T-vertices and 
                           11
                           (
                           
                              
                                 2
                              
                              
                                 l
                                 −
                                 1
                              
                           
                           n
                           −
                           2
                           )
                           +
                           16
                         old vertices at level l, 
                           l
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           k
                        . A vertical T-vertex at level l 
                        
                           (
                           1
                           ⩽
                           l
                           ⩽
                           k
                           −
                           2
                           )
                         produces 11 non-deletable vertices at most, and produces 8 non-deletable vertices at most at level 
                           k
                           −
                           1
                        . There are about half of vertical T-vertices at level k, each of which produces one non-deletable vertex. So the new vertices in 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                         is about 
                           
                              
                                 ∑
                              
                              
                                 l
                                 =
                                 1
                              
                              
                                 k
                                 −
                                 2
                              
                           
                           11
                           (
                           
                              
                                 2
                              
                              
                                 l
                              
                           
                           n
                           −
                           4
                           )
                           +
                           8
                           (
                           
                              
                                 2
                              
                              
                                 k
                                 −
                                 1
                              
                           
                           n
                           −
                           4
                           )
                           +
                           0.5
                           (
                           
                              
                                 2
                              
                              
                                 k
                              
                           
                           n
                           −
                           4
                           )
                           =
                           20
                           n
                           ⋅
                           
                              
                                 2
                              
                              
                                 k
                                 −
                                 1
                              
                           
                           −
                           22
                           n
                           −
                           44
                           k
                           +
                           54
                        . On the other hand, there are about 
                           
                              
                                 ∑
                              
                              
                                 l
                                 =
                                 1
                              
                              
                                 k
                              
                           
                           11
                           (
                           
                              
                                 2
                              
                              
                                 l
                                 −
                                 l
                              
                           
                           n
                           −
                           2
                           )
                           +
                           16
                           =
                           22
                           n
                           ⋅
                           
                              
                                 2
                              
                              
                                 k
                                 −
                                 1
                              
                           
                           −
                           11
                           n
                           −
                           6
                           k
                         old vertices. So we have 
                           R
                           ≈
                           
                              
                                 20
                                 n
                                 ⋅
                                 
                                    
                                       2
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 −
                                 44
                                 k
                              
                              
                                 22
                                 n
                                 ⋅
                                 
                                    
                                       2
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 −
                                 6
                                 k
                              
                           
                        . One can see that R approaches 
                           
                              10
                              11
                           
                         when k is large enough.

The number of additional control points can be quite large and may lead the refined mesh be a tensor product mesh using the local refinement of T-splines (Sederberg et al., 2003). So here we will give another ratio 
                           
                              
                                 R
                              
                              
                                 ′
                              
                           
                           =
                           
                              N
                              
                                 TN
                              
                           
                         to give an intuitional expression of how big the refinement region in 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                        , where N is the total number of new vertices in 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                        , and TN is the total number of vertices in the corresponding tensor product mesh. For the case in Fig. 11(a), the ratio is 
                           
                              
                                 R
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 4
                                 k
                              
                              
                                 
                                    (
                                    5
                                    +
                                    2
                                    k
                                    )
                                 
                                 
                                    2
                                 
                              
                           
                           ⩽
                           
                              1
                              
                                 5
                                 +
                                 k
                              
                           
                        . For the case in Fig. 11(b), we have 
                           
                              
                                 R
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 7
                                 k
                                 −
                                 1
                              
                              
                                 
                                    (
                                    6
                                    +
                                    3
                                    k
                                    )
                                 
                                 
                                    2
                                 
                              
                           
                           ⩽
                           
                              7
                              
                                 36
                                 +
                                 9
                                 k
                              
                           
                        . For the case in Fig. 11(c), there are 
                           (
                           
                              
                                 2
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           n
                           +
                           4
                           k
                           +
                           5
                           )
                           (
                           
                              
                                 2
                              
                              
                                 k
                              
                           
                           n
                           +
                           2
                           k
                           +
                           4
                           )
                         vertices in the corresponding tensor product mesh, so the ratio 
                           
                              
                                 R
                              
                              
                                 ′
                              
                           
                           ⩽
                           
                              
                                 12.5
                                 n
                                 
                                    
                                       2
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 52
                                 k
                              
                              
                                 
                                    
                                       2
                                    
                                    
                                       2
                                       k
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       2
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 8
                                 k
                                 +
                                 13
                                 )
                                 n
                              
                           
                           ⩽
                           
                              
                                 12.5
                                 n
                              
                              
                                 
                                    
                                       2
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 (
                                 8
                                 k
                                 +
                                 13
                                 )
                                 n
                              
                           
                        . For the case in Fig. 11(d), there are 
                           
                              
                                 (
                                 
                                    
                                       2
                                    
                                    
                                       k
                                    
                                 
                                 n
                                 +
                                 1
                                 )
                              
                              
                                 2
                              
                           
                         vertices in the corresponding tensor product mesh, so the ratio 
                           
                              
                                 R
                              
                              
                                 ′
                              
                           
                           ⩽
                           
                              
                                 20
                                 n
                                 
                                    
                                       2
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 −
                                 44
                                 k
                              
                              
                                 
                                    (
                                    
                                       
                                          2
                                       
                                       
                                          k
                                       
                                    
                                    n
                                    +
                                    1
                                    )
                                 
                                 
                                    2
                                 
                              
                           
                           ⩽
                           
                              
                                 20
                                 n
                              
                              
                                 (
                                 
                                    
                                       2
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 4
                                 n
                                 )
                              
                           
                        .

The above results provide upper bounds for the ratio R and 
                           
                              
                                 R
                              
                              
                                 ′
                              
                           
                        . In practice, the ratio is much smaller as shown in Fig. 11.

Next we briefly discuss the supports of Modified T-spline basis functions. Suppose that T is a hierarchical T-mesh and the level differences between adjacent cells are at most one. Denote the corresponding tensor product mesh of T at level l by 
                           
                              
                                 T
                              
                              
                                 l
                              
                           
                        . Let v be a vertex at level l, then the support of Modified T-spline basis function at v is contained in an 
                           m
                           ×
                           n
                         rectangular mesh grid G at 
                           
                              
                                 T
                              
                              
                                 l
                                 −
                                 1
                              
                           
                        , where 
                           m
                           ,
                           n
                           ⩽
                           3
                        . Fig. 12
                         shows the supports of the Modified T-spline basis functions at four vertices 
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 4
                              
                           
                        , where 
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                         is in level 3, 
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 v
                              
                              
                                 3
                              
                           
                         are in level 2, and 
                           
                              
                                 v
                              
                              
                                 4
                              
                           
                         is in level 1.

For a given T-mesh T, we have constructed a set of blending functions 
                           
                              
                                 {
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                        , where n is the number of vertices in T. The constructed blending functions have the following nice properties.


                        
                           Theorem 3.3
                           
                              The blending functions 
                              
                                 
                                    
                                       {
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       s
                                       ,
                                       t
                                       )
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                               
                              constructed in Section 
                              3.2 
                              have the following properties:
                                 
                                    •
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                2
                                             
                                          
                                        
                                       continuity: 
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          s
                                          ,
                                          t
                                          )
                                        
                                       is 
                                       
                                          
                                             
                                                C
                                             
                                             
                                                2
                                             
                                          
                                        
                                       continuous over T, 
                                       
                                          i
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          n
                                       
                                       .
                                    


                                       Non-negativity: 
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          s
                                          ,
                                          t
                                          )
                                          ⩾
                                          0
                                       
                                       , 
                                       
                                          i
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          n
                                       
                                       .
                                    


                                       Partition of unity: 
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          s
                                          ,
                                          t
                                          )
                                          ≡
                                          1
                                       
                                       .
                                    


                                       Linear independence: 
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          s
                                          ,
                                          t
                                          )
                                       
                                       , 
                                       
                                          i
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          n
                                       
                                       , are linearly independent.
                                    


                                       Compact support: 
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          s
                                          ,
                                          t
                                          )
                                        
                                       has compact support.
                                    


                        
                           Proof
                           We only prove that 
                                 
                                    
                                       {
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       s
                                       ,
                                       t
                                       )
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                               are linearly independent and form a partition of unity. We adopt the notations as in Section 3.2.

Assume the extended T-mesh 
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                               has m (
                                 m
                                 >
                                 n
                              ) vertices. By Lemma 3.2, the T-spline blending functions 
                                 
                                    
                                       {
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       s
                                       ,
                                       t
                                       )
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                               over 
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                               are linearly independent and form a partition of unity.

Without loss of generality, let 
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       n
                                    
                                 
                               be the vertices in T and 
                                 
                                    
                                       v
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       m
                                    
                                 
                               be the new vertices. By the construction process of the blending functions 
                                 
                                    
                                       {
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       s
                                       ,
                                       t
                                       )
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              ,
                                 
                                    (9)
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   )
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   )
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         1
                                                         ,
                                                         n
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         1
                                                         m
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                         ,
                                                         n
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                         m
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   ⋱
                                                
                                                
                                                   0
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   ⋯
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         n
                                                         ,
                                                         n
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         n
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   )
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   )
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       M
                                       
                                          
                                             (
                                             
                                                
                                                   T
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   T
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   T
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                               where 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 1
                              , 
                                 j
                                 =
                                 n
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 m
                              .

Obviously, the matrix M in (9) has full rank, and the column sums of M are all one. By Lemma 2.1, 
                                 
                                    
                                       {
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       s
                                       ,
                                       t
                                       )
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                               are linearly independent and form a partition of unity. The lemma is thus proved. □


                        
                           Remark 3.2
                           In the following, we call the blending functions 
                                 
                                    
                                       {
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       s
                                       ,
                                       t
                                       )
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                               basis functions over a T-mesh.


                        Fig. 13
                         compares a Modified T-spline function and a T-spline function over a T-mesh. In both figures (a) and (b), the control coefficients corresponding to the vertices marked by orange circles are taken as one while others are taken as zero. So the functions are actually the sum of the blending functions defined over the vertices labeled with orange circles. Figs. 13(a) and (b) depict the shapes of the Modified T-spline function and T-spline function respectively. It can be seen that the Modified T-spline looks more fair than the T-spline.

Let 
                           S
                           =
                           
                              span
                           
                           
                              
                                 {
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                         be the Modified T-spline space defined over T-mesh T, where 
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           (
                           s
                           ,
                           t
                           )
                         are the basis functions defined over T. For a given continuous function 
                           f
                           (
                           s
                           ,
                           t
                           )
                        , we would like to know the approximation error of f from 
                           S
                        .

In this section, we assume that T is a hierarchical T-mesh such that for any two neighboring cells in T, the level difference is at most one. Ω is the rectangular parameter domain that is occupied by T. 
                           
                              
                                 Ω
                              
                              
                                 l
                              
                           
                         is the parametric domain that consists of all the cells in level l. 
                           
                              
                                 h
                              
                              
                                 l
                              
                           
                         is the maximum length of the cells in level l.


                        
                           Theorem 3.4
                           
                              For any continuous function 
                              
                                 f
                                 ∈
                                 C
                                 (
                                 Ω
                                 )
                              
                              , there exists a Modified T-spline function 
                              
                                 g
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 ∈
                                 S
                               
                              such that
                              
                                 
                                    (10)
                                    
                                       
                                          |
                                          f
                                          (
                                          s
                                          ,
                                          t
                                          )
                                          −
                                          g
                                          (
                                          s
                                          ,
                                          t
                                          )
                                          |
                                       
                                       ⩽
                                       C
                                       w
                                       (
                                       f
                                       ,
                                       
                                          
                                             h
                                          
                                          
                                             l
                                          
                                       
                                       )
                                       ,
                                       
                                       (
                                       s
                                       ,
                                       t
                                       )
                                       ∈
                                       
                                          
                                             Ω
                                          
                                          
                                             l
                                          
                                       
                                       .
                                    
                                 
                               
                              Here 
                              
                                 w
                                 (
                                 f
                                 ,
                                 h
                                 )
                               
                              is the modulus of continuity of f, that is, 
                              
                                 w
                                 (
                                 f
                                 ,
                                 h
                                 )
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       
                                          
                                             ‖
                                             x
                                             −
                                             y
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                       ⩽
                                       h
                                    
                                 
                                 |
                                 f
                                 (
                                 x
                                 )
                                 −
                                 f
                                 (
                                 y
                                 )
                                 |
                              
                              . C is a constant which is independent of the mesh T.
                           


                        
                           Proof
                           For any function f, define
                                 
                                    
                                       A
                                       f
                                       (
                                       s
                                       ,
                                       t
                                       )
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       f
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             η
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       s
                                       ,
                                       t
                                       )
                                       ,
                                    
                                 
                               where 
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       η
                                    
                                    
                                       i
                                    
                                 
                                 )
                               are the coordinates of the vertex in T corresponding to the basis function 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                              .

Let 
                                 θ
                                 ⊂
                                 
                                    
                                       Ω
                                    
                                    
                                       l
                                    
                                 
                               be a cell in level l. For any 
                                 (
                                 
                                    s
                                    ˆ
                                 
                                 ,
                                 
                                    t
                                    ˆ
                                 
                                 )
                                 ∈
                                 θ
                              , we have
                                 
                                    
                                       f
                                       (
                                       
                                          s
                                          ˆ
                                       
                                       ,
                                       
                                          t
                                          ˆ
                                       
                                       )
                                       −
                                       A
                                       f
                                       (
                                       
                                          s
                                          ˆ
                                       
                                       ,
                                       
                                          t
                                          ˆ
                                       
                                       )
                                       =
                                       f
                                       (
                                       
                                          s
                                          ˆ
                                       
                                       ,
                                       
                                          t
                                          ˆ
                                       
                                       )
                                       −
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             K
                                          
                                       
                                       f
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             η
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          s
                                          ˆ
                                       
                                       ,
                                       
                                          t
                                          ˆ
                                       
                                       )
                                       =
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             K
                                          
                                       
                                       
                                          [
                                          f
                                          (
                                          
                                             s
                                             ˆ
                                          
                                          ,
                                          
                                             t
                                             ˆ
                                          
                                          )
                                          −
                                          f
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                η
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ]
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          s
                                          ˆ
                                       
                                       ,
                                       
                                          t
                                          ˆ
                                       
                                       )
                                       ⩽
                                       
                                          max
                                          
                                             i
                                             ∈
                                             K
                                          
                                       
                                       
                                          |
                                          f
                                          (
                                          
                                             s
                                             ˆ
                                          
                                          ,
                                          
                                             t
                                             ˆ
                                          
                                          )
                                          −
                                          f
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                η
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          |
                                       
                                    
                                 
                               by the partition of unity of basis functions. Here 
                                 K
                                 =
                                 {
                                 i
                                 |
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 
                                    s
                                    ˆ
                                 
                                 ,
                                 
                                    t
                                    ˆ
                                 
                                 )
                                 ≠
                                 0
                                 ,
                                 
                                 1
                                 ⩽
                                 i
                                 ⩽
                                 n
                                 }
                              .

Now suppose θ is contained in a cell 
                                 
                                    
                                       θ
                                    
                                    
                                       ′
                                    
                                 
                               at level 
                                 l
                                 −
                                 1
                              . Denote the corresponding tensor product mesh of T at level 
                                 l
                                 −
                                 1
                               as 
                                 
                                    
                                       T
                                    
                                    
                                       l
                                       −
                                       1
                                    
                                 
                              . Then there is a 
                                 3
                                 ×
                                 3
                               rectangular mesh grid G in 
                                 
                                    
                                       T
                                    
                                    
                                       l
                                       −
                                       1
                                    
                                 
                               whose central cell is 
                                 
                                    
                                       θ
                                    
                                    
                                       ′
                                    
                                 
                              , and the B-spline basis functions at the vertices of G do not vanish in θ. If G doesnʼt contain new vertices of 
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                               (extended T-mesh of T), then 
                                 {
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       η
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 |
                                 i
                                 ∈
                                 K
                                 }
                                 ⊂
                                 G
                              , so
                                 
                                    
                                       
                                          max
                                          
                                             i
                                             ∈
                                             K
                                          
                                       
                                       
                                          |
                                          f
                                          (
                                          
                                             s
                                             ˆ
                                          
                                          ,
                                          
                                             t
                                             ˆ
                                          
                                          )
                                          −
                                          f
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                η
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          |
                                       
                                       ⩽
                                       w
                                       (
                                       f
                                       ,
                                       3
                                       
                                          2
                                       
                                       
                                          
                                             h
                                          
                                          
                                             l
                                             −
                                             1
                                          
                                       
                                       )
                                       ⩽
                                       (
                                       3
                                       
                                          2
                                       
                                       +
                                       1
                                       )
                                       w
                                       (
                                       f
                                       ,
                                       
                                          
                                             h
                                          
                                          
                                             l
                                             −
                                             1
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           

For a hierarchical T-mesh, we generally have 
                                 
                                    
                                       h
                                    
                                    
                                       l
                                    
                                 
                                 ⩾
                                 
                                    
                                       h
                                    
                                    
                                       l
                                       −
                                       1
                                    
                                 
                                 /
                                 2
                              . Therefore
                                 
                                    (11)
                                    
                                       
                                          |
                                          f
                                          (
                                          
                                             s
                                             ˆ
                                          
                                          ,
                                          
                                             t
                                             ˆ
                                          
                                          )
                                          −
                                          A
                                          f
                                          (
                                          
                                             s
                                             ˆ
                                          
                                          ,
                                          
                                             t
                                             ˆ
                                          
                                          )
                                          |
                                       
                                       ⩽
                                       (
                                       3
                                       
                                          2
                                       
                                       +
                                       1
                                       )
                                       w
                                       (
                                       f
                                       ,
                                       
                                          
                                             h
                                          
                                          
                                             l
                                             −
                                             1
                                          
                                       
                                       )
                                       ⩽
                                       2
                                       (
                                       3
                                       
                                          2
                                       
                                       +
                                       1
                                       )
                                       w
                                       (
                                       f
                                       ,
                                       
                                          
                                             h
                                          
                                          
                                             l
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           

When G contains new vertices of 
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                              , then there exist Modified T-spline basis functions outside of G whose supports contain θ. So we have to enlarge G. Such changes only influence the const C in (10). Fortunately, according to the distribution process, if the level difference between adjacent cells is at most one, G does not need to be enlarged.  □

Since Modified T-spline basis functions 
                           
                              
                                 {
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                         are linear combinations of the T-spline functions 
                           
                              
                                 {
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 m
                              
                           
                        , and by knot insertion, the T-spline functions 
                           
                              
                                 {
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 m
                              
                           
                         are linear combinations of the TP B-spline basis functions 
                           
                              
                                 {
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 l
                              
                           
                        , so 
                           
                              
                                 {
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                         are linear combinations of 
                           
                              
                                 {
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 l
                              
                           
                        . In matrix form,
                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 M
                                 
                                    
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             T
                                          
                                          
                                             m
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             T
                                          
                                          
                                             m
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 L
                                 
                                    
                                       (
                                       
                                          
                                             N
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             N
                                          
                                          
                                             l
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                         Thus
                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 M
                                 L
                                 
                                    
                                       (
                                       
                                          
                                             N
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             N
                                          
                                          
                                             l
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                        
                     

Suppose we have a Modified T-spline surface
                           
                              
                                 S
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 =
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 
                                    
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                         then it can be converted into a TP B-spline surface:
                           
                              
                                 S
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    l
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 =
                                 (
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       Q
                                    
                                    
                                       l
                                    
                                 
                                 )
                                 
                                    
                                       (
                                       
                                          
                                             N
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             N
                                          
                                          
                                             l
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                         where 
                           (
                           
                              
                                 Q
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 Q
                              
                              
                                 l
                              
                           
                           )
                           =
                           (
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 P
                              
                              
                                 m
                              
                           
                           )
                           M
                           L
                        .

This conversion makes it easy for Modified T-splines to be conveniently imported into the current surface modeling system. Fig. 14
                         shows the conversion results of the Modified T-spline surface. Here the curves on the surfaces in column (b) are the images of the T-mesh, and the curves on the surface in column (c) are the images of tensor product mesh.

Suppose we are given an open mesh model with vertices 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           N
                        , in 3D space, and their corresponding parameter values 
                           (
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           )
                        , 
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           N
                        , obtained from some parameterization of the mesh (we use the method in Floater, 1997, in the current paper). The parameter domain is assumed to be 
                           [
                           0
                           ,
                           1
                           ]
                           ×
                           [
                           0
                           ,
                           1
                           ]
                        .

The surface fitting scheme repeats the following steps 2 and 3 until the fitting error in each cell is less than some tolerance ε.
                           
                              1.
                              Construct a uniform tensor product mesh 
                                    
                                       
                                          T
                                       
                                       
                                          0
                                       
                                    
                                  as the initial mesh. Set 
                                    k
                                    =
                                    0
                                 .

Solve a least square fitting problems on the kth level mesh 
                                    
                                       
                                          T
                                       
                                       
                                          k
                                       
                                    
                                  to find a Modified T-spline surface 
                                    
                                       
                                          S
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    s
                                    ,
                                    t
                                    )
                                  to fit the given mesh model.

Search for the cells of the T-mesh 
                                    
                                       
                                          T
                                       
                                       
                                          k
                                       
                                    
                                  whose fitting errors are greater than ε, then split these cells into four sub-cells to obtain a new mesh 
                                    
                                       
                                          T
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 . The fitting error over a cell s is defined to be 
                                    
                                       
                                          max
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ∈
                                          s
                                       
                                    
                                    ‖
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          S
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ‖
                                 . Set 
                                    k
                                    :
                                    =
                                    k
                                    +
                                    1
                                 .


                        Fig. 15
                         illustrates three examples for fitting open meshes with Modified T-splines, and Table 1
                         shows the statistic data including the number points/faces of the mesh models, the number of control points of the fitting spline surfaces and the fitting level.

The surface fitting scheme provided in the previous subsections can be easily adapted to approximate a NURBS model with a Modified T-spline surface. We illustrate two examples as shown in Figs. 16 and 17
                        
                        . In each example, the approximation error ε and the number of control points in the approximating Modified T-spline are provided. Here the control nets of NURBS surface are displayed in bright green, and the one of the Modified T-splines are in pink. From the examples, it can be seen that there is a considerable reduction of control points of Modified T-splines compared with NURBS representations.

@&#CONCLUSIONS AND FUTURE WORK@&#

This paper proposes a new local refinement splines called Modified T-splines. The basic idea is to construct a set of basis functions over a T-mesh which have good properties such as non-negativity, partition of unity and compact support. Due to the properties of the basis functions, Modified T-splines inherit many good properties of current local refinement splines, and thus should be useful both in geometric modeling and isogeometric analysis.

There are a few problems worthy of further investigation. First, the local refinement algorithm is crucial in adaptive modeling and analysis of splines. We will discuss the local refinement algorithm for Modified T-splines. Second, in the current construction, the Modified T-splines are 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      continuous globally. We will investigate the possibility to insert multiple knots such that 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      or 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      continuity could be achieved at the knot lines, i.e., we will consider Modified T-splines over μ-extended box partitions (Dokken et al., 2013). Finally, we will investigate further applications of Modified T-splines in geometric modeling and isogeometric analysis.

@&#ACKNOWLEDGEMENTS@&#

The authors thank the reviewers for providing useful comments and suggestion. The work is supported by 973 Program 
                  2011CB302400, the NSF of China No. 11031007.

@&#REFERENCES@&#

