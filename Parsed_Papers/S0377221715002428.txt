@&#MAIN-TITLE@&#A branch-price-and-cut method for the vegetable crop rotation scheduling problem with minimal plot sizes

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We address a vegetable production problem with sustainability considerations.


                        
                        
                           
                           We propose an integer programming formulation and a branch-price-and-cut method.


                        
                        
                           
                           The method relies on subadditive valid inequalities and a strong branching rule.


                        
                        
                           
                           1 percent-optimality was proven for all instances within reasonable computational times.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in agriculture

Crop rotation scheduling

Branch-price-and-cut

Strong branching

Subadditive valid inequalities

@&#ABSTRACT@&#


               
               
                  Crop rotation plays an important role in agricultural production models with sustainability considerations. Commonly associated strategies include the alternation of botanical families in the plots, the use of fallow periods and the inclusion of green manure crops. In this article, we address the problem of scheduling vegetable production in this context. Vegetables crop farmers usually manage a large number of crop species with different planting periods and growing times. These crops present multiple and varied harvesting periods and productivities. The combination of such characteristics makes the generation of good vegetable crop rotation schedules a hard combinatorial task. We approach this problem while considering two additional important practical aspects: standard plot sizes (multiples of a base area) and total area minimisation. We propose an integer programming formulation for this problem and develop a branch-price-and-cut algorithm that includes several performance-enhancing characteristics, such as the inclusion of a family of subadditive valid inequalities, two primal heuristics and a strong branching rule. Extensive computational experiments over a set of instances based on real-life data validate the efficiency and robustness of the proposed method.
               
            

@&#INTRODUCTION@&#

Sustainable agricultural production and distribution models have gained attention in the literature in recent years (Alfandari, Lemalade, Nagih, & Plateau, 2011; Bachinger & Zander, 2007; Detlefsen & Jensen, 2007; Haneveld & Stegeman, 2005). In particular, we have been interested in the use of crop rotation as a pest control and conservation of productive resources strategy in the farming of vegetables. The scheduling of vegetable crop rotation, especially when the goal is to supply a given demand, presents several complicated characteristics associated with the fact that crops with very different planting, growing and (multiple and coupled) harvesting times must be addressed simultaneously.

In the past decade, a few mathematical formulations have been proposed in the literature with the purpose of considering ecologically based constraints. Santos (2009) developed an integer programming model by considering the following three ecological based criteria: (i) crops of the same botanical family cannot be grown one after another in the same land plot, (ii) a green manure crop must be periodically grown in each plot and (iii) there are requirements in terms of fallowness that must be respected. These criteria aim at reducing the population growth of pests and weeds; recovering of the physical, chemical and biological soil properties; increasing soil fertility and incorporating nitrogen into the system through biological fixation (Altieri, 1995; Dias, Dukes, & Antunes, 2014; Wezel et al., 2013). They have been used in a number of follow-up articles addressing variants of the model proposed in Santos (2009), including, for instance, concerns regarding the supply of demands (Santos, Costa, Arenales, & Santos, 2010), the management of perishable stocks (Costa, Santos, Alem, & Santos, 2014) and the extension of these ecologically based constraints to avoid growing crops from the same botanical family simultaneously in neighbouring plots (Santos, Arenales, Costa, & Santos, 2010; Santos, Michelon, Arenales, & Santos, 2011). These problems have been solved with variants of a column generation algorithm (Lübbecke & Desrosiers, 2005; Vanderbeck & Wolsey, 2010) in which the generated columns carry the crop planting schedule information.

The articles mentioned above deal with the sizing of the plots, but following two different approaches. Either they assume that the plot size is an exogenous parameter (Santos, Arenales et al., 2010; Santos et al., 2011) or they let the optimisation model to freely decide on plot sizes by using endogenous variables (Costa et al., 2013; Santos, Costa et al., 2010). While both approaches might have their applicabilities, they also have limitations. Fixing candidate plot sizes a priori reduces the solution space and might, therefore, lead to sub-optimal configurations. On the other hand, imposing no sizing constraints usually lead to a large number of plots, with very different and frequently small areas. This is contrary to what is expected in practice, where plot size standardisation is a welcome characteristic because it eliminates the need of dealing with very small plots (with sizes smaller than the base area) and also facilitates farming management. Indeed, many caring techniques, such as irrigation, are planned for or more suitably used in plots with standard sizes.

In this paper, we focus on a crop rotation scheduling problem that deals with the sizing of the plots endogenously, while imposing that they are multiples of a base area. We also consider the ecological based criteria mentioned earlier and an explicit area minimisation objective. The idea of area minimisation has been already addressed in Alfandari et al. (2011) and has clear advantages, such as the reduction of infrastructure and operational costs and the facilitation of the maintenance of conservation spaces with wider environments, thus reducing the pressure on areas that are more susceptible to degradation. To tackle this problem, we propose an integer programming model that minimises the planting area while guaranteeing that the obtained plot sizes are multiples of a base value and supply a given demand. Since the proposed model corresponds to an extensive formulation, we develop a branch-price-and-cut (BPC) algorithm.

BPC algorithms have shown to be a powerful tool for solving hard combinatorial problems (Barnhart, Johnson, Nemhauser, Savelsbergh, & Vance, 1998; Vanderbeck & Wolsey, 2010). In the context of crop scheduling, we are aware of two other applications of the method, which deal with crops with different growth cycles (Santos, Arenales et al., 2010) and equal growth cycles (Alfandari, Plateau, & Schepler, 2015). In Santos, Arenales et al. (2010), the authors propose a BPC for a vegetable crop rotation (using criteria (i)–(iii)) with additional adjacency constraints imposing that crops of the same botanical family cannot be grown simultaneously in neighbouring areas. Plots locations and sizes were determined a priori, allowing the model to be reformulated as a pure 0–1 master problem. In Alfandari et al. (2015), the authors use a BPC algorithm to solve a crop rotation problem that select plots from a candidate list in order to minimise the combined area of chosen plots while meeting a given demand. They deal with crops that have a single growing cycle (and therefore, one harvest period) and only two possible planting periods per year, following the same ideas proposed in Alfandari et al. (2011). These crop characteristics allow the feasible crop rotations to be expressed by means of a clever transition graph, so the subproblems can be solved by using a shortest path algorithm. In both Santos, Arenales et al. (2010) and Alfandari et al. (2015), the models are defined using a set of potential plot sizes chosen a priori. This allows the use of binary variables associated with the selection of scheduling sequences for each plot and the efficient use of traditional branching rules.

The BPC algorithm proposed in this paper is structurally different from those proposed in Santos, Arenales et al. (2010) and Alfandari et al. (2015). Indeed, since the model includes decisions on both plot sizes and schedules simultaneously, the decision variables must be defined as general integers, i.e., they are allowed to take any positive integer value. To be effective in such context, the BPC has to rely on branching rules based on sets of variables, aided with a strong branching strategy. In addition, we aim at tackling practical situations that involve up to 20 crops with diverse characteristics and have to follow a fine granularity of the time discretisation (each year represented as 48 time periods). These features lead to large instances which require a number of further performance-enhancing characteristics, such as the use of a set of newly developed family of valid inequalities, which improve the quality of the bounds obtained by the column generation subroutine, and two primal heuristics.

To verify the performance of the proposed BPC algorithm in practice, we have run an extensive set of computational experiments using instances based on real-life data. For all instances, the proposed method was able to prove 1 percent-optimality within very reasonable computational times. The results also indicate the positive effect of the proposed performance-enhancing features.

The remainder of this paper is organised to present this whole set of ideas coherently. Section 2 defines the problem and presents the developed mixed-integer model. The solution methodology is then described in Section 3, in which we detail, in order, the column generation procedure, the branching strategy, the proposed valid inequalities, and the primal heuristic procedures that compose our branch-price-and-cut method. Section 4 presents the results of the computational experiments while Section 5 ends this paper with conclusions and suggested routes for further investigation.

Let N be the number of different available crops and M be the number of time periods (days, weeks, months, etc.) in which the growing of these crops is going to be scheduled to satisfy a given known demand. The crop rotation scheduling problem (CRSP) consists of determining schedules for the crop rotation activity such that the production of each crop at each period is sufficient to satisfy its corresponding demand, while respecting a set of ecological criteria and biological methods. We consider that the main objective is to minimise the size of the planting area. In addition, we assume that the planting area is divided into plots, which have a predefined minimum size denoted by a
                     min and that the size of any plot can only be a multiple of this value. Consider the following additional parameters:

                        
                           C
                        
                        
                           a set of crops that are planted to satisfy the demand;

a set of crops that are available for green manuring;

total number of crops, i.e., cardinality of C ∪ G;

index of a fictitious crop, representing the presence of fallow;

number of botanical families;

set of crops from the botanical family p, p = 1, …, NF;

production time for crop i, including soil preparation and harvesting;

set of time periods in which crop i can be planted;

minimum time interval to wait between planting two crops from the same botanical family.

We can write linear constraints forcing a single plot schedule to respect the ecologically based criteria mentioned previously. Indeed, using binary variables:

                        
                           
                              
                                 
                                    
                                       x
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   crop
                                                   
                                                   i
                                                   
                                                   is
                                                   
                                                   planted
                                                   
                                                   in
                                                   
                                                   time
                                                   
                                                   period
                                                   
                                                   j
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   otherwise
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     for 
                        
                           i
                           =
                           1
                           ,
                           ⋯
                           ,
                           N
                           +
                           1
                        
                      and j = 1, … , M, these constraints read (Santos, Costa et al., 2010):

                        
                           (1)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                   +
                                                   1
                                                
                                             
                                             
                                                ∑
                                                
                                                   r
                                                   =
                                                   0
                                                
                                                
                                                   
                                                      t
                                                      i
                                                   
                                                   −
                                                   1
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   ,
                                                   j
                                                   −
                                                   r
                                                
                                             
                                             ≤
                                             1
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          M
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   F
                                                   (
                                                   p
                                                   )
                                                
                                             
                                             
                                                ∑
                                                
                                                   r
                                                   =
                                                   0
                                                
                                                
                                                   
                                                      t
                                                      i
                                                   
                                                   −
                                                   1
                                                   +
                                                   
                                                      t
                                                      f
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   ,
                                                   j
                                                   −
                                                   r
                                                
                                             
                                             ≤
                                             1
                                             ,
                                             
                                             p
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             NF
                                             ,
                                             
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             M
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   G
                                                
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   
                                                      I
                                                      i
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             =
                                             1
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                M
                                             
                                             
                                                x
                                                
                                                   N
                                                   +
                                                   1
                                                   ,
                                                   j
                                                
                                             
                                             =
                                             1
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             N
                                             +
                                             1
                                             ,
                                             
                                             j
                                             ∈
                                             
                                                I
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where j − r < 0 is replaced by j − r + M in constraints (1) and (2). Constraints (1) ensure that at most one crop is planted at each time period (including fallow), whereas constraints (2) forbid planting crops from the same botanical family in a time interval smaller than tf
                     . Constraint (3) imposes that a crop must be planted for green manuring and constraint (4) guarantees the presence of fallow. Both constraints (3) and (4) can be easily modified to incorporate the need of more fallows or green manure crops during the rotation period (Santos, 2009).

The right-hand side in constraint (4) enforces the requirement of a single period of fallow. This is not a limitation of the model, but a choice that follows our experience with vegetable farmers in Brazil. The common practice among these farmers is to make intense use of the land. In addition, we base this requirement on the recent literature that addresses the effect of a single short fallow on crop yield (Babu, Rao, & Veeraraghavaiah, 2014; Dias et al., 2014; Gabriel & Quemada, 2011; Hunt & Kirkegaard, 2012) and on the fact that we also consider green manuring as a way of recovering soil chemical and physical properties and interrupting the population growth of pests and weeds (Allen, Pikul, Waddell, & Cochran, 2011; Kröbel et al., 2014; Manyanga, Mafongoya, & Tauro, 2014; Miller et al., 2011).

Let X be the set of all feasible schedules that satisfy constraints (1) to (5). Additionally, let S be the set of indices associated with the schedules in X, such that each schedule in X can be denoted by xs
                      for a unique s ∈ S. Given a schedule xs
                     , we are interested in determining the production that results from the use of such schedule in a given plot. To obtain this information, the following parameters are needed:

                        
                           pir
                           
                        
                        
                           total production of crop i on its rth harvesting;

time interval between the period crop i is planted and the period of its first harvesting.

The production of crop i at time period j in an area of size equal to the base area, when using schedule xs
                     , is then given by

                        
                           (6)
                           
                              
                                 
                                    a
                                    
                                       i
                                       j
                                    
                                    s
                                 
                                 =
                                 
                                    ∑
                                    
                                       r
                                       =
                                       1
                                    
                                    
                                       
                                          t
                                          i
                                       
                                       −
                                       
                                          o
                                          i
                                       
                                       −
                                       1
                                    
                                 
                                 
                                    a
                                    min
                                 
                                 
                                    p
                                    
                                       i
                                       r
                                    
                                 
                                 
                                    x
                                    
                                       i
                                       ,
                                       j
                                       −
                                       
                                          o
                                          i
                                       
                                       −
                                       r
                                    
                                    s
                                 
                                 ,
                              
                           
                        
                     where a
                     min stands for the base plot area.

Relationship (6) converts schedule-based information to crop production values. This is crucial for obtaining the following model, which aims at finding schedules with a combined production that meets the required demand while minimising the total planting area:

                        
                           (7)
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                u
                                                s
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    
                                       s.t.
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                a
                                                
                                                   i
                                                   j
                                                
                                                s
                                             
                                             
                                                u
                                                s
                                             
                                             ≥
                                             
                                                d
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                          
                                          
                                             i
                                             ∈
                                             C
                                          
                                          ,
                                          
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          M
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                u
                                                s
                                             
                                             ≤
                                             L
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (10)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                u
                                                s
                                             
                                             ∈
                                             
                                                Z
                                                +
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                          
                                          s
                                          ∈
                                          S
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where u is the vector of decision variables such that each component us
                      is the number of base-area plots of size a
                     min that is assigned to schedule s ∈ S. Parameter dij
                      is the demand of crop i in time period j, for i ∈ C and j = 1, … , M, and therefore constraints (8) ensure that the required demand is met. Constraint (9) imposes that the number of base-area plots does not exceed the upper limit L. This constraint can be tightened by changing L in (9) to any known upper bound on the solution of the problem. As we have observed in preliminary computational experiments, this strategy was helpful to speed up the proposed solution method. We assume that planting area is homogeneous, as in practice the plots used to grow the vegetable crops have typically similar characteristics, as a result of years of similar cropping management. The model can be easily extended to cope with heterogeneous areas (see, for instance Santos, Arenales et al., 2010; Santos, Costa et al., 2010).

The usual large number of possible schedules and the integrality of variables us
                      makes the resolution of such a model a difficult challenge. The following section describes the method that has been proposed for this purpose.

@&#METHODOLOGY@&#

In this section, we describe the main components of the branch-price-and-cut method that we implemented to solve problem (7)–(10). First, we describe the column generation procedure used to solve the linear relaxations at each branching node. Then, we present a strong branching strategy and propose a class of valid inequalities used to tighten these linear relaxations. Finally, we present two heuristics used to further improve the computational performance of the method.

As mentioned above, the number of schedules in S is usually very large even for problems with a small number of crops and periods, making the explicit resolution of model (7)–(10) impractical. A common workaround in such cases is the use of the column generation technique which is based on the idea of artificially reducing the number of variables and dynamically generating promising columns during the solution method (Lübbecke & Desrosiers, 2005; Vanderbeck & Wolsey, 2010).

In the case of this paper, this aim can be achieved by initially solving a so-called restricted master problem (RMP), in which the integrality of variables us
                         is ignored and which contains just a (small) subset 
                           
                              
                                 S
                                 ¯
                              
                              ⊂
                              S
                           
                         of the variables:

                           
                              (11)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      s
                                                      ∈
                                                      
                                                         S
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   u
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       
                                          s.t.
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      s
                                                      ∈
                                                      
                                                         S
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   a
                                                   
                                                      i
                                                      j
                                                   
                                                   s
                                                
                                                
                                                   u
                                                   s
                                                
                                                ≥
                                                
                                                   d
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                             
                                             
                                                i
                                                ∈
                                                C
                                             
                                             ,
                                             
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             M
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      s
                                                      ∈
                                                      
                                                         S
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   u
                                                   s
                                                
                                                ≤
                                                L
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                   s
                                                
                                                ≥
                                                0
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                             
                                             s
                                             ∈
                                             
                                                S
                                                ¯
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

After solving the RMP, the method searches for promising columns, i.e., columns with negative reduced cost. Let 
                           
                              (
                              
                                 π
                                 11
                                 *
                              
                              ,
                              
                                 π
                                 12
                                 *
                              
                              ,
                              …
                              ,
                              
                                 π
                                 
                                    |
                                    C
                                    |
                                    M
                                 
                                 *
                              
                              )
                           
                         and σ
                        * be the dual variables associated with constraints (12) and (13), respectively, in the optimal solution of the RMP. The reduced cost of a column us
                         is given by:

                           
                              
                                 
                                    
                                       
                                          c
                                          ˜
                                       
                                       s
                                    
                                    =
                                    1
                                    −
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          C
                                       
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       M
                                    
                                    
                                       a
                                       
                                          i
                                          j
                                       
                                       s
                                    
                                    
                                       
                                          π
                                       
                                       
                                          i
                                          j
                                       
                                       *
                                    
                                    −
                                    
                                       σ
                                       *
                                    
                                    .
                                 
                              
                           
                        
                     

Therefore, the aim is to find a schedule xij
                         ∈ {0, 1}, i = 1, … , N + 1,  j = 1, … , M, respecting constraints (1)–(5) with associated column us
                         minimising the above expression. Relations (6) enable such pricing subproblem to be written as follows:

                           
                              
                                 
                                    
                                       max
                                       
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             C
                                          
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          M
                                       
                                       
                                          ∑
                                          
                                             r
                                             =
                                             1
                                          
                                          
                                             
                                                t
                                                i
                                             
                                             −
                                             
                                                o
                                                i
                                             
                                             −
                                             1
                                          
                                       
                                       
                                          p
                                          
                                             i
                                             r
                                          
                                       
                                       
                                          x
                                          
                                             i
                                             ,
                                             j
                                             −
                                             
                                                o
                                                i
                                             
                                             −
                                             r
                                          
                                       
                                       
                                          π
                                          
                                             i
                                             j
                                          
                                          *
                                       
                                       
                                       
                                       s.t.
                                       
                                       
                                       x
                                       ∈
                                       X
                                       .
                                    
                                 
                              
                           
                        Let x
                        ⋆ represent the optimal solution of this subproblem. If

                           
                              
                                 
                                    1
                                    −
                                    
                                       a
                                       min
                                    
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          C
                                       
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       M
                                    
                                    
                                       ∑
                                       
                                          r
                                          =
                                          1
                                       
                                       
                                          
                                             t
                                             i
                                          
                                          −
                                          
                                             o
                                             i
                                          
                                          −
                                          1
                                       
                                    
                                    
                                       p
                                       
                                          i
                                          r
                                       
                                    
                                    
                                       x
                                       
                                          i
                                          ,
                                          j
                                          −
                                          
                                             o
                                             i
                                          
                                          −
                                          r
                                       
                                       ☆
                                    
                                    
                                       π
                                       
                                          i
                                          j
                                       
                                       *
                                    
                                    −
                                    
                                       σ
                                       *
                                    
                                    <
                                    0
                                    ,
                                 
                              
                           
                        then the column obtained from x
                        ⋆ is attractive. This column can be written as 
                           
                              (
                              
                                 a
                                 11
                                 *
                              
                              ,
                           
                        
                        
                           
                              
                                 a
                                 12
                                 *
                              
                              ,
                              …
                              ,
                              
                                 a
                                 
                                    |
                                    C
                                    |
                                    M
                                 
                                 *
                              
                              
                                 
                                    ,
                                    1
                                    )
                                 
                                 T
                              
                           
                         and be inserted in the RMP. As before, parameters 
                           
                              a
                              
                                 i
                                 j
                              
                              *
                           
                         can be obtained using the relationship given in (6).

After a new column is inserted, the RMP is solved again, and the method iterates. The optimal solution of the linear relaxation of the master problem is obtained when no column with a negative reduced cost can be found. Such an optimal solution corresponds to a lower bound for the optimal solution of the integer programming problem (7)–(10). An integer solution, in turn, can be obtained by branching on fractional us
                         variables. This is discussed in the following section.

In a branch-price-and-cut algorithm, defining an efficient branching strategy is typically more complicated than in the classical branch-and-bound method. Indeed, the standard variable dichotomy rule may compromise the structure of the subproblem as well as lead to an unbalanced tree (Vanderbeck, 2000b; Vanderbeck & Wolsey, 2010). Hence, more elaborate strategies are often required to achieve good computational performance.

We propose branching constraints of the type (Vance, 1998; Vanderbeck, 1999; 2000a):

                           
                              (15)
                              
                                 
                                    
                                       ∑
                                       
                                          s
                                          ∈
                                          Q
                                       
                                    
                                    
                                       u
                                       s
                                    
                                    ≤
                                    
                                       α
                                       ¯
                                    
                                    −
                                    1
                                    ,
                                    
                                    
                                       ∑
                                       
                                          s
                                          ∈
                                          Q
                                       
                                    
                                    
                                       u
                                       s
                                    
                                    ≥
                                    
                                       α
                                       ¯
                                    
                                    ,
                                 
                              
                           
                        which simultaneously use several RMP variables at a time. Set Q, which contains the indices of the variables in the branching constraints, and the RHS value 
                           
                              α
                              ¯
                           
                         are obtained as follows. For each i ∈ C and j = 1, … , M, we define the set

                           
                              (16)
                              
                                 
                                    
                                       S
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       {
                                       s
                                       ∈
                                       S
                                       :
                                       
                                          a
                                          
                                             i
                                             j
                                          
                                          s
                                       
                                       >
                                       0
                                       }
                                    
                                    ,
                                 
                              
                           
                        which is given by the indices of master variables us
                         with positive coefficient 
                           
                              a
                              
                                 i
                                 j
                              
                              s
                           
                         in the associated constraint (12). In other words, Sij
                         contains the indices of the columns (schedules) that contribute to the production of crop i in period j. If the following summation

                           
                              (17)
                              
                                 
                                    
                                       α
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          s
                                          ∈
                                          
                                             S
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                          u
                                          ¯
                                       
                                       s
                                    
                                 
                              
                           
                        is fractional, then Sij
                         is a candidate branching set. Q is chosen as the candidate set corresponding to pair (i, j) leading to the minimum value

                           
                              (18)
                              
                                 
                                    
                                       θ
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          s
                                          ∈
                                          
                                             S
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                    
                                       a
                                       
                                          i
                                          j
                                       
                                       s
                                    
                                    
                                       
                                          u
                                          ¯
                                       
                                       s
                                    
                                    −
                                    
                                       d
                                       
                                          i
                                          j
                                       
                                    
                                    ,
                                 
                              
                           
                        over all i ∈ C and j = 1, … , M, where θij
                         is the extra production of crop i in period j in the current solution 
                           
                              u
                              ¯
                           
                        . The value 
                           
                              
                                 
                                    α
                                    ¯
                                 
                                 
                                    i
                                    j
                                 
                              
                              =
                              
                                 ⌈
                                 
                                    α
                                    
                                       i
                                       j
                                    
                                 
                                 ⌉
                              
                           
                         is used to set 
                           
                              α
                              ¯
                           
                         in (15). By using the minimum θij
                         to define set Q, we aim at selecting a branching set composed by master variables with nonzero coefficients in an active constraint of the RMP, according to the current optimal solution. Therefore, this strategy increases the chances of effectively perturbing the RMP of the child nodes.

Alternative rules can be used to define the candidate branching sets. For instance, let 
                           
                              a
                              
                                 i
                                 j
                              
                              ☆
                           
                         be the largest coefficient in the RMP row associated with pair (i, j). The candidate branching set may be defined as follows:

                           
                              (19)
                              
                                 
                                    
                                       S
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       {
                                       s
                                       ∈
                                       S
                                       :
                                       
                                          a
                                          
                                             i
                                             j
                                          
                                          s
                                       
                                       ≥
                                       
                                          a
                                          
                                             i
                                             j
                                          
                                          ☆
                                       
                                       }
                                    
                                    .
                                 
                              
                           
                        
                     

Notice that in this case, only a subset of the master variables with a nonzero coefficient in row ij will be selected, namely those with the largest coefficient. In Section 4, we compare the impact of these two choices within the branch-price-and-cut method.

An efficient branching strategy should have a relatively small computational cost and deliver the most significant increase in the lower bounds of each child node. The branching rule proposed above uses the minimum θij
                            to decide which candidate set Sij
                            should be chosen for branching. Although this increases the chances of making an effective choice, additional analysis may be helpful to improve the quality of the branching decision. Hence, we propose a strong branching strategy (Achterberg, Koch, & Martin, 2005; Linderoth & Savelsbergh, 1999) in which we estimate the candidate branching sets that are likely to most improve the lower bounds of the generated child nodes.

For each i ∈ C and j = 1, … , M, let 
                              
                                 z
                                 
                                    i
                                    j
                                 
                                 L
                              
                            and 
                              
                                 z
                                 
                                    i
                                    j
                                 
                                 R
                              
                            be the optimal values of the two linear programming problems obtained from the current RMP after adding the constraints 
                              
                                 
                                    ∑
                                    
                                       s
                                       ∈
                                       
                                          S
                                          
                                             i
                                             j
                                          
                                       
                                    
                                 
                                 
                                    u
                                    s
                                 
                                 ≤
                                 
                                    
                                       α
                                       ¯
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 −
                                 1
                              
                            and 
                              
                                 
                                    ∑
                                    
                                       s
                                       ∈
                                       
                                          S
                                          
                                             i
                                             j
                                          
                                       
                                    
                                 
                                 
                                    u
                                    s
                                 
                                 ≥
                                 
                                    
                                       α
                                       ¯
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 ,
                              
                            respectively. No columns are generated when solving these two problems to quickly obtain 
                              
                                 z
                                 
                                    i
                                    j
                                 
                                 L
                              
                            and 
                              
                                 z
                                 
                                    i
                                    j
                                 
                                 R
                              
                           . As a result, these values only provide estimates for the lower bounds of the left and right child nodes in cases where Sij
                            is chosen as the branching set. The pair (i, j) yielding the largest estimates 
                              
                                 z
                                 
                                    i
                                    j
                                 
                                 L
                              
                            and 
                              
                                 z
                                 
                                    i
                                    j
                                 
                                 R
                              
                            is the one selected for branching in the branch-price-and-cut algorithm.

To reduce the computational cost of this search, we sort the pairs (i, j) in nondescending order of the associated values θij
                            and restrict our search to those pairs in the first positions. More specifically, we initially define set Q as the candidate set Sij
                            corresponding to the smallest θij
                           . Then, by analysing each pair (i, j) in the pre-defined order, we redefine Q whenever better values for 
                              
                                 z
                                 
                                    i
                                    j
                                 
                                 L
                              
                            and 
                              
                                 z
                                 
                                    i
                                    j
                                 
                                 R
                              
                            are found. We stop this search when Q is redefined for the second time. Typically, only few candidates are investigated using this strategy before a good quality choice is obtained, as the pairs with small θij
                            are expected to generate better branching constraints.

Some remarks are in order. In cases where the problem used to obtain 
                              
                                 z
                                 
                                    i
                                    j
                                 
                                 L
                              
                            or 
                              
                                 z
                                 
                                    i
                                    j
                                 
                                 R
                              
                            is infeasible, the associated estimate value assumes LB+2 (where LB is the current lower bound of the current node), somehow prioritising candidates that lead to pruning. Because the LHS in the constraints (15) is a summation over variables, this value might be an integer even if the individual variables are not. There is, therefore, a risk of finding no valid branching constraint. In these cases, one must use the traditional dichotomy rule, i.e., given a fractional component 
                              
                                 
                                    u
                                    ¯
                                 
                                 s
                              
                            of the optimal solution, we create two child nodes by imposing one of the following variable bounds to each subproblem

                              
                                 (20)
                                 
                                    
                                       
                                          u
                                          s
                                       
                                       ≤
                                       
                                          ⌈
                                          
                                             
                                                u
                                                ¯
                                             
                                             s
                                          
                                          ⌉
                                       
                                       −
                                       1
                                       ,
                                       
                                       
                                          u
                                          s
                                       
                                       ≥
                                       
                                          ⌈
                                          
                                             
                                                u
                                                ¯
                                             
                                             s
                                          
                                          ⌉
                                       
                                       .
                                    
                                 
                              
                           
                        

In our tests, this branching rule was rarely required.

Branching with column generation is not a trivial task. In addition to the typical difficulty in finding an effective branching strategy, we must also consider the changes they imply at the subproblem level. Branching rules of type (20) generally imply quite complex changes, as they must avoid a subset of schedules to become the optimal solutions of the subproblem. The difficulty of solving the subproblem increases for each new variable bound added to the RMP. Branching constraints of type (15) require milder modifications to the subproblem. In fact, assume that in a given node of the branch-and-bound tree we have K branching constraints in the RMP, which are determined by K branching sets Q
                           1, Q
                           2, … , QK
                           . In association with the branching constraints, we have their dual variables (δ
                           1, δ
                           2, … , δK
                           ) that must be considered at the subproblem level. Hence, for each k = 1, … , K, we add a binary variable wk
                            to the subproblem, which assumes the value 1 only if schedule x leads to a positive production of crop i at time period j, such that pair (i, j) was used to define branching set Qk
                           . This means that the index of the column resulting from this schedule must be added to the kth branching set. To ensure this relationship holds, we add the following constraint to the subproblem, for each k = 1, … , K:

                              
                                 
                                    
                                       
                                          ∑
                                          
                                             r
                                             =
                                             1
                                          
                                          
                                             
                                                t
                                                
                                                   i
                                                   k
                                                
                                             
                                             −
                                             
                                                o
                                                
                                                   i
                                                   k
                                                
                                             
                                             −
                                             1
                                          
                                       
                                       
                                          x
                                          
                                             
                                                i
                                                k
                                             
                                             ,
                                             
                                                j
                                                k
                                             
                                             −
                                             
                                                o
                                                
                                                   i
                                                   k
                                                
                                             
                                             −
                                             r
                                          
                                       
                                       =
                                       
                                          w
                                          k
                                       
                                       ,
                                    
                                 
                              
                           where ik
                            and jk
                            are the crop and period associated with the branching set Qk
                           .

When the left-hand-side of the above equation equals 1, this value signals that there is production of crop ik
                            at time period jk
                            and thus we must have wk
                            = 1. Notice that the result of this summation can be at most 1, as the production originates from a single planting (see model (1)–(5)). Finally, it remains to be mentioned that the binary variables must also be added to the objective function of the subproblem. Their costs are given by the dual variables associated with the branching constraints in the RMP. Hence, we add the following summation to the objective function of the subproblem

                              
                                 
                                    
                                       −
                                       
                                          δ
                                          1
                                       
                                       
                                          w
                                          1
                                       
                                       −
                                       
                                          δ
                                          2
                                       
                                       
                                          w
                                          2
                                       
                                       −
                                       …
                                       −
                                       
                                          δ
                                          K
                                       
                                       
                                          w
                                          K
                                       
                                       .
                                    
                                 
                              
                           
                        

The changes in the objective function must also be applied to the computation of the reduced costs. It is worth mentioning that all these required changes do not affect significantly the difficulty of solving the subproblem in practice, as we will see in the computational results presented in Section 4.2.

To improve the quality of the lower bounds provided by the master problem, we propose a family of valid inequalities. These inequalities, called the special rounding inequalities, correspond to general-purpose cuts such as the Chvátal–Gomory inequalities (Nemhauser & Wolsey, 1988). They are inspired by the dual feasible functions proposed in Fekete and Schepers (2001) for the bin-packing problem.

The special rounding inequalities are derived from constraints (8) of the RMP. They have the following form:

                              
                                 (21)
                                 
                                    
                                       
                                          ∑
                                          
                                             s
                                             ∈
                                             
                                                S
                                                ¯
                                             
                                          
                                       
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                          k
                                       
                                       
                                          (
                                          
                                             a
                                             
                                                i
                                                j
                                             
                                             s
                                          
                                          )
                                       
                                       
                                          u
                                          s
                                       
                                       ≥
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                          k
                                       
                                       
                                          (
                                          
                                             d
                                             
                                                i
                                                j
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           for each i ∈ C and j = 1, … , M, where dij
                            > 0 and 
                              
                                 
                                    a
                                    
                                       i
                                       j
                                    
                                    s
                                 
                                 ≤
                                 
                                    d
                                    
                                       i
                                       j
                                    
                                 
                                 ,
                              
                            for each 
                              
                                 s
                                 ∈
                                 
                                    S
                                    ¯
                                 
                              
                           . The family of functions 
                              
                                 
                                    F
                                    
                                       i
                                       j
                                    
                                    k
                                 
                                 :
                                 
                                    [
                                    0
                                    ,
                                    
                                       d
                                       
                                          i
                                          j
                                       
                                    
                                    ]
                                 
                                 →
                                 
                                    [
                                    0
                                    ,
                                    k
                                    +
                                    1
                                    ]
                                 
                              
                            is defined as

                              
                                 (22)
                                 
                                    
                                       
                                          
                                             F
                                             
                                                i
                                                j
                                             
                                             k
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               k
                                                               +
                                                               1
                                                               )
                                                               x
                                                            
                                                            
                                                               d
                                                               
                                                                  i
                                                                  j
                                                               
                                                            
                                                         
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         
                                                            
                                                               k
                                                               x
                                                            
                                                            
                                                               d
                                                               
                                                                  i
                                                                  j
                                                               
                                                            
                                                         
                                                         ∈
                                                         Z
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ⌈
                                                            
                                                               
                                                                  k
                                                                  x
                                                               
                                                               
                                                                  d
                                                                  
                                                                     i
                                                                     j
                                                                  
                                                               
                                                            
                                                            ⌉
                                                         
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           for 
                              
                                 k
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 
                                    d
                                    
                                       i
                                       j
                                    
                                 
                              
                            and 0 ≤ x ≤ dij
                           . Notice that 
                              
                                 
                                    F
                                    
                                       i
                                       j
                                    
                                    k
                                 
                                 
                                    (
                                    
                                       d
                                       
                                          i
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 k
                                 +
                                 1
                                 ,
                              
                            for any i ∈ C, j = 1, … , M and 
                              
                                 k
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 
                                    d
                                    
                                       i
                                       j
                                    
                                 
                              
                           . Based on Proposition 4.1 in Nemhauser and Wolsey (1988, p. 231), to verify that (21) is a valid inequality for 
                              
                                 P
                                 =
                                 
                                    Z
                                    n
                                 
                                 ∩
                                 
                                    {
                                    u
                                    ∈
                                    
                                       R
                                       +
                                       
                                          
                                             |
                                          
                                          
                                             S
                                             ¯
                                          
                                          
                                             |
                                          
                                       
                                    
                                    :
                                    
                                       ∑
                                       
                                          s
                                          ∈
                                          
                                             S
                                             ¯
                                          
                                       
                                    
                                    
                                       a
                                       
                                          i
                                          j
                                       
                                       s
                                    
                                    
                                       u
                                       s
                                    
                                    ≥
                                    
                                       d
                                       
                                          i
                                          j
                                       
                                    
                                    }
                                 
                                 ,
                              
                            it is sufficient to show that each function 
                              
                                 F
                                 
                                    i
                                    j
                                 
                                 k
                              
                            is subadditive, non-decreasing and satisfies 
                              
                                 
                                    F
                                    
                                       i
                                       j
                                    
                                    k
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 0
                              
                           . From definition (22), it is clear that 
                              
                                 
                                    F
                                    
                                       i
                                       j
                                    
                                    k
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 0
                              
                            and 
                              
                                 F
                                 
                                    i
                                    j
                                 
                                 k
                              
                            is non-decreasing. In Proposition 3.1, we show that this function is subadditive as well.

                              Proposition 3.1
                              
                                 The function Fk
                                 : [0, d] → [0, k + 1] defined as
                                 
                                    
                                       (23)
                                       
                                          
                                             
                                                
                                                   F
                                                   k
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     (
                                                                     k
                                                                     +
                                                                     1
                                                                     )
                                                                     x
                                                                  
                                                                  d
                                                               
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               if
                                                               
                                                               
                                                                  
                                                                     k
                                                                     x
                                                                  
                                                                  d
                                                               
                                                               ∈
                                                               Z
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  ⌈
                                                                  
                                                                     
                                                                        k
                                                                        x
                                                                     
                                                                     d
                                                                  
                                                                  ⌉
                                                               
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               otherwise
                                                               ,
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 is subadditive, for any
                                 
                                    
                                       d
                                       ∈
                                       
                                          Z
                                          +
                                       
                                    
                                  
                                 and k = 1, … , d such that d > 0.

To be subadditive, the function must satisfy Fk
                                 (x) + Fk
                                 (y) ≥ Fk
                                 (x + y), for any 
                                    
                                       x
                                       ,
                                       y
                                       ,
                                       x
                                       +
                                       y
                                       ∈
                                       R
                                       ∩
                                       [
                                       0
                                       ,
                                       d
                                       ]
                                    
                                 . Hence, given x, y ∈ [0, d] such that x + y ∈ [0, d], we have one out of the following possible cases:

                                    
                                       1.
                                       
                                          
                                             
                                                
                                                   
                                                      k
                                                      x
                                                   
                                                   d
                                                
                                                ,
                                                
                                                   
                                                      k
                                                      y
                                                   
                                                   d
                                                
                                                ∈
                                                Z
                                             
                                          . Hence, 
                                             
                                                
                                                   F
                                                   k
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                +
                                                
                                                   F
                                                   k
                                                
                                                
                                                   (
                                                   y
                                                   )
                                                
                                                =
                                                
                                                   
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                      (
                                                      x
                                                      +
                                                      y
                                                      )
                                                   
                                                   d
                                                
                                                =
                                                
                                                   F
                                                   k
                                                
                                                
                                                   (
                                                   x
                                                   +
                                                   y
                                                   )
                                                
                                             
                                          ;


                                          
                                             
                                                
                                                   
                                                      k
                                                      x
                                                   
                                                   d
                                                
                                                ∈
                                                Z
                                                ,
                                                
                                                   
                                                      k
                                                      y
                                                   
                                                   d
                                                
                                                ∉
                                                Z
                                             
                                          . Consequently, 
                                             
                                                
                                                   
                                                      k
                                                      (
                                                      x
                                                      +
                                                      y
                                                      )
                                                   
                                                   d
                                                
                                                ∉
                                                Z
                                             
                                          . Hence, 
                                             
                                                
                                                   F
                                                   k
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                +
                                                
                                                   F
                                                   k
                                                
                                                
                                                   (
                                                   y
                                                   )
                                                
                                                =
                                                
                                                   
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                      x
                                                   
                                                   d
                                                
                                                +
                                                
                                                   ⌈
                                                   
                                                      
                                                         k
                                                         y
                                                      
                                                      d
                                                   
                                                   ⌉
                                                
                                                ≥
                                                
                                                   
                                                      k
                                                      x
                                                   
                                                   d
                                                
                                                +
                                                
                                                   ⌈
                                                   
                                                      
                                                         k
                                                         y
                                                      
                                                      d
                                                   
                                                   ⌉
                                                
                                                =
                                                
                                                   ⌈
                                                   
                                                      
                                                         k
                                                         x
                                                      
                                                      d
                                                   
                                                   +
                                                   
                                                      
                                                         k
                                                         y
                                                      
                                                      d
                                                   
                                                   ⌉
                                                
                                                =
                                                
                                                   F
                                                   k
                                                
                                                
                                                   (
                                                   x
                                                   +
                                                   y
                                                   )
                                                
                                             
                                          ;


                                          
                                             
                                                
                                                   
                                                      k
                                                      x
                                                   
                                                   d
                                                
                                                ,
                                                
                                                   
                                                      k
                                                      y
                                                   
                                                   d
                                                
                                                ∉
                                                Z
                                                ,
                                             
                                           but 
                                             
                                                
                                                   
                                                      k
                                                      (
                                                      x
                                                      +
                                                      y
                                                      )
                                                   
                                                   d
                                                
                                                ∈
                                                Z
                                             
                                          . First, as 
                                             
                                                
                                                   k
                                                   x
                                                
                                                d
                                             
                                           and 
                                             
                                                
                                                   k
                                                   y
                                                
                                                d
                                             
                                           are fractional, then 
                                             
                                                
                                                   ⌈
                                                   
                                                      
                                                         k
                                                         x
                                                      
                                                      d
                                                   
                                                   ⌉
                                                
                                                +
                                                
                                                   ⌈
                                                   
                                                      
                                                         k
                                                         y
                                                      
                                                      d
                                                   
                                                   ⌉
                                                
                                             
                                           must be strictly larger than 
                                             
                                                
                                                   
                                                      k
                                                      x
                                                   
                                                   d
                                                
                                                +
                                                
                                                   
                                                      k
                                                      y
                                                   
                                                   d
                                                
                                             
                                          . Because 
                                             
                                                
                                                   
                                                      k
                                                      x
                                                   
                                                   d
                                                
                                                +
                                                
                                                   
                                                      k
                                                      y
                                                   
                                                   d
                                                
                                             
                                           is an integer, it follows that 
                                             
                                                
                                                   ⌈
                                                   
                                                      
                                                         k
                                                         x
                                                      
                                                      d
                                                   
                                                   ⌉
                                                
                                                +
                                                
                                                   ⌈
                                                   
                                                      
                                                         k
                                                         y
                                                      
                                                      d
                                                   
                                                   ⌉
                                                
                                                =
                                                
                                                   
                                                      k
                                                      x
                                                   
                                                   d
                                                
                                                +
                                                
                                                   
                                                      k
                                                      y
                                                   
                                                   d
                                                
                                                +
                                                1
                                             
                                          . Additionally, 
                                             
                                                x
                                                +
                                                y
                                                ∈
                                                
                                                   [
                                                   0
                                                   ,
                                                   d
                                                   ]
                                                
                                                ⇒
                                                
                                                   
                                                      x
                                                      +
                                                      y
                                                   
                                                   d
                                                
                                                ≤
                                                1
                                             
                                          . Hence, 
                                             
                                                
                                                   F
                                                   k
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                +
                                                
                                                   F
                                                   k
                                                
                                                
                                                   (
                                                   y
                                                   )
                                                
                                                =
                                                
                                                   
                                                      k
                                                      x
                                                   
                                                   d
                                                
                                                +
                                                
                                                   
                                                      k
                                                      y
                                                   
                                                   d
                                                
                                                +
                                                1
                                                ≥
                                                
                                                   
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                      (
                                                      x
                                                      +
                                                      y
                                                      )
                                                   
                                                   d
                                                
                                                =
                                                
                                                   F
                                                   k
                                                
                                                
                                                   (
                                                   x
                                                   +
                                                   y
                                                   )
                                                
                                             
                                          ;


                                          
                                             
                                                
                                                   
                                                      k
                                                      x
                                                   
                                                   d
                                                
                                                ,
                                                
                                                   
                                                      k
                                                      y
                                                   
                                                   d
                                                
                                                ,
                                                
                                                   
                                                      k
                                                      (
                                                      x
                                                      +
                                                      y
                                                      )
                                                   
                                                   d
                                                
                                                ∉
                                                Z
                                             
                                          . Thus, 
                                             
                                                
                                                   F
                                                   k
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                +
                                                
                                                   F
                                                   k
                                                
                                                
                                                   (
                                                   y
                                                   )
                                                
                                                =
                                                
                                                   ⌈
                                                   
                                                      
                                                         k
                                                         x
                                                      
                                                      d
                                                   
                                                   ⌉
                                                
                                                +
                                                
                                                   ⌈
                                                   
                                                      
                                                         k
                                                         y
                                                      
                                                      d
                                                   
                                                   ⌉
                                                
                                                ≥
                                                
                                                   ⌈
                                                   
                                                      
                                                         k
                                                         x
                                                      
                                                      d
                                                   
                                                   +
                                                   
                                                      
                                                         k
                                                         y
                                                      
                                                      d
                                                   
                                                   ⌉
                                                
                                                =
                                                
                                                   ⌈
                                                   
                                                      
                                                         k
                                                         (
                                                         x
                                                         +
                                                         y
                                                         )
                                                      
                                                      d
                                                   
                                                   ⌉
                                                
                                                =
                                                
                                                   F
                                                   k
                                                
                                                
                                                   (
                                                   x
                                                   +
                                                   y
                                                   )
                                                
                                             
                                          .

Since Fk
                                 (x) + Fk
                                 (y) ≥ Fk
                                 (x + y) in all cases, the proof is complete.□

Inequalities (21) have two advantageous properties. First, they are equivalent to or dominate a class of rank-1 Chvátal–Gomory inequalities. Second, we need to generate only those inequalities with k odd, as they dominate the inequalities obtained with other values of k. Proposition 3.2 state and prove these properties.

                              Proposition 3.2
                              
                                 Special rounding inequalities (
                                 
                                    21
                                 
                                 ) are equivalent to or dominate any rank-1 Chvátal–Gomory inequalities of the form
                                 
                                    
                                       (24)
                                       
                                          
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   
                                                      S
                                                      ¯
                                                   
                                                
                                             
                                             
                                                ⌈
                                                γ
                                                
                                                   a
                                                   
                                                      i
                                                      j
                                                   
                                                   s
                                                
                                                ⌉
                                             
                                             
                                                u
                                                s
                                             
                                             ≥
                                             
                                                ⌈
                                                γ
                                                
                                                   d
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                ⌉
                                             
                                          
                                       
                                    
                                 
                                 with
                                 
                                    
                                       γ
                                       ∈
                                       (
                                       
                                          1
                                          
                                             d
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       ,
                                       1
                                       )
                                       ,
                                    
                                  
                                 for i ∈ C, j = 1, …M and dij
                                  > 0. Moreover, the inequalities defined with
                                 
                                    
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                          k
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                    
                                  
                                 are equivalent to or dominate those defined with
                                 
                                    
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                          
                                             2
                                             k
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       ,
                                    
                                  
                                 for any k ∈ {1, … , dij
                                 } and 0 ≤ x ≤ dij
                                 .

To prove that inequalities (21) are equivalent to or dominate inequalities (24), we have to show that 
                                    
                                       
                                          ⌈
                                          γ
                                          
                                             a
                                             
                                                i
                                                j
                                             
                                             s
                                          
                                          ⌉
                                       
                                       ≥
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                          k
                                       
                                       
                                          (
                                          
                                             a
                                             
                                                i
                                                j
                                             
                                             s
                                          
                                          )
                                       
                                    
                                  whenever 
                                    
                                       
                                          ⌈
                                          γ
                                          
                                             d
                                             
                                                i
                                                j
                                             
                                          
                                          ⌉
                                       
                                       =
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                          k
                                       
                                       
                                          (
                                          
                                             d
                                             
                                                i
                                                j
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                  with 
                                    
                                       γ
                                       ∈
                                       (
                                       
                                          1
                                          
                                             d
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       ,
                                       1
                                       )
                                    
                                 . Given γ such that 
                                    
                                       
                                          ⌈
                                          γ
                                          
                                             d
                                             
                                                i
                                                j
                                             
                                          
                                          ⌉
                                       
                                       =
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                          k
                                       
                                       
                                          (
                                          
                                             d
                                             
                                                i
                                                j
                                             
                                          
                                          )
                                       
                                       =
                                       k
                                       +
                                       1
                                       ,
                                    
                                  it follows that γdij
                                  > k and hence 
                                    
                                       γ
                                       x
                                       >
                                       
                                          
                                             k
                                             x
                                          
                                          
                                             d
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       ,
                                    
                                  for any x ∈ (0, dij
                                 ). If 
                                    
                                       
                                          
                                             k
                                             x
                                          
                                          
                                             d
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       ∈
                                       
                                          Z
                                          +
                                       
                                    
                                  then 
                                    
                                       
                                          ⌈
                                          γ
                                          x
                                          ⌉
                                       
                                       ≥
                                       
                                          
                                             k
                                             x
                                          
                                          
                                             d
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       +
                                       1
                                       ≥
                                       
                                          
                                             k
                                             x
                                          
                                          
                                             d
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       +
                                       
                                          x
                                          
                                             d
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             k
                                             +
                                             1
                                             )
                                             x
                                          
                                          
                                             d
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       =
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                          k
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                    
                                 . Otherwise, 
                                    
                                       
                                          
                                             k
                                             x
                                          
                                          
                                             d
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       ∉
                                       
                                          Z
                                          +
                                       
                                    
                                  implies in 
                                    
                                       
                                          ⌈
                                          γ
                                          x
                                          ⌉
                                       
                                       ≥
                                       
                                          ⌈
                                          
                                             
                                                k
                                                x
                                             
                                             
                                                d
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                          ⌉
                                       
                                       =
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                          k
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       ,
                                    
                                  which completes the first part of the proof.

We prove now the dominance of special rounding inequalities defined with 
                                    
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                          k
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                    
                                  over those defined with 
                                    
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                          
                                             2
                                             k
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                    
                                 . From (21), it follows that

                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   
                                                      S
                                                      ¯
                                                   
                                                
                                             
                                             2
                                             
                                                F
                                                
                                                   i
                                                   j
                                                
                                                k
                                             
                                             
                                                (
                                                
                                                   a
                                                   
                                                      i
                                                      j
                                                   
                                                   s
                                                
                                                )
                                             
                                             
                                                u
                                                s
                                             
                                             ≥
                                             2
                                             k
                                             +
                                             2
                                             ,
                                          
                                       
                                    
                                 as 
                                    
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                          k
                                       
                                       
                                          (
                                          
                                             d
                                             
                                                i
                                                j
                                             
                                          
                                          )
                                       
                                       =
                                       k
                                       +
                                       1
                                    
                                 . On the other hand, we have also from (21) that

                                    
                                       (25)
                                       
                                          
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   
                                                      S
                                                      ¯
                                                   
                                                
                                             
                                             
                                                F
                                                
                                                   i
                                                   j
                                                
                                                
                                                   2
                                                   k
                                                
                                             
                                             
                                                (
                                                
                                                   a
                                                   
                                                      i
                                                      j
                                                   
                                                   s
                                                
                                                )
                                             
                                             
                                                u
                                                s
                                             
                                             ≥
                                             2
                                             k
                                             +
                                             1
                                             .
                                          
                                       
                                    
                                 For any feasible solution of the master problem we have that 
                                    
                                       
                                          ∑
                                          
                                             s
                                             ∈
                                             
                                                S
                                                ¯
                                             
                                          
                                       
                                       
                                          u
                                          s
                                       
                                       ≥
                                       1
                                    
                                 . Using this fact and (25), we can write

                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   
                                                      S
                                                      ¯
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   F
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      2
                                                      k
                                                   
                                                
                                                
                                                   (
                                                   
                                                      a
                                                      
                                                         i
                                                         j
                                                      
                                                      s
                                                   
                                                   )
                                                
                                                +
                                                1
                                                )
                                             
                                             
                                                u
                                                s
                                             
                                             ≥
                                             2
                                             k
                                             +
                                             2
                                             .
                                          
                                       
                                    
                                 
                              

Following the same reasoning of the first part of the proof, it suffices to show now that 
                                    
                                       
                                          (
                                          
                                             F
                                             
                                                i
                                                j
                                             
                                             
                                                2
                                                k
                                             
                                          
                                          
                                             (
                                             
                                                a
                                                
                                                   i
                                                   j
                                                
                                                s
                                             
                                             )
                                          
                                          +
                                          1
                                          )
                                       
                                       ≥
                                       2
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                          k
                                       
                                       
                                          (
                                          
                                             a
                                             
                                                i
                                                j
                                             
                                             s
                                          
                                          )
                                       
                                    
                                 . Indeed, we have one out of the following three cases:

                                    
                                       1.
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      k
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                ∉
                                                Z
                                             
                                          . In such case, 
                                             
                                                
                                                   
                                                      k
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                ∉
                                                Z
                                             
                                          . Hence, 
                                             
                                                2
                                                
                                                   F
                                                   
                                                      i
                                                      j
                                                   
                                                   k
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                =
                                                2
                                                
                                                   ⌈
                                                   
                                                      
                                                         k
                                                         x
                                                      
                                                      
                                                         d
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                   
                                                   ⌉
                                                
                                                =
                                                
                                                   ⌈
                                                   
                                                      
                                                         k
                                                         x
                                                      
                                                      
                                                         d
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                   
                                                   ⌉
                                                
                                                +
                                                
                                                   ⌈
                                                   
                                                      
                                                         k
                                                         x
                                                      
                                                      
                                                         d
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                   
                                                   ⌉
                                                
                                                ≤
                                                
                                                   ⌈
                                                   
                                                      
                                                         2
                                                         k
                                                         x
                                                      
                                                      
                                                         d
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                   
                                                   ⌉
                                                
                                                +
                                                1
                                                =
                                                
                                                   F
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      2
                                                      k
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                +
                                                1
                                                .
                                             
                                          
                                       


                                          
                                             
                                                
                                                   
                                                      k
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                ∈
                                                Z
                                                ,
                                             
                                           so that 
                                             
                                                
                                                   
                                                      2
                                                      k
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                ∈
                                                Z
                                             
                                          . Hence, 
                                             
                                                2
                                                
                                                   F
                                                   
                                                      i
                                                      j
                                                   
                                                   k
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                =
                                                2
                                                
                                                   
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                             
                                           and 
                                             
                                                
                                                   F
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      2
                                                      k
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                +
                                                1
                                                =
                                                
                                                   
                                                      (
                                                      2
                                                      k
                                                      +
                                                      1
                                                      )
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                +
                                                1
                                                =
                                                
                                                   
                                                      2
                                                      k
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                +
                                                
                                                   x
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                +
                                                1
                                                ≥
                                                
                                                   
                                                      2
                                                      k
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      2
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                ,
                                             
                                           as 
                                             
                                                
                                                   x
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                ≤
                                                1
                                             
                                          . As a result, 
                                             
                                                
                                                   F
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      2
                                                      k
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                +
                                                1
                                                ≥
                                                
                                                   
                                                      2
                                                      k
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      2
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                ≥
                                                2
                                                
                                                   
                                                      (
                                                      k
                                                      +
                                                      1
                                                      )
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                =
                                                2
                                                
                                                   F
                                                   
                                                      i
                                                      j
                                                   
                                                   k
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                             
                                          .


                                          
                                             
                                                
                                                   
                                                      2
                                                      k
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                ∈
                                                Z
                                             
                                           and 
                                             
                                                
                                                   
                                                      k
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                ∉
                                                Z
                                             
                                          . Hence, 
                                             
                                                2
                                                
                                                   ⌈
                                                   
                                                      
                                                         k
                                                         x
                                                      
                                                      
                                                         d
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                   
                                                   ⌉
                                                
                                                −
                                                2
                                                
                                                   
                                                      k
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                <
                                                2
                                             
                                           which implies that 
                                             
                                                2
                                                ⌈
                                                
                                                   
                                                      k
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                ⌉
                                                −
                                                2
                                                
                                                   
                                                      k
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                =
                                                1
                                             
                                          . It follows that 
                                             
                                                2
                                                
                                                   ⌈
                                                   
                                                      
                                                         k
                                                         x
                                                      
                                                      
                                                         d
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                   
                                                   ⌉
                                                
                                                =
                                                1
                                                +
                                                2
                                                
                                                   
                                                      k
                                                      x
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                =
                                                1
                                                +
                                                
                                                   ⌈
                                                   2
                                                   
                                                      
                                                         k
                                                         x
                                                      
                                                      
                                                         d
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                   
                                                   ⌉
                                                
                                             
                                          .

Since 
                                    
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                          
                                             2
                                             k
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       
                                          
                                             (
                                             2
                                             k
                                             +
                                             1
                                             )
                                             x
                                          
                                          
                                             d
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                  and 
                                    
                                       2
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                          k
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       2
                                       
                                          ⌈
                                          
                                             
                                                k
                                                x
                                             
                                             
                                                d
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                          ⌉
                                       
                                       ,
                                    
                                  we obtain from the above implications that 
                                    
                                       2
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                          k
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                          
                                             2
                                             k
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       +
                                       1
                                       ,
                                    
                                  which completes the proof. □

The separation of special rounding inequalities can be achieved with a simple full enumeration algorithm, which is called each time the column generation algorithm converges. The violated inequalities of type (21) are added to the RMP and the process is restarted until no violated inequality is found.

Similar to the discussion presented in Section 3.2, adding the special rounding inequalities to the RMP also requires modifying the subproblem to take into account the corresponding dual variables. However because each valid inequality is based on the coefficients of a single master constraint of type (12), the original dual variable can be used and we do not need to create any additional variable in the subproblem. More specifically, let ip
                            ∈ C, jp
                            ∈ {1, … , M} and 
                              
                                 
                                    k
                                    p
                                 
                                 ∈
                                 
                                    {
                                    1
                                    ,
                                    ⋯
                                    ,
                                    
                                       d
                                       
                                          
                                             i
                                             p
                                          
                                          
                                             j
                                             p
                                          
                                       
                                    
                                    }
                                 
                              
                            be the parameters that were used to generate the pth valid inequality in the RMP. Let σp
                            be the dual variable for constraint (12) associated with such parameters. The subproblem is then modified by adding the term 
                              
                                 
                                    F
                                    
                                       
                                          i
                                          p
                                       
                                       
                                          j
                                          p
                                       
                                    
                                    
                                       k
                                       p
                                    
                                 
                                 
                                    (
                                    
                                       a
                                       min
                                    
                                    
                                       p
                                       
                                          
                                             i
                                             p
                                          
                                          r
                                       
                                    
                                    )
                                 
                                 
                                    σ
                                    p
                                 
                              
                            to the cost of each variable 
                              
                                 
                                    x
                                    
                                       
                                          i
                                          p
                                       
                                       ,
                                       
                                          j
                                          p
                                       
                                       −
                                       
                                          o
                                          
                                             i
                                             p
                                          
                                       
                                       −
                                       r
                                    
                                 
                                 ,
                              
                            for 
                              
                                 r
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    t
                                    
                                       i
                                       p
                                    
                                 
                                 −
                                 
                                    o
                                    
                                       i
                                       p
                                    
                                 
                                 −
                                 1
                              
                           . Needless to say, the changes in the objective function must also be applied to the computation of the reduced costs. As it was the case when adding branching constraints, the changes required by the valid inequalities did not significantly increase the difficulty of solving the subproblem.

Primal heuristics are typically useful to accelerate the convergence of a branch-and-price algorithm. Hence, we propose two simple heuristic procedures to improve the performance of the branch-price-and-cut method, namely the rounding heuristic (RH) and the constructive heuristic (CH).

The RH is called just before the branching procedure, after the column generation has finished. The purpose of this heuristic is to obtain a feasible integer solution based on the columns currently available at the last solved RMP. The heuristic works by simply imposing integrality to the master variables and then calling a generic MIP solver for a limited amount of time. At the end of this procedure, if a feasible solution is found, this solution corresponds to a feasible solution of the original problem (7)–(10). MIP-based heuristics have been widely used in the column generation literature (Joncour, Michel, Sadykov, Sverdlov, & Vanderbeck, 2010). Although very simple, they have shown to be powerful in practice, in special for the case we address here, as we will verify later in Section 4.2.4.

The CH is a classical residual heuristic that is called in the middle of the column generation procedure. The main purpose of this heuristic is to find an integer solution that is feasible for the original MP (7)–(10). In addition, it helps in the diversification of the types of columns obtained in the column generation procedure. At each iteration of this heuristic, a new column is generated by calling a modified version of the subproblem. The schedules corresponding to the generated columns are combined to provide a tentative solution, which may lead to a feasible solution when the heuristic procedure terminates.

We may call the CH during any iteration of the column generation procedure after solving the subproblem and obtaining an attractive new column. To describe the heuristic procedure, let 
                              
                                 d
                                 ˜
                              
                            be the residual demand vector, which is initially defined as the original demand d. Additionally, let 
                              
                                 
                                    (
                                    1
                                    ,
                                    
                                       a
                                       11
                                       ′
                                    
                                    ,
                                    
                                       a
                                       12
                                       ′
                                    
                                    ,
                                    …
                                    ,
                                    
                                       a
                                       
                                          |
                                          C
                                          |
                                          M
                                       
                                       ′
                                    
                                    ,
                                    1
                                    )
                                 
                                 T
                              
                            represent the last generated column. The procedure begins by adding this column to the current RMP, setting 
                              
                                 d
                                 ˜
                              
                            as the right-hand side and then solving this problem. Using the entries of the column and 
                              
                                 
                                    d
                                    ˜
                                 
                                 ,
                              
                            we compute the value

                              
                                 
                                    
                                       
                                          u
                                          ′
                                       
                                       =
                                       min
                                       
                                          {
                                          
                                             ⌈
                                             
                                                
                                                   
                                                      d
                                                      ˜
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                
                                                   a
                                                   
                                                      i
                                                      j
                                                   
                                                   ′
                                                
                                             
                                             ⌉
                                          
                                          :
                                          
                                             
                                                d
                                                ˜
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          >
                                          0
                                          
                                          and
                                          
                                          
                                             a
                                             
                                                i
                                                j
                                             
                                             ′
                                          
                                          >
                                          0
                                          ;
                                          
                                             i
                                             ∈
                                             C
                                          
                                          ;
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          M
                                          }
                                       
                                       ,
                                    
                                 
                              
                           which corresponds to the minimum relative area required to satisfy at least one of the demand values 
                              
                                 
                                    d
                                    ˜
                                 
                                 
                                    i
                                    j
                                 
                              
                            by the corresponding production 
                              
                                 a
                                 
                                    i
                                    j
                                 
                                 ′
                              
                           . The resulting u′ is used to fix the current column in the tentative solution, i.e., the schedule used to generate the column is assigned to a plot of relative size u′, as part of a potential feasible solution of the original problem. After computing u′, we update the residual demand as follows:

                              
                                 
                                    
                                       
                                          
                                             d
                                             ˜
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       max
                                       
                                          {
                                          
                                             
                                                d
                                                ˜
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          −
                                          
                                             u
                                             ′
                                          
                                          
                                             a
                                             
                                                i
                                                j
                                             
                                             ′
                                          
                                          ,
                                          0
                                          }
                                       
                                       ,
                                       
                                       
                                       for
                                       
                                       
                                          i
                                          ∈
                                          C
                                       
                                       ,
                                       
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       M
                                       .
                                    
                                 
                              
                           
                        

In the case 
                              
                                 
                                    
                                       d
                                       ˜
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 0
                              
                            for all i ∈ C, j = 1, … , M, the tentative solution is complete and feasible for the original MP (7)–(10), and thus the procedure terminates. Otherwise, a new column should be generated through another call to the subproblem. In our implementation, we use a modified version of the subproblem, in which the objective function is adjusted according to the residual demand 
                              
                                 d
                                 ˜
                              
                           . For each variable xij
                            in the subproblem, with i ∈ C and j = 1, … , M, we assign the residual cost

                              
                                 
                                    
                                       
                                          c
                                          
                                             i
                                             j
                                          
                                          res
                                       
                                       =
                                       
                                          ∑
                                          
                                             r
                                             =
                                             1
                                          
                                          
                                             
                                                t
                                                i
                                             
                                             −
                                             
                                                o
                                                i
                                             
                                             −
                                             1
                                          
                                       
                                       
                                          a
                                          min
                                       
                                       
                                          p
                                          
                                             i
                                             r
                                          
                                       
                                       
                                          
                                             d
                                             ˜
                                          
                                          
                                             i
                                             ,
                                             j
                                             +
                                             
                                                o
                                                i
                                             
                                             +
                                             r
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

The rationale behind this idea is to force the subproblem to generate schedules for the production of crops in time periods for which there is still a residual demand. After solving this subproblem, a new column is generated and the process is repeated. Calling the CH at each iteration of the column generation algorithm may be computationally expensive. Hence, we call the CH heuristic periodically (e.g., at every five outer iterations of column generation and at every 10 nodes of the branch-and-price tree). In Section 4.2.4, we present computational experiments to show the behaviour of this heuristic when it is embedded in the branch-price-and-cut algorithm.

In this section the performance of the BPC method is assessed through computational experiments. To test the proposed method we developed a C++ implementation on top of the CPLEX 12.4 Concert Library, which is used to solve each RMP and subproblem.

We generated a set of CRSP instances based on real-life data obtained from a producer in Barbacena, in the countryside of Brazil (21 degrees 3 arcminutes 30 arcseconds S and 43 degrees 46 arcminutes 25 arcseconds W, 1165 metres above sea level). The original dataset included 26 crops with their different planting and growing times and productivities (Santos, Costa et al., 2010). This set was used to randomly generate classes of instances with different planning horizons, namely M = 48 and 96 periods, corresponding to 1 and 2 years, respectively. At each period, a percentage (df
                        ) of the possible harvesting periods of each crop (according to periods of crop planting) was assumed to have positive demands, with df
                         = 20–50 percent or 60–90 percent. These assumptions yielded four classes, which we designate P48-20/50, P48-60/90, P96-20/50 and P96-60/90. Each of these classes contains 15 instances with different numbers of crops (five instances for each N = 10, 15, and 20). In all experiments, a
                        min has been fixed at 1 square metre and the initial L has been set to 50, 000, a sufficiently large value so that no instance would become infeasible.

@&#RESULTS@&#

We are interested in the overall performance of the proposed BPC method, as well as in the effect of the various features of the algorithm discussed in the previous sections. The complete version of this method has been implemented with the following features:

                           
                              •
                              The strong branching strategy presented in Section 3.2 and using branching sets (16) which includes all variables with positive coefficients in the constraint;

The special rounding valid inequality (SR) proposed in Section 3.3. The separation procedure is called at every node, when the column generation procedure finishes;

The rounding heuristic (RH) described in Section 3.4.1. This heuristic is called once at every 50 processed nodes (the first time being in the root node) and is allowed to run for at most 100 seconds in each call;

The constructive heuristic (CH) described in Section 3.4.2. This heuristic is called once at every five outer iterations of column generation, but only at every 10 processed nodes (the first time being in the root node);

Best-bound search node selection strategy.

We have chosen this configuration based on the performances observed in preliminary computational experiments with different versions of the BPC method. Some of these experiments are later summarised in this section. Before that, we present and analyse the overall results of the complete version. To obtain these results, we have limited the maximum running time to 1 hour.


                           Table 1
                            shows the results of solving the CRSP instances using the complete version of the proposed BPC method. For each instance, the first two columns of Table 1 give the class and the name of the instance, respectively. The name is given in the format N–k, where N is the number of crops and k is the instance identifier. The third column (UB) gives the value of the best integer solution found by the method. The fourth column (Gap) shows the relative gap (in percent) between the UB value and the best lower bound (LB) found by the method. This gap is computed as 100(UB − LB)/(10−10 + UB). The relative gap at the root node is given on the fifth column (Gap root) and is computed using the UB and LB available at the end of the root node, just before branching and after solving the rounding heuristic. Columns 6 and 7 give the total number of nodes (Nodes) and cuts (Cuts) generated in the branching tree, respectively. Columns 8–11 give the total CPU time (Total), the CPU time spent in the root node only (Root), the total CPU time spent solving all the pricing subproblems and the total CPU time spent with the rounding heuristic (Rounding), all in seconds. The time spent in the root node includes the time required by the first run of the rounding heuristic. The instances that reached the maximum running time are marked with the symbol ‘*’ in the total CPU time column. Finally, the last two columns of Table 1 show the number of processed nodes and the elapsed time needed to find the best integer solution corresponding to the UB value.

The results in Table 1 show that the proposed BPC algorithm was able to solve all instances to 1 percent-optimality (i.e., with a relative gap less than or equal to 1 percent). Moreover, most of the instances could be solved to optimality. The class P96-60/90 was the most challenging for the method, as many instances could not be solved to optimality with the imposed maximum running time. On the other hand, class P96-20/50 was the easiest, as the method could solve to optimality all of the instances in this class. The total CPU time and the number of nodes were typically small for the instances solved to optimality. In most of the instances, the best integer solution was found at the root node (node 0) by using the rounding heuristic. Nevertheless, branching was useful in several instances to reduce the relative gap and to prove optimality.

Having discussed the overall performance of the proposed BPC method, we are interested now in analysing the effect of each component of this algorithm. Hence, in the following subsections, we present the results of computational experiments with different variants of the method. For the sake of clarity, we analyse the performance of these variants in terms of the percentage of proven optimal solutions obtained in 1 hour of running time. To evaluate each of these individual algorithm aspects, we present the results obtained when a single feature is turned off at a time. In all of the tables below, the first column gives the name of the instance class; columns 2–4 present the results for the complete (best) version of the algorithm; and the remaining columns present the results for other versions of the algorithm. For each version, the tables show the percentage of instances that were solved to optimality (Opt), to 0.1 percent-optimality (≤0.1), and to 1 percent-optimality (≤1).


                           Table 2
                            presents the percentages of optimal, 0.1 percent-optimal and 1 percent-optimal solutions for different variants of the branching strategy proposed in Section 3.2. We have included the results of the following strategies:

                              
                                 •
                                 Rule 1: The standard strategy used in the complete version of the algorithm;

Rule 2: Same configuration as in Rule 1, except for not using strong branching. The candidate branching sets are analysed in the nondescending order of values θij
                                     for each row ij, as described in Section 3.2;

Rule 3: Same configuration as in Rule 1, but using (19) as branching set;

Rule 4: Same configuration as in Rule 1, but using strong branching with the variable dichotomy rule described in (20).

The results indicate that Rule 1 (which includes all proposed features) is indeed the most efficient algorithmic version, as optimality was proven for a larger percentage of instances. By comparing Rules 1 and 2, we were able to observe the importance of using the strong branching technique. The choice of an appropriate branching set is also important, as fewer instances were solved to optimality using Rule 3. As expected, using the variable dichotomy rule (Rule 4) resulted in a drastic reduction of the method’s performance, even though the strong branching technique was still used. Computational experiments using Rules 3 and 4 without using strong branching yielded significantly worse results. A number of other variants of the addressed rules were also tested during the computational experiments, but none of them presented interesting results.

In this section, we compare different versions of the BPC method regarding the use of valid inequalities. The complete version of the method uses the special rounding (SR) inequality, as proposed in Section 3.3. The first variant that we consider does not use any valid inequality, while the second one uses only the rank-1 Chvátal–Gomory (ChG) inequality. As mentioned earlier, the SR inequality dominates the ChG inequality. The results presented in Table 3
                            indicate that only the proposed SR inequalities were beneficial to the convergence of the algorithm. On the other hand, the bound improvement obtained by the use of the ChG inequalities did not compensate for the time spent generating them, as the overall performance of the corresponding variant was worse than the performance of the variant that did not rely on any valid inequality.

In Section 3.4, we described two primal heuristics to be used within the BPC method, namely the rounding heuristic (RH) and the constructive heuristic (CH). Table 4
                            presents the results obtained with different configurations of the method regarding the use of these heuristics: when CH and RH are both used (CH: yes, RH: yes), when only one is used (CH: no, RH: yes/CH: yes, RH: no), and when both are ignored (CH: no, RH: no). The results indicate that RH is crucial for improving the convergence of the method. Indeed, the performance of the method was considerably affected when this heuristic was disregarded. On the other hand, all instances could be solved within a 1 percent optimality gap when this heuristic was used. Regarding CH, the percentages in Table 4 lead to a mixed conclusion. By comparing the case in which both heuristics are ignored against the case using CH alone, the constructive heuristic has a negative effect on convergence. Nevertheless, when RH is present, the inclusion of CH improves performance. One possible explanation for this result is that CH generates extra columns that have little value by themselves but can be usefully incorporated in the rounding procedure of RH.

In this section, we analyse how the performance of the complete version of the algorithm varies when the demands are increased. Table 5
                            shows the results for the following different demand scenarios: using the original demands dij
                            of the instances (Original demand), using dij
                            multiplied by two (Demand * 2), and using dij
                            multiplied by four (Demand * 4). No clear conclusions can be drawn from these results because in some cases the performance was slightly improved whereas in others, the performance was slightly degraded. More importantly, however, these results appear to suggest that the method is robust to demand variations, as it was still able to solve all instances within 1 percent of optimality (considering the same 1 hour running time limit).


                           Table 5 can also be seen as an analysis of different values for the a
                           min parameter, as increasing all the demand is equivalent to reducing the size of the minimum accepted plot. These results indicate that the method seems to be robust to variations on this parameter.

@&#CONCLUSIONS@&#

Here, we have addressed a sustainable vegetable crop rotation scheduling problem with the goal of minimising the planting area while supplying the given demands and respecting standardised plot sizes. The production of vegetables usually occurs in coupled sequential harvesting periods, which differentiates this situation from other multi-period scheduling problems, such as the cutting stock problem. The existence of multiple harvests, in which a single planting might supply the demands for various future periods, is associated with the need to use integer variables to model the requirement of standard plot sizes and the fact that real-life instances usually address a large number of periods, making this a very difficult combinatorial problem. To solve this problem, we have proposed a branch-price-and-cut method that incorporates enhanced features, such as a strong branching strategy using branching sets, a family of newly developed subadditive valid inequalities, and primal heuristics procedures.

To verify the performance of the proposed method, we randomly generated four classes of instances based on real-life data. The results of the computational experiments on these instances suggest that the resulting method is efficient and robust to demand variation. Most of the instances could be solved to optimality. The relative gap of the 16 instances for which optimality was not achieved was less than 1 percent. In addition, we analysed the impact of the main features of the method on its overall performance. Our analyses indicate that the column generation combined within a MIP-based rounding heuristic at the root node could be used to provide high quality solutions and are probably sufficient in practice. Nevertheless, branching could improve both lower and upper bounds for a number of instances. The strong branching technique and the proposed valid inequalities contributed significantly to the improvement of the performance of the branch-price-and-cut method. Furthermore, primal heuristics were shown to be crucial to the accelerated convergence of the method.

Future research in this area should incorporate additional aspects that might make the obtained solutions even more suitable in practice, including a multi-objective analysis of factors as total area, number of plots and other ecologically based criteria.

@&#ACKNOWLEDGEMENTS@&#

The authors would like to thank the anonymous referees for their valuable contributions to this paper. This research was supported by Fundação Arthur Bernardes (FUNARBE), Brazil.

@&#REFERENCES@&#

