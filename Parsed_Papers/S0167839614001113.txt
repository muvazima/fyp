@&#MAIN-TITLE@&#Biquintic 
                  
                     
                        G
                     
                     
                        2
                     
                  
                surfaces via functionals

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Multi-sided holes in a bicubic patch complex are filled by a curvature-continuous cap.


                        
                        
                           
                           The cap is of degree bi-5 and has good and flexible shape.


                        
                        
                           
                           The space of n-sided 
                                 
                                    
                                       G
                                    
                                    
                                       2
                                    
                                 
                               caps of degree bi-5 is explored via functionals.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Curvature continuity

Surface

Functionals

Multi-sided

G2

Reparameterization

@&#ABSTRACT@&#


               Graphical abstract
               
                  
               
               
                  
               
            

@&#INTRODUCTION@&#

Tensor-product splines of degree bi-3 represent the simplest choice for creating curvature continuous surfaces for a regular grid-like layout. Several such regular grids can be joined into a bi-cubic 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      surface complex leaving multi-sided holes to be filled. When the surfaces are to be completed by curvature-continuous (
                        
                           
                              G
                           
                           
                              2
                           
                        
                     ) multi-sided blends, the construction of degree bi-5 in Karčiauskas and Peters (2013) is likely to be of least polynomial degree – unless the shape is compromised. The construction in Karčiauskas and Peters (2013) leverages several carefully-chosen reparameterizations and intermediate, structurally simpler ‘guide surfaces’ to, step-by-step, establish the surface shape by prolonging and distributing curvature from the bi-cubic complex into a multi-sided cap. By generating well-shaped n-sided curvature continuous surface caps for a wide variety of challenging input data, the construction established that the space of bi-5 patches is sufficiently rich for such high-end modeling.

The main point of this paper is to further explore the space of bi-5 constructions, but without intermediate guide surfaces. To control the many degrees of freedom that surface caps of degree bi-5 offer after enforcing smoothness, we tested a variety of functionals that act separately on each of the coordinates f of the surface cap and have the form
                        
                           (1)
                           
                              
                                 
                                    F
                                 
                                 
                                    κ
                                 
                              
                              f
                              :
                              =
                              
                                 ∫
                                 0
                                 1
                              
                              
                                 ∫
                                 0
                                 1
                              
                              
                                 ∑
                                 
                                    i
                                    +
                                    j
                                    =
                                    κ
                                    ,
                                    i
                                    ,
                                    j
                                    ≥
                                    0
                                 
                              
                              
                                 
                                    κ
                                    !
                                 
                                 
                                    i
                                    !
                                    j
                                    !
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          ∂
                                       
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    f
                                    (
                                    s
                                    ,
                                    t
                                    )
                                    
                                       
                                          ∂
                                       
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    f
                                    (
                                    s
                                    ,
                                    t
                                    )
                                    )
                                 
                                 
                                    2
                                 
                              
                              d
                              s
                              d
                              t
                              ,
                           
                        
                      as well as their tensor-analogues 
                        
                           
                              F
                           
                           
                              κ
                           
                           
                              ⁎
                           
                        
                        f
                        :
                        =
                        
                           
                              ∫
                           
                           
                              0
                           
                           
                              1
                           
                        
                        
                           
                              ∫
                           
                           
                              0
                           
                           
                              1
                           
                        
                        
                           
                              (
                              
                                 
                                    ∂
                                 
                                 
                                    s
                                 
                                 
                                    κ
                                 
                              
                              f
                              (
                              s
                              ,
                              t
                              )
                              )
                           
                           
                              2
                           
                        
                        +
                        
                           
                              (
                              
                                 
                                    ∂
                                 
                                 
                                    t
                                 
                                 
                                    κ
                                 
                              
                              f
                              (
                              s
                              ,
                              t
                              )
                              )
                           
                           
                              2
                           
                        
                        d
                        s
                        d
                        t
                     . The functional 
                        
                           
                              F
                           
                           
                              4
                           
                           
                              ⁎
                           
                        
                      was used in Loop (2004), Loop and Schaefer (2008) and combinations 
                        
                           
                              F
                           
                           
                              2
                           
                        
                        +
                        λ
                        
                           
                              F
                           
                           
                              1
                           
                        
                      for various λ have been used to approximate functionals based on first and second fundamental forms (e.g. Halstead et al., 1993; Greiner, 1994, 1996; Loos et al., 1999; Westgaard and Nowacki, 2001; Sarraga, 2000; the last additionally applies 
                        
                           
                              F
                           
                           
                              3
                           
                        
                     ). Setting degrees of freedom by such functionals may be considered less predictable (see Fig. 1
                     
                     ) than successive approximation via guide surfaces, since the effect of minimizing such a functional over a complex blend of splines is difficult to predict – and may even fail to yield well-distributed highlight lines as our extensive experiments for 3-sided caps revealed. However, for 
                        n
                        >
                        4
                     , we could always find some functional that achieved quality comparable to Karčiauskas and Peters (2013) over all test cases: 
                        
                           
                              F
                           
                           
                              4
                           
                        
                      works well for caps of valence 
                        n
                        =
                        5
                     , 
                        
                           
                              F
                           
                           
                              5
                           
                        
                      for 
                        n
                        =
                        6
                     , 
                        
                           
                              F
                           
                           
                              7
                           
                        
                      for 
                        n
                        =
                        7
                      and 
                        
                           
                              F
                           
                           
                              8
                           
                        
                      for 
                        n
                        =
                        8
                      and beyond. For 
                        n
                        =
                        3
                     , all tested functionals failed to yield satisfactory highlight lines, i.e. yielded poorly distributed highlight lines on at least one and typically many test cases. But we discovered a simpler guided construction whose quality is on par with Karčiauskas and Peters (2013).


                     Overview. Section 2 gives an overview of the cap construction. Section 3 provides the details and summarizes the algorithm. Section 4 focuses on the special case 
                        n
                        =
                        3
                     . Section 5 shows the result of the modeling with functionals for challenging input configurations, and compares the new approach to Karčiauskas and Peters (2013), Loop and Schaefer (2008), as well as to Catmull–Clark subdivision (Catmull and Clark, 1978). First, we review the literature.

Curvature continuous n-sided surface cap constructions have to be able to locally model any and all quadratic expansions at the central n-valent extra-ordinary point – and some cubic expansions to match higher-order saddles. Otherwise we would simply extend the boundary data to a plane and generate a flat facet to satisfy curvature continuity. This requirement of ‘flexibility’ (local approximation order) forces a minimal polynomial degree for piecewise polynomial surface constructions. For example, flexible 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         tensor-product caps based on quad meshes (and with possibly adjacent extraordinary points of valence 
                           n
                           ≠
                           4
                        ) must have degree bi-3 or higher (and then 
                           3
                           ×
                           3
                         polynomial pieces per quad) to avoid flat spots when modeling higher-order saddles (Peters and Fan, 2009). A similar lower bound theorem for 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         surfaces is not yet proven, but it appears unlikely that a flexible 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         cap of a 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         bicubic B-spline complex can be constructed exclusively with polynomial patches of degree bi-4; or that such caps can always be constructed using just one bi-5 patch per quad. For, while the bi-5 construction in Gregory and Zhou (1999) is interesting from an algebraic point of view, the resulting shape generally disappoints, see Fig. 3
                        .

Focusing on constructions that use a finite number of tensor-product spline pieces arranged in an unrestricted patch layout, the constructions of Grimm and Hughes (1995), Cotrina Navau and Pla Garcia (2000) are high-degree rational and Ying and Zorin (2004) use root and exponential functions. (Flexibility with degree bi-3 can be achieved for ‘polar configurations’ via subdivision. But here we focus on the more common ‘star-like’ configurations of Catmull–Clark subdivision (Catmull and Clark, 1978), and allow only a finite number of polynomial pieces.) Among polynomial 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         constructions using a single patch per quad, the degree can be as high as bi-18 (Gregory and Hahn, 1989). The degree of Ye (1997), Kiciak (2013) is bi-9. The constructions in Prautzsch (1997), Reif (1998) offer solutions of degree bi-6 – but only if their flexibility is restricted to second order. To attain third order flexibility, as is necessary to correctly model higher-order saddles, the constructions in Prautzsch (1997), Reif (1998) need to be of degree bi-9. The constructions of Loop (2004), Loop and Schaefer (2008) explore the space of degree bi-7 surfaces to fill an n-sided hole in a bi-3 spline complex. The formulas of Loop and Schaefer (2008) were derived by minimizing 
                           
                              
                                 F
                              
                              
                                 4
                              
                              
                                 ⁎
                              
                           
                        .

To separate central points, i.e. extraordinary points where more or less than four patches meet, or to reduce the sudden change in curvature at the transition between the cap and the surrounding bi-cubic surface, a number of surface constructions assume that the input control net is the result of two or more Catmull–Clark refinement steps. Such preprocessing may introduce shape problems due to the dominance of the hyperbolic terms (Karčiauskas et al., 2004).

Guiding polynomials were introduced in Prautzsch (1997), Reif (1998) primarily to ensure 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         continuity at the central point of the cap. Entire polynomials were also chosen as ‘guide shapes’ in the non-rational constructions (Ying and Zorin, 2004 and Levin, 2006). Restricting the guides to be entire polynomials makes the resulting surfaces less flexible than using piecewise polynomial guides (Peters, 2002). For controlling shape, ‘guided splines’ (Karčiauskas and Peters, 2009) specifically advocate the use of piecewise guides over (global) optimization via functionals. The construction in Karčiauskas and Peters (2013) refined and improved this approach. Here, we revisit optimization via functionals, but only after careful reparameterization of the boundary data.

As illustrated in Fig. 4
                     , our space of spline caps consists of n four-sided patches that each consist of 
                        2
                        ×
                        2
                      bi-5 pieces.


                     Definitions and setup. We consider a network of quadrilateral facets or quads with vertices called control points. These control points are called regular points if they are surrounded by four quads and star points when surrounded by more or fewer than four quads. The analogous surface point, where more or fewer than four surface pieces (patches) meet, are called central points.

We assume, for simplicity of exposition, that each star point is surrounded by at least one layer of regular points. We denote as cap-net 
                     c the two-ring of one star point, i.e. the star point plus 6n points forming two layers of quads surrounding it. (Note that the second layer of quads is allowed to have star points.) The corresponding n-sided surface piece is called a surface cap. Fig. 5
                     a displays a cap-net, and Fig. 5c displays an extended cap-net i.e. a cap-net plus one additional layer. This additional layer is not used for the construction of the cap but provides a surface ring (green in Fig. 5d) surrounding the cap for visual context and to assess the continuation of curvature from the surrounding complex into the cap.

Each 
                        4
                        ×
                        4
                      sub-grid of points of the network is interpreted as the B-spline control net of a bi-cubic tensor-product spline surface. The well-known formulas for converting from the B-spline to the Bernstein–Bézier form (BB-form; see e.g.  Farin, 2002; Prautzsch et al., 2002) can be applied to the cap-net – except at star points. Along the boundary of a surface cap, this provides Hermite data in bi-degree 3 form (fine meshes in Fig. 5b, d). We refer to these Hermite data in the following as the tensor-border 
                     b (of depth 2 and degree 3) of the cap construction.

A tensor-product patch f of bi-degree d in Bernstein–Bézier form (BB-form) is defined by its BB-coefficients 
                        
                           
                              f
                           
                           
                              i
                              j
                           
                        
                      via
                        
                           
                              f
                              (
                              u
                              ,
                              v
                              )
                              :
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 d
                              
                              
                              
                                 ∑
                                 
                                    j
                                    =
                                    0
                                 
                                 d
                              
                              
                                 
                                    f
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                                 
                                    d
                                 
                              
                              (
                              u
                              )
                              
                                 
                                    b
                                 
                                 
                                    j
                                 
                                 
                                    d
                                 
                              
                              (
                              v
                              )
                              ,
                              
                              
                                 
                                    b
                                 
                                 
                                    k
                                 
                                 
                                    d
                                 
                              
                              (
                              t
                              )
                              :
                              =
                              
                                 (
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       
                                          k
                                       
                                    
                                 
                                 )
                              
                              
                                 
                                    (
                                    1
                                    −
                                    t
                                    )
                                 
                                 
                                    d
                                    −
                                    k
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                              (
                              u
                              ,
                              v
                              )
                              ∈
                              □
                              :
                              =
                              
                                 
                                    [
                                    0
                                    .
                                    .
                                    1
                                    ]
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                        
                      i.e. all patches will be parameterized over the unit square. 
                        
                           
                              C
                           
                           
                              r
                           
                        
                      continuity of surfaces can be achieved by 
                        
                           
                              G
                           
                           
                              r
                           
                        
                      constructions, i.e. by relating adjacent surface pieces by reparameterization ρ so that, up to rth order, 
                        
                           
                              f
                           
                           
                              ˜
                           
                        
                        =
                        f
                        ∘
                        ρ
                     . While the smoothness of the resulting surface can be expressed in the language of differential geometry, i.e. in terms of charts, it suffices, and is often more efficient, to express as agreement of one-sided r-jets along the boundary where two surface pieces are glued together. We use this approach in the following. Although ρ is just a change of variables, its choice is crucial for the properties of the surface cap.


                     
                        Definition 1
                        Two surface pieces 
                              
                                 
                                    f
                                 
                                 
                                    ˜
                                 
                              
                            and f sharing a boundary curve e join 
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                            if there exists a suitably oriented and non-singular reparameterization 
                              ρ
                              :
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              →
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                            so that the jets 
                              
                                 
                                    ∂
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    ˜
                                 
                              
                            and 
                              
                                 
                                    ∂
                                 
                                 
                                    k
                                 
                              
                              (
                              f
                              ∘
                              ρ
                              )
                           , 
                              k
                              =
                              0
                              ,
                              1
                              ,
                              2
                           , agree along e.

Throughout, we will choose e to correspond to surface patch parameters 
                        (
                        u
                        ,
                        0
                        =
                        v
                        )
                     . Then the relevant Taylor expansion up to and including degree 2 of the reparameterization ρ with respect to v is
                        
                           (2)
                           
                              ρ
                              =
                              
                                 (
                                 u
                                 +
                                 b
                                 (
                                 u
                                 )
                                 v
                                 +
                                 
                                    1
                                    2
                                 
                                 e
                                 (
                                 u
                                 )
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 a
                                 (
                                 u
                                 )
                                 v
                                 +
                                 
                                    1
                                    2
                                 
                                 d
                                 (
                                 u
                                 )
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              .
                           
                        
                      By the chain rule of differentiation, this yields the well-known constraints
                        
                           (3)
                           
                              
                                 
                                    ∂
                                 
                                 
                                    v
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    ˜
                                 
                              
                              =
                              a
                              (
                              u
                              )
                              
                                 
                                    ∂
                                 
                                 
                                    v
                                 
                              
                              f
                              +
                              b
                              (
                              u
                              )
                              
                                 
                                    ∂
                                 
                                 
                                    u
                                 
                              
                              f
                              ,
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    ∂
                                 
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    ˜
                                 
                              
                              =
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                              (
                              u
                              )
                              
                                 
                                    ∂
                                 
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              f
                              +
                              2
                              a
                              (
                              u
                              )
                              b
                              (
                              u
                              )
                              
                                 
                                    ∂
                                 
                                 
                                    u
                                 
                              
                              
                                 
                                    ∂
                                 
                                 
                                    v
                                 
                              
                              f
                              +
                              b
                              
                                 
                                    (
                                    u
                                    )
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    ∂
                                 
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              f
                              +
                              e
                              (
                              u
                              )
                              
                                 
                                    ∂
                                 
                                 
                                    u
                                 
                              
                              f
                              +
                              d
                              (
                              u
                              )
                              
                                 
                                    ∂
                                 
                                 
                                    v
                                 
                              
                              f
                              .
                           
                        
                     
                  

For this section, we assume that the valence of the star point is 
                        n
                        >
                        4
                     . The case 
                        n
                        =
                        3
                      will receive special attention in Section 4. We construct the cap from n spline patches each of which consists of 
                        2
                        ×
                        2
                      pieces of polynomial degree bi-5 (see Fig. 6
                     ). This section explains the principles and main equations that yield the algorithm in Section 3.3. The final implementation of surface caps can be reduced to forming a linear combination of tabulated generating functions weighted by the cap-net points 
                        
                           
                              c
                           
                           
                              j
                           
                           
                              k
                           
                        
                     , see Section 3.4.

Treating adjacent patches without bias for one side, we choose the reparameterization along the inter-sector boundary (cf. Fig. 6a) so that formula (2) simplifies to 
                           a
                           (
                           u
                           )
                           :
                           =
                           −
                           1
                         and 
                           e
                           (
                           u
                           )
                           :
                           =
                           b
                           (
                           u
                           )
                           (
                           
                              
                                 b
                              
                              
                                 ′
                              
                           
                           (
                           u
                           )
                           −
                           
                              
                                 d
                                 (
                                 u
                                 )
                              
                              2
                           
                           )
                        ; i.e. 
                           
                              (5)
                              
                                 ρ
                                 =
                                 
                                    (
                                    u
                                    +
                                    b
                                    (
                                    u
                                    )
                                    
                                       (
                                       v
                                       +
                                       
                                          1
                                          2
                                       
                                       
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          u
                                          )
                                          −
                                          
                                             
                                                d
                                                (
                                                u
                                                )
                                             
                                             2
                                          
                                          )
                                       
                                       )
                                    
                                    
                                       
                                          v
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    −
                                    v
                                    +
                                    
                                       1
                                       2
                                    
                                    d
                                    (
                                    u
                                    )
                                    
                                       
                                          v
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         We name as 
                           
                              
                                 ρ
                              
                              
                                 o
                              
                           
                         the reparameterization between the domains of 
                           
                              
                                 p
                              
                              
                                 `
                              
                           
                           :
                           =
                           
                              
                                 p
                              
                              
                                 o
                                 ,
                                 k
                                 −
                                 1
                              
                           
                         and 
                           
                              
                                 p
                              
                              
                                 ´
                              
                           
                           :
                           =
                           
                              
                                 p
                              
                              
                                 o
                                 ,
                                 k
                              
                           
                         and as 
                           
                              
                                 ρ
                              
                              
                                 r
                                 l
                              
                           
                         the reparameterization between the domains of 
                           
                              
                                 q
                              
                              
                                 `
                              
                           
                           :
                           =
                           
                              
                                 p
                              
                              
                                 l
                                 ,
                                 k
                                 −
                                 1
                              
                           
                         and 
                           
                              
                                 q
                              
                              
                                 ´
                              
                           
                           :
                           =
                           
                              
                                 p
                              
                              
                                 r
                                 ,
                                 k
                              
                           
                         (see Fig. 7
                        ). We choose
                           
                              
                                 for 
                                 
                                    
                                       ρ
                                    
                                    
                                       o
                                    
                                 
                                 :
                                 
                                 b
                                 (
                                 u
                                 )
                                 :
                                 =
                                 2
                                 c
                                 (
                                 1
                                 −
                                 u
                                 )
                                 +
                                 
                                    2
                                    3
                                 
                                 c
                                 u
                                 ,
                                 
                                 d
                                 (
                                 u
                                 )
                                 :
                                 =
                                 0
                                 ,
                                 
                                 c
                                 :
                                 =
                                 cos
                                 ⁡
                                 
                                    
                                       2
                                       π
                                    
                                    n
                                 
                                 ;
                              
                           
                        
                        
                           
                              
                                 for 
                                 
                                    
                                       ρ
                                    
                                    
                                       r
                                       l
                                    
                                 
                                 :
                                 
                                 b
                                 (
                                 u
                                 )
                                 :
                                 =
                                 
                                    2
                                    3
                                 
                                 c
                                 
                                    
                                       (
                                       1
                                       −
                                       u
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 d
                                 (
                                 u
                                 )
                                 :
                                 =
                                 0
                                 .
                              
                           
                         Since adjacent patches share the BB-coefficients along their common boundary, enforcing (3) locally between 
                           
                              
                                 p
                              
                              
                                 `
                              
                           
                         and 
                           
                              
                                 p
                              
                              
                                 ´
                              
                           
                         by setting to zero each coefficient of the polynomial (in the boundary parameter u) that is the difference between the left side and the right side of (3). This yields a system of 6 linear equations. Enforcing (4) adds another 6 linear equations. Enforcing (3) and (4) locally between 
                           
                              
                                 q
                              
                              
                                 `
                              
                           
                         and 
                           
                              
                                 q
                              
                              
                                 ´
                              
                           
                         yields another 
                           7
                           +
                           8
                         linear equations for a total of 27 linear equations. It is straightforward to compute the symbolic solution of this local system to express dependent BB-coefficients in terms of locally independent BB-coefficients as defined in Fig. 7b. We account for the interactions between the n such local systems of equations at a central point 
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       `
                                    
                                 
                              
                              
                                 00
                              
                           
                         as follows.
                           
                              (i)
                              We select the six BB-coefficients 
                                    
                                       
                                          {
                                          
                                             
                                                p
                                             
                                             
                                                l
                                                m
                                             
                                             
                                                o
                                                ,
                                                0
                                             
                                          
                                          }
                                       
                                       
                                          0
                                          ≤
                                          l
                                          +
                                          m
                                          ≤
                                          2
                                       
                                    
                                  that define the quadratic expansion of the first sector (index 
                                    k
                                    =
                                    0
                                 ) and then express the corresponding (initially independent) BB-coefficients of the other sectors recursively via (6)
                                 
                                    
                                       (6)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ´
                                                      
                                                   
                                                
                                                
                                                   00
                                                
                                             
                                             :
                                             =
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         `
                                                      
                                                   
                                                
                                                
                                                   00
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ´
                                                      
                                                   
                                                
                                                
                                                   10
                                                
                                             
                                             :
                                             =
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         `
                                                      
                                                   
                                                
                                                
                                                   10
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ´
                                                      
                                                   
                                                
                                                
                                                   20
                                                
                                             
                                             :
                                             =
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         `
                                                      
                                                   
                                                
                                                
                                                   20
                                                
                                             
                                             ;
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ´
                                                      
                                                   
                                                
                                                
                                                   01
                                                
                                             
                                             :
                                             =
                                             −
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         `
                                                      
                                                   
                                                
                                                
                                                   01
                                                
                                             
                                             +
                                             2
                                             c
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         `
                                                      
                                                   
                                                
                                                
                                                   10
                                                
                                             
                                             +
                                             2
                                             (
                                             1
                                             −
                                             c
                                             )
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         `
                                                      
                                                   
                                                
                                                
                                                   00
                                                
                                             
                                             ;
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ´
                                                      
                                                   
                                                
                                                
                                                   11
                                                
                                             
                                             :
                                             =
                                             −
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         `
                                                      
                                                   
                                                
                                                
                                                   11
                                                
                                             
                                             +
                                             
                                                
                                                   8
                                                   c
                                                
                                                5
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         `
                                                      
                                                   
                                                
                                                
                                                   20
                                                
                                             
                                             +
                                             2
                                             
                                                (
                                                1
                                                −
                                                
                                                   
                                                      11
                                                      c
                                                   
                                                   15
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         `
                                                      
                                                   
                                                
                                                
                                                   10
                                                
                                             
                                             −
                                             
                                                
                                                   2
                                                   c
                                                
                                                15
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         `
                                                      
                                                   
                                                
                                                
                                                   00
                                                
                                             
                                             ;
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ´
                                                      
                                                   
                                                
                                                
                                                   02
                                                
                                             
                                             :
                                             =
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         `
                                                      
                                                   
                                                
                                                
                                                   02
                                                
                                             
                                             −
                                             5
                                             c
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         `
                                                      
                                                   
                                                
                                                
                                                   11
                                                
                                             
                                             +
                                             4
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         `
                                                      
                                                   
                                                
                                                
                                                   20
                                                
                                             
                                             +
                                             (
                                             5
                                             c
                                             −
                                             4
                                             )
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         `
                                                      
                                                   
                                                
                                                
                                                   01
                                                
                                             
                                             +
                                             c
                                             
                                                (
                                                9
                                                −
                                                
                                                   
                                                      26
                                                      c
                                                   
                                                   3
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         `
                                                      
                                                   
                                                
                                                
                                                   10
                                                
                                             
                                             +
                                             
                                                (
                                                4
                                                −
                                                9
                                                c
                                                +
                                                
                                                   
                                                      14
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   3
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         `
                                                      
                                                   
                                                
                                                
                                                   00
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              

The assignment in each local system of
                                    
                                       (7)
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ´
                                                   
                                                
                                             
                                             
                                                12
                                             
                                          
                                          =
                                          −
                                          2
                                          c
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      `
                                                   
                                                
                                             
                                             
                                                21
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      `
                                                   
                                                
                                             
                                             
                                                12
                                             
                                          
                                          +
                                          2
                                          c
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ´
                                                   
                                                
                                             
                                             
                                                21
                                             
                                          
                                          +
                                          
                                             (
                                             
                                                
                                                   11
                                                   c
                                                
                                                3
                                             
                                             −
                                             4
                                             )
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      `
                                                   
                                                
                                             
                                             
                                                11
                                             
                                          
                                          +
                                          
                                             
                                                4
                                                c
                                             
                                             15
                                          
                                          (
                                          12
                                          −
                                          11
                                          c
                                          )
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      `
                                                   
                                                
                                             
                                             
                                                20
                                             
                                          
                                          +
                                          
                                             (
                                             4
                                             −
                                             
                                                
                                                   33
                                                   c
                                                
                                                5
                                             
                                             +
                                             
                                                
                                                   106
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                45
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      `
                                                   
                                                
                                             
                                             
                                                10
                                             
                                          
                                          +
                                          
                                             c
                                             3
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      `
                                                   
                                                
                                             
                                             
                                                01
                                             
                                          
                                          +
                                          
                                             c
                                             45
                                          
                                          (
                                          26
                                          c
                                          −
                                          27
                                          )
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      `
                                                   
                                                
                                             
                                             
                                                00
                                             
                                          
                                       
                                    
                                  leads globally to a circulant system for computing 
                                    
                                       
                                          p
                                       
                                       
                                          12
                                       
                                       
                                          o
                                          ,
                                          k
                                       
                                    
                                  (since 
                                    
                                       
                                          p
                                       
                                       
                                          12
                                       
                                       
                                          o
                                          ,
                                          k
                                          −
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                `
                                             
                                          
                                       
                                       
                                          21
                                       
                                    
                                  and 
                                    
                                       
                                          p
                                       
                                       
                                          12
                                       
                                       
                                          o
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ´
                                             
                                          
                                       
                                       
                                          12
                                       
                                    
                                 , marked as ⊗, respectively × in Fig. 7b). This circulant system has a solution that is unique except for 
                                    n
                                    =
                                    6
                                 , where one 
                                    
                                       
                                          p
                                       
                                       
                                          12
                                       
                                       
                                          o
                                          ,
                                          k
                                       
                                    
                                 , say 
                                    
                                       
                                          p
                                       
                                       
                                          12
                                       
                                       
                                          o
                                          ,
                                          0
                                       
                                    
                                 , is additionally free to choose. (The case 
                                    n
                                    =
                                    3
                                  leads to a singularity at the central point and is treated in Section 4 using a different construction.)


                        
                           Lemma 1
                           
                              For any choice of BB-coefficients in 
                              
                                 
                                    
                                       P
                                    
                                    
                                       ρ
                                    
                                 
                              
                              , adjacent patches 
                              
                                 
                                    
                                       p
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       p
                                    
                                    
                                       k
                                    
                                 
                               
                              join 
                              
                                 
                                    
                                       G
                                    
                                    
                                       2
                                    
                                 
                               
                              under the reparameterization ρ.
                           

The 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         assignments at 
                           
                              
                                 m
                              
                              
                                 k
                              
                           
                         (see the hollow boxes for (8) and diamonds ⋄ for (9) in Fig. 7b)
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             `
                                          
                                       
                                    
                                    
                                       i
                                       1
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             `
                                          
                                       
                                    
                                    
                                       i
                                       0
                                    
                                 
                                 +
                                 
                                    1
                                    4
                                 
                                 (
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             `
                                          
                                       
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ´
                                          
                                       
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 )
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ´
                                          
                                       
                                    
                                    
                                       i
                                       1
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             `
                                          
                                       
                                    
                                    
                                       i
                                       0
                                    
                                 
                                 −
                                 
                                    1
                                    4
                                 
                                 (
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             `
                                          
                                       
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ´
                                          
                                       
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 )
                                 ,
                                 
                                 i
                                 =
                                 4
                                 ,
                                 5
                                 ,
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                `
                                             
                                          
                                       
                                       
                                          31
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                `
                                             
                                          
                                       
                                       
                                          30
                                       
                                    
                                    +
                                    
                                       1
                                       4
                                    
                                    (
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                `
                                             
                                          
                                       
                                       
                                          32
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ´
                                             
                                          
                                       
                                       
                                          32
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                `
                                             
                                          
                                       
                                       
                                          52
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ´
                                             
                                          
                                       
                                       
                                          52
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                `
                                             
                                          
                                       
                                       
                                          42
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ´
                                             
                                          
                                       
                                       
                                          42
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                `
                                             
                                          
                                       
                                       
                                          50
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                `
                                             
                                          
                                       
                                       
                                          40
                                       
                                    
                                    )
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ´
                                             
                                          
                                       
                                       
                                          31
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                `
                                             
                                          
                                       
                                       
                                          30
                                       
                                    
                                    −
                                    
                                       1
                                       4
                                    
                                    (
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                `
                                             
                                          
                                       
                                       
                                          32
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ´
                                             
                                          
                                       
                                       
                                          32
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          w
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                `
                                             
                                          
                                       
                                       
                                          52
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ´
                                             
                                          
                                       
                                       
                                          52
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          w
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                `
                                             
                                          
                                       
                                       
                                          42
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ´
                                             
                                          
                                       
                                       
                                          42
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                `
                                             
                                          
                                       
                                       
                                          50
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                `
                                             
                                          
                                       
                                       
                                          40
                                       
                                    
                                    )
                                    ,
                                    
                                    
                                       
                                          w
                                       
                                       
                                          1
                                       
                                    
                                    :
                                    =
                                    −
                                    
                                       c
                                       96
                                    
                                    ,
                                    
                                    
                                       
                                          w
                                       
                                       
                                          2
                                       
                                    
                                    :
                                    =
                                    
                                       c
                                       96
                                    
                                    ,
                                    
                                    
                                       
                                          w
                                       
                                       
                                          3
                                       
                                    
                                    :
                                    =
                                    
                                       c
                                       30
                                    
                                    ,
                                 
                              
                           
                         are incompatible with the 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         tensor-border data. Therefore we define for each edge of one sector of the tensor-border b, the reparameterization pieces 
                           
                              
                                 β
                              
                              
                                 m
                              
                           
                         and 
                           
                              
                                 β
                              
                              
                                 l
                              
                           
                         of degree bi-3 (see Fig. 8
                        b). We choose the reparameterization to preserve the first cross-derivative along the border of the cap, i.e.  
                           a
                           (
                           u
                           )
                           :
                           =
                           1
                        , 
                           b
                           (
                           u
                           )
                           :
                           =
                           0
                         in (2), and we enforce 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         continuity between 
                           
                              
                                 β
                              
                              
                                 m
                              
                           
                         and 
                           
                              
                                 β
                              
                              
                                 l
                              
                           
                         and symmetry about the diagonal of 
                           
                              
                                 β
                              
                              
                                 m
                              
                           
                        . Then the choice
                           
                              (10)
                              
                                 
                                    
                                       β
                                    
                                    
                                       22
                                    
                                    
                                       m
                                    
                                 
                                 :
                                 =
                                 
                                    (
                                    
                                       1
                                       3
                                    
                                    +
                                    
                                       c
                                       216
                                    
                                    ,
                                    
                                       1
                                       3
                                    
                                    +
                                    
                                       c
                                       216
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       β
                                    
                                    
                                       32
                                    
                                    
                                       m
                                    
                                 
                                 :
                                 =
                                 
                                    (
                                    
                                       1
                                       2
                                    
                                    +
                                    
                                       
                                          7
                                          c
                                       
                                       1296
                                    
                                    ,
                                    
                                       1
                                       3
                                    
                                    +
                                    
                                       c
                                       72
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       β
                                    
                                    
                                       32
                                    
                                    
                                       l
                                    
                                 
                                 :
                                 =
                                 
                                    (
                                    1
                                    ,
                                    
                                       1
                                       3
                                    
                                    +
                                    
                                       c
                                       18
                                    
                                    )
                                 
                              
                           
                         defines 
                           
                              
                                 β
                              
                              
                                 m
                              
                           
                         and 
                           
                              
                                 β
                              
                              
                                 l
                              
                           
                         up to second order along the tensor-border and makes compatible the prolongation of the tensor-border data and the smoothness constraints between sectors of the cap. Let β denote the reparameterization for the whole tensor-border and 
                           
                              
                                 β
                              
                              
                                 k
                              
                           
                         its (identical) pieces, one for each sector. 
                           Lemma 2
                           
                              The reparameterized tensor-border 
                              
                                 b
                                 ∘
                                 β
                               
                              is 
                              
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               
                              within each sector and adjacent pieces 
                              
                                 
                                    
                                       b
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 ∘
                                 
                                    
                                       β
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       b
                                    
                                    
                                       k
                                    
                                 
                                 ∘
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                 
                               
                              join 
                              
                                 
                                    
                                       G
                                    
                                    
                                       2
                                    
                                 
                               
                              by satisfying 
                              (8) 
                              and 
                              (9) 
                              (see squares in 
                              
                                 Fig. 7
                              
                              b).
                           

We complete the patches 
                           
                              
                                 p
                              
                              
                                 k
                              
                           
                         so that they are internally 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                        . This leaves free the set of 
                           9
                           n
                           =
                           (
                           3
                           ×
                           3
                           )
                           n
                         unconstrained BB-coefficients that determine the center of each 
                           
                              
                                 p
                              
                              
                                 k
                              
                           
                         where its four pieces join (see circles in Fig. 7a). Combining Lemma 1 and Lemma 2 this yields overall curvature continuity.


                        
                           Theorem 1
                           
                              For any choice of BB-coefficients
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             2
                                             h
                                          
                                          
                                             o
                                             ,
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             l
                                             m
                                          
                                          
                                             o
                                             ,
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             o
                                             ,
                                             k
                                          
                                       
                                       ,
                                       
                                       h
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       3
                                       ,
                                       4
                                       ,
                                       5
                                       ,
                                       
                                       0
                                       ≤
                                       l
                                       +
                                       m
                                       ≤
                                       2
                                       ,
                                       
                                       i
                                       ,
                                       j
                                       =
                                       3
                                       ,
                                       4
                                       ,
                                       5
                                       ,
                                       
                                       k
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       n
                                       −
                                       1
                                       ,
                                    
                                 
                               
                              (plus 
                              
                                 
                                    
                                       p
                                    
                                    
                                       12
                                    
                                    
                                       o
                                       ,
                                       0
                                    
                                 
                               
                              if 
                              
                                 n
                                 =
                                 6
                              
                              ), the just-defined cap 
                              p 
                              is curvature continuous and joins the input patch complex with curvature continuity.
                           

We can now succinctly state the full construction.


                        Input: A cap-net of 
                           6
                           n
                           +
                           1
                         points 
                           
                              
                                 c
                              
                              
                                 j
                              
                              
                                 k
                              
                           
                           ,
                           j
                           =
                           1
                           ,
                           …
                           ,
                           7
                         with star point  
                           
                              
                                 c
                              
                              
                                 7
                              
                           
                           =
                           
                              
                                 c
                              
                              
                                 7
                              
                              
                                 k
                              
                           
                        , 
                           k
                           =
                           0
                           ,
                           …
                           ,
                           n
                           −
                           1
                         of valence n (cf. Fig. 8c) – or – an n-sided tensor-border b of degree 3 and depth 2 (cf. Fig. 5b).


                        Output: (Cf. Fig. 4.) A surface cap p consisting of n spline patches 
                           
                              
                                 p
                              
                              
                                 k
                              
                           
                        , 
                           k
                           =
                           0
                           ,
                           …
                           ,
                           n
                           −
                           1
                        . The patches 
                           
                              
                                 p
                              
                              
                                 k
                                 −
                                 1
                              
                           
                         and 
                           
                              
                                 p
                              
                              
                                 k
                              
                           
                         are joined 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         and the cap joins with b both 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                        . Each spline patch 
                           
                              
                                 p
                              
                              
                                 k
                              
                           
                         is internally 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         and consists of 
                           2
                           ×
                           2
                         polynomial pieces 
                           
                              
                                 p
                              
                              
                                 o
                                 ,
                                 k
                              
                           
                        , 
                           
                              
                                 p
                              
                              
                                 r
                                 ,
                                 k
                              
                           
                        , 
                           
                              
                                 p
                              
                              
                                 m
                                 ,
                                 k
                              
                           
                        , 
                           
                              
                                 p
                              
                              
                                 l
                                 ,
                                 k
                              
                           
                         of degree bi-5.


                        Algorithm (for 
                           n
                           >
                           4
                        , cf. Fig. 6)
                           
                              1.
                              Set the central point 
                                    
                                       
                                          p
                                       
                                       
                                          00
                                       
                                    
                                    =
                                    
                                       
                                          p
                                       
                                       
                                          00
                                       
                                       
                                          o
                                          ,
                                          k
                                       
                                    
                                  for all k to the limit point of Catmull–Clark subdivision (Halstead et al., 1993)
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                00
                                             
                                          
                                          :
                                          =
                                          
                                             n
                                             
                                                n
                                                +
                                                5
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                7
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   γ
                                                
                                                
                                                   5
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   5
                                                
                                                
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   γ
                                                
                                                
                                                   6
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   6
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          ,
                                          
                                          
                                             
                                                γ
                                             
                                             
                                                5
                                             
                                          
                                          :
                                          =
                                          
                                             1
                                             
                                                n
                                                (
                                                n
                                                +
                                                5
                                                )
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                γ
                                             
                                             
                                                6
                                             
                                          
                                          :
                                          =
                                          
                                             4
                                             
                                                n
                                                (
                                                n
                                                +
                                                5
                                                )
                                             
                                          
                                          .
                                       
                                    
                                 
                              

Set the tensor-border of p to 
                                    b
                                    ∘
                                    β
                                 .

Expressing all dependent BB-coefficients in terms of 
                                    
                                       
                                          p
                                       
                                       
                                          00
                                       
                                    
                                  and the 
                                    9
                                    n
                                    +
                                    5
                                    n
                                    +
                                    5
                                  (
                                    9
                                    n
                                    +
                                    5
                                    n
                                    +
                                    6
                                  if 
                                    n
                                    =
                                    6
                                 ) BB-coefficients of
                                    
                                       
                                          P
                                          :
                                          =
                                          
                                             {
                                             
                                                
                                                   p
                                                
                                                
                                                   2
                                                   h
                                                
                                                
                                                   o
                                                   ,
                                                   k
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   l
                                                   m
                                                
                                                
                                                   o
                                                   ,
                                                   0
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   o
                                                   ,
                                                   k
                                                
                                             
                                             }
                                          
                                          ,
                                          
                                          h
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          3
                                          ,
                                          4
                                          ,
                                          5
                                          ,
                                          
                                          1
                                          ≤
                                          l
                                          +
                                          m
                                          ≤
                                          2
                                          ,
                                          
                                          i
                                          ,
                                          j
                                          =
                                          3
                                          ,
                                          4
                                          ,
                                          5
                                       
                                    
                                  (plus 
                                    
                                       
                                          p
                                       
                                       
                                          12
                                       
                                       
                                          o
                                          ,
                                          0
                                       
                                    
                                  if 
                                    n
                                    =
                                    6
                                 ), the surface is determined by minimizing
                                    
                                       (11)
                                       
                                          
                                             min
                                             P
                                          
                                          ⁡
                                          
                                             
                                                F
                                             
                                             
                                                κ
                                                (
                                                n
                                                )
                                             
                                          
                                          p
                                          ,
                                          
                                          κ
                                          (
                                          n
                                          )
                                          :
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      n
                                                      −
                                                      1
                                                      ,
                                                   
                                                   
                                                      for 
                                                      n
                                                      =
                                                      5
                                                      ,
                                                      6
                                                   
                                                
                                                
                                                   
                                                      n
                                                      ,
                                                   
                                                   
                                                      for 
                                                      n
                                                      =
                                                      7
                                                      ,
                                                      8
                                                   
                                                
                                                
                                                   
                                                      8
                                                      ,
                                                   
                                                   
                                                      for 
                                                      n
                                                      >
                                                      8
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

The cap construction is linear and coordinate-wise. Due to the relatively short, explicit formulas for the dependent BB-coefficients in terms of the independent BB-coefficients, the construction steps of the algorithm are simple and stable. With the central point set to the Catmull–Clark limit point of the cap-net, (11) requires only solving a linear system of size 
                           N
                           ×
                           N
                        , where 
                           N
                           :
                           =
                           9
                           n
                           +
                           5
                           n
                           +
                           5
                         (
                           14
                           n
                           +
                           6
                         when 
                           n
                           =
                           6
                        ). For all reasonable values of n, we have solved this system and computed seven generating functions of the cap-net. The final surface cap is a linear combination of these tabulated generating functions weighted by the cap-net  points.

Specifically, since the algorithm works for each coordinate separately, it can be applied to when all cap-net points have value 0, except for 
                           
                              
                                 c
                              
                              
                                 m
                              
                              
                                 0
                              
                           
                           =
                           1
                        , for one of 
                           m
                           =
                           1
                           ,
                           …
                           ,
                           7
                         (cf. Fig. 8c). This yields the scalar-valued bi-5 coefficients
                           
                              (12)
                              
                                 
                                    
                                       h
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       k
                                       ,
                                       m
                                    
                                 
                                 ∈
                                 R
                                 ,
                                 
                                 k
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 n
                                 −
                                 1
                                 ,
                                 
                                 m
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 7
                                 ,
                                 
                                 i
                                 ,
                                 j
                                 ∈
                                 {
                                 0
                                 ,
                                 …
                                 ,
                                 5
                                 }
                                 ,
                                  where 
                                 
                                    
                                       h
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       0
                                       ,
                                       7
                                    
                                 
                                 =
                                 …
                                 =
                                 
                                    
                                       h
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       n
                                       −
                                       1
                                       ,
                                       7
                                    
                                 
                              
                           
                         of the pieces attached to the central point. Then the central patches 
                           
                              
                                 p
                              
                              
                                 o
                                 ,
                                 κ
                              
                           
                        , 
                           κ
                           =
                           0
                           .
                           .
                           n
                           −
                           1
                         have the BB-coefficients
                           
                              (13)
                              
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       o
                                       ,
                                       κ
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       h
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       0
                                       ,
                                       7
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       7
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       k
                                       =
                                       0
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    6
                                 
                                 
                                    
                                       h
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       k
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       m
                                    
                                    
                                       κ
                                       −
                                       k
                                    
                                 
                                 ,
                              
                           
                         where the superscript of 
                           
                              
                                 c
                              
                              
                                 m
                              
                              
                                 κ
                                 −
                                 k
                              
                           
                         is interpreted modulo n. The remaining pieces are determined by the re-parameterized tensor-border and by 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                        -extending the central pieces 
                           
                              
                                 p
                              
                              
                                 o
                                 ,
                                 κ
                              
                           
                        .

The failure of formula (7) to provide adequate shape when 
                        n
                        =
                        3
                      calls for special treatment. By choosing to join the patches 
                        
                           
                              p
                           
                           
                              o
                              ,
                              k
                              −
                              1
                           
                        
                      and 
                        
                           
                              p
                           
                           
                              o
                              ,
                              k
                           
                        
                      with reparameterization
                        
                           (14)
                           
                              
                                 
                                    ρ
                                 
                                 
                                    o
                                 
                              
                              :
                              
                              b
                              (
                              u
                              )
                              :
                              =
                              −
                              
                                 
                                    (
                                    1
                                    −
                                    u
                                    )
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                              d
                              (
                              u
                              )
                              :
                              =
                              −
                              6
                              
                                 
                                    (
                                    1
                                    −
                                    u
                                    )
                                 
                                 
                                    3
                                 
                              
                              ,
                           
                        
                      we resolve the 
                        
                           
                              G
                           
                           
                              2
                           
                        
                      constraints between the 
                        
                           
                              p
                           
                           
                              o
                              ,
                              k
                           
                        
                      and retain as independent the BB-coefficients shown in Fig. 9
                     a as black disks. As in Karčiauskas and Peters (2013), the construction results in better shape when the location of the central point is provided. The algorithm sets one of the three neighbors of the star point so that their average equals the limit formula for Catmull–Clark subdivision, except for a slight, shape-wise important perturbation of 
                        
                           
                              γ
                           
                           
                              5
                           
                        
                     .
                        
                           (15)
                           
                              central point
                              =
                              (
                              1
                              −
                              3
                              
                                 
                                    γ
                                 
                                 
                                    5
                                 
                              
                              −
                              3
                              
                                 
                                    γ
                                 
                                 
                                    6
                                 
                              
                              )
                              
                                 
                                    c
                                 
                                 
                                    7
                                 
                              
                              +
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 2
                              
                              
                                 (
                                 
                                    
                                       γ
                                    
                                    
                                       5
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       5
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       6
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       6
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              ,
                              
                              
                                 
                                    γ
                                 
                                 
                                    5
                                 
                              
                              :
                              =
                              
                                 5
                                 96
                              
                              ,
                              
                              
                                 
                                    γ
                                 
                                 
                                    6
                                 
                              
                              :
                              =
                              
                                 1
                                 6
                              
                              .
                           
                        
                      The patches 
                        
                           
                              p
                           
                           
                              l
                              ,
                              k
                           
                        
                     , 
                        
                           
                              p
                           
                           
                              m
                              ,
                              k
                           
                        
                      and 
                        
                           
                              p
                           
                           
                              r
                              ,
                              k
                           
                        
                      are fully determined by 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      connection to the central patches 
                        
                           
                              p
                           
                           
                              o
                              ,
                              k
                           
                        
                      and by matching the (degree-raised and split) tensor-border b. The tensor-border is not reparameterized but matched directly. This yields a 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      join at 
                        
                           
                              m
                           
                           
                              k
                           
                        
                     .

Together, the construction now has 45 unconstrained BB-coefficients, all associated with 
                        
                           
                              p
                           
                           
                              o
                           
                        
                     : the coefficients 
                        
                           
                              p
                           
                           
                              i
                              j
                           
                           
                              o
                              ,
                              k
                           
                        
                        ,
                        i
                        >
                        2
                        ,
                        j
                        >
                        2
                      that determine 
                        
                           
                              p
                           
                           
                              o
                              ,
                              k
                           
                        
                      where its four pieces join plus 
                        19
                        −
                        1
                      coefficients involved in the 
                        
                           
                              G
                           
                           
                              2
                           
                        
                      constraints between 
                        
                           
                              p
                           
                           
                              o
                              ,
                              k
                              −
                              1
                           
                        
                      and 
                        
                           
                              p
                           
                           
                              o
                              ,
                              k
                           
                        
                     . We tested a broad range of functionals including 
                        
                           
                              F
                           
                           
                              k
                           
                        
                      and 
                        
                           
                              F
                           
                           
                              k
                           
                           
                              ⁎
                           
                        
                      to determine these coefficients. The best result, obtained by minimizing 
                        
                           
                              F
                           
                           
                              4
                           
                        
                     , is shown in Fig. 10
                     c (together with the result of minimizing 
                        
                           
                              F
                           
                           
                              2
                           
                        
                        +
                        
                           1
                           4
                        
                        
                           
                              F
                           
                           
                              1
                           
                        
                      and the construction of Loop and Schaefer, 2008).

Since even the best choice of functional 
                        
                           
                              F
                           
                           
                              4
                           
                        
                      disappoints for valence 3, we construct a 3-piece 
                     
                        
                           
                              G
                           
                           
                              1
                           
                        
                      
                     guide surface g, albeit a simpler one than in Karčiauskas and Peters (2013). Initially, the guide consists of three bi-5 patches (see Fig. 9c) and the patches join 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      via a reparameterization ρ whose relevant part up to first order is defined by 
                        a
                        (
                        u
                        )
                        :
                        =
                        −
                        1
                      and 
                        b
                        (
                        u
                        )
                        :
                        =
                        2
                        c
                        
                           
                              (
                              1
                              −
                              u
                              )
                           
                           
                              2
                           
                        
                        =
                        −
                        
                           
                              (
                              1
                              −
                              u
                              )
                           
                           
                              2
                           
                        
                     . The tensor-border BB-coefficients 
                        
                           
                              g
                           
                           
                              i
                              j
                           
                           
                              k
                           
                        
                     , 
                        i
                        >
                        2
                      or 
                        j
                        >
                        2
                      are defined without reparameterization by the surrounding complex and are rendered green in Fig. 9c; In particular, the bi-5 guide is 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      connected to the surrounding complex. The 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      constraints leave free the coefficients marked as disks, except that one additional coefficient is fixed to stabilize the central point according to (15). The remaining 14 coefficients are set by minimizing 
                        
                           
                              F
                           
                           
                              4
                           
                        
                      (other functionals resulted in poorer shape). Appendix A gives the technical details of how to modify g to have the same layout and a compatible parameterization to p. Analogous to general case, but including the central point, we finally determine p when 
                        n
                        =
                        3
                      by minimizing over the 
                        45
                        +
                        1
                      unconstrained coefficients the functional
                        
                           (16)
                           
                              
                                 ∑
                                 
                                    k
                                    =
                                    0
                                 
                                 2
                              
                              
                              
                                 ∑
                                 
                                    s
                                    ∈
                                    {
                                    o
                                    ,
                                    r
                                    ,
                                    m
                                    ,
                                    l
                                    }
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    4
                                 
                              
                              
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       s
                                       ,
                                       k
                                    
                                 
                                 −
                                 
                                    
                                       g
                                    
                                    
                                       s
                                       ,
                                       k
                                    
                                 
                                 )
                              
                              .
                           
                        
                      That is, we minimize the difference between the guide g and the cap p with respect to 
                        
                           
                              F
                           
                           
                              4
                           
                        
                     .

We note that the choice (14) does not require reparameterizing the tensor-border so that the cap construction for 
                        n
                        =
                        3
                      applies directly to tensor-borders of degree 5. By contrast, the approach of Loop and Schaefer (2008) requires a transition ring. And, if the degree 
                        3
                        ×
                        5
                      blend is replaced by a sequence of bi-3 patches as in Fig. 11
                     b, the approach of Loop and Schaefer (2008) does not apply since it requires a single cubic per half-edge. The bi-5 construction naturally fits a split boundary. (The resulting highlight line distribution is very similar to that of Fig. 11c shown in Fig. 11d, e and hence is not displayed.)

We compared and selected functionals based on a series of basic hard test cases. Here the sectors of the extended cap-net are intentionally planar in order to generate easily understood, namely zero curvature at parts of the tensor-border. (If the tensor-border has itself a complex curvature distribution, it will be more difficult to predict the expected or desirable curvature distribution of the surface cap.) Fig. 12
                      illustrates the effect of different choices of κ when minimizing with respect to 
                        
                           
                              F
                           
                           
                              κ
                           
                        
                     . Differences can be subtle and are best observed by moving the surfaces with respect to light sources. Fig. 13
                      and Fig. 14
                      compare the new construction based on minimizing functionals with those of Loop and Schaefer (2008), Catmull–Clark subdivision and Karčiauskas and Peters (2013). Fig. 13 shows limitations of the otherwise good bi-7 construction of Loop and Schaefer (2008). The highlight lines of the 
                        
                           
                              F
                           
                           
                              8
                           
                        
                      construction developed in this paper and shown in Fig. 13b are more evenly distributed than of those of Loop and Schaefer (2008) but slightly less so than those of Karčiauskas and Peters (2013) in Fig. 13d. Applying a single Catmull–Clark subdivision step to make the data less extreme improves highlight lines both for Loop and Schaefer (2008) and the present algorithm. More than one step of subdivision not only increases the number of polynomial pieces but also negatively affects the highlight line distribution. Fig. 14 shows the artifacts of Catmull–Clark subdivision when applied to difficult saddle input and to convex input.


                     Fig. 15
                      and Fig. 16
                      illustrate that the construction applies and good shape is obtained also for immediately adjacent caps.

Valences above 
                        n
                        =
                        8
                      are exotic in design applications. Here all functionals failed (see Fig. 17
                     b) and, as in Karčiauskas and Peters (2013), we had to make the layout less distorted. In checking functionals 
                        
                           
                              F
                           
                           
                              k
                           
                        
                     , we can restrict k to at most the total degree 10 of the bi-5 patches – but in fact, already 
                        
                           
                              F
                           
                           
                              9
                           
                        
                      turned out to be ineffective. A 3-layer construction, analogous to the one explained in Karčiauskas and Peters (2013), with the Catmull–Clark-like 7-partition of Fig. 17d, yields a remarkably well-distributed layout of BB-coefficients. We say remarkably, since Fig. 17d shows the BB-coefficients (uniformly scaled in the y-direction) of this (technically more elaborate) construction for 
                        n
                        =
                        1000
                      on input of the tensor-border of the characteristic ring of Catmull–Clark subdivision.

@&#CONCLUSION@&#

Knowing that the space of bi-5 spline caps is rich enough to include caps of good shape, we applied functionals to set extraneous degrees of freedom. This approach is in contrast to relying on step-by-step improved fits via intermediate guide surfaces in Karčiauskas and Peters (2013). In the cases when the valence n is greater than four, we found functionals that prevent abrupt change of the curvature distribution across the cap boundary and that gently average out the propagated highlight lines in the neighborhood of the central point. While qualitatively similar to Karčiauskas and Peters (2013), these constructions are conceptually simpler. For 
                        n
                        =
                        3
                     , we presented a guided construction of reduced complexity.

We emphasize that our choice of functionals was by elimination: functionals performing poorly on one or more of our test data sets were eliminated. One justification for choosing functionals of the form 
                        
                           
                              F
                           
                           
                              k
                           
                        
                      or 
                        
                           
                              F
                           
                           
                              k
                           
                           
                              ⁎
                           
                        
                      is to assume that the surface's first fundamental form is close to the identity (see e.g.  Westgaard and Nowacki, 2001). Then they can be interpreted as penalizing high-order terms. However, multi-sided configurations typically have ever more non-uniform parameterizations as the valence n increases, hence fail the assumption. This may explain why the degree k of the most successful functionals 
                        
                           
                              F
                           
                           
                              k
                           
                        
                      selected for (11) increases with n: to obtain good shape as n and hence the complexity of the input tensor-border increases, the goal of keeping the total degree low for the whole cap must successively be abandoned.

@&#ACKNOWLEDGEMENTS@&#

The work was supported in part by NSF Grant CCF-1117695. Charles Loop kindly provided the generating functions for the comparisons with Loop and Schaefer (2008).

To relate the guide to the surface cap, we found that the shape suffers if we just split g to obtain a patch of the same layout as p (see Fig. 19b vs. Fig. 19c). Instead, we determine a more subtle reparameterization of the data as follows. Let 
                        
                           
                              b
                           
                           
                              χ
                           
                        
                      be the tensor-border of the characteristic ring χ of Catmull–Clark subdivision. We apply the 3-piece 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      construction of Section 4 to 
                        
                           
                              b
                           
                           
                              χ
                           
                        
                     . This yields the map 
                        
                           
                              σ
                           
                           
                              ¯
                           
                        
                      of Fig. 9c. We also apply the 
                        
                           
                              G
                           
                           
                              2
                           
                        
                      bi-5 cap construction (without guide) to 
                        
                           
                              b
                           
                           
                              χ
                           
                        
                     . This yields the parameterization σ of Fig. 9b. We now consider the BB-coefficients 
                        
                           
                              f
                           
                           
                              i
                              j
                           
                        
                     , 
                        i
                        ,
                        j
                        ∈
                        {
                        0
                        ,
                        1
                        ,
                        2
                        }
                      that define the derivatives 
                        
                           
                              ∂
                           
                           
                              u
                           
                           
                              i
                           
                        
                        
                           
                              ∂
                           
                           
                              v
                           
                           
                              j
                           
                        
                        f
                     , 
                        i
                        ,
                        j
                        ∈
                        {
                        0
                        ,
                        1
                        ,
                        2
                        }
                     , up to and including order bi-2 at a corner point y of the tensor-product patch 
                        f
                        :
                        (
                        u
                        ,
                        v
                        )
                        ∈
                        
                           
                              [
                              0
                              .
                              .
                              1
                              ]
                           
                           
                              2
                           
                        
                        →
                        R
                      of degree bi-5 (see Fig. 18
                     
                     a, b) at 
                        (
                        0
                        ,
                        0
                        )
                     :
                        
                           (17)
                           
                              
                                 
                                    H
                                 
                                 
                                    y
                                 
                              
                              f
                              :
                              =
                              
                                 
                                    [
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    ]
                                 
                                 
                                    i
                                    ,
                                    j
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    ,
                                    2
                                    }
                                 
                              
                           
                        
                      We call 
                        
                           
                              H
                           
                           
                              y
                           
                        
                        f
                      the BB-jet of f at y. Fig. 18c illustrates how BB-jets at four corner points define a tensor-product patch 
                        H
                        f
                      of degree bi-5. Sampling with BB-jets, a map S of degree bi-5 for sampling the guide is obtained as follows (see Fig. 18d). We compute numerically the four vertices 
                        S
                        (
                        y
                        )
                        :
                        =
                        
                           
                              (
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                              )
                           
                           
                              −
                              1
                           
                        
                        ∘
                        
                           
                              σ
                           
                           
                              o
                           
                        
                        (
                        y
                        )
                      where 
                        y
                        ∈
                        {
                        (
                        0
                        ,
                        0
                        )
                        ,
                        (
                        1
                        ,
                        0
                        )
                        ,
                        (
                        1
                        ,
                        1
                        )
                        ,
                        (
                        0
                        ,
                        1
                        )
                        }
                      and then compute the remainder of S by the requirement that 
                        
                           
                              H
                           
                           
                              y
                           
                        
                        
                           
                              σ
                           
                           
                              o
                           
                        
                        =
                        
                           
                              H
                           
                           
                              y
                           
                        
                        (
                        
                           
                              σ
                           
                           
                              ¯
                           
                        
                        ∘
                        S
                        )
                     . (This equation is linear for our fixed y.) Then the central piece of the final guide with the correct layout is obtained as 
                        
                           
                              g
                           
                           
                              o
                              ,
                              k
                           
                        
                        ←
                        
                           
                              H
                           
                           
                              y
                           
                        
                        
                           
                              g
                           
                           
                              k
                           
                        
                        ∘
                        S
                      (see Fig. 18d) and the outer pieces 
                        
                           
                              g
                           
                           
                              l
                              ,
                              k
                           
                        
                     , 
                        
                           
                              g
                           
                           
                              m
                              ,
                              k
                           
                        
                     , 
                        
                           
                              g
                           
                           
                              r
                              ,
                              k
                           
                        
                      of g are defined by 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      prolongation of the tensor-border and 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      connection to 
                        
                           
                              g
                           
                           
                              o
                              ,
                              k
                           
                        
                     .

@&#REFERENCES@&#

