@&#MAIN-TITLE@&#Direct simulation of drying colloidal suspension on substrate using immersed free surface model

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We model mesoscale gas–liquid–solid three-phase flow.


                        
                        
                           
                           We estimate efficiently capillary force exerted on mobile particles at free surface.


                        
                        
                           
                           We estimate accurately curvature of free surface.


                        
                        
                           
                           We simulate structure formation of colloidal suspension on substrate during drying.


                        
                        
                           
                           We clarify effect of wettability of particles on structure formation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Colloidal suspension

Free surface

Phase change

Immersed free surface model

Immersed boundary method

Level set method

@&#ABSTRACT@&#


               Graphical abstract
               
                  
               
               
                  
               
            

@&#INTRODUCTION@&#

Drying of colloidal suspension on a substrate is a key process to fabricate particulate films that constitute various electronic devices, such as solar cells, flat panel displays and biological/chemical sensors [1]. The colloidal particles in a suspension spontaneously form a variety of microstructures on the substrate during drying [2–8]. The microstructure formation of the colloidal particles is a type of self-organization. Elucidation of the self-organization is crucial to control the microstructures of the colloidal particles. During drying, the colloidal particles are influenced by various non-linear interactions, such as contact interaction, van der Waals interaction, electrostatic interaction, capillary interaction and hydrodynamic interaction including thermal fluctuation of a solvent. A simulation of drying colloidal suspension is a major challenge even though computational fluid dynamics is now well developed. Recently, many researchers have been performed macroscopic simulations of the drying colloidal suspension [9–13], in which the evolution of the solid phase fraction in the suspension has been solved. Although the macroscopic simulations are applicable to systems in actual size, the microstructures of the colloidal particles cannot be obtained. On the other hand, several researchers have addressed direct simulations of the drying colloidal suspension [14,15], in which the motion of each particle has been solved. Although the direct simulation is rather expensive in computation than the macroscopic simulation, it has the advantage of obtaining the microstructures of the colloidal particles during drying.

For the direct simulation of the drying colloidal suspension, mesoscale gas–liquid–solid three phase flow with phase change should be taken into consideration. The problem can be divided into two issues; mesoscale solid–fluid two phase flow and gas–liquid two phase flow with phase change. Firstly, there are two issues in the mesoscale solid–fluid two phase flow. They are to apply the no-slip boundary condition on the solid–fluid interface and to reproduce the Brownian motion that satisfies the fluctuation–dissipation theorem. The immersed boundary (IB) method [16] is an efficient way to apply the no-slip boundary condition on moving solid objects in a fixed Cartesian coordinate system. Many researchers have applied the IB method to the simulation of particulate flows [17–21]. The fluctuation–dissipation theorem can be satisfied by use of the Landau–Lifshitz Navier–Stokes (LLNS) equations in the fluctuating hydrodynamics [22,23], which includes the stochastic fluctuation stress. Several researchers have simulated the Brownian motion of colloidal particles by use of the LLNS as well as the IB method [24–27]. Secondly, an issue of the gas–liquid two-phase flow is to capture a free surface on which surface tension is exerted. The level set method [28] is one of the most reliable approaches to capture the free surface, because it enables us to calculate accurately the normal vectors and curvatures of the free surface, compared with other capturing methods [29–31]. Many researchers have applied the method to simulations of gas–liquid two-phase flows with phase change [32–37].

Although both colloidal suspension flows and two-phase flows with phase change have been successfully simulated, few direct simulations of the drying colloidal suspension have ever been presented in the literature. A difficulty with the simulation is modeling of the capillary force exerted on the particles protruding from a free surface. In Ref. [15], the capillary force is modeled as the simple spring force that is a function of the immersed height of the particle, in which the free surface is not deformed. In Ref. [14], the capillary force and the deformation of the free surface are calculated through the specified wettability parameter, in which the contact angle on the particle surface cannot be explicitly specified. Most recently, we have developed the immersed free surface (IFS) model to estimate accurately and efficiently capillary forces exerted on many particles at a free surface [38]. The IFS model is used along with the immersed boundary method and the level set method to accomplish a three-way coupling of the fluid flow, the free surface motion and the particle motion. This paper aims to develop a new direct simulation method for a drying colloidal suspension on a substrate using the IFS model. The present simulation method includes the crucial forces exerted on colloidal particles, such as the contact force, the van der Waals force, the electrostatic force, the capillary force, and the fluctuating hydrodynamic force, as shown in Fig. 1
                     . Therefore, the present method enables us to estimate a variety of microstructures of colloidal particles on a substrate during drying.

This paper consists of the following parts. In Section 2, mathematical formulation in the present method is described. Namely, the governing equations of free surface motion, gas–liquid two-phase flow with phase change and particle motion are derived from the conservation laws. The IFS model is introduced into the equation of the free surface motion. In Section 3, numerical solver is described, in which the solution algorithm and the discretization of the governing equations are given in detail. In Section 4, some simulation results are illustrated to stress the capability of the present method. All the simulations in this paper are applied to gas–liquid two-phase flows with density ratio of 1000. Finally, the conclusion of this paper is stated in Section 5.

A gas–liquid–solid three phase flow is considered in this paper, in which a liquid and its vapor, spherical solid particles and a substrate exist. Fig. 2
                      shows a two-dimensional schematic picture of the flow field on a Cartesian grid modeled in the present simulation method. The gas–liquid two-phase flow is treated as a single-field model, in which one set of conservation equations with the variable density and the variable viscosity is adopted. The free surface has a finite thickness, in which the density and the viscosity changes continuously. Each spherical particle is treated as a rigid body, in which the particle motion has 6 degrees of freedom: 3 for translation and 3 for rotation. The interface between the solid phase (particle and substrate) and the fluid has a finite thickness to accomplish the solid–fluid coupling in the IB method.


                        Fig. 3
                         shows a schematic picture of flow across a free surface. The mass conservation law between the liquid phase and the gas phase is expressed as
                           
                              (1)
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       l
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       s
                                    
                                 
                                 −
                                 
                                    
                                       v
                                    
                                    
                                       l
                                    
                                 
                                 )
                                 ⋅
                                 n
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       g
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       s
                                    
                                 
                                 −
                                 
                                    
                                       v
                                    
                                    
                                       g
                                    
                                 
                                 )
                                 ⋅
                                 n
                                 =
                                 (
                                 1
                                 −
                                 Ψ
                                 )
                                 
                                    
                                       ω
                                    
                                    
                                       ˙
                                    
                                 
                                 ,
                              
                           
                         where Ψ is the total fraction of solid phase that is introduced to eliminate the phase change in the solid phase. The velocity of the free surface leads to
                           
                              (2)
                              
                                 
                                    
                                       v
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       l
                                    
                                 
                                 +
                                 (
                                 1
                                 −
                                 Ψ
                                 )
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          ˙
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          l
                                       
                                    
                                 
                                 n
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       g
                                    
                                 
                                 +
                                 (
                                 1
                                 −
                                 Ψ
                                 )
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          ˙
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          g
                                       
                                    
                                 
                                 n
                                 .
                              
                           
                         Then the velocity of the free surface can be expressed in a single-field model as
                           
                              (3)
                              
                                 
                                    
                                       v
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 v
                                 +
                                 (
                                 1
                                 −
                                 Ψ
                                 )
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          ˙
                                       
                                    
                                    ρ
                                 
                                 n
                                 ,
                              
                           
                         where 
                           v
                         and ρ are the velocity and the variable density of fluid, respectively. Using the level set (LS) method [28], a free surface is defined as the zero level surface of a level set function ϕ. The advection equation of ϕ is given by
                           
                              (4)
                              
                                 
                                    
                                       ∂
                                       ϕ
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       v
                                    
                                    
                                       s
                                    
                                 
                                 ⋅
                                 ∇
                                 ϕ
                                 =
                                 0
                                 ,
                              
                           
                         where the domain of 
                           ϕ
                           >
                           0
                         represents the liquid phase and the domain of 
                           ϕ
                           <
                           0
                         represents the gas phase. The reinitialization of the level set function is accomplished using a converged solution of the advection equation as
                           
                              (5)
                              
                                 
                                    
                                       ∂
                                       ϕ
                                    
                                    
                                       ∂
                                       τ
                                    
                                 
                                 +
                                 S
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 n
                                 ⋅
                                 ∇
                                 ϕ
                                 =
                                 S
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ,
                              
                           
                         where
                           
                              (6)
                              
                                 S
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             0
                                          
                                          
                                             |
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   0
                                                
                                             
                                             |
                                             ≤
                                             
                                                1
                                                2
                                             
                                             h
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ϕ
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             |
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   0
                                                
                                             
                                             |
                                             >
                                             
                                                1
                                                2
                                             
                                             h
                                          
                                       
                                    
                                 
                              
                           
                         is the modified sign function [39], τ is the pseudo time step, 
                           
                              
                                 ϕ
                              
                              
                                 0
                              
                           
                         is the level set function before the reinitialization and h is the grid spacing. The unit normal vector to the free surface toward the liquid phase is given by
                           
                              (7)
                              
                                 n
                                 =
                                 
                                    
                                       ∇
                                       ϕ
                                    
                                    
                                       |
                                       ∇
                                       ϕ
                                       |
                                    
                                 
                                 .
                              
                           
                         In addition, the fraction of liquid phase is calculated from the level set function using a smoothed Heaviside function as
                           
                              (8)
                              
                                 F
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             0
                                          
                                          
                                             ϕ
                                             <
                                             −
                                             α
                                          
                                       
                                       
                                          
                                             
                                                1
                                                
                                                   2
                                                   π
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   π
                                                   ϕ
                                                
                                                α
                                             
                                             +
                                             
                                                ϕ
                                                
                                                   2
                                                   α
                                                
                                             
                                             +
                                             
                                                1
                                                2
                                             
                                          
                                          
                                             −
                                             α
                                             ≤
                                             ϕ
                                             ≤
                                             α
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             ϕ
                                             >
                                             α
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           α
                           =
                           1.5
                           h
                         represents the half thickness of the free surface.

It is generally required to solve the transport equations of energy and vapor to estimate the vaporization mass flow rate per unit surface 
                           
                              
                                 ω
                              
                              
                                 ˙
                              
                           
                        , because 
                           
                              
                                 ω
                              
                              
                                 ˙
                              
                           
                         is the function of the mass fraction of vapor species and temperature at the free surface [40]. During drying of a colloidal suspension, 
                           
                              
                                 ω
                              
                              
                                 ˙
                              
                           
                         may change in space and in time. Nevertheless, a constant 
                           
                              
                                 ω
                              
                              
                                 ˙
                              
                           
                         is used in this paper, because the focus of this paper is not to reproduce the behavior of phase change but to simulate the interactions between colloidal particles and a moving free surface. Therefore, the simulation results that are insensitive to a change of 
                           
                              
                                 ω
                              
                              
                                 ˙
                              
                           
                         are illustrated in this paper. Actually, a constant 
                           
                              
                                 ω
                              
                              
                                 ˙
                              
                           
                         could be an acceptable assumption, if the deformation of a free surface would be small enough for the diffusion of the vapor to be assumed constant in space.

Most recently, we have proposed the immersed free surface (IFS) model [38], in which a free surface is extended into the solid phase as a virtual free surface that is smoothly connected to the free surface at the three-phase contact line. Fig. 4
                         shows a schematic picture of the IFS model for a particle on a free surface. The total surface tension exerted on the contact line is replaced with the total surface tension exerted on the virtual free surface as
                           
                              (9)
                              
                                 
                                    ∮
                                    
                                       ∂
                                       S
                                    
                                 
                                 σ
                                 d
                                 r
                                 =
                                 
                                    ∫
                                    S
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       v
                                    
                                 
                                 
                                 d
                                 s
                                 .
                              
                           
                         A proof in two dimensions of Eq. (9) is described in Ref. [38]. Furthermore, the total surface tension exerted on the virtual free surface is transformed into the body force using the continuous surface force (CSF) model [41]. In a word, the force and the torque exerted on a solid phase are obtained from the volume integration of the body force in the solid phase instead of the line integration of the surface tension at the contact line. The transformation from the line integration into the volume integration leads to great savings of computational effort, because we do not have to define the contact line on the surface of solid phase. The shape of the virtual free surface may be arbitrary if the following conditions are satisfied. Firstly, the virtual free surface is required to intersect with the solid–fluid interface at a specified contact angle. Secondly, the whole virtual free surface is required to be inside the solid phase. To satisfy the above conditions, the level set function is modified in the l-th solid-phase using the advection equation as
                           
                              (10)
                              
                                 
                                    
                                       ∂
                                       ϕ
                                    
                                    
                                       ∂
                                       τ
                                    
                                 
                                 +
                                 Ψ
                                 
                                    
                                       e
                                    
                                    
                                       l
                                    
                                 
                                 ⋅
                                 ∇
                                 ϕ
                                 =
                                 Ψ
                                 |
                                 ∇
                                 ϕ
                                 |
                                 cos
                                 ⁡
                                 
                                    
                                       θ
                                    
                                    
                                       l
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 e
                              
                              
                                 l
                              
                           
                         is the inward unit normal to the l-th solid phase and 
                           
                              
                                 θ
                              
                              
                                 l
                              
                           
                         is the specified contact angle at the surface of the l-th solid phase. At each time step, the level set function in the solid-phase is modified using Eq. (10) after solving Eq. (4) in the whole domain. The equation is solved in an iterative manner as well as Eq. (5). The converged solution of Eq. (10) is expressed at the surface of the l-th solid phase as
                           
                              (11)
                              
                                 
                                    
                                       e
                                    
                                    
                                       l
                                    
                                 
                                 ⋅
                                 n
                                 =
                                 cos
                                 ⁡
                                 
                                    
                                       θ
                                    
                                    
                                       l
                                    
                                 
                                 ,
                              
                           
                         which means that the free surface intersects with the surface of the l-th solid phase at the specified contact angle. The modification of the level set function in the solid phase is followed by the reinitialization of the level set function in the whole domain.

Due to the above modification, the total volume of liquid phase is prone to be erroneous. Therefore, a simple correcting method of the level set function is introduced to conserve the total volume of liquid phase. After the reinitialization, the level set function is corrected as
                           
                              (12)
                              
                                 ϕ
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       e
                                    
                                 
                                 −
                                 
                                    
                                       Δ
                                       V
                                    
                                    
                                       
                                          S
                                       
                                       
                                          s
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 ϕ
                              
                              
                                 e
                              
                           
                         is the erroneous level set function, ΔV is the volumetric error of liquid phase between before and after solving the level set equations and 
                           
                              
                                 S
                              
                              
                                 s
                              
                           
                         is the area of free surface. The area of free surface is given by
                           
                              (13)
                              
                                 
                                    
                                       S
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    ∫
                                    Ω
                                 
                                 (
                                 1
                                 −
                                 Ψ
                                 )
                                 
                                    
                                       ∂
                                       F
                                    
                                    
                                       ∂
                                       ϕ
                                    
                                 
                                 d
                                 x
                                 d
                                 y
                                 d
                                 z
                                 ,
                              
                           
                         where Ω is the whole computational domain. The volumetric error of liquid phase is expressed as
                           
                              (14)
                              
                                 Δ
                                 V
                                 =
                                 
                                    
                                       V
                                    
                                    
                                       after
                                    
                                 
                                 −
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          before
                                       
                                    
                                    −
                                    E
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 V
                              
                              
                                 before
                              
                           
                         is the volume of liquid phase before solving the level set equations, 
                           
                              
                                 V
                              
                              
                                 after
                              
                           
                         is the volume of liquid phase after solving the level set equations and E is the phase change volume of liquid phase at each time step. The volume of liquid phase is given by
                           
                              (15)
                              
                                 V
                                 =
                                 
                                    ∫
                                    Ω
                                 
                                 (
                                 1
                                 −
                                 Ψ
                                 )
                                 F
                                 d
                                 x
                                 d
                                 y
                                 d
                                 z
                                 ,
                              
                           
                         and the phase change volume of liquid phase at each time step is given by
                           
                              (16)
                              
                                 E
                                 =
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          ˙
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       s
                                    
                                 
                                 Δ
                                 t
                                 ,
                              
                           
                         where Δt is the computational time step. The above correction means a parallel translation of the level set function, so that it does not impair the property of the distance function ϕ. It is noted that Eq. (12) may be only valid for such a simple topology of the liquid phase that will be presented in this paper. We are planning to introduce a more sophisticated method to correct the level set function that is applicable to a complicated topology of the liquid phase.

The law of mass conservation of multiphase flow is expressed as
                           
                              (17)
                              
                                 
                                    
                                       ∂
                                       ρ
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 +
                                 ∇
                                 ⋅
                                 (
                                 ρ
                                 v
                                 )
                                 =
                                 0
                                 .
                              
                           
                         To employ a pressure-based solver, the continuity equation is derived from Eq. (4) and Eq. (17) as follows: multiplying Eq. (4) by 
                           ∂
                           ρ
                           /
                           ∂
                           ϕ
                         and substituting 
                           n
                           =
                           ∇
                           ρ
                           /
                           |
                           ∇
                           ρ
                           |
                         yields
                           
                              (18)
                              
                                 
                                    
                                       ∂
                                       ρ
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 +
                                 ∇
                                 ⋅
                                 (
                                 ρ
                                 v
                                 )
                                 −
                                 ρ
                                 ∇
                                 ⋅
                                 v
                                 +
                                 
                                    
                                       (
                                       1
                                       −
                                       Ψ
                                       )
                                       
                                          
                                             ω
                                          
                                          
                                             ˙
                                          
                                       
                                    
                                    ρ
                                 
                                 |
                                 ∇
                                 ρ
                                 |
                                 =
                                 0
                                 .
                              
                           
                         Comparing Eq. (18) with Eq. (17), a non-conservative form of the continuity equation is given as
                           
                              (19)
                              
                                 ∇
                                 ⋅
                                 v
                                 =
                                 
                                    
                                       (
                                       1
                                       −
                                       Ψ
                                       )
                                       
                                          
                                             ω
                                          
                                          
                                             ˙
                                          
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 |
                                 ∇
                                 ρ
                                 |
                                 .
                              
                           
                         Eq. (19) is rewritten in a conservative form as
                           
                              (20)
                              
                                 ∇
                                 ⋅
                                 v
                                 =
                                 (
                                 1
                                 −
                                 Ψ
                                 )
                                 
                                    
                                       ω
                                    
                                    
                                       ˙
                                    
                                 
                                 
                                    |
                                    ∇
                                    
                                       (
                                       
                                          1
                                          ρ
                                       
                                       )
                                    
                                    |
                                 
                                 ,
                              
                           
                         which is adopted in the present method. The velocity jump condition at the free surface induced by phase change is naturally imposed through the continuity equation of Eq. (20). In a free surface with finite thickness, the smoothly varying density of fluid yields a non-zero divergence of velocity. As a result, the velocity jump takes place across the free surface with phase change.

The law of momentum conservation is based on the Landau–Lifshitz Navier–Stokes (LLNS) equations and expressed as
                           
                              (21)
                              
                                 ρ
                                 
                                    
                                       ∂
                                       v
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 −
                                 ρ
                                 v
                                 ⋅
                                 ∇
                                 v
                                 −
                                 ∇
                                 p
                                 +
                                 ∇
                                 ⋅
                                 μ
                                 
                                    {
                                    ∇
                                    v
                                    +
                                    
                                       
                                          (
                                          ∇
                                          v
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    }
                                 
                                 −
                                 
                                    2
                                    3
                                 
                                 ∇
                                 ⋅
                                 
                                    {
                                    μ
                                    (
                                    ∇
                                    ⋅
                                    v
                                    )
                                    I
                                    }
                                 
                                 +
                                 ∇
                                 ⋅
                                 S
                                 +
                                 ρ
                                 g
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       s
                                    
                                 
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       p
                                    
                                 
                                 ,
                              
                           
                         where p is the pressure, μ is the variable viscosity of fluid, 
                           I
                         is the identity matrix, 
                           S
                         is the stochastic stress tensor, 
                           g
                         is the gravity acceleration, 
                           
                              
                                 F
                              
                              
                                 s
                              
                           
                         is the surface tension, and 
                           
                              
                                 F
                              
                              
                                 p
                              
                           
                         is the body force that is introduced for solid–fluid coupling in the immersed boundary (IB) method [17]. Note that the fourth term in the right-hand side cannot be eliminated, because the divergence of velocity is not equal to zero for a flow with variable density. The variable density and the variable viscosity are given by
                           
                              (22)
                              
                                 ρ
                                 =
                                 F
                                 
                                    
                                       ρ
                                    
                                    
                                       l
                                    
                                 
                                 +
                                 (
                                 1
                                 −
                                 F
                                 )
                                 
                                    
                                       ρ
                                    
                                    
                                       g
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (23)
                              
                                 μ
                                 =
                                 F
                                 
                                    
                                       μ
                                    
                                    
                                       l
                                    
                                 
                                 +
                                 (
                                 1
                                 −
                                 F
                                 )
                                 
                                    
                                       μ
                                    
                                    
                                       g
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 μ
                              
                              
                                 l
                              
                           
                         is the viscosity of liquid phase, 
                           
                              
                                 μ
                              
                              
                                 g
                              
                           
                         is the viscosity of gas phase.

The stochastic stress tensor [42] is given by
                           
                              (24)
                              
                                 S
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   x
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   x
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   x
                                                   z
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   y
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   y
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   y
                                                   z
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   z
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   z
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   z
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                         where
                           
                              (25)
                              
                                 
                                    〈
                                    
                                       
                                          s
                                       
                                       
                                          x
                                          x
                                       
                                    
                                    〉
                                    =
                                    〈
                                    
                                       
                                          s
                                       
                                       
                                          x
                                          y
                                       
                                    
                                    〉
                                    =
                                    〈
                                    
                                       
                                          s
                                       
                                       
                                          x
                                          z
                                       
                                    
                                    〉
                                    =
                                    〈
                                    
                                       
                                          s
                                       
                                       
                                          y
                                          x
                                       
                                    
                                    〉
                                    =
                                    〈
                                    
                                       
                                          s
                                       
                                       
                                          y
                                          y
                                       
                                    
                                    〉
                                    =
                                    〈
                                    
                                       
                                          s
                                       
                                       
                                          y
                                          z
                                       
                                    
                                    〉
                                    =
                                    〈
                                    
                                       
                                          s
                                       
                                       
                                          z
                                          x
                                       
                                    
                                    〉
                                    =
                                    〈
                                    
                                       
                                          s
                                       
                                       
                                          z
                                          y
                                       
                                    
                                    〉
                                    =
                                    〈
                                    
                                       
                                          s
                                       
                                       
                                          z
                                          z
                                       
                                    
                                    〉
                                    =
                                    0
                                    ,
                                 
                              
                              
                                 
                                    
                                       〈
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   x
                                                   x
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       〉
                                    
                                    =
                                    
                                       〈
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   y
                                                   y
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       〉
                                    
                                    =
                                    
                                       〈
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   z
                                                   z
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       〉
                                    
                                    =
                                    
                                       8
                                       3
                                    
                                    
                                       
                                          k
                                       
                                       
                                          B
                                       
                                    
                                    T
                                    μ
                                    δ
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    δ
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    δ
                                    
                                       (
                                       z
                                       −
                                       
                                          
                                             z
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    δ
                                    
                                       (
                                       t
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    〈
                                    
                                       
                                          s
                                       
                                       
                                          x
                                          x
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          y
                                          y
                                       
                                    
                                    〉
                                    =
                                    〈
                                    
                                       
                                          s
                                       
                                       
                                          x
                                          x
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          z
                                          z
                                       
                                    
                                    〉
                                    =
                                    〈
                                    
                                       
                                          s
                                       
                                       
                                          y
                                          y
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          z
                                          z
                                       
                                    
                                    〉
                                    =
                                    −
                                    
                                       4
                                       3
                                    
                                    
                                       
                                          k
                                       
                                       
                                          B
                                       
                                    
                                    T
                                    μ
                                    δ
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    δ
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    δ
                                    
                                       (
                                       z
                                       −
                                       
                                          
                                             z
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    δ
                                    
                                       (
                                       t
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       〈
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   x
                                                   y
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       〉
                                    
                                    =
                                    
                                       〈
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   x
                                                   z
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       〉
                                    
                                    =
                                    
                                       〈
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   y
                                                   z
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       〉
                                    
                                    =
                                    2
                                    
                                       
                                          k
                                       
                                       
                                          B
                                       
                                    
                                    T
                                    μ
                                    δ
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    δ
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    δ
                                    
                                       (
                                       z
                                       −
                                       
                                          
                                             z
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    δ
                                    
                                       (
                                       t
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       〈
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   y
                                                   x
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       〉
                                    
                                    =
                                    
                                       〈
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   x
                                                   y
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       〉
                                    
                                    ,
                                    
                                    
                                       〈
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   z
                                                   x
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       〉
                                    
                                    =
                                    
                                       〈
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   x
                                                   z
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       〉
                                    
                                    ,
                                    
                                    
                                       〈
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   z
                                                   y
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       〉
                                    
                                    =
                                    
                                       〈
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   y
                                                   z
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       〉
                                    
                                    .
                                 
                              
                           
                         Here 
                           〈
                           
                           〉
                         denotes an ensemble average, 
                           
                              
                                 k
                              
                              
                                 B
                              
                           
                         is the Boltzmann constant, T is the temperature and δ is the Dirac's delta function. The surface tension is expressed according to the CSF model as
                           
                              (26)
                              
                                 
                                    
                                       F
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 σ
                                 κ
                                 ∇
                                 F
                                 ,
                              
                           
                         where σ is the surface tension coefficient, κ is the mean curvature of free surface that is calculated from the level set function [43] as
                           
                              (27)
                              
                                 κ
                                 =
                                 −
                                 ∇
                                 ⋅
                                 n
                                 =
                                 −
                                 
                                    1
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          3
                                          /
                                          2
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                x
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          y
                                          y
                                       
                                    
                                    −
                                    2
                                    
                                       
                                          ϕ
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          y
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          x
                                          y
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                y
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          x
                                          x
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                x
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          z
                                          z
                                       
                                    
                                    −
                                    2
                                    
                                       
                                          ϕ
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          z
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          x
                                          z
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                z
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          x
                                          x
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                y
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          z
                                          z
                                       
                                    
                                    −
                                    2
                                    
                                       
                                          ϕ
                                       
                                       
                                          y
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          z
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          y
                                          z
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                z
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          y
                                          y
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

The body force is expressed as
                           
                              (28)
                              
                                 
                                    
                                       F
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 Ψ
                                 ρ
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             p
                                          
                                       
                                       −
                                       v
                                    
                                    
                                       Δ
                                       t
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 v
                              
                              
                                 p
                              
                           
                         is the total velocity of solid phase. This simple immersed boundary method may have such numerical problems as temporal oscillation, grid dependency and velocity divergence [44]. From our experience, however, those problems are practically unnoticeable for a particulate flow of low Reynolds number that contains the particles heavier than the fluid. It is probably because the inertia effect is very small. In fact, the particle Reynolds number is at most 0.05 in the present simulations. The total fraction of solid phase is a summation of the fractions of the solid phases (particles and substrate) that overlap one another as
                           
                              (29)
                              
                                 Ψ
                                 =
                                 
                                    ∑
                                    l
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       l
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 ψ
                              
                              
                                 l
                              
                           
                         is the fraction of the l-th solid phase. Here 
                           
                              
                                 ψ
                              
                              
                                 l
                              
                           
                         is calculated using a smoothed Heaviside function as
                           
                              (30)
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   l
                                                
                                             
                                             <
                                             −
                                             α
                                          
                                       
                                       
                                          
                                             
                                                1
                                                
                                                   2
                                                   π
                                                
                                             
                                             sin
                                             ⁡
                                             
                                                
                                                   π
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                
                                                α
                                             
                                             +
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      l
                                                   
                                                
                                                
                                                   2
                                                   α
                                                
                                             
                                             +
                                             
                                                1
                                                2
                                             
                                          
                                          
                                             −
                                             α
                                             ≤
                                             
                                                
                                                   d
                                                
                                                
                                                   l
                                                
                                             
                                             ≤
                                             α
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   l
                                                
                                             
                                             >
                                             α
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 d
                              
                              
                                 l
                              
                           
                         is the signed distance function from the l-th solid–fluid interface and 
                           α
                           =
                           1.5
                           h
                         is the half thickness of the solid–fluid interface. For a spherical particle, 
                           
                              
                                 d
                              
                              
                                 l
                              
                           
                         is given by
                           
                              (31)
                              
                                 
                                    
                                       d
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       l
                                    
                                 
                                 −
                                 |
                                 
                                    
                                       
                                          r
                                          ¯
                                       
                                    
                                    
                                       l
                                    
                                 
                                 |
                                 ,
                              
                           
                         where 
                           
                              
                                 a
                              
                              
                                 l
                              
                           
                         is the radius of the l-th particle and 
                           
                              
                                 
                                    r
                                    ¯
                                 
                              
                              
                                 l
                              
                           
                         is the position vector from the center of the l-th particle. The total velocity of solid phase is a weighted average of the rigid velocities of the solid phases that overlap one another as
                           
                              (32)
                              
                                 
                                    
                                       v
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             ψ
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             
                                                p
                                                ,
                                             
                                             l
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             ψ
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 v
                              
                              
                                 
                                    p
                                    ,
                                 
                                 l
                              
                           
                         is the rigid velocity of the l-th solid phase. For a spherical particle,
                           
                              (33)
                              
                                 
                                    
                                       v
                                    
                                    
                                       
                                          p
                                          ,
                                       
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       V
                                    
                                    
                                       l
                                    
                                 
                                 +
                                 
                                    
                                       Ω
                                    
                                    
                                       l
                                    
                                 
                                 ×
                                 
                                    
                                       
                                          r
                                          ¯
                                       
                                    
                                    
                                       l
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 V
                              
                              
                                 l
                              
                           
                         is the translational velocity of the l-th particle and 
                           
                              
                                 Ω
                              
                              
                                 l
                              
                           
                         is the rotational velocity of the l-th particle. The body force works only in the solid phase, in which the velocity in Eq. (21) is forced into the total velocity of solid phase. As a result, the no-slip boundary condition on the solid–fluid interface is implicitly fulfilled.

Based on the Newton's second law of motion. The translational motion of the l-th particle is expressed as
                           
                              (34)
                              
                                 
                                    
                                       M
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       d
                                       
                                          
                                             V
                                          
                                          
                                             l
                                          
                                       
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       c
                                       ,
                                       l
                                    
                                 
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       e
                                       ,
                                       l
                                    
                                 
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       v
                                       ,
                                       l
                                    
                                 
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 M
                              
                              
                                 l
                              
                           
                         is the mass of particle, 
                           
                              
                                 F
                              
                              
                                 c
                                 ,
                                 l
                              
                           
                         is the contact force, 
                           
                              
                                 F
                              
                              
                                 e
                                 ,
                                 l
                              
                           
                         is the electrostatic force, 
                           
                              
                                 F
                              
                              
                                 v
                                 ,
                                 l
                              
                           
                         is the van der Waals force and 
                           
                              
                                 F
                              
                              
                                 v
                                 ,
                                 l
                              
                           
                         is the hydrodynamic force. The rotational motion of the l-th particle is expressed as
                           
                              (35)
                              
                                 
                                    
                                       I
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       d
                                       
                                          
                                             Ω
                                          
                                          
                                             l
                                          
                                       
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       c
                                       ,
                                       l
                                    
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 I
                              
                              
                                 l
                              
                           
                         is the inertia moment of particle, 
                           
                              
                                 T
                              
                              
                                 c
                                 ,
                                 l
                              
                           
                         is the contact torque and 
                           
                              
                                 T
                              
                              
                                 h
                                 ,
                                 l
                              
                           
                         is the hydrodynamic torque. The trajectory of the l-th particle is calculated from the translational velocity as
                           
                              (36)
                              
                                 
                                    
                                       d
                                       
                                          
                                             X
                                          
                                          
                                             l
                                          
                                       
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       V
                                    
                                    
                                       l
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 X
                              
                              
                                 l
                              
                           
                         denotes the center of the l-th particle.

The contact force and the contact torque are obtained by a summation of the forces exerted by solid objects (particles and substrate) that are in contact with the l-th particle as
                           
                              (37)
                              
                                 
                                    
                                       F
                                    
                                    
                                       c
                                       ,
                                       l
                                    
                                 
                                 =
                                 
                                    ∑
                                    m
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       t
                                       ,
                                       m
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (38)
                              
                                 
                                    
                                       T
                                    
                                    
                                       c
                                       ,
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       l
                                    
                                 
                                 
                                    ∑
                                    m
                                 
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       m
                                    
                                 
                                 ×
                                 
                                    
                                       f
                                    
                                    
                                       t
                                       ,
                                       m
                                    
                                 
                                 )
                                 .
                              
                           
                         Here m is an index of the solid object that is in contact with the l-th particle, 
                           
                              
                                 f
                              
                              
                                 n
                                 ,
                                 m
                              
                           
                         is the normal force exerted by the m-th solid object, 
                           
                              
                                 f
                              
                              
                                 t
                                 ,
                                 m
                              
                           
                         is the tangential force exerted by the m-th solid object and 
                           
                              
                                 n
                              
                              
                                 m
                              
                           
                         is the unit normal vector to the m-th solid object. The normal force and the tangential force are given by the Voigt model [45] used in the discrete element method (DEM) [46]. The tangential force consists of a slider as well as a spring and a dashpot, so that the model is able to describe a friction between solid objects. The reason why we adopt this sophisticated model is that the frictions of particle-to-particle and particle-to-substrate play a crucial role for a structure formation of the colloidal particles [47,48]. The Voigt model is described in our previous work on a DEM simulation [49] in detail.

The electrostatic force and the van der Waals force are obtained by a summation of the forces exerted by solid objects that are close to the l-th particle as
                           
                              (39)
                              
                                 
                                    
                                       F
                                    
                                    
                                       e
                                       ,
                                       l
                                    
                                 
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       v
                                       ,
                                       l
                                    
                                 
                                 =
                                 
                                    ∑
                                    m
                                 
                                 (
                                 −
                                 
                                    
                                       f
                                    
                                    
                                       e
                                       ,
                                       m
                                    
                                 
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       v
                                       ,
                                       m
                                    
                                 
                                 )
                                 
                                    
                                       n
                                    
                                    
                                       m
                                    
                                 
                                 ,
                              
                           
                         where m is an index of the solid object close to the particle, 
                           
                              
                                 f
                              
                              
                                 e
                                 ,
                                 m
                              
                           
                         is the magnitude of two-body electrostatic force and 
                           
                              
                                 f
                              
                              
                                 v
                                 ,
                                 m
                              
                           
                         is the magnitude of two-body van der Waals force. Both the two-body electrostatic force and the two-body van der Waals force are given by the DLVO (Derjaguin–Landau–Verwey–Overbeek) theory [50]. The magnitudes of the forces are functions of the inter-surface distance between two solid objects. If the electric charges on the two solid objects have the same sign, the electrostatic force is repulsive. On the other hand, the van der Waals force is always attractive. The formulae of the two-body forces are described in Ref. [49] in detail. It is noted that the surface of solid object is treated as a sharp interface to estimate 
                           
                              
                                 F
                              
                              
                                 c
                                 ,
                                 l
                              
                           
                        , 
                           
                              
                                 T
                              
                              
                                 c
                                 ,
                                 l
                              
                           
                        , 
                           
                              
                                 F
                              
                              
                                 e
                                 ,
                                 l
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 v
                                 ,
                                 l
                              
                           
                        , unlike the hydrodynamic force and the hydrodynamic torque described below.

The hydrodynamic force and the hydrodynamic torque are obtained by the volume integration of the body force in Eq. (28) as
                           
                              (40)
                              
                                 
                                    
                                       F
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                 
                                 =
                                 −
                                 ∫
                                 
                                    {
                                    
                                       
                                          F
                                       
                                       
                                          p
                                       
                                    
                                    −
                                    Ψ
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          p
                                       
                                    
                                    −
                                    ρ
                                    )
                                    g
                                    }
                                 
                                 d
                                 V
                                 ,
                              
                           
                        
                        
                           
                              (41)
                              
                                 
                                    
                                       T
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                 
                                 =
                                 −
                                 ∫
                                 (
                                 
                                    
                                       
                                          r
                                          ¯
                                       
                                    
                                    
                                       l
                                    
                                 
                                 ×
                                 
                                    
                                       F
                                    
                                    
                                       p
                                    
                                 
                                 )
                                 d
                                 V
                                 ,
                              
                           
                         where 
                           
                              
                                 ρ
                              
                              
                                 p
                              
                           
                         is the density of particle. As shown in Eq. (40), the buoyancy is included in the hydrodynamic force. Using the immersed free surface model, the capillary force and the capillary torque exerted on the particle are naturally introduced into 
                           
                              
                                 F
                              
                              
                                 h
                                 ,
                                 l
                              
                           
                         and 
                           
                              
                                 T
                              
                              
                                 h
                                 ,
                                 l
                              
                           
                        , respectively. This is because 
                           
                              
                                 F
                              
                              
                                 p
                              
                           
                         is a function of 
                           v
                         in the particle that is induced by the surface tension exerted on the virtual free surface. Then we can compute efficiently the capillary force exerted on a particle by the present method, because any explicit treatment of the contact angle boundary condition is not necessary. Furthermore, it is noted that 
                           
                              
                                 F
                              
                              
                                 h
                              
                           
                         and 
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                         are stochastic because 
                           
                              
                                 F
                              
                              
                                 p
                              
                           
                         is a function of fluctuating velocity 
                           v
                        . Then the translational and the rotational Brownian motions of the particle emanate from the above stochastic hydrodynamic force and torque.

The present simulation method employs a weakly-coupled numerical solver for gas–liquid–solid three-phase flows. In a word, the equations of free surface motion, multiphase flow and particle motion are solved in sequence at each time step. Fig. 5
                      shows the solution algorithm in the present simulation method in a flow chart. Major discretization schemes to solve the equations are described in the following subsections.

The free surface and the virtual free surface are represented by the level set function. The equations of the level set function, Eqs. (4), (5) and (10) must be solved accurately, especially for gas–liquid two-phase flows with high density ratios. Therefore, a third-order total variation diminishing (TVD) Runge–Kutta scheme [51] and a fifth-order weighted essentially non-oscillatory (WENO) scheme [52] are adopted to solve the equations in this paper. These schemes allow us to simulate gas–liquid two-phase flows with density ratio up to 1000. All the variables in the level set equations are defined at cell centers. Expressing the right-hand side of the equations as 
                           R
                           (
                           ϕ
                           )
                        , a third-order TVD Runge–Kutta scheme is expressed as
                           
                              (42)
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          ⁎
                                       
                                    
                                    =
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          n
                                       
                                    
                                    +
                                    Δ
                                    t
                                    R
                                    
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          ⁎
                                          ⁎
                                       
                                    
                                    =
                                    
                                       3
                                       4
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          n
                                       
                                    
                                    +
                                    
                                       1
                                       4
                                    
                                    
                                       {
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                          
                                             ⁎
                                          
                                       
                                       +
                                       Δ
                                       t
                                       R
                                       
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             
                                                ⁎
                                             
                                          
                                          )
                                       
                                       }
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       1
                                       3
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          n
                                       
                                    
                                    +
                                    
                                       2
                                       3
                                    
                                    
                                       {
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                          
                                             ⁎
                                             ⁎
                                          
                                       
                                       +
                                       Δ
                                       t
                                       R
                                       
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             
                                                ⁎
                                                ⁎
                                             
                                          
                                          )
                                       
                                       }
                                    
                                    ,
                                 
                              
                           
                         where n and 
                           n
                           +
                           1
                         are indices for temporal discretization. The right-hand side of the level set equations has a uniform expression as
                           
                              (43)
                              
                                 R
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 )
                                 =
                                 −
                                 (
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       x
                                       ,
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       y
                                       ,
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       z
                                       ,
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                           
                        , 
                           
                              
                                 
                                    
                                       v
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                           
                        , 
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                           
                         are the components of the advection velocity and 
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                           
                         is the source term. Note that i, j, k are indices for spatial discretization. Using an upstream differencing scheme, the advection term in x direction is discretized as
                           
                              (44)
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       x
                                       ,
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       −
                                       |
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       |
                                    
                                    2
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       x
                                       ,
                                       i
                                    
                                    
                                       +
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       +
                                       |
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       |
                                    
                                    2
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       x
                                       ,
                                       i
                                    
                                    
                                       −
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 ϕ
                              
                              
                                 x
                                 ,
                                 i
                              
                              
                                 +
                              
                           
                         represents a forward differencing and 
                           
                              
                                 ϕ
                              
                              
                                 x
                                 ,
                                 i
                              
                              
                                 −
                              
                           
                         represents a backward differencing, respectively. The advection terms in y and z directions are discretized in the same manner.

In the fifth-order WENO scheme, the forward differencing and the backward differencing are expressed as weighted averages of three third-order differencing schemes as
                           
                              (45)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       x
                                       ,
                                       i
                                    
                                    
                                       ±
                                    
                                 
                                 =
                                 
                                    
                                       ω
                                    
                                    
                                       x
                                       ,
                                       i
                                    
                                    
                                       ±
                                       ,
                                       1
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       x
                                       ,
                                       i
                                    
                                    
                                       ±
                                       ,
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       ω
                                    
                                    
                                       x
                                       ,
                                       i
                                    
                                    
                                       ±
                                       ,
                                       2
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       x
                                       ,
                                       i
                                    
                                    
                                       ±
                                       ,
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       ω
                                    
                                    
                                       x
                                       ,
                                       i
                                    
                                    
                                       ±
                                       ,
                                       3
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       x
                                       ,
                                       i
                                    
                                    
                                       ±
                                       ,
                                       3
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 ω
                              
                              
                                 x
                                 ,
                                 i
                              
                              
                                 ±
                                 ,
                                 m
                              
                           
                         is the weighting coefficients. The third-order differencing schemes are expressed as
                           
                              (46)
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          x
                                          ,
                                          i
                                       
                                       
                                          ±
                                          ,
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             d
                                          
                                          
                                             x
                                             ,
                                             i
                                          
                                          
                                             ±
                                             ,
                                             1
                                          
                                       
                                       3
                                    
                                    −
                                    
                                       
                                          7
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                2
                                             
                                          
                                       
                                       6
                                    
                                    +
                                    
                                       
                                          11
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                3
                                             
                                          
                                       
                                       6
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          x
                                          ,
                                          i
                                       
                                       
                                          ±
                                          ,
                                          2
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          
                                             d
                                          
                                          
                                             x
                                             ,
                                             i
                                          
                                          
                                             ±
                                             ,
                                             2
                                          
                                       
                                       6
                                    
                                    +
                                    
                                       
                                          5
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                3
                                             
                                          
                                       
                                       6
                                    
                                    +
                                    
                                       
                                          
                                             d
                                          
                                          
                                             x
                                             ,
                                             i
                                          
                                          
                                             ±
                                             ,
                                             4
                                          
                                       
                                       3
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          x
                                          ,
                                          i
                                       
                                       
                                          ±
                                          ,
                                          3
                                       
                                    
                                    =
                                    
                                       
                                          
                                             d
                                          
                                          
                                             x
                                             ,
                                             i
                                          
                                          
                                             ±
                                             ,
                                             3
                                          
                                       
                                       3
                                    
                                    +
                                    
                                       
                                          5
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                4
                                             
                                          
                                       
                                       6
                                    
                                    −
                                    
                                       
                                          
                                             d
                                          
                                          
                                             x
                                             ,
                                             i
                                          
                                          
                                             ±
                                             ,
                                             5
                                          
                                       
                                       6
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 d
                              
                              
                                 x
                                 ,
                                 i
                              
                              
                                 ±
                                 ,
                                 m
                              
                           
                         is the first-order differencing scheme defined as
                           
                              (47)
                              
                                 
                                    
                                       d
                                    
                                    
                                       x
                                       ,
                                       i
                                    
                                    
                                       ±
                                       ,
                                       m
                                    
                                 
                                 =
                                 ±
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                             ±
                                             (
                                             4
                                             −
                                             m
                                             )
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       −
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                             ±
                                             (
                                             3
                                             −
                                             m
                                             )
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                    
                                    
                                       Δ
                                       x
                                    
                                 
                                 .
                              
                           
                         Here Δx denotes the grid spacing in x direction. Each weighting coefficient is expressed as
                           
                              (48)
                              
                                 
                                    
                                       ω
                                    
                                    
                                       x
                                       ,
                                       i
                                    
                                    
                                       ±
                                       ,
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       
                                          α
                                       
                                       
                                          x
                                          ,
                                          i
                                       
                                       
                                          ±
                                          ,
                                          m
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             m
                                             =
                                             1
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             α
                                          
                                          
                                             x
                                             ,
                                             i
                                          
                                          
                                             ±
                                             ,
                                             m
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where
                           
                              (49)
                              
                                 
                                    
                                       α
                                    
                                    
                                       x
                                       ,
                                       i
                                    
                                    
                                       ±
                                       ,
                                       1
                                    
                                 
                                 =
                                 
                                    0.1
                                    
                                       
                                          (
                                          
                                             
                                                S
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                1
                                             
                                          
                                          +
                                          ϵ
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       α
                                    
                                    
                                       x
                                       ,
                                       i
                                    
                                    
                                       ±
                                       ,
                                       1
                                    
                                 
                                 =
                                 
                                    0.6
                                    
                                       
                                          (
                                          
                                             
                                                S
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                2
                                             
                                          
                                          +
                                          ϵ
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       α
                                    
                                    
                                       x
                                       ,
                                       i
                                    
                                    
                                       ±
                                       ,
                                       1
                                    
                                 
                                 =
                                 
                                    0.3
                                    
                                       
                                          (
                                          
                                             
                                                S
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                3
                                             
                                          
                                          +
                                          ϵ
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                                 .
                              
                           
                         Here 
                           ϵ
                           =
                           
                              
                                 10
                              
                              
                                 −
                                 10
                              
                           
                         is a small value to avoid dividing by zero and 
                           
                              
                                 S
                              
                              
                                 x
                                 ,
                                 i
                              
                              
                                 ±
                                 ,
                                 m
                              
                           
                         is the smoothness indicator of each third-order differencing as
                           
                              (50)
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          x
                                          ,
                                          i
                                       
                                       
                                          ±
                                          ,
                                          1
                                       
                                    
                                    =
                                    
                                       13
                                       12
                                    
                                    
                                       
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                1
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                3
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       1
                                       4
                                    
                                    
                                       
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                1
                                             
                                          
                                          −
                                          4
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                2
                                             
                                          
                                          +
                                          3
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                3
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          x
                                          ,
                                          i
                                       
                                       
                                          ±
                                          ,
                                          2
                                       
                                    
                                    =
                                    
                                       13
                                       12
                                    
                                    
                                       
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                2
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                3
                                             
                                          
                                          +
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                4
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       1
                                       4
                                    
                                    
                                       
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                4
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          x
                                          ,
                                          i
                                       
                                       
                                          ±
                                          ,
                                          3
                                       
                                    
                                    =
                                    
                                       13
                                       12
                                    
                                    
                                       
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                3
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                4
                                             
                                          
                                          +
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                5
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       1
                                       4
                                    
                                    
                                       
                                          (
                                          3
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                3
                                             
                                          
                                          −
                                          4
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                4
                                             
                                          
                                          +
                                          
                                             
                                                d
                                             
                                             
                                                x
                                                ,
                                                i
                                             
                                             
                                                ±
                                                ,
                                                5
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

The advection velocity and the source term in Eq. (43) depend on each equation of the level set function. For the advection equation of Eq. (4),
                           
                              (51)
                              
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             u
                                             ¯
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          (
                                          1
                                          −
                                          
                                             
                                                Ψ
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          )
                                          
                                             
                                                ω
                                             
                                             
                                                ˙
                                             
                                          
                                       
                                       
                                          
                                             ρ
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          x
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             v
                                             ¯
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          (
                                          1
                                          −
                                          
                                             
                                                Ψ
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          )
                                          
                                             
                                                ω
                                             
                                             
                                                ˙
                                             
                                          
                                       
                                       
                                          
                                             ρ
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          y
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             w
                                             ¯
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          (
                                          1
                                          −
                                          
                                             
                                                Ψ
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          )
                                          
                                             
                                                ω
                                             
                                             
                                                ˙
                                             
                                          
                                       
                                       
                                          
                                             ρ
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          z
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    0
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 n
                              
                              
                                 x
                              
                           
                        , 
                           
                              
                                 n
                              
                              
                                 y
                              
                           
                        , 
                           
                              
                                 n
                              
                              
                                 z
                              
                           
                         are the components of 
                           n
                         as
                           
                              (52)
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          x
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             x
                                             ,
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         x
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         y
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         z
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          y
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             y
                                             ,
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         x
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         y
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         z
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          z
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             z
                                             ,
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         x
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         y
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         z
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                         Here derivatives 
                           
                              
                                 ϕ
                              
                              
                                 x
                              
                           
                        , 
                           
                              
                                 ϕ
                              
                              
                                 y
                              
                           
                        , 
                           
                              
                                 ϕ
                              
                              
                                 z
                              
                           
                         are obtained using the second-order central differencing. In addition, 
                           
                              u
                              ¯
                           
                        , 
                           
                              v
                              ¯
                           
                        , 
                           
                              w
                              ¯
                           
                         in Eq. (51) are the components of cell-centered flow velocity. Since the flow velocity is defined at cell faces on a staggered grid, the cell-centered velocity should be estimated using the cell-faced velocity. In the present method, it is achieved based on the assumption that a cell face is occupied by the fluid with larger density between both sides of the cell face. According to this assumption, the components of the cell-centered velocity are expressed as
                           
                              (53)
                              
                                 
                                    
                                       
                                          
                                             u
                                             ¯
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      x
                                                      ,
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      x
                                                      ,
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                <
                                                0
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             v
                                             ¯
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      y
                                                      ,
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      +
                                                      1
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      y
                                                      ,
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                <
                                                0
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             w
                                             ¯
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      z
                                                      ,
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      z
                                                      ,
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                <
                                                0
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                         For the reinitialization equation of Eq. (5), the advection velocity and the source term are expressed as
                           
                              (54)
                              
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    S
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          0
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    )
                                    
                                       
                                          n
                                       
                                       
                                          x
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    S
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          0
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    )
                                    
                                       
                                          n
                                       
                                       
                                          y
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    S
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          0
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    )
                                    
                                       
                                          n
                                       
                                       
                                          z
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    S
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          0
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                         where 
                           S
                           (
                           
                              
                                 ϕ
                              
                              
                                 0
                                 ,
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                           
                           )
                         is the discretized form of Eq. (6). For the modification equation of Eq. (10),
                           
                              (55)
                              
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          Ψ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                l
                                             
                                          
                                          
                                             
                                                ψ
                                             
                                             
                                                l
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                l
                                                ,
                                                x
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                l
                                             
                                          
                                          
                                             
                                                ψ
                                             
                                             
                                                l
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          Ψ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                l
                                             
                                          
                                          
                                             
                                                ψ
                                             
                                             
                                                l
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                l
                                                ,
                                                y
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                l
                                             
                                          
                                          
                                             
                                                ψ
                                             
                                             
                                                l
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          Ψ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                l
                                             
                                          
                                          
                                             
                                                ψ
                                             
                                             
                                                l
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                l
                                                ,
                                                z
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                l
                                             
                                          
                                          
                                             
                                                ψ
                                             
                                             
                                                l
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          Ψ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                l
                                             
                                          
                                          
                                             
                                                ψ
                                             
                                             
                                                l
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          
                                             
                                                θ
                                             
                                             
                                                l
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                l
                                             
                                          
                                          
                                             
                                                ψ
                                             
                                             
                                                l
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 e
                              
                              
                                 l
                                 ,
                                 x
                              
                           
                        , 
                           
                              
                                 e
                              
                              
                                 l
                                 ,
                                 y
                              
                           
                        , 
                           
                              
                                 e
                              
                              
                                 l
                                 ,
                                 z
                              
                           
                         are the components of 
                           
                              
                                 e
                              
                              
                                 l
                              
                           
                        . In a word, the normal vector and the contact angle are given by a linear combination of those of the overlapped solid phases.

The advection equation of the level set function is evolved with an actual time step Δt that is used in the multiphase flow computation. On the other hand, the reinitialization equation and the modification equation of the level set function are evolved with a pseudo time step Δτ that is decided under the condition of a numerical stability. If a smaller time step is used, the number of iterations N required for a convergence is increased. We use typically 
                           Δ
                           τ
                           =
                           0.5
                           h
                         and 
                           N
                           =
                           10
                         for both equations in this paper.

For surface tension-dominated flows, an imbalance between the surface tension on the free surface and the pressure gradient across the free surface leads to unphysical flows (spurious flows) around the free surface. Many researchers have ever proposed accurate methods of curvature estimation to fix the problem [53–57]. A common principle in those methods is that a curvature at a cell is estimated at the foot of a perpendicular from the cell to the sharp interface between gas and liquid. Holding the principle, the curvatures in a free surface remain constant, which is crucial for the balance between the surface tension and the pressure gradient. In this paper, the foot of a perpendicular is obtained by the following method, which is similar to and simpler than the method in Ref. [57]. Fig. 6
                         shows a two-dimensional schematic picture of the present way of curvature estimation. Using the level set function and its normal, the position vector of the foot of perpendicular from the cell center to the sharp interface between gas and liquid is expressed as
                           
                              (56)
                              
                                 
                                    
                                       r
                                    
                                    
                                       f
                                    
                                 
                                 =
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 +
                                 Δ
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 r
                              
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                           
                         is the position vector of a cell center and
                           
                              (57)
                              
                                 Δ
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 .
                              
                           
                         If a regular grid is used, the indices of the foot-containing cell is readily obtained as
                           
                              (58)
                              
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    i
                                    −
                                    int
                                    
                                    
                                       {
                                       1
                                       −
                                       sign
                                       (
                                       0.5
                                       ,
                                       Δ
                                       
                                          
                                             r
                                          
                                          
                                             x
                                             ,
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       )
                                       }
                                    
                                    +
                                    int
                                    
                                    
                                       (
                                       
                                          
                                             Δ
                                             
                                                
                                                   r
                                                
                                                
                                                   x
                                                   ,
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                             
                                          
                                          
                                             Δ
                                             x
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          j
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    j
                                    −
                                    int
                                    
                                    
                                       {
                                       1
                                       −
                                       sign
                                       (
                                       0.5
                                       ,
                                       Δ
                                       
                                          
                                             r
                                          
                                          
                                             y
                                             ,
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       )
                                       }
                                    
                                    +
                                    int
                                    
                                    
                                       (
                                       
                                          
                                             Δ
                                             
                                                
                                                   r
                                                
                                                
                                                   y
                                                   ,
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                             
                                          
                                          
                                             Δ
                                             y
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          k
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    k
                                    −
                                    int
                                    
                                    
                                       {
                                       1
                                       −
                                       sign
                                       (
                                       0.5
                                       ,
                                       Δ
                                       
                                          
                                             r
                                          
                                          
                                             z
                                             ,
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       )
                                       }
                                    
                                    +
                                    int
                                    
                                    
                                       (
                                       
                                          
                                             Δ
                                             
                                                
                                                   r
                                                
                                                
                                                   z
                                                   ,
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                             
                                          
                                          
                                             Δ
                                             z
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 i
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 j
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 k
                              
                              
                                 0
                              
                           
                         are indices of the foot-containing cell, 
                           Δ
                           
                              
                                 r
                              
                              
                                 x
                                 ,
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                           
                        , 
                           Δ
                           
                              
                                 r
                              
                              
                                 y
                                 ,
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                           
                        , 
                           Δ
                           
                              
                                 r
                              
                              
                                 z
                                 ,
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                           
                         are the components of 
                           Δ
                           
                              
                                 r
                              
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                           
                        , 
                           int
                           (
                           a
                           )
                         returns integer part of a and 
                           sign
                           (
                           a
                           ,
                           b
                           )
                         returns the absolute value of a times the sign of b. The location of the foot is parameterized in the cell as
                           
                              (59)
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    =
                                    mod
                                    
                                    
                                       (
                                       
                                          
                                             Δ
                                             
                                                
                                                   r
                                                
                                                
                                                   x
                                                   ,
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                             
                                          
                                          
                                             Δ
                                             x
                                          
                                       
                                       ,
                                       1
                                       )
                                    
                                    +
                                    0.5
                                    −
                                    sign
                                    (
                                    0.5
                                    ,
                                    Δ
                                    
                                       
                                          r
                                       
                                       
                                          x
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    )
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          y
                                       
                                    
                                    =
                                    mod
                                    
                                    
                                       (
                                       
                                          
                                             Δ
                                             
                                                
                                                   r
                                                
                                                
                                                   y
                                                   ,
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                             
                                          
                                          
                                             Δ
                                             y
                                          
                                       
                                       ,
                                       1
                                       )
                                    
                                    +
                                    0.5
                                    −
                                    sign
                                    (
                                    0.5
                                    ,
                                    Δ
                                    
                                       
                                          r
                                       
                                       
                                          y
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    )
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          z
                                       
                                    
                                    =
                                    mod
                                    
                                    
                                       (
                                       
                                          
                                             Δ
                                             
                                                
                                                   r
                                                
                                                
                                                   z
                                                   ,
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                             
                                          
                                          
                                             Δ
                                             z
                                          
                                       
                                       ,
                                       1
                                       )
                                    
                                    +
                                    0.5
                                    −
                                    sign
                                    (
                                    0.5
                                    ,
                                    Δ
                                    
                                       
                                          r
                                       
                                       
                                          z
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                         where 
                           0
                           ≤
                           
                              
                                 p
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 y
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 z
                              
                           
                           ≤
                           1
                         and 
                           mod
                           (
                           a
                           ,
                           b
                           )
                         returns the remainder of the division of a by b.

In Ref. [57], the curvature at the foot is interpolated using the curvatures at vertices of the foot-containing cell. In this paper, on the other hand, the curvature at the foot is obtained by differencing the level set functions at 27 virtual grid points around the foot. The level set function at each virtual grid point is interpolated using the level set function at real grid points around the virtual grid point. In a word, differencing the interpolated level set function is substituted for interpolating the curvature obtained by differencing. This virtual grid differencing can lead to more accurate curvature estimation than Ref. [57], because the distribution of the level set function is smoother than the curvature distribution in general. The tri-linear interpolated level set functions at 27 virtual grid points are expressed as
                           
                              (60)
                              
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       I
                                       ,
                                       J
                                       ,
                                       K
                                    
                                 
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       I
                                       ,
                                       
                                          
                                             j
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       J
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       K
                                    
                                 
                                 (
                                 1
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 )
                                 (
                                 1
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 )
                                 (
                                 1
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       z
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       I
                                       +
                                       1
                                       ,
                                       
                                          
                                             j
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       J
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       K
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 1
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 )
                                 (
                                 1
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       z
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       I
                                       ,
                                       
                                          
                                             j
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       J
                                       +
                                       1
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       K
                                    
                                 
                                 (
                                 1
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 )
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 (
                                 1
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       z
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       I
                                       ,
                                       
                                          
                                             j
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       J
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       K
                                       +
                                       1
                                    
                                 
                                 (
                                 1
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 )
                                 (
                                 1
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 )
                                 
                                    
                                       p
                                    
                                    
                                       z
                                    
                                 
                                 +
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       I
                                       +
                                       1
                                       ,
                                       
                                          
                                             j
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       J
                                       +
                                       1
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       K
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 (
                                 1
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       z
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       I
                                       +
                                       1
                                       ,
                                       
                                          
                                             j
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       J
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       K
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 1
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 )
                                 
                                    
                                       p
                                    
                                    
                                       z
                                    
                                 
                                 +
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       I
                                       ,
                                       
                                          
                                             j
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       J
                                       +
                                       1
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       K
                                       +
                                       1
                                    
                                 
                                 (
                                 1
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 )
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       z
                                    
                                 
                                 +
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       I
                                       +
                                       1
                                       ,
                                       
                                          
                                             j
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       J
                                       +
                                       1
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       K
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       z
                                    
                                 
                                 ,
                              
                           
                         where 
                           I
                           =
                           −
                           1
                           ,
                           0
                           ,
                           1
                        , 
                           J
                           =
                           −
                           1
                           ,
                           0
                           ,
                           1
                         and 
                           K
                           =
                           −
                           1
                           ,
                           0
                           ,
                           1
                        . Then the curvature at the foot is calculated using Eq. (27). The derivatives in Eq. (27) are discretized by the standard second-order central differencing as
                           
                              (61)
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          x
                                       
                                    
                                    =
                                    
                                       
                                          −
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                −
                                                1
                                                ,
                                                0
                                                ,
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                1
                                                ,
                                                0
                                                ,
                                                0
                                             
                                          
                                       
                                       
                                          2
                                          Δ
                                          x
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          y
                                       
                                    
                                    =
                                    
                                       
                                          −
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                −
                                                1
                                                ,
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                1
                                                ,
                                                0
                                             
                                          
                                       
                                       
                                          2
                                          Δ
                                          y
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          z
                                       
                                    
                                    =
                                    
                                       
                                          −
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                0
                                                ,
                                                −
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                0
                                                ,
                                                1
                                             
                                          
                                       
                                       
                                          2
                                          Δ
                                          z
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          x
                                          x
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                −
                                                1
                                                ,
                                                0
                                                ,
                                                0
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                1
                                                ,
                                                0
                                                ,
                                                0
                                             
                                          
                                       
                                       
                                          Δ
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          y
                                          y
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                −
                                                1
                                                ,
                                                0
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                1
                                                ,
                                                0
                                             
                                          
                                       
                                       
                                          Δ
                                          
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          z
                                          z
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                0
                                                ,
                                                −
                                                1
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                0
                                                ,
                                                1
                                             
                                          
                                       
                                       
                                          Δ
                                          
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          x
                                          y
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                −
                                                1
                                                ,
                                                −
                                                1
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                1
                                                ,
                                                −
                                                1
                                                ,
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                −
                                                1
                                                ,
                                                1
                                                ,
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                1
                                                ,
                                                1
                                                ,
                                                0
                                             
                                          
                                       
                                       
                                          4
                                          Δ
                                          x
                                          Δ
                                          y
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          x
                                          z
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                −
                                                1
                                                ,
                                                0
                                                ,
                                                −
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                1
                                                ,
                                                0
                                                ,
                                                −
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                −
                                                1
                                                ,
                                                0
                                                ,
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                1
                                                ,
                                                0
                                                ,
                                                1
                                             
                                          
                                       
                                       
                                          4
                                          Δ
                                          x
                                          Δ
                                          z
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          y
                                          z
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                −
                                                1
                                                ,
                                                −
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                1
                                                ,
                                                −
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                −
                                                1
                                                ,
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                1
                                                ,
                                                1
                                             
                                          
                                       
                                       
                                          4
                                          Δ
                                          y
                                          Δ
                                          z
                                       
                                    
                                    .
                                 
                              
                           
                         Finally, the curvature obtained above is used as the cell-centered curvature 
                           
                              
                                 κ
                              
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                           
                        .

The governing equations of multiphase flow are spatially discretized on a staggered grid system. Fig. 7
                         shows a two-dimensional schematic picture of the flow variables on a staggered grid. For the temporally discretization, a time-splitting scheme is adopted to use the IB method. Firstly, a gas–liquid two phase flow without solid phase is obtained by solving Eq. (21) without 
                           
                              
                                 F
                              
                              
                                 p
                              
                           
                         as
                           
                              (62)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             v
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       v
                                    
                                    
                                       ˜
                                    
                                 
                                 ⋅
                                 ∇
                                 
                                    
                                       v
                                    
                                    
                                       ˜
                                    
                                 
                                 −
                                 
                                    1
                                    ρ
                                 
                                 ∇
                                 p
                                 +
                                 
                                    1
                                    ρ
                                 
                                 ∇
                                 ⋅
                                 μ
                                 
                                    {
                                    ∇
                                    
                                       
                                          v
                                       
                                       
                                          ˜
                                       
                                    
                                    +
                                    
                                       
                                          (
                                          ∇
                                          
                                             
                                                v
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    }
                                 
                                 −
                                 
                                    2
                                    
                                       3
                                       ρ
                                    
                                 
                                 ∇
                                 ⋅
                                 
                                    {
                                    μ
                                    (
                                    ∇
                                    ⋅
                                    
                                       
                                          v
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    I
                                    }
                                 
                                 +
                                 
                                    1
                                    ρ
                                 
                                 ∇
                                 ⋅
                                 S
                                 +
                                 
                                    1
                                    ρ
                                 
                                 
                                    
                                       F
                                    
                                    
                                       s
                                    
                                 
                                 +
                                 g
                                 ,
                              
                           
                         where 
                           
                              
                                 v
                              
                              
                                 ˜
                              
                           
                         is the velocity without the solid phase. Secondly, a gas–liquid–solid three phase flow is obtained by modifying the velocity in the solid phase as
                           
                              (63)
                              
                                 
                                    
                                       ∂
                                       v
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 
                                    1
                                    ρ
                                 
                                 
                                    
                                       F
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 Ψ
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             p
                                          
                                       
                                       −
                                       
                                          
                                             v
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       Δ
                                       t
                                    
                                 
                                 .
                              
                           
                         Eq. (62) is solved by the simplified marker and cell (SMAC) method [58], in which the homogeneous second-derivatives in the viscous term are implicitly discretized using the Crank–Nicolson scheme and the other derivatives are explicitly discretized. An implicit discretization of the viscous term is crucial to success of a mesoscale simulation, because a small grid spacing used leads to a stringent stability condition for the viscous term. The predictor step in the SMAC method is expressed as
                           
                              (64)
                              
                                 
                                    (
                                    1
                                    −
                                    
                                       
                                          Δ
                                          t
                                       
                                       
                                          2
                                          ρ
                                       
                                    
                                    ∇
                                    ⋅
                                    μ
                                    ∇
                                    )
                                 
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       n
                                    
                                 
                                 +
                                 Δ
                                 t
                                 
                                    [
                                    −
                                    
                                       1
                                       ρ
                                    
                                    ∇
                                    
                                       
                                          p
                                       
                                       
                                          n
                                       
                                    
                                    −
                                    
                                       
                                          v
                                       
                                       
                                          n
                                       
                                    
                                    ⋅
                                    ∇
                                    
                                       
                                          v
                                       
                                       
                                          n
                                       
                                    
                                    +
                                    
                                       1
                                       
                                          2
                                          ρ
                                       
                                    
                                    ∇
                                    ⋅
                                    μ
                                    ∇
                                    
                                       
                                          v
                                       
                                       
                                          n
                                       
                                    
                                    +
                                    
                                       1
                                       ρ
                                    
                                    ∇
                                    ⋅
                                    μ
                                    
                                       
                                          (
                                          ∇
                                          
                                             
                                                v
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    −
                                    
                                       2
                                       
                                          3
                                          ρ
                                       
                                    
                                    ∇
                                    ⋅
                                    
                                       {
                                       μ
                                       
                                          (
                                          ∇
                                          ⋅
                                          
                                             
                                                v
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                       I
                                       }
                                    
                                    +
                                    g
                                    +
                                    
                                       1
                                       ρ
                                    
                                    ∇
                                    ⋅
                                    S
                                    +
                                    
                                       1
                                       ρ
                                    
                                    
                                       
                                          F
                                       
                                       
                                          s
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    
                                       v
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 ⁎
                              
                           
                         is a predictive value of 
                           
                              
                                 v
                              
                              
                                 ˜
                              
                           
                        . Eq. (64) is temporally discretized using the alternative direction implicit (ADI) scheme [59], in which the tri-diagonal matrix algorithm (TDMA) [59] is employed to solve a system of equations in each direction.

In the right-hand side of Eq. (64), the advection term is discretized using the first-order upstream differencing scheme, and the pressure gradient term and the viscous term are discretized using the second-order central differencing scheme. The divergence of the stochastic stress tensor is discretized as
                           
                              (65)
                              
                                 
                                    
                                       (
                                       
                                          1
                                          ρ
                                       
                                       ∇
                                       ⋅
                                       S
                                       )
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                1
                                                
                                                   
                                                      
                                                         ρ
                                                         ¯
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         x
                                                         x
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         x
                                                         x
                                                         ,
                                                         i
                                                         −
                                                         1
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   Δ
                                                   x
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         y
                                                         x
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         +
                                                         1
                                                         ,
                                                         k
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         y
                                                         x
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   Δ
                                                   y
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         z
                                                         x
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         z
                                                         x
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   Δ
                                                   z
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                1
                                                
                                                   
                                                      
                                                         ρ
                                                         ¯
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         x
                                                         y
                                                         ,
                                                         i
                                                         +
                                                         1
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         x
                                                         y
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   Δ
                                                   x
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         y
                                                         y
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         y
                                                         y
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         −
                                                         1
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   Δ
                                                   y
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         z
                                                         y
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         z
                                                         y
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   Δ
                                                   z
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                1
                                                
                                                   
                                                      
                                                         ρ
                                                         ¯
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         x
                                                         z
                                                         ,
                                                         i
                                                         +
                                                         1
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         x
                                                         z
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   Δ
                                                   x
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         y
                                                         z
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         +
                                                         1
                                                         ,
                                                         k
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         y
                                                         z
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   Δ
                                                   y
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         z
                                                         z
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         z
                                                         z
                                                         ,
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                         −
                                                         1
                                                      
                                                   
                                                
                                                
                                                   Δ
                                                   z
                                                
                                             
                                             )
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    ρ
                                    ¯
                                 
                              
                              
                                 x
                              
                           
                        , 
                           
                              
                                 
                                    ρ
                                    ¯
                                 
                              
                              
                                 y
                              
                           
                         and 
                           
                              
                                 
                                    ρ
                                    ¯
                                 
                              
                              
                                 z
                              
                           
                         are the densities at the cell faces normal to x, y and z direction, respectively. Based on the assumption described in Section 3.1 that a cell face is occupied by the fluid with larger density, the densities at the cell faces are expressed as
                           
                              (66)
                              
                                 
                                    
                                       
                                          
                                             ρ
                                             ¯
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          x
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                         ¯
                                                      
                                                   
                                                   
                                                      x
                                                      ,
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                <
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                         ¯
                                                      
                                                   
                                                   
                                                      x
                                                      ,
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             ρ
                                             ¯
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          y
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      −
                                                      1
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                         ¯
                                                      
                                                   
                                                   
                                                      y
                                                      ,
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                <
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                         ¯
                                                      
                                                   
                                                   
                                                      y
                                                      ,
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             ρ
                                             ¯
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          z
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                         ¯
                                                      
                                                   
                                                   
                                                      z
                                                      ,
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                <
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                         ¯
                                                      
                                                   
                                                   
                                                      z
                                                      ,
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where
                           
                              (67)
                              
                                 
                                    
                                       
                                          
                                             n
                                             ¯
                                          
                                       
                                       
                                          x
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                x
                                                ,
                                                i
                                                −
                                                1
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                n
                                             
                                             
                                                x
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                       2
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             n
                                             ¯
                                          
                                       
                                       
                                          y
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                y
                                                ,
                                                i
                                                ,
                                                j
                                                −
                                                1
                                                ,
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                n
                                             
                                             
                                                y
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                       2
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             n
                                             ¯
                                          
                                       
                                       
                                          z
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                z
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                                −
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                n
                                             
                                             
                                                z
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                       2
                                    
                                    .
                                 
                              
                           
                         According to the statistical properties in Eq. (25), each element of the stochastic stress tensor in Eq. (65) is discretized as
                           
                              (68)
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          x
                                          x
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             8
                                             
                                                
                                                   k
                                                
                                                
                                                   B
                                                
                                             
                                             T
                                             
                                                
                                                   μ
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                             
                                          
                                          
                                             3
                                             Δ
                                             x
                                             Δ
                                             y
                                             Δ
                                             z
                                             Δ
                                             t
                                          
                                       
                                    
                                    
                                    
                                       
                                          χ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          y
                                          y
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          
                                             2
                                             
                                                
                                                   k
                                                
                                                
                                                   B
                                                
                                             
                                             T
                                             
                                                
                                                   μ
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                             
                                          
                                          
                                             3
                                             Δ
                                             x
                                             Δ
                                             y
                                             Δ
                                             z
                                             Δ
                                             t
                                          
                                       
                                    
                                    
                                       
                                          χ
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          
                                             2
                                             
                                                
                                                   k
                                                
                                                
                                                   B
                                                
                                             
                                             T
                                             
                                                
                                                   μ
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                             
                                          
                                          
                                             Δ
                                             x
                                             Δ
                                             y
                                             Δ
                                             z
                                             Δ
                                             t
                                          
                                       
                                    
                                    
                                       
                                          χ
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          z
                                          z
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          
                                             2
                                             
                                                
                                                   k
                                                
                                                
                                                   B
                                                
                                             
                                             T
                                             
                                                
                                                   μ
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                             
                                          
                                          
                                             3
                                             Δ
                                             x
                                             Δ
                                             y
                                             Δ
                                             z
                                             Δ
                                             t
                                          
                                       
                                    
                                    
                                       
                                          χ
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          
                                             2
                                             
                                                
                                                   k
                                                
                                                
                                                   B
                                                
                                             
                                             T
                                             
                                                
                                                   μ
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                             
                                          
                                          
                                             Δ
                                             x
                                             Δ
                                             y
                                             Δ
                                             z
                                             Δ
                                             t
                                          
                                       
                                    
                                    
                                       
                                          χ
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          x
                                          y
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          y
                                          x
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             2
                                             
                                                
                                                   k
                                                
                                                
                                                   B
                                                
                                             
                                             T
                                             
                                                
                                                   
                                                      μ
                                                      ¯
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                                
                                                   x
                                                   y
                                                
                                             
                                          
                                          
                                             Δ
                                             x
                                             Δ
                                             y
                                             Δ
                                             z
                                             Δ
                                             t
                                          
                                       
                                    
                                    
                                       
                                          χ
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          x
                                          z
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          z
                                          x
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             2
                                             
                                                
                                                   k
                                                
                                                
                                                   B
                                                
                                             
                                             T
                                             
                                                
                                                   
                                                      μ
                                                      ¯
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                                
                                                   x
                                                   z
                                                
                                             
                                          
                                          
                                             Δ
                                             x
                                             Δ
                                             y
                                             Δ
                                             z
                                             Δ
                                             t
                                          
                                       
                                    
                                    
                                       
                                          χ
                                       
                                       
                                          4
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          y
                                          z
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          z
                                          y
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             2
                                             
                                                
                                                   k
                                                
                                                
                                                   B
                                                
                                             
                                             T
                                             
                                                
                                                   
                                                      μ
                                                      ¯
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                                
                                                   y
                                                   z
                                                
                                             
                                          
                                          
                                             Δ
                                             x
                                             Δ
                                             y
                                             Δ
                                             z
                                             Δ
                                             t
                                          
                                       
                                    
                                    
                                       
                                          χ
                                       
                                       
                                          5
                                       
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 χ
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 χ
                              
                              
                                 3
                              
                           
                        , 
                           
                              
                                 χ
                              
                              
                                 4
                              
                           
                        , 
                           
                              
                                 χ
                              
                              
                                 5
                              
                           
                         are standard normal random numbers that are mutually independent, and
                           
                              (69)
                              
                                 
                                    
                                       
                                          
                                             μ
                                             ¯
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          x
                                          y
                                       
                                    
                                    =
                                    
                                       1
                                       4
                                    
                                    (
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          −
                                          1
                                          ,
                                          j
                                          −
                                          1
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          ,
                                          j
                                          −
                                          1
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          −
                                          1
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    )
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             μ
                                             ¯
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          x
                                          z
                                       
                                    
                                    =
                                    
                                       1
                                       4
                                    
                                    (
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          −
                                          1
                                          ,
                                          j
                                          ,
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          −
                                          1
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    )
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             μ
                                             ¯
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          y
                                          z
                                       
                                    
                                    =
                                    
                                       1
                                       4
                                    
                                    (
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          ,
                                          j
                                          −
                                          1
                                          ,
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          ,
                                          j
                                          −
                                          1
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                         are the averaged viscosities at the cell edges in xy plane, xz plane and yz plane, respectively. The averaged viscosities are also used to discretize the cross derivatives in the viscous term. In addition, the surface tension term is discretized as
                           
                              (70)
                              
                                 
                                    
                                       (
                                       
                                          1
                                          ρ
                                       
                                       
                                          
                                             F
                                          
                                          
                                             s
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                σ
                                                
                                                   
                                                      
                                                         ρ
                                                         ¯
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         i
                                                         −
                                                         1
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                2
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         i
                                                         −
                                                         1
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   Δ
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                σ
                                                
                                                   
                                                      
                                                         ρ
                                                         ¯
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                         −
                                                         1
                                                         ,
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                2
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                         −
                                                         1
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                
                                                   Δ
                                                   y
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                σ
                                                
                                                   
                                                      
                                                         ρ
                                                         ¯
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                         −
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                
                                                2
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         k
                                                         −
                                                         1
                                                      
                                                   
                                                
                                                
                                                   Δ
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     

After the predictor step, we solve the Poisson equation of the corrective pressure as
                           
                              (71)
                              
                                 ∇
                                 ⋅
                                 
                                    (
                                    
                                       1
                                       ρ
                                    
                                    ∇
                                    
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    1
                                    
                                       Δ
                                       t
                                    
                                 
                                 
                                    {
                                    ∇
                                    ⋅
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          ⁎
                                       
                                    
                                    −
                                    (
                                    1
                                    −
                                    Ψ
                                    )
                                    
                                       
                                          ω
                                       
                                       
                                          ˙
                                       
                                    
                                    
                                       |
                                       ∇
                                       
                                          (
                                          
                                             1
                                             ρ
                                          
                                          )
                                       
                                       |
                                    
                                    }
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 p
                              
                              
                                 ′
                              
                           
                         is the corrective pressure. The left-hand side of Eq. (71) is discretized at a cell center as
                           
                              (72)
                              
                                 
                                    
                                       L
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 −
                                 
                                    (
                                    
                                       
                                          
                                             1
                                             
                                                
                                                   
                                                      ρ
                                                      ¯
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                                
                                                   x
                                                
                                             
                                          
                                          +
                                          
                                             1
                                             
                                                
                                                   
                                                      ρ
                                                      ¯
                                                   
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          Δ
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             1
                                             
                                                
                                                   
                                                      ρ
                                                      ¯
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                                
                                                   y
                                                
                                             
                                          
                                          +
                                          
                                             1
                                             
                                                
                                                   
                                                      ρ
                                                      ¯
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   +
                                                   1
                                                   ,
                                                   k
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                       
                                          Δ
                                          
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             1
                                             
                                                
                                                   
                                                      ρ
                                                      ¯
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                                
                                                   z
                                                
                                             
                                          
                                          +
                                          
                                             1
                                             
                                                
                                                   
                                                      ρ
                                                      ¯
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   +
                                                   1
                                                
                                                
                                                   z
                                                
                                             
                                          
                                       
                                       
                                          Δ
                                          
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 
                                    1
                                    
                                       Δ
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                ρ
                                                ¯
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       −
                                       1
                                       ,
                                       j
                                       ,
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 
                                    1
                                    
                                       Δ
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                ρ
                                                ¯
                                             
                                          
                                          
                                             i
                                             +
                                             1
                                             ,
                                             j
                                             ,
                                             k
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       +
                                       1
                                       ,
                                       j
                                       ,
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 
                                    1
                                    
                                       Δ
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                ρ
                                                ¯
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       j
                                       −
                                       1
                                       ,
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 
                                    1
                                    
                                       Δ
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                ρ
                                                ¯
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             +
                                             1
                                             ,
                                             k
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       j
                                       +
                                       1
                                       ,
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 
                                    1
                                    
                                       Δ
                                       
                                          
                                             z
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                ρ
                                                ¯
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                          
                                             z
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                       −
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 
                                    1
                                    
                                       Δ
                                       
                                          
                                             z
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                ρ
                                                ¯
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             +
                                             1
                                          
                                          
                                             z
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                       +
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 .
                              
                           
                         The right-hand side of Eq. (71) is discretized at a cell center as
                           
                              (73)
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       Δ
                                       t
                                    
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                i
                                                +
                                                1
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             
                                                ⁎
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             
                                                ⁎
                                             
                                          
                                       
                                       
                                          Δ
                                          x
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                +
                                                1
                                                ,
                                                k
                                             
                                             
                                                ⁎
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             
                                                ⁎
                                             
                                          
                                       
                                       
                                          Δ
                                          y
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                                +
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             
                                                ⁎
                                             
                                          
                                       
                                       
                                          Δ
                                          z
                                       
                                    
                                    −
                                    (
                                    1
                                    −
                                    
                                       
                                          Ψ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    )
                                    
                                       
                                          ω
                                       
                                       
                                          ˙
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               ρ
                                                               ¯
                                                            
                                                         
                                                         
                                                            i
                                                            +
                                                            1
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                   
                                                   −
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               ρ
                                                               ¯
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                Δ
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   (
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               ρ
                                                               ¯
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            j
                                                            +
                                                            1
                                                            ,
                                                            k
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                   
                                                   −
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               ρ
                                                               ¯
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                Δ
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   (
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               ρ
                                                               ¯
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                            +
                                                            1
                                                         
                                                         
                                                            z
                                                         
                                                      
                                                   
                                                   −
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               ρ
                                                               ¯
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                         
                                                         
                                                            z
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                Δ
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 ⁎
                              
                           
                        , 
                           
                              
                                 
                                    
                                       v
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 ⁎
                              
                           
                        , 
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 ⁎
                              
                           
                         are the components of 
                           
                              
                                 
                                    
                                       v
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 ⁎
                              
                           
                        . The converged solution of 
                           
                              
                                 L
                              
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                              
                                 p
                              
                           
                           =
                           
                              
                                 R
                              
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                              
                                 p
                              
                           
                         is obtained by a line relaxation method, in which the tri-diagonal matrix algorithm (TDMA) is adopted to solve a system of equations in each line. The convergence criteria is given by
                           
                              (74)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                   
                                                      p
                                                   
                                                
                                                −
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 ≤
                                 
                                    
                                       10
                                    
                                    
                                       −
                                       3
                                    
                                 
                                 .
                              
                           
                         Using the corrective pressure, the pressure and the velocity without the solid phase are obtained in the corrector step as
                           
                              (75)
                              
                                 p
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                 
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (76)
                              
                                 
                                    
                                       v
                                    
                                    
                                       ˜
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       ⁎
                                    
                                 
                                 −
                                 
                                    
                                       Δ
                                       t
                                    
                                    ρ
                                 
                                 ∇
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                                 .
                              
                           
                         Finally, the velocity of the gas–liquid–solid three phase flow is obtained by discretizing Eq. (63) as
                           
                              (77)
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                Ψ
                                             
                                             
                                                i
                                                −
                                                1
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                Ψ
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                       2
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   p
                                                   ,
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   u
                                                
                                                
                                                   p
                                                   ,
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                             
                                          
                                          2
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                Ψ
                                             
                                             
                                                i
                                                ,
                                                j
                                                −
                                                1
                                                ,
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                Ψ
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                       2
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   p
                                                   ,
                                                   i
                                                   ,
                                                   j
                                                   −
                                                   1
                                                   ,
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   p
                                                   ,
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                             
                                          
                                          2
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                Ψ
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                                −
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                Ψ
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                       2
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   p
                                                   ,
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   −
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   w
                                                
                                                
                                                   p
                                                   ,
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                             
                                          
                                          2
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 u
                              
                              
                                 ˜
                              
                           
                        , 
                           
                              
                                 v
                              
                              
                                 ˜
                              
                           
                        , 
                           
                              
                                 w
                              
                              
                                 ˜
                              
                           
                         are the components of 
                           
                              
                                 v
                              
                              
                                 ˜
                              
                           
                         and 
                           
                              
                                 u
                              
                              
                                 p
                              
                           
                        , 
                           
                              
                                 v
                              
                              
                                 p
                              
                           
                        , 
                           
                              
                                 w
                              
                              
                                 p
                              
                           
                         are the components of 
                           
                              
                                 v
                              
                              
                                 p
                              
                           
                        .

For a numerical stability, there are time step constraints for the transport terms in Eq. (62). If a temporally first-order scheme is adopted, the Courant–Friedrichs–Levy (CFL) stability condition for the advection term is expressed as
                           
                              (78)
                              
                                 max
                                 ⁡
                                 
                                    (
                                    
                                       
                                          |
                                          
                                             
                                                
                                                   u
                                                   ¯
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          |
                                       
                                       
                                          Δ
                                          x
                                       
                                    
                                    +
                                    
                                       
                                          |
                                          
                                             
                                                
                                                   v
                                                   ¯
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          |
                                       
                                       
                                          Δ
                                          y
                                       
                                    
                                    +
                                    
                                       
                                          |
                                          
                                             
                                                
                                                   w
                                                   ¯
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          |
                                       
                                       
                                          Δ
                                          z
                                       
                                    
                                    )
                                 
                                 Δ
                                 t
                                 ≤
                                 1
                                 .
                              
                           
                         The stability condition for the viscous term is expressed as [60]
                        
                           
                              (79)
                              
                                 max
                                 ⁡
                                 
                                    (
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             ρ
                                          
                                          
                                             l
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             g
                                          
                                       
                                       
                                          
                                             ρ
                                          
                                          
                                             g
                                          
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       1
                                       
                                          Δ
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       1
                                       
                                          Δ
                                          
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       1
                                       
                                          Δ
                                          
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 Δ
                                 t
                                 ≤
                                 
                                    1
                                    2
                                 
                                 .
                              
                           
                         The stability condition for the surface force term is expressed as [40]
                        
                           
                              (80)
                              
                                 
                                    
                                       
                                          π
                                          σ
                                       
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                l
                                             
                                          
                                          +
                                          
                                             
                                                ρ
                                             
                                             
                                                g
                                             
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       1
                                       
                                          Δ
                                          
                                             
                                                x
                                             
                                             
                                                3
                                                /
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       1
                                       
                                          Δ
                                          
                                             
                                                y
                                             
                                             
                                                3
                                                /
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       1
                                       
                                          Δ
                                          
                                             
                                                z
                                             
                                             
                                                3
                                                /
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 Δ
                                 t
                                 ≤
                                 
                                    1
                                    2
                                 
                                 .
                              
                           
                         The present simulation is hardly restricted by the stability conditions of Eqs. (78) and (79), because the flow speed is much small and the viscous term is treated implicitly. In fact, the implicit treatment of the homogeneous second-derivatives in Eq. (64) allows us to adopt a time step five times more than the time step that is specified in Eq. (79). Consequently, the computational time step is commonly constrained by the stability condition of Eq. (80).

In the present simulation method, the substrate is treated as a still solid phase and put on the bottom boundary of a cuboidal computational domain. Then the bottom boundary is located in the solid phase, in which p is given by a zeroth order extrapolation, ϕ is given by a first-order extrapolation, and 
                           u
                           =
                           v
                           =
                           w
                           =
                           
                              
                                 s
                              
                              
                                 x
                                 z
                              
                           
                           =
                           
                              
                                 s
                              
                              
                                 z
                                 x
                              
                           
                           =
                           
                              
                                 s
                              
                              
                                 y
                                 z
                              
                           
                           =
                           
                              
                                 s
                              
                              
                                 z
                                 y
                              
                           
                           =
                           0
                        . On the top boundary, a flow out boundary condition is imposed, in which ϕ, u, v are given by a first-order extrapolation, w is given by applying the condition of zero divergence, 
                           
                              
                                 s
                              
                              
                                 z
                                 x
                              
                           
                        , 
                           
                              
                                 s
                              
                              
                                 z
                                 y
                              
                           
                         are given by a zeroth order extrapolation, p is fixed to the atmospheric pressure 
                           
                              
                                 p
                              
                              
                                 ∞
                              
                           
                         and 
                           
                              
                                 s
                              
                              
                                 x
                                 x
                              
                           
                           =
                           
                              
                                 s
                              
                              
                                 y
                                 y
                              
                           
                           =
                           
                              
                                 s
                              
                              
                                 z
                                 z
                              
                           
                           =
                           
                              
                                 s
                              
                              
                                 x
                                 y
                              
                           
                           =
                           
                              
                                 s
                              
                              
                                 y
                                 x
                              
                           
                           =
                           0
                        . In addition, a periodic boundary condition is imposed on the side boundaries.

The forces and the torques exerted on a colloidal particle have different characteristic times. The characteristic times of 
                           
                              
                                 F
                              
                              
                                 c
                              
                           
                        , 
                           
                              
                                 F
                              
                              
                                 e
                              
                           
                        , 
                           
                              
                                 F
                              
                              
                                 v
                              
                           
                         in Eq. (34) and 
                           
                              
                                 T
                              
                              
                                 c
                              
                           
                         in Eq. (35) are associated with the motion of molecules. The characteristic times of 
                           
                              
                                 F
                              
                              
                                 h
                              
                           
                         in Eq. (34) and 
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                         in Eq. (35), on the other hand, are associated with the motion of colloidal particles. The former characteristic times are typically smaller than the latter ones. The present simulation method is able to separate the time evolution of particle motion from the time evolution of flow, because both time evolutions are weakly coupled with each other. Therefore, in addition to Δt for evaluating 
                           
                              
                                 F
                              
                              
                                 h
                              
                           
                         and 
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                        , a smaller time step 
                           Δ
                           
                              
                                 t
                              
                              
                                 ′
                              
                           
                         is used to evaluate 
                           
                              
                                 F
                              
                              
                                 c
                              
                           
                        , 
                           
                              
                                 F
                              
                              
                                 e
                              
                           
                        , 
                           
                              
                                 F
                              
                              
                                 v
                              
                           
                        , 
                           
                              
                                 T
                              
                              
                                 c
                              
                           
                        . This dual time stepping, which has been proposed in our previous work [26], saves the computational cost considerably, because the evaluation of 
                           
                              
                                 F
                              
                              
                                 h
                              
                           
                         and 
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                         requires rather expensive computation of the flow. The relation of 
                           Δ
                           
                              
                                 t
                              
                              
                                 ′
                              
                           
                         and Δt is given by
                           
                              (81)
                              
                                 Δ
                                 t
                                 =
                                 λ
                                 Δ
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                              
                           
                         where λ is a positive integer. In a word, the flow and the particle motion are evolved with Δt and 
                           Δ
                           
                              
                                 t
                              
                              
                                 ′
                              
                           
                        , respectively.

Eqs. (34) and (35) are temporally discretized using the first-order Euler explicit scheme as
                           
                              (82)
                              
                                 
                                    
                                       V
                                    
                                    
                                       l
                                    
                                    
                                       m
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       V
                                    
                                    
                                       l
                                    
                                    
                                       m
                                    
                                 
                                 +
                                 
                                    
                                       Δ
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    M
                                 
                                 
                                    (
                                    
                                       
                                          F
                                       
                                       
                                          c
                                          ,
                                          l
                                       
                                       
                                          m
                                       
                                    
                                    +
                                    
                                       
                                          F
                                       
                                       
                                          e
                                          ,
                                          l
                                       
                                       
                                          m
                                       
                                    
                                    +
                                    
                                       
                                          F
                                       
                                       
                                          v
                                          ,
                                          l
                                       
                                       
                                          m
                                       
                                    
                                    +
                                    
                                       
                                          F
                                       
                                       
                                          h
                                          ,
                                          l
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                        
                           
                              (83)
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       l
                                    
                                    
                                       m
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       Ω
                                    
                                    
                                       l
                                    
                                    
                                       m
                                    
                                 
                                 +
                                 
                                    
                                       Δ
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    I
                                 
                                 
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          c
                                          ,
                                          l
                                       
                                       
                                          m
                                       
                                    
                                    +
                                    
                                       
                                          T
                                       
                                       
                                          h
                                          ,
                                          l
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         and Eq. (36) is temporally discretized using the first-order Euler implicit scheme as
                           
                              (84)
                              
                                 
                                    
                                       X
                                    
                                    
                                       l
                                    
                                    
                                       m
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       l
                                    
                                    
                                       m
                                    
                                 
                                 +
                                 Δ
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       V
                                    
                                    
                                       l
                                    
                                    
                                       m
                                       +
                                       1
                                    
                                 
                                 ,
                              
                           
                         where m is index for temporal discretization for the particle motion. At each time step of the flow computation, initializations are performed as 
                           
                              
                                 V
                              
                              
                                 l
                              
                              
                                 m
                                 =
                                 0
                              
                           
                           =
                           
                              
                                 V
                              
                              
                                 l
                              
                              
                                 n
                              
                           
                        , 
                           
                              
                                 Ω
                              
                              
                                 l
                              
                              
                                 m
                                 =
                                 0
                              
                           
                           =
                           
                              
                                 Ω
                              
                              
                                 l
                              
                              
                                 n
                              
                           
                        , 
                           
                              
                                 X
                              
                              
                                 l
                              
                              
                                 m
                                 =
                                 0
                              
                           
                           =
                           
                              
                                 X
                              
                              
                                 l
                              
                              
                                 n
                              
                           
                        . After repeating the time evolution of Eqs. (82), (83) and (84) 
                        λ times, the solution of the particle motion at the next time step is obtained as 
                           
                              
                                 V
                              
                              
                                 l
                              
                              
                                 n
                                 +
                                 1
                              
                           
                           =
                           
                              
                                 V
                              
                              
                                 l
                              
                              
                                 m
                                 =
                                 λ
                              
                           
                        , 
                           
                              
                                 Ω
                              
                              
                                 l
                              
                              
                                 n
                                 +
                                 1
                              
                           
                           =
                           
                              
                                 Ω
                              
                              
                                 l
                              
                              
                                 m
                                 =
                                 λ
                              
                           
                        , 
                           
                              
                                 X
                              
                              
                                 l
                              
                              
                                 n
                                 +
                                 1
                              
                           
                           =
                           
                              
                                 X
                              
                              
                                 l
                              
                              
                                 m
                                 =
                                 λ
                              
                           
                        . Note that 
                           
                              
                                 F
                              
                              
                                 h
                                 ,
                                 l
                              
                              
                                 n
                              
                           
                         and 
                           
                              
                                 T
                              
                              
                                 h
                                 ,
                                 l
                              
                              
                                 n
                              
                           
                         remain constant during the repeat.

The components of 
                           
                              
                                 F
                              
                              
                                 h
                                 ,
                                 l
                              
                           
                         are discretized at cell centers as
                           
                              (85)
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          h
                                          ,
                                          l
                                          ,
                                          x
                                       
                                    
                                    =
                                    −
                                    
                                       ∑
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       {
                                       
                                          
                                             F
                                          
                                          
                                             p
                                             ,
                                             x
                                             ,
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       −
                                       
                                          
                                             Ψ
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             ρ
                                          
                                          
                                             p
                                          
                                       
                                       −
                                       
                                          
                                             ρ
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       )
                                       
                                          
                                             g
                                          
                                          
                                             x
                                          
                                       
                                       }
                                    
                                    Δ
                                    x
                                    Δ
                                    y
                                    Δ
                                    z
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          h
                                          ,
                                          l
                                          ,
                                          y
                                       
                                    
                                    =
                                    −
                                    
                                       ∑
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       {
                                       
                                          
                                             F
                                          
                                          
                                             p
                                             ,
                                             y
                                             ,
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       −
                                       
                                          
                                             Ψ
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             ρ
                                          
                                          
                                             p
                                          
                                       
                                       −
                                       
                                          
                                             ρ
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       )
                                       
                                          
                                             g
                                          
                                          
                                             y
                                          
                                       
                                       }
                                    
                                    Δ
                                    x
                                    Δ
                                    y
                                    Δ
                                    z
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          h
                                          ,
                                          l
                                          ,
                                          z
                                       
                                    
                                    =
                                    −
                                    
                                       ∑
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       {
                                       
                                          
                                             F
                                          
                                          
                                             p
                                             ,
                                             z
                                             ,
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       −
                                       
                                          
                                             Ψ
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             ρ
                                          
                                          
                                             p
                                          
                                       
                                       −
                                       
                                          
                                             ρ
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       )
                                       
                                          
                                             g
                                          
                                          
                                             z
                                          
                                       
                                       }
                                    
                                    Δ
                                    x
                                    Δ
                                    y
                                    Δ
                                    z
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 g
                              
                              
                                 x
                              
                           
                        , 
                           
                              
                                 g
                              
                              
                                 y
                              
                           
                        , 
                           
                              
                                 g
                              
                              
                                 z
                              
                           
                         are the components of 
                           g
                         and 
                           
                              
                                 F
                              
                              
                                 p
                                 ,
                                 x
                              
                           
                        , 
                           
                              
                                 F
                              
                              
                                 p
                                 ,
                                 y
                              
                           
                        , 
                           
                              
                                 F
                              
                              
                                 p
                                 ,
                                 z
                              
                           
                         are the components of 
                           
                              
                                 F
                              
                              
                                 p
                              
                           
                         estimated at cell centers as
                           
                              (86)
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          p
                                          ,
                                          x
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          Ψ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                p
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   u
                                                   ¯
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                       
                                          Δ
                                          t
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          p
                                          ,
                                          y
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          Ψ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                p
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   v
                                                   ¯
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                       
                                          Δ
                                          t
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          p
                                          ,
                                          z
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          Ψ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                p
                                                ,
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   w
                                                   ¯
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                          
                                       
                                       
                                          Δ
                                          t
                                       
                                    
                                    .
                                 
                              
                           
                         The components of 
                           
                              
                                 T
                              
                              
                                 h
                                 ,
                                 l
                              
                           
                         are discretized at cell centers as
                           
                              (87)
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          h
                                          ,
                                          l
                                          ,
                                          x
                                       
                                    
                                    =
                                    −
                                    
                                       ∑
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          
                                             r
                                             ¯
                                          
                                       
                                       
                                          l
                                          ,
                                          y
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          p
                                          ,
                                          z
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          
                                             r
                                             ¯
                                          
                                       
                                       
                                          l
                                          ,
                                          z
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          p
                                          ,
                                          y
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    )
                                    Δ
                                    x
                                    Δ
                                    y
                                    Δ
                                    z
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          h
                                          ,
                                          l
                                          ,
                                          y
                                       
                                    
                                    =
                                    −
                                    
                                       ∑
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          
                                             r
                                             ¯
                                          
                                       
                                       
                                          l
                                          ,
                                          z
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          p
                                          ,
                                          x
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          
                                             r
                                             ¯
                                          
                                       
                                       
                                          l
                                          ,
                                          x
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          p
                                          ,
                                          z
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    )
                                    Δ
                                    x
                                    Δ
                                    y
                                    Δ
                                    z
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          h
                                          ,
                                          l
                                          ,
                                          z
                                       
                                    
                                    =
                                    −
                                    
                                       ∑
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          
                                             r
                                             ¯
                                          
                                       
                                       
                                          l
                                          ,
                                          x
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          p
                                          ,
                                          y
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          
                                             r
                                             ¯
                                          
                                       
                                       
                                          l
                                          ,
                                          y
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          p
                                          ,
                                          x
                                          ,
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    )
                                    Δ
                                    x
                                    Δ
                                    y
                                    Δ
                                    z
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 
                                    r
                                    ¯
                                 
                              
                              
                                 l
                                 ,
                                 x
                              
                           
                        , 
                           
                              
                                 
                                    r
                                    ¯
                                 
                              
                              
                                 l
                                 ,
                                 y
                              
                           
                        , 
                           
                              
                                 
                                    r
                                    ¯
                                 
                              
                              
                                 l
                                 ,
                                 z
                              
                           
                         are the components of 
                           
                              
                                 
                                    r
                                    ¯
                                 
                              
                              
                                 l
                              
                           
                        . Note that the summations in Eqs. (85) and (87) are performed in the l-th particle domain.

We need to measure the distance between particles to evaluate 
                           
                              
                                 F
                              
                              
                                 c
                              
                           
                        , 
                           
                              
                                 F
                              
                              
                                 e
                              
                           
                        , 
                           
                              
                                 F
                              
                              
                                 v
                              
                           
                         and 
                           
                              
                                 T
                              
                              
                                 c
                              
                           
                        . The measurement is performed for not only the particles in the computational domain but also the particles outside the domain, because the periodic condition is imposed on the side boundaries of the computational domain. Fig. 8
                         shows a schematic picture of measuring distance from the particle 
                           P
                           (
                           
                              
                                 x
                              
                              
                                 p
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 p
                              
                           
                           )
                         to the particle 
                           Q
                           (
                           
                              
                                 x
                              
                              
                                 Q
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 Q
                              
                           
                           )
                        . We consider the virtual computational domain centering around P, whose size is equal to the actual computational domain. If Q is in the virtual computational domain, the distance to Q is measured. If Q is, on the other hand, outside the virtual computational domain, the distance to the imaginary particle 
                           
                              
                                 Q
                              
                              
                                 ′
                              
                           
                         is measured. Consequently, the distance from P to Q is expressed as
                           
                              (88)
                              
                                 R
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   x
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   y
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where
                           
                              (89)
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          x
                                       
                                    
                                    =
                                    
                                       
                                          x
                                       
                                       
                                          Q
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          P
                                       
                                    
                                    −
                                    
                                       
                                          L
                                       
                                       
                                          x
                                       
                                    
                                    int
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   Q
                                                
                                             
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   P
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   x
                                                
                                             
                                             /
                                             2
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          y
                                       
                                    
                                    =
                                    
                                       
                                          y
                                       
                                       
                                          Q
                                       
                                    
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          P
                                       
                                    
                                    −
                                    
                                       
                                          L
                                       
                                       
                                          y
                                       
                                    
                                    int
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   Q
                                                
                                             
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   P
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   y
                                                
                                             
                                             /
                                             2
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                         Here 
                           
                              
                                 L
                              
                              
                                 x
                              
                           
                         and 
                           
                              
                                 L
                              
                              
                                 y
                              
                           
                         are the side lengths of the computational domain in x and y direction, respectively.

We illustrate some simulation results to demonstrate the capability of the present simulation method. Firstly, two important components in the present method, such as the way of curvature estimation and the IFS model, are demonstrated in the following subsections. Then simulations of drying colloidal suspension on a substrate are performed. We treat the flow field as follows: 
                        
                           
                              ρ
                           
                           
                              l
                           
                        
                        =
                        
                           
                              10
                           
                           
                              3
                           
                        
                         kg
                        /
                        
                           
                              m
                           
                           
                              3
                           
                        
                     , 
                        
                           
                              ρ
                           
                           
                              g
                           
                        
                        =
                        1
                         kg
                        /
                        
                           
                              m
                           
                           
                              3
                           
                        
                     , 
                        
                           
                              μ
                           
                           
                              l
                           
                        
                        =
                        
                           
                              10
                           
                           
                              −
                              3
                           
                        
                         N
                        
                        s
                        /
                        
                           
                              m
                           
                           
                              3
                           
                        
                     , 
                        
                           
                              μ
                           
                           
                              g
                           
                        
                        =
                        2
                        ×
                        
                           
                              10
                           
                           
                              −
                              5
                           
                        
                         N
                        
                        s
                        /
                        
                           
                              m
                           
                           
                              3
                           
                        
                     , 
                        σ
                        =
                        0.073
                         N
                        /
                        m
                     , 
                        T
                        =
                        300
                         K
                     , 
                        
                           
                              p
                           
                           
                              ∞
                           
                        
                        =
                        
                           
                              10
                           
                           
                              5
                           
                        
                         N
                        /
                        
                           
                              m
                           
                           
                              2
                           
                        
                      and 
                        |
                        g
                        |
                        =
                        9.8
                         m
                        /
                        
                           
                              s
                           
                           
                              2
                           
                        
                     . The spherical particles have the same diameter of 
                        
                           
                              d
                           
                           
                              p
                           
                        
                        =
                        
                           
                              10
                           
                           
                              −
                              6
                           
                        
                         m
                      and the same density of 
                        
                           
                              ρ
                           
                           
                              p
                           
                        
                        =
                        2
                        ×
                        
                           
                              10
                           
                           
                              3
                           
                        
                         kg
                        /
                        
                           
                              m
                           
                           
                              3
                           
                        
                     . The Young's modulus and the Poisson's ratio of the spherical particles and the substrate are 
                        
                           
                              10
                           
                           
                              9
                           
                        
                         N
                        /
                        
                           
                              m
                           
                           
                              2
                           
                        
                      and 0.3, respectively.

A simulation of a still droplet with the diameter of 
                           d
                           =
                           5
                           ×
                           
                              
                                 10
                              
                              
                                 −
                                 4
                              
                           
                            m
                         without drying is performed as a demonstration of the present way of curvature estimation including the virtual grid differencing. Both the stochastic stress term and the gravitational acceleration term in the hydrodynamic equations are neglected to emphasize a spurious flow induced by the simulation. The simulation is performed on two grid resolutions of 
                           d
                           /
                           h
                           =
                           10
                         and 20 to investigate the grid dependency of the way of curvature estimation. The initial condition is 
                           v
                           =
                           0
                         and 
                           p
                           =
                           
                              
                                 p
                              
                              
                                 ∞
                              
                           
                         in a whole computational domain. The simulation time is 
                           t
                           =
                           10
                           
                              
                                 t
                              
                              
                                 d
                              
                           
                        , where 
                           
                              
                                 t
                              
                              
                                 d
                              
                           
                           =
                           0.25
                           π
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                 
                                 /
                                 σ
                              
                           
                         is the theoretical oscillation period of an inviscid droplet [61]. The converged solution has been obtained at 
                           t
                           =
                           10
                           
                              
                                 t
                              
                              
                                 d
                              
                           
                        . Fig. 9
                         shows the estimated curvature field at the cross section of the droplet for 
                           d
                           /
                           h
                           =
                           20
                        . A cell-centered curvature is estimated by the conventional way as well as the present way. When we use the conventional way, the curvature is directly obtained from the surrounding level set functions using Eq. (27). As shown in Fig. 9(a), the curvature field has a concentric distribution in the region of free surface, because the curvature is a function of the local level set function. In other words, the estimated curvature decreases outward in a radial direction. On the other hand, the curvature remains nearly constant in the region of free surface when we use the present way, as shown in Fig. 9(b). This is because all the curvatures in the region of free surface is calculated on the sharp interface between gas and liquid.


                        Fig. 10
                         shows the computed velocity field at the cross section of the droplet at 
                           t
                           =
                           10
                           
                              
                                 t
                              
                              
                                 d
                              
                           
                        . Figs. 10(a) and (b) represent the spurious flow induced by the conventional way of curvature estimation and the present way of curvature estimation, respectively. As shown in Fig. 10(a), the conventional way induces a large spurious flow that is severely affected by the computational grid. Namely, main outward spurious flow emanates from the free surface along the grid lines. As shown in Fig. 10(b), on the other hand, the present way induces a much smaller spurious flow than the conventional way, in which the induced spurious flow is almost independent of the direction of the computational grid. In addition, the spurious flow induced by the conventional way depends strongly on the grid resolution, whereas the spurious flow induced by the present way is insensitive to the grid resolution.


                        Fig. 11
                         shows the computational results of the magnitude of spurious flow and the error of the Laplace pressure as a function of grid resolution. The magnitude of the spurious flow is represented by the dimensionless number 
                           
                              Ca
                           
                           =
                           
                              
                                 μ
                              
                              
                                 l
                              
                           
                           
                              
                                 v
                              
                              
                                 ¯
                              
                           
                           /
                           σ
                        , where 
                           
                              
                                 v
                              
                              
                                 ¯
                              
                           
                         is the root mean square of velocity in the computational domain. The error of the Laplace pressure is represented by the dimensionless value 
                           Δ
                           
                              
                                 p
                              
                              
                                 ′
                              
                           
                           =
                           |
                           Δ
                           p
                           −
                           Δ
                           
                              
                                 p
                              
                              
                                 exact
                              
                           
                           |
                           /
                           Δ
                           
                              
                                 p
                              
                              
                                 exact
                              
                           
                        , where Δp is the computed Laplace pressure and 
                           Δ
                           
                              
                                 p
                              
                              
                                 exact
                              
                           
                           =
                           4
                           σ
                           /
                           d
                         is the exact Laplace pressure. The Laplace pressure is computed using a volume average of the pressure in the droplet. As shown in Fig. 11(a), a mean speed of the spurious flow obtained by the present way is about an order of magnitude less than that obtained by the conventional way. As shown in Fig. 11(b), the error of the Laplace pressure induced by the present way is a fraction of that induced by the conventional way. Furthermore, the present way of curvature estimation is insensitive to the grid resolution and has a good performance even on a coarse grid unlike the conventional way. In other words, the present way is able to estimate accurately the curvature of a smaller droplet compared with the conventional way. It is noted that the additional computational cost of the present way over the conventional way is negligible small.

A simulation of a sphere moving across a free surface without drying is performed as a demonstration of the IFS model. The sphere initially located in the liquid phase is forced to move toward the gas phase at the constant speed of 
                           
                              
                                 v
                              
                              
                                 z
                              
                           
                           =
                           0.05
                            m
                           /
                           s
                        . In other words, the motion equations of the sphere are not solved. The stochastic stress term in the hydrodynamic equations is neglected. The specified contact angle on the sphere is 30 degrees. The simulation is performed on two grid resolutions of 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           5
                         and 10 to investigate the grid dependency of the IFS model. Fig. 12
                        (a) shows the initial snapshot of the sphere and the free surface for 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           10
                        , in which the spherical center z is located at 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                         below the flat free surface. Fig. 12(b) shows the snapshot just before the contact between the top of the sphere and the free surface, in which the free surface remains flat. Fig. 12(c) shows the snapshot just after the contact, in which the virtual free surface in the sphere curves convex downward. By way of the IFS model, the curved virtual free surface exerts a upward hydrodynamic force on the sphere, which means a vertical capillary force. The contact between the sphere and the free surface takes place at less than 
                           z
                           /
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           =
                           −
                           0.5
                        , because the free surface has a finite thickness. As the sphere goes up, the virtual free surface flattens at a certain moment, as shown in Fig. 12(d). The vertical capillary force is not exerted on the sphere at that time. As the sphere goes up further, then the virtual free surface curves convex upward, so that the vertical capillary force is exerted downward on the sphere. Fig. 12(e) shows the snapshot when the contact line coincides with the horizontal great circle of the sphere. Fig. 12(f) shows the snapshot just before a breakup of the free surface, in which a necking of the free surface takes place. Fig. 12(g) shows the snapshot just after the breakup of the free surface, in which a broken virtual free surface remains in the sphere. The broken virtual free surface does not exert the capillary force on the sphere, because it forms a closed surface. As shown in Fig. 12(h), the spherical center reaches finally at 
                           z
                           =
                           1.7
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                        , and the free surface becomes flattened again. It is noted that the free surface intersects with the spherical surface at the specified contact angle in Figs. 12(c), (d), (e) and (f).

We performed a quantitative validation of the IFS model in Ref. [38], in which a computed vertical capillary force exerted on a still sphere protruding a free surface has been agreed well with an analytical formula. Here we illustrate a capillary force exerted on the mobile sphere shown in Fig. 12. Fig. 13
                         shows the dimensionless vertical hydrodynamic forces as a function of the position of the spherical center. Although the hydrodynamic force includes a viscous drag, the viscous drag is negligible small compared with the capillary force in this case. Therefore, the axis of ordinate in the figure represents, in effect, the vertical capillary force exerted on the sphere. The capillary force is naturally exerted when the free surface intersects with the sphere, namely, from the position (c) to (f). From the position (c) to (d), the capillary force is exerted in upward direction. On the other hand, the capillary force is exerted in downward direction from the position (d) to (f). This reverse of the capillary force is due to the shape change of the virtual free surface in the sphere, as described in Fig. 12. When the contact line coincides with the horizontal great circle of the sphere at the position (e), the vertical capillary force exerted on a still sphere with the contact angle of 30 degrees is analytically obtained as 
                           
                              
                                 f
                              
                              
                                 z
                              
                           
                           =
                           0.5
                           
                              3
                           
                           π
                           σ
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                        . The computational result for the mobile sphere agrees quite well with the analytical solution for a still sphere. Since the magnitude of the downward force is larger than that of the upward force and the distance for which the downward force acts are larger than that for which the upward force acts, a work is required to pull up the sphere from the liquid phase to the gas phase. This corresponds to that the sphere is hydrophilic. The vertical capillary force in Fig. 13 oscillates with higher frequency than the motion of the sphere. This may be due to a discretization error in computing the surface tension exerted on the virtual free surface. Due to a lack of grid resolution, the amplitude of the oscillation for 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           5
                         is larger than that for 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           10
                         and the breakup of the free surface for 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           5
                         gets behind that for 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           10
                        . Nevertheless, the computed vertical capillary force agrees well with the analytical solution even for 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           5
                        . It can be said that the IFS model enables us to estimate accurately the vertical capillary force exerted on a sphere even for the grid resolution of 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           5
                        .


                        Fig. 14
                         shows the volumetric error of liquid phase as a function of the position of the spherical center. The volume of liquid slightly increases during a period in which the sphere moves across the free surface. This may be due to a discretization error in computing the area of free surface by Eq. (13) and the volume of liquid by Eq. (15). On the other hand, the volume of liquid is completely conserved if the free surface moves without protrusion of the sphere. In addition, the volumetric error of liquid phase is insensitive to the grid resolution, as shown in Fig. 14. Although the volumetric error of liquid phase should be fixed for more precise simulations, the present error can be within an acceptable level.

A simulation of two spheres moving along a free surface with drying is performed as a demonstration of the IFS model. The spheres are initially immersed in a liquid film on a substrate. Then the liquid film dries with 
                           
                              
                                 ω
                              
                              
                                 ˙
                              
                           
                           =
                           10
                            kg
                           /
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           
                           s
                        , so that the spheres protrude from the free surface. The vaporization mass flow rate may be rather larger than that in an actual system. A large mass flow rate leads to a large velocity jump across the free surface when the density ratio between gas phase and liquid phase is high. In fact, the velocity jump is up to about 10 m/s in the present simulation. Such a large velocity jump has possible numerical instabilities. We have adopted this mass flow rate to illustrate the robustness of the present method. Naturally, the present method is applicable to a phase change flow with a smaller mass flow rate.

In the simulation, the spheres have two degrees of freedom of motion, such as translational motion without rotation in the cross sectional plane of the spheres. To emphasize the capillary force obtained by the IFS model, the stochastic stress term in the hydrodynamic equations is neglected. We also ignore the electrostatic force, the van der Waals force and the tangential contact force that are exerted on the spheres. In a word, each sphere moves under the hydrodynamic force and the normal contact force that are exerted by another sphere and the substrate. The specified contact angle on the sphere and that on the substrate are 30 degrees and 0 degrees, respectively. The simulation is performed on three grid resolutions of 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           5
                           ,
                           
                           10
                            and 
                           15
                         to investigate the grid dependency of the IFS model.


                        Fig. 15
                        (a) shows the initial snapshot of the spheres and the free surface for 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           10
                        , in which the spheres are attached on the substrate. As the free surface goes down due to the drying, the free surface is in contact with the top of the spheres, in which the virtual free surface in the spheres curves convex downward, as shown in Fig. 15(b). The curved virtual free surface exerts upward capillary forces on the spheres, so that the spheres are floated from the substrate, as shown in Fig. 15(c). During the flotation of the spheres, the virtual free surface is almost flat and capillary forces do not act on the spheres. In fact, the vertical capillary force exerted on a floating body on a free surface is balanced with the gravitational force exerted on the body. Therefore, the “flotation capillary force” exerted on a colloidal particle whose diameter is less than 10 μm is negligible small [2]. As the free surface further goes down, the spheres are re-attached on the substrate, as shown in Fig. 15(d). From this point forward, menisci are formed on both sides of the spheres. The menisci become asymmetric on both sides of each sphere, because the menisci between the spheres are overlapped each other. The asymmetric menisci lead to an imbalance of surface tensions exerted on the contact lines. As a result, an attractive force is exerted on the spheres and the spheres approach each other, as shown in Fig. 15(e). The attractive force exerted between the spheres is called “immersion capillary force” [2]. The immersion capillary force is effective even for single nano-sized particles unlike the flotation capillary force, because the immersion capillary force does not need to balance with the gravitational force. Then the spheres are in contact with each other, as shown in Fig. 15(f). From this point forward, the drying of liquid phase takes place mainly outside the aggregated spheres. Fig. 15(g) shows the snapshot just before the free surface is in contact with the substrate. In other words, dewetting starts from this point. Eventually, the volume of liquid phase in the computational domain approaches zero, as shown in Fig. 15(h).


                        Fig. 16
                         shows the positions of the closest points of two spheres as a function of the volume of liquid phase. The distance between the closest points is 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                         at first, as shown in Fig. 16. For 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           15
                        , two spheres hardly move in x direction during the flotation of the spheres from the substrate. After the reattachment of the spheres on the substrate, the distance between the closest points rapidly decreases because an attractive immersion capillary force is exerted on the spheres. Eventually, two spheres are in contact with each other at the midpoint between the initial positions. For 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           10
                        , the distance between the closest points slightly increases during the flotation of the spheres, although the motion of the spheres is roughly the same as that for 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           15
                        . The increase of the distance between the closest points is more significant for 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           5
                        . Due to the significant increase of the distance during the flotation of the spheres, the contact of two spheres gets considerably behind those for 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           15
                         and 10. It can be said that the grid resolution of 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           5
                         is insufficient to simulate two spheres moving along the free surface.


                        Fig. 17
                         shows the lateral hydrodynamic force exerted on the first sphere as a function of the volume of liquid phase. The lateral hydrodynamic force is close to zero when the spheres are in motion, because an immersion capillary force balances with a viscous drag force. The lateral hydrodynamic force increases after the spheres are in contact with each other, because the viscous drag becomes zero. Furthermore, the lateral hydrodynamic force increases, because the immersion capillary force increases with increasing asymmetricity of the menisci on both sides of each sphere. An approximate analytical form of the lateral immersion capillary force exerted on two identical spheres is given as 
                           
                              
                                 f
                              
                              
                                 x
                              
                           
                           =
                           2
                           π
                           σ
                           
                              
                                 r
                              
                              
                                 c
                              
                              
                                 2
                              
                           
                           
                              
                                 sin
                              
                              
                                 2
                              
                           
                           ⁡
                           β
                           /
                           L
                        , where 
                           
                              
                                 r
                              
                              
                                 c
                              
                           
                         is the radius of the contact circle on the spheres, β is the slope angle and L is the distance between the spherical centers [2]. Note that β means the angle between a horizontal line and the menisci outside the spheres. Under the present periodic boundary condition, the approximate analytical form is modified as 
                           
                              
                                 f
                              
                              
                                 x
                              
                           
                           =
                           2
                           π
                           σ
                           
                              
                                 r
                              
                              
                                 c
                              
                              
                                 2
                              
                           
                           
                              
                                 sin
                              
                              
                                 2
                              
                           
                           ⁡
                           β
                           {
                           1
                           /
                           L
                           −
                           1
                           /
                           (
                           
                              
                                 L
                              
                              
                                 x
                              
                           
                           −
                           L
                           )
                           }
                        , where 
                           
                              
                                 L
                              
                              
                                 x
                              
                           
                         is the length of the computational domain in x direction. The approximate analytical solution of the lateral immersion capillary force is shown in Fig. 17, where 
                           
                              
                                 r
                              
                              
                                 c
                              
                           
                         and β are read from Fig. 15(g). As shown in Fig. 17, the computational result for 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           15
                         agrees quite well with the approximate analytical solution. On the other hand, the computational results are underestimated for 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           10
                         and 5. Therefore, it is preferable to use the grid resolution of 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           15
                         to estimate precisely the lateral immersion capillary force when two spheres are in contact. It is noted that the IFS model using the grid resolution of 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           10
                         enables us to estimate accurately the lateral immersion capillary force when two spheres have a distance from each other [38].

Simulations of drying colloidal suspension on a substrate are performed as a demonstration of the present method. We assume a thin liquid film on a substrate containing identical 130 spherical particles that dries with 
                           
                              
                                 ω
                              
                              
                                 ˙
                              
                           
                           =
                           10
                            kg
                           /
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           
                           s
                        . The size of the substrate is 
                           15
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           ×
                           15
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                        , so that the coverage ratio to the close-packed particles is 0.5. The particles have six degrees of freedom of motion. The particles are subject to all the forces modeled in Section 2 except the electrostatic force, such as the stochastic force, the tangential contact force and the van der Waals force of particle-to-particle and particle-to-substrate. The Hamaker constant of the particles and the substrate used to estimate the van der Waals force is 
                           
                              
                                 10
                              
                              
                                 −
                                 20
                              
                           
                            J
                        . The frictional coefficient of particle-to-particle and particle-to-substrate is 0.1. Both the hydrophilic particles with the contact angle of 
                           θ
                           =
                           30
                           °
                         and the hydrophobic particles with the contact angle of 
                           θ
                           =
                           120
                           °
                         are simulated. The contact angle on the substrate is 0 degrees. The grid resolution used is 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           /
                           h
                           =
                           10
                        . It is noted that the CPU time for these simulations is about one week on a personal computer with two CPUs.


                        Fig. 18
                         shows snapshots of the hydrophilic particles and the free surface during drying. The initial height of the free surface is 
                           1.2
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                        , in which all particles are attached on the substrate, as shown in Fig. 18(a). As the drying starts, some particles are floated from the substrate due to the Brownian motion of the particles, as shown in Fig. 18(b). Then the floating particles are in contact with the free surface, as shown in Fig. 18(c). As the free surface goes down, the floating particles are re-attached on the substrate, as shown in 18(d). From this point forward, menisci are formed around the particles. The menisci around each particle become asymmetric, because the inter-particle distances are asymmetric. As a result, net immersion capillary forces are exerted between the neighboring particles, so that the particles aggregate one another. As shown in 18(e), the aggregation of the particles produces some holes where particles do not exist. Since the holes increase the asymmetricity of menisci, the holes are enlarged with time. Then dewetting takes place on the substrate, as shown in Fig. 18(f). It can be called “particle-induced dewetting”. As the holes are enlarged further, all the particles on the substrate aggregate one another, as shown in Fig. 18(g). Eventually, the volume of liquid phase approaches zero and the structure of particles are fixed on the substrate, as shown in Fig. 18(h).


                        Fig. 19
                         shows snapshots of the hydrophobic particles and the free surface during drying. The initial condition shown in Fig. 19(a) is the same as Fig. 18(a). As the drying starts, some particles are floated from the substrate due to the Brownian motion of the particles. The particles are subject to the upward vertical capillary force and protrude from the free surface, as shown in Fig. 19(b). The particles float on the free surface at the equilibrium position that depends on the contact angle. As shown in Fig. 19(c), the floating particles readily aggregate one another due to the van der Waals force, because the floating particles are free from the frictional drag from the substrate. As the aggregation proceeds, the particles at an inner region of the aggregate are re-attached on the substrate due to the van der Waals force exerted between the particles and the substrate, as shown in Fig. 19(d). This is because the particles at an inner region of the aggregate are free from the vertical capillary force. Then the number of re-attached particles increases with time, as shown in Fig. 19(e). When many particles in the aggregate are re-attached on the substrate, the free surface becomes convex upward around the aggregate. The convex free surface exerts immersion capillary forces between the aggregate and the floating particles. As a result, the remaining floating particles are attached to the aggregate, as shown in Fig. 19(f). As the free surface goes down further, dewetting takes place on the substrate, as shown in Fig. 19(g). Eventually, the volume of liquid phase approaches zero and the structure of particles are fixed on the substrate, as shown in Fig. 19(h).

The structure of particles obtained by the above simulations are quantitatively evaluated by nondimensional boundary area (NBA) proposed by the authors. The NBA represents the ratio of boundary area of aggregated particles to the summation of boundary area of each particle. A two-dimensional schematic picture of boundary area of aggregated particles is shown in Fig. 20
                        . In the case of spherical particles with the same diameter, the boundary area can be approximated using the coordination number of each particle. Then NBA is expressed as
                           
                              (90)
                              
                                 
                                    NBA
                                 
                                 =
                                 
                                    1
                                    
                                       ξ
                                       N
                                    
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       0
                                    
                                    ξ
                                 
                                 
                                    {
                                    (
                                    ξ
                                    −
                                    k
                                    )
                                    n
                                    (
                                    k
                                    )
                                    }
                                 
                                 ,
                              
                           
                         where ξ is the maximum coordination number, N is the total number of particles, 
                           n
                           (
                           k
                           )
                         is the number of particles whose coordination number is k. Note that 
                           ξ
                           =
                           6
                         in two dimensions and 
                           ξ
                           =
                           12
                         in three dimensions. The NBA becomes 1 when all particles are completely dispersed. The NBA becomes 0 when all particles are hexagonally close packed. Namely, the NBA decreases as aggregation of the particles evolves.


                        Fig. 21
                         shows NBA as a function of dimensionless time. Since a monolayer structure of particles is investigated here, NBA in two dimensions is illustrated in the figure. For hydrophilic particles, the aggregation of the particles takes place in two steps. At the first step, a slight aggregation of the floating particles takes place from time 18(b) to time 18(d). The driving force of the aggregation at the first step is the van der Waals force. At the second step, a significant aggregation of the particles attached on the substrate takes place from time 18(e) to time 18(g). The driving force of the aggregation at the second step is the immersion capillary force. The major part of the aggregation takes place after the dewetting at time 18(f). For hydrophobic particles, on the other hand, the aggregation of the particles continuously takes place just after the drying starts. The aggregation has been almost finished until all particles are re-attached on the substrate at time 19(f). In other words, the aggregation takes place before the dewetting at time 19(g). Although the hydrophobic particles aggregate earlier than the hydrophilic particles, the hydrophilic particles aggregate more significantly than the hydrophobic particles when the drying is completed. This is because the hydrophilic particles are subject to the strong immersion capillary force in the final stage of the drying.

@&#CONCLUSION@&#

In this paper, we have presented a new direct simulation method for a drying colloidal suspension on a substrate. A key issue of the present method is the immersed free surface (IFS) model to estimate accurately and efficiently the capillary forces exerted on the particles, which has been developed by the authors. Using the IFS model along with the immersed boundary (IB) method and the level set (LS) method, we have accomplished a three-way coupling of the fluid flow, the free surface motion and the particle motion. In addition, we have developed a way of curvature estimation using virtual grid differencing to calculate the surface tension accurately.

Some simulations have been performed to demonstrate the present method. In the simulation of a still droplet, we have shown that the present way of curvature estimation is superior to the conventional way of curvature estimation in terms of accuracy. Compared to the conventional way, the present way has induced a small amount of spurious flows that may cause a critical error with simulations of free surface flow. It has been also shown that the present way of curvature estimation is insensitive to the grid resolution and has a good performance even in a coarse grid. In the simulation of a sphere moving across a free surface and the simulation of two spheres moving along a free surface, we have shown that the IFS model reproduces the deformation of menisci and the capillary force exerted on the spheres. In addition to a quantitative validation for still spheres in our previous work [38], the present study has given a quantitative validation for mobile spheres including the investigation on the grid dependency of the model. As a result, it has been shown that the estimation of the lateral capillary force exerted on two spheres requires a higher grid resolution than the estimation of the vertical capillary force exerted on a sphere. Furthermore, simulations of drying colloidal suspension containing 130 spherical particles have been performed to demonstrate the applicability of the present method to actual systems. As a result, we have shown that the mechanism of structure formation of the hydrophobic particles is much different from that of the hydrophilic particles. The hydrophilic particles have aggregated on the substrate under the influence of dewetting of the liquid film. On the other hand, the hydrophobic particles have aggregated on the substrate before dewetting. The above mechanism of the structure formation has been clarified by use of the present simulation method that has the capability of calculating the capillary force exerted on mobile particles. The capability of the present method can be helpful to clarify the formation mechanism of a variety of monolayer structures of colloidal particles during drying, such as crystal structure, amorphous structure and networked structure.

In addition to the capillary force, the present method models the stochastic hydrodynamic force, the frictional force and the van der Waals force. These forces can have an substantial influence on the microscopic structure of the particles after drying of the liquid, because these forces control the rearrangement of the particles that are in contact one another. For example, a smaller frictional force will reduce point defects in the aggregates of the particles, so that the NBA of the final structure of the particles will be decreased. Further investigations are required to clarify the influence of these forces on the structure formation of the particles during drying. A possible improvement in the present method is an introduction of the transport equations of energy and vapor to estimate a variable vaporization mass flow rate that has been a constant value in this paper. The improvement enables us to solve accurately the motion of a highly deformed free surface, because the vaporization mass flow rate at a highly deformed free surface can be different from that at a flat free surface. In the near future, we will apply our simulation method to the structure formation containing a highly deformed free surface, such as cracking and buckling of a particulate film during drying.

@&#ACKNOWLEDGEMENT@&#

This work was partially supported by JSPS KAKENHI Grant Number 23560903.

@&#REFERENCES@&#

