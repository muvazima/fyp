@&#MAIN-TITLE@&#A method for the evaluation of projective geometric consistency in weakly calibrated stereo with application to point matching

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a method for the indexing of point matches based on cross ratios.


                        
                        
                           
                           Matches are characterised by the distribution of a scalar measure derived from multiple point relations.


                        
                        
                           
                           Our consistency measure is processed statistically using random sampling.


                        
                        
                           
                           We propose applications both in weekly calibrated and uncalibrated scenarios.


                        
                        
                           
                           Our method exhibits low false positive rates without the use of thresholds.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Correspondence problem

Wide-baseline stereo

Epipolar geometry

Statistical estimation

Random sampling

@&#ABSTRACT@&#


               
               
                  We present a novel method that evaluates the geometric consistency of putative point matches in weakly calibrated settings, i.e. when the epipolar geometry but not the camera calibration is known, using only the point coordinates as information. The main idea behind our approach is the fact that each point correspondence in our data belongs to one of two classes (inliers/outlier). The classification of each point match relies on the histogram of a quantity representing the difference between cross ratios derived from a construction involving 6-tuples of point matches. Neither constraints nor scenario dependent parameters/thresholds are needed. Even for few candidate point matches the ensemble of 6-tuples containing each of them turns to provide statistically reliable histograms that prove to discriminate between inliers and outliers. In fact, in most cases a random sampling among this population is sufficient. Nevertheless, the accuracy of the method is positively correlated to its sampling density leading to an accuracy versus resulting computational complexity trade-off. Theoretical analysis and experiments are given that show the consistent performance of the proposed classification method when applied in inlier/outlier discrimination. The achieved accuracy is favourably evaluated against established methods that employ geometric only information, i.e. those relying on the Sampson, the algebraic and the symmetric epipolar distances. Finally, we also present an application of our scheme in uncalibrated stereo inside a RANSAC framework and compare it to the same as above methods.
               
            

@&#INTRODUCTION@&#

One of the first steps in most wide baseline computer vision algorithms, arising in tasks such as feature-based stereo 3D reconstruction, image registration, and camera self-calibration, is the acquisition of correspondences between image features extracted from different views of the same static scene. In traditional stereo or structure from motion the rigid motion between the cameras may be assumed to be small, which simplifies the feature matching or tracking operation. We are interested instead in wide-baseline settings where two images of the same scene may be taken from very different points of view, possibly by two different types of cameras, and without knowledge of the intrinsic camera parameters. Under these assumptions, the image points undergo a non-linear projective transformation which necessitates their evaluation inside a projective mathematical framework. Although much research has been directed at reliable matching, there are many difficulties to overcome for practical use; the difficulties arise at the lowest level with feature point detection and description, and at the highest level with reducing ambiguity among point matches. Our focus in this paper will be in the latter, namely how to express geometric validity of feature points given only their image coordinates.

Researchers have generally addressed point matching as a necessary step in larger real world problems and, consequently, there exist a number of algorithms which are adequate for solving specific variations of the problem. Thus, given some information about the structure of the scene or the camera pose, one can limit the class of transformations that each region can undergo between a set of images, e.g. scaling, rotational and affine transformations which in turn simplify the matching procedure [1–3]. In wide-baseline scenarios with no scene knowledge these assumptions do not apply, so the initial approaches in the point matching pipeline use the basic idea of detecting local feature points together with local neighbourhood regions that are covariant with the underlying viewpoint change [4–8]. Feature matching, as a pattern recognition task, is quite a mature field and many algorithms that were developed in different contexts can be applied in the wide baseline scenario for detecting and matching local features. However, any local feature matching strategy that does not take into account the allowed spatial relationships arising from the subsumed projection model of the cameras is bound to produce spurious matches. Local feature matching is thus usually performed as a first processing step to obtain some initial matches that are subsequently refined using geometric information. Relevant algorithms can be classified into stratified reconstruction methods [9] and direct reconstruction methods [10] and projective reconstruction is a necessary first step in all these approaches. Inside this projective mathematical framework current state of the art algorithms make a preliminary detection of spurious matches/outliers, before attempting to upgrade or refine their estimates about the scene and the cameras [11–13]. One issue in any stratified algorithm is that while in each successive step, stronger and more physically meaningful constraints about the allowed point matches become available, their accuracy is very adversely affected by leftover outliers from previous stages. Thus the most efficient algorithm pipelines employ robust frameworks like RANSAC in the first stages and accurate non-robust methods like Levenberg–Marquard in the later ones, using the additional mathematical constraints that have arisen. However, the inherent difficulties of mathematical calculations in projective space often necessitate the tuning of thresholding parameters for the comparison of geometric features and derived quantities. This tuning is either done manually for a class of scenes, or performed as a pre-processing computational step [14]. Finally, as shown in [15,16,10], the addition of Gaussian noise in the points used to calculate the fundamental matrix leads to an elliptical error distribution of the epipoles. This can be in turn used to compute the envelope of the epipolar lines, which is proven to be a hyperbola. Although, some of the methods proposed compute the covariance of the fundamental matrix and subsequently the distribution of the epipoles without prior information [15], it is also stated that an accurate calculation requires the knowledge of the error distribution of image points.

We propose a novel method to estimate a strong form of geometric validity in a projective setting given subsets of point-correspondences. Two main ideas are behind our approach. The first one is to take advantage of multiple geometric point relations to assess the conformance to the epipolar geometry of each putative match, in contrast to quantities like the epipolar distances that are derived by a single point-pair. Secondly, the large number of geometric relations for each match allows us to process them in a statistical framework, instead of relying on a single scalar value for each one. The statistical processing in turn is handled in such a way as to lower the computational complexity by sampling and to avoid the direct use of thresholds in the classification. More specifically, our method employs a new metric-like quantity based on the difference of the apparent cross-ratios as seen from each image and defined geometrically by 6-tuples of point-correspondences and the two epipoles. Since 
                        
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                        
                      is a metric-less space [9], the difference of cross-ratios or any function thereof cannot claim to exhibit true metric characteristics. We instead employ it in a statistical framework to characterise geometrically consistent and inconsistent point matches. Each point pair correspondence aggregates multiple estimates about their projective geometric consistency in relation to others, which are in turn used to approximate the empirical distribution function (EDF) of our confidence metric. We show experimentally that the distribution of our proposed quantity is sufficiently distinct between inliers and outliers as to enable their identification through simple clustering without any arbitrary thresholds. Naturally, the indirect assumption of an error distribution in the vector space of the EDFs and a threshold is implied by the clustering algorithm. However, as shown by experimental and theoretical analysis, in that resulting space the inliers and outliers can be indexed by a simple clustering algorithm that assumes linearly separable data. Finally we show that the performance of the algorithm improves with increasing sample ratio, yet attains good levels even for comparatively small sample sizes, especially regarding false positive matches classification.

@&#OVERVIEW@&#

The rest of the paper is structured as follows. In Section 2 we describe our problem statement and mention relevant methods, along with an overview of our approach. In Section 3 we introduce our geometric validity indicator function and analyse its statistics. The indexing method that operates on the indicator function is described in Section 4. An application of the complete method for uncalibrated images inside a RANSAC framework follows in Section 5. In Section 6, we present both synthetic and real experimental results. The experiments cover the verification of the statistics modeled in Section 3, as well as the comparison of our algorithm to relevant methods in point-matching applications and in a RANSAC framework. Finally, conclusions and directions for future work are given in Section 7.

The need to evaluate geometric consistency arises directly or indirectly in most algorithms of computer vision, both in weakly calibrated and uncalibrated scenarios. Weakly calibrated camera scenarios occur when we have an approximate or even exact estimation of the epipolar geometry, either through prior knowledge of the configuration or through a few strong matches that enable us to estimate the fundamental matrix. Somewhere in the chain of calculations or at the end for judging the computed results, some error function is usually minimised according to a set of constraints. The two general methodologies for that purpose evaluate either the similarity of appearance in two regions subject to a class of transformations (local descriptors) or spatial/geometric constraints between point sets (global descriptors) and in some cases both. We refer to [17] for a comparison of local descriptors. Our focus is on the pure geometric problem, meaning that we use only the image coordinates as input on which to define geometric constraints and ignore any texture specific information.

Cameras record the projections of real objects in a Euclidean space, so when the mathematical constraints used to process the data correspond to some physically invariant quantity, the results are more likely to be close to the truth in a way that is physically meaningful. For instance, a 3D reconstruction from calibrated cameras concerns mathematically Euclidean spaces, in which least squares minimisations can be viewed as minimisation of distances. A noisy 3D reconstructed model that is computed by means of minimising some sort of distance (ray lines, reprojected points, etc.) in a Euclidean space is in most cases recognisable by humans, because the error quantities have physical equivalents. This is not the case in uncalibrated scenarios, which involve operations inside projective spaces. Due to the absense of a projective metric there can be no algebraic method that produces physically optimal results. As a result, geometric consistency is expressed by a handful of algebraic quantities which are processed differently by each of the many and various computer vision algorithms.

Before describing the methods which employ relevant concepts to our own, we will recall the basic notions of epipolar geometry and introduce the semantics that we will subsequently use. Let the images 
                           
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    I
                                 
                                 
                                    2
                                 
                              
                           
                         be obtained by two cameras with projection matrices 
                           
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                           
                        , having distinct optical centers. If 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                           
                         are the projections of the same 3D point X on 
                           
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    I
                                 
                                 
                                    2
                                 
                              
                           
                         expressed in homogeneous coordinates, then the epipolar constraint holds:
                           
                              (1)
                              
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       Fx
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              
                           
                        where F is the 
                           
                              3
                              ×
                              3
                           
                         fundamental matrix corresponding to the two images. The epipoles 
                           
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                           
                         in 
                           
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    e
                                 
                                 
                                    2
                                 
                              
                           
                         in 
                           
                              
                                 
                                    I
                                 
                                 
                                    2
                                 
                              
                           
                         are the images of the camera centres 
                           
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                           
                         respectively. The product 
                           
                              
                                 
                                    Fx
                                 
                                 
                                    1
                                 
                              
                           
                         defines an epipolar line 
                           
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                           
                         on image 
                           
                              
                                 
                                    I
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    F
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                           
                         an epipolar line 
                           
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                           
                         on 
                           
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                           
                        . Thus, constraint (1) states that 
                           
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                           
                         should lie on the epipolar line 
                           
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                           
                         and accordingly 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                           
                         should lie on the epipolar line 
                           
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                           
                        .

In practical scenarios the image points and the fundamental matrix are noisy and thus the inner products of Eq. (1) are not exactly equal to zero. The squared error of this expression, known as algebraic distance and originating in the conic-fitting work of Bookstein, is the simplest way to assess the compliance of a pair of matches to the epipolar geometry and one of the first uses in that field was in the well known 8-point algorithm [18,19]. However it lacks any physical meaning along with the fact that it can easily produce spurious matches, since any point 
                           
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                           
                         on the epipolar line 
                           
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                           
                         satisfies it.

A more physically meaningful quantity should be something measured in the image plane. One such quantity is the distance from a point 
                           
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                           
                         to the epipolar line corresponding to 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    Fx
                                 
                                 
                                    1
                                 
                              
                           
                        , which is given by:
                           
                              (2)
                              
                                 d
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         Fx
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   F
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             (
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                           
                         are the first and second rows of 
                           
                              F
                           
                         respectively.

However, in this criterion the two images do not play a symmetric role, because Eq. (2) determines only the epipolar lines in the second image. By exchanging the role of the two images, the fundamental matrix is changed to its transpose, thus to avoid the inconsistency of the epipolar geometry between the two images, the symmetric epipolar distance is defined as:
                           
                              (3)
                              
                                 d
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 d
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         Fx
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   F
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             (
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        which operates simultaneously in both images.

Another quantity that expresses the compliance of matches to the epipolar geometry in a geometrically meaningful way is the reprojection error
                           
                              (4)
                              
                                 d
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 d
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                     

This is defined as the distance of the measured correspondences 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                           
                         to 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                           
                        , which are the estimated “true” correspondences that satisfy 
                           
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                    T
                                 
                              
                              
                                 
                                    Fx
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              =
                              0
                           
                         exactly. Clearly, this is dependent on the way of estimation of 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                           
                        . An easier to calculate quantity is the first order approximation of the reprojection error, known as the Sampson distance:
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         Fx
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   F
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             (
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The above-mentioned equations have been used as cost functions and minimisation quantities in numerous algorithms that operate on single point-pair constraints inside the projective stratum. More analytic reviews and comparisons between them, regarding primarily their use as minimisation quantities for fundamental matrix estimation, can be found in [20–23]. In any case, in order to employ the scalar quantities based on epipolar distances in a binary classification framework to distinguish between inliers and outliers, one needs to define a threshold. As proven in [15,10], addition of Gaussian noise on the image points leads to a hyperbolic envelope for each epipolar line. This envelope can be used to define thresholds for the binary classification, however it is both variable across each epipolar line and needs prior knowledge of the image points’ noise for an accurate calculation.

Stronger forms of geometric consistency can be expressed by using sets of multiple point-matches, since single point-pair equations give rise to multiple false matches, especially in degenerate configurations such as when the epipolar lines are close to parallel. A wide range of algorithms utilise multiple points purely geometrically in configurations inspired by the theory of invariants in projective spaces [24–27]. Most of them however deal with restricted problems, such as in the case of scenes with planar objects [2,28,29]. In [30] some general constraints based on the cross-ratio for 4, 6 and 7 point-pairs are mentioned, which are employed in a minimisation framework for the estimation of the fundamental matrix. As with most methods in 
                           
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                              
                           
                        , there remain the problems arising due to the mathematical peculiarities of this space.

Calculations in a projective space are non-linear and no metrics can be defined in it. This is a common inconvenience to most algorithms operating inside the projective stratum, since commonly used minimisation and estimation methods are optimal in some way when operating in metric spaces. For example methods based on least squares minimise a quantity that can be formulated in a way as to correspond to the Euclidean distance between two points. Thus in a Euclidean space, the minimisation of this quantity which is invariant to rigid body transformations would represent solutions to problems that are physically meaningful. Conversely, the absence of a metric quantity in a projective space renders these methods nonoptimal in any physically meaningful way [10,9]. As a result, in most wide-baseline scenarios the distribution of errors in geometrical calculations is not known and arithmetically ill-behaved. Particularly in wide baseline point matching, some kind of error distribution for the outliers and an associated threshold is required in most indexing frameworks. The most common practical approaches usually follow the RANSAC [11] paradigm. According to it, pair matches extracted through some flavour of local descriptor serve as the seeds for an outlier rejection phase that utilises geometric epipolar constraints after randomly choosing minimal subsets from which to estimate the fundamental matrix. The RANSAC paradigm is not computer vision specific and the numerous refinements that have been proposed in that context [13,31–33,12] primarily suggest different ways to evaluate variations of the same geometric criterion, namely the epipolar distance. A critical assumption in the RANSAC algorithm is that the inlier bound, or the variance of the noise is known [11]. Some enhanced versions like MINPRAN [34], MUSE [35], ASSC [36], STARSAC [37] explicitly estimate the unknown scale of the inliers noise to extract the inliers from the data. All these methods still employ the aforementioned geometric distances as a means of evaluating the conformance of the matches to the epipolar geometry.

In the sections to follow we describe a method for the evaluation of projective geometric consistency among point-matches between two images in a weakly calibrated wide baseline setting. We also propose applications for it in (a) pure point matching and in (b) robust fundamental matrix estimation, the latter as a component in a RANSAC-like framework. Our approach is purely geometric, i.e. we only use the image coordinates and ignore texture and colour, leaving this information to appropriate local feature descriptors that provide the initial matches. We introduce a cost function based on the cross ratio that expresses the goodness of fit of a set of 6 point matches in general position relative to the given epipolar geometry. Each point pair can be an element in many 6-tuples of point pairs, providing us with multiple measurements for its epipolar geometric consistency in respect to the other points. Through a statistical analysis and backed by experimental results we show that our cost function viewed as a random process exhibits sufficiently distinct properties when the point-matches satisfy the epipolar geometry (inliers) compared to the case when they do not (outliers). Using a random sampling procedure we approximate the empirical distribution function of our cost function for each match over the set of all point-pairs. We show that the EDFs characterising each potential match converge after relatively few samples and cluster into outliers and inliers that can be linearly separated. Moreover, the clustering is performed progressively without the consideration of arbitrary thresholds in their characterisation and indexing. The accuracy of our algorithm is positively correlated to the number of samples, which correspond linearly to its computational complexity. At the same time, this accuracy is already sufficient when involving a moderate number of samples. Finally, we note that our mathematical framework is fully projective, without any scene or camera position constraints.

Although we describe and evaluate our method without assuming any particular algorithm for the initial point matching, it is important to state the intended application scenario. In particular, we propose our algorithm as a last filtering step in a pipeline of methods of increasing specificity, which is a common approach for many practical computer vision algorithms. As an example, which is also followed in the experimental section, an appearance based matching method (e.g. SIFT, cross-corelation, elliptical regions) is followed by a simple epipolar line method and finally by our approach. This is done both to take advantage of existing well-established methodologies for point matching and to constrain the high computational complexity of our method that is shown in this paper to be correlated to the percentage of outliers.

The cross-ratio is an invariant quantity in any projective space and it is defined on 4 collinear points. In 
                        
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        
                      this quantity constitutes an invariant also for a pencil of 4 coplanar lines and in 
                        
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                        
                      for a pencil of 4 planes. Since our problem formulation assumes known epipolar geometry, it corresponds to a projective framework in which points from 
                        
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                        
                      are projected on 
                        
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        
                     . Given 6 points in 
                        
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                        
                     , such that no three of them are collinear, we can define a pencil of four planes as shown in Fig. 1
                      by selecting two of the points as common to all of them. The cross-ratio for this pencil of planes is invariant to any projective transformation [38] and any line intersecting all four planes will meet them at points that also have the same cross-ratio. Since the projection of four collinear points from 
                        
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                        
                      to 
                        
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        
                      will preserve both collinearity and cross ratio, we can measure it on the image planes of a stereo pair and both measurements should coincide. Cross-ratios have already been proposed [39] for matching purposes, however with the requirement of planar surfaces about the scene. We introduce a novel way to overcome the cross-ratio’s notable arithmetic instability, by assuming correct correspondences for any random 6 point-pair set and under this assumption statistically evaluating the differences in the cross-ratios as seen on each image.

We will now describe the basic quantity that will be used for the assessment of geometric validity. Assuming 6 ordered 3D points, corresponding conceptually to the pencil of planes shown in Fig. 1, we will estimate their cross-ratio from their projections on the two images. Since the cross-ratio of the pencil is equal to that of four collinear 3D points defining the intersections of an arbitrary line through the planes, we need to find such appropriate points or their projections on the images. Two out of the four collinear points can be the same that define two planes of the pencil, while the other two have to be estimated. We employ a method using homographies between the two images to identify the intersection points for the remaining two planes.

Although the two homographies are used in a symmetric way to find the projections of the remaining two points on each image, in the presence of measurement noise in the point locations they generally yield unequal cross-ratios.

Let 
                              
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 …
                                 
                                    
                                       X
                                    
                                    
                                       6
                                    
                                 
                              
                            be 6 points in 
                              
                                 
                                    
                                       P
                                    
                                    
                                       3
                                    
                                 
                              
                           , which define the planes 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 ,
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 ,
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       5
                                    
                                 
                                 )
                              
                            and 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       6
                                    
                                 
                                 )
                              
                            that intersect along the line 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           , as shown in Fig. 1. Let also 
                              
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 …
                                 
                                    
                                       x
                                    
                                    
                                       6
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 …
                                 
                                    
                                       x
                                    
                                    
                                       6
                                    
                                    
                                       ′
                                    
                                 
                              
                            be the projections of the six points onto the image planes of two cameras with optical centers C and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                              
                            respectively. Then, line 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       4
                                    
                                 
                                 )
                              
                            intersects planes 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       5
                                    
                                 
                                 )
                              
                            and 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       6
                                    
                                 
                                 )
                              
                            at points M and N respectively. We want to compute the ratio 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       4
                                    
                                 
                                 ;
                                 M
                                 ,
                                 N
                                 )
                              
                            which is a projectively invariant quantity for the pencil of planes in question. The cross-ratios defined from the projections of points 
                              
                                 
                                    
                                       X
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       4
                                    
                                 
                                 ,
                                 M
                                 ,
                                 N
                              
                            on the two image planes should therefore in the absence of noise be equal:
                              
                                 (6)
                                 
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          4
                                       
                                    
                                    ;
                                    M
                                    ,
                                    N
                                    )
                                    =
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          4
                                       
                                    
                                    ;
                                    m
                                    ,
                                    n
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   4
                                                
                                                
                                                   ′
                                                
                                             
                                             ;
                                             
                                                
                                                   m
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Knowledge of the epipolar geometry in the form of the fundamental matrix F allows us to extract the two epipoles as its left and right null–spaces. Subsequently, we can estimate the points 
                              
                                 m
                                 ,
                                 n
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                            using the epipoles 
                              
                                 e
                                 ,
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                              
                           , the projections of planes 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       5
                                    
                                 
                                 )
                                 ,
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       6
                                    
                                 
                                 )
                              
                            and the projections of line 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       4
                                    
                                 
                                 )
                              
                           . We describe the calculation for points 
                              
                                 m
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       ′
                                    
                                 
                              
                           , as shown in Fig. 2
                           .

We need at least four points to define the homography of plane 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       5
                                    
                                 
                                 )
                              
                            for the stereo pair. To this end we exploit the fact that any projective plane in general position intersects the line joining the optical centres at some point, by taking the epipole as the fourth point of the plane for each camera. This yields the four correspondences 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       5
                                    
                                 
                                 ,
                                 e
                                 )
                                 ↔
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                5
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          
                                             
                                                e
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                           , which allows us to estimate the point homography 
                              
                                 
                                    
                                       H
                                    
                                    
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             5
                                          
                                       
                                       )
                                    
                                 
                              
                            (see [10]). We can now use the inverse transpose of the point homography 
                              
                                 
                                    
                                       H
                                    
                                    
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             5
                                          
                                       
                                       )
                                    
                                 
                              
                           , which is the corresponding line homography for the plane 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       5
                                    
                                 
                                 )
                              
                           , to predict a phantom image 
                              
                                 
                                    
                                       l
                                    
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                              
                            of line 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                 
                                 )
                              
                            in the second camera. By this we mean that we estimate the image 
                              
                                 
                                    
                                       l
                                    
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                              
                            of line 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                 
                                 )
                              
                            on the second camera, under the assumption that it is coplanar with plane 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       5
                                    
                                 
                                 )
                              
                           .
                              
                                 (7)
                                 
                                    
                                       
                                          l
                                       
                                       
                                          v
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          H
                                       
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                5
                                             
                                          
                                          )
                                       
                                       
                                          -
                                          T
                                       
                                    
                                    
                                       
                                          l
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          )
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       l
                                    
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       )
                                    
                                 
                              
                            are the 2D homogeneous coordinates of line 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                 
                                 )
                              
                            in the first image. Apparently, this would hold true only for the points of the line 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       4
                                    
                                 
                                 )
                              
                            that lie on the plane 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       5
                                    
                                 
                                 )
                              
                           , in the general case these being only the intersection point M. The image 
                              
                                 
                                    
                                       m
                                    
                                    
                                       ′
                                    
                                 
                              
                            of M on the second camera can be thus estimated as
                              
                                 (8)
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          l
                                       
                                       
                                          v
                                       
                                       
                                          ′
                                       
                                    
                                    ∩
                                    
                                       
                                          l
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          H
                                       
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                5
                                             
                                          
                                          )
                                       
                                       
                                          -
                                          T
                                       
                                    
                                    
                                       
                                          l
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          )
                                       
                                    
                                    ×
                                    
                                       
                                          l
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           and accordingly in the first image as
                              
                                 (9)
                                 
                                    m
                                    =
                                    
                                       
                                          H
                                       
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                5
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          l
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                    ×
                                    
                                       
                                          l
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        

Using the same reasoning, we calculate the projections 
                              
                                 n
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                            of N by substituting point 
                              
                                 
                                    
                                       X
                                    
                                    
                                       5
                                    
                                 
                              
                            with 
                              
                                 
                                    
                                       X
                                    
                                    
                                       6
                                    
                                 
                              
                            in the equations:
                              
                                 (10)
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          H
                                       
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                6
                                             
                                          
                                          )
                                       
                                       
                                          -
                                          T
                                       
                                    
                                    
                                       
                                          l
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          )
                                       
                                    
                                    ×
                                    
                                       
                                          l
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                           
                              
                                 (11)
                                 
                                    n
                                    =
                                    
                                       
                                          H
                                       
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                6
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          l
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                    ×
                                    
                                       
                                          l
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        

We now have all point coordinates needed to calculate the cross ratios 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                 
                                 ;
                                 m
                                 ,
                                 n
                                 )
                              
                            and 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                             
                                                ′
                                             
                                          
                                          ;
                                          
                                             
                                                m
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                           . The function of the cross-ratio with regard to its four point arguments is subsequently denoted as 
                              
                                 λ
                              
                            and the procedure which is employed to find the projected virtual points 
                              
                                 m
                                 ,
                                 n
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                            as 
                              
                                 h
                              
                           , taking as its arguments the point matches and the epipoles. Using these notions we express 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              
                            in the following way, which will allow us in the sections to follow to approximate their statistical behaviour:
                              
                                 (12)
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    λ
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          4
                                       
                                    
                                    ,
                                    m
                                    ,
                                    n
                                    )
                                    =
                                    λ
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   4
                                                
                                             
                                             ,
                                             
                                                
                                                   h
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            ,
                                                            e
                                                            ,
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   3
                                                   ,
                                                   4
                                                   ,
                                                   5
                                                
                                             
                                             ,
                                             
                                                
                                                   h
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            ,
                                                            e
                                                            ,
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   3
                                                   ,
                                                   4
                                                   ,
                                                   6
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (13)
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    λ
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   4
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   m
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    =
                                    λ
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   4
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   h
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            ,
                                                            e
                                                         
                                                      
                                                   
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   3
                                                   ,
                                                   4
                                                   ,
                                                   5
                                                
                                             
                                             ,
                                             
                                                
                                                   h
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            ,
                                                            e
                                                         
                                                      
                                                   
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   3
                                                   ,
                                                   4
                                                   ,
                                                   6
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Finally, we define 
                              
                                 Δ
                              
                            as the difference of the two cross-ratios
                              
                                 (14)
                                 
                                    Δ
                                    =
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    -
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        

This quantity can only be guaranteed to be equal to zero in the absence of noise in the point coordinates. Its error distribution is heavily dependent on the unknown intrinsic and extrinsic calibration and thus cannot be easily handled in a traditional estimation framework. We shall subsequently try to employ 
                              
                                 Δ
                              
                            in our algorithm in a way that obviates this problem.

Most computations in a projective framework are inherently problematic due to the fact that the errors in the quantities involved follow distributions that depend on the particular scene and camera configuration and they also are not in any way invariant under projective transformations in a rigid body scenario. For example, while the cross ratio of a pencil of planes remains constant under projective transformations, addition of noise to one point only yields a difference that is wildly dependent on both the transformation and the point configuration, which can be proved by the fact that cross-ratios are points in 
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                              
                           . When used in any quantitative computation they are necessarily employed as projections from 
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                              
                            unto 
                              
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                              
                           , i.e. as the ratio of projective coordinates of 
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                              
                           , and thus are clearly unbounded and subject to the underlying line at infinity which is not known in a weakly calibrated scenario. Thus we will employ some means of filtering in our algorithm to lessen the impact of grossly ill-posed computations. The choice of the method will become clearer in the sections to follow, so at this point it should suffice to point out that we are interested in characterising projectively valid and invalid configurations of sets of 6 points and thus their particular ordering is of no importance.

As shown in Fig. 1, points 
                              
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                              
                            define the instance of the pencil of planes constructed by indicating the intersection of the planes. In total we can form 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   6
                                                
                                             
                                             
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            pencils of planes from each set of 6 points, each one having a different cross-ratio. For each pencil of planes we have a different estimation for 
                              
                                 Δ
                              
                           , denoted as 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 with
                                 
                                 i
                                 =
                                 1
                                 …
                                 
                                    
                                       
                                          
                                             
                                                
                                                   6
                                                
                                             
                                             
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           . In the case of error free points and regardless of the method for the estimation of 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                              
                           , we have 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                              
                            for all i. In the presence of noise however and assuming that the underlying projective base does not cause the cross-ratio expressed in 
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                              
                            to cross the line at infinity, we can assume that the difference 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                              
                            for valid point configurations has a zero mean value and unknown but low standard deviation. This is clearly not always a valid assumption, but we intend to detect these cases, which also characterise good quality point matches, by enforcing a constraint that strongly favours points for which the calculations are not ill-posed and consistently give low values in the difference of cross ratios. Among the 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   6
                                                
                                             
                                             
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 15
                              
                            possible 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                              
                           s we choose the one with the largest absolute value to express the geometric validity of each set of 6 points, denoted as s:
                              
                                 (15)
                                 
                                    s
                                    =
                                    
                                       
                                          
                                             max
                                          
                                          
                                             i
                                             =
                                             1
                                             …
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               6
                                                            
                                                         
                                                         
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    |
                                    
                                       
                                          Δ
                                       
                                       
                                          i
                                       
                                    
                                    |
                                 
                              
                           
                        

This quantity is indicative of the geometric consistency of a 6-tuple, yet it is fragile since it operates in a projective space with an arbitrary basis. However, each putative point-correspondence can form many possible 6-tuples and thus we have the option of sampling s among them and processing it statistically. We will argue in the sections to follow, that the statistical properties of inliers and outliers with regard to s are sufficiently distinct as to enable us to differentiate between them by simple clustering.

We will now analyse the statistical properties of quantity s viewed as a random process. To achieve this, we will proceed in steps starting with the estimation of the statistics of the cross ratio 
                           
                              λ
                           
                         when computed according to Section 3.1.1. Subsequently we will estimate the distribution of the difference of cross-ratios 
                           
                              Δ
                           
                         and finally we will conclude with the statistical properties of s. Reminding that s depends on 7 point pair correspondences (counting the two epipoles as the seventh), we consider two different scenarios that generate values for s in an arbitrary weakly calibrated setting:
                           
                              •
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                    
                                 : All seven point correspondences are correct, i.e. the six point matches and the fundamental matrix are correct.


                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                    
                                 : At least one among the seven point correspondences is incorrect, which means it is an outlier and not just subject to measurement error. Since the seventh point–pair correspondence is defined by the two epipoles, this scenario includes the case when the epipolar calibration is invalid, i.e. the fundamental matrix does not correspond to the true epipolar geometry.

We perform for both cases a simplified statistical analysis which is confirmed by experiments. Before doing this however, we will consider the statistical behaviour of the aforementioned cross-ratio calculation from 6 point correspondences, which applies to both cases.

In Section 3.1.1 we have described the calculation of 
                              
                                 Δ
                              
                            for a given 6-tuple of point matches as the difference of the 2 cross-ratios 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              
                           . Each of these cross ratios was derived from 4 collinear projective points, of which 2 were real image points while the other two were virtual, i.e. calculated from other image points and not necessarily inside the image boundaries. It can be seen from (12) and (13) that 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              
                            are calculated in an identical way with regard to the ranges and positions of their variables. As such, they both express the same distribution when aggregated over all possible configurations of points confined in an image frame and of epipoles. We denote this distribution as 
                              
                                 
                                    
                                       f
                                    
                                    
                                       λ
                                    
                                 
                                 (
                                 x
                                 )
                              
                            and proceed to estimate it by firstly making some simplifications in our analysis which were found empirically to be good approximations.

The calculation of the cross-ratio from the seven point correspondences by the method described in the previous sections is a non-linear function of 14 homogeneous point parameters, for which there is even a closed form expression when taking into account some approximations, albeit a rather long and complex one. Statistical analysis on this function given the distribution of its initial variables was rather involved and has not yielded useful results, however the final calculation of the cross ratio from four points is relatively easily expressed in terms of the distributions of its points 
                              
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                 
                                 ,
                                 
                                 m
                                 ,
                                 
                                 n
                              
                            (resp. 
                              
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       m
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                           ).

We proceed in two steps. Firstly, we will estimate the distributions of the four points involved in the calculation of each cross-ratio. Some approximations and simplifications will be used in the process, which however are confirmed by Monte Carlo experiments. Secondly, we calculate analytically the PDF of the cross-ratio given the distributions of the previous step. For this we will follow a modification of the method employed in [40]. We refer to it as well as to Appendix C for more details, we note however the following: although the four points are two dimensional, they all are due to the definition of the cross-ratio collinear and thus we can express them using one–dimensional coordinates along the line passing through them. This observation simplifies the subsequent statistical analysis.

The first simplification we make use of is the assumption that the four points used in the estimation of the cross ratio are mutually independent and of rectangular distribution. This holds true for the first two points alone, 
                              
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                 
                                 
                                 or
                                 
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                    
                                       ′
                                    
                                 
                              
                           , but is only an approximation for the two subsequent ones 
                              
                                 m
                                 ,
                                 
                                 n
                              
                            and 
                              
                                 
                                    
                                       m
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                           , as implied by the arguments of 
                              
                                 h
                              
                           . Moreover, the ranges of the distributions are different for 
                              
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                 
                              
                            (resp. 
                              
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                    
                                       ′
                                    
                                 
                              
                           ) than for 
                              
                                 m
                                 ,
                                 
                                 n
                              
                            (resp. 
                              
                                 
                                    
                                       m
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                           ). In the first case the points are constrained in the image frame since they are real points in the images, while in the latter they can be anywhere on the real plane since they are calculated points through the function 
                              
                                 h
                              
                            mentioned in Eqs. (12) and (13).

Viewing each uncalibrated image as a 2-dimensional projective space whose image point coordinates correspond to an arbitrary basis, each line in it is a one–dimensional subspace. For the estimation of m (resp. n) along line 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                 
                                 )
                              
                           , function 
                              
                                 h
                              
                            operates on points 
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                              
                            with 
                              
                                 i
                                 =
                                 {
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 ,
                                 5
                                 }
                              
                            (resp. 
                              
                                 i
                                 =
                                 {
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 ,
                                 6
                                 }
                              
                           ) which are of rectangular distribution inside the image frame, but also on the epipoles 
                              
                                 e
                                 ,
                                 
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                              
                           , which stretch the whole projective space to account for all possible epipolar configurations. As such we adopt the assumption that the calculated point m (resp. n) can be located anywhere on the entire projective line passing through points 
                              
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                 
                              
                            (resp. 
                              
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                    
                                       ′
                                    
                                 
                              
                           ) in a uniform way. The PDFs of their projective parameter on the normal basis are, under these assumptions and for all possible point-matches and epipolar configurations, Cauchy distributions as shown in Appendix D. However, in our subsequent statistical analysis we modeled these points with a very low order approximation in the form of a rectangular distribution. The width denoted as 
                              
                                 ρ
                              
                            was chosen empirically by comparing histograms of cross-ratios obtained through Monte Carlo experiments using real data and both exact and approximated distributions.

By summarising the above, 
                              
                                 λ
                              
                            is approximated by the cross-ratio of 4 points with independent rectangular distributions, two of them ranging in 
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                            and the two remaining in 
                              
                                 [
                                 0
                                 ,
                                 ρ
                                 ]
                              
                           , where 
                              
                                 ρ
                              
                            is greater than 1 and represents the range of the virtual points 
                              
                                 m
                                 ,
                                 
                                 
                                    
                                       m
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 n
                                 ,
                                 
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                           . The case for 
                              
                                 ρ
                                 =
                                 1
                              
                           , i.e. all four points have identical rectangular distributions, has been analysed in depth in [40]. We proceed in a similar way for the case of nonidentical distributions and arrive to a closed form solution (see Appendix C), however the expression is rather long to be included here. The shape of the distribution depends on parameter 
                              
                                 ρ
                              
                           . For 
                              
                                 ρ
                                 =
                                 1
                              
                           , the resulting distribution is symmetric around the mean value and coincides with the one described in [40], while for increasing values of 
                              
                                 ρ
                              
                            it becomes more concentrated around 1.

In Fig. 3
                            we overimpose the approximated PDF onto experimental data taken from Monte Carlo runs of the cross-ratio calculation on random synthetic data. The Monte Carlo experiments were performed using both valid and invalid synthetic data and an implementation of the cross-ratio calculation described in Section 3.1.1 over 1000 runs. The synthetic data parameters and generation for these and subsequent Monte Carlo experiments of Section 3.2 are, unless otherwise noted, the same as the ones used in the experiments of Section 6. Taking into account multiple scene settings we have observed that the estimated histograms for invalid point-matches are better approximated by slightly larger values of 
                              
                                 ρ
                              
                           , than the ones estimated from valid point-matches, however the difference seems to be negligible. In any case, the exact value of 
                              
                                 ρ
                              
                            is not needed in the subsequent indexing algorithm, so we will no further elaborate on that.

Having approximated the PDF of the cross ratio calculation, we now examine the distribution of the difference 
                              
                                 Δ
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              
                           , starting with case 
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           , i.e. for at least one invalid point match in each 6-tuple. For this scenario we will make a further approximation by assuming that the two cross-ratios 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              
                            calculated for each 6-tuple of point-matches are statistically independent. This is an overstatement, yet our choice is suggested by the following reasoning: The points used in the calculations of 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              
                            are assumed to act on geometric objects such as lines and planes in projective space and the calculations themselves correspond to geometric processes. As such we expect that any quantities derived through them will preserve some characteristics of the underlying projective space and be connected by some sequence of projective transformations. In the case of outliers, either by point mismatches or erroneous epipolar geometry, there will be no consistent underlying projective relations and thus we assume that statistically this can be expressed as identical independent distributions for 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              
                            over the set of random point configurations and epipolar geometries. This assumption must be relaxed when there are some projectively consistent point-matches among the seven (expressing the epipolar geometry as a point match between the two epipoles), but for simplicity we will handle all cases having from one to seven outliers as being the same and completely independent.

Under the assumption of independence, the difference 
                              
                                 Δ
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              
                            will be given by the cross correlation of the two identical distributions for 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              
                           , denoted as 
                              
                                 
                                    
                                       f
                                    
                                    
                                       λ
                                    
                                 
                                 (
                                 x
                                 )
                              
                            :
                              
                                 (16)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          Δ
                                       
                                    
                                    (
                                    x
                                    |
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          λ
                                       
                                    
                                    (
                                    x
                                    )
                                    ★
                                    
                                       
                                          f
                                       
                                       
                                          λ
                                       
                                    
                                    (
                                    x
                                    )
                                 
                              
                           Although we have a closed form solution for 
                              
                                 
                                    
                                       f
                                    
                                    
                                       λ
                                    
                                 
                                 (
                                 x
                                 )
                              
                           , the integral implied in Eq. (16) could not be solved analytically and we present results derived through numerical integration of our analytic function in Fig. 4
                           (a) for 
                              
                                 ρ
                                 =
                                 2
                              
                           . An empirical histogram of our implementation computed through Monte Carlo experiments is also shown for comparison.

For the calculation of 
                              
                                 Δ
                              
                            in the case of valid epipolar geometry and point matches, i.e. scenario 
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                              
                           , we cannot make use of the approximation of independence. The two cross-ratios 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              
                            are highly correlated because of the unterlying geometric consistency and thus the cross-correlation of their distribution functions cannot be used for the estimation of 
                              
                                 
                                    
                                       f
                                    
                                    
                                       Δ
                                    
                                 
                                 (
                                 x
                                 |
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                           . However, we note that under ideal conditions the two cross-ratios are equal due to their theoretical invariance. We can therefore assume that in that case the PDF of 
                              
                                 Δ
                              
                            is a delta function. This is confirmed as expected by Monte Carlo experiments on random synthetic data with correct epipolar geometry and no noise perturbation. In the presence of noise 
                              
                                 
                                    
                                       f
                                    
                                    
                                       Δ
                                    
                                 
                                 (
                                 x
                                 |
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            will deviate from the delta function in a way that we do not model theoretically, however we provide experimental results about its statistical
                              1
                              For interpretation of color in Fig. 6, the reader is referred to the web version of this article.
                           
                           
                              1
                            properties in Section 6.1 (Fig. 6
                            – blue line).

At this point the distribution of s defined in Eq. (15) can be expressed in terms of 
                              
                                 
                                    
                                       f
                                    
                                    
                                       Δ
                                    
                                 
                                 (
                                 x
                                 )
                              
                           . We recall from Eq. (15) that s is the maximum absolute value taken from 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   6
                                                
                                             
                                             
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 15
                              
                            calculations of 
                              
                                 Δ
                              
                            coming from the same process (i.e. either case 
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                              
                            or 
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                           ) and thus having the same distribution. We denote this distribution as 
                              
                                 
                                    
                                       f
                                    
                                    
                                       |
                                       Δ
                                       |
                                    
                                 
                                 (
                                 x
                                 )
                              
                            and it can be trivially estimated from 
                              
                                 
                                    
                                       f
                                    
                                    
                                       Δ
                                    
                                 
                                 (
                                 x
                                 )
                              
                           . Making the additional approximation that the calculations 
                              
                                 |
                                 
                                    
                                       Δ
                                    
                                    
                                       j
                                    
                                 
                                 |
                              
                            are mutually independent, we can apply the equations that express the cumulative distribution function of the 
                              
                                 max
                              
                            operator on sets of values. Thus, the approximated CDF of 
                              
                                 |
                                 s
                                 |
                              
                            for each of the two cases 
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                              
                            is given by:
                              
                                 (17)
                                 
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          |
                                          s
                                          |
                                       
                                    
                                    (
                                    x
                                    |
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             ∏
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             15
                                          
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          |
                                          Δ
                                          |
                                       
                                    
                                    (
                                    x
                                    |
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          F
                                       
                                       
                                          |
                                          Δ
                                          |
                                       
                                    
                                    
                                       
                                          (
                                          x
                                          |
                                          
                                             
                                                S
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          15
                                       
                                    
                                    
                                    i
                                    =
                                    1
                                    ,
                                    2
                                 
                              
                           
                        

Having estimated the PDF 
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       |
                                       s
                                       |
                                    
                                 
                                 (
                                 x
                                 |
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            of 
                              
                                 |
                                 s
                                 |
                              
                            by integration of its CDF 
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       |
                                       s
                                       |
                                    
                                 
                                 (
                                 x
                                 |
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           , we consider a final simplification in order to remove the absolute value. We note that both 
                              
                                 
                                    
                                       f
                                    
                                    
                                       Δ
                                    
                                 
                                 (
                                 x
                                 |
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            and 
                              
                                 
                                    
                                       f
                                    
                                    
                                       Δ
                                    
                                 
                                 (
                                 x
                                 |
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            are under the hypotheses of the previous sections approximately symmetric around the origin allowing us to presume the same for s, since it is calculated through operations that are also symmetric around the origin. Thus, the distribution of s can be expressed as:
                              
                                 (18)
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    x
                                    |
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            |
                                                            s
                                                            |
                                                         
                                                      
                                                      (
                                                      x
                                                      |
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      if
                                                      
                                                      x
                                                      >
                                                      0
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            |
                                                            s
                                                            |
                                                         
                                                      
                                                      (
                                                      -
                                                      x
                                                      |
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      if
                                                      
                                                      x
                                                      <
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    i
                                    =
                                    1
                                    ,
                                    2
                                 
                              
                           
                        

Using (17) and (18) and numerical integration we calculated 
                              
                                 
                                    
                                       f
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 x
                                 |
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           , which is shown in Fig. 4(b) together with results from the actual implementation derived through Monte Carlo experiments. The histogram differs in the exact shape from the function derived through Eq. (17), indicating that the assumption of independence is not sufficiently appropriate. However, the general shape characteristics are similar, allowing us to draw some conclusions about the processes involved. The effect of the 
                              
                                 max
                              
                            operator on the initial probability distribution is such that values close to zero are suppressed to a degree that is positively correlated to its standard deviation and the size of the set of values. Under ideal conditions the PDFs of 
                              
                                 Δ
                              
                            for the two cases 
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                              
                            differ markedly in their characteristics. Due to its large standard deviation, 
                              
                                 
                                    
                                       f
                                    
                                    
                                       |
                                       Δ
                                       |
                                    
                                 
                                 (
                                 x
                                 |
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            which has a global maximum at zero corresponds after the filtering stage to 
                              
                                 
                                    
                                       f
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 x
                                 |
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           , that exhibits a local minimum at zero and two local maximums symmetrically around it. At the same time, 
                              
                                 
                                    
                                       f
                                    
                                    
                                       |
                                       Δ
                                       |
                                    
                                 
                                 (
                                 x
                                 |
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            which has ideally a delta distribution is not changed at all under the 
                              
                                 max
                              
                            operator and thus is the same as 
                              
                                 
                                    
                                       f
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 x
                                 |
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                           , which is confirmed by Monte Carlo experiments. Under noisy conditions the two are of course not equal anymore, however even under moderate amounts of noise in the point locations the standard deviation is small enough so that the two PDFs for 
                              
                                 |
                                 Δ
                                 |
                              
                            and s exhibit the same global maximum. Indicative results for both cases 
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                            with noisy synthetic and real data are given in Section 6.1.

In the previous sections we have introduced the quantity s, operating on point correspondences and the epipolar geometry as encoded in the fundamental matrix F. Denoting a set of 6 point matches as 
                        
                           
                              
                                 Q
                              
                              
                                 k
                              
                           
                        
                      and 
                        
                           
                              
                                 Δ
                              
                              
                                 k
                              
                              
                                 i
                              
                           
                        
                      as the 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             6
                                          
                                       
                                       
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                      different cross-ratio differences, we restate Eq. (15) with the new arguments:
                        
                           (19)
                           
                              s
                              (
                              
                                 
                                    Q
                                 
                                 
                                    k
                                 
                              
                              ,
                              F
                              )
                              =
                              
                                 
                                    
                                       max
                                    
                                    
                                       i
                                       =
                                       1
                                       …
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         6
                                                      
                                                   
                                                   
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             k
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        
                     As shown before, the output of this function when viewed as a random process has a sufficiently different distribution around zero for the two cases of valid and invalid data (
                        
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                        
                     ). Since we normally have much more than 6 points in each image pair, any given point match pair can be an element in many 6-tuples of pairs 
                        
                           
                              
                                 Q
                              
                              
                                 k
                              
                           
                        
                     , giving multiple values for 
                        
                           s
                           (
                           
                              
                                 Q
                              
                              
                                 k
                              
                           
                           ,
                           F
                           )
                        
                      from which to assess the point pair’s statistical properties. Subsequently, the statistical properties can be used to index each point pair match as valid or invalid, i.e. as an inlier or outlier. In the following sections we shall describe the resulting algorithm in detail.

Let 
                           
                              I
                              ,
                              
                              
                                 
                                    I
                                 
                                 
                                    ′
                                 
                              
                           
                         be an image pair for which we have the epipolar geometry F and an initial estimation of N point correspondences between them, r percent of which are outliers. We denote as 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                         the points in images I, 
                           
                              
                                 
                                    I
                                 
                                 
                                    ′
                                 
                              
                           
                         respectively,
                           
                              (20)
                              
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 …
                                 N
                              
                           
                        a matched point pair and T the set of all 
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           
                        . For the purpose of simplicity we will omit the subscript i in 
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           
                         in the subsequent expressions. We will construct for each t a histogram from the values of 
                           
                              s
                              (
                              
                                 
                                    Q
                                 
                                 
                                    k
                                 
                              
                              ,
                              F
                              )
                           
                         for all 6-tuples of point matches that include it, i.e. all 
                           
                              
                                 
                                    Q
                                 
                                 
                                    k
                                 
                              
                           
                         for which 
                           
                              t
                              ∈
                              
                                 
                                    Q
                                 
                                 
                                    k
                                 
                              
                           
                        .

In the case when t is an outlier, every set 
                           
                              
                                 
                                    Q
                                 
                                 
                                    k
                                 
                              
                           
                         it participates in will be an invalid one and thus the resulting histogram will be derived from the random process of the case 
                           
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                           
                         analysed in Section 3.2.2.

If on the other hand t is an inlier, then it will be an element of both valid and invalid 6-tuples of matches. Thus its histogram will be a mixture from both cases 
                           
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                           
                        , with mixture coefficients related to the percentage r of outliers. Specifically, the PDF of s corresponding to t will be:
                           
                              (21)
                              
                                 
                                    
                                       f
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   (
                                                   x
                                                   |
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                
                                                   if
                                                   t
                                                   
                                                   is an outlier
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   (
                                                   x
                                                   |
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                   +
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   (
                                                   x
                                                   |
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                
                                                   if
                                                   
                                                   t
                                                   
                                                   is an inlier
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where the values for the mixture coefficients 
                           
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                           
                         are given by
                           
                              (22)
                              
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       total number of valid
                                       
                                       
                                          
                                             Q
                                          
                                          
                                             k
                                          
                                       
                                       
                                       for a valid
                                       
                                       t
                                    
                                    
                                       total number of
                                       
                                       
                                          
                                             Q
                                          
                                          
                                             k
                                          
                                       
                                       
                                       for a single
                                       
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         1
                                                         -
                                                         r
                                                         )
                                                         N
                                                         -
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         5
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         N
                                                         -
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         5
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          5
                                       
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       -
                                       r
                                       )
                                       N
                                       -
                                       i
                                    
                                    
                                       N
                                       -
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 1
                                 -
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 1
                                 -
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          5
                                       
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       -
                                       r
                                       )
                                       N
                                       -
                                       i
                                    
                                    
                                       N
                                       -
                                       i
                                    
                                 
                              
                           
                        
                     

We would like to avoid using the mixture ratios and the probability distributions 
                           
                              
                                 
                                    f
                                 
                                 
                                    s
                                 
                              
                              (
                              s
                              |
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              
                              
                                 
                                    f
                                 
                                 
                                    s
                                 
                              
                              (
                              s
                              |
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         explicitly for the purposes of indexing, since they depend both on the measurement errors and the percentage of outliers which are not usually known beforehand. We accomplish this by employing a k-means algorithm for 2 classes (inliers-outliers) on the histograms of all point pair-matches. Assuming that the measurement noise and percentage of outliers are within bounds allowing discernible distribution functions for the two classes, this scheme should be able to differentiate between inliers and outliers automatically and without the use of arbitrary or calculated thresholds.

Ideally we would like to calculate the histograms corresponding to each point pair using all available information from our given images. This would amount to the calculation of 
                           
                              Δ
                           
                         for a total of 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                N
                                             
                                          
                                          
                                             
                                                6
                                             
                                          
                                       
                                    
                                 
                              
                           
                         6-tuples of points, which becomes infeasible even for values of N in the range of a few tens. We will thus employ some form of subsampling to keep the complexity of the algorithm to a manageable level.

A simple biased scheme is used to randomly select 6 point-pair sets among the available ones. The biasing is utilised to ensure that each point pair will be an element in about the same number of 6-tuples 
                           
                              
                                 
                                    Q
                                 
                                 
                                    k
                                 
                              
                           
                        . More specifically, the sampling algorithm keeps record of the the previous selections and weights down point-pairs that have been sampled more frequently than others. As a result, at each step in the sampling procedure the samples taken for any point-pair are close to the total mean. The reason for this lies in the way we employ the termination criterion for our indexing algorithm, for which we prefer to keep the number of samples for each point pair histogram in the same range. By using a suitable implementation of the k-means algorithm, the inliers and outliers among the point pairs are indexed progressively as new 6-tuples are sampled until they converge, i.e. when point-pairs stop changing labels.

We have sofar referred to the estimation of the underlying distribution function for each point using histograms. In practice histograms are quite noisy and thus not very suitable for our classification step. We use instead a Gaussian kernel density estimation method that smooths the EDF of each point pair.
                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       s
                                       ,
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             2
                                             π
                                          
                                       
                                       n
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       
                                          
                                             x
                                             -
                                             s
                                             (
                                             
                                                
                                                   Q
                                                
                                                
                                                   t
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             ,
                                             F
                                             )
                                          
                                          
                                             2
                                             b
                                          
                                       
                                    
                                 
                              
                           
                        where n is the number of sampled 6-tuples 
                           
                              
                                 
                                    Q
                                 
                                 
                                    t
                                    (
                                    k
                                    )
                                 
                              
                           
                         that contain the point pair t, and b is an appropriately chosen bandwidth parameter. Finally, the estimated distribution is encoded in a vector 
                           
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    s
                                    ,
                                    t
                                 
                              
                              =
                              {
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    s
                                    ,
                                    t
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                              …
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    s
                                    ,
                                    t
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    M
                                 
                              
                              )
                              }
                           
                        , where 
                           
                              
                                 
                                    x
                                 
                                 
                                    m
                                 
                              
                           
                         with 
                           
                              m
                              =
                              1
                              …
                              M
                           
                         is a fixed number of values around the origin, to be subsequently used as observations for a k-means algorithm with two clusters. The size M of the vector is an arbitrary design parameter which in our implementation was set to 100. It is shown however in the experiments of Section 6.1, that after PCA analysis of this 100-dimensional vector, the first three principal components are adequate for classification purposes.

At this point we can describe the complete indexing algorithm. We start by taking an image pair 
                           
                              I
                              ,
                              
                              
                                 
                                    I
                                 
                                 
                                    ′
                                 
                              
                           
                         with known epipolar geometry F and an initial estimation of N point correspondences between them. A vector of fixed size representing a quantised distribution function 
                           
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    s
                                    ,
                                    t
                                 
                              
                              (
                              x
                              )
                           
                         is assigned to each point correspondence t and initialised to zeros. Each t is also assigned a class index denoted as 
                           
                              C
                              (
                              t
                              )
                           
                         and set to false, which represents an outlier.
                           
                              1.
                              Six point matches are selected using a biased random estimator. The biasing ensures that as the sampling proceeds, each point pair will participate in approximately the same number of 6-tuples.
                                    
                                       •
                                       For every set 
                                             
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                           of 6 point-match pairs, 
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  6
                                                               
                                                            
                                                            
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                           pencils of planes are assumed and the differences of their cross-ratios 
                                             
                                                
                                                   
                                                      Δ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      1
                                                      i
                                                   
                                                
                                                -
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      2
                                                      i
                                                   
                                                
                                             
                                           relating to each image are calculated.

We select 
                                             
                                                
                                                   
                                                      Δ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                           whose absolute value is the largest (denoted as s (
                                             
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          ,
                                          F)) and assign it to all point-pairs of the 6-tuple in question.


                                          
                                             
                                                s
                                                (
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                F
                                                )
                                             
                                           is weighted by a Gaussian kernel in accordance to Eq. (24) and added to the histogram vectors of each of the 6 point matches.

The above procedure is repeated until all point pairs have received some measurements for their histogram vectors. These vectors are used as inputs in a k-means classification algorithm for 2 classes (inliers/outliers).

The classification of step 2 is repeated periodically. The algorithm terminates when the classification labels converge and remain fixed across iterations or when we reach a maximum number of samples

The output of the algorithm is the classification of each point pair as inlier or outlier. The calculation can be stopped at any sample ratio ignoring the termination criterion, in which case the classification will have a lower accuracy. The algorithm is given in form of pseudocode in Appendix B.

So far we have described our method in a weakly calibrated scenario, where the epipolar geometry is accurately or approximately known. By employing our indexing algorithm in a RANSAC framework, we can extend it in the uncalibrated case. Each iteration of the RANSAC algorithm, as usually employed in fundamental matrix calculation, estimates as a first step the epipolar geometry from a minimal sample. Our indexing algorithm can subsequently be employed to find the number of inliers defining the consensus set, whose cardinality is used in the basic implementation of RANSAC to assess the validity of the estimation of the fundamental matrix. We start by taking two images 
                        
                           I
                           ,
                           
                           
                              
                                 I
                              
                              
                                 ′
                              
                           
                        
                      and N point correspondences between them denoted as t. Employed in the original RANSAC framework [11] where the cardinality of the consensus set serves as the model selection metric, our algorithm can be described by the following pseudocode:
                        
                           
                              
                              
                                 
                                    1: 
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   iter
                                                
                                             
                                             ←
                                             0
                                          
                                       
                                    
                                 
                                 
                                    2: repeat
                                    
                                 
                                 
                                    3: Randomly select 7 point correspondences
                                 
                                 
                                    4: Estimate F
                                    
                                 
                                 
                                    5: Calculate 
                                          
                                             C
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                        for all remaining 
                                          
                                             (
                                             N
                                             -
                                             7
                                             )
                                          
                                        point correspondences
                                 
                                 
                                    6: 
                                       
                                          
                                             CS
                                             (
                                             
                                                
                                                   n
                                                
                                                
                                                   iter
                                                
                                             
                                             )
                                             ←
                                             0
                                          
                                        {Initialise consensus set}
                                 
                                 
                                    7: 
                                       for all 
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                          
                                        
                                       do
                                    
                                 
                                 
                                    8: 
                                       if 
                                       
                                          
                                             C
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             =
                                          
                                        
                                       true then
                                    
                                 
                                 
                                    9: 
                                       
                                       
                                          
                                             CS
                                             (
                                             
                                                
                                                   n
                                                
                                                
                                                   iter
                                                
                                             
                                             )
                                             ←
                                             CS
                                             (
                                             
                                                
                                                   n
                                                
                                                
                                                   iter
                                                
                                             
                                             )
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 
                                    10: 
                                       end if
                                    
                                 
                                 
                                    11: 
                                       end for
                                    
                                 
                                 
                                    12: 
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   iter
                                                
                                             
                                             ←
                                             
                                                
                                                   n
                                                
                                                
                                                   iter
                                                
                                             
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 
                                    13: until 
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   iter
                                                
                                             
                                             >
                                             
                                                
                                                   n
                                                
                                                
                                                   max
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    14: Select maximum consensus set 
                                          
                                             
                                                
                                                   CS
                                                
                                                
                                                   max
                                                
                                             
                                             =
                                             
                                                
                                                   max
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                   …
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                
                                             
                                             CS
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                 
                                 
                                    15: Reestimate F using all inliers corresponding to the maximum consensus set.
                                 
                                 
                                    16: return F and inliers
                                 
                              
                           
                        
                     
                  

The indexing method we propose in the current formulation only gives binary decisions about the classification of the point matches into inliers and outliers. This forces us to firstly try to use the only RANSAC flavour that can make use of a binary model selection metric, which happens to be the worst performing one when using geometric distances as the model selection metric [13,12,41]. In order to employ the improved variations of RANSAC like MSAC or LMedS in our framework, we can make a slight modification in it with no overhead at all. Instead of only the binary decisions of the k-means step we could also make use of the distances of each histogram vector from the two cluster centres, which gives us a real valued metric-like quantity to assess the quality of the classification decision. At this point however we wanted to examine the application of our proposed indexing method as is and to provide a baseline algorithm. Thus, we implemented it and used it in the experiments presented in Section 6.3 only in the original RANSAC scheme, leaving any improvements for future work.

The previous approach has of course a very high computational complexity, since our algorithm is invoked on each iteration of the RANSAC algorithm. A much less computationally intensive methodology is to use our indexing method as the final filtering step after the application of a RANSAC scheme based on the epipolar distances. This has the disadvantage of needing some threshold for the RANSAC step, due to the use of the epipolar distances within. However, since we will filter the resulting point matches at the end with our method, the choice of an optimal threshold becomes less of an issue. In detail, we propose the following pipelined approach:
                           
                              •
                              Employ a MSAC scheme, using as a cost function the symmetric epipolar distance. The MSAC algorithm terminates after a fixed number of iterations and produces an estimation of the fundamental matrix and a list of inliers.

Use the calculated fundamental matrix and inliers of the first step as input to the cross-ratio indexing method and output the resulting inlier list.

We present the results of this algorithm together with the one described previously in Section 6.3.

@&#EXPERIMENTS@&#

We will now present experimental results to verify the statistical analysis made in the previous sections as well as a real application for our algorithm in a RANSAC framework. In Section 6.1 we show the statistical behaviour of our cost function s for inliers, outliers and mixtures thereof. Following that, we compare the performance of the indexing algorithm to the well-known geometric distances mentioned in Section 2.1. Finally, in Section 6.3 we show two different applications of our algorithm in a RANSAC scheme next to variations of RANSAC implementations using geometric distances.

In our experiments we present results both for synthetic and real data. More specifically, the synthetic data scene consists of 100 uniformly distributed random points inside a sphere of radius of 1 unit and a house shaped object for visual reference. The points are projected unto two ideal pinhole cameras distanced at 3 units and less than 10 times their focal length, so that their projections appear purely perspective. Intrinsic parameters for the cameras were chosen as to reflect real settings and the projected points were disturbed by Gaussian noise on the image plane, whose characteristics are stated explicitly in each experiment. The poses and positions of the cameras, as well as the methodology for the creation of outliers were chosen in two different ways and are described in detail in each experiment.

For the real data scenarios we have used images from the INRIA SYNTIM project database [42], two of which are shown in Fig. A.14 of the appendix. The image database contains complete intrinsic and extrinsic calibration parameters for each pair and mainly includes small baseline configurations. Interest points and local descriptors have been extracted by the SIFT methodology and matched automatically as proposed by Lowe [4], using the implementations from VLFeat.org. Ground truth for each putative match has been provided by hand.

For this experiment we have tried to simulate the whole configuration space of different camera positions and schemes different as extensively as possible. Since the locations of epipoles define the epipolar geometry more consistently than the real camera locations, they were varied in such a way that they appear on the image planes over many different areas of a grid. The epipole positions on the were extending 5 times outside the image boundaries, while at the same time the baselines of the cameras were 1 and 2 units. Some of the positions of the cameras that result are shown in Fig. A.15 of the appendix, but the multiple poses taken from each one are omitted for clarity. The following figures show the estimated distribution of a real implementation of our cost function s in comparison to the approximated model analysed in Section 3.2.3. Results were obtained for both real and synthetic data and for increasing sample numbers. The projected points from the synthetic data are perturbed by Gaussian noise with a standard deviation of 1–3pixels relative to an image size of 
                           
                              1024
                              ×
                              768
                           
                        . The epipoles both for the synthetic and the real data were calculated with the 8-point algorithm using the noisy pixels, so they exhibit the uncertainty that is present in realistic scenarios. The real data configurations consist of scenes from the SYNTIM project, from which SIFT features were extracted and matched automatically. The ground truth was defined manually. Finally, the outliers were completely random point-matches, following the assumption made in the theoretical section.

We ran 3 sets of Monte Carlo experiments for each of the synthetic and real data scenarios. For the first set, denoted as 
                           
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                           
                        , we randomly selected 6-tuples containing only valid matches for the estimation of the histograms. The second set 
                           
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                           
                         included samples in which at least one point correspondence was invalid. Finally, set 3 consisted of sampled 6-tuples for which one point-pair was fixed and valid while the rest where randomly chosen among a population having 30 per-cent outliers and is denoted as 
                           
                              
                                 
                                    T
                                 
                                 
                                    3
                                 
                              
                           
                        . The second and third set of experiments illustrate the behaviour of the algorithm in real cases, while the first one gives an indication the cost function’s ability to differentiate between correct and incorrect matches. Following the notation of Section 3.2, 
                           
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                           
                         corresponds to cases 
                           
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                           
                         respectively. 
                           
                              
                                 
                                    T
                                 
                                 
                                    3
                                 
                              
                           
                         corresponds to a mixture of 
                           
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                           
                        , with mixture coefficients similar to a real scenario.


                        Fig. 6 presents estimated histograms from 500 random samples, derived from the same synthetic setting for each of the 3 sets, and for increasing values of noise. As mentioned in Section 3.2.2, the distribution of sets of incorrect matches 
                           
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                           
                         remains unchanged with regard to the noise of the image points. At the same time, the distribution of sets of correct matches 
                           
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                           
                         becomes less pronounced with increasing noise. The result is shown in the figure that the distribution of the mixture 
                           
                              
                                 
                                    T
                                 
                                 
                                    3
                                 
                              
                           
                         is discernible from a that of 
                           
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                           
                         up to a noise threshold that is related to the scene and the percentage of outliers. This threshold is not needed for indexing so it was not analytically modeled.


                        Fig. 7
                         presents estimated histograms for each of the 3 sets after 500 random samples. The synthetic data correspond to a single configuration with additive Gaussian noise on the image point locations of 3pixels standard deviation. The histograms get closer together for large sample numbers and zero noise the distributions we estimated using the approximated model of Section 3. Finally, in order to visualise the performance of the histograms as data in a clustering framework, we performed PCA analysis on them using multiple points from the same configuration. The results for the first two components are shown in Fig. 8
                        , where it can be seen that the three sets have a pretty good separation, being almost linearly pairwise separable.

The next series of experiments were targeted at assessing the performance of our algorithm in inlier/outlier classification. The methodology for choosing the camera positions was a little different from the previous experiment for the following reason. The positioning of the cameras by first choosing the desired epipoles explores the mathematical behaviour of the algorithm, but is not easy to review and assess because in a simple automatic implementation the views of the cameras appear unnatural and do not necessarily target on the test object. For these reasons, we selected a methodology in which the optical axis of the camera passes through the centre of the scene with a standard deviation of 0.5 units, and the optical centre is located on a rectangular grid as shown in Fig. 5. The grid points for the camera positions ranged on a rectangular area of 
                           
                              6
                              ×
                              6
                           
                         units, with the baselines ranging accordingly from 0.5 to 
                           
                              3
                              
                                 
                                    2
                                 
                              
                           
                         units. A view from the two cameras for the smallest and largest baseline is shown in Fig. A.16 of the appendix. Finally, the experiments were performed following the Monte Carlo methodology, with each camera configuration being evaluated against 10 random scenes and the results averaged. Additionally, the projected points on the image planes were contaminated with additive Gaussian noise of 2 pixels standard deviation.

The real image scenarios were taken from the INRIA SYNTIM dataset with automatically derived SIFT features and manual ground truth annotation. The percentage of outliers in both the synthetic and real scenarios were 30% and the epipolar geometry was calculated from a random selection of correct points-matches, thus having an uncertainty equivalent to real cases. We present the classification results of the epipolar distances described in Section 2.1, namely the algebraic the symmetric epipolar and the Sampson distance using ROC curves, with the associated standard deviation derived through the Monte-Carlo method. Since our method does not use any thresholds, we present it on the same graph using points and the associated standard deviation ellipses. We present results for our proposed indexing scheme in which we varied the number of sampled 6-tuples used for the calculation of each point-pair’s histogram between 100 and 1000 samples. Finally, the total number of points used in each scene was 60.

A special note has to be made about the creation of outliers. The points in the real images were all selected by a SIFT detector and matched according to Lowe’s methodology and the groundtruth was confirmed manually, so it represented a true and complete point-matching scenario. This methodology frequently leads to incorrect matches that are “almost correct”, i.e. in the same neighbourhood, especially in images with repeating patterns like the one shown in Fig. A.14(a) of the appendix. We tried to simulate and test this behaviour in our outlier creation methodology for the synthetic scenes. Specifically, outliers are allowed to be inside a radius of 30pixels from a possible true match. Although this might seem small, since it is applied on both images it leads to large variations on the epipolar line distances, from a few pixels up to over 200, depending on the position of the epipoles. This value was found empirically to be close to the results exhibited by using SIFT on real image pairs. Larger offsets correspond to almost random outliers and are very easily discarded by the epipolar distances even with a very crude threshold. For completely random outliers, their performance is really unbeatable, giving consistently for almost all camera and scene configuration an AUC of over 0.95.

Results for some of the synthetic scenarios, along with two real ones from the SYNTIM database, are shown in Figs. 9 and 10
                        
                         respectively. One can note that that the performance of our indexing scheme becomes almost monotonically better with increased sampling, and consistently gives low false positive ratios. Yet, from our method’s point of view, we do need to take into account any minimum sample size for different settings. The monotonicity of the classification performance allows one to terminate the algorithm at any point taking into account the computational power available and the required accuracy in the results. More importantly, false positives remain constantly low, even for low number of samples. This suggests that the indexing scheme is quite strict, and that the correct point matches move away from the cluster of incorrect matches as the sample size increases. Although we generally have a smaller maximum number of inliers, these will more likely be correct and suitable for subsequent geometric algorithms that need strong and unambiguous points.

In Fig. 11
                         we present ROC curves for the same scene, using varying radiuses for the distribution of outliers. The performance of our algorithm for 40% and 50% of outliers is shown in Fig. 12
                        . Since the discriminating power of our method depends on the noise level and percentage of outliers, there is a maximum percentage for each noise level for which our method breaks down. For 2pixels of standard deviation this is found to be at about 35–40%. However, by using a pipelined approach in which we preprocess the putative point matches by a simpler and less strict method like the one presented in Section 5.1, we can keep the percentage of outliers given as an input to our method in that range.


                        Figs. 11 and 12 allow us to draw some conclusions about the application scenarios for which our method performs better than the epipolar distances. They are the two cases where (a) the outlier percentage is moderate and (b) there are a lot of possible matches in the same neighbourhood. The first case can be easily explained by referring to Eq. (23), which shows how the mixture coefficients of the inlier/outlier distributions for each point-match depend on the percentage of outliers. Smaller percentages make the difference in the histograms of inliers more pronounced, and subsequently the k-means algorithm can easily distinguish them. The second case, where there are many possible matches in the same neighbourhood, gives frequently square errors in the epipolar distances that are relatively small. This does not greatly impact our method, since we do not use these errors and rely on multiple measurements derived from our 6-point geometric construction. On the contrary, all types of epipolar distances are very likely to report these point matches as inliers.

Finally, and on the negative side, to be able to achieve a comparable level of performance in total correct decisions to the geometric distances, a minimum number of samples is needed for our algorithm. Even for that minimum number of samples the running time of our algorithm is quite larger than the other methods, at least using a naive implementation. The running times for the 60 points and 1000 samples per point-pair histogram used in each scene and instance of the Monte-Carlo experiments by our algorithm on a 2.6Ghz i7 machine are presented in Table 1
                        . However, as shown, the calculations involved are highly parallelisable and could greatly benefit from implementation techniques taking this fact into account. Especially GPUs are very well suited to that task and is one main focus for future improvement.

We now present experimental results from an application of our algorithm for point matching in an uncalibrated scenario. The implementation is the same as the one outlined in Section 5. Given some putative point correspondences among two images, we sample minimal sets of 7 point correspondences from which the fundamental matrix and hence the epipoles are estimated according to the methodology in [10]. Each point correspondence, excluding the 7 ones used to instantiate the fundamental matrix, is indexed as an inlier or outlier using our projectively geometric indexing method. The cardinality of the consensus set, i.e. the number of inliers classified through our method, is used to rank the samples as in the original definition of the RANSAC framework of Fischler and Bolles [11]. We did not employ a more sophisticated implementation like MSAC since our indexing algorithm provides binary decisions for point matches and not an error quantity. Note that instead of only using the binary decisions from the k-means clustering step, we could also employ the distances of each point correspondence from the cluster centers to serve as error terms which would allow us to use the possibly superior variations of RANSAC.

After a preset number of iterations, which in our experiments was set to 100, the algorithm selects as its output the largest consensus set and its associated fundamental matrix. Up to this point this scenario is identical in its outlines to RANSAC variations used in the estimation of the fundamental matrix, allowing us to compare these methods with ours. We note however that the comparative evaluation of the methods will be done in terms of inlier/outlier indexing performance. More specifically, although the results of the RANSAC variations are both the fundamental matrix and the inlier/outlier classification, we shall only use the latter in our comparisons and ignore the former, i.e the correctness of the fundamental matrix will not be somehow evaluated. This is justified by the fact that the final estimation of the fundamental matrix is usually performed on the inliers by a dedicated non-robust algorithm that is independent of the rest of the RANSAC framework and thus not in the scope of a point matching application.

As comparable methods we have chosen among ones that also operate inside a RANSAC framework and utilise only geometric information, i.e only point coordinates in the image and no texture or colour. All the methods use some form of the geometric distances described in Section 2.1 and they primarily differ in the way they rank the consensus set in each iteration. Each method is indicated in the legends of each figure by the RANSAC variation, which is either RANSAC in the original implementation or MSAC, and the method of validation for each sample. These are either the symmetric epipolar distance (sym. epip. dist.), the Sampson distance (sampson dist.) or the proposed cross-ratio indexing scheme (c-r index 100/ c-r index 500). The latter was employed for two sample sizes per point-pair, namely 100 and 500. We do not include results for the algebraic distance, since it is consistently outperformed by the symmetric apipolar and Sampson distance methods. Finally, we also include the proposed pipelined algorithm of Section 5.1 denoted as (symepi
                        
                        +
                        
                        c-r index 1000) using 1000 samples per point-pair histogram.

The data used in this set of experiments are the same as the ones used in Section 6.2, consisting of both synthetic and real image pairs. The synthetic data include random outliers and are perturbed by Gaussian noise, while the real images contain outliers and localisation errors occurring naturally in the initial matching step by SIFT descriptors. In both cases we evaluate the performance of our proposed algorithm and the other methods against the groundtruth. Fig. 13
                        (a–b) shows the results for total correct decisions and false positives for nine synthetic and two real image pairs. Gaussian noise with a standard deviation 
                           
                              
                                 
                                    σ
                                 
                                 
                                    noise
                                 
                              
                              =
                              2
                           
                         pixels relative to a 
                           
                              1024
                              ×
                              768
                           
                         frame was added to the image points. The total number of points used in each case was 40, which was chosen in order to keep the computational time of the non-optimised implementation of our algorithm manageable for large scale tests.

With small sample sizes the number of correct decisions for the cross-ratio indexing method is relatively low. From 500 samples per point-pair outperforms the algorithms based on the geometric distances in most scenarios, even when implemented in a MSAC framework which is superior to the original RANSAC implementation for the same error metric. Yet, that comes at a cost of computational time which moreover increases non-linearly with the total number of points and the percentage of outliers, since the sample size per point pair should also increase to achieve the same classification performance. The runtimes for c-r index 100 in a 4-core i7@2.6GHz hybrid parallel Matlab/C/LAPACK implementation is 150–200s, whereas for c-r index 500 it is 800–1000s. On the plus side, the number of false positives remains constantly low. As such, even for small sample sizes the few matches that are indexed as inliers are mostly correct. In order to be of practical use, the implementation has to take advantage of parallelisation techniques, for which our method very well suited. It is presented here mainly to show its performance and application in uncalibrated cases, and also as a way to test our algorithm with noisy fundamental matrices that follow distributions that occur in reality. On the other hand, the pipelined approach has a runtime of about 20s in the same hardware configuration, which makes it much more acceptable and promising. Although the true positive ratio is not very high, since it uses as it’s input less initial point matches, it exhibits the lowest false positive ratio of all tested methods.

We have proposed a novel method for the evaluation of projective geometric consistency in weakly calibrated scenarios. The main idea behind our approach is the fact that each point correspondence in our data belongs to one of two classes (inliers/outlier). We characterise each class by the distribution of a measure based on a general projective framework without constraints or scenario dependent parameters/thresholds. Moreover, we show that the accuracy of the method is positively correlated to its sampling density and resulting computational complexity, which is a design choice in it and not fixed. The theoretical analysis and experiments we provided show a promising behaviour of the cost function and indexing method we introduce when applied in inlier/outlier discrimination, especially regarding false positives. Finally, we also presented two applications of our scheme in uncalibrated stereo inside a RANSAC framework and compared it favourably to other relevant algorithms that only make use of geometric information. On the other hand, the main disadvantage of our approach is its high computational complexity and running time.

Our future work will focus on lowering both computational complexity and running time. The first is due to the explosive number of combinations that arise in our method and can be reduced in the current framework by employing additional information for the rejection of improbable or ill-posed intermediate results. One similar step towards that direction has already been shown in the pipelined approach of Section 5.1. Furthermore, our present formulation provides an insight to the maximum number of points that can be evaluated, which can lead to an approach that segments all available point matches into computationally manageable chunks. Related and in addition to that, our proposed method is highly parallelisable and can greatly benefit from such an implementation. We have already tested this assumption in our parallel MATLAB implementation, and expect much larger gains in GPUs. Finally, regarding the application of our method in a RANSAC framework, we can improve the described method by making use of the additional information available from the clustering step such as the cluster distances and their quality of separability. As mentioned in Section 6.3, this would allow us to employ more sophisticated versions of the random sampling framework with minimal overhead in the implementation.

@&#ACKNOWLEDGMENTS@&#

This paper is part of the 03ED853 research project, implemented within the framework of the “Reinforcement Programme of Human Research Manpower” (PENED) and co-financed by National and Community Funds (25% from the Greek Ministry of Development–General Secretariat of Research and Technology and 75% from E.U. – European Social Funding).

See Figs. A.14–A.16
                     
                     
                     .


                     
                        
                           
                              
                              
                                 
                                    1: 
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   m
                                                
                                             
                                             ←
                                             
                                                
                                                   
                                                      
                                                         
                                                            -
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  max
                                                               
                                                            
                                                            …
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  max
                                                               
                                                            
                                                         
                                                         
                                                            ︸
                                                         
                                                      
                                                   
                                                   
                                                      linear space of length
                                                      
                                                      M
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    2: for all 
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             T
                                          
                                        
                                       do
                                    
                                 
                                 
                                    3: 
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   s
                                                   ,
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             (
                                             x
                                             )
                                             ←
                                             0
                                          
                                       
                                    
                                 
                                 
                                    4: 
                                       
                                          
                                             C
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             ←
                                             false
                                          
                                       
                                    
                                 
                                 
                                    5: end for
                                    
                                 
                                 
                                    6: 
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   samples
                                                
                                             
                                             ←
                                             0
                                          
                                       
                                    
                                 
                                 
                                    7: repeat
                                    
                                 
                                 
                                    8: 
                                       while 
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   samples
                                                
                                             
                                             mod
                                             
                                             100
                                             N
                                             
                                             ≠
                                             
                                             0
                                          
                                        
                                       do
                                    
                                 
                                 
                                    9: Randomly select 
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       , a set of 6 point-matches 
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    10: 
                                       
                                          
                                             
                                                
                                                   Δ
                                                
                                                
                                                   k
                                                
                                                
                                                   j
                                                
                                             
                                             ←
                                             
                                                
                                                   λ
                                                
                                                
                                                   k
                                                   1
                                                
                                                
                                                   j
                                                
                                             
                                             -
                                             
                                                
                                                   λ
                                                
                                                
                                                   k
                                                   2
                                                
                                                
                                                   j
                                                
                                             
                                          
                                        for 
                                          
                                             j
                                             =
                                             1
                                             …
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               6
                                                            
                                                         
                                                         
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       , representing each pencil of planes defined by 
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    11: 
                                       
                                          
                                             s
                                             (
                                             
                                                
                                                   Q
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             F
                                             )
                                             ←
                                             
                                                
                                                   Δ
                                                
                                                
                                                   k
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       , where 
                                          
                                             j
                                             =
                                             
                                                
                                                   
                                                      maximiser
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                      …
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        6
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             (
                                             |
                                             
                                                
                                                   Δ
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             )
                                          
                                       
                                    
                                 
                                 
                                    12: 
                                       for all 
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             
                                                
                                                   Q
                                                
                                                
                                                   k
                                                
                                             
                                          
                                        
                                       do
                                    
                                 
                                 
                                    13: 
                                       
                                       for 
                                       
                                          
                                             m
                                             ←
                                             1
                                             …
                                             M
                                          
                                        
                                       do
                                    
                                 
                                 
                                    14: 
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   s
                                                   ,
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             [
                                             m
                                             ]
                                             ←
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   s
                                                   ,
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             [
                                             m
                                             ]
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         2
                                                         π
                                                      
                                                   
                                                   N
                                                
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                         -
                                                         s
                                                         (
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         ,
                                                         F
                                                         )
                                                      
                                                      
                                                         2
                                                         b
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    15: 
                                       
                                       end for
                                    
                                 
                                 
                                    16: 
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   samples
                                                
                                             
                                             ←
                                             
                                                
                                                   n
                                                
                                                
                                                   samples
                                                
                                             
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 
                                    17: 
                                       end for
                                    
                                 
                                 
                                    18: 
                                       end while
                                    
                                 
                                 
                                    19: 
                                       for all 
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                          
                                        
                                       do
                                    
                                 
                                 
                                    20: 
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   previous
                                                
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             ←
                                             C
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    21: 
                                       end for
                                    
                                 
                                 
                                    22: Employ 2 classes k-means for all 
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   s
                                                   ,
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    23: Assign estimated classes to each 
                                          
                                             C
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    24: until 
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   previous
                                                
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             =
                                             C
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                        for all 
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                          
                                        
                                       or 
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   samples
                                                
                                             
                                             >
                                             
                                                
                                                   n
                                                
                                                
                                                   max
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    25: return 
                                       
                                          
                                             C
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                        for all 
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Let 
                        
                           A
                           ,
                           
                           B
                           ,
                           
                           C
                           ,
                           
                           D
                        
                      be independent stochastic variables, each pair having identical independent rectangular distributions. Specifically:
                        
                           (C.1)
                           
                              
                                 
                                    f
                                 
                                 
                                    A
                                 
                              
                              (
                              a
                              )
                              =
                              
                                 
                                    f
                                 
                                 
                                    B
                                 
                              
                              (
                              b
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                if
                                                
                                                x
                                                ⩽
                                                0
                                                
                                                or
                                                
                                                x
                                                ⩾
                                                1
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                if
                                                
                                                0
                                                <
                                                x
                                                <
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (C.2)
                           
                              
                                 
                                    f
                                 
                                 
                                    C
                                 
                              
                              (
                              c
                              )
                              =
                              
                                 
                                    f
                                 
                                 
                                    D
                                 
                              
                              (
                              d
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                if
                                                
                                                x
                                                ⩽
                                                0
                                                
                                                or
                                                
                                                x
                                                ⩾
                                                ρ
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      ρ
                                                   
                                                
                                             
                                             
                                                if
                                                
                                                0
                                                <
                                                x
                                                <
                                                ρ
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           ρ
                           >
                           1
                        
                     .

We want to calculate the probability density function 
                        
                           
                              
                                 f
                              
                              
                                 X
                              
                           
                           (
                           x
                           )
                        
                      of the cross ratio
                        
                           (C.3)
                           
                              X
                              (
                              A
                              ,
                              B
                              ,
                              C
                              ,
                              D
                              )
                              =
                              
                                 
                                    (
                                    C
                                    -
                                    A
                                    )
                                    (
                                    D
                                    -
                                    B
                                    )
                                 
                                 
                                    (
                                    D
                                    -
                                    A
                                    )
                                    (
                                    C
                                    -
                                    B
                                    )
                                 
                              
                           
                        
                     
                  

Working along the lines of [40], we calculate the ordered probabilities
                        
                           (C.4)
                           
                              1
                              -
                              
                                 
                                    F
                                 
                                 
                                    x
                                    ,ordered
                                 
                              
                              (
                              x
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    p
                                 
                                 
                                    1
                                 
                              
                              <
                              
                                 
                                    p
                                 
                                 
                                    2
                                 
                              
                              <
                              
                                 
                                    p
                                 
                                 
                                    3
                                 
                              
                              <
                              
                                 
                                    p
                                 
                                 
                                    4
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          4
                                       
                                    
                                 
                              
                              )
                           
                        
                     for each of the 24 ordered permutations 
                        
                           
                              
                                 S
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       4
                                    
                                 
                              
                           
                           =
                           {
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                           <
                           
                              
                                 p
                              
                              
                                 2
                              
                           
                           <
                           
                              
                                 p
                              
                              
                                 3
                              
                           
                           <
                           
                              
                                 p
                              
                              
                                 4
                              
                           
                           }
                        
                      of the four points 
                        
                           {
                           A
                           ,
                           B
                           ,
                           C
                           ,
                           D
                           }
                        
                     .
                        
                           (C.5)
                           
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    ABCD
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    BACD
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    ABDC
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    BADC
                                 
                              
                              )
                              =
                              
                                 
                                    P
                                    (
                                    x
                                    <
                                    X
                                    ,
                                    A
                                    <
                                    B
                                    <
                                    C
                                    <
                                    D
                                    )
                                 
                                 
                                    P
                                    (
                                    A
                                    <
                                    B
                                    <
                                    C
                                    <
                                    D
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    x
                                    )
                                 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          24
                                          
                                             
                                                ρ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          ρ
                                          -
                                          1
                                       
                                       
                                          6
                                          
                                             
                                                ρ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                (
                                                ρ
                                                -
                                                1
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          4
                                          
                                             
                                                ρ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (C.6)
                           
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    ACBD
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    BCAD
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    ADBC
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    BDAC
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    CABD
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    CBAD
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    DABC
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    DBAC
                                 
                              
                              )
                              =
                              
                                 
                                    P
                                    (
                                    x
                                    <
                                    X
                                    ,
                                    A
                                    <
                                    C
                                    <
                                    B
                                    <
                                    D
                                    )
                                 
                                 
                                    P
                                    (
                                    A
                                    <
                                    C
                                    <
                                    B
                                    <
                                    D
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    )
                                 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          24
                                          
                                             
                                                ρ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          ρ
                                          -
                                          1
                                       
                                       
                                          6
                                          
                                             
                                                ρ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (C.7)
                           
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    ACDB
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    BCDA
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    ADCB
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    BDCA
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    CDAB
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    CDBA
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    DCAB
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    DCBA
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    CADB
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    CBDA
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    DACB
                                 
                              
                              )
                              =
                              P
                              (
                              x
                              <
                              X
                              |
                              
                                 
                                    S
                                 
                                 
                                    DBCA
                                 
                              
                              )
                              =
                              
                                 
                                    P
                                    (
                                    x
                                    <
                                    X
                                    ,
                                    A
                                    <
                                    C
                                    <
                                    D
                                    <
                                    B
                                    )
                                 
                                 
                                    P
                                    (
                                    A
                                    <
                                    C
                                    <
                                    D
                                    <
                                    B
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    x
                                    )
                                 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          24
                                          
                                             
                                                ρ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Due to the ordering, there are only three different cases among the 24. Denoting the four points 
                        
                           {
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 4
                              
                           
                           }
                        
                      by vector 
                        
                           
                              
                                 S
                              
                              
                                 →
                              
                           
                        
                     , each one of the joint probabilities 
                        
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           ,
                           
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           ,
                           
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                        
                      can be estimated according to the definition:
                        
                           (C.8)
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              (
                              x
                              )
                              =
                              
                                 ∫
                                 
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          →
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    S
                                 
                                 
                                    →
                                 
                              
                              )
                              d
                              
                                 
                                    S
                                 
                                 
                                    →
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                        
                      define the following spaces:
                        
                           
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                              =
                              {
                              
                                 
                                    S
                                 
                                 
                                    →
                                 
                              
                              =
                              {
                              a
                              ,
                              b
                              ,
                              c
                              ,
                              d
                              }
                              |
                              X
                              (
                              a
                              ,
                              b
                              ,
                              c
                              ,
                              d
                              )
                              >
                              x
                              ,
                              0
                              <
                              a
                              <
                              b
                              <
                              c
                              <
                              d
                              <
                              ρ
                              ,
                              a
                              <
                              1
                              ,
                              b
                              <
                              1
                              }
                              =
                              {
                              (
                              a
                              ,
                              b
                              ,
                              c
                              ,
                              d
                              )
                              |
                              X
                              (
                              a
                              ,
                              b
                              ,
                              c
                              ,
                              d
                              )
                              >
                              x
                              ,
                              0
                              <
                              a
                              <
                              b
                              <
                              c
                              <
                              d
                              <
                              1
                              }
                              ∪
                              {
                              (
                              a
                              ,
                              b
                              ,
                              c
                              ,
                              d
                              )
                              |
                              X
                              (
                              a
                              ,
                              b
                              ,
                              c
                              ,
                              d
                              )
                              >
                              x
                              ,
                              0
                              <
                              a
                              <
                              b
                              <
                              c
                              <
                              1
                              <
                              d
                              <
                              ρ
                              }
                              ∪
                              {
                              (
                              a
                              ,
                              b
                              ,
                              c
                              ,
                              d
                              )
                              |
                              X
                              (
                              a
                              ,
                              b
                              ,
                              c
                              ,
                              d
                              )
                              >
                              x
                              ,
                              0
                              <
                              a
                              <
                              b
                              <
                              1
                              <
                              c
                              <
                              d
                              <
                              ρ
                              }
                              =
                              
                                 
                                    M
                                 
                                 
                                    A
                                 
                              
                              ∪
                              
                                 
                                    M
                                 
                                 
                                    B
                                 
                              
                              ∪
                              
                                 
                                    M
                                 
                                 
                                    C
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                              
                              =
                              {
                              
                                 
                                    S
                                 
                                 
                                    →
                                 
                              
                              {
                              a
                              ,
                              c
                              ,
                              b
                              ,
                              d
                              }
                              |
                              X
                              (
                              a
                              ,
                              c
                              ,
                              b
                              ,
                              d
                              )
                              >
                              x
                              ,
                              0
                              <
                              a
                              <
                              c
                              <
                              b
                              <
                              d
                              <
                              ρ
                              ,
                              a
                              <
                              1
                              ,
                              b
                              <
                              1
                              }
                              =
                              {
                              (
                              a
                              ,
                              c
                              ,
                              b
                              ,
                              d
                              )
                              |
                              X
                              (
                              a
                              ,
                              c
                              ,
                              b
                              ,
                              d
                              )
                              >
                              x
                              ,
                              0
                              <
                              a
                              <
                              c
                              <
                              b
                              <
                              d
                              <
                              1
                              }
                              ∪
                              {
                              (
                              a
                              ,
                              c
                              ,
                              b
                              ,
                              d
                              )
                              |
                              X
                              (
                              a
                              ,
                              c
                              ,
                              b
                              ,
                              d
                              )
                              >
                              x
                              ,
                              0
                              <
                              a
                              <
                              c
                              <
                              b
                              <
                              1
                              <
                              d
                              <
                              ρ
                              }
                              =
                              
                                 
                                    M
                                 
                                 
                                    D
                                 
                              
                              ∪
                              
                                 
                                    M
                                 
                                 
                                    E
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    M
                                 
                                 
                                    3
                                 
                              
                              =
                              {
                              
                                 
                                    S
                                 
                                 
                                    →
                                 
                              
                              {
                              a
                              ,
                              c
                              ,
                              d
                              ,
                              b
                              }
                              |
                              X
                              (
                              a
                              ,
                              c
                              ,
                              d
                              ,
                              b
                              )
                              >
                              x
                              ,
                              0
                              <
                              a
                              <
                              c
                              <
                              d
                              <
                              b
                              <
                              1
                              }
                              =
                              
                                 
                                    M
                                 
                                 
                                    F
                                 
                              
                           
                        
                     
                  

Although the order of the variables a, b, c, d is different, regions 
                        
                           
                              
                                 M
                              
                              
                                 A
                              
                           
                           ,
                           
                           
                              
                                 M
                              
                              
                                 D
                              
                           
                        
                      and 
                        
                           
                              
                                 M
                              
                              
                                 F
                              
                           
                        
                      are subject to similar analysis, as well as 
                        
                           
                              
                                 M
                              
                              
                                 B
                              
                           
                        
                      and 
                        
                           
                              
                                 M
                              
                              
                                 E
                              
                           
                        
                     . We will thus only calculate the regions 
                        
                           
                              
                                 M
                              
                              
                                 A
                              
                           
                           ,
                           
                           
                              
                                 M
                              
                              
                                 B
                              
                           
                        
                      and 
                        
                           
                              
                                 M
                              
                              
                                 C
                              
                           
                        
                      and deal with the permutations in a subsequent step.

We obtain the boundaries of 
                           
                              
                                 
                                    M
                                 
                                 
                                    A
                                 
                              
                              ,
                              
                              
                                 
                                    M
                                 
                                 
                                    B
                                 
                              
                           
                         and 
                           
                              
                                 
                                    M
                                 
                                 
                                    C
                                 
                              
                           
                         after studying the properties of Eq. (C.3) as a multivariate function and taking into account the ordering and the different ranges of the points:
                           
                              (C.9)
                              
                                 
                                    
                                       M
                                    
                                    
                                       A
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                →
                                             
                                          
                                          =
                                          {
                                          a
                                          ,
                                          b
                                          ,
                                          c
                                          ,
                                          d
                                          }
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            0
                                                            <
                                                            d
                                                            <
                                                            1
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                            <
                                                            c
                                                            <
                                                            d
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  cd
                                                                  (
                                                                  x
                                                                  -
                                                                  1
                                                                  )
                                                               
                                                               
                                                                  xd
                                                                  -
                                                                  c
                                                               
                                                            
                                                            <
                                                            b
                                                            <
                                                            c
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                            <
                                                            a
                                                            <
                                                            
                                                               
                                                                  c
                                                                  (
                                                                  b
                                                                  -
                                                                  d
                                                                  )
                                                                  +
                                                                  xd
                                                                  (
                                                                  c
                                                                  -
                                                                  b
                                                                  )
                                                               
                                                               
                                                                  b
                                                                  -
                                                                  d
                                                                  +
                                                                  x
                                                                  (
                                                                  c
                                                                  -
                                                                  b
                                                                  )
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (C.10)
                              
                                 
                                    
                                       M
                                    
                                    
                                       B
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                →
                                             
                                          
                                          =
                                          {
                                          a
                                          ,
                                          b
                                          ,
                                          c
                                          ,
                                          d
                                          }
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            <
                                                            d
                                                            <
                                                            ρ
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                            <
                                                            c
                                                            <
                                                            1
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  cd
                                                                  (
                                                                  x
                                                                  -
                                                                  1
                                                                  )
                                                               
                                                               
                                                                  xd
                                                                  -
                                                                  c
                                                               
                                                            
                                                            <
                                                            b
                                                            <
                                                            c
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                            <
                                                            a
                                                            <
                                                            
                                                               
                                                                  c
                                                                  (
                                                                  b
                                                                  -
                                                                  d
                                                                  )
                                                                  +
                                                                  xd
                                                                  (
                                                                  c
                                                                  -
                                                                  b
                                                                  )
                                                               
                                                               
                                                                  b
                                                                  -
                                                                  d
                                                                  +
                                                                  x
                                                                  (
                                                                  c
                                                                  -
                                                                  b
                                                                  )
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (C.11)
                              
                                 
                                    
                                       M
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                →
                                             
                                          
                                          =
                                          {
                                          a
                                          ,
                                          b
                                          ,
                                          c
                                          ,
                                          d
                                          }
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            <
                                                            d
                                                            <
                                                            ρ
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            1
                                                            <
                                                            c
                                                            <
                                                            
                                                               
                                                                  xd
                                                               
                                                               
                                                                  1
                                                                  +
                                                                  d
                                                                  (
                                                                  x
                                                                  -
                                                                  1
                                                                  )
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  cd
                                                                  (
                                                                  x
                                                                  -
                                                                  1
                                                                  )
                                                               
                                                               
                                                                  xd
                                                                  -
                                                                  c
                                                               
                                                            
                                                            <
                                                            b
                                                            <
                                                            1
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                            <
                                                            a
                                                            <
                                                            
                                                               
                                                                  c
                                                                  (
                                                                  b
                                                                  -
                                                                  d
                                                                  )
                                                                  +
                                                                  xd
                                                                  (
                                                                  c
                                                                  -
                                                                  b
                                                                  )
                                                               
                                                               
                                                                  b
                                                                  -
                                                                  d
                                                                  +
                                                                  x
                                                                  (
                                                                  c
                                                                  -
                                                                  b
                                                                  )
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

By substituting these regions in Eq. (C.8), we have:
                           
                              (C.12)
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             M
                                          
                                          
                                             A
                                          
                                       
                                       ∪
                                       
                                          
                                             M
                                          
                                          
                                             B
                                          
                                       
                                       ∪
                                       
                                          
                                             M
                                          
                                          
                                             C
                                          
                                       
                                    
                                 
                                 f
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       S
                                    
                                    
                                       →
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             M
                                          
                                          
                                             A
                                          
                                       
                                       ∪
                                       
                                          
                                             M
                                          
                                          
                                             B
                                          
                                       
                                       ∪
                                       
                                          
                                             M
                                          
                                          
                                             C
                                          
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 d
                                 
                                    
                                       S
                                    
                                    
                                       →
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ∫
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      A
                                                   
                                                
                                             
                                          
                                          d
                                          
                                             
                                                S
                                             
                                             
                                                →
                                             
                                          
                                          +
                                          
                                             ∫
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      B
                                                   
                                                
                                             
                                          
                                          d
                                          
                                             
                                                S
                                             
                                             
                                                →
                                             
                                          
                                          +
                                          
                                             ∫
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      C
                                                   
                                                
                                             
                                          
                                          d
                                          
                                             
                                                S
                                             
                                             
                                                →
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       A
                                    
                                 
                                 (
                                 x
                                 )
                                 +
                                 
                                    
                                       P
                                    
                                    
                                       B
                                    
                                 
                                 (
                                 x
                                 )
                                 +
                                 
                                    
                                       P
                                    
                                    
                                       C
                                    
                                 
                                 (
                                 x
                                 )
                              
                           
                        
                        
                           
                              (C.13)
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       A
                                    
                                 
                                 (
                                 x
                                 )
                                 +
                                 
                                    
                                       P
                                    
                                    
                                       B
                                    
                                 
                                 (
                                 x
                                 )
                              
                           
                        
                        
                           
                              (C.14)
                              
                                 
                                    
                                       P
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       A
                                    
                                 
                                 (
                                 x
                                 )
                              
                           
                        
                        
                           
                              (C.15)
                              
                                 
                                    
                                       P
                                    
                                    
                                       A
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       24
                                       
                                          
                                             ρ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          2
                                          x
                                          (
                                          x
                                          -
                                          1
                                          )
                                          ln
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         -
                                                         1
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          2
                                          x
                                          -
                                          1
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (C.16)
                              
                                 
                                    
                                       P
                                    
                                    
                                       B
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       24
                                       
                                          
                                             ρ
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       -
                                       2
                                       x
                                       +
                                       1
                                       )
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   ln
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  ρ
                                                               
                                                               
                                                                  x
                                                                  ρ
                                                                  -
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   ln
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  -
                                                                  1
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          (
                                          2
                                          
                                             
                                                x
                                             
                                             
                                                6
                                             
                                          
                                          -
                                          6
                                          
                                             
                                                x
                                             
                                             
                                                5
                                             
                                          
                                          +
                                          6
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          )
                                          -
                                          2
                                          (
                                          
                                             
                                                ρ
                                             
                                             
                                                3
                                             
                                          
                                          -
                                          1
                                          )
                                          
                                             
                                                x
                                             
                                             
                                                5
                                             
                                          
                                          +
                                          (
                                          6
                                          
                                             
                                                ρ
                                             
                                             
                                                3
                                             
                                          
                                          -
                                          
                                             
                                                ρ
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          5
                                          )
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          -
                                          2
                                          
                                             
                                                
                                                   2
                                                   (
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   -
                                                   ρ
                                                   -
                                                   1
                                                   )
                                                   +
                                                   (
                                                   8
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   -
                                                   12
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   8
                                                   ρ
                                                   )
                                                   ln
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  ρ
                                                                  -
                                                                  x
                                                               
                                                               
                                                                  x
                                                                  ρ
                                                                  -
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   -
                                                   2
                                                   ln
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  (
                                                                  ρ
                                                                  -
                                                                  1
                                                                  )
                                                               
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        x
                                                                        -
                                                                        1
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   -
                                                   2
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   ln
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ρ
                                                                  -
                                                                  1
                                                               
                                                               
                                                                  ρ
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          (
                                          5
                                          
                                             
                                                ρ
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          2
                                          ρ
                                          -
                                          3
                                          )
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          (
                                          2
                                          ρ
                                          -
                                          2
                                          )
                                          x
                                          +
                                          ln
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         -
                                                         1
                                                      
                                                      
                                                         x
                                                         ρ
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          (
                                          6
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          6
                                          x
                                          +
                                          2
                                          )
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (C.17)
                              
                                 
                                    
                                       P
                                    
                                    
                                       C
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 -
                                 
                                    
                                       1
                                    
                                    
                                       12
                                       
                                          
                                             ρ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                -
                                                2
                                                
                                                x
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                4
                                             
                                          
                                          
                                          ln
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         1
                                                         +
                                                         ρ
                                                         x
                                                         -
                                                         ρ
                                                         )
                                                         (
                                                         ρ
                                                         x
                                                         -
                                                         1
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               ρ
                                                            
                                                         
                                                         x
                                                         (
                                                         x
                                                         -
                                                         1
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                   +
                                                   3
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 3
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       4
                                    
                                 
                                 ln
                                 
                                    
                                       x
                                       (
                                       x
                                       -
                                       1
                                       )
                                       
                                          
                                             ρ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       (
                                       1
                                       +
                                       ρ
                                       x
                                       -
                                       ρ
                                       )
                                       (
                                       -
                                       1
                                       +
                                       ρ
                                       x
                                       )
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       5
                                    
                                 
                                 +
                                 2
                                 
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                3
                                             
                                          
                                          -
                                          
                                             
                                                ρ
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          ln
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         -
                                                         1
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          (
                                          2
                                          
                                          
                                             
                                                ρ
                                             
                                             
                                                3
                                             
                                          
                                          -
                                          3
                                          
                                          
                                             
                                                ρ
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          2
                                          
                                          ρ
                                          )
                                          ln
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         (
                                                         1
                                                         +
                                                         ρ
                                                         x
                                                         -
                                                         ρ
                                                         )
                                                      
                                                      
                                                         (
                                                         x
                                                         -
                                                         1
                                                         )
                                                         (
                                                         ρ
                                                         x
                                                         -
                                                         1
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                ρ
                                             
                                             
                                                4
                                             
                                          
                                          
                                          ln
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                         +
                                                         ρ
                                                         x
                                                         -
                                                         ρ
                                                      
                                                      
                                                         ρ
                                                         (
                                                         x
                                                         -
                                                         1
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 (
                                 
                                    
                                       ρ
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 
                                    
                                       ρ
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 2
                                 (
                                 2
                                 
                                    
                                       ρ
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 
                                    
                                       ρ
                                    
                                    
                                       3
                                    
                                 
                                 -
                                 2
                                 
                                 ρ
                                 +
                                 1
                                 )
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 (
                                 
                                    
                                       ρ
                                    
                                    
                                       3
                                    
                                 
                                 -
                                 3
                                 
                                    
                                       ρ
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 4
                                 
                                 ρ
                                 -
                                 2
                                 )
                                 x
                                 +
                                 (
                                 3
                                 
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 3
                                 
                                 x
                                 +
                                 1
                                 )
                                 ln
                                 
                                    
                                       
                                          
                                             
                                                (
                                                -
                                                1
                                                +
                                                ρ
                                                x
                                                )
                                                (
                                                1
                                                +
                                                ρ
                                                x
                                                -
                                                ρ
                                                )
                                             
                                             
                                                
                                                   
                                                      x
                                                      -
                                                      1
                                                   
                                                
                                                (
                                                ρ
                                                -
                                                1
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   -
                                                   4
                                                   
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   +
                                                   6
                                                   
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   -
                                                   4
                                                   
                                                   ρ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   3
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   -
                                                   3
                                                   
                                                   x
                                                   +
                                                   1
                                                
                                             
                                          
                                          ln
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                         +
                                                         ρ
                                                         x
                                                         -
                                                         ρ
                                                      
                                                      
                                                         (
                                                         ρ
                                                         -
                                                         1
                                                         )
                                                         (
                                                         x
                                                         -
                                                         1
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The graphs for 
                           
                              
                                 
                                    P
                                 
                                 
                                    A
                                 
                              
                              (
                              x
                              )
                              ,
                              
                              
                                 
                                    P
                                 
                                 
                                    B
                                 
                              
                              (
                              x
                              )
                              ,
                              
                              
                                 
                                    P
                                 
                                 
                                    C
                                 
                              
                              (
                              x
                              )
                           
                         assuming 
                           
                              ρ
                              =
                              2
                           
                         are shown in Fig. C.17
                        .

We can now substitute 
                           
                              
                                 
                                    P
                                 
                                 
                                    A
                                 
                              
                              ,
                              
                              
                                 
                                    P
                                 
                                 
                                    B
                                 
                              
                              ,
                              
                              
                                 
                                    P
                                 
                                 
                                    C
                                 
                              
                           
                         in (C.12)–(C.14), and subsequently 
                           
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                           
                         in (C.5–C.7). After taking the derivatives with respect to x for each of the 3 cases of ordered points we come up with the following distribution functions:
                           
                              (C.18)
                              
                                 
                                    
                                       f
                                    
                                    
                                       X
                                       ,ordered
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 -
                                 
                                    
                                       
                                          
                                             
                                                
                                                   dP
                                                
                                                
                                                   A
                                                
                                             
                                             (
                                             x
                                             )
                                          
                                          
                                             dx
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   dP
                                                
                                                
                                                   B
                                                
                                             
                                             (
                                             x
                                             )
                                          
                                          
                                             dx
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   dP
                                                
                                                
                                                   C
                                                
                                             
                                             (
                                             x
                                             )
                                          
                                          
                                             dx
                                          
                                       
                                    
                                    
                                       
                                          
                                             1
                                          
                                          
                                             24
                                             
                                                
                                                   ρ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             ρ
                                             -
                                             1
                                          
                                          
                                             6
                                             
                                                
                                                   ρ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   (
                                                   ρ
                                                   -
                                                   1
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             4
                                             
                                                
                                                   ρ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (C.19)
                              
                                 
                                    
                                       f
                                    
                                    
                                       X
                                       ,ordered
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 -
                                 
                                    
                                       
                                          
                                             
                                                
                                                   dP
                                                
                                                
                                                   A
                                                
                                             
                                             (
                                             x
                                             )
                                          
                                          
                                             dx
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   dP
                                                
                                                
                                                   B
                                                
                                             
                                             (
                                             x
                                             )
                                          
                                          
                                             dx
                                          
                                       
                                    
                                    
                                       
                                          
                                             1
                                          
                                          
                                             24
                                             
                                                
                                                   ρ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             ρ
                                             -
                                             1
                                          
                                          
                                             6
                                             
                                                
                                                   ρ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (C.20)
                              
                                 
                                    
                                       f
                                    
                                    
                                       X
                                       ,ordered
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 -
                                 
                                    
                                       
                                          
                                             
                                                
                                                   dP
                                                
                                                
                                                   A
                                                
                                             
                                             (
                                             x
                                             )
                                          
                                          
                                             dx
                                          
                                       
                                    
                                    
                                       
                                          
                                             1
                                          
                                          
                                             24
                                             
                                                
                                                   ρ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The cross ratio for an ordered four point configuration 
                           
                              λ
                              (
                              a
                              ,
                              b
                              ,
                              c
                              ,
                              d
                              )
                           
                         is related in a simple way to the cross ratio of all permutations of the points. The 24 permutations can be divided into 6 groups of 4 each. In each such group the cross ratio of the permuted points is obtained from the cross ratio of the ordered points by one of the following functions:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                1
                                             
                                          
                                          :
                                          (
                                          1
                                          ,
                                          ∞
                                          )
                                          →
                                          (
                                          1
                                          ,
                                          ∞
                                          )
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          x
                                          )
                                          =
                                          x
                                       
                                    
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                2
                                             
                                          
                                          :
                                          (
                                          1
                                          ,
                                          ∞
                                          )
                                          →
                                          (
                                          1
                                          ,
                                          ∞
                                          )
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          x
                                          )
                                          =
                                          1
                                          +
                                          1
                                          /
                                          (
                                          x
                                          -
                                          1
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                3
                                             
                                          
                                          :
                                          (
                                          0
                                          ,
                                          1
                                          )
                                          →
                                          (
                                          1
                                          ,
                                          ∞
                                          )
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                3
                                             
                                          
                                          (
                                          x
                                          )
                                          =
                                          1
                                          /
                                          x
                                       
                                    
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                4
                                             
                                          
                                          :
                                          (
                                          0
                                          ,
                                          1
                                          )
                                          →
                                          (
                                          1
                                          ,
                                          ∞
                                          )
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                4
                                             
                                          
                                          (
                                          x
                                          )
                                          =
                                          1
                                          -
                                          1
                                          /
                                          x
                                       
                                    
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                5
                                             
                                          
                                          :
                                          (
                                          -
                                          ∞
                                          ,
                                          0
                                          )
                                          →
                                          (
                                          1
                                          ,
                                          ∞
                                          )
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                5
                                             
                                          
                                          (
                                          x
                                          )
                                          =
                                          1
                                          -
                                          x
                                       
                                    
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                6
                                             
                                          
                                          :
                                          (
                                          -
                                          ∞
                                          ,
                                          0
                                          )
                                          →
                                          (
                                          1
                                          ,
                                          ∞
                                          )
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                6
                                             
                                          
                                          (
                                          x
                                          )
                                          =
                                          1
                                          /
                                          (
                                          1
                                          -
                                          x
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

The next step is to assign the corresponding function to each one of the 24 permutations and calculate the transformed probability density functions. The relations of the permuted points to the arbitrarily chosen basis order of 
                           
                              {
                              a
                              ,
                              b
                              ,
                              c
                              ,
                              d
                              }
                           
                         is:
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 X
                                 (
                                 d
                                 ,
                                 c
                                 ,
                                 b
                                 ,
                                 a
                                 )
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 X
                                 (
                                 c
                                 ,
                                 d
                                 ,
                                 a
                                 ,
                                 b
                                 )
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 X
                                 (
                                 b
                                 ,
                                 a
                                 ,
                                 d
                                 ,
                                 c
                                 )
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 X
                                 (
                                 a
                                 ,
                                 b
                                 ,
                                 c
                                 ,
                                 d
                                 )
                                 )
                                 =
                                 X
                                 (
                                 a
                                 ,
                                 b
                                 ,
                                 c
                                 ,
                                 d
                                 )
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 X
                                 (
                                 d
                                 ,
                                 a
                                 ,
                                 b
                                 ,
                                 c
                                 )
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 X
                                 (
                                 c
                                 ,
                                 b
                                 ,
                                 a
                                 ,
                                 d
                                 )
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 X
                                 (
                                 b
                                 ,
                                 c
                                 ,
                                 d
                                 ,
                                 a
                                 )
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 X
                                 (
                                 a
                                 ,
                                 d
                                 ,
                                 c
                                 ,
                                 b
                                 )
                                 )
                                 =
                                 X
                                 (
                                 a
                                 ,
                                 b
                                 ,
                                 c
                                 ,
                                 d
                                 )
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 X
                                 (
                                 d
                                 ,
                                 c
                                 ,
                                 a
                                 ,
                                 b
                                 )
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 X
                                 (
                                 c
                                 ,
                                 d
                                 ,
                                 b
                                 ,
                                 a
                                 )
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 X
                                 (
                                 b
                                 ,
                                 a
                                 ,
                                 c
                                 ,
                                 d
                                 )
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 X
                                 (
                                 a
                                 ,
                                 b
                                 ,
                                 d
                                 ,
                                 c
                                 )
                                 )
                                 =
                                 X
                                 (
                                 a
                                 ,
                                 b
                                 ,
                                 c
                                 ,
                                 d
                                 )
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       4
                                    
                                 
                                 (
                                 X
                                 (
                                 d
                                 ,
                                 b
                                 ,
                                 a
                                 ,
                                 c
                                 )
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       4
                                    
                                 
                                 (
                                 X
                                 (
                                 c
                                 ,
                                 a
                                 ,
                                 b
                                 ,
                                 d
                                 )
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       4
                                    
                                 
                                 (
                                 X
                                 (
                                 b
                                 ,
                                 d
                                 ,
                                 c
                                 ,
                                 a
                                 )
                                 )
                                 
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       4
                                    
                                 
                                 (
                                 X
                                 (
                                 a
                                 ,
                                 c
                                 ,
                                 d
                                 ,
                                 b
                                 )
                                 )
                                 =
                                 X
                                 (
                                 a
                                 ,
                                 b
                                 ,
                                 c
                                 ,
                                 d
                                 )
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       5
                                    
                                 
                                 (
                                 X
                                 (
                                 d
                                 ,
                                 b
                                 ,
                                 c
                                 ,
                                 a
                                 )
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       5
                                    
                                 
                                 (
                                 X
                                 (
                                 c
                                 ,
                                 a
                                 ,
                                 d
                                 ,
                                 b
                                 )
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       5
                                    
                                 
                                 (
                                 X
                                 (
                                 b
                                 ,
                                 d
                                 ,
                                 a
                                 ,
                                 c
                                 )
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       5
                                    
                                 
                                 (
                                 X
                                 (
                                 a
                                 ,
                                 c
                                 ,
                                 b
                                 ,
                                 d
                                 )
                                 )
                                 =
                                 X
                                 (
                                 a
                                 ,
                                 b
                                 ,
                                 c
                                 ,
                                 d
                                 )
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       6
                                    
                                 
                                 (
                                 X
                                 (
                                 d
                                 ,
                                 a
                                 ,
                                 c
                                 ,
                                 b
                                 )
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       6
                                    
                                 
                                 (
                                 X
                                 (
                                 c
                                 ,
                                 b
                                 ,
                                 d
                                 ,
                                 a
                                 )
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       6
                                    
                                 
                                 (
                                 X
                                 (
                                 b
                                 ,
                                 c
                                 ,
                                 a
                                 ,
                                 d
                                 )
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       6
                                    
                                 
                                 (
                                 X
                                 (
                                 a
                                 ,
                                 d
                                 ,
                                 b
                                 ,
                                 c
                                 )
                                 )
                                 =
                                 X
                                 (
                                 a
                                 ,
                                 b
                                 ,
                                 c
                                 ,
                                 d
                                 )
                              
                           
                        
                     

After some substitutions and simplifications, we finally have for the PDF of the unordered points:
                           
                              (C.21)
                              
                                 
                                    
                                       f
                                    
                                    
                                       X
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       2
                                    
                                    
                                       
                                          
                                             1
                                          
                                          
                                             24
                                             
                                                
                                                   ρ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             ρ
                                             -
                                             1
                                          
                                          
                                             6
                                             
                                                
                                                   ρ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   (
                                                   ρ
                                                   -
                                                   1
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             4
                                             
                                                
                                                   ρ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                          ,
                                          3
                                       
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       X
                                       ,ordered
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 (
                                 x
                                 )
                                 )
                                 
                                    
                                       
                                          
                                             
                                                d
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                dx
                                             
                                          
                                          (
                                          x
                                          )
                                       
                                    
                                 
                                 +
                                 
                                    
                                       2
                                    
                                    
                                       
                                          
                                             1
                                          
                                          
                                             24
                                             
                                                
                                                   ρ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             ρ
                                             -
                                             1
                                          
                                          
                                             6
                                             
                                                
                                                   ρ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          2
                                          ,
                                          4
                                          ,
                                          5
                                          ,
                                          6
                                       
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       X
                                       ,ordered
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 (
                                 x
                                 )
                                 )
                                 
                                    
                                       
                                          
                                             
                                                d
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                dx
                                             
                                          
                                          (
                                          x
                                          )
                                       
                                    
                                 
                                 +
                                 
                                    
                                       2
                                    
                                    
                                       
                                          
                                             1
                                          
                                          
                                             24
                                             
                                                
                                                   ρ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          6
                                       
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       X
                                       ,
                                       
                                       ordered
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 (
                                 x
                                 )
                                 )
                                 
                                    
                                       
                                          
                                             
                                                d
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                dx
                                             
                                          
                                          (
                                          x
                                          )
                                       
                                    
                                 
                                 =
                                 -
                                 2
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                          ,
                                          3
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             dP
                                          
                                          
                                             C
                                          
                                       
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             i
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       (
                                       x
                                       )
                                       )
                                    
                                    
                                       dx
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                d
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                dx
                                             
                                          
                                          (
                                          x
                                          )
                                       
                                    
                                 
                                 -
                                 2
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          6
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             dP
                                          
                                          
                                             B
                                          
                                       
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             i
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       (
                                       x
                                       )
                                       )
                                    
                                    
                                       dx
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                d
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                dx
                                             
                                          
                                          (
                                          x
                                          )
                                       
                                    
                                 
                                 -
                                 4
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          6
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             dP
                                          
                                          
                                             A
                                          
                                       
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             i
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       (
                                       x
                                       )
                                       )
                                    
                                    
                                       dx
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                d
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                dx
                                             
                                          
                                          (
                                          x
                                          )
                                       
                                    
                                 
                                 =
                                 -
                                 2
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                          ,
                                          3
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             dP
                                          
                                          
                                             C
                                          
                                       
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             i
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       (
                                       x
                                       )
                                       )
                                    
                                    
                                       dx
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                d
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                dx
                                             
                                          
                                          (
                                          x
                                          )
                                       
                                    
                                 
                                 -
                                 2
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          6
                                       
                                    
                                 
                                 
                                    
                                       
                                          2
                                          
                                             
                                                
                                                   
                                                      dP
                                                   
                                                   
                                                      A
                                                   
                                                
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                (
                                                x
                                                )
                                                )
                                             
                                             
                                                dx
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      dP
                                                   
                                                   
                                                      B
                                                   
                                                
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                (
                                                x
                                                )
                                                )
                                             
                                             
                                                dx
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                d
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                dx
                                             
                                          
                                          (
                                          x
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

The resulting closed form expression for 
                           
                              
                                 
                                    f
                                 
                                 
                                    X
                                 
                              
                              (
                              x
                              )
                           
                         is omitted due to its length. In Fig. 3 we show 2 plots of 
                           
                              
                                 
                                    f
                                 
                                 
                                    X
                                 
                              
                              (
                              x
                              )
                           
                         with 
                           
                              ρ
                           
                         found through trial and error, compared to a histogram of experimental data taken from an implementation of our cross-ratio calculation using random points limited in a rectangular frame and both valid and invalid epipoles.

Point m is as argued in Section 3.2.1 distributed uniformly on the projective line in the sense that the angle between its representing ray and the y-axis is also distributed uniformly between 
                        
                           [
                           0
                           ,
                           2
                           π
                           ]
                        
                     . We will express the PDF 
                        
                           
                              
                                 f
                              
                              
                                 θ
                              
                           
                           (
                           x
                           )
                        
                      of its projective parameter along the line defined by the points 
                        
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                           ,
                           
                           
                              
                                 x
                              
                              
                                 4
                              
                           
                        
                      after projection on the normalised image plane.

In Fig. D.18
                      we show for the purposes of visualisation the embedding from 
                        
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                        
                      unto 
                        
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        
                      of a one-dimensional projective space representing the line 
                        
                           (
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 4
                              
                           
                           )
                        
                     . The dashed rays correspond to projective points along it, while the thick line on the top corresponds to some choice of basis or equivalently a choice of the line at infinity. Generally and without additional knowledge, the preferred basis for most calculations in uncalibrated images is the one that expresses points in homogeneous normalised image coordinates, as suggested by [19]. In the figure shown and assuming the image line is expressed by the equation 
                        
                           y
                           =
                           1
                        
                     , the coordinates of the intersection points between this line and the rays representing the projective points are their homogeneous coordinates. All points except the point at infinity on the projective line 
                        
                           (
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 4
                              
                           
                           )
                        
                      can be expressed by a single projective parameter 
                        
                           θ
                        
                      for some fixed basis, which in the case of homogeneous coordinates is just the x-coordinate. We note also that this choice of basis projects points of the line 
                        
                           (
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 4
                              
                           
                           )
                        
                      that lie inside the image frame around the origin.

Let 
                        
                           ϕ
                        
                      be the angular coordinate with respect to the x axis of a point m on the projective line 
                        
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                        
                     . When this point is projected unto 
                        
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                        
                      using the standard basis, then its projective parameter 
                        
                           θ
                        
                      is given by:
                        
                           (D.1)
                           
                              θ
                              (
                              ϕ
                              )
                              =
                              
                                 
                                    cos
                                    (
                                    ϕ
                                    )
                                 
                                 
                                    sin
                                    (
                                    ϕ
                                    )
                                 
                              
                              =
                              cot
                              (
                              ϕ
                              )
                           
                        
                     We assume for the estimation of the PDF that 
                        
                           ϕ
                        
                      is distributed uniformly between 
                        
                           [
                           0
                           ,
                           π
                           ]
                        
                      since the angles between 
                        
                           [
                           π
                           ,
                           2
                           π
                           ]
                        
                      are equiprobable and symmetric.
                        
                           (D.2)
                           
                              ϕ
                              (
                              θ
                              )
                              =
                              
                                 
                                    θ
                                 
                                 
                                    -
                                    1
                                 
                              
                              =
                              arccot
                              (
                              θ
                              )
                           
                        
                     
                     
                        
                           (D.3)
                           
                              
                                 
                                    f
                                 
                                 
                                    θ
                                 
                              
                              (
                              x
                              )
                              =
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ϕ
                                       
                                    
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    (
                                    x
                                    )
                                    )
                                 
                                 
                                    |
                                    
                                       
                                          θ
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    (
                                    x
                                    )
                                    )
                                    |
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ϕ
                                       
                                    
                                    (
                                    ϕ
                                    (
                                    x
                                    )
                                    )
                                 
                                 
                                    |
                                    
                                       
                                          θ
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    ϕ
                                    (
                                    x
                                    )
                                    )
                                    |
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          max
                                       
                                    
                                    -
                                    
                                       
                                          ϕ
                                       
                                       
                                          min
                                       
                                    
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    |
                                    -
                                    1
                                    -
                                    cot
                                    
                                       
                                          (
                                          ϕ
                                          (
                                          x
                                          )
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    |
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    π
                                    -
                                    0
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    1
                                    +
                                    cot
                                    
                                       
                                          (
                                          arccot
                                          (
                                          x
                                          )
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    π
                                    (
                                    1
                                    +
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (D.4)
                           
                              
                                 
                                    f
                                 
                                 
                                    θ
                                 
                              
                              (
                              x
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    π
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             1
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     
                  

This corresponds to a Cauchy distribution and it is shown in Fig. D.18(b). Points m, n (resp. 
                        
                           
                              
                                 m
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 n
                              
                              
                                 ′
                              
                           
                        
                     ) over all possible scenes and epipolar geometries should follow this distribution along the line 
                        
                           (
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 4
                              
                           
                           )
                        
                      (resp. 
                        
                           (
                           
                              
                                 x
                              
                              
                                 3
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 4
                              
                              
                                 ′
                              
                           
                           )
                        
                     ).

@&#REFERENCES@&#

