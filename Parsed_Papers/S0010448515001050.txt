@&#MAIN-TITLE@&#An improved star test for implicit polynomial objects

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A homogeneous star test method for implicit polynomial objects.


                        
                        
                           
                           A linear programming optimization method to improve the efficiency of star test.


                        
                        
                           
                           Comparison of the naive star test and the homogeneous star test using different arithmetic.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Geometric modeling

Implicit objects

Star-shaped

Star test

@&#ABSTRACT@&#


               
               
                  For a given point set, a particular point is called a star if it can see all the boundary points of the set. The star test determines whether a candidate point is a star for a given set. It is a key component of some topology computing algorithms such as Connected components via Interval Analysis (CIA), Homotopy type via Interval Analysis (HIA), etc. Those algorithms decompose the input object using axis-aligned boxes, so that each box is either not intersecting or intersecting with the object and in this later case its center is a star point of the intersection. Graphs or simplicial complexes describing the topology of the objects can be obtained by connecting these star points following different rules. The star test is performed for simple primitive geometric objects, because complex objects can be constructed using Constructive Solid Geometry (CSG), and the star property is preserved via union and intersection. In this paper, we improve the method to perform the test for implicit objects. For a primitive set defined by an implicit polynomial equation, the polynomial is made homogeneous with the introduction of an auxiliary variable, thus the degree of the star condition is reduced. A linear programming optimization is introduced to further improve the performance. Several examples are given to show the experimental results of our method.
               
            

@&#INTRODUCTION@&#

Computing the topology of geometric objects is a fundamental problem in computer aided design (CAD), computer graphics (CG), and robotics. It plays an important role in a lot of geometric computations, such as recognition, feature extraction, simplification, motion planning, etc. Also topological information of objects has a significant impact on classification, indexation, shape description in solid modeling and shape matching.

Several research efforts have been conducted to compute the topology of geometric objects. The Cylindrical Algebraic Decomposition (CADec), due to Collins and its variants  [1–5] decompose a semi-algebraic set into cells and compute its topological properties. CADec is the first method for computing the topology of a semi-algebraic set. This decomposition theoretically solves the piano mover’s problem, i.e.  the motion planning problem. Unfortunately, CADec and its variants rely on Computer Algebra tools with at least exponential cost. Thus roboticians typically prefer probably-approximately-correct (PAC) methods, like the probabilistic roadmap  [6] to solve the motion planning problem. PAC methods are fast but only approximate.

Computing the topology and arrangement of planar algebraic curves has been subject to several studies  [7–9], the output of the proposed methods is a graph homotopic to the input algebraic curve. However, these methods cannot process solid geometric objects.

To preserve the topology in surface extraction, a star-shaped criterion for geometric objects was presented in  [10]. A star is a point which can see all the boundary points of a point set, and the kernel of the set consists of all star points. The star test can be reduced to testing whether the kernel is empty or not, and the kernel of polyhedral primitives can be computed using linear programming. Therefore, the authors suggested to perform a dense tessellation of the original primitive as a pre-processing step. Then an approximate kernel is computed using linear programming. At last, a point in the kernel is selected as the best candidate to perform the star test. However, the method depends on the approximation incurred in tessellation.

Recently, Delanoue et al.  [11,12] proposed two exact algorithms, Connected components via Interval Analysis (CIA) and Homotopy type via Interval Analysis (HIA), resorting to interval analysis. Contrarily to CADec, their methods CIA and HIA are practicable: they only use interval computations and the classical recursive space subdivision  [13]. Two other nice features of their methods is that they consider each geometric primitive independently, and they apply also to non polynomial functions (like 
                        cos
                     , 
                        sin
                     , 
                        exp
                     , 
                        log
                     , etc.). Thus, CIA and HIA can compute topological properties for Constructive Solid Geometry (CSG) shapes easily. In counterpart, for CIA and HIA, the sets, i.e.  the free space for motion planning, must be fat (see  Appendix for the definition); in practice the free space is fat, but if by mistake it is not then the methods detect it. A more serious limitation of CIA and HIA (relatively to CADec) is that they do not take into account objects defined by projections, like extrusions or parametric patches: 
                        
                           P
                        
                        :
                        
                           (
                           u
                           ,
                           v
                           ,
                           w
                           )
                        
                        ∈
                        
                           
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           
                           
                              3
                           
                        
                        →
                        
                           (
                           x
                           ,
                           y
                           ,
                           z
                           )
                        
                        =
                        
                           P
                        
                        
                           (
                           u
                           ,
                           v
                           ,
                           w
                           )
                        
                        ∈
                        
                           
                              R
                           
                           
                              3
                           
                        
                      often met in CAD  [14].

CIA and HIA are important for CAD because they compute and certify topologic properties of input geometric sets and objects. The need for certification (of geometric, or topological, properties of geometric programs) is currently increasing, e.g.  Narkawicz et al. in NASA recently certified the correctness of a geometric software for the detection and avoidance of collisions between airplanes  [15]. In the future, all critical geometric objects and algorithms should be certified with some proof assistant, like Coq or PVS.

We now mention three other potential applications of the star test in CAD. First, variational modeling: the idea is to specify mechanical parts or clearances with geometric constraints (incidences, tangencies, distances, angles), which a solver numerically solves. Unfortunately, topologic constraints like connectedness are not expressible into mathematical equations or inequalities. The solution is to resort to the generate-and-test paradigm of Artificial Intelligence: the solver generates all solutions, connected or not, and then CIA discards non-connected clearances.

Second, CIA and HIA can also apply to the space of feasible configurations or free motions of some given mechanisms, for example composed of articulated bars: is it possible for this flexible mechanism to move continuously from one feasible configuration to another? More generally, HIA can compute homotopy independent cycles, or homotopy independent paths between two given positions in a configuration space.

Third and last, CIA and HIA may help to study the consistence of toleranced Breps. In a nuttshell, each cell (vertex, curve, surface patch) of a toleranced BRep  [16] is attached a tolerance, or thickness. Tolerances were introduced to robustly compute Boolean operations between solids: tolerances fill cracks and can solve inaccuracy issues. Shapiro  [16] suggested that Leray’s nerve theorem may provide a set of local conditions (like contractibility or collapsibility, some of them computable with the star test), which are necessary or sufficient to guarantee that a given toleranced BRep is consistent, for instance that it indeed separates an inside from an outside.

In this paper, we improve the method to perform the star test for geometric objects defined by implicit polynomial equations. We propose several computable and sufficient conditions to prove that a set is empty, to prove that a set is non empty, to prove that a point is a star, to prove that it is not. For implicit polynomial objects, we reduce the degree of the star condition, and compare the proposed method with the method in  [11,12]. Furthermore, we implement the test using interval arithmetic  [17,18] and Bernstein based methods, we then compare their performances.

The rest of the paper is organized as follows: in Section  2, we recall some basic concepts and properties of interval solvers and Bernstein based methods. Then our methods of the star test for implicit objects are introduced in Sections  3 and 4. Experimental results are shown and discussed in Section  5. We conclude the paper in Section  6.

Here we recall some fundamental concepts and propositions  [11,12]. 
                           Definition 1
                           A point 
                                 
                                    s
                                 
                               is a star for a subset 
                                 
                                    X
                                 
                               of an Euclidean space if 
                                 
                                    X
                                 
                               contains all the line segments connecting any of its points and 
                                 
                                    s
                                 
                              .

Given a geometric set 
                           
                              S
                           
                        , the test whether a candidate point 
                           
                              s
                           
                         is a star point of 
                           
                              S
                           
                         is usually called star test. 
                           Definition 2
                           If 
                                 
                                    s
                                 
                               is a star for subset 
                                 
                                    X
                                 
                               of an Euclidean space, one says that 
                                 
                                    X
                                 
                               is star-shaped or 
                                 
                                    s
                                 
                              -star-shaped.


                        
                           Proposition 1
                           
                              Let 
                              
                                 
                                    X
                                 
                               
                              and 
                              
                                 
                                    Y
                                 
                               
                              be two 
                              
                                 
                                    s
                                 
                              
                              -star-shaped sets, then 
                              
                                 
                                    X
                                 
                                 ∩
                                 
                                    Y
                                 
                               
                              and 
                              
                                 
                                    X
                                 
                                 ∪
                                 
                                    Y
                                 
                               
                              are also 
                              
                                 
                                    s
                                 
                              
                              -star-shaped.
                           

For the proof, we refer readers to the reference  [11]. After Proposition 1, the star property is preserved via union and intersection. Thus, it is sufficient for HIA and CIA to consider independently each geometric primitive in the CSG tree. It is a big advantage of these methods that they do not need to compute intersections between geometric primitives, i.e. they avoid the (difficult) boundary evaluation problem   [19–21].

Star test is a key component of some topology computing algorithms such as CIA, HIA, etc. To show the application of the star test, we recall the definition of the HIA algorithm briefly. Let 
                           I
                         be a finite set of integers, 
                           
                              
                                 ∪
                              
                              
                                 i
                                 ∈
                                 I
                              
                           
                           
                              
                                 
                                    S
                                 
                              
                              
                                 i
                              
                           
                           =
                           
                              S
                           
                         is called a finite cover of 
                           
                              S
                           
                        , 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 i
                              
                           
                         are interior disjoint sets. The HIA algorithm computes a finite cover 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 i
                              
                           
                           ,
                           i
                           ∈
                           I
                         of the studied set 
                           
                              S
                           
                         such that 
                           ∀
                           J
                           ⊂
                           I
                           ,
                           
                           
                              
                                 ∩
                              
                              
                                 j
                                 ∈
                                 J
                              
                           
                           
                              
                                 
                                    S
                                 
                              
                              
                                 j
                              
                           
                         is either empty or contractible. It is contractible if it contains a star. The algorithm starts with a given initial box 
                           
                              B
                           
                        , 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 
                                    B
                                 
                              
                              
                                 i
                              
                           
                           ∩
                           
                              S
                           
                        , where 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 i
                              
                           
                         will be sub-boxes of 
                           
                              B
                           
                        . If a box 
                           
                              B
                           
                         such that 
                           
                              B
                           
                           ∩
                           
                              S
                           
                           ≠
                           0̸
                         is not a member of such finite cover, it is subdivided at the center, with a random perturbation, and along the longest edge. The procedure is recursively performed until a cover satisfying the previous condition is found. Let 
                           
                              S
                           
                         be a 
                           d
                         dimensional object, then the studied boxes have dimension 
                           d
                           ,
                           d
                           −
                           1
                           ,
                           …
                           ,
                           0
                        . It may happen that one of the subdivided boxes is smaller than some given threshold 
                           ε
                         and the expected cover is still not reached, then the whole procedure has to be re-run. Usually it is the case when some subdividing (hyper)plane is tangent or almost tangent to the given object. It is claimed that the cover can be found for most fat objects with probability 1  [11,12]. The CIA algorithm is quite similar to the HIA algorithm, more details can be found in  [11,12].


                        Fig. 1
                         illustrates the rule to connect star points of the HIA algorithm in a box: let 
                           
                              S
                           
                         be the object, and 
                           
                              B
                           
                         be the studied box. Point 
                           E
                         is a star for 
                           
                              S
                           
                           ∩
                           
                              B
                           
                        . Point 
                           A
                         is a star for the intersection of 
                           
                              S
                           
                         and the upper edge of 
                           
                              B
                           
                        . Point 
                           B
                         is a star for the intersection of 
                           
                              S
                           
                         and the left edge of 
                           
                              B
                           
                        . Point 
                           D
                         is a star for the intersection of 
                           
                              S
                           
                         and the bottom edge of 
                           
                              B
                           
                        . The intersection of 
                           
                              S
                           
                         and the right edge is empty. Finally, 
                           A
                         (and 
                           C
                        ) are trivial stars for 
                           A
                           ∩
                           
                              S
                           
                         (and 
                           C
                           ∩
                           
                              S
                           
                        ). The simplicial complex homotopic to 
                           
                              S
                           
                           ∩
                           
                              B
                           
                         is also shown, see Fig. 1 right. The maximal simplices are triangles 
                           A
                           B
                           E
                           ,
                           B
                           C
                           E
                           ,
                           C
                           D
                           E
                        . Other simplices of dimension 1 (
                           A
                           B
                           ,
                           B
                           E
                           ,
                           E
                           A
                        , etc.) and dimension 0 (
                           A
                           ,
                           B
                           ,
                           C
                           ,
                           D
                           ,
                           E
                        ) are deduced by inclusion. By definition of a simplicial complex, either two simplices intersect on another simplex of the complex, or they are disjoint.

In Fig. 2
                        , we give a further example of the HIA algorithm. The given object 
                           
                              S
                           
                         is a CSG object, where a small disk is subtracted from a big disk. For each 
                           i
                           ∈
                           I
                           =
                           
                              {
                              0
                              ,
                              …
                              ,
                              5
                              }
                           
                           ,
                           
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         is the center of the box 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 i
                              
                           
                        , and it is a star point of 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 
                                    B
                                 
                              
                              
                                 i
                              
                           
                           ∩
                           
                              S
                           
                        . Further, 
                           ∀
                           J
                           ⊂
                           I
                           ,
                           
                              
                                 ∩
                              
                              
                                 j
                                 ∈
                                 J
                              
                           
                           
                              {
                              
                                 
                                    
                                       B
                                    
                                 
                                 
                                    j
                                 
                              
                              ∩
                              
                                 S
                              
                              }
                           
                         is also star-shaped, the star points are shown. By connecting those star points, a simplicial complex which is homotopic to 
                           
                              S
                           
                         is obtained. More details, examples and applications can be found in Delanoue’s Ph.D. thesis  [22].

For CIA  [11], the rule is simpler: a graph is built instead of a simplicial complex. The vertices of the graph are star points, and the edges connect all neighboring star points. The output graph indicates the connected components of the given objects. Delanoue et al.  [22] use CIA for solving the motion planning problem in Robotics: CIA quickly provides an exact solution, while the probabilistic roadmap is only approximate.

When the CIA and the HIA algorithms  [11,12] consider a too small box 
                           
                              B
                           
                         to test if its center is a star for 
                           
                              B
                           
                           ∩
                           
                              S
                           
                        , the algorithms may fail because either 
                           
                              S
                           
                         is not fat, or 
                           ¬
                           
                              S
                           
                         is not fat, where 
                           ¬
                           
                              S
                           
                         denotes the complement set of 
                           
                              S
                           
                        , see  Appendix.

In this section, we introduce some solvers and arithmetic methods which will be used afterwards.

Interval arithmetic  [17,18] is a method developed for computing bounds on rounding errors and computing enclosures for the image of a box by some mathematical function, and thus developing numerical methods that yield reliable results. The method is also used to reliably solve systems of equations. Variants of interval methods for plotting algebraic curves were compared and discussed  [13].

Interval arithmetic and interval analysis make fully reliable computations possible, there are some limitations however. First, the “wrapping effect” arises. Interval arithmetic losses the dependence between variables. For example, consider 
                              f
                              
                                 (
                                 x
                                 )
                              
                              =
                              x
                              
                                 (
                                 1
                                 −
                                 x
                                 )
                              
                           , and the interval 
                              
                                 X
                              
                              =
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           . Naive interval arithmetic finds that 
                              f
                              
                                 (
                                 
                                    X
                                 
                                 )
                              
                              =
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           . This is correct but over-estimates the exact interval which is 
                              
                                 [
                                 0
                                 ,
                                 1
                                 /
                                 4
                                 ]
                              
                           . Various methods or optimizations (e.g.  resorting to the centered form, exploiting monotonicity) mitigate this phenomenon.

There is a second more fundamental limitation, actually a non computability fact. Interval arithmetic cannot compare two numbers represented with overlapping intervals. Thus interval arithmetic is not sufficient for algorithms of Computational Geometry which need to know the sign, i.e.  negative, positive, zero of geometric predicates (turn left/right/aligned, inCircle/outCircle/onCircle). It is also not sufficient for geometric representations and methods based on boundaries of objects, which occurs when shapes are represented based on their boundary in the Boundary Representation (BRep) model. In this case, algorithms have to decide whether a given point is inside, on, or outside, which is the same inherently intractable, undecidable comparison problem  [23].

Consider the problem of finding a root for 
                              f
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              0
                            in a given box 
                              
                                 B
                              
                           , where 
                              f
                              :
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                              →
                              
                                 
                                    R
                                 
                                 
                                    m
                                 
                              
                           . If 
                              0
                              ∉
                              f
                              
                                 (
                                 
                                    B
                                 
                                 )
                              
                           , then there are no roots of 
                              f
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              0
                            in 
                              
                                 B
                              
                           . Otherwise, 
                              0
                              ∈
                              f
                              
                                 (
                                 
                                    B
                                 
                                 )
                              
                           , the box 
                              
                                 B
                              
                            is reduced with box consistency techniques  [24], or some contraction operators (Krawczyk–Moore operator, Hansen–Sengupta operator, etc.)  [25–27]. For example, given an equation 
                              z
                              =
                              x
                              +
                              y
                           , the simplest box consistency technique which propagates intervals iterates the computations of 
                              
                                 
                                    
                                       z
                                       ←
                                       z
                                       ∩
                                       
                                          (
                                          x
                                          +
                                          y
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       x
                                       ←
                                       x
                                       ∩
                                       
                                          (
                                          z
                                          −
                                          y
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       y
                                       ←
                                       y
                                       ∩
                                       
                                          (
                                          z
                                          −
                                          x
                                          )
                                       
                                       .
                                    
                                 
                              
                            The secant method is a variant of the classical Newton method, where the Jacobian is not updated at each step. For solving a given equation 
                              f
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              0
                           , 
                              f
                              :
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                              →
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           , the secant method computes the fixed-point of 
                              S
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              
                                 x
                              
                              −
                              
                                 
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              f
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                           , where 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    0
                                 
                              
                            is the center of 
                              
                                 B
                              
                           . The interval community proposed several adaptations to interval analysis for the secant method. Krawczyk–Moore operator computes 
                              
                                 B
                              
                              ≔
                              S
                              
                                 (
                                 
                                    B
                                 
                                 )
                              
                              ∩
                              
                                 B
                              
                            iteratively, where 
                              S
                              
                                 (
                                 
                                    B
                                 
                                 )
                              
                            is evaluated with the centered form 
                              S
                              
                                 (
                                 
                                    x
                                 
                                 ∈
                                 
                                    B
                                 
                                 )
                              
                              =
                              S
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    (
                                    
                                       x
                                    
                                    −
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 )
                              
                              ∈
                              S
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              +
                              
                                 
                                    S
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 
                                    B
                                 
                                 )
                              
                              
                                 (
                                 
                                    x
                                 
                                 −
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                           . There are theorems to guarantee existence and uniqueness of a root of the system in a box  [28].

A box which cannot be significantly reduced likely contains more than one root, and it is subdivided. The procedure is stopped when it is proved that the box contains only one regular root (for instance 
                              
                                 ‖
                                 
                                    
                                       S
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    
                                       B
                                    
                                    )
                                 
                                 ‖
                              
                              <
                              1
                            or 
                              S
                              
                                 (
                                 
                                    B
                                 
                                 )
                              
                            is strictly included in 
                              
                                 B
                              
                           , thus the secant map is contractant, and the center of 
                              
                                 B
                              
                            can be used as an initial value for classical Newton–Raphson method), or when the size of 
                              
                                 B
                              
                            is smaller than a given threshold, then the box should be put in a list of residual boxes for which we cannot conclude.

Let 
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                       
                                       
                                          n
                                          −
                                          i
                                       
                                    
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                    i
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    n
                                 
                              
                            be Bernstein polynomials. Any degree 
                              n
                            Bézier curve 
                              f
                              
                                 (
                                 t
                                 )
                              
                            can be expressed as 
                              
                                 
                                    f
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                    0
                                    ≤
                                    t
                                    ≤
                                    1
                                    ,
                                 
                              
                            where 
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                              ,
                              
                              i
                              =
                              0
                              ,
                              …
                              ,
                              n
                            are Bernstein coefficients.

For 
                              t
                            in the interval 
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           , all Bernstein polynomials 
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            are non-negative. Moreover, their sum equals one for each 
                              t
                            in 
                              R
                           , because 
                              
                                 
                                    1
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             t
                                             +
                                             
                                                (
                                                1
                                                −
                                                t
                                                )
                                             
                                             )
                                          
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             (
                                             1
                                             −
                                             t
                                             )
                                          
                                       
                                       
                                          n
                                          −
                                          i
                                       
                                    
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    .
                                 
                              
                            So 
                              f
                              
                                 (
                                 t
                                 )
                              
                            is a linear convex combination of the 
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                           . When each 
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                            lies in 
                              R
                           , 
                              f
                              
                                 (
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 )
                              
                              ⊆
                              
                                 [
                                 min
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 max
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 ]
                              
                           . When each 
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                            lies in 
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           , 
                              f
                              
                                 (
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 )
                              
                            is covered by the convex hull of 
                              
                                 
                                    
                                       {
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    n
                                 
                              
                           . This is usually called the convex hull property. If the parameter domain is not 
                              t
                              ∉
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           , but 
                              t
                              ∈
                              
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 ]
                              
                           , then a re-parametrization 
                              s
                              =
                              
                                 (
                                 t
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              /
                              
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                            is applied and the de Casteljau algorithm can be used for computing Bernstein coefficients of 
                              f
                              
                                 (
                                 s
                                 )
                              
                           . The de Casteljau algorithm is typically used to split the interval 
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                            into two intervals 
                              
                                 [
                                 0
                                 ,
                                 1
                                 /
                                 2
                                 ]
                              
                            and 
                              
                                 [
                                 1
                                 /
                                 2
                                 ,
                                 1
                                 ]
                              
                            in Bernstein solvers.

Multivariate Bernstein bases are obtained with tensor product. For instance, for bivariate polynomial in 
                              u
                            and 
                              v
                           , with degree 
                              m
                            in 
                              u
                            and 
                              n
                            in 
                              v
                           , the Bernstein polynomials are 
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          m
                                          ,
                                          n
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    =
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       v
                                       )
                                    
                                    ,
                                    
                                    i
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    m
                                    ;
                                    
                                    j
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    n
                                    ,
                                 
                              
                            and any bivariate polynomial with bidegree not greater than 
                              
                                 (
                                 m
                                 ,
                                 n
                                 )
                              
                            can be expressed in Bernstein form. The convex hull property also holds for multivariate cases.

Bernstein based methods (methods exploiting properties of the Bernstein polynomials, e.g.  convex hull property, variation diminishing property, de Casteljau subdivision algorithm, etc.) have widespread applications in numerical computation, such as curve/surface approximation and interpolation  [29], root finding  [30], geometric constraint systems solving  [31,32], etc. It is well-known that the de Casteljau algorithm converges much faster than other iterative algorithms. However, the transformation matrix between high-degree canonical power basis and Bernstein basis is ill-conditioned  [33]. Moreover, computing the smallest and the greatest Bernstein coefficients is NP-hard in high dimension, even for multi-linear case. Bernstein polytopes  [34] are proposed to evaluate or solve high dimensional multi-variate systems.

Given a box 
                        
                           B
                        
                        ⊂
                        
                           
                              R
                           
                           
                              d
                           
                        
                     , let 
                        
                           S
                        
                      be an object defined by 
                        f
                        
                           (
                           
                              x
                           
                           )
                        
                        ≤
                        0
                     , where 
                        f
                        :
                        
                           
                              R
                           
                           
                              d
                           
                        
                        →
                        R
                     . The star test is trivial for the case 
                        
                           B
                        
                        ∩
                        
                           S
                        
                        =
                        0̸
                     , and 
                        
                           B
                        
                        ∩
                        
                           S
                        
                      is star-shaped when 
                        
                           B
                        
                        ⊆
                        
                           S
                        
                     . The test whether 
                        
                           B
                        
                        ∩
                        
                           S
                        
                        =
                        0̸
                      is called emptiness test. We introduce a naive method to perform the emptiness test in this section, which is used to facilitate the star test.

For implicit objects, the emptiness test is often decidable using interval arithmetic and subdivision, because we know that 
                        f
                        
                           (
                           
                              B
                           
                           )
                        
                        <
                        0
                      implies 
                        
                           B
                        
                        ⊂
                        
                           S
                        
                     , so 
                        
                           B
                        
                      is covered by 
                        
                           S
                        
                     , and 
                        
                           B
                        
                        ∩
                        
                           S
                        
                      is star-shaped; or 
                        f
                        
                           (
                           
                              B
                           
                           )
                        
                        >
                        0
                      implies 
                        
                           B
                        
                        ∩
                        
                           S
                        
                        =
                        0̸
                     ; otherwise, 
                        0
                        ∈
                        f
                        
                           (
                           
                              B
                           
                           )
                        
                     , further study is needed to get a guaranteed result, which is discussed in Section  4.

Notably, for the last case, whether 
                        
                           B
                        
                        ∩
                        
                           S
                        
                        =
                        0̸
                      can be further studied by evaluating 
                        f
                      on vertices of 
                        
                           B
                        
                     . That is, 
                        
                           B
                        
                        ∩
                        
                           S
                        
                        ≠
                        0̸
                      if there is a vertex 
                        
                           v
                        
                      of 
                        
                           B
                        
                      such that 
                        f
                        
                           (
                           
                              v
                           
                           )
                        
                        <
                        0
                     , this has been used in some surface extraction methods, such as marching cubes algorithm  [35]. Also, in the star test, we need to know whether 
                        
                           B
                        
                        ∩
                        ∂
                        
                           S
                        
                        =
                        0̸
                      or not. If there are vertices 
                        
                           
                              
                                 v
                              
                           
                           
                              1
                           
                        
                     , 
                        
                           
                              
                                 v
                              
                           
                           
                              2
                           
                        
                      of 
                        
                           B
                        
                     , such that 
                        f
                        
                           (
                           
                              
                                 
                                    v
                                 
                              
                              
                                 1
                              
                           
                           )
                        
                        ≤
                        0
                        ≤
                        f
                        
                           (
                           
                              
                                 
                                    v
                                 
                              
                              
                                 2
                              
                           
                           )
                        
                     , then it is proved that 
                        
                           B
                        
                        ∩
                        ∂
                        
                           S
                        
                        ≠
                        0̸
                     . Otherwise, we are unlucky and nothing can be guaranteed because of the lack of accuracy. This kind of boxes most probably is close to the boundary of the object.

As most of the geometric sets are not star-shaped, the test is usually performed for a given set restricted in a studied box  [11,12]. Complex objects can be defined using CSG, and the star property is preserved via Boolean operation. All primitive objects in a CSG tree can be tested independently, which simplifies the algorithm, see Proposition 1. Therefore, in this section, we only focus on the star test for simple primitive objects restricted in a studied box 
                        
                           B
                        
                     , and only for the case when 
                        
                           B
                        
                      probably contains boundary points of the given object, i.e.   
                        0
                        ∈
                        f
                        
                           (
                           
                              B
                           
                           )
                        
                     .

Geometric primitive objects defined by implicit polynomial equations have been extensively used in CAD and CG. For the star test, Delanoue et al.  [11,12] used interval arithmetic to test whether the star condition holds or not. For polynomial functions 
                        f
                     , the efficiency of their algorithm is usually sensitive to the degree of the polynomial equation.

In this section, we recall the naive star test method initially presented in  [11,12]. 
                           Proposition 2
                           
                              Let 
                              
                                 f
                               
                              be a 
                              
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               
                              function from 
                              
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                               
                              to 
                              
                                 R
                              
                              , 
                              
                                 
                                    B
                                 
                                 ⊂
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                               
                              be a convex set, typically an axis aligned box, and 
                              
                                 
                                    S
                                 
                                 =
                                 
                                    {
                                    
                                       x
                                    
                                    ∣
                                    f
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    ≤
                                    0
                                    }
                                 
                              
                              . If there exists 
                              
                                 
                                    s
                                 
                                 ∈
                                 
                                    B
                                 
                                 ∩
                                 
                                    S
                                 
                               
                              such that the contradicting set 
                              
                                 
                                    C
                                 
                               
                              is empty:
                              
                                 
                                    (1)
                                    
                                       
                                          C
                                       
                                       ≔
                                       
                                          {
                                          
                                             x
                                          
                                          ∈
                                          
                                             B
                                          
                                          ∣
                                          f
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          =
                                          0
                                          ,
                                          
                                          ∇
                                          f
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          ⋅
                                          
                                             (
                                             
                                                x
                                             
                                             −
                                             
                                                s
                                             
                                             )
                                          
                                          ≤
                                          0
                                          }
                                       
                                       =
                                       0̸
                                       ,
                                    
                                 
                              
                              then 
                              
                                 
                                    B
                                 
                                 ∩
                                 
                                    S
                                 
                               
                              is 
                              
                                 
                                    s
                                 
                              
                              -star-shaped.
                           

Let 
                           g
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           ∇
                           f
                           
                              (
                              
                                 x
                              
                              )
                           
                           ⋅
                           
                              (
                              
                                 x
                              
                              −
                              
                                 s
                              
                              )
                           
                        . The star test can be performed using interval arithmetic  [11,12] and subdivision. We assume that 
                           
                              s
                           
                         lies in 
                           
                              S
                           
                        , i.e.   
                           f
                           
                              (
                              
                                 s
                              
                              )
                           
                           <
                           0
                        , then 
                           
                              s
                           
                         is a star point for 
                           
                              B
                           
                           ∩
                           
                              S
                           
                         when 
                           
                              (2)
                              
                                 g
                                 
                                    (
                                    
                                       B
                                    
                                    )
                                 
                                 =
                                 ∇
                                 f
                                 
                                    (
                                    
                                       B
                                    
                                    )
                                 
                                 ⋅
                                 
                                    (
                                    
                                       B
                                    
                                    −
                                    
                                       s
                                    
                                    )
                                 
                                 >
                                 0
                                 ⇒
                                 
                                    C
                                 
                                 =
                                 0̸
                                 .
                              
                           
                         However, the above condition may not hold for some star points of 
                           
                              B
                           
                           ∩
                           
                              S
                           
                        , because the initial (before subdivision) box 
                           
                              B
                           
                         probably contains roots for both 
                           f
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           0
                         (the boundary of the object 
                           
                              S
                           
                        ) and 
                           g
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           0
                           
                           
                              (
                              g
                              
                                 (
                                 
                                    s
                                 
                                 )
                              
                              =
                              0
                              )
                           
                        , though no common root exists. Moreover, the interval arithmetic may over-estimate the result. In these cases, the initial box 
                           
                              B
                           
                         is subdivided in 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    B
                                 
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    B
                                 
                              
                              
                                 
                                    
                                       2
                                    
                                    
                                       d
                                    
                                 
                              
                           
                        , then 
                           
                              C
                           
                           =
                           
                              
                                 
                                    C
                                 
                              
                              
                                 1
                              
                           
                           ∪
                           
                              
                                 
                                    C
                                 
                              
                              
                                 2
                              
                           
                           ∪
                           ⋯
                           ∪
                           
                              
                                 
                                    C
                                 
                              
                              
                                 
                                    
                                       2
                                    
                                    
                                       d
                                    
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 i
                              
                           
                         is the contradicting set of the test in the box 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 i
                              
                           
                        . When 
                           0
                           ∉
                           f
                           
                              (
                              
                                 
                                    
                                       B
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        , i.e.  either 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 i
                              
                           
                           ∩
                           
                              S
                           
                           =
                           0̸
                         or 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 i
                              
                           
                           ⊂
                           
                              S
                           
                        , thus the contradicting set 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 i
                              
                           
                         is empty. Remark that 
                           
                              s
                           
                         may not belong to 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 i
                              
                           
                         when 
                           
                              B
                           
                         is subdivided.

If all 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 i
                              
                           
                         in sub-tests are empty, then 
                           
                              s
                           
                         is a star point, see Fig. 3
                         for an example. It may happen that the size of one subdivided box 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 i
                              
                           
                         satisfying 
                           0
                           ∈
                           f
                           
                              (
                              
                                 
                                    
                                       B
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                              )
                           
                         is smaller than a given threshold 
                           ε
                        . In this case, 
                           
                              s
                           
                         cannot be guaranteed to be a star point because of the lack of accuracy.

In Fig. 4
                        (a), we show the subdivision of the star test using interval arithmetic for a unit disk defined by 
                           f
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           =
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 y
                              
                              
                                 2
                              
                           
                           −
                           1
                           ≤
                           0
                        , the candidate star point is the center of the disk, i.e.   
                           
                              s
                           
                           =
                           
                              (
                              0
                              ,
                              0
                              )
                           
                        , and the initial studied box is 
                           
                              B
                           
                           =
                           
                              (
                              
                                 [
                                 −
                                 1
                                 ,
                                 1
                                 ]
                              
                              ,
                              
                                 [
                                 −
                                 1
                                 ,
                                 1
                                 ]
                              
                              )
                           
                        . The initial box 
                           
                              B
                           
                         covers the disk, and contains the candidate star point 
                           
                              s
                           
                        , thus it needs to be subdivided. At last, there is no such sub-box that contains both the candidate star point 
                           
                              s
                           
                         and boundary points of the object simultaneously.

With Bernstein based methods, a range of 
                           f
                           
                              (
                              
                                 B
                              
                              )
                           
                         and 
                           g
                           
                              (
                              
                                 B
                              
                              )
                           
                         is given by the 
                           min
                         and the 
                           max
                         of the Bernstein coefficients. Therefore, for the problem of the star test, the condition (1) can be tested using Bernstein based methods. For example, we can write the polynomial 
                           g
                           
                              (
                              
                                 x
                              
                              )
                           
                           ,
                           
                              x
                           
                           ∈
                           
                              B
                           
                         in Bernstein form, then it is guaranteed to be positive if all the Bernstein coefficients are positive. Usually, it is more efficient than using the method of interval arithmetic due to the efficiency and stability of the de Casteljau algorithm and the fact that Bernstein based methods provide tighter ranges for polynomials. For the example of Fig. 4(a), it is not, because the interval arithmetic is optimal when each variable occurs once in the expression of functions.

We propose a method to improve the efficiency of the star test for implicit objects. Let 
                           
                              S
                           
                         be defined by 
                           
                              S
                           
                           =
                           
                              {
                              
                                 x
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                              ∣
                              f
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              ≤
                              0
                              }
                           
                        , where 
                           f
                           
                              (
                              
                                 x
                              
                              )
                           
                         is a total degree 
                           n
                         polynomial, given a point 
                           
                              s
                           
                           =
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    s
                                 
                                 
                                    d
                                 
                              
                              )
                           
                        , then the expression in the star condition 
                           ∇
                           f
                           
                              (
                              
                                 x
                              
                              )
                           
                           ⋅
                           
                              (
                              
                                 x
                              
                              −
                              
                                 s
                              
                              )
                           
                         is also a total degree 
                           n
                         polynomial. For each monomial of 
                           f
                           
                              (
                              
                                 x
                              
                              )
                           
                         with total degree 
                           m
                         less than 
                           n
                        , it is elevated to degree 
                           n
                         via the product with a monomial 
                           
                              
                                 h
                              
                              
                                 n
                                 −
                                 m
                              
                           
                        , where 
                           h
                         is a new auxiliary variable (
                           h
                         for homogeneous variable). Therefore, we get a degree 
                           n
                         homogeneous polynomial 
                           F
                           
                              (
                              
                                 x
                              
                              ,
                              h
                              )
                           
                        , such that 
                           F
                           
                              (
                              
                                 x
                              
                              ,
                              1
                              )
                           
                           =
                           f
                           
                              (
                              
                                 x
                              
                              )
                           
                        . Then the star condition (1) for 
                           
                              s
                           
                           ∈
                           
                              S
                           
                         becomes
                           
                              
                                 
                                    {
                                    
                                       (
                                       
                                          x
                                       
                                       ,
                                       h
                                       )
                                    
                                    ∈
                                    
                                       (
                                       
                                          B
                                       
                                       ,
                                       
                                          [
                                          1
                                          ,
                                          1
                                          ]
                                       
                                       )
                                    
                                    ∣
                                    F
                                    
                                       (
                                       
                                          x
                                       
                                       ,
                                       h
                                       )
                                    
                                    =
                                    0
                                    ,
                                    ∇
                                    F
                                    
                                       (
                                       
                                          x
                                       
                                       ,
                                       h
                                       )
                                    
                                    ⋅
                                    
                                       (
                                       
                                          (
                                          
                                             x
                                          
                                          ,
                                          h
                                          )
                                       
                                       −
                                       
                                          (
                                          
                                             s
                                          
                                          ,
                                          h
                                          )
                                       
                                       )
                                    
                                    ≤
                                    0
                                    }
                                 
                                 =
                                 0̸
                                 .
                              
                           
                         As 
                           F
                           
                              (
                              
                                 x
                              
                              ,
                              h
                              )
                           
                         is a homogeneous polynomial, we have 
                           
                              (3)
                              
                                 ∇
                                 F
                                 
                                    (
                                    
                                       x
                                    
                                    ,
                                    h
                                    )
                                 
                                 ⋅
                                 
                                    (
                                    
                                       x
                                    
                                    ,
                                    h
                                    )
                                 
                                 =
                                 n
                                 F
                                 
                                    (
                                    
                                       x
                                    
                                    ,
                                    h
                                    )
                                 
                              
                           
                         after Euler’s theorem. Thus, the star condition becomes 
                           
                              (4)
                              
                                 
                                    {
                                    
                                       x
                                    
                                    ∈
                                    
                                       B
                                    
                                    ∣
                                    F
                                    
                                       (
                                       
                                          x
                                       
                                       ,
                                       1
                                       )
                                    
                                    =
                                    0
                                    ,
                                    
                                    −
                                    ∇
                                    F
                                    
                                       (
                                       
                                          x
                                       
                                       ,
                                       1
                                       )
                                    
                                    ⋅
                                    
                                       (
                                       
                                          s
                                       
                                       ,
                                       1
                                       )
                                    
                                    ≤
                                    0
                                    }
                                 
                                 =
                                 0̸
                                 .
                              
                           
                         Let 
                           G
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           −
                           ∇
                           F
                           
                              (
                              
                                 x
                              
                              ,
                              1
                              )
                           
                           ⋅
                           
                              (
                              
                                 s
                              
                              ,
                              1
                              )
                           
                        . The degree of 
                           G
                           
                              (
                              
                                 x
                              
                              )
                           
                         is reduced to 
                           n
                           −
                           1
                        . Thus, no matter whether the interval arithmetic method or a Bernstein based method is used, less subdivisions are needed for the homogeneous star test compared to the naive star test of Eq. (2).

For the example shown in Fig. 4(a), the new variable 
                           h
                           =
                           1
                         is introduced to make 
                           f
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         a homogeneous polynomial, that is 
                           F
                           
                              (
                              x
                              ,
                              y
                              ,
                              h
                              )
                           
                           =
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 y
                              
                              
                                 2
                              
                           
                           −
                           
                              
                                 h
                              
                              
                                 2
                              
                           
                        . The gradient of 
                           F
                           
                              (
                              x
                              ,
                              y
                              ,
                              h
                              )
                           
                         is 
                           ∇
                           F
                           
                              (
                              x
                              ,
                              y
                              ,
                              h
                              )
                           
                           =
                           
                              (
                              2
                              x
                              ,
                              2
                              y
                              ,
                              −
                              2
                              h
                              )
                           
                        . Since 
                           h
                           =
                           1
                        , we have 
                           G
                           
                              (
                              
                                 B
                              
                              )
                           
                           =
                           −
                           ∇
                           F
                           
                              (
                              
                                 B
                              
                              ,
                              1
                              )
                           
                           ⋅
                           
                              (
                              
                                 s
                              
                              ,
                              1
                              )
                           
                           =
                           2
                        , which shows that 
                           ∀
                           
                              x
                           
                           ∈
                           
                              B
                           
                         the star condition holds trivially, and strictly no subdivision is needed, see Fig. 4(b). In comparison, when the naive star condition (2) is used, the given box has to be subdivided to prove that the center of the box is a star, as shown in Fig. 4(a). In this example, whether the interval arithmetic method or the Bernstein based methods is used, we have the same result for both the naive star test and the homogeneous star test because each variable occurs once. That is, there is no dependency, thus no dependency loss and naive interval arithmetic gives exact bounds.

Notably, for a conic such as a disk, the equation 
                           G
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           0
                         defines the polar line (or plane) of 
                           
                              s
                           
                         relatively to the conic, see Fig. 5
                        . We try to further explain the reason of improvement of the homogeneous star test with the following example.

In subfigures 6
                        (a) and (b), the object 
                           
                              S
                           
                         is the complement set of a unit disk, and the studied box is 
                           
                              B
                           
                           =
                           
                              (
                              
                                 [
                                 −
                                 1.6
                                 ,
                                 −
                                 0.9
                                 ]
                              
                              ,
                              
                                 [
                                 −
                                 0.35
                                 ,
                                 0.35
                                 ]
                              
                              )
                           
                        . In subfigures 6(c) and (d), the object 
                           
                              S
                           
                         is the unit disk, and the box is 
                           
                              B
                           
                           =
                           
                              (
                              
                                 [
                                 0.25
                                 ,
                                 1.25
                                 ]
                              
                              ,
                              
                                 [
                                 −
                                 0.5
                                 ,
                                 0.5
                                 ]
                              
                              )
                           
                        . In both examples, the center of the box 
                           
                              s
                           
                         is a star of 
                           
                              B
                           
                           ∩
                           
                              S
                           
                        . With the naive star condition (2), we need subdivisions and we subdivide the studied box along the longest edge at each step if the contradicting set 
                           
                              C
                           
                         cannot be guaranteed to be an empty set. The subdivisions are shown in subfigures 6(a) and (c). With the homogeneous star condition, we use the same subdividing strategy but we do not need any subdivision because the polar line of the candidate star point relatively to the disk does not pass through the studied box, see subfigures 6(b) and (d). Both interval arithmetic and Bernstein based methods result in the same subdivisions here.

The homogeneous star test also needs subdivision when the polar line of the candidate star point passes through the studied box, however it needs fewer subdivisions than the naive star test (2), see Fig. 7
                        .

So far, we did not yet discuss the efficiency of the star test when 
                           
                              s
                           
                         is not a star. Of course, it is important to detect as soon as possible that 
                           
                              s
                           
                         is not a star. This is discussed later in Section  4.4.

This section presents another optimization of the star test. Actually, the star test is the problem of finding a point in the contradicting set, i.e.  to find 
                           
                              x
                           
                         in a given box 
                           
                              B
                           
                        , such that 
                           f
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           0
                         and 
                           g
                           
                              (
                              
                                 x
                              
                              )
                           
                           ≤
                           0
                         (or 
                           G
                           
                              (
                              
                                 x
                              
                              )
                           
                           ≤
                           0
                         for the homogeneous star test). An optimization method has been proposed in  [31] to solve this problem, we recall the method and detail it for the 2D case in the remainder of this section.

First, 
                           f
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         and 
                           g
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         are expressed with the same Bernstein control net, i.e.   
                           
                              
                                 f
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         and 
                           
                              
                                 g
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           ,
                           
                           i
                           =
                           0
                           ,
                           …
                           ,
                           m
                           ,
                           
                           j
                           =
                           0
                           ,
                           …
                           ,
                           n
                        . We then search 
                           k
                           ∈
                           R
                         such that 
                           h
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           =
                           k
                           f
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           +
                           g
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           >
                           0
                        ,
                           1
                        
                        
                           1
                           This 
                                 h
                               is independent of the homogeneous variable in Section  4.2.
                        
                        i.e.  for all control points, 
                           
                              
                                 h
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           =
                           k
                           
                              
                                 f
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           +
                           
                              
                                 g
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         are strictly positive. Thus, if we find such a 
                           k
                        , 
                           f
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           =
                           0
                         implies 
                           g
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           >
                           0
                        , and we have proved that the system 
                           
                              (5)
                              
                                 
                                    {
                                    
                                       
                                          
                                             f
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             g
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             ≤
                                             0
                                          
                                       
                                    
                                 
                              
                           
                         has no solution, the contradicting set 
                           
                              C
                           
                         is empty, so the candidate point is a star. Otherwise, the box 
                           
                              B
                           
                         is subdivided, and for each sub-box we perform the star test of the candidate star point 
                           
                              s
                           
                         with linear programming optimization. When the size of a sub-box is smaller than a given threshold 
                           ε
                        , in this case we cannot get a guaranteed result because of the lack of accuracy.

To solve for 
                           k
                         is just a linear programming problem with only one unknown 
                           k
                        , so it is easy to solve: start with an interval 
                           
                              (
                              −
                              ∞
                              ,
                              +
                              ∞
                              )
                           
                         for 
                           k
                        , and clip it with linear inequalities. For all 
                           i
                        , for all 
                           j
                        , 
                           k
                           
                              
                                 f
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           +
                           
                              
                                 g
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           >
                           0
                         (take 
                           ≥
                           ε
                           =
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 3
                              
                           
                         to simplify). According to the sign of 
                           
                              
                                 f
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        , we clip for the 
                           min
                         or the 
                           max
                         of the current interval for 
                           k
                        . It is similar to ray casting a convex polyhedron. Eventually, we obtain an interval for 
                           k
                        , maybe it is empty.

In 3D, we still have only one equation 
                           f
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           0
                         and only one inequality 
                           g
                           
                              (
                              
                                 x
                              
                              )
                           
                           ≤
                           0
                         or 
                           G
                           
                              (
                              
                                 x
                              
                              )
                           
                           ≤
                           0
                        , so we still have one unknown 
                           k
                        . The sole difference is that we have control net 
                           
                              
                                 f
                              
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                           
                         and 
                           
                              
                                 g
                              
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                           
                        .

This improvement is independent of the homogenization optimization. For the examples in Fig. 6, with linear programming optimization, no subdivision is needed for both the naive star test and the homogeneous star test. For the example in Fig. 7, only one subdivision is needed for both the naive star test and the homogeneous star test if this linear programming optimization method is used.

Furthermore, with this linear programming optimization, the homogeneous star test turns out to be mathematically equivalent to the naive star test. We prove it for the 2D case. From  (3), we have 
                           g
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           n
                           f
                           
                              (
                              
                                 x
                              
                              )
                           
                           +
                           G
                           
                              (
                              
                                 x
                              
                              )
                           
                        , where 
                           n
                         is the degree of 
                           f
                           
                              (
                              
                                 x
                              
                              )
                           
                        . Thus, 
                           k
                           f
                           
                              (
                              
                                 x
                              
                              )
                           
                           +
                           g
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           
                              (
                              k
                              +
                              n
                              )
                           
                           f
                           
                              (
                              
                                 x
                              
                              )
                           
                           +
                           G
                           
                              (
                              
                                 x
                              
                              )
                           
                        . For the 2D case, if 
                           f
                           
                              (
                              
                                 x
                              
                              )
                           
                        , 
                           g
                           
                              (
                              
                                 x
                              
                              )
                           
                        , and 
                           G
                           
                              (
                              
                                 x
                              
                              )
                           
                         are expressed with the same Bernstein control net, i.e.   
                           
                              
                                 f
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        , 
                           
                              
                                 g
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        , and 
                           
                              
                                 G
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        , we then get 
                           k
                           
                              
                                 f
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           +
                           
                              
                                 g
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           =
                           
                              (
                              k
                              +
                              n
                              )
                           
                           
                              
                                 f
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           +
                           
                              
                                 G
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        , i.e.   
                           
                              
                                 G
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           =
                           
                              
                                 g
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           −
                           n
                        . Therefore, if 
                           k
                         fulfils 
                           k
                           
                              
                                 f
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           +
                           
                              
                                 g
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           >
                           0
                        , then 
                           K
                           =
                           k
                           +
                           n
                         fulfils 
                           K
                           
                              
                                 f
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           +
                           
                              
                                 G
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           >
                           0
                         and the two methods (naive, and homogeneous) are equivalent with linear programming optimization.

Notably, the linear programming optimization method can be extended to other geometric bases (such as Bspline, NURBS, etc.), which possess convex hull property and subdivision algorithms like de Casteljau algorithm.

In the star test of 
                           
                              s
                           
                           ∈
                           
                              B
                           
                           ∩
                           
                              S
                           
                         for a given object 
                           
                              S
                           
                         and a studied box 
                           
                              B
                           
                        , suppose that we find a sub-box 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 i
                              
                           
                           ⊂
                           
                              B
                           
                         such that 
                           g
                           
                              (
                              
                                 
                                    
                                       B
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           <
                           0
                         and a vertex 
                           
                              v
                           
                         of 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 i
                              
                           
                         is inside 
                           
                              S
                           
                        , i.e.   
                           f
                           
                              (
                              
                                 v
                              
                              )
                           
                           <
                           0
                        , then the contradicting set 
                           
                              C
                           
                         contains at least the vertex 
                           
                              v
                           
                        , so 
                           
                              s
                           
                         is not a star of 
                           
                              B
                           
                           ∩
                           
                              S
                           
                        . It helps to terminate the procedure of subdivision as soon as possible when 
                           
                              s
                           
                         is not a star point. For the linear programming optimization, when there is no 
                           k
                         satisfying the condition (5), 
                           
                              s
                           
                         is not a star if for one subdivided box 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 i
                              
                           
                        , we have 
                           max
                           
                              {
                              
                                 
                                    f
                                 
                                 
                                    0
                                    ,
                                    0
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    m
                                    ,
                                    0
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    0
                                    ,
                                    n
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    m
                                    ,
                                    n
                                 
                              
                              }
                           
                           ≥
                           0
                        , 
                           min
                           
                              {
                              
                                 
                                    f
                                 
                                 
                                    0
                                    ,
                                    0
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    m
                                    ,
                                    0
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    0
                                    ,
                                    n
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    m
                                    ,
                                    n
                                 
                              
                              }
                           
                           ≤
                           0
                        , (thus 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 i
                              
                           
                           ∩
                           ∂
                           
                              S
                           
                           ≠
                           0̸
                        ) and 
                           max
                           
                              {
                              
                                 
                                    g
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              }
                           
                           ≤
                           0
                         (thus 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 i
                              
                           
                           ≠
                           0̸
                        ). Experimental results are shown in Section  5.

So far, we have presented computable sufficient conditions for a candidate point 
                           
                              s
                           
                           ∈
                           
                              B
                           
                           ∩
                           
                              S
                           
                         to be or not to be a star point of 
                           
                              B
                           
                           ∩
                           
                              S
                           
                        . The star test is performed when the box 
                           
                              B
                           
                         is not full and not empty. When the star condition cannot be guaranteed or contradicted, the box 
                           
                              B
                           
                         is subdivided and the star test of 
                           
                              s
                           
                         is recursively performed for each sub-box.

However, it may happen in some rare cases that these sufficient conditions are never satisfied during the subdivision, usually when the boundary of 
                           
                              S
                           
                         is tangent or almost tangent to the boundary of 
                           
                              B
                           
                        . It also occurs with the original methods by Delanoue et al. In these cases, we have to stop the procedure to avoid endless subdivision, and the algorithm fails. The conservative choice is to consider that 
                           
                              s
                           
                         is not a star for 
                           
                              B
                           
                           ∩
                           
                              S
                           
                        . Thus 
                           
                              B
                           
                         is subdivided and star points are searched in sub-boxes of 
                           
                              B
                           
                        .


                        
                           
                              
                           
                        
                     

In this section, we summarize the procedure of the star test of a candidate point 
                           
                              s
                           
                         for a given object 
                           
                              S
                           
                         in a studied box 
                           
                              B
                           
                        . The star test is actually an emptiness test of the contradicting set 
                           
                              C
                           
                         in the box 
                           
                              B
                           
                        . The detail is shown in Algorithm 1.

@&#EXPERIMENTAL RESULTS@&#

In practical applications, the polynomials used in geometric modeling are usually of low degree. Therefore, Bernstein based methods can be used to perform the star test to improve efficiency. We implemented the star test using interval arithmetic and Bernstein based methods for comparison purposes.

Some implicit objects are selected to perform the star test using different arithmetic. 
                        
                           
                              
                                 S
                              
                           
                           
                              i
                           
                        
                      are defined by 
                        
                           
                              f
                           
                           
                              i
                           
                        
                        
                           (
                           
                              x
                           
                           )
                        
                        ≤
                        0
                     , where 
                        
                           
                              f
                           
                           
                              i
                           
                        
                      are 
                        
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 1
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 2
                                 
                                    
                                       
                                          (
                                          x
                                          −
                                          1
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          (
                                          y
                                          −
                                          2
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 2
                                 x
                                 y
                                 −
                                 1
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 x
                                 
                                    
                                       
                                          (
                                          x
                                          −
                                          1
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 y
                                 −
                                 2
                                 x
                                 y
                                 −
                                 1
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       4
                                    
                                 
                                 −
                                 2
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 1
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 
                                    
                                       601
                                    
                                    
                                       9
                                    
                                 
                                 −
                                 
                                    
                                       872
                                    
                                    
                                       3
                                    
                                 
                                 x
                                 +
                                 544
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 512
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 256
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                 
                                 −
                                 
                                    
                                       2728
                                    
                                    
                                       9
                                    
                                 
                                 y
                                 +
                                 
                                    
                                       2384
                                    
                                    
                                       3
                                    
                                 
                                 x
                                 y
                                 −
                                 768
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 y
                                 +
                                 
                                    
                                       5104
                                    
                                    
                                       9
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       2432
                                    
                                    
                                       3
                                    
                                 
                                 x
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 768
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 512
                                 
                                    
                                       y
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 256
                                 
                                    
                                       y
                                    
                                    
                                       4
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       5
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                 
                                 =
                                 3
                                 
                                    
                                       
                                          (
                                          x
                                          −
                                          1
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 3
                                 
                                    
                                       
                                          (
                                          y
                                          −
                                          1
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 
                                    
                                       
                                          (
                                          z
                                          −
                                          1
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 2
                                 x
                                 y
                                 −
                                 x
                                 z
                                 −
                                 y
                                 z
                                 −
                                 1
                                 ,
                              
                           
                        
                      where 
                        
                           
                              f
                           
                           
                              4
                           
                        
                      is the example 6 of  [13]. The studied boxes 
                        
                           
                              
                                 B
                              
                           
                           
                              i
                           
                        
                      are 
                        
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       [
                                       −
                                       1.5
                                       ,
                                       −
                                       0.6
                                       ]
                                    
                                    ,
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       [
                                       −
                                       2
                                       ,
                                       10
                                       ]
                                    
                                    ,
                                    
                                       [
                                       0
                                       ,
                                       12
                                       ]
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       [
                                       −
                                       1
                                       ,
                                       5
                                       ]
                                    
                                    ,
                                    
                                       [
                                       −
                                       1
                                       ,
                                       5
                                       ]
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       [
                                       −
                                       2
                                       ,
                                       2
                                       ]
                                    
                                    ,
                                    
                                       [
                                       −
                                       2
                                       ,
                                       2
                                       ]
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       [
                                       0.45
                                       ,
                                       0.9
                                       ]
                                    
                                    ,
                                    
                                       [
                                       0.45
                                       ,
                                       0.9
                                       ]
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                    
                                    
                                       5
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       [
                                       −
                                       1
                                       ,
                                       5
                                       ]
                                    
                                    ,
                                    
                                       [
                                       −
                                       1
                                       ,
                                       5
                                       ]
                                    
                                    ,
                                    
                                       [
                                       −
                                       1
                                       ,
                                       5
                                       ]
                                    
                                    )
                                 
                                 .
                              
                           
                        
                      The center of the box is selected as the candidate star point in each example. The objects 
                        
                           
                              
                                 B
                              
                           
                           
                              i
                           
                        
                        ∩
                        
                           
                              
                                 S
                              
                           
                           
                              i
                           
                        
                        ,
                        
                        i
                        =
                        0
                        ,
                        …
                        ,
                        5
                      are shown in Figs. 8
                     (a)–(e) and 9
                     , 
                        
                           
                              
                                 B
                              
                           
                           
                              5
                           
                        
                        ∩
                        
                           
                              
                                 S
                              
                           
                           
                              5
                           
                        
                      is a 3D ellipsoid. The first two columns show subdivisions of the naive star test using interval arithmetic and Bernstein based methods, respectively. The third and fourth columns show subdivisions of the homogeneous star test using interval arithmetic and Bernstein based methods, respectively. At last, the fifth column shows the subdivisions of the homogeneous star test with linear programming optimization. In our experiments, the star test (either naive or homogeneous) with linear programming optimization performs better in terms of subdivision among all these methods.


                     Tables 1 and 2
                     
                      give the depth of the subdivisions and the running time of the star test for each 
                        
                           
                              
                                 B
                              
                           
                           
                              i
                           
                        
                        ∩
                        
                           
                              
                                 S
                              
                           
                           
                              i
                           
                        
                     . In the tables, Naive refers to the naive star test, Homogeneous refers to the homogeneous star test. IA refers to the interval arithmetic, B refers to the Bernstein based methods, and LPO refers to the linear programming optimization method. Table 1 confirms the equivalence of the naive star test and the homogeneous star test with linear programming optimization. With all these examples, the candidate star point is a star. The slowest method is clearly the initial Naive IA. In the fifth example, IA method fails the star test when we set the threshold for terminating the subdivision to 
                        ϵ
                        =
                        0.01
                     . All other methods are much faster. The fastest method is Naive LPO in the first and the fifth example, and Homogeneous IA in the four other examples. This superiority of IA is only apparent and is due to the sparsity of equations 
                        
                           
                              f
                           
                           
                              i
                           
                        
                        ,
                        
                        i
                        =
                        1
                        ,
                        2
                        ,
                        3
                        ,
                        5
                     , so the wrapping effect of IA is not sensible. With dense equations, as for 
                        
                           
                              f
                           
                           
                              4
                           
                        
                        [13], occurring in real world, the running times increase with the subdivision levels. These results confirm Martin et al. ones  [13].


                     Fig. 10
                      shows some examples where the candidate points are not star points. Let 
                        ¬
                        
                           
                              
                                 S
                              
                           
                           
                              i
                           
                        
                      be the complement set of 
                        
                           
                              
                                 S
                              
                           
                           
                              i
                           
                        
                     . The studied boxes are 
                        
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                    
                                    
                                       
                                          
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       [
                                       0
                                       ,
                                       5
                                       ]
                                    
                                    ,
                                    
                                       [
                                       −
                                       3
                                       ,
                                       2
                                       ]
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                    
                                    
                                       
                                          
                                             3
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       [
                                       −
                                       2
                                       ,
                                       1.2
                                       ]
                                    
                                    ,
                                    
                                       [
                                       −
                                       2
                                       ,
                                       1.2
                                       ]
                                    
                                    )
                                 
                                 .
                              
                           
                        
                      The subdivisions of the star test for 
                        
                           
                              
                                 B
                              
                           
                           
                              
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                           
                        
                        ∩
                        ¬
                        
                           
                              
                                 S
                              
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              
                                 B
                              
                           
                           
                              
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                           
                        
                        ∩
                        
                           
                              
                                 S
                              
                           
                           
                              3
                           
                        
                      are shown in Fig. 10 and Table 4. Table 5 gives the running time of the star test using different methods. As we already know, IA is not a good method to perform the star test, so the naive star test and the homogeneous star test are implemented and compared using Bernstein based methods. Furthermore, the subdivisions are the same for the homogeneous star test and the naive star test using LPO, and the running time is similar, only the results of the homogeneous star test using LPO is given. The subdivision stops as soon as the contradicting set is proved to be non-empty.

We implement the HIA algorithm using the proposed star test methods. In Fig. 11
                     , the first row gives an example of 
                        
                           
                              
                                 S
                              
                           
                           
                              6
                           
                        
                     , which is the subtraction of a quarter disk 
                        
                           
                              x
                           
                           
                              2
                           
                        
                        +
                        
                           
                              y
                           
                           
                              2
                           
                        
                        −
                        1
                        ≤
                        0
                      and a small disk 
                        
                           
                              
                                 (
                                 x
                                 −
                                 0.5
                                 )
                              
                           
                           
                              2
                           
                        
                        +
                        
                           
                              
                                 (
                                 y
                                 −
                                 0.5
                                 )
                              
                           
                           
                              2
                           
                        
                        −
                        0.01
                        ≤
                        0
                     . The second row of Fig. 11 is an example of 
                        
                           
                              
                                 S
                              
                           
                           
                              7
                           
                        
                     , which is the subtraction of a disk 
                        
                           
                              
                                 (
                                 x
                                 −
                                 0.5
                                 )
                              
                           
                           
                              2
                           
                        
                        +
                        
                           
                              
                                 (
                                 y
                                 −
                                 0.5
                                 )
                              
                           
                           
                              2
                           
                        
                        −
                        0.25
                        ≤
                        0
                      and 
                        
                           
                              
                                 S
                              
                           
                           
                              4
                           
                        
                     . The initial box 
                        
                           
                              
                                 B
                              
                           
                           
                              6
                           
                        
                      is ([0,1], [0,1]), and 
                        
                           
                              
                                 B
                              
                           
                           
                              7
                           
                        
                      is ([0.3,0.6], [0.7,1]). Number of simplicial vertices of the HIA results are given in Table 3
                     . 
                      Notably, the IA method fails the HIA algorithm for 
                        
                           
                              
                                 S
                              
                           
                           
                              7
                           
                        
                     . Because with LPO, the naive star test and the homogeneous star test are equivalent, only one of them is given. Thus, except for some very sparse equations 
                        f
                     , the best star test is usually LPO (either naive or homogeneous) because the resulting graphs or simplicial complexes have less vertices.

@&#CONCLUSION@&#

In this paper, we presented methods to improve the star test for implicit objects. We proposed computable sufficient conditions to prove the contradicting set is empty, or that it is not empty. The correctness of these conditions should be formally proved in a near future with some proof assistant, like Coq. Examples are given to show the performances of our methods for implicit objects. In our implementation of the star test, interval arithmetic and Bernstein based methods are used and compared. Our method is easy to extend to implicit piecewise (rational) polynomial functions.

A shortfall of our method is that it is limited to implicit polynomial objects. Those objects defined by implicit equations  [36,37] involving transcendental functions 
                        f
                     , like 
                        exp
                      in Moving Least Square (MLS) or in Blinn objects (blobs), cannot be treated directly, although we may find two bounding polynomials that bound 
                        f
                      and then perform the star test. This will be considered as part of our future enhancements of this work. Moreover, other geometric sets will be taken into consideration, such as shapes formed by parametric objects  [38], sweeping, Minkowski sum, or deformed parametric objects whose domains are defined by implicit sets, etc.

It happens that a star-shaped set may fail the test since only the center of the box is tested, which may result in some unnecessary subdivisions. One of our future works will be to find a method to directly test if the kernel of a given object is empty or not.

@&#ACKNOWLEDGMENTS@&#

The work is supported by National Natural Science Foundation of China (61100084, 61202197, 61272300), Zhejiang Provincial Natural Science Foundation of China (LQ13F020003, LY15F020014), Zhejiang Province Department of Education Fund (Y201223321), and China Scholarship Council.

In mathematics, specifically in topology, if 
                        
                           S
                        
                      is a subset of a Euclidean space, then 
                        
                           x
                        
                      is an interior point of 
                        
                           S
                        
                      if there exists an open ball centered at 
                        
                           x
                        
                      which is completely contained in 
                        
                           S
                        
                     . The interior set 
                        
                           int
                        
                        
                           (
                           
                              S
                           
                           )
                        
                      consists of all interior points. The boundary 
                        ∂
                        
                           S
                        
                      of 
                        
                           S
                        
                      is the set of points 
                        
                           p
                        
                      of 
                        
                           S
                        
                      such that every neighborhood of 
                        
                           p
                        
                      contains at least one point of 
                        
                           S
                        
                      and at least one point not belonging to 
                        
                           S
                        
                     , as shown in Fig. A.12
                     . A set 
                        
                           S
                        
                      is said to be fat if 
                        ∀
                        
                           p
                        
                        ∈
                        ∂
                        
                           S
                        
                     , every neighborhood of 
                        
                           p
                        
                      contains at least one point of 
                        
                           int
                        
                        
                           (
                           
                              S
                           
                           )
                        
                     , e.g.  the set 
                        
                           S
                        
                      which is defined by 
                        f
                        
                           (
                           x
                           ,
                           y
                           )
                        
                        =
                        
                           
                              x
                           
                           
                              2
                           
                        
                        +
                        
                           
                              y
                           
                           
                              2
                           
                        
                        −
                        1
                        ≤
                        0
                      is a fat set, the Cantor set is not a fat set.

A fat set contains interior points with rational coordinates, which an algorithm can compute. Our methods use floating point arithmetic for the sake of efficiency, thus they will fail for fat sets which do not contain points with floating point coordinates. Actually they fail for objects with tiny smallest feature size  [39–42], or for objects touching along a common boundary like a stack of cubes.

The HIA algorithm  [11,12] computes a simplicial complex which is homotopic to the input set. It usually computes more star points than the optimization to get a simplicial complex, an example is shown in Fig. A.13
                     . In this example, our algorithm will fail if the ring thickness is too small.

@&#REFERENCES@&#

