@&#MAIN-TITLE@&#Kinematic skeleton extraction from 3D articulated models

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A kinematic skeleton extraction method for articulated bodies is proposed.


                        
                        
                           
                           It is a hybrid approach combining topology-based and geometry-based methods.


                        
                        
                           
                           It does not require manually-chosen feature points or markers.


                        
                        
                           
                           It is independent of both postures and the number of branches of the model.


                        
                        
                           
                           The results can be directly applied to the character rigging.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Skeleton extraction

Character animation

Pose-independence

Morse theory

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

The 1D skeleton of an object provides an intuitive abstraction for both shape recognition and manipulation. A good skeleton should be simple enough to provide a glimpse of the overall structure while preserving a certain level of detail. Because of its importance and usefulness, there have been many previous studies designed to obtain a robust and efficient method for extracting a skeleton from a given object. Strictly speaking, however, the 1D skeleton can be classified into two different categories: the curve skeleton and the kinematic skeleton (or bone skeleton). The former provides an understanding of the abstract structure of the given shape. The latter is used as a tool to control the animation or the deformation of its corresponding model.

Many existing skeleton extraction methods  [1–4] focus on the curve skeleton. In this case, most nodes are optional nodes which make the resulting skeleton smoother. For the kinematic skeleton, however, all nodes should be carefully chosen because they become the joints for animating characters. Thus, the direct conversion (downsampling, for example) from the curve skeleton is not a simple task in the sense that it may produce redundant joints  [2]. Moreover, the joints can be classified into two different categories. Joints such as the shoulder and the hip introduce a branch on the skeleton. Ideas based on topological features such as the Reeb graph and the Morse complex are suitable for detecting such joints. On the other hand, joints including the elbow and the knee do not invoke a “split” of the skeleton because they are characterized solely by geometric features such as angle, curvature, and thickness. Therefore, it is desirable to handle them independently. We call the former topological joints and the latter geometric joints, respectively.

In this paper, we propose a fully automatic, pose-independent method to extract the kinematic skeleton of an articulated model. It is a hybrid approach, and addresses topological and geometric joints from different points of view. It does not require any type of manually-defined markers or feature points and is free from assumptions concerning the poses of the given model or the number of branches (including legs, arms, and tails). Experiments show that our algorithm is also efficient with respect to time. The process takes less than five seconds for the model with 33,827 vertices and 18 terminal branches.

@&#RELATED WORK@&#

There have been various approaches to extracting the one-dimensional skeleton of a given model. One set of approaches are geometry-based methods that exploit the geometric features of the given model. The 1D simplification of the medial axis has been a popular technique in the computational geometry community [5,1,3]. Thinning methods  [6–8,2] construct the 1D skeleton by repeatedly removing the boundary of the model. Mesh segmentation  [9] is also closely related to the problem of skeleton extraction. There have been various studies on mesh segmentation and skeleton extraction based on curvature and geodesic distances  [10–12], dihedral angles  [13], slippage  [14], convex decomposition  [15], and shape diameter function  [16]. However, geometric attributes of the surface are quite sensitive to the deformation or noise in the model.

Instead of focusing on the local geometry, topology-based methods [17–20,4] define a set of real-valued functions on the input mesh to construct a data structure describing its topology using structures such as Reeb graphs  [21–23], contour trees  [24], and Morse complexes  [25,26]. The quality of a topology-based method largely depends on the selection of a mapping function and the feature points, and the isocontours of the mapping function tend to be highly distorted when the given model has a complex shape.

Our algorithm is composed of three main stages: feature point selection, topology tree construction, and geometric refinement. A set of feature points is first extracted in the feature point selection stage (Section  3.1). Each feature point represents a terminal branch such as a finger or toe. Considering terminal branches as leaf nodes, we construct a tree 
                        T
                      which describes the topology of the input model 
                        M
                        =
                        
                           (
                           V
                           ,
                           E
                           ,
                           F
                           )
                        
                      in a bottom-up manner by merging small branches into a larger branch repeatedly during the topology tree construction stage (Section  3.2). Finally, 
                        T
                      is fit into 
                        M
                      as its kinematic skeleton after geometric refinements including internal joint extraction and joint position adjustment (Section  3.3).


                        Preprocessing. We use the medial axis (MA) point approximation algorithm proposed in  [27]. Starting from a sufficiently large ball tangent to 
                           M
                         at each 
                           v
                           ∈
                           V
                        , the process iteratively shrinks the ball until it becomes maximal and empty, which results in an approximate medial ball tangent to 
                           M
                         at 
                           v
                        . We obtain a set 
                           M
                         of approximate MA points of a given model 
                           M
                         after preprocessing.


                        Candidate feature point selection. Let 
                           
                              
                                 D
                              
                              
                                 p
                              
                           
                           
                              (
                              x
                              )
                           
                        , where 
                           p
                           ,
                           x
                           ∈
                           V
                        , is the shortest distance from the source 
                           p
                         to the target 
                           x
                         on 
                           M
                        . If there are branches such as fingers and toes, the vertices on the tips of the branches are highly likely to be the local maxima of 
                           
                              
                                 D
                              
                              
                                 p
                              
                           
                        . Based on this observation, we use the local maxima of 
                           
                              
                                 D
                              
                              
                                 p
                              
                           
                         as conservative initial guesses of feature points. We use the alternative notation 
                           D
                           
                              (
                              p
                              ,
                              x
                              )
                           
                         instead of 
                           
                              
                                 D
                              
                              
                                 p
                              
                           
                           
                              (
                              x
                              )
                           
                         when describing the mesh distance between 
                           p
                         and 
                           x
                         without specifying the source point.

When 
                           p
                         is close to the tip of the branch, however, 
                           
                              
                                 D
                              
                              
                                 p
                              
                           
                         may miss the feature point on that branch. To avoid this situation, we first find a feature point 
                           
                              s
                           
                         which is the farthest vertex from a randomly chosen source point 
                           p
                        , then perform Dijkstra’s algorithm again using 
                           
                              s
                           
                         as a new source to compute 
                           
                              
                                 D
                              
                              
                                 
                                    s
                                 
                              
                           
                        . The resulting set 
                           
                              
                                 
                                    FP
                                 
                              
                              
                                 0
                              
                           
                         of candidate feature points is the union of the local maxima of 
                           
                              
                                 D
                              
                              
                                 
                                    s
                                 
                              
                           
                         and 
                           
                              s
                           
                         itself. Thus: 
                           
                              (1)
                              
                                 
                                    
                                       
                                          FP
                                       
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    {
                                    x
                                    |
                                    
                                       
                                          D
                                       
                                       
                                          
                                             s
                                          
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    ≥
                                    
                                       
                                          D
                                       
                                       
                                          
                                             s
                                          
                                       
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    ,
                                    x
                                    ∈
                                    V
                                    ,
                                    ∀
                                    y
                                    ∈
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    }
                                 
                                 ∪
                                 
                                    {
                                    
                                       s
                                    
                                    }
                                 
                              
                           
                         where 
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                         denotes the 1-ring neighbor of 
                           x
                        . We keep track of 
                           
                              
                                 δ
                              
                              
                                 
                                    max
                                 
                              
                           
                           =
                           max
                           
                              {
                              
                                 
                                    D
                                 
                                 
                                    
                                       s
                                    
                                 
                              
                              }
                           
                         for further processing.


                        Filtering. After we compute 
                           
                              
                                 D
                              
                              
                                 p
                              
                           
                           
                              (
                              x
                              )
                           
                         for 
                           x
                           ∈
                           V
                         by Dijkstra’s algorithm, 
                           
                              
                                 D
                              
                              
                                 p
                              
                           
                           
                              (
                              x
                              )
                           
                         for any point 
                           x
                         on the edge or on the face are approximated by the linear interpolation of 
                           
                              
                                 D
                              
                              
                                 p
                              
                           
                         of neighboring vertices. Let 
                           
                              
                                 C
                              
                              
                                 p
                              
                           
                           
                              (
                              δ
                              )
                           
                         be the isocontour defined by 
                           
                              {
                              x
                              |
                              
                                 
                                    D
                                 
                                 
                                    p
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                              =
                              δ
                              ,
                              x
                              ∈
                              M
                              }
                           
                        . The candidate feature point set 
                           
                              
                                 
                                    FP
                                 
                              
                              
                                 0
                              
                           
                         may contain meaningless points that include noise. To distinguish these points from meaningful points, we estimate the depth of each branch and eliminate the points in 
                           
                              
                                 
                                    FP
                                 
                              
                              
                                 0
                              
                           
                         whose corresponding branch is shallower than a certain threshold 
                           
                              
                                 δ
                              
                              
                                 ̄
                              
                           
                         (see Fig. 1
                         for the detailed condition). We repeat this filtering process for a sequence of appropriately chosen source points until there are no more points to be removed. The detailed procedure is described in Fig. 2
                        . We used 3%–5% of 
                           
                              
                                 δ
                              
                              
                                 
                                    max
                                 
                              
                           
                         as 
                           
                              
                                 δ
                              
                              
                                 ̄
                              
                           
                         throughout our experiments.

When there are multiple feature points on a single branch, we select the one with the smallest corresponding medial ball because a point on a smaller feature tends to be a better representative of a branch than a point on a larger feature. The resulting set 
                           
                              FP
                           
                         is shown in Fig. 3
                        .

For every feature point 
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                           ∈
                           
                              FP
                           
                         obtained in Section  3.1, we compute 
                           
                              
                                 D
                              
                              
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                              
                           
                         using Dijkstra’s algorithm and sample 
                           
                              
                                 ν
                              
                              
                                 ̄
                              
                           
                         contours uniformly with respect to 
                           
                              
                                 D
                              
                              
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        . Let 
                           
                              
                                 C
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         be the 
                           j
                        -th isocontour centered at 
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                         (using 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                         as abbreviations for 
                           
                              
                                 C
                              
                              
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        ). We can detect topological splits on isocontours if 
                           
                              |
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              |
                           
                           <
                           
                              |
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                    +
                                    1
                                 
                              
                              |
                           
                        , where 
                           
                              |
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              |
                           
                         denotes the number of connected components of 
                           
                              
                                 C
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        . Unlike the existing methods  [19,28] that select only one source point, we construct a topology tree 
                           
                              
                                 T
                              
                              
                                 i
                              
                           
                         for each 
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                           ∈
                           
                              FP
                           
                         locally. If 
                           
                              
                                 j
                              
                              
                                 ′
                              
                           
                         is the lowest index satisfying 
                           
                              |
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    
                                       
                                          j
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              |
                           
                           ≥
                           2
                        , then we search for the boundary of the 
                           i
                        -th leaf branch by investigating 
                           
                              
                                 C
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        s for 
                           j
                           ≤
                           
                              
                                 j
                              
                              
                                 ′
                              
                           
                        . After pruning the branches using these boundaries (called cutting contours), we merge a set of smaller branches into a larger one whenever their cutting contours are close to one another. Then, we again try to find the boundaries of newly introduced larger branches. We repeat this cut-and-merge operation until the local topology trees 
                           
                              
                                 T
                              
                              
                                 i
                              
                           
                         are merged into a global topology tree 
                           T
                        .


                        Cutting. In general, the shape of the isocontour drastically changes near the topological joint. Assuming that the ideal shape of the contour as a planar circle, we encode the shape of 
                           
                              
                                 C
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         using a three-dimensional vector 
                           
                              SD
                           
                           =
                           
                              (
                              
                                 sd
                              
                              
                                 (
                                 1
                                 )
                              
                              ,
                              
                                 sd
                              
                              
                                 (
                                 2
                                 )
                              
                              ,
                              
                                 sd
                              
                              
                                 (
                                 3
                                 )
                              
                              )
                           
                        , where the components denote thickness, flatness and distortion, respectively (see Fig. 4
                        ). The thickness 
                           
                              
                                 
                                    sd
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           
                              (
                              1
                              )
                           
                         of 
                           
                              
                                 C
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         can be defined by the radius of the largest medial ball in the band-shaped region 
                           
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          ¯
                                       
                                    
                                    ¯
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         bounded by 
                           
                              
                                 C
                              
                              
                                 i
                                 ,
                                 j
                                 −
                                 1
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        . For 
                           
                              
                                 
                                    sd
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           
                              (
                              2
                              )
                           
                         and 
                           
                              
                                 
                                    sd
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           
                              (
                              3
                              )
                           
                        , we uniformly sample 
                           ν
                         points 
                           
                              
                                 x
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           
                              
                                 |
                              
                              
                                 l
                              
                           
                        , where 
                           1
                           ≤
                           l
                           ≤
                           ν
                         on 
                           
                              
                                 C
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        , and perform principal component analysis (PCA) on the points to obtain the best-fitting plane 
                           P
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                           
                         with its center 
                           c
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                           
                        . Let 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           
                              
                                 |
                              
                              
                                 l
                              
                           
                         be the projection of 
                           
                              
                                 x
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           
                              
                                 |
                              
                              
                                 l
                              
                           
                         onto 
                           P
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                           
                        . Then, 
                           
                              
                                 
                                    sd
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           
                              (
                              2
                              )
                           
                         and 
                           
                              
                                 
                                    sd
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           
                              (
                              3
                              )
                           
                         are defined by the out-of-plane and the in-plane deviation from the planar circle on 
                           P
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                           
                        , respectively.
                           
                              
                                 (2)
                                 
                                    
                                       
                                          
                                             sd
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                    =
                                    max
                                    
                                       {
                                       
                                          
                                             ρ
                                          
                                          
                                             p
                                          
                                       
                                       |
                                       p
                                       ∈
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      ¯
                                                   
                                                
                                                ¯
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       }
                                    
                                 
                              
                              
                                 (3)
                                 
                                    
                                       
                                          
                                             sd
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                l
                                             
                                          
                                          d
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               ̄
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ν
                                          ∗
                                          
                                             
                                                
                                                   rad
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 (4)
                                 
                                    
                                       
                                          
                                             sd
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                l
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   d
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  ̄
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            j
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                      ,
                                                      c
                                                      
                                                         (
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               i
                                                               ,
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            rad
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          ν
                                          ∗
                                          
                                             
                                                
                                                   rad
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 
                                    rad
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           =
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                    
                                 
                                 d
                                 
                                    (
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          l
                                       
                                    
                                    ,
                                    c
                                    
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       )
                                    
                                    )
                                 
                              
                              
                                 ν
                              
                           
                         denotes the expected radius of 
                           
                              
                                 C
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        . Using these shape descriptors for each 
                           
                              
                                 C
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         we finally choose the 
                           
                              
                                 C
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         that maximizes the following score function (the amount of change) as a cutting contour: 
                           
                              (5)
                              
                                 score
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       ∈
                                       
                                          {
                                          1
                                          ,
                                          2
                                          ,
                                          3
                                          }
                                       
                                    
                                 
                                 
                                    {
                                    ω
                                    
                                       (
                                       l
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      sd
                                                   
                                                
                                                ¯
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       
                                          (
                                          l
                                          )
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   
                                                      sd
                                                   
                                                
                                                ¯
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             −
                                             1
                                          
                                       
                                       
                                          (
                                          l
                                          )
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ω
                                          
                                             (
                                             l
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      sd
                                                   
                                                
                                                ¯
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             +
                                             1
                                          
                                       
                                       
                                          (
                                          l
                                          )
                                       
                                       −
                                       2
                                       
                                          
                                             
                                                
                                                   
                                                      sd
                                                   
                                                
                                                ¯
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       
                                          (
                                          l
                                          )
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      sd
                                                   
                                                
                                                ¯
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                             −
                                             1
                                          
                                       
                                       
                                          (
                                          l
                                          )
                                       
                                       )
                                    
                                    }
                                 
                              
                           
                         where 
                           ω
                           
                              (
                              l
                              )
                           
                         denotes the weight of 
                           
                              sd
                           
                           
                              (
                              l
                              )
                           
                        . The two terms in Eq. (5)approximate the first and the second derivative of 
                           
                              SD
                           
                        , respectively.


                        Merging. The cutting contours 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                           ,
                           1
                           ≤
                           i
                           ≤
                           
                              |
                              
                                 FP
                              
                              |
                           
                         obtained in the previous step estimate the boundaries of such smaller branches, and the thickness of 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         is a good approximation of the size of the corresponding joint. More specifically, 
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           +
                           
                              
                                 
                                    sd
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              1
                              )
                           
                         is the estimation of the length of the 
                           i
                        -th branch, where 
                           
                              
                                 
                                    sd
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              1
                              )
                           
                         is the thickness of 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                        . Thus, we merge the two branches 
                           i
                         and 
                           j
                         if 
                           
                              (6)
                              
                                 D
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 ≤
                                 
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          
                                             sd
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                    )
                                 
                                 +
                                 
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          
                                             sd
                                          
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                    )
                                 
                              
                           
                         implying that the two branches are sufficiently close to each other.

When some smaller branches are merged, an additional joint is needed to clearly identify their merging point, i.e., a cutting plane which acts as a boundary of a newly introduced larger branch. To do this, we again perform PCA on the points on the cutting contours of the smaller branches. For the resulting plane 
                           P
                           =
                           
                              (
                              c
                              ,
                              n
                              )
                           
                         with a center 
                           c
                         and a normal 
                           n
                        , we can check its validity by testing whether the signs of 
                           
                              (
                              x
                              −
                              c
                              )
                           
                           ⋅
                           n
                         for all samples 
                           x
                         are the same. Otherwise, we move 
                           P
                         along the direction of 
                           n
                         until 
                           P
                         clearly cuts out the smaller branches from 
                           M
                        . The final position of 
                           c
                         becomes the merging joint of smaller branches.


                        Cut-and-merge iteration. For each branch with local topology trees 
                           
                              
                                 T
                              
                              
                                 i
                              
                           
                        , we scan the isocontours while checking 
                           
                              |
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              |
                           
                        , and find its cutting contour in the cutting stage. Then, some branches are merged into a larger branch by checking the condition in Eq. (6) in the merging stage. We perform this cut-and-merge iteration repeatedly until the global topology tree 
                           T
                         is obtained.

For each candidate branch in the current iteration round, there are two possible cases while scanning the isocontours on a branch. One is that the topological split is detected successfully in the cutting stage. In this case, the branch should participate as a candidate of the next iteration round because the split implies that this branch is not completely scanned yet. Another possible case is that it penetrates the region covered by different branches before detecting the topological split. When this occurs, we simply stop scanning the branch. The overall process of topology tree construction is described in Fig. 5
                        .

We assign high priorities to thinner branches (i.e. having smaller 
                           
                              sd
                           
                           
                              (
                              1
                              )
                           
                        ) when determining the scanning order among them. As a consequence, the tail branch does not perform the scanning process until all arms and legs are finished (Fig. 5(c) and (d)) because it is attached to the thicker part.


                        Internal joint extraction. The bone of the 
                           i
                        -th branch 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                         obtained in the previous stage is a set of straight lines connecting two joints 
                           
                              
                                 j
                              
                              
                                 i
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 j
                              
                              
                                 i
                              
                              
                                 2
                              
                           
                         of each branch. Our strategy for finding 
                           
                              
                                 j
                              
                              
                                 i
                              
                              
                                 τ
                              
                           
                           ,
                           τ
                           ≥
                           3
                        , is to detect the MA point with the maximum deviation from the current bone. To overcome noise on the MA, we take a subset of 
                           M
                         whose elements are sufficiently close to the skeleton. For every slice 
                           
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          ¯
                                       
                                    
                                    ¯
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           ⊂
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                        , we take the medial balls whose radii are larger than 
                           ω
                           ∗
                           
                              
                                 
                                    sd
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           
                              (
                              1
                              )
                           
                         as reliable samples (setting 
                           ω
                           =
                           0.8
                         throughout our experiments). 
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 i
                              
                           
                         denotes the set of reliable samples on the MA contained in 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                        .

Let 
                           
                              ED
                           
                           
                              (
                              m
                              ,
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                                 
                                    τ
                                 
                              
                              )
                           
                         be the Euclidean distance from 
                           m
                           ∈
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 i
                              
                           
                         to the bone segments induced by the joints in the set 
                           
                              
                                 J
                              
                              
                                 i
                              
                              
                                 τ
                              
                           
                        . Our algorithm incrementally adds the joints 
                           
                              
                                 j
                              
                              
                                 i
                              
                              
                                 τ
                              
                           
                           ,
                           τ
                           ≥
                           3
                         into 
                           
                              
                                 J
                              
                              
                                 i
                              
                           
                         one by one, where 
                           
                              
                                 J
                              
                              
                                 i
                              
                           
                         denotes the set of joints in 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                        . If the magnitude of the change of the current bone is negligible after inserting 
                           
                              
                                 j
                              
                              
                                 i
                              
                              
                                 τ
                              
                           
                        , then we throw out 
                           
                              
                                 j
                              
                              
                                 i
                              
                              
                                 τ
                              
                           
                         and halt the insertion process. The detailed procedure of our internal joint extraction method is described in Fig. 6
                        . We set 
                           
                              
                                 δ
                              
                              
                                 ̄
                              
                           
                           =
                           0.1
                         in our experiments.

Note that our strategy is not an optimization but a handling of local deviation. We choose a point with the maximum deviation (the normalized Euclidean distance with respect to the thickness) as the candidate internal joint (see Line 4 in Fig. 6). Our focus is the extent to which the shape of bones is affected after inserting a joint rather than minimizing 
                           
                              Er
                           
                           
                              (
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                                 
                                    τ
                                 
                              
                              )
                           
                         for every insertion. Thus, 
                           
                              Er
                           
                           
                              (
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                                 
                                    τ
                                 
                              
                              )
                           
                         may not decrease monotonically during the joint insertion process (see Fig. 7
                        ).


                        Skeleton completion. At this point, we have obtained a set of internal joints and associated bones for every branch. Because we now have the actual directions of bones inside the branches, we can adjust the cutting contours of each branch to make the boundaries clearer. For each cutting contour with the plane 
                           P
                           =
                           
                              (
                              c
                              ,
                              n
                              )
                           
                        , we set its new normal 
                           n
                         to be parallel to the direction of the bone adjacent to 
                           c
                         and then move 
                           c
                         along with the direction of 
                           n
                         to adjust its position. This process is similar to that performed in the topology tree extraction stage.

Finally, the root region can be obtained by cutting out every sub-branch using its cutting contour. For each 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 M
                              
                              
                                 
                                    root
                                 
                              
                           
                        , we approximate the root joint 
                           
                              
                                 j
                              
                              
                                 
                                    root
                                 
                              
                           
                           =
                           
                              
                                 ∑
                                 
                                    
                                       ρ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 ∑
                                 
                                    
                                       ρ
                                    
                                    
                                       i
                                    
                                 
                              
                           
                         by the weighted average of the vertex positions, where 
                           
                              
                                 ρ
                              
                              
                                 i
                              
                           
                         is the radius of the medial ball tangent to 
                           M
                         at 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        .

@&#EXPERIMENTAL RESULTS@&#


                     Figs. 8 and 9
                     
                      show the extracted kinematic skeletons and the deformation results after manual rigging for various articulated models, respectively. The feature points and the topological joints are captured quite well. The resulting skeletons convey the abstract structures of given models, indicating that they can be directly used by animators for further processing.

On the other hand, several internal joints are somewhat different from our expectation. Some of them have erroneous positions (e.g., the arms of Armadillo), and others are missing (e.g., the legs of Horse). In fact, our internal joint extraction idea detects the most critical bending within a branch incrementally. The amount of bending depends not only on the angle between two branches around the internal joint but also on the feature sizes of those branches. The bending on the thinner branches is more noticeable than that on the thicker ones if the bending angles are the same. Our algorithm detects internal joints successfully when the bending is quite noticeable, as in the left back leg of Horse in Fig. 8, but the knee joints of the other legs are missed due to the absence of noticeable bending. However, it is extremely difficult to detect the internal joints for such cases in either a geometric or a topological manner without a predefined number of joints or the approximate length of each bone.

The model specifications and the running times are shown in Table 1
                     . Regarding the MA computation time as a preprocessing, the most time-consuming process is the topology tree construction. In our case, not only the model complexity, indicated by 
                        
                           |
                           V
                           |
                        
                      and 
                        
                           |
                           F
                           |
                        
                     , but also the topological complexity of 
                        M
                      are dominant factors to determine the overall running time. The running time of all substeps, including the computation of distance functions, shape descriptors, and cutting contours, is proportional to the number of branches in 
                        T
                     .

@&#CONCLUSION@&#


                     Summary. We proposed a method to extract the kinematic skeleton from an articulated 3D model. Our method is a bottom-up tree construction method which builds an entire skeleton by investigating topological changes on the wavefront of 
                        
                           
                              D
                           
                           
                              p
                           
                        
                        
                           (
                           x
                           )
                        
                     . After that, we refine the resulting skeleton with additional joints based on geometric conditions such as (bending) angle and thickness. The medial axis points are used throughout the process for determining joint position and estimating the thicknesses of branches. Our method is a fully automatic process that does not require manually chosen feature points or markers and is independent of both postures and the number of branches of a given model. Experiments show that our method can efficiently extract kinematic skeletons from various types of articulated bodies and that the results can be directly applied to the character rigging.


                     Limitations and future work. A limitation of our work is that input models should be genus-0 without tunnels. Another limitation is that our method produces star-like skeletons. Though it is suitable for invertebrates such as insects and spiders, the spinal column should be provided for humanoids and four-legged animals to deform the torso part. Finally, a method to symmetrize resulting skeletons to convey the bisymmetric nature of most articulated bodies would be helpful.

@&#ACKNOWLEDGMENTS@&#

This research was supported by the Basic Science Research Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Education, Science and Technology (No. 2010-0024092), and by the KUSTAR-KAIST Institute, Korea, under the R&D program supervised by the KAIST.

@&#REFERENCES@&#

