@&#MAIN-TITLE@&#An impulse-based energy tracking method for collision resolution

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           DEM can be based on penalties or impulses to resolve collisions.


                        
                        
                           
                           The impulse-based energy tracking method (ETM) resolves multiple collisions consistently.


                        
                        
                           
                           ETM models multiple collisions iteratively yet simultaneously, while tracking the system energy.


                        
                        
                           
                           ETM does not rely on penalties and does not require computation of penetration of bodies.


                        
                        
                           
                           The method is validated in the context of energy conservation and meso-scale angles of repose.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Discrete element method

Energy conservation

Impulse method

Multiple-body collision

@&#ABSTRACT@&#


               
               
                  Discrete element methods can be based on either penalties or impulses to resolve collisions. A generic impulse based method, the energy tracking method (ETM), is described to resolve collisions between multiple non-convex bodies in three dimensions. As opposed to the standard sequential impulse method (SQM) and simultaneous impulse method (SMM), which also apply impulses to avoid penetration, the energy tracking method changes the relative velocity between two colliding bodies iteratively yet simultaneously. Its main novelty is that impulses are applied gradually at multi-point contacts, and energy changes at the contact points are tracked to ensure conservation. Three main steps are involved in the propagation of the impulses during the single- and multi-contact resolution: compression, restitution-related energy loss, and separation. Numerical tests show that the energy tracking method captures the energy conservation property of perfectly elastic single- and multi-point collisions. ETM exhibits improved angular velocity estimation, as compared to SMM and SQM, as demonstrated by two numerical examples that model multi-point contact between box-shaped objects. Angles of repose estimated for multi-object pack repositioning of spheres, cubes, and crosses are in good agreement with the reported experimental values.
               
            

@&#INTRODUCTION@&#

The numerical simulation of collision-driven interactions between a large number of bodies has many applications in engineering, ranging from the simulation of rock fragmentation in mining engineering processes  [1–3], to the simulation of particle flow for tumble mills in agriculture  [4]. A robust numerical method to simulate multi-body interaction must satisfy run-time constraints and handle large amounts of fragments of a range of sizes, as well as being stable and physically realistic. Current numerical approaches to model these processes include penalty-based  [5], analytical  [6], and impulse-based methods  [7].

The impulse method, first proposed by Hahn  [8], applies the impulse–momentum form of Newton’s second law to compute collision response within a multi-body system. The family of impulse methods provides an efficient and accurate alternative to resolve high-frequency collisions of hundreds or thousands of colliding bodies. Impulse methods have been shown to be energy conservative  [9], do not rely on penalty parameters, do not require the computation of penetration between bodies, and thrive on their ability of directly using meso-scale material properties. Impulse methods are regularly applied to model haptic interfaces in robotics research  [10] and to simulate the motion of tendons, joints, and muscles  [11,12]. Impulse methods have been used in engineering for simulated sensorless manipulation of objects  [13], and in combination with the finite element method for the simulation of gravity-driven fragmentation  [3]. Unlike a posteriori methods, the impulse-based method does not rely on arbitrary penalty and damping parameters that define repulsion as a function of penetration. Instead, this method models collisions as a function of predicted impact trajectory and impulse. Thus, impulse methods do not require geometric intersection checks, but instead relies on collision time estimation algorithms, e.g. the efficient Lin–Canny algorithm  [14,15]. Contact detection is based on the computation of the relative normal velocity of colliding bodies at each contact point. Newton’s impact law, as defined for a single-point collision, is applied either sequentially in sequential impulse methods (SQM)  [16] or simultaneously in simultaneous impulse methods (SMM)  [17,18] to deal with multiple collisions and multiple contact points. There are at least two versions of simultaneous impulse methods. In 1989, Baraff  [17] proposed a simple version of SMM which treated multiple collisions as a linear complementary problem; this method only considered normal impulses and the change of normal velocities, and it did not consider friction. The generic SMM  [18] enforces constraints on all collisions by solving a system of linear equations, taking into account impulses in the normal and tangential directions, and considering friction. Due to the simultaneous evaluation of collisions, SMM cannot capture the propagation of contact forces during a collision. Sequential impulse methods (SQM) treat multiple concurrent collisions one-by-one, and non-penetration constraints are enforced to multiple collisions sequentially, iterating over the contact points until no objects collide. In SQM, Newton’s impact law is locally applied to each contact, making it particularly well suited for parallelization. A drawback of SQM is that it inverts relative normal velocities of collisions one-by-one, yielding results that depend on the order in which collisions are resolved  [16,19].

The penalty method iteratively computes penalty parameters to enforce collisions as a set of non-penetration constraints  [20,21]. It is widely used due to its simplicity and flexibility  [22–24]. However, this method relies on the definition of an arbitrary, experimentally estimated, normal and tangential stiffness of an enforced spring system that prevents object penetration  [25–27]. Relative high collision velocities lead to large overlaps and exaggerated repulsion forces, and introduce instability to the simulation. This results in gearing the development of the method towards increasing stability and disregarding possible emerging artificial energy gains and losses  [28,29]. The Lagrange multiplier method is an alternative approach that adds unknowns to solve bilateral constraints, such as joint constraints  [29]. The midpoint integration rule combined with the Lagrange multiplier method  [30] and penalty regularization of contact rates  [31,32] has been proposed to ensure energy conservation during collisions. Penalties are applied to solve collision and contact of objects within the context of the discrete element method (DEM)  [33,34], smoothed particle hydrodynamics (SPH)  [35,36], and the material point method (MPM)  [37,38]. Sphere-conglomerates are used to avoid penetration computation penalties  [2]; however, these models are unable to represent smooth surfaces and require large number of spheres that scale with level of detail. Smoothed particle hydrodynamics and the material point method are point-based methods that are best suited to simulate explosions and large deformation problems, and rely on point-to-point contact detection algorithms, resulting in difficult numerical computation of contact force direction  [39]. The main geometric hurdles of the penalty method are the need to calibrate micro-to-macro material properties of conglomerates using laboratory experiments, and the arbitrary definition of penalty parameters during the definition of the non-penetration constraints.

The hybrid finite element–discrete element method  [40] can model deformation of colliding bodies as a function of impact. Deformation of the bodies is penalized by stark computational costs and is well suited for high-resolution models  [24], e.g. impact-driven non-linear degradation of bodies. Models that seek to study emerging behavior from the interaction of hundreds and thousands of objects often assume bodies to be rigid at the moment of impact  [41]. One-way coupling of brittle deformation, such as fragmentation, can be used in combination with the rigidity assumption to reduce computational cost  [3]. Impulse-based methods pose no restriction in their use within the context of deformability.

In analytical methods, the simulation of non-penetration constraints is treated as a linear complementary problem  [42], which does not rely on penalty parameters and does not require use of a damping parameter to remain stable. Its main difficulty is in considering the influence of friction on the collision. For instance, for systems with dynamic or sliding friction, the linear complementary problem matrix becomes non-positive definite and non-symmetric, constraints at the contact point become non-linear, and the problem becomes a non-linear complementarity problem  [29].

Energy conservation is critical to ensure stability of a numerical method, especially for contact and collision problems  [28,43]. A number of conserving schemes have been developed to ensure energy conservation. These schemes make use of the penalty regulation of normal contact constraint and inherit the conservation property from continuum problems. These conservation schemes can conveniently be combined with the finite element method to simulate frictionless  [44] and frictional  [43] contact and collision. Hesch and Betsch  [45] formulated the node-to-segment contact method and solved large deformation contact problems with the conserving scheme. More recently, an energy and momentum-conserving temporal discretization scheme  [46] was developed for adhesive contact problems without considering friction and dissipation. Even though the conserving scheme improves numerical stability, it also inherits from the penalty method the difficulty of having to determine penalty parameters. In order to remove penalty sensitivity, Chawla and Laursen  [47] proposed an energy and momentum conserving algorithm, which makes use of Lagrange multipliers instead of penalty parameters.

The generalized impulse method presented here, called the energy tracking method (ETM), addresses the individual shortcomings of the sequential impulse method (SQM) and simultaneous impulse method (SMM). It is aimed at efficiently and accurately modeling high-frequency collisions of non-convex bodies. ETM treats multiple concurrent collisions as a series of single-point collisions, and introduces an additional level of iteration at each collision time step. At the beginning of the collision analysis the relative velocity is negative, indicating that the bodies are on a collision course. An impulse is applied to each body to avoid penetration, in a step-wise manner, incrementally increasing the relative velocity until it reaches zero. At each step, velocities at each collision point are updated. During this process, kinetic energy decreases and elastic energy at the contact points increases. Subsequently, the relative normal velocity continues to increase until all of the elastic energy is released. As opposed to the standard SQM, ETM gradually applies impulses to change relative normal velocities of multiple collisions iteratively yet simultaneously. In contrast to the SMM, ETM yields low angular velocity errors when dealing with multi-contact collisions, due to its ability to simulate the interaction of forces during collision. ETM is advantageous as it processes collisions in a simultaneous, albeit iterative, manner. Energy is shown to be conservative for large multi-body systems of spheres, cubes and non-convex crosses. Numerical experiments evaluating the angle of repose of systems of these objects compare well with macroscopic laboratory experiments reported in the literature  [48].

The energy tracking method is based on two levels of iteration: iteration for time steps, 
                        
                           t
                        
                     , and iteration for impulse computation at each collision time step, 
                        
                           s
                        
                     . As time progresses, 
                        
                           t
                        
                        =
                        
                           {
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                           ,
                           …
                           }
                        
                     , positions and velocities of bodies are updated. The non-penetration strategy  [14,15], based on the fast search of the closest features among convex polyhedra, identifies collision candidates based on the concept of collision time. Accurate estimation of collision time, 
                        
                           
                              t
                           
                           
                              c
                           
                        
                     , is required to apply impulses and avoid geometric overlap due to collision (Fig. 1
                     ). Impulses are then computed for each contact point using an iterative method, over a set of iterations 
                        
                           s
                        
                        =
                        
                           {
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 2
                              
                           
                           ,
                           …
                           }
                        
                     . The latter captures the propagation of impulses at a single instance in time. 
                        
                           
                              s
                           
                           
                              k
                           
                        
                      indicates the step 
                        k
                     . At step 
                        k
                     , the linear velocity and angular velocity of body 
                        j
                      are denoted as 
                        
                           
                              
                                 v
                              
                           
                           
                              j
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           )
                        
                      and 
                        
                           
                              ω
                           
                           
                              j
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           )
                        
                     . The impulse applied at contact point 
                        
                           
                              c
                           
                           
                              i
                           
                        
                      is denoted as 
                        
                           
                              
                                 p
                              
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           )
                        
                     .

In SQM and SMM, the relative normal velocity is directly inverted. The energy tracking method (ETM), on the other hand, gradually applies the impulses to change the relative normal velocity over a set of iterations, applying impulses to multiple collisions at the same time. This procedure is described for a single-point collision. Without loss of generality, the colliding objects are assumed not to deform.

A body 
                        
                           
                              b
                           
                           
                              N
                           
                        
                      collides with another body 
                        
                           
                              b
                           
                           
                              M
                           
                        
                      at contact point 
                        
                           
                              c
                           
                           
                              i
                           
                        
                      (Fig. 2
                     ). A set of impulses, 
                        
                           {
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              )
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           ,
                           …
                           }
                        
                     , is applied at the contact points to each colliding body sequentially. The subscript 
                        i
                      in 
                        
                           
                              
                                 p
                              
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           )
                        
                      denotes that the impulse is applied to the contact point 
                        
                           
                              c
                           
                           
                              i
                           
                        
                     , and 
                        
                           
                              s
                           
                           
                              k
                           
                        
                      denotes this impulse is applied at the iteration 
                        
                           
                              s
                           
                           
                              k
                           
                        
                     . The velocities of colliding body 
                        
                           
                              b
                           
                           
                              j
                           
                        
                        
                           (
                           j
                           =
                           N
                           
                           or
                           
                           M
                           )
                        
                      at the contact point 
                        
                           
                              c
                           
                           
                              i
                           
                        
                      at iteration 
                        
                           
                              s
                           
                           
                              k
                           
                        
                      is denoted as 
                        
                           (1)
                           
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    i
                                 
                                 
                                    j
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    j
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              +
                              
                                 
                                    
                                       ω
                                    
                                 
                                 
                                    j
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              ×
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    i
                                 
                                 
                                    j
                                 
                              
                           
                        
                      where 
                        
                           
                              
                                 r
                              
                           
                           
                              i
                           
                           
                              j
                           
                        
                        =
                        
                           
                              
                                 {
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       z
                                    
                                    
                                       j
                                    
                                 
                                 }
                              
                           
                           
                              
                                 T
                              
                           
                        
                      is the vector from the center of mass of body 
                        
                           
                              b
                           
                           
                              j
                           
                        
                      to the contact point 
                        
                           
                              c
                           
                           
                              i
                           
                        
                     , which is assumed to be constant during the collision. 
                        
                           
                              
                                 u
                              
                           
                           
                              i
                           
                           
                              j
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           )
                        
                      is the velocity of body 
                        
                           
                              b
                           
                           
                              j
                           
                        
                      at the contact point 
                        
                           
                              c
                           
                           
                              i
                           
                        
                     . 
                        
                           
                              
                                 v
                              
                           
                           
                              j
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           )
                        
                      is the linear velocity at the center of mass, and 
                        
                           
                              ω
                           
                           
                              j
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           )
                        
                      is the angular velocity. The relative velocity of two colliding bodies at contact point 
                        
                           
                              c
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              
                                 u
                              
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           )
                        
                     , is defined as 
                        
                           (2)
                           
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    i
                                 
                                 
                                    N
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              −
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    i
                                 
                                 
                                    M
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              .
                           
                        
                      The change of relative velocity from iteration 
                        
                           
                              s
                           
                           
                              k
                           
                        
                      to iteration 
                        
                           
                              s
                           
                           
                              k
                              +
                              1
                           
                        
                      is defined as 
                        
                           (3)
                           
                              △
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 )
                              
                              −
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

First, an assumption for the change of relative velocity before and after applying an impulse without considering energy loss is described. Energy loss caused by the impulse in the normal direction of the contact surface is handled by Stronge’s hypothesis  [49]. The consideration of friction is introduced in Section  5 for single-point collisions and Section  6 for multiple collisions. When a pair of impulses of opposite signs 
                        
                           
                              
                                 p
                              
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           )
                        
                      and 
                        −
                        
                           
                              
                                 p
                              
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           )
                        
                      is applied to colliding bodies, these impulses effectively change their linear and angular velocities: 
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                m
                                             
                                             
                                                N
                                             
                                          
                                          △
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                N
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          −
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                m
                                             
                                             
                                                M
                                             
                                          
                                          △
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                
                                             
                                             
                                                i
                                             
                                             
                                                N
                                             
                                          
                                          ×
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                
                                                   I
                                                
                                             
                                             
                                                N
                                             
                                          
                                          △
                                          
                                             
                                                ω
                                             
                                             
                                                N
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                
                                             
                                             
                                                i
                                             
                                             
                                                M
                                             
                                          
                                          ×
                                          −
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                
                                                   I
                                                
                                             
                                             
                                                M
                                             
                                          
                                          △
                                          
                                             
                                                ω
                                             
                                             
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              
                                 I
                              
                           
                           
                              N
                           
                        
                      and 
                        
                           
                              
                                 I
                              
                           
                           
                              M
                           
                        
                      are the inertia tensors, which are constant during the collision and are computed using an explicit exact expression  [50], and 
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          △
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                N
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                N
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                N
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          △
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                           
                              (7)
                              
                                 
                                    
                                       
                                          △
                                          
                                             
                                                ω
                                             
                                             
                                                N
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                ω
                                             
                                             
                                                N
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                ω
                                             
                                             
                                                N
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          △
                                          
                                             
                                                ω
                                             
                                             
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                ω
                                             
                                             
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                ω
                                             
                                             
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              m
                           
                           
                              N
                           
                        
                      and 
                        
                           
                              m
                           
                           
                              M
                           
                        
                      are the masses of body 
                        
                           
                              b
                           
                           
                              N
                           
                        
                      and 
                        
                           
                              b
                           
                           
                              M
                           
                        
                     .

Once the change of relative velocity is known, impulses are computed from the collision matrix  [7], 
                        
                           (8)
                           
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       K
                                    
                                 
                                 
                                    i
                                 
                                 
                                    −
                                    1
                                 
                              
                              △
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                           
                        
                      where the collision matrix 
                        
                           
                              
                                 K
                              
                           
                           
                              i
                           
                        
                     , which is constant, non-singular, symmetric, and positive definite, is defined as 
                        
                           (9)
                           
                              
                                 
                                    
                                       K
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             N
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             M
                                          
                                       
                                    
                                 
                                 )
                              
                              
                                 1
                              
                              −
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   I
                                                
                                             
                                             
                                                N
                                             
                                          
                                          )
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       N
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   I
                                                
                                             
                                             
                                                M
                                             
                                          
                                          )
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       M
                                    
                                 
                                 )
                              
                           
                        
                      where 
                        
                           1
                        
                      is the identity matrix, and 
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       N
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             0
                                          
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   z
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   y
                                                
                                                
                                                   N
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   z
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                                
                                                   N
                                                
                                             
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   y
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                              
                           
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       M
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             0
                                          
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   z
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   y
                                                
                                                
                                                   M
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   z
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                                
                                                   M
                                                
                                             
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   y
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        
                      where 
                        
                           
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              i
                           
                           
                              N
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              i
                           
                           
                              M
                           
                        
                      are the cross-product matrix of 
                        
                           
                              
                                 r
                              
                           
                           
                              i
                           
                           
                              N
                           
                        
                      and 
                        
                           
                              
                                 r
                              
                           
                           
                              i
                           
                           
                              M
                           
                        
                     .

ETM applies Stronge’s hypothesis  [49] to express the energy dissipation in the normal direction. Let 
                        
                           
                              W
                           
                           
                              
                                 release
                              
                           
                        
                      be the work done by the normal component of the collision impulse during a collision. Then,  [7]
                     
                        
                           (12)
                           
                              
                                 
                                    W
                                 
                                 
                                    
                                       release
                                    
                                 
                              
                              =
                              −
                              
                                 
                                    e
                                 
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    W
                                 
                                 
                                    m
                                    c
                                 
                              
                           
                        
                      where 
                        
                           
                              e
                           
                           
                              n
                           
                        
                        ∈
                        
                           (
                           0
                           ,
                           1
                           )
                        
                      is the normal restitution coefficient which is a measurement of bounce, where 
                        
                           
                              e
                           
                           
                              n
                           
                        
                        =
                        1
                      implies a perfectly elastic collision and 
                        
                           
                              e
                           
                           
                              n
                           
                        
                        =
                        0
                      implies that the relative normal velocity is reduced to zero after the collision, and 
                        
                           
                              W
                           
                           
                              m
                              c
                           
                        
                      is the work done by the normal impulse at the point of maximum compression, where the relative normal velocity changes sign.

For the following analysis, a local orthogonal coordinate system in 
                        
                           {
                           
                              
                                 
                                    t
                                 
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 
                                    n
                                 
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 
                                    q
                                 
                              
                              
                                 i
                              
                           
                           }
                        
                      is defined at the locality of the contact in terms of the normal and tangential components of the collision (Fig. 3
                     ). It follows that
                        
                           
                              (13)
                              
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ×
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          |
                                          
                                             
                                                
                                                   u
                                                
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          |
                                       
                                    
                                 
                              
                           
                           
                              (14)
                              
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ×
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              
                                 n
                              
                           
                           
                              i
                           
                        
                      is the normal direction of collision surface, and 
                        
                           
                              
                                 t
                              
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              
                                 q
                              
                           
                           
                              i
                           
                        
                      are the two tangential directions at the contact point. It follows that the impulse 
                        
                           
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           )
                        
                        =
                        
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       q
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 }
                              
                           
                           
                              
                                 T
                              
                           
                        
                      and relative velocity 
                        
                           
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           )
                        
                      can be formulated in terms of this local coordinate system as 
                        
                           (15)
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                
                                                   L
                                                
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   u
                                                
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                
                                                   L
                                                
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              
                                 L
                              
                           
                           
                              i
                           
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                           
                              
                                 T
                              
                           
                        
                      defines the transformation from global to local coordinates.

Mirtich  [7] proposed that the work done by contact forces, 
                        △
                        
                           
                              W
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           )
                        
                     , is path independent and is a function of the relative velocity before and after applying the impulse: 
                        
                           (16)
                           
                              △
                              
                                 
                                    W
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    
                                       K
                                    
                                 
                                 
                                    i
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          u
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 −
                                 
                                    
                                       
                                          u
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 )
                              
                              .
                           
                        
                      The amounts of work done by the normal and tangential impulses are considered separately. 
                        Lemma 3.1
                        
                           During a collision, the work done by the impulse can be decomposed into the work done by the impulse in the normal direction and the work done by the impulse in the tangential direction, as follows
                           
                              
                                 
                                    (17)
                                    
                                       △
                                       
                                          
                                             W
                                          
                                          
                                             i
                                             ,
                                             t
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          2
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          +
                                          △
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             t
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    (18)
                                    
                                       △
                                       
                                          
                                             W
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          2
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                n
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          +
                                          △
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                n
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    (19)
                                    
                                       △
                                       
                                          
                                             W
                                          
                                          
                                             i
                                             ,
                                             q
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          2
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                q
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          +
                                          △
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                q
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             q
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           
                        


                     
                        Proof
                        According to Eq. (16), the work done by the contact force from iteration 
                              
                                 
                                    s
                                 
                                 
                                    k
                                 
                              
                            to 
                              
                                 
                                    s
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                            is: 
                              
                                 (20)
                                 
                                    △
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             K
                                          
                                       
                                       
                                          i
                                       
                                       
                                          
                                             −1
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    .
                                 
                              
                            Substituting Eq. (8) into the previous equation yields 
                              
                                 (21)
                                 
                                    △
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                            Considering the collision in the local coordinate system defined by Eqs. (13) and (14), it follows that: 
                              
                                 
                                    (22)
                                    
                                       △
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         L
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      
                                                         L
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                          
                                             
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             i
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    (23)
                                    
                                       △
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                          
                                             
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             i
                                          
                                          
                                             −
                                             
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             i
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                            Since 
                              
                                 
                                    
                                       L
                                    
                                 
                                 
                                    i
                                 
                              
                            is an orthogonal matrix, 
                              
                                 
                                    
                                       L
                                    
                                 
                                 
                                    i
                                 
                                 
                                    −
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       L
                                    
                                 
                                 
                                    i
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                           , 
                              
                                 (24)
                                 
                                    △
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                              
                            and 
                              
                                 (25)
                                 
                                    △
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      2
                                                      
                                                         
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            t
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         )
                                                      
                                                      +
                                                      △
                                                      
                                                         
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            t
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      2
                                                      
                                                         
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            n
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         )
                                                      
                                                      +
                                                      △
                                                      
                                                         
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            n
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      2
                                                      
                                                         
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            q
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         )
                                                      
                                                      +
                                                      △
                                                      
                                                         
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            q
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      t
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      q
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                            Thus, 
                              
                                 
                                    (26)
                                    
                                       △
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       △
                                       
                                          
                                             W
                                          
                                          
                                             i
                                             ,
                                             t
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       +
                                       △
                                       
                                          
                                             W
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       +
                                       △
                                       
                                          
                                             W
                                          
                                          
                                             i
                                             ,
                                             q
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    (27)
                                    
                                       △
                                       
                                          
                                             W
                                          
                                          
                                             i
                                             ,
                                             t
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          2
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          +
                                          △
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             t
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    (28)
                                    
                                       △
                                       
                                          
                                             W
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          2
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                n
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          +
                                          △
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                n
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    (29)
                                    
                                       △
                                       
                                          
                                             W
                                          
                                          
                                             i
                                             ,
                                             q
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          2
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                q
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          +
                                          △
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             q
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           
                           □


                     
                        Lemma 3.2
                        
                           During a collision, if the impulse is only applied in the normal direction of the colliding surface, where 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              =
                              0
                            
                           and 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    r
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              =
                              0
                            
                           in local coordinates, then, the work done by the contact force can be expressed as a function of the change of relative normal velocity:
                           
                              
                                 (30)
                                 
                                    △
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       2
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       +
                                       △
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             H
                                          
                                          
                                             21
                                          
                                       
                                       A
                                       +
                                       
                                          
                                             H
                                          
                                          
                                             22
                                          
                                       
                                       +
                                       
                                          
                                             H
                                          
                                          
                                             23
                                          
                                       
                                       B
                                       )
                                    
                                    △
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          n
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                              
                           
                           where,
                           
                              
                                 
                                    (31)
                                    
                                       
                                          H
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         13
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         22
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         23
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         31
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         32
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         33
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       =
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                K
                                             
                                          
                                          
                                             i
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   L
                                                
                                             
                                             
                                                i
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    (32)
                                    
                                       A
                                       =
                                       −
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   23
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   12
                                                
                                             
                                             −
                                             
                                                
                                                   H
                                                
                                                
                                                   13
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   32
                                                
                                             
                                          
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   33
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   11
                                                
                                             
                                             −
                                             
                                                
                                                   H
                                                
                                                
                                                   13
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   31
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    (33)
                                    
                                       B
                                       =
                                       −
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   31
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   12
                                                
                                             
                                             −
                                             
                                                
                                                   H
                                                
                                                
                                                   11
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   32
                                                
                                             
                                          
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   31
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   13
                                                
                                             
                                             −
                                             
                                                
                                                   H
                                                
                                                
                                                   11
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   33
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        


                     
                        Proof
                        According to Eq. (18), the work done by the normal contact force is independent of the change of the relative velocity in the tangential direction, and can be expressed as a function of the change of relative velocity in the normal direction: 
                              
                                 (34)
                                 
                                    △
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       2
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       +
                                       △
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          n
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                            To replace 
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                            by a function of 
                              △
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                           , the relationship between 
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                            and 
                              △
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                            is expressed as: 
                              
                                 
                                    (35)
                                    
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                K
                                             
                                          
                                          
                                             i
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       △
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    (36)
                                    
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                K
                                             
                                          
                                          
                                             i
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             △
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    (37)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                K
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             i
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             △
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    (38)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          H
                                       
                                       
                                          
                                             △
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    (39)
                                    
                                       
                                          H
                                       
                                       =
                                       
                                          L
                                       
                                       
                                          
                                             
                                                K
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   L
                                                
                                                )
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 
                                    (40)
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         n
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         q
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         13
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         22
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         23
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         31
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         32
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         33
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       
                                          [
                                          
                                             
                                                
                                                   △
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   △
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         n
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   △
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         q
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                                 
                                    (41)
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         n
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         q
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                   △
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                   △
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         n
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         13
                                                      
                                                   
                                                   △
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         q
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                   △
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         22
                                                      
                                                   
                                                   △
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         n
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         23
                                                      
                                                   
                                                   △
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         q
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         31
                                                      
                                                   
                                                   △
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         32
                                                      
                                                   
                                                   △
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         n
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         33
                                                      
                                                   
                                                   △
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         q
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              =
                              0
                            and 
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    q
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              =
                              0
                           . 
                              
                                 (42)
                                 
                                    
                                       [
                                       
                                          
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      11
                                                   
                                                
                                                △
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      t
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      12
                                                   
                                                
                                                △
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      13
                                                   
                                                
                                                △
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      q
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      21
                                                   
                                                
                                                △
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      t
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      22
                                                   
                                                
                                                △
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      23
                                                   
                                                
                                                △
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      q
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      31
                                                   
                                                
                                                △
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      t
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      32
                                                   
                                                
                                                △
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      33
                                                   
                                                
                                                △
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      q
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                            Regarding 
                              △
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                            as unknown and solving above equation, 
                              △
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    t
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                            and 
                              △
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    q
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                            can be expressed as function of 
                              △
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                           : 
                              
                                 
                                    (43)
                                    
                                       △
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             t
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       −
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   33
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   12
                                                
                                             
                                             −
                                             
                                                
                                                   H
                                                
                                                
                                                   13
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   32
                                                
                                             
                                          
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   33
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   11
                                                
                                             
                                             −
                                             
                                                
                                                   H
                                                
                                                
                                                   13
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   31
                                                
                                             
                                          
                                       
                                       △
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       A
                                       △
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    (44)
                                    
                                       △
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             q
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       −
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   31
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   12
                                                
                                             
                                             −
                                             
                                                
                                                   H
                                                
                                                
                                                   11
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   32
                                                
                                             
                                          
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   31
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   13
                                                
                                             
                                             −
                                             
                                                
                                                   H
                                                
                                                
                                                   11
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   33
                                                
                                             
                                          
                                       
                                       △
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       B
                                       △
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                            Then 
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                            is expressed as a function of 
                              △
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                           , 
                              
                                 (45)
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          n
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             H
                                          
                                          
                                             21
                                          
                                       
                                       A
                                       +
                                       
                                          
                                             H
                                          
                                          
                                             22
                                          
                                       
                                       +
                                       
                                          
                                             H
                                          
                                          
                                             23
                                          
                                       
                                       B
                                       )
                                    
                                    △
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          n
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                            Substituting the previous equation into Eq. (18) yields: 
                              
                                 (46)
                                 
                                    △
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       2
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       +
                                       △
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             H
                                          
                                          
                                             21
                                          
                                       
                                       A
                                       +
                                       
                                          
                                             H
                                          
                                          
                                             22
                                          
                                       
                                       +
                                       
                                          
                                             H
                                          
                                          
                                             23
                                          
                                       
                                       B
                                       )
                                    
                                    △
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          n
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                           □

By manipulating Eq. (46), the change of the relative normal velocity is defined as follows, if the change of energy is known: 
                        
                           
                              (47)
                              
                                 △
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 =
                                 −
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 ±
                                 
                                    
                                       C
                                       +
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                           
                              (48)
                              
                                 C
                                 =
                                 
                                    
                                       2
                                       △
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             H
                                          
                                          
                                             21
                                          
                                       
                                       A
                                       +
                                       
                                          
                                             H
                                          
                                          
                                             22
                                          
                                       
                                       +
                                       
                                          
                                             H
                                          
                                          
                                             23
                                          
                                       
                                       B
                                    
                                 
                                 .
                              
                           
                        
                      Since the relative normal velocity increases during simulation, the positive solution is chosen: 
                        
                           (49)
                           
                              
                                 △
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       ,
                                       n
                                    
                                    
                                       
                                          max
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 =
                                 −
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       C
                                       +
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                           
                              
                                 C
                                 =
                                 
                                    
                                       2
                                       △
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             H
                                          
                                          
                                             21
                                          
                                       
                                       A
                                       +
                                       
                                          
                                             H
                                          
                                          
                                             22
                                          
                                       
                                       +
                                       
                                          
                                             H
                                          
                                          
                                             23
                                          
                                       
                                       B
                                    
                                 
                                 .
                              
                           
                        
                     
                  

In SQM and SMM, the impulse is defined by Eq. (8), once the change of relative velocity is determined by Newton’s impact law. In ETM, the change of relative velocity is first computed in the normal direction, after which friction is considered. A static friction condition is defined, assuming that there is no tangential velocity after collision, such that the change of relative normal velocity is given by 
                        
                           (50)
                           
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       [
                                       
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                +
                                                △
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              .
                           
                        
                      The impulse in this case is expressed as 
                        
                           
                              
                                 p
                              
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           )
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       
                                          K
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                           
                              −
                              1
                           
                        
                        △
                        
                           
                              
                                 u
                              
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           )
                        
                      (Eq. (8)). Decomposing this impulse into its normal and tangential directions, 
                        
                           
                              (51)
                              
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       i
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       i
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           
                              (52)
                              
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       i
                                       ,
                                       q
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 −
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       i
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                              
                           
                        
                      where the static friction condition is defined as 
                        
                           (53)
                           
                              
                                 |
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       i
                                       ,
                                       q
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 |
                              
                              ≤
                              μ
                              
                                 |
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       i
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 |
                              
                              .
                           
                        
                      If the static friction condition is satisfied, the above impulse is expressed by Eq. (8). Otherwise, the impulse is re-computed as follows, to ensure that the change of relative normal velocity is 
                        △
                        
                           
                              
                                 
                                    u
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              i
                              ,
                              n
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           )
                        
                      after applying the impulses. The impulse is expressed as 
                        
                           (54)
                           
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              
                                 
                                    
                                       n
                                    
                                 
                                 
                                    i
                                 
                              
                              +
                              μ
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    i
                                 
                              
                           
                        
                      where 
                        
                           (55)
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    △
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          n
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          i
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       
                                          
                                             K
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       μ
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                              .
                           
                        
                     
                  


                     
                        Proof
                        The tangential impulse is derived as follows. 
                              
                                 (56)
                                 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          i
                                          ,
                                          q
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    =
                                    μ
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          n
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          i
                                       
                                    
                                    .
                                 
                              
                            So 
                              
                                 
                                    (57)
                                    
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             i
                                             ,
                                             q
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       +
                                       μ
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    (58)
                                    
                                       
                                          
                                             
                                                K
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       △
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    (59)
                                    
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             i
                                          
                                          
                                             
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                K
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             i
                                          
                                          
                                             
                                                T
                                             
                                          
                                       
                                       △
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    (60)
                                    
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             i
                                          
                                          
                                             
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                K
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                i
                                                ,
                                                n
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                i
                                             
                                          
                                          μ
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                n
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       =
                                       △
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    (61)
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             △
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   n
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                
                                                
                                                   i
                                                
                                                
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      K
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                +
                                                μ
                                                
                                                   
                                                      
                                                         q
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                           □

Once collisions are identified, a series of impulses are applied to avoid penetration. Unlike SQM and SMM, ETM does not invert the relative normal velocity, 
                        
                           
                              
                                 
                                    u
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              i
                              ,
                              n
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           )
                        
                     , directly, 
                        
                           
                              
                                 
                                    u
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              i
                              ,
                              n
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           )
                        
                        =
                        −
                        
                           
                              e
                           
                           
                              n
                           
                        
                        
                           
                              
                                 
                                    u
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              i
                              ,
                              n
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           )
                        
                     . Instead, it updates the relative normal velocity gradually over a set of iterations, 
                        
                           {
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 s
                              
                              
                                 λ
                              
                           
                           }
                        
                     , by applying a set of impulses, 
                        
                           {
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              )
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           ,
                           …
                           }
                        
                     , sequentially. This is advantageous, as it allows tracking of the change of relative normal velocity and elastic energy at each contact point, and the fluctuation of kinetic energy of system during a single collision (Fig. 4
                     ). The collision response is divided into three stages: compression, in which 
                        
                           
                              
                                 
                                    u
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              i
                              ,
                              n
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           )
                        
                      is negative; restitution, stage in which the estimated energy loss can be accounted for; and separation, in which the relative normal velocities are positive. The initial change of relative normal velocity, 
                        △
                        
                           
                              
                                 
                                    u
                                 
                                 
                                    ̇
                                 
                              
                           
                           
                              n
                           
                        
                     , is defined as
                        
                           (62)
                           
                              △
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    n
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          n
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                                 
                                    λ
                                 
                              
                           
                        
                      where 
                        
                           
                              
                                 
                                    u
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              i
                              ,
                              n
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           )
                        
                      is the initial relative normal velocity, and 
                        λ
                      is a positive integer which controls the rate of change of the relative normal velocity during collision analysis. The parameter 
                        λ
                      counts the number of iterations for impulse computation at each collision time step. Without loss of generality, the change of relative normal velocity is initially chosen as 
                        △
                        
                           
                              
                                 
                                    u
                                 
                                 
                                    ̇
                                 
                              
                           
                           
                              n
                           
                        
                      for each iteration, and is recomputed at different stages to ensure energy conservation (Algorithm 1).


                     
                        
                           
                        
                     
                  

The compression of two colliding bodies is modeled while taking friction into account. The assumption of the change of relative normal velocity from iteration 
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                         to iteration 
                           
                              
                                 s
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         is expressed as 
                           
                              (63)
                              
                                 △
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             △
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             if  
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   n
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             +
                                             △
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                             <
                                             0
                                          
                                       
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                |
                                             
                                          
                                          
                                             if  
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   n
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             +
                                             △
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                             >
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         The change of relative normal velocity is defined as 
                           △
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ̇
                                    
                                 
                              
                              
                                 n
                              
                           
                        , unless the relative normal velocity becomes positive after applying the impulse. In this case, the change of relative normal velocity is recomputed to ensure that it reaches zero after applying the impulse for a single collision.

Once the assumption for the change of the relative normal velocity is established, the impulse is obtained from Eqs. (50)–(55). Work done by the impulse in the normal direction, 
                           △
                           
                              
                                 W
                              
                              
                                 i
                                 ,
                                 n
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    k
                                 
                              
                              )
                           
                        , is expressed by Eq. (16). The elastic energy at the contact point before the collision is set to zero: 
                           
                              
                                 W
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           =
                           0
                        . At each step, the energy due to the normal contact force at contact point 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                         is updated, according to
                           
                              (64)
                              
                                 
                                    
                                       W
                                    
                                    
                                       i
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       W
                                    
                                    
                                       i
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 +
                                 △
                                 
                                    
                                       W
                                    
                                    
                                       i
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

At the end of the first stage, the work done by the normal impulse reaches the maximum value, and the sign of the relative normal velocity changes to positive. Energy dissipation in the normal direction is expressed by Stronge’s hypothesis  [49],
                           
                              (65)
                              
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

Separation of two colliding bodies is modeled taking friction into account. The change of relative normal velocity from iteration 
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                         to iteration 
                           
                              
                                 s
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         is expressed as 
                           
                              (66)
                              
                                 △
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             △
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             if  
                                             △
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                             ≤
                                             △
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                   ,
                                                   n
                                                
                                                
                                                   
                                                      max
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             △
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                   ,
                                                   n
                                                
                                                
                                                   
                                                      max
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             if  
                                             △
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                             >
                                             △
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                   ,
                                                   n
                                                
                                                
                                                   
                                                      max
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         The change of relative normal velocity is defined as 
                           △
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ̇
                                    
                                 
                              
                              
                                 n
                              
                           
                        . However, there is a limitation to the change of relative normal velocity: its maximum change is capped by the maximum work which can be done by the impulse, equal to the elastic energy absorbed at the contact point. Therefore, there is a maximum change of relative normal velocity, 
                           △
                           
                              
                                 u
                              
                              
                                 i
                                 ,
                                 n
                              
                              
                                 
                                    max
                                 
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    k
                                 
                              
                              )
                           
                        , which releases the residual energy at the contact point. This maximum change of the relative normal velocity is expressed by Eq. (49). In Eq. (47) there are two solutions for the change of relative normal velocity, the positive sign is always chosen, as the relative velocity is assumed to increase during this stage. Once the assumption of the change of relative normal velocity is established, the impulse is computed using Eqs. (50)–(55). The work done by the impulse, 
                           △
                           
                              
                                 W
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    k
                                 
                              
                              )
                           
                        , is expressed by Eq. (16). As in Stage I, the energy at each contact point 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                         is updated at each step according to Eq. (64). The relative normal velocity and energy are updated gradually over iterations. The iterating stops when 
                           
                              
                                 W
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    k
                                 
                              
                              )
                           
                           ≤
                           0
                         (see Algorithm 1).


                     Fig. 5
                      illustrates multiple collisions, 
                        
                           c
                        
                        =
                        
                           {
                           
                              
                                 c
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 c
                              
                              
                                 n
                              
                           
                           }
                        
                     , between multiple bodies, 
                        
                           b
                        
                        =
                        
                           {
                           
                              
                                 b
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 b
                              
                              
                                 m
                              
                           
                           }
                        
                     , detected at a time step 
                        
                           
                              t
                           
                           
                              c
                           
                        
                     , where 
                        m
                      is the total colliding bodies and 
                        n
                      is the total contact points. At each iteration, multiple collisions are treated as concurrent collisions and impulses are computed and applied to contact points sequentially. The interaction of multiple collisions is simulated by repeating the computation until all relative normal velocities are non-negative (Algorithm 2). The computation for multiple collisions consists of three main stages.


                     
                        
                           
                        
                     
                  

Impulses are applied to eliminate all negative relative normal velocities among contact points. At each iteration 
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                        , the contact point with the smallest relative normal velocity, the minimum contact point, 
                           
                              
                                 c
                              
                              
                                 
                                    min
                                 
                              
                           
                        , is identified. If the minimum contact point is colliding (its relative normal velocity is negative), a pair of impulses, obtained using Eqs. (50)–(55) considering friction, is applied to 
                           
                              
                                 c
                              
                              
                                 
                                    min
                                 
                              
                           
                         to resolve the collision. The change of relative normal velocity is given by Eq. (63). The work done by normal impulses is computed using Eq. (16), and the energy at the contact point is updated. The linear and angular velocities of the colliding bodies, and the relative velocities of all related contact points, are also updated. The procedure is repeated until 
                           
                              
                                 c
                              
                              
                                 
                                    min
                                 
                              
                           
                         is not colliding. At the end of this stage, all relative normal velocities will be non-negative, and the total energy among collisions reaches its maximum value.

Energy dissipation in the normal direction is applied sequentially over all collisions, applying Stronge’s hypothesis (Eq. (65)).

Impulses are applied to progressively release energy at all collision points. At each iteration 
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                        , contact points, 
                           
                              c
                           
                        , are sequentially evaluated. If the elastic 
                           
                              
                                 W
                              
                              
                                 i
                                 ,
                                 n
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         is positive, a pair of impulses, 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         and 
                           −
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         is applied to contact point 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                         to release energy. This computation is repeated until the energy at all contact points is zero, i.e. 
                           max
                           
                              {
                              
                                 
                                    W
                                 
                                 
                                    i
                                 
                              
                              }
                           
                           =
                           0
                        . For each iteration 
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                         and each collision 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                        , impulses are expressed by Eqs. (50)–(55). The change of relative velocity is given by Eq. (66). The work done by normal impulses is computed using Eq. (16). Subsequently, the energy of the collision, and the velocities of the colliding bodies related to contact point 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                        , are updated. The three stages described above are repeated until no negative relative normal velocity remains. As in SQM, ETM cannot ensure termination after a certain number of iterations for perfectly elastic collisions. For oscillating cases, termination is enforced after the three stages have been repeated a finite amount of times, e.g. 300, after which the normal restitution is set to zero. Once the restitution is zero, the computation is ensured to terminate after a few iterations.

ETM is investigated using selected numerical tests. The collision of two tetrahedra validates the performance of ETM for single-point collisions. A series of multi-contact scenarios are selected to exhibit ETM advantages as compared to SQM and SMM. In some cases gravity is disregarded, certain examples are assumed perfectly elastic to evaluate possible artificial energy losses and gains, and in all the cases time step size is assumed to be 1/600 seconds. Energy conservation and repose angles are evaluated for a series of packing and repositioning numerical tests involving spheres, cubes, and non-convex cross objects.

In the following tests, the total system energy, 
                        
                           
                              E
                           
                           
                              t
                           
                        
                     , is expressed as 
                        
                           (67)
                           
                              
                                 
                                    E
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                    
                                       p
                                    
                                 
                                 +
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                 
                                 
                                    N
                                 
                              
                              
                                 (
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                                 g
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             V
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 v
                                 )
                              
                           
                        
                      where 
                        n
                      is the number of bodies, 
                        
                           
                              E
                           
                           
                              i
                           
                           
                              p
                           
                        
                      and 
                        
                           
                              E
                           
                           
                              i
                           
                           
                              k
                           
                        
                      are the potential energy and kinetic energy of body 
                        i
                        ,
                        
                           
                              m
                           
                           
                              i
                           
                        
                      is the mass of body 
                        i
                        ,
                        g
                      is gravity acceleration, 
                        
                           
                              h
                           
                           
                              i
                           
                        
                      is the height of the center of gravity of body 
                        i
                        ,
                        
                           
                              V
                           
                           
                              i
                           
                        
                      is the volume, and 
                        
                           u
                        
                        
                           (
                           
                              x
                           
                           )
                        
                      is the linear velocity at integration point 
                        
                           x
                        
                     . The relative error of 
                        
                           
                              E
                           
                           
                              t
                           
                        
                      is measured as follows: 
                        
                           (68)
                           
                              
                                 
                                    ξ
                                 
                                 
                                    
                                       
                                          E
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              =
                              
                                 |
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             t
                                          
                                          
                                             b
                                          
                                       
                                       −
                                       
                                          
                                             E
                                          
                                          
                                             t
                                          
                                          
                                             f
                                          
                                       
                                    
                                    
                                       
                                          
                                             E
                                          
                                          
                                             t
                                          
                                          
                                             b
                                          
                                       
                                    
                                 
                                 |
                              
                           
                        
                      where 
                        
                           
                              E
                           
                           
                              t
                           
                           
                              b
                           
                        
                      and 
                        
                           
                              E
                           
                           
                              t
                           
                           
                              f
                           
                        
                      are the energies before and after collision.

The energy tracking method is investigated using a single-point collision of two tetrahedra, 
                           a
                         and 
                           b
                         (Fig. 6
                        (a)). Initial linear and angular velocities of body 
                           a
                         are 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 a
                              
                           
                           =
                           
                              (
                              0
                              ,
                              0
                              ,
                              −
                              100
                              )
                           
                           
                           
                              m
                           
                           /
                           
                              s
                           
                         and 
                           
                              
                                 ω
                              
                              
                                 a
                              
                           
                           =
                           
                              (
                              5
                              ,
                              10
                              ,
                              3
                              )
                           
                           
                           
                              rad
                           
                           /
                           
                              s
                           
                        , respectively. Body 
                           b
                         is initially static and only moves after the collision. No external force acts on these bodies. In this test, the collision is assumed to be perfectly elastic and frictionless, i.e.  
                           
                              
                                 e
                              
                              
                                 n
                              
                           
                           =
                           1
                         and 
                           μ
                           =
                           0
                        . The experiment constitutes a simple closed system, which is expected to be energy conservative.

The progression of the relative normal velocity, elastic and kinetic energy at the contact point, and the total system energy are plotted in Fig. 6(b) for 
                           λ
                           =
                           200
                        . During the simulation of collision, the total energy of the system remains constant. During the first stage, the relative normal velocity changes from −211.84 to 0 m/s, the elastic energy at the contact point increases from 0 to 60124 J, and the kinetic energy decreases from 83809.2 to 23685.2 J. During the third stage, the relative normal velocity changes from 0 to 211.84 m/s, the elastic energy at the contact point decreases from 60124 to 0 J, and the kinetic energy decreases from 23685.2 to 83809.2 J. Only a single contact point is taken into account here. In Fig. 6(b), energies are divided by 300 to aid visualization.

The influence of 
                           λ
                         is investigated by measuring the relative error of total energy. A variation of the error is measured for increasing 
                           λ
                         values of 
                           
                              {
                              1
                              ,
                              5
                              ,
                              10
                              ,
                              100
                              ,
                              200
                              ,
                              500
                              }
                           
                        , yielding errors, 
                           
                              (69)
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       
                                          
                                             E
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 =
                                 
                                    {
                                    1.73
                                    ×
                                    1
                                    
                                       
                                          0
                                       
                                       
                                          −
                                          16
                                       
                                    
                                    ,
                                    6.94
                                    ×
                                    1
                                    
                                       
                                          0
                                       
                                       
                                          −
                                          16
                                       
                                    
                                    ,
                                    1.21
                                    ×
                                    1
                                    
                                       
                                          0
                                       
                                       
                                          −
                                          15
                                       
                                    
                                    ,
                                    1.73
                                    ×
                                    1
                                    
                                       
                                          0
                                       
                                       
                                          −
                                          16
                                       
                                    
                                    ,
                                    1.51
                                    ×
                                    1
                                    
                                       
                                          0
                                       
                                       
                                          −
                                          14
                                       
                                    
                                    ,
                                    1.42
                                    ×
                                    1
                                    
                                       
                                          0
                                       
                                       
                                          −
                                          14
                                       
                                    
                                    }
                                 
                              
                           
                         that are initially close to the numerical epsilon, but increase by two orders of magnitude for 
                           λ
                           =
                           500
                        . The consistently low errors indicate that the single collision can be resolved exactly. The increase of this error, with increasing 
                           λ
                        , reflects the accumulation of the numerical error due to the increased number of iterations and operations. This numerical error is also observed to be low.

The simultaneous impulse method (SMM) inserts all collisions into a system of linear equations, so that constraints on the relative normal velocities, 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 ,
                                 n
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              )
                           
                           =
                           −
                           
                              
                                 e
                              
                              
                                 n
                              
                           
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 ,
                                 n
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        , are enforced simultaneously. 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 ,
                                 n
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 ,
                                 n
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         are the relative normal velocities before and after collision, respectively. In some cases, this empirical velocity constraint does not match real physical behavior. The example investigated in this section is one of them.

Consider the collision of two box-shaped bodies, where one is static and the other dynamic, and gravity is ignored. The initial linear velocity of the cube is (0, 0, −10) m/s and its angular velocity is zero. The moving cube is expected to rotate after the collision, as all of its contact points are located on one half of the contact surface, and are repelled upwards after the collision, generating a positive rotational moment that throws the body out of balance. For SMM, since relative normal velocities at all contact points are the same before the collision, 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 ,
                                 n
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           =
                           −
                           10
                           
                           
                              m
                           
                           /
                           
                              s
                           
                        , the relative normal velocities at all contact points are the same after the collision, 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                                 ,
                                 n
                              
                           
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           =
                           10
                           
                           
                              m
                           
                           /
                           
                              s
                           
                        . Therefore, SMM does not model the rotation which is a function of the propagation of the impulses during collision (Fig. 7
                        (a)). Angular velocities in the 
                           x
                           ,
                           y
                         and 
                           z
                         directions of the SQM and ETM are plotted in Fig. 7(b). SMM fails to predict post-collision non-zero angular velocities. In contrast, ETM predicts angular velocities that agree with the expected rotation.

The collision of a 2×2×1 m box-shaped body and the ground is now investigated. Gravity is ignored, and the collision is assumed to be perfectly elastic. The initial linear and angular velocities are (1, 1, −10) m/s and zero, respectively. Since there is no initial angular velocity of the cube before collision, and the ground surface is perfectly horizontal, the linear velocity after the collision should be exactly inverted, and the angular velocity should remain zero.

In this test, the relative error of the velocity is used to track the effect of 
                           λ
                         on the quality of the simulation: 
                           
                              (70)
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       
                                          v
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          |
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                f
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                o
                                             
                                          
                                          |
                                       
                                    
                                    
                                       
                                          |
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                o
                                             
                                          
                                          |
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 o
                              
                           
                         is the initial linear or angular velocity of the object at the beginning of simulation, and 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 f
                              
                           
                         are the final linear or angular velocity of the object after collision resolution.

SQM treats multiple collisions as concurrent collisions, and simply inverts the relative normal velocity after applying the impulse. Thus, impulses are applied to collisions one by one, and not simultaneously. In contrast, ETM applies the impulses to multiple collisions simultaneously, but does so by gradually increasing the relative normal velocity during the collision. In this numerical experiment, multiple collisions occur simultaneously between the box-shaped object and the ground, exposing the difficulty of SQM in treating impulse propagation during collisions, as compared to ETM.

The object collides with the ground at time step 166 (Fig. 8
                        (a)). The relative error of the linear velocities remains close to zero, and does not vary with 
                           λ
                         for either method. The relative error of the angular velocity is lower for ETM as compared to SQM from the onset, and further decreases as 
                           λ
                         increases (Fig. 8(b)). For higher values of 
                           λ
                        , i.e. 
                           λ
                           >
                           50
                        , the accumulated numerical error becomes measurable and the relative velocity error does not further reduce. In the simulations herein, 
                           λ
                           =
                           30
                        .

The energy conservative property of multiple bodies is now investigated. A necessary condition for the impulse-based method to be energy-conservative has been previously identified  [9]. Namely, and, in the context of an SQM formulation, the relative contact velocity must be exactly reversed, as opposed to only inverting it in the normal direction. In contrast, ETM ensures conservation by constraining iterations based on the tracking of energy during collision resolution. This property is illustrated by quantifying artificial energy loss and gain during collision resolution, in terms of the measurement of the relative error in the computation of energy conservation of the collision. To this end, two perfectly elastic cases are examined, in which 540 and 1080 spherical bodies fall into a static box. Relative energy errors for at each collision step, over 250 time steps, are plotted in Fig. 9
                        . Overall, relative errors for both models are consistently below 8×10−3 for both SQM and ETM.

The experiment models the interaction between multiple bodies of different shapes, including cubes, spheres, and concave units, discretized using a tetrahedral mesh (Fig. 10
                        ). Cubes and spheres are typical convex proxies for rock fragments, while specialized three-dimensional concrete crosses are widely used in coastal structure engineering to protect against wave action for hydraulic stability. Gravitational acceleration is assumed to be −9.8 m/s2. Spheres, cubes, and concave units are initially set up in an array randomly oriented about their centers. These bodies undergo gravity-driven fall and settle into a box with static boundary walls (Fig. 11
                        ).

The ETM is used to investigate the repose angle of the slope generated by removing the right boundary of the previously generated stacks (Fig. 12
                        ). Snapshots of the final repose angles for different object shapes and for different frictions are shown in Fig. 13
                        .

To measure the angle of repose, the floor of the container is subdivided using an 8×16 grid, where the longest side of the container is subdivided sixteen times. Eight lines are fitted, using least squares, through the highest nodes identified in each of the sixteen cells. The slopes of these are regarded as the repose angles in these eight zones (Fig. 14
                        ). The average repose angle corresponds to the average measured slope. The absolute error is the average difference of the average repose angle as compared to the maximum and minimum measured repose angles. For the spheres, the absolute error ranges from 
                           0.0255
                           °
                         to 
                           0.8
                           °
                        , for cubes from 
                           1.29
                           °
                         to 
                           3.17
                           °
                        , and for crosses from 
                           1.2
                           °
                         up to 
                           12.89
                           °
                        . The angle of repose and respective measurement error is plotted as a function of the micro-scale friction coefficient in Fig. 15
                        .

For comparison, angles of repose obtained experimentally and numerically for spheres  [51] are plotted along the numerical results. Results are in good agreement with the laboratory experiments which have shown that the angle of repose increases non-linearly with the friction coefficient  [48]. The discrete element method (DEM) has been used to investigate the numerical methodologies to design concrete armor units  [52,53]. A numerically generated repose angle for the same cross-shaped particle, computed using 3D DEM  [53], is also plotted for comparison. As expected, crosses exhibit more interlocking than spheres and cubes and yield, almost consistently, higher repose angles when the friction coefficient is non-zero. When the colliding bodies are frictionless, the bodies avalanche without generating a slope (Fig. 13). For the frictionless computation, the measured angle of repose mainly depends on the packing proper of bodies. For all shapes, repose angles are close to, but greater than, those measured for dry sand. Results obtained by ETM are comparable to those reported in  [53].

A novel energy tracking method (ETM) has been proposed to solve collision responses in a multi-body system. The ETM belongs to the family of impulse methods, which apply impulses to avoid penetration. In previous versions of the impulse method, i.e. SMM and SQM, the relative velocity at the contact point after collision is directly derived from the relative velocity before collision—in a purely simultaneous or sequential manner, and the impulse is a function of the change of the relative normal velocity. In this generalized form of the impulse method, the relative velocity is adjusted gradually over a set of iterations, while within each of these iterations, their effects are considered simultaneously. By applying velocities gradually to the contact points, the impulses are able to influence multiple contact points at the same time, enabling propagation of impulse effects, and thereby improving the overall ability of the method to capture propagation of forces during dynamics simulations. Furthermore, ETM ensures that no artificial energy loss or gain results from the resolution of the collisions, setting the stage for a more rigorous analysis of energy lost due to other factors, such as brittle deformation, during impact.

@&#ACKNOWLEDGMENT@&#

The authors thank Rio Tinto for supporting this work, through the Rio Tinto Centre for Advanced Mineral Recovery at Imperial College London (P16954).

In the SQM, the relative velocity at single collision is updated directly by impulse in one iteration. 
                        
                           
                              
                                 u
                              
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           )
                        
                      and 
                        
                           
                              
                                 u
                              
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           )
                        
                      denote the relative velocities at contact point 
                        
                           
                              c
                           
                           
                              i
                           
                        
                      before and after applying impulse respectively. The change of relative velocity can be expressed as 
                        
                           (71)
                           
                              △
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              −
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              .
                           
                        
                      To simulate single-point collision with friction, first the static friction condition for the SQM is established. Assuming that the body is static in the tangential directions after collision, the relative velocity after applying the impulse is calculated as 
                        
                           (72)
                           
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              =
                              −
                              
                                 
                                    e
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              
                                 
                                    
                                       n
                                    
                                 
                                 
                                    i
                                 
                              
                           
                        
                      where 
                        
                           
                              e
                           
                           
                              n
                           
                        
                      is the coefficient of normal restitution, and 
                        
                           
                              
                                 n
                              
                           
                           
                              i
                           
                        
                      is the normal direction in local coordinates. The above equation can be rewritten in a local coordinate system as 
                        
                           (73)
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                n
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                q
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 ]
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          0
                                       
                                       
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                n
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                       
                                          0
                                       
                                    
                                 
                                 ]
                              
                              .
                           
                        
                      This local coordinate system is defined in Section  2. Then the impulse, 
                        
                           
                              
                                 p
                              
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           )
                        
                     , is calculated by Eq. (8). The friction condition is defined as: 
                        
                           (74)
                           
                              
                                 |
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 |
                              
                              <
                              μ
                              
                                 |
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       i
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 |
                              
                           
                        
                      where 
                        μ
                      is the coefficient of friction. Once the static friction condition is not satisfied, then, 
                        
                           
                              
                                 p
                              
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           )
                        
                      is recomputed as follows  [54]: 
                        
                           (75)
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          n
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             n
                                          
                                       
                                       +
                                       1
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          i
                                       
                                       
                                          
                                             T
                                          
                                       
                                    
                                    
                                       K
                                    
                                    
                                       (
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       μ
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                      then the impulse is recalculated as: 
                        
                           (76)
                           
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              =
                              
                                 |
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 |
                              
                              
                                 
                                    
                                       n
                                    
                                 
                                 
                                    i
                                 
                              
                              +
                              μ
                              
                                 |
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 |
                              
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    i
                                 
                              
                              .
                           
                        
                      The SQM treats multiple concurrent collisions (Fig. 5) as a series of single-point collisions, and the non-penetration constraints are enforced on multiple collisions sequentially. Because the SQM resolves the problem through a series of local solutions, occasionally the solution does not converge to a global solution of system. Even though this problem has not been fully solved, some approaches have been proposed to improve the stability of the SQM. In the following, the approach proposed by Chatterjee  [55] is described. During initialization, all collisions are inserted into a heap data structure 
                        
                           ψ
                        
                      according to the order of their relative normal velocities. The contact point with the smallest relative normal velocity is obtained from this heap data structure 
                        
                           ψ
                        
                     . If the smallest relative normal velocity is negative, impulses should be applied to the contact point having the smallest relative normal velocity, to avoid penetration. The impulse is calculated according to the equations from Eqs. (71) to (76). Then, the linear and angular velocities of the related colliding bodies are updated. After all of the dependent collisions are treated, the heap 
                        
                           ψ
                        
                      is updated. This computation continues to iterate over the single-point collisions sequentially, until all the negative relative normal velocities are non-negative. For the requirement of numerical stability of SQM, a proper normal restitution coefficient is required  [19]. This approach suffers from two main drawbacks: firstly, different orders of resolving collisions yield different results when multiple collisions are considered; secondly, infinite calculations occur in special cases discussed in  [16].

Alternatively, the SMM  [18] inserts collisions into a system of linear equations. All of the constraints are resolved simultaneously. For simplification, SMM is described as the special case used in Section  7.2 with friction, 
                        μ
                        =
                        0
                     , and restitution, 
                        
                           
                              e
                           
                           
                              n
                           
                        
                        =
                        1.0
                     . SMM avoids the problem of non-termination of the SQM. Simulation with different order of resolving collisions always produces the same global solution. However, the SMM enforces constraints, 
                        
                           
                              
                                 u
                              
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           )
                        
                        =
                        −
                        
                           
                              e
                           
                           
                              n
                           
                        
                        
                           
                              
                                 u
                              
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           )
                        
                        
                           
                              
                                 n
                              
                           
                           
                              i
                           
                        
                     , on all the collisions, which causes SQM to fail to simulate the interaction among multiple collisions accurately (Section  7.2).

Consider a single-point collision, 
                        
                           
                              c
                           
                           
                              i
                           
                        
                     , as shown in Fig. 2. SMM also simulates the collision in one iteration. Let 
                        
                           
                              
                                 v
                              
                           
                           
                              N
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           )
                        
                      and 
                        
                           
                              ω
                           
                           
                              N
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           )
                        
                      are the linear and angular velocities of body 
                        N
                      before collision. 
                        
                           
                              
                                 v
                              
                           
                           
                              M
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           )
                        
                      and 
                        
                           
                              ω
                           
                           
                              M
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           )
                        
                      are the linear and angular velocities of body 
                        M
                      before collision. By applying impulse 
                        
                           
                              
                                 p
                              
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           )
                        
                      and 
                        −
                        
                           
                              
                                 p
                              
                           
                           
                              i
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           )
                        
                      to contact point 
                        
                           
                              c
                           
                           
                              i
                           
                        
                     , after collision the linear and angular velocities of body 
                        N
                      become 
                        
                           
                              
                                 v
                              
                           
                           
                              N
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           )
                        
                      and 
                        
                           
                              ω
                           
                           
                              N
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           )
                        
                     , and the linear and angular velocities of body 
                        M
                      become 
                        
                           
                              
                                 v
                              
                           
                           
                              M
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           )
                        
                      and 
                        
                           
                              ω
                           
                           
                              M
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           )
                        
                     . In three dimensions, the linear and angular velocities, together with impulses, lead to a total of fifteen unknowns, 
                        
                           x
                        
                     :
                        
                           (77)
                           
                              
                                 x
                              
                              =
                              
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                   
                                                   
                                                      N
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      N
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                   
                                                   
                                                      M
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      M
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              .
                           
                        
                      To obtain 
                        
                           x
                        
                     , a total of fifteen equations are expressed as a system of linear equations, 
                        
                           A
                        
                        
                           x
                        
                        =
                        
                           b
                        
                     .

Firstly, due to the principle of impulse and linear momentum, 
                        
                           (78)
                           
                              
                                 
                                    m
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    N
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              −
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    m
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    N
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                           
                        
                      and 
                        
                           (79)
                           
                              
                                 
                                    m
                                 
                                 
                                    M
                                 
                              
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    M
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              +
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    m
                                 
                                 
                                    M
                                 
                              
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    M
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                           
                        
                      where 
                        
                           
                              m
                           
                           
                              N
                           
                        
                      and 
                        
                           
                              m
                           
                           
                              M
                           
                        
                      are the masses of bodies 
                        N
                      and 
                        M
                     .

Secondly, according to the principle of impulse and angular momentum, 
                        
                           (80)
                           
                              
                                 
                                    
                                       I
                                    
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    ω
                                 
                                 
                                    N
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              −
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    i
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       I
                                    
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    ω
                                 
                                 
                                    N
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                           
                        
                      and 
                        
                           (81)
                           
                              
                                 
                                    
                                       I
                                    
                                 
                                 
                                    M
                                 
                              
                              
                                 
                                    ω
                                 
                                 
                                    M
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              +
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    i
                                 
                                 
                                    M
                                 
                              
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       I
                                    
                                 
                                 
                                    M
                                 
                              
                              
                                 
                                    ω
                                 
                                 
                                    M
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                           
                        
                      where 
                        
                           
                              
                                 r
                              
                           
                           
                              i
                           
                           
                              N
                           
                        
                      and 
                        
                           
                              
                                 r
                              
                           
                           
                              i
                           
                           
                              M
                           
                        
                      are the vectors form the center of bodies 
                        N
                      and 
                        M
                      to the contact point 
                        
                           
                              c
                           
                           
                              i
                           
                        
                     . 
                        
                           
                              
                                 I
                              
                           
                           
                              N
                           
                        
                      and 
                        
                           
                              
                                 I
                              
                           
                           
                              M
                           
                        
                      are inertia tensors for 
                        N
                      and 
                        M
                     , respectively. By substituting Eqs. (78), (79), (80), and (81) into the linear system of equations in its block-matrix form, which is expressed as 
                        
                           (82)
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                N
                                             
                                          
                                          
                                             I
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          −
                                          
                                             I
                                          
                                       
                                    
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                             
                                             
                                                N
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          −
                                          
                                             
                                                
                                                   r
                                                
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                M
                                             
                                          
                                          
                                             I
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             I
                                          
                                       
                                    
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                             
                                             
                                                M
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                
                                             
                                             
                                                M
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ]
                              
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                N
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                N
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 ]
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                N
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                ω
                                             
                                             
                                                N
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                M
                                             
                                          
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                
                                             
                                             
                                                M
                                             
                                          
                                          
                                             
                                                ω
                                             
                                             
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        
                      where 
                        
                           I
                        
                      is the 3×3 identity matrix.

Thirdly, the relationship between the relative normal velocity before collision, 
                        
                           
                              
                                 u
                              
                           
                           
                              i
                              ,
                              n
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 0
                              
                           
                           )
                        
                     , and after collision, 
                        
                           
                              
                                 u
                              
                           
                           
                              i
                              ,
                              n
                           
                        
                        
                           (
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           )
                        
                     , is expressed, without considering the influence of the normal restitution coefficient, 
                        
                           
                              e
                           
                           
                              n
                           
                        
                        =
                        1
                     , as: 
                        
                           (83)
                           
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              =
                              −
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                           
                        
                      by substituting Eqs. (1) and (2) into the previous equation, 
                        
                           (84)
                           
                              
                                 [
                                 
                                    (
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          N
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ω
                                       
                                       
                                          N
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    ×
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          i
                                       
                                       
                                          N
                                       
                                    
                                    )
                                 
                                 −
                                 
                                    (
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          M
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ω
                                       
                                       
                                          M
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    ×
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          i
                                       
                                       
                                          M
                                       
                                    
                                    )
                                 
                                 ]
                              
                              
                                 n
                              
                              =
                              −
                              
                                 [
                                 
                                    (
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          N
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ω
                                       
                                       
                                          N
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    ×
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          i
                                       
                                       
                                          N
                                       
                                    
                                    )
                                 
                                 −
                                 
                                    (
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          M
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ω
                                       
                                       
                                          M
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    ×
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          i
                                       
                                       
                                          M
                                       
                                    
                                    )
                                 
                                 ]
                              
                              
                                 n
                              
                           
                        
                      which can be rewritten as 
                        
                           
                              (85)
                              
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   x
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   y
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   z
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 +
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         z
                                                      
                                                   
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                         ,
                                                         y
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         y
                                                      
                                                   
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                         ,
                                                         z
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         x
                                                      
                                                   
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                         ,
                                                         z
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         z
                                                      
                                                   
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                         ,
                                                         x
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         y
                                                      
                                                   
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                         ,
                                                         x
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         x
                                                      
                                                   
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                         ,
                                                         y
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   x
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   y
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   z
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 −
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   x
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   y
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   z
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 −
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         z
                                                      
                                                   
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                         ,
                                                         y
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         y
                                                      
                                                   
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                         ,
                                                         z
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         x
                                                      
                                                   
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                         ,
                                                         z
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         z
                                                      
                                                   
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                         ,
                                                         x
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         y
                                                      
                                                   
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                         ,
                                                         x
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                         ,
                                                         x
                                                      
                                                   
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                         ,
                                                         y
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   x
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   y
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   z
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           
                              (86)
                              
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 −
                                 
                                    [
                                    
                                       (
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             N
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             ω
                                          
                                          
                                             N
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                       ×
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             i
                                          
                                          
                                             N
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       (
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             M
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             ω
                                          
                                          
                                             M
                                          
                                       
                                       
                                          (
                                          
                                             
                                                s
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                       ×
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             i
                                          
                                          
                                             M
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 
                                    n
                                 
                                 .
                              
                           
                        
                      Fourthly, the Coulomb friction is defined as 
                        
                           (87)
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                          =
                                          
                                             
                                                μ
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                i
                                                ,
                                                n
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                i
                                                ,
                                                k
                                             
                                          
                                          =
                                          
                                             
                                                μ
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                i
                                                ,
                                                n
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                      then by substituting Eqs. (85)–(87) into the linear system of equations, and expressing it in block form, yields 
                        
                           (88)
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                N
                                             
                                          
                                          
                                             I
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          −
                                          
                                             I
                                          
                                       
                                    
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                             
                                             
                                                N
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          −
                                          
                                             
                                                
                                                   r
                                                
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                M
                                             
                                          
                                          
                                             I
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             I
                                          
                                       
                                    
                                    
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                             
                                             
                                                M
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                
                                             
                                             
                                                M
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                             
                                             
                                                N
                                                ,
                                                M
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   B
                                                
                                             
                                             
                                                N
                                                ,
                                                M
                                             
                                          
                                       
                                       
                                          −
                                          
                                             
                                                
                                                   A
                                                
                                             
                                             
                                                N
                                                ,
                                                M
                                             
                                          
                                       
                                       
                                          −
                                          
                                             
                                                
                                                   C
                                                
                                             
                                             
                                                N
                                                ,
                                                M
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   D
                                                
                                             
                                             
                                                N
                                                ,
                                                M
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                N
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                N
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 ]
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                N
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                ω
                                             
                                             
                                                N
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                M
                                             
                                          
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                
                                             
                                             
                                                M
                                             
                                          
                                          
                                             
                                                ω
                                             
                                             
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   F
                                                
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        
                      where the elements in 
                        
                           A
                        
                      are expressed as 
                        
                           
                              (89)
                              
                                 
                                    
                                       
                                          A
                                       
                                    
                                    
                                       N
                                       ,
                                       M
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   ,
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   ,
                                                   z
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                           
                              (90)
                              
                                 
                                    
                                       
                                          B
                                       
                                    
                                    
                                       N
                                       ,
                                       M
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   ,
                                                   z
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                   ,
                                                   y
                                                
                                                
                                                   N
                                                
                                             
                                             −
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   ,
                                                   y
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                   ,
                                                   z
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                   ,
                                                   z
                                                
                                                
                                                   N
                                                
                                             
                                             −
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   ,
                                                   z
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                   ,
                                                   y
                                                
                                                
                                                   N
                                                
                                             
                                             −
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   ,
                                                   y
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                                
                                                   N
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                           
                              (91)
                              
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       N
                                       ,
                                       M
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   ,
                                                   z
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                   ,
                                                   y
                                                
                                                
                                                   M
                                                
                                             
                                             −
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   ,
                                                   y
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                   ,
                                                   z
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                   ,
                                                   z
                                                
                                                
                                                   M
                                                
                                             
                                             −
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   ,
                                                   z
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                   ,
                                                   y
                                                
                                                
                                                   M
                                                
                                             
                                             −
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                   ,
                                                   y
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                                
                                                   M
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                           
                              (92)
                              
                                 
                                    
                                       
                                          D
                                       
                                    
                                    
                                       N
                                       ,
                                       M
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   x
                                                
                                             
                                             −
                                             
                                                
                                                   μ
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   y
                                                
                                             
                                             −
                                             
                                                
                                                   μ
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   z
                                                
                                             
                                             −
                                             
                                                
                                                   μ
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   z
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   x
                                                
                                             
                                             −
                                             
                                                
                                                   μ
                                                
                                                
                                                   q
                                                
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   y
                                                
                                             
                                             −
                                             
                                                
                                                   μ
                                                
                                                
                                                   q
                                                
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   z
                                                
                                             
                                             −
                                             
                                                
                                                   μ
                                                
                                                
                                                   q
                                                
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                      and, 
                        
                           (93)
                           
                              
                                 
                                    
                                       F
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                                 ]
                              
                              .
                           
                        
                     
                  

In SMM, multiple collisions are resolved simultaneously, and the assembly of a system equations, 
                        
                           A
                        
                        
                           x
                        
                        =
                        
                           b
                        
                     , for multiple collisions is introduced. The vector of unknowns 
                        
                           x
                        
                      for multiple collisions is defined as 
                        
                           (94)
                           
                              
                                 x
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                0
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          ⋯
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                m
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                m
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          ⋯
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                n
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        
                      where 
                        m
                      is the number of bodies and 
                        n
                      is the number of contact points.

Firstly, applying the principle of impulse and linear momentum for body 
                        j
                     , 
                        
                           (95)
                           
                              
                                 
                                    m
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    j
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              −
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    
                                       I
                                    
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    m
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    j
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                           
                        
                      assemble Eq. (95) to the matrix 
                        
                           A
                        
                      and vector 
                        
                           b
                        
                     : 
                        
                           (96)
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                5
                                                ,
                                                6
                                                j
                                                −
                                                5
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                5
                                                ,
                                                6
                                                j
                                                −
                                                4
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                5
                                                ,
                                                6
                                                j
                                                −
                                                3
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                4
                                                ,
                                                6
                                                j
                                                −
                                                5
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                4
                                                ,
                                                6
                                                j
                                                −
                                                4
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                4
                                                ,
                                                6
                                                j
                                                −
                                                3
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                3
                                                ,
                                                6
                                                j
                                                −
                                                5
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                3
                                                ,
                                                6
                                                j
                                                −
                                                4
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                3
                                                ,
                                                6
                                                j
                                                −
                                                3
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                           
                        
                      and 
                        
                           (97)
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                5
                                                ,
                                                6
                                                m
                                                +
                                                3
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                5
                                                ,
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                5
                                                ,
                                                6
                                                m
                                                +
                                                3
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                4
                                                ,
                                                6
                                                m
                                                +
                                                3
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                4
                                                ,
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                4
                                                ,
                                                6
                                                m
                                                +
                                                3
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                3
                                                ,
                                                6
                                                m
                                                +
                                                3
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                3
                                                ,
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                j
                                                −
                                                3
                                                ,
                                                6
                                                m
                                                +
                                                3
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              =
                              −
                              
                                 [
                                 
                                    
                                       
                                          1
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          1
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                 
                                 ]
                              
                           
                        
                      and 
                        
                           (98)
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                6
                                                j
                                                −
                                                5
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                6
                                                j
                                                −
                                                4
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                6
                                                j
                                                −
                                                3
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              =
                              
                                 
                                    m
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    j
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

Secondly, according to the principle of impulse and angular momentum, the relation among impulse, angular momentum of body 
                        j
                      (
                        j
                        =
                        1
                        …
                        m
                     ), and impulses at contact points 
                        
                           
                              c
                           
                           
                              i
                           
                        
                      (
                        j
                        =
                        1
                        …
                        n
                     ), can be expressed as 
                        
                           (99)
                           
                              
                                 
                                    m
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    
                                       I
                                    
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    ω
                                 
                                 
                                    j
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              −
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       I
                                    
                                 
                                 
                                    j
                                 
                              
                              ω
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                           
                        
                      subsequently, the linear system of equations is assembled via 
                        
                           
                              (100)
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   −
                                                   2
                                                   ,
                                                   6
                                                   j
                                                   −
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   −
                                                   2
                                                   ,
                                                   6
                                                   j
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   −
                                                   2
                                                   ,
                                                   6
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   −
                                                   1
                                                   ,
                                                   6
                                                   j
                                                   −
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   −
                                                   1
                                                   ,
                                                   6
                                                   j
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   −
                                                   1
                                                   ,
                                                   6
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   ,
                                                   6
                                                   j
                                                   −
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   ,
                                                   6
                                                   j
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   ,
                                                   6
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    
                                       
                                          I
                                       
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           
                              (101)
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   −
                                                   2
                                                   ,
                                                   6
                                                   m
                                                   +
                                                   3
                                                   i
                                                   −
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   −
                                                   2
                                                   ,
                                                   6
                                                   m
                                                   +
                                                   3
                                                   i
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   −
                                                   2
                                                   ,
                                                   6
                                                   m
                                                   +
                                                   3
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   −
                                                   1
                                                   ,
                                                   6
                                                   m
                                                   +
                                                   3
                                                   i
                                                   −
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   −
                                                   1
                                                   ,
                                                   6
                                                   m
                                                   +
                                                   3
                                                   i
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   −
                                                   1
                                                   ,
                                                   6
                                                   m
                                                   +
                                                   3
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   ,
                                                   6
                                                   m
                                                   +
                                                   3
                                                   i
                                                   −
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   ,
                                                   6
                                                   m
                                                   +
                                                   3
                                                   i
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   6
                                                   j
                                                   ,
                                                   6
                                                   m
                                                   +
                                                   3
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 −
                                 
                                    [
                                    
                                       
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   q
                                                
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   q
                                                
                                             
                                          
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                      and 
                        
                           (102)
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                6
                                                j
                                                −
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                6
                                                j
                                                −
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                6
                                                j
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              =
                              
                                 
                                    
                                       I
                                    
                                 
                                 
                                    j
                                 
                              
                              ω
                              
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              .
                           
                        
                      Thirdly, Newton’s impact law is introduced to the collision 
                        
                           
                              c
                           
                           
                              i
                           
                        
                      between bodies 
                        
                           
                              b
                           
                           
                              N
                           
                        
                      and 
                        
                           
                              b
                           
                           
                              M
                           
                        
                     , and matrix 
                        
                           A
                        
                      is manipulated to yield 
                        
                           (103)
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                2
                                                ,
                                                6
                                                N
                                                −
                                                5
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                2
                                                ,
                                                6
                                                N
                                                −
                                                4
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                2
                                                ,
                                                6
                                                N
                                                −
                                                3
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                1
                                                ,
                                                6
                                                N
                                                −
                                                5
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                1
                                                ,
                                                6
                                                N
                                                −
                                                4
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                1
                                                ,
                                                6
                                                N
                                                −
                                                3
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                ,
                                                6
                                                N
                                                −
                                                5
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                ,
                                                6
                                                N
                                                −
                                                4
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                ,
                                                6
                                                N
                                                −
                                                3
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                x
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                y
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                z
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                 
                                 ]
                              
                           
                        
                      and 
                        
                           (104)
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                2
                                                ,
                                                6
                                                N
                                                −
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                2
                                                ,
                                                6
                                                N
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                2
                                                ,
                                                6
                                                N
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                1
                                                ,
                                                6
                                                N
                                                −
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                1
                                                ,
                                                6
                                                N
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                1
                                                ,
                                                6
                                                N
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                ,
                                                6
                                                N
                                                −
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                ,
                                                6
                                                N
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                ,
                                                6
                                                N
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                z
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                y
                                             
                                             
                                                N
                                             
                                          
                                          −
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                y
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                z
                                             
                                             
                                                N
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                x
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                z
                                             
                                             
                                                N
                                             
                                          
                                          −
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                z
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                x
                                             
                                             
                                                N
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                x
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                y
                                             
                                             
                                                N
                                             
                                          
                                          −
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                y
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                x
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                 
                                 ]
                              
                           
                        
                      and 
                        
                           (105)
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                2
                                                ,
                                                6
                                                M
                                                −
                                                5
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                2
                                                ,
                                                6
                                                M
                                                −
                                                4
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                2
                                                ,
                                                6
                                                M
                                                −
                                                3
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                1
                                                ,
                                                6
                                                M
                                                −
                                                5
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                1
                                                ,
                                                6
                                                M
                                                −
                                                4
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                1
                                                ,
                                                6
                                                M
                                                −
                                                3
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                ,
                                                6
                                                M
                                                −
                                                5
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                ,
                                                6
                                                M
                                                −
                                                4
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                ,
                                                6
                                                M
                                                −
                                                3
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              =
                              −
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                x
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                y
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                z
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                 
                                 ]
                              
                           
                        
                      and 
                        
                           (106)
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                2
                                                ,
                                                6
                                                M
                                                −
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                2
                                                ,
                                                6
                                                M
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                2
                                                ,
                                                6
                                                M
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                1
                                                ,
                                                6
                                                M
                                                −
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                1
                                                ,
                                                6
                                                M
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                −
                                                1
                                                ,
                                                6
                                                M
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                ,
                                                6
                                                M
                                                −
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                ,
                                                6
                                                M
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                m
                                                +
                                                3
                                                i
                                                ,
                                                6
                                                M
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              =
                              −
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                z
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                y
                                             
                                             
                                                M
                                             
                                          
                                          −
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                y
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                z
                                             
                                             
                                                M
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                x
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                z
                                             
                                             
                                                M
                                             
                                          
                                          −
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                z
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                x
                                             
                                             
                                                M
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                x
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                y
                                             
                                             
                                                M
                                             
                                          
                                          −
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                y
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                i
                                                ,
                                                x
                                             
                                             
                                                M
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                 
                                 ]
                              
                              .
                           
                        
                      Fourthly, Coulomb friction is considered, and the linear system is modified as follows: 
                        
                           (107)
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                n
                                                +
                                                3
                                                i
                                                −
                                                2
                                                ,
                                                6
                                                n
                                                +
                                                3
                                                i
                                                −
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                n
                                                +
                                                3
                                                i
                                                −
                                                2
                                                ,
                                                6
                                                n
                                                +
                                                3
                                                i
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                n
                                                +
                                                3
                                                i
                                                −
                                                2
                                                ,
                                                6
                                                n
                                                +
                                                3
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                n
                                                +
                                                3
                                                i
                                                −
                                                1
                                                ,
                                                6
                                                n
                                                +
                                                3
                                                i
                                                −
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                n
                                                +
                                                3
                                                i
                                                −
                                                1
                                                ,
                                                6
                                                n
                                                +
                                                3
                                                i
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                n
                                                +
                                                3
                                                i
                                                −
                                                1
                                                ,
                                                6
                                                n
                                                +
                                                3
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                n
                                                +
                                                3
                                                i
                                                ,
                                                6
                                                n
                                                +
                                                3
                                                i
                                                −
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                n
                                                +
                                                3
                                                i
                                                ,
                                                6
                                                n
                                                +
                                                3
                                                i
                                                −
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                6
                                                n
                                                +
                                                3
                                                i
                                                ,
                                                6
                                                n
                                                +
                                                3
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                x
                                             
                                          
                                          −
                                          
                                             
                                                μ
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                x
                                             
                                          
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                y
                                             
                                          
                                          −
                                          
                                             
                                                μ
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                y
                                             
                                          
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                z
                                             
                                          
                                          −
                                          
                                             
                                                μ
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                z
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                x
                                             
                                          
                                          −
                                          
                                             
                                                μ
                                             
                                             
                                                q
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                x
                                             
                                          
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                y
                                             
                                          
                                          −
                                          
                                             
                                                μ
                                             
                                             
                                                q
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                y
                                             
                                          
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                z
                                             
                                          
                                          −
                                          
                                             
                                                μ
                                             
                                             
                                                q
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                i
                                                ,
                                                z
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              .
                           
                        
                      Finally, the vector 
                        
                           b
                        
                      is updated: 
                        
                           (108)
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                6
                                                n
                                                +
                                                3
                                                i
                                                −
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                6
                                                n
                                                +
                                                3
                                                i
                                                −
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                6
                                                n
                                                +
                                                3
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                                 ]
                              
                           
                        
                      where 
                        
                           (109)
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              =
                              −
                              
                                 (
                                 
                                    (
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          N
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ω
                                       
                                       
                                          N
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          i
                                       
                                       
                                          N
                                       
                                    
                                    )
                                 
                                 −
                                 
                                    (
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          M
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ω
                                       
                                       
                                          M
                                       
                                    
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          i
                                       
                                       
                                          M
                                       
                                    
                                    )
                                 
                                 )
                              
                              
                                 n
                              
                              .
                           
                        
                     
                  

The solution to this linear system of equations, 
                        
                           A
                        
                        
                           x
                        
                        =
                        
                           b
                        
                     , yields the linear and angular velocities of the colliding bodies after collision, along with the impulse applied to avoid penetration.

Supplementary material related to this article can be found online at http://dx.doi.org/10.1016/j.cma.2014.05.004.

The following is the Supplementary material related to this article. 
                        
                           MMC S1
                           
                              Energy tracking method. Repositioning of multiple bodies with zero friction. Normal restitution is assumed 
                                    
                                       
                                          e
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    0.3
                                 .
                           
                           
                        
                     
                     
                        
                           MMC S2
                           
                              Energy tracking method. Repositioning of multiple bodies with friction of 0.2. Normal restitution is assumed 
                                    
                                       
                                          e
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    0.3
                                 .
                           
                           
                        
                     
                     
                        
                           MMC S3
                           
                              Energy tracking method. Repositioning of multiple bodies with friction of 0.3. Normal restitution is assumed 
                                    
                                       
                                          e
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    0.3
                                 .
                           
                           
                        
                     
                     
                        
                           MMC S4
                           
                              Energy tracking method. Repositioning of multiple bodies with friction of 0.4. Normal restitution is assumed 
                                    
                                       
                                          e
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    0.3
                                 .
                           
                           
                        
                     
                     
                        
                           MMC S5
                           
                              Energy tracking method. Repositioning of multiple bodies with friction of 0.5. Normal restitution is assumed 
                                    
                                       
                                          e
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    0.3
                                 .
                           
                           
                        
                     
                     
                        
                           MMC S6
                           
                              Energy tracking method. Repositioning of multiple bodies with friction of 0.6. Normal restitution is assumed 
                                    
                                       
                                          e
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    0.3
                                 .
                           
                           
                        
                     
                  

@&#REFERENCES@&#

