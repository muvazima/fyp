@&#MAIN-TITLE@&#Return-on-investment (ROI) criteria for network design

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We develop a model for optimal location of retail stores on a network.


                        
                        
                           
                           The objective is to maximize the total profit of stores subject to a minimum ROI.


                        
                        
                           
                           Given a store’s profit is concave in demand and investment, the ROI is unimodal.


                        
                        
                           
                           We demonstrate an application to location of retail stores as an M/M/1/K queue.


                        
                        
                           
                           We introduce an upper bound of optimal value and heuristic algorithms.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Facilities planning and design

Location

Network

Return on investment

Operations-finance interface

@&#ABSTRACT@&#


               
               
                  We develop a model for optimal location of retail stores on a network. The objective is to maximize the total profit of the network subject to a minimum ROI (or ROI threshold) required at each store. Our model determines the location and number of stores, allocation of demands to the stores, and total investment. We formulate a store’s profit as a jointly concave function in demand and investment, and show that the corresponding ROI function is unimodal. We demonstrate an application of our model to location of retail stores operating as an M/M/1/K queue and show the joint concavity of a store’s profit. To this end, we prove the joint concavity of the throughput of an M/M/1/K queue. Parametric analysis is performed on an illustrative example for managerial implications. We introduce an upper bound of an optimal value of the problem and develop three heuristic algorithms based on the structural properties of the profit and ROI functions. Computational results are promising.
               
            

@&#INTRODUCTION@&#

One of the widely used objectives for network design is profit maximization. This approach can lead to higher investment (for example, locating more stores) than a return-on-investment (ROI) criterion, where ROI is the profit of an investment divided by the cost of the investment. Starbucks’ failure in 2008 invokes the motivation to consider an ROI criterion in addition to profit.

“Starbucks nearly tripled the number of stores worldwide, from 5886 in 2002 to 15,011 in 2007. But in the Great Recession of 2008, it was hurt by rising costs, the cannibalization effects of years of overexpansion, and stiff competition from McDonald’s and Dunkin Donuts. By the end of 2008, Starbucks stock, once seemingly invincible, had declined by over 50 percent. 1000 employees were laid off and 600 underperforming locations were closed in the United States.” (Excerpted from the New York Times, May 25, 2010) Greer (2010) illustrated the up-and-downs of the number of stores including the plan of adding 500 new stores in 2010. While the stores closed in 2008 were company-owned, the growth in 2010 is based on franchising requiring no upfront investment. Starbucks just collected loyalty streams paid by the stores.

This research was motivated by communications with one of our partners in automobile industry, whose details are omitted per request. The automobile manufacturer considers ROI in location decisions in a sequential manner. Finance first brings a ROI threshold because ROI evaluates the efficiency of an investment from an investor’s perspective. While investment decisions are internally made, ROI-incorporated location decisions can be aligned with some metrics interesting to external stakeholders. Examples include financial ratios such as return on equity and return on asset. The ROI threshold is translated into a minimum demand per site, which is then used for an estimate on the number of dealerships to be located. Based on population data, the whole geographical regions are partitioned in a way that the minimum demand requirement would be satisfied in each region. Then, a 1-median problem is solved for a location within each region since customers are sensitive to distance. When the minimum demand requirement is over- or under-achieved in some regions, the whole regions are partitioned with a smaller or larger number of dealerships.

The partner’s sequential approach to location decisions is a simple heuristic which is not even close to optimal. Thus, we develop an analytical model simultaneously determining the decision variables: (i) the number and location of stores, (ii) the allocation of demands to the stores, and (iii) investments at the stores. The objective is to maximize the profit of a retail network subject to a ROI threshold required at each store. The main purpose of this formulation is to deliver useful insights by addressing the impact of a financial requirement such as ROI threshold on the profit.

From a systems perspective, the interface between business functions is critical to a firm’s success. However, in the literature, not much attention has been paid to the link between operations and finance via ROI criteria. Myung, Kim, and Tcha (1997) considered a bi-objective model for uncapacitated facility location where one objective is to maximize the net profit and the other to maximize the profitability (ROI) of the investment. Brimberg and ReVelle (2000) also proposed a bi-criterion model which examines the tradeoff between the total and investment costs. Brimberg, Hansen, Laporte, Mladenovic, and Urosevic (2008) examined the objective of maximizing ROI, but imposed a minimum acceptable level on market share. They showed that an optimal solution without market share constraints is given by a single open facility, but one-facility location is rare in a retail network. These models are intended for the location of manufacturing plants and determine assignment of plants to demand nodes. In a retail environment, however, the traffic to a store is determined rather by customer preference, for example, distance sensitivity. Such customer choices are explicitly incorporated as “closest assignment” constraints in our model.

Our analysis includes an application of our model to location of retail stores operating as an M/M/1/K queue where the stochastic nature of arrival and service processes in retail operations is explicitly treated. Previous research in similar settings can be found in Berman, Krass, and Wang (2006) and Berman, Huang, Kim, and Menezes (2007) from which our model extends using ROI criteria. General problems of finding optimal facility location and resource allocation in a stochastic environment belong to the class of “Location Problems with Stochastic Demands and Congestion” (Berman and Krass, 2002, chap. 11). Snyder (2006) also provided a survey of location models with uncertainty.

We summarize key contributions. First, a more general modeling structure is introduced. In the previous location models with ROI criteria, profit or cost is formulated as a linear function and ROI as a linear fractional function. We generalize profit as a nonlinear function and ROI as a nonlinear fractional function. The resulting formulation inherits the complexity of classical location problems and the nonlinearity of profit and ROI functions adds more challenges. In particular, the profit function in our model is jointly concave in demand and investment, and can be applied to many practical settings where the marginal benefit of an increasing demand or investment decreases. Given these assumptions, we show the corresponding ROI function is unimodal. Second, in our application to location of retail stores operating as an M/M/1/K queue, we show the “queueing-based” profit function is also joint concave. To this end, we prove the joint concavity of the throughput of an M/M/1/K queue. This result is not available in the queueing literature to the best of our knowledge. Third, we introduce an upper bound of an optimal value of the problem and develop three heuristic algorithms based on the structural properties of the profit and ROI functions. While our framework was motivated by retail networks, these results can be applied in other potential research in network design. The first two contributions have implications for various other areas in operational research.

Our framework does not explicitly incorporate competition between retail chains. Direct applications include monopolistic chains with low competition. When high competition exists, the effect can implicitly be captured by estimating parameters with cautions. For example, market share can be used instead of total demand at any demand point. Also customers’ distance sensitivity can be adjusted to a high value (page 1016 in Berman et al., 2007).

The rest of the paper is planned as follows. In Section 2, we present the problem framework and assumptions. We also formulate the profit and ROI functions of a store, and show their structural properties. In Section 3, we formulate the problem and decompose it into stores’ subproblems. We also show some structural properties of a subproblem. In Section 4, we apply our model to location of retail stores operating an M/M/1/K queue. An example of the problem is illustrated in Section 5. Section 6 highlights some observations from parametric analysis using the example in Section 5. In Section 7, we introduce an upper bound of an optimal value of the problem and develop three heuristic algorithms. Section 8 includes numerical results from a computational experiment with random graphs. The conclusion with suggested future research follows in Section 9.

A chain has retail stores located within the area represented by a discrete undirected network G = (N, L), where N is the node set with |N| = n and L is the link set. Customers are concentrated at the nodes and demands originate from node i at the rate of wi
                      per unit time. The shortest distance between nodes i and j is denoted to be dij
                     . Customers from a node patronize the closest store. Customers’ choice based on distance has been used in the location literature (Berman et al., 2006; Gerrard and Church, 1996). As illustrated in our communications with an automobile manufacturer in the previous section, businesses use distance as one of the key contributing factors in customers’ preference. While this assumption is still realistic, different or more refined versions are possible. For example, customers rank facilities by travel and waiting times (Marianov, Rios, & Icaza, 2008). Given the distance-based customers’ choice, for a given set X⊂N of store locations, a demand node can be “assigned” to the closest node with a located store. The set of nodes assigned to a store at node j (or “store j”) is denoted to be Nj
                     . Demands from a node, even though assigned to the closest store, might still be “lost” due to the following two sources (Berman et al., 2006):

                        
                           1.
                           Inconvenience. Customers from a node (i) are “sensitive” to distance and are lost when the store (j) they patronize is not close enough. The function ϕ(dij
                              ) detailed below maps the likelihood of customers from node i travelling to store j.

Incapacity. Customers from node i are sensitive to congestion at store j (and also to service delays, overall appearance, layout, etc). Even though a customer from node i travels to store j, upon arrival, she might not join it due to congestion. The capacity of a store is determined by the level of investment.

Given that node i is assigned to store j, let the fraction of customers from node i travelling to store j be ϕ(dij
                     ) ≥ 0, where the “coverage decay function” ϕ(d) is non-increasing. For numerical examples and computational experiments in this paper, we use a piecewise linear convex function, ϕ(d) = max {1 − d/(θd
                     max ), 0} (Berman et al., 2007), where d
                     max  is the largest shortest distance of G and θ > 0 is a constant representing customers’ distance sensitivity. For example, a larger value of θ can be used under higher competition as noted in the previous section. See Berman, Krass, and Drezner (2003) for more examples of ϕ(d). However, a choice of ϕ(d) does not affect the results in the remainder of this paper. From the definition of ϕ(d), we define below the unit-time demand of store j
                     
                        
                           
                              
                                 
                                    λ
                                    j
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       
                                          N
                                          j
                                       
                                    
                                 
                                 
                                    w
                                    i
                                 
                                 ϕ
                                 
                                    (
                                    
                                       d
                                       
                                          i
                                          j
                                       
                                    
                                    )
                                 
                              
                           
                        
                     which represents the average number of customers arriving at store j per unit time.

The decision maker determines the set X of store locations and investment (or variable investment cost) Ij
                      ≥ 0 of a store at node j. Note that the number of stores (m = |X|) is not pre-specified. There is also a fixed setup cost S ≥ 0 for locating a store. The objective is to maximize the total profit of all stores located on the network subject to a pre-specified ROI threshold α required at each store. The full formulation of this problem is presented in the next section. We first develop the profit and ROI functions of a store, and investigate their structural properties in this section.

Suppose a store is located at some node with some λ and I (dropping the index “j”). We assume that the “throughput” or unit-time sales of the store, T(λ, I), is a non-decreasing and jointly concave function of λ and I, with the boundary conditions T(λ, 0) = 0 and T(0, I) = 0. Examples include the Cobb–Douglas function T(λ, I) = AλβIγ
                     , where 0 ≤ β ≤ 1, 0 ≤ γ ≤ 1, and β + γ ≤ 1. Let p and c be the average expense of one customer and the average cost associated with the sales, respectively. Then, the unit-time profit is (p − c)T(λ, I) and the profit of the store is

                        
                           (1)
                           
                              
                                 f
                                 (
                                 λ
                                 ,
                                 I
                                 )
                                 =
                                 (
                                 p
                                 −
                                 c
                                 )
                                 T
                                 (
                                 λ
                                 ,
                                 I
                                 )
                                 −
                                 I
                                 −
                                 S
                              
                           
                        
                     which is also jointly concave in λ and I. Note that the investment I and setup cost S are incurred for one time, but the profit (p − c)T(λ, I) is realized per unit time, for example, per year. If the store operates for y years, the present value of y cash flows of (p − c)T(λ, I) is A(p − c)T(λ, I), where A = [1 − (1 + r)−y
                     ]/r is the annuity factor for a rate of r. Without loss of generality, we let A = 1 in this paper. The store’s ROI is the profit divided by the total cost as

                        
                           (2)
                           
                              
                                 
                                    g
                                    r
                                 
                                 
                                    (
                                    λ
                                    ,
                                    I
                                    )
                                 
                                 =
                                 
                                    
                                       (
                                       p
                                       −
                                       c
                                       )
                                       T
                                       (
                                       λ
                                       ,
                                       I
                                       )
                                       −
                                       I
                                       −
                                       S
                                    
                                    
                                       c
                                       T
                                       (
                                       λ
                                       ,
                                       I
                                       )
                                       +
                                       I
                                       +
                                       S
                                    
                                 
                              
                           
                        
                     which is a “real” ROI compared to (3). However, it is difficult to analyze gr
                     (λ, I) which is a ratio of two concave functions. We thus use a different ratio below to measure ROI,

                        
                           (3)
                           
                              
                                 g
                                 
                                    (
                                    λ
                                    ,
                                    I
                                    )
                                 
                                 =
                                 
                                    
                                       (
                                       p
                                       −
                                       c
                                       )
                                       T
                                       (
                                       λ
                                       ,
                                       I
                                       )
                                       −
                                       I
                                       −
                                       S
                                    
                                    
                                       I
                                       +
                                       S
                                    
                                 
                                 .
                              
                           
                        
                     We use g(λ, I) instead of gr
                     (λ, I) based on the following relationship between the two:

                        Proposition 1
                        
                           For each value of gr
                           (λ, I), there exists a unique corresponding value of g(λ, I).

We show one-on-one correspondence between values of gr
                           (λ, I) and g(λ, I).

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      p
                                                      −
                                                      c
                                                      )
                                                      T
                                                      (
                                                      λ
                                                      ,
                                                      I
                                                      )
                                                      −
                                                      I
                                                      −
                                                      S
                                                   
                                                   
                                                      c
                                                      T
                                                      (
                                                      λ
                                                      ,
                                                      I
                                                      )
                                                      +
                                                      I
                                                      +
                                                      S
                                                   
                                                
                                                =
                                                β
                                                
                                                implies
                                                
                                                
                                                   p
                                                   
                                                      
                                                         c
                                                         +
                                                         
                                                            
                                                               I
                                                               +
                                                               S
                                                            
                                                            
                                                               T
                                                               (
                                                               λ
                                                               ,
                                                               I
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                =
                                                1
                                                +
                                                β
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Hence, if β > 0, p − c − cβ > 0.

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      p
                                                      −
                                                      c
                                                      )
                                                      T
                                                      (
                                                      λ
                                                      ,
                                                      I
                                                      )
                                                      −
                                                      I
                                                      −
                                                      S
                                                   
                                                   
                                                      I
                                                      +
                                                      S
                                                   
                                                
                                                =
                                                γ
                                                
                                                implies
                                                
                                                
                                                   
                                                      I
                                                      +
                                                      S
                                                   
                                                   
                                                      T
                                                      (
                                                      λ
                                                      ,
                                                      I
                                                      )
                                                   
                                                
                                                =
                                                
                                                   
                                                      p
                                                      −
                                                      c
                                                   
                                                   
                                                      1
                                                      +
                                                      γ
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

After some algebra, we have

                              
                                 
                                    
                                       
                                          
                                             
                                                γ
                                                =
                                                
                                                   
                                                      p
                                                      β
                                                   
                                                   
                                                      p
                                                      −
                                                      c
                                                      −
                                                      c
                                                      β
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                           □

Let α be an ROI threshold required for opening a store. Then, the minimum ROI requirement to the store can be written as

                        
                           
                              
                                 g
                                 
                                    (
                                    λ
                                    ,
                                    I
                                    )
                                 
                                 =
                                 
                                    
                                       (
                                       p
                                       −
                                       c
                                       )
                                       T
                                       (
                                       λ
                                       ,
                                       I
                                       )
                                       −
                                       I
                                       −
                                       S
                                    
                                    
                                       I
                                       +
                                       S
                                    
                                 
                                 ≥
                                 α
                              
                           
                        
                     or

                        
                           (4)
                           
                              
                                 h
                                 (
                                 λ
                                 ,
                                 I
                                 )
                                 =
                                 (
                                 p
                                 −
                                 c
                                 )
                                 T
                                 (
                                 λ
                                 ,
                                 I
                                 )
                                 −
                                 I
                                 −
                                 S
                                 −
                                 α
                                 (
                                 I
                                 +
                                 S
                                 )
                                 ≥
                                 0
                                 .
                              
                           
                        
                     Obviously, h(λ, I) is also jointly concave in λ and I.

Some structural results of the ROI function g(λ, I) follow in the remainder of this section.

                        Lemma 1
                        
                           If g(x) is twice differentiable and if the condition
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   g
                                                   ′
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                =
                                                0
                                                ⇒
                                                
                                                   g
                                                   
                                                      ′
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                ≤
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                           holds, then g(x) is unimodal (
                           
                              Boyd & Vandenberghe, 2004
                           
                           ).
                        

The pseudo-concavity of g(x) also is noted in Mangasarian, 1994, page 148, without proof.

                        Theorem 1
                        
                           For a fixed λ, 
                              
                                 
                                    g
                                    
                                       (
                                       I
                                       )
                                    
                                    =
                                    
                                       
                                          (
                                          p
                                          −
                                          c
                                          )
                                          T
                                          (
                                          λ
                                          ,
                                          I
                                          )
                                          −
                                          I
                                          −
                                          S
                                       
                                       
                                          I
                                          +
                                          S
                                       
                                    
                                 
                              
                            
                           is a unimodal function of I.

We have

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         d
                                                         g
                                                      
                                                      
                                                         d
                                                         I
                                                      
                                                   
                                                   =
                                                   
                                                      (
                                                      p
                                                      −
                                                      c
                                                      )
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            d
                                                            T
                                                            /
                                                            d
                                                            I
                                                         
                                                         
                                                            I
                                                            +
                                                            S
                                                         
                                                      
                                                      −
                                                      
                                                         T
                                                         
                                                            
                                                               (
                                                               I
                                                               +
                                                               S
                                                               )
                                                            
                                                            2
                                                         
                                                      
                                                      ]
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           and

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            d
                                                            2
                                                         
                                                         g
                                                      
                                                      
                                                         d
                                                         
                                                            I
                                                            2
                                                         
                                                      
                                                   
                                                   =
                                                   
                                                      (
                                                      p
                                                      −
                                                      c
                                                      )
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               d
                                                               2
                                                            
                                                            T
                                                            /
                                                            d
                                                            
                                                               I
                                                               2
                                                            
                                                         
                                                         
                                                            I
                                                            +
                                                            S
                                                         
                                                      
                                                      −
                                                      2
                                                      
                                                         (
                                                         
                                                            
                                                               d
                                                               T
                                                               /
                                                               d
                                                               I
                                                            
                                                            
                                                               
                                                                  (
                                                                  I
                                                                  +
                                                                  S
                                                                  )
                                                               
                                                               2
                                                            
                                                         
                                                         −
                                                         
                                                            T
                                                            
                                                               
                                                                  (
                                                                  I
                                                                  +
                                                                  S
                                                                  )
                                                               
                                                               3
                                                            
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           Then, the condition of Lemma 1 holds.□

Based on Lemma 2 below, we show Theorem 2 which is stronger than Theorem 1.

                        Lemma 2
                        
                           If g(x) is twice differentiable and if g(x) satisfies
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                   T
                                                
                                                ▽
                                                g
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                =
                                                0
                                                ⇒
                                                
                                                   y
                                                   T
                                                
                                                
                                                   ▽
                                                   2
                                                
                                                g
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                y
                                                ≤
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                           for all x ∈ dom(g) and all y ∈ Rn, then g(x) is unimodal (
                           
                              Boyd & Vandenberghe, 2004
                           
                           ).
                        


                           
                              
                                 
                                    g
                                    
                                       (
                                       λ
                                       ,
                                       I
                                       )
                                    
                                    =
                                    
                                       
                                          (
                                          p
                                          −
                                          c
                                          )
                                          T
                                          (
                                          λ
                                          ,
                                          I
                                          )
                                          −
                                          I
                                          −
                                          S
                                       
                                       
                                          I
                                          +
                                          S
                                       
                                    
                                 
                              
                            
                           is a unimodal function of (λ, I).

We have

                              
                                 
                                    
                                       ▽
                                       g
                                       
                                          (
                                          λ
                                          ,
                                          I
                                          )
                                       
                                       =
                                       
                                          (
                                          p
                                          −
                                          c
                                          )
                                       
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               T
                                                            
                                                            
                                                               ∂
                                                               λ
                                                            
                                                         
                                                         
                                                            1
                                                            
                                                               (
                                                               I
                                                               +
                                                               S
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               T
                                                            
                                                            
                                                               ∂
                                                               I
                                                            
                                                         
                                                         
                                                            1
                                                            
                                                               (
                                                               I
                                                               +
                                                               S
                                                               )
                                                            
                                                         
                                                         −
                                                         
                                                            T
                                                            
                                                               
                                                                  (
                                                                  I
                                                                  +
                                                                  S
                                                                  )
                                                               
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           and

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      ▽
                                                      2
                                                   
                                                   g
                                                   
                                                      (
                                                      λ
                                                      ,
                                                      I
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                
                                                   =
                                                   
                                                   
                                                      (
                                                      p
                                                      −
                                                      c
                                                      )
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ∂
                                                                              2
                                                                           
                                                                           T
                                                                        
                                                                        
                                                                           ∂
                                                                           
                                                                              λ
                                                                              2
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        1
                                                                        
                                                                           (
                                                                           I
                                                                           +
                                                                           S
                                                                           )
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ∂
                                                                              2
                                                                           
                                                                           T
                                                                        
                                                                        
                                                                           ∂
                                                                           λ
                                                                           ∂
                                                                           I
                                                                        
                                                                     
                                                                     
                                                                        1
                                                                        
                                                                           (
                                                                           I
                                                                           +
                                                                           S
                                                                           )
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           ∂
                                                                           T
                                                                        
                                                                        
                                                                           ∂
                                                                           λ
                                                                        
                                                                     
                                                                     
                                                                        1
                                                                        
                                                                           
                                                                              (
                                                                              I
                                                                              +
                                                                              S
                                                                              )
                                                                           
                                                                           2
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                            
                                                            
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ∂
                                                                              2
                                                                           
                                                                           T
                                                                        
                                                                        
                                                                           ∂
                                                                           λ
                                                                           ∂
                                                                           I
                                                                        
                                                                     
                                                                     
                                                                        1
                                                                        
                                                                           (
                                                                           I
                                                                           +
                                                                           S
                                                                           )
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           ∂
                                                                           T
                                                                        
                                                                        
                                                                           ∂
                                                                           λ
                                                                        
                                                                     
                                                                     
                                                                        1
                                                                        
                                                                           
                                                                              (
                                                                              I
                                                                              +
                                                                              S
                                                                              )
                                                                           
                                                                           2
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ∂
                                                                              2
                                                                           
                                                                           T
                                                                        
                                                                        
                                                                           ∂
                                                                           
                                                                              I
                                                                              2
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        1
                                                                        
                                                                           (
                                                                           I
                                                                           +
                                                                           S
                                                                           )
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           ∂
                                                                           T
                                                                        
                                                                        
                                                                           ∂
                                                                           I
                                                                        
                                                                     
                                                                     
                                                                        2
                                                                        
                                                                           
                                                                              (
                                                                              I
                                                                              +
                                                                              S
                                                                              )
                                                                           
                                                                           2
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        
                                                                           2
                                                                           T
                                                                        
                                                                        
                                                                           
                                                                              (
                                                                              I
                                                                              +
                                                                              S
                                                                              )
                                                                           
                                                                           3
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Given any (λ′, I′) such that (λ′, I′)▽g = 0, after some simple algebra, we have

                              
                                 
                                    
                                       
                                          (
                                          
                                             λ
                                             ′
                                          
                                          ,
                                          
                                             I
                                             ′
                                          
                                          )
                                       
                                       
                                          ▽
                                          2
                                       
                                       g
                                       
                                          (
                                          x
                                          )
                                       
                                       
                                          
                                             (
                                             
                                                λ
                                                ′
                                             
                                             ,
                                             
                                                I
                                                ′
                                             
                                             )
                                          
                                          T
                                       
                                       =
                                       
                                          
                                             p
                                             −
                                             c
                                          
                                          
                                             I
                                             +
                                             S
                                          
                                       
                                       
                                          (
                                          
                                             λ
                                             ′
                                          
                                          ,
                                          
                                             I
                                             ′
                                          
                                          )
                                       
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      T
                                                      /
                                                      ∂
                                                      
                                                         λ
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      T
                                                      /
                                                      ∂
                                                      λ
                                                      ∂
                                                      I
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      T
                                                      /
                                                      ∂
                                                      λ
                                                      ∂
                                                      I
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      T
                                                      /
                                                      ∂
                                                      
                                                         I
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       
                                          
                                             (
                                             
                                                λ
                                                ′
                                             
                                             ,
                                             
                                                I
                                                ′
                                             
                                             )
                                          
                                          T
                                       
                                       ,
                                    
                                 
                              
                           which is non-positive from Lemma 2.□

Given the framework in the previous section, we formalize our model by defining the following three decision variables:


                     yj
                      = 1 if a store is located at node j;  0 otherwise,


                     xij
                      = 1 if node i is assigned to the store at node j;  0 otherwise,


                     Ij
                      = investment of a store at node j.

The formulation below maximizes the total profit of a network without ROI constraints.

                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          (
                                          
                                             P
                                             1
                                          
                                          )
                                          
                                          max
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                [
                                                
                                                   
                                                      (
                                                      p
                                                      −
                                                      c
                                                      )
                                                   
                                                   T
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         w
                                                         i
                                                      
                                                      ϕ
                                                      
                                                         (
                                                         
                                                            d
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         x
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      ,
                                                      
                                                         I
                                                         j
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      I
                                                      j
                                                   
                                                   −
                                                   S
                                                   
                                                      y
                                                      j
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                    
                                 
                                 
                                    
                                       s.t.
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             =
                                             1
                                             
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ≤
                                          
                                             y
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                          i
                                          ,
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (7)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                x
                                                
                                                   i
                                                   k
                                                
                                             
                                             
                                                d
                                                
                                                   i
                                                   k
                                                
                                             
                                             +
                                             
                                                (
                                                M
                                                −
                                                
                                                   d
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                             
                                                y
                                                j
                                             
                                             ≤
                                             M
                                          
                                       
                                    
                                    
                                       
                                          
                                          i
                                          ,
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ,
                                          
                                             y
                                             j
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                       
                                    
                                    
                                       
                                          
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             I
                                             j
                                          
                                          ≥
                                          0
                                       
                                    
                                    
                                       
                                          
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          .
                                       
                                    
                                 
                              
                           
                        
                     If Ij
                      = 0, then 
                        
                           
                              (
                              p
                              −
                              c
                              )
                           
                           T
                           (
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              n
                           
                           
                              w
                              i
                           
                           ϕ
                           
                              (
                              
                                 d
                                 
                                    i
                                    j
                                 
                              
                              )
                           
                           
                              x
                              
                                 i
                                 j
                              
                           
                           ,
                           
                              I
                              j
                           
                           )
                           =
                           0
                        
                     . Thus yj
                      must be zero as well. On the other hand, if yj
                      = 0, then xij
                      = 0 for all i, due to constraints (6) which mean 
                        
                           
                              (
                              p
                              −
                              c
                              )
                           
                           T
                           (
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              n
                           
                           
                              w
                              i
                           
                           ϕ
                           
                              (
                              
                                 d
                                 
                                    i
                                    j
                                 
                              
                              )
                           
                           
                              x
                              
                                 i
                                 j
                              
                           
                           ,
                           
                              I
                              j
                           
                           )
                           =
                           0
                        
                     . Thus Ij
                      = 0. Either yj
                      or Ij
                      being zero implies that the other is also zero. Constraints (5) state that each node is assigned to one store. Constraints (6) ensure that node i cannot be assigned to node j unless there is a store located at node j. Constraints (7) guarantee that each node is assigned to the closest store, where M ≥ d
                     max. In case of a tie, (P
                     1) will assign a node to a store with less demand load since the objective function is nondecreasing concave in demand. The validation of constraints (7) can be found in Berman et al. (2006). Other forms of “closest assignment” constraints are available in Gerrard and Church (1996). Close assignment is a realistic assumption in a retail environment, but these constraints do not limit the applicability of our model to other settings since other types of constraints can be used instead.

After ROI constraints (h(λj, Ij
                     ) ≥ 0 as in (4)) are introduced, (P
                     1) turns into

                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          (
                                          
                                             P
                                             2
                                          
                                          )
                                          
                                          max
                                          
                                          
                                          
                                          
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                [
                                                
                                                   
                                                      (
                                                      p
                                                      −
                                                      c
                                                      )
                                                   
                                                   T
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         w
                                                         i
                                                      
                                                      ϕ
                                                      
                                                         (
                                                         
                                                            d
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         x
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      ,
                                                      
                                                         I
                                                         j
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      I
                                                      j
                                                   
                                                   −
                                                   S
                                                   
                                                      y
                                                      j
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                    
                                 
                                 
                                    
                                       s.t.
                                    
                                    
                                    
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                (
                                                p
                                                −
                                                c
                                                )
                                             
                                             T
                                             
                                                (
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      w
                                                      i
                                                   
                                                   ϕ
                                                   
                                                      (
                                                      
                                                         d
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      x
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   ,
                                                   
                                                      I
                                                      j
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                I
                                                j
                                             
                                             −
                                             S
                                             
                                                y
                                                j
                                             
                                             −
                                             α
                                             
                                                (
                                                
                                                   I
                                                   j
                                                
                                                +
                                                S
                                                
                                                   y
                                                   j
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ≥
                                          
                                          0
                                          
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                       
                                    
                                    
                                 
                                 
                                    
                                    
                                       
                                          (
                                          5
                                          )
                                          ,
                                          (
                                          6
                                          )
                                          ,
                                          (
                                          7
                                          )
                                          ,
                                          (
                                          8
                                          )
                                          ,
                                          (
                                          9
                                          )
                                          .
                                       
                                    
                                    
                                       
                                    
                                 
                              
                           
                        
                     
                  

Let z*(P) be the optimal objective function value of a problem (P). Obviously, z*(P
                     1) ≥ z*(P
                     2) for any α. Since (P
                     2) is challenging, we focus on a subproblem regarding to a store. Given a fixed set of m store locations, unit-time demands (
                        
                           
                              λ
                              j
                           
                           =
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              n
                           
                           
                              w
                              i
                           
                           ϕ
                           
                              (
                              
                                 d
                                 
                                    i
                                    j
                                 
                              
                              )
                           
                           
                              x
                              
                                 i
                                 j
                              
                           
                           ,
                        
                      
                     j = 1, …, m) are also fixed. Then, (P
                     1) can be decomposed into m separate subproblems as

                        
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                P
                                                j
                                                1
                                             
                                             )
                                          
                                          
                                          
                                             max
                                             
                                                
                                                   I
                                                   j
                                                
                                                ≥
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                          f
                                          
                                             (
                                             
                                                I
                                                j
                                             
                                             )
                                          
                                          =
                                          
                                             (
                                             p
                                             −
                                             c
                                             )
                                          
                                          T
                                          
                                             (
                                             
                                                λ
                                                j
                                             
                                             ,
                                             
                                                I
                                                j
                                             
                                             )
                                          
                                          −
                                          
                                             I
                                             j
                                          
                                          −
                                          S
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Similarly, (P
                     2) can be decomposed as

                        
                           
                              
                                 
                                    
                                       
                                          (
                                          
                                             P
                                             j
                                             2
                                          
                                          )
                                       
                                    
                                    
                                    
                                       
                                          
                                             max
                                             
                                                
                                                   I
                                                   j
                                                
                                                ≥
                                                0
                                             
                                          
                                          
                                          f
                                          
                                             (
                                             
                                                I
                                                j
                                             
                                             )
                                          
                                          =
                                          
                                             (
                                             p
                                             −
                                             c
                                             )
                                          
                                          T
                                          
                                             (
                                             
                                                λ
                                                j
                                             
                                             ,
                                             
                                                I
                                                j
                                             
                                             )
                                          
                                          −
                                          
                                             I
                                             j
                                          
                                          −
                                          S
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             s.t.
                                             
                                             h
                                             
                                                (
                                                
                                                   I
                                                   j
                                                
                                                )
                                             
                                             =
                                             
                                                (
                                                p
                                                −
                                                c
                                                )
                                             
                                             T
                                             
                                                (
                                                
                                                   λ
                                                   j
                                                
                                                ,
                                                
                                                   I
                                                   j
                                                
                                                )
                                             
                                             −
                                             
                                                I
                                                j
                                             
                                             −
                                             S
                                             −
                                             α
                                             
                                                (
                                                
                                                   I
                                                   j
                                                
                                                +
                                                S
                                                )
                                             
                                             ≥
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     Since both f(I) and h(I) are concave, 
                        
                           (
                           
                              P
                              j
                              2
                           
                           )
                        
                      is a concave programming problem. Consider also a problem of maximizing the ROI of store j formulated as

                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   P
                                                   j
                                                   0
                                                
                                                )
                                             
                                             
                                             
                                                max
                                                
                                                   
                                                      I
                                                      j
                                                   
                                                   ≥
                                                   0
                                                
                                             
                                             
                                             g
                                             
                                                (
                                                
                                                   I
                                                   j
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      (
                                                      p
                                                      −
                                                      c
                                                      )
                                                   
                                                   T
                                                   
                                                      (
                                                      
                                                         λ
                                                         j
                                                      
                                                      ,
                                                      
                                                         I
                                                         j
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      I
                                                      j
                                                   
                                                   −
                                                   S
                                                
                                                
                                                   
                                                      I
                                                      j
                                                   
                                                   +
                                                   S
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The objective function of 
                        
                           (
                           
                              P
                              j
                              0
                           
                           )
                        
                      is unimodal by Theorem 1 or 2. We use the three formulations to characterize 
                        
                           I
                           j
                           2
                        
                      below.

                        Proposition 2
                        
                           Suppose that
                           
                              
                                 
                                    z
                                    *
                                 
                                 
                                    (
                                    
                                       P
                                       j
                                       1
                                    
                                    )
                                 
                                 >
                                 0
                                 ,
                              
                            
                           and that
                           
                              
                                 
                                    I
                                    j
                                    0
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    I
                                    j
                                    2
                                 
                                 ,
                              
                            
                           and
                           
                              
                                 I
                                 j
                                 1
                              
                            
                           solve
                           
                              
                                 (
                                 
                                    P
                                    j
                                    0
                                 
                                 )
                                 ,
                              
                           
                           
                              
                                 (
                                 
                                    P
                                    j
                                    2
                                 
                                 )
                                 ,
                              
                            
                           and
                           
                              
                                 (
                                 
                                    P
                                    j
                                    1
                                 
                                 )
                                 ,
                              
                            
                           respectively. Then, there exist 
                           
                              α
                            
                           and
                           
                              
                                 α
                                 ¯
                              
                            
                           such that
                           
                              
                                 (i)
                                 
                                    
                                       
                                          
                                             I
                                             j
                                             0
                                          
                                          ≤
                                          
                                             I
                                             j
                                             2
                                          
                                          =
                                          
                                             I
                                             j
                                             1
                                          
                                       
                                     
                                    for α ≤ 
                                       α
                                    ,


                                    
                                       
                                          
                                             I
                                             j
                                             0
                                          
                                          ≤
                                          
                                             I
                                             j
                                             2
                                          
                                          <
                                          
                                             I
                                             j
                                             1
                                          
                                       
                                     
                                    for
                                    
                                       
                                          α
                                          ∈
                                          (
                                          
                                             α
                                             ̲
                                          
                                          ,
                                          
                                             α
                                             ¯
                                          
                                          ]
                                          ,
                                       
                                    
                                 


                                    
                                       
                                          (
                                          
                                             P
                                             j
                                             2
                                          
                                          )
                                       
                                     
                                    is infeasible for
                                    
                                       
                                          α
                                          >
                                          
                                             α
                                             ¯
                                          
                                          .
                                       
                                    
                                 

Suppose 
                              
                                 
                                    z
                                    *
                                 
                                 
                                    (
                                    
                                       P
                                       j
                                       1
                                    
                                    )
                                 
                                 ≤
                                 0
                              
                           . Then, by setting Ij
                            = 0, we can always set the profit to zero. Since 
                              
                                 
                                    f
                                    
                                       (
                                       
                                          I
                                          j
                                          0
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       p
                                       −
                                       c
                                       )
                                    
                                    T
                                    
                                       (
                                       
                                          λ
                                          j
                                       
                                       ,
                                       
                                          I
                                          j
                                          0
                                       
                                       )
                                    
                                    −
                                    
                                       I
                                       j
                                       0
                                    
                                    −
                                    S
                                    ≤
                                    
                                       (
                                       p
                                       −
                                       c
                                       )
                                    
                                    T
                                    
                                       (
                                       
                                          λ
                                          j
                                       
                                       ,
                                       
                                          I
                                          j
                                          1
                                       
                                       )
                                    
                                    −
                                    
                                       I
                                       j
                                       1
                                    
                                    −
                                    S
                                    =
                                    f
                                    
                                       (
                                       
                                          I
                                          j
                                          1
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    I
                                    j
                                    0
                                 
                                 ≤
                                 
                                    I
                                    j
                                    1
                                 
                              
                           . Let

                              
                                 
                                    
                                       
                                          
                                             
                                                α
                                                ̲
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                g
                                                
                                                   (
                                                   
                                                      I
                                                      j
                                                      1
                                                   
                                                   )
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            p
                                                            −
                                                            c
                                                            )
                                                         
                                                         T
                                                         
                                                            (
                                                            
                                                               λ
                                                               j
                                                            
                                                            ,
                                                            
                                                               I
                                                               j
                                                               1
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            I
                                                            j
                                                            1
                                                         
                                                         −
                                                         S
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                         j
                                                         1
                                                      
                                                      +
                                                      S
                                                   
                                                
                                                
                                                and
                                             
                                          
                                       
                                       
                                          
                                             
                                                α
                                                ¯
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                g
                                                
                                                   (
                                                   
                                                      I
                                                      j
                                                      0
                                                   
                                                   )
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            p
                                                            −
                                                            c
                                                            )
                                                         
                                                         T
                                                         
                                                            (
                                                            
                                                               λ
                                                               j
                                                            
                                                            ,
                                                            
                                                               I
                                                               j
                                                               0
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            I
                                                            j
                                                            0
                                                         
                                                         −
                                                         S
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                         j
                                                         0
                                                      
                                                      +
                                                      S
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Then, 
                              
                                 
                                    α
                                    ̲
                                 
                                 =
                                 g
                                 
                                    (
                                    
                                       I
                                       j
                                       1
                                    
                                    )
                                 
                                 ≤
                                 g
                                 
                                    (
                                    
                                       I
                                       j
                                       0
                                    
                                    )
                                 
                                 =
                                 
                                    α
                                    ¯
                                 
                                 .
                              
                            For α ≤ 
                              α
                           , 
                              
                                 I
                                 j
                                 1
                              
                            solves 
                              
                                 (
                                 
                                    P
                                    j
                                    2
                                 
                                 )
                              
                            as well because the ROI constraint in 
                              
                                 (
                                 
                                    P
                                    j
                                    2
                                 
                                 )
                              
                            is non-binding. For 
                              
                                 α
                                 ∈
                                 (
                                 
                                    α
                                    ̲
                                 
                                 ,
                                 
                                    α
                                    ¯
                                 
                                 ]
                                 ,
                              
                            the ROI constraint of 
                              
                                 (
                                 
                                    P
                                    j
                                    2
                                 
                                 )
                              
                            is binding, i.e., 
                              
                                 
                                    g
                                    
                                       (
                                       
                                          I
                                          j
                                          2
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             p
                                             −
                                             c
                                             )
                                          
                                          T
                                          
                                             (
                                             
                                                λ
                                                j
                                             
                                             ,
                                             
                                                I
                                                j
                                                2
                                             
                                             )
                                          
                                          −
                                          
                                             I
                                             j
                                             2
                                          
                                          −
                                          S
                                       
                                       
                                          
                                             I
                                             j
                                             2
                                          
                                          +
                                          S
                                       
                                    
                                    =
                                    α
                                 
                              
                           . It follows that 
                              
                                 
                                    I
                                    j
                                    0
                                 
                                 ≤
                                 
                                    I
                                    j
                                    2
                                 
                                 <
                                 
                                    I
                                    j
                                    1
                                 
                              
                           . For 
                              
                                 α
                                 >
                                 
                                    α
                                    ¯
                                 
                                 ,
                              
                           
                           
                              
                                 (
                                 
                                    P
                                    j
                                    2
                                 
                                 )
                              
                            is infeasible.□

By preprocessing 
                        α
                      and 
                        
                           
                              α
                              ¯
                           
                           ,
                        
                      we are able to find 
                        
                           I
                           j
                           2
                        
                      more efficiently in our solution procedures for numerical examples and computational experiments. In particular, we use the False Position method (Burden & Faires, 2001) in search of 
                        
                           I
                           j
                           2
                        
                      since 
                        
                           h
                           (
                           
                              I
                              j
                              0
                           
                           )
                        
                      and 
                        
                           h
                           (
                           
                              I
                              j
                              1
                           
                           )
                        
                      have opposite signs when 
                        
                           α
                           ∈
                           [
                           
                              α
                              ̲
                           
                           ,
                           
                              α
                              ¯
                           
                           ]
                        
                     . In Fig. 1
                      are examples of the three functions f(I), g(I), and h(I) where

                        
                           
                              
                                 
                                    
                                       
                                          f
                                          (
                                          I
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          (
                                          p
                                          −
                                          c
                                          )
                                          T
                                          (
                                          λ
                                          ,
                                          I
                                          )
                                          −
                                          I
                                          −
                                          S
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          g
                                          (
                                          I
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                (
                                                p
                                                −
                                                c
                                                )
                                                T
                                                (
                                                λ
                                                ,
                                                I
                                                )
                                                −
                                                I
                                                −
                                                S
                                             
                                             
                                                I
                                                +
                                                S
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          h
                                          (
                                          I
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          (
                                          p
                                          −
                                          c
                                          )
                                          T
                                          (
                                          λ
                                          ,
                                          I
                                          )
                                          −
                                          I
                                          −
                                          S
                                          −
                                          α
                                          (
                                          I
                                          +
                                          S
                                          )
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

If the ROI function g(I) is concave, the property of 
                        
                           
                              z
                              *
                           
                           
                              (
                              
                                 P
                                 j
                                 2
                              
                              )
                           
                        
                      below is obvious. We note that this property still holds when g(I) is pseudo-concave.

                        Property 1
                        
                           For a fixed λj
                           , 
                              
                                 
                                    z
                                    *
                                 
                                 
                                    (
                                    
                                       P
                                       j
                                       2
                                    
                                    )
                                 
                              
                            
                           is non-increasing in α.

Since the objective function g(Ij
                           ) of 
                              
                                 (
                                 
                                    P
                                    j
                                    0
                                 
                                 )
                              
                            is pseudo-concave in Ij
                           , the “upper level set” 
                              
                                 
                                    
                                       I
                                       j
                                    
                                    
                                       (
                                       α
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          I
                                          j
                                       
                                       ≥
                                       0
                                       |
                                       g
                                       
                                          (
                                          
                                             I
                                             j
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                p
                                                −
                                                c
                                                )
                                             
                                             T
                                             
                                                (
                                                
                                                   λ
                                                   j
                                                
                                                ,
                                                
                                                   I
                                                   j
                                                
                                                )
                                             
                                             −
                                             
                                                I
                                                j
                                             
                                             −
                                             S
                                          
                                          
                                             
                                                I
                                                j
                                             
                                             +
                                             S
                                          
                                       
                                       ≥
                                       α
                                       }
                                    
                                 
                              
                            is convex for any α (Avriel, 1976). For distinct ROI thresholds, α′ and α′′ such that α′ < α′′, Ij
                           (α′)⊃Ij
                           (α′′), where Ij
                           (α′) and Ij
                           (α′′) are the feasible sets of 
                              
                                 (
                                 
                                    P
                                    j
                                    2
                                 
                                 )
                              
                            for α′ and α′′, respectively. Thus, 
                              
                                 
                                    z
                                    *
                                 
                                 
                                    (
                                    
                                       P
                                       j
                                       2
                                    
                                    )
                                 
                              
                            for α′ is at least that for α′′.□

As online shopping threatens to continue siphoning off sales in brick-and-mortar stores, customers’ perception and experience on retail services have become increasingly important. Retail customers are generally sensitive to waiting and research in retailing indeed found empirical evidences on how quickly shoppers become impatient. Retail customers often rate waiting as the single biggest complaint, and consider it as a critical determinant on where to shop (Doyle, 2003). The duration of the waiting time at checkout is one of the key service attributes on which retailers compete with one another (Casey, 2004). Research released by Barclays and Barclaycard (2010) reveals that two fifths of British shoppers refuse to queue for longer than two minutes and two thirds of them regularly abandon purchases. These observations motivated application of our model to location of retail stores operating as a queue.

An M/M/1/K queue is admittedly a “stylized” setting where not all detailed operations in a retail store can be incorporated. Still, this framework allows to address stochastic nature of retail operations and loss of demands due to congestion. We note that some of our assumptions are found also in Berman et al. (2006) and Berman et al. (2007). In both papers, a facility operates as an M/M/1/K queue and customers patronize the closest facility. Berman et al. (2007) illustrated retail applications of their location model.

Assuming retail stores operates as an M/M/1/K queue, we derive a queueing-based profit function and show that it is non-increasing and jointly concave in λ and I. Let λ and μ be the demand rate and service rate of an M/M/1/K queue, respectively. Then, the loss probability (or blocking fraction) can be shown as (Gross & Harris, 1985)

                        
                           
                              
                                 B
                                 
                                    (
                                    λ
                                    ,
                                    μ
                                    ,
                                    K
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            λ
                                                            /
                                                            μ
                                                            )
                                                         
                                                         K
                                                      
                                                      
                                                         (
                                                         1
                                                         −
                                                         λ
                                                         /
                                                         μ
                                                         )
                                                      
                                                   
                                                   
                                                      1
                                                      −
                                                      
                                                         
                                                            (
                                                            λ
                                                            /
                                                            μ
                                                            )
                                                         
                                                         
                                                            K
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                if
                                                
                                                λ
                                                ≠
                                                μ
                                                ,
                                                λ
                                                ≠
                                                0
                                                ,
                                                μ
                                                ≠
                                                0
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   1
                                                   
                                                      K
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                if
                                                
                                                λ
                                                =
                                                μ
                                                ≠
                                                0
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             
                                                if
                                                
                                                λ
                                                =
                                                0
                                                ,
                                                μ
                                                ≠
                                                0
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             
                                                if
                                                
                                                μ
                                                =
                                                0
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     B(λ, μ, K) is convex in μ (Nagarajan & Towsley, 1992). The throughput is given as

                        
                           (11)
                           
                              
                                 T
                                 
                                    (
                                    λ
                                    ,
                                    μ
                                    )
                                 
                                 =
                                 λ
                                 
                                    [
                                    1
                                    −
                                    B
                                    (
                                    λ
                                    ,
                                    μ
                                    ,
                                    K
                                    )
                                    ]
                                 
                                 =
                                 λ
                                 
                                    [
                                    1
                                    −
                                    
                                       
                                          
                                             
                                                (
                                                λ
                                                /
                                                μ
                                                )
                                             
                                             K
                                          
                                          
                                             (
                                             1
                                             −
                                             λ
                                             /
                                             μ
                                             )
                                          
                                       
                                       
                                          1
                                          −
                                          
                                             
                                                (
                                                λ
                                                /
                                                μ
                                                )
                                             
                                             
                                                K
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     Then, the profit of a store in (1) can be re-formulated as f(λ, μ) = (p − c)T(λ, μ) − I(μ) − S, where the investment I(μ) is differentiable, increasing, and convex in μ (Christ & Avi-Itzhak, 2002).

In the remainder of this section, we show structural properties of the throughput of an M/M/1/K queue as a function of demand λ and service rate μ(I), where μ(I) is again a function of I. This is, in fact, the main complication in application of our model to a queueing setting.

                        Proposition 3
                        
                           T(λ, μ(I)) defined by 
                           (11) 
                           is an increasing function of λ.

To show ∂T/∂λ > 0, we have

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   T
                                                
                                                
                                                   ∂
                                                   λ
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                            
                                                               2
                                                               K
                                                               +
                                                               2
                                                            
                                                         
                                                         −
                                                         
                                                            (
                                                            K
                                                            +
                                                            1
                                                            )
                                                         
                                                         
                                                            μ
                                                            
                                                               K
                                                               +
                                                               2
                                                            
                                                         
                                                         
                                                            λ
                                                            K
                                                         
                                                         +
                                                         K
                                                         
                                                            μ
                                                            
                                                               K
                                                               +
                                                               1
                                                            
                                                         
                                                         
                                                            λ
                                                            
                                                               K
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               μ
                                                               
                                                                  K
                                                                  +
                                                                  1
                                                               
                                                            
                                                            −
                                                            
                                                               λ
                                                               
                                                                  K
                                                                  +
                                                                  1
                                                               
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   
                                                      μ
                                                      
                                                         K
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         K
                                                         
                                                            λ
                                                            
                                                               K
                                                               +
                                                               1
                                                            
                                                         
                                                         −
                                                         K
                                                         μ
                                                         
                                                            λ
                                                            K
                                                         
                                                         −
                                                         μ
                                                         
                                                            λ
                                                            K
                                                         
                                                         +
                                                         
                                                            μ
                                                            
                                                               K
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               μ
                                                               
                                                                  K
                                                                  +
                                                                  1
                                                               
                                                            
                                                            −
                                                            
                                                               λ
                                                               
                                                                  K
                                                                  +
                                                                  1
                                                               
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           The numerator of the above fraction can be rewritten as

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                K
                                                
                                                   λ
                                                   K
                                                
                                                
                                                   (
                                                   λ
                                                   −
                                                   μ
                                                   )
                                                
                                                −
                                                μ
                                                
                                                   (
                                                   λ
                                                   −
                                                   μ
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      
                                                         K
                                                         −
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      λ
                                                      
                                                         K
                                                         −
                                                         2
                                                      
                                                   
                                                   μ
                                                   +
                                                   
                                                      λ
                                                      
                                                         K
                                                         −
                                                         3
                                                      
                                                   
                                                   
                                                      μ
                                                      2
                                                   
                                                   +
                                                   ⋯
                                                   +
                                                   
                                                      μ
                                                      
                                                         K
                                                         −
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   (
                                                   λ
                                                   −
                                                   μ
                                                   )
                                                
                                                
                                                   (
                                                   K
                                                   
                                                      λ
                                                      K
                                                   
                                                   −
                                                   
                                                      λ
                                                      
                                                         K
                                                         −
                                                         1
                                                      
                                                   
                                                   μ
                                                   −
                                                   
                                                      λ
                                                      
                                                         K
                                                         −
                                                         2
                                                      
                                                   
                                                   
                                                      μ
                                                      2
                                                   
                                                   −
                                                   ⋯
                                                   −
                                                   
                                                      μ
                                                      K
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   (
                                                   λ
                                                   −
                                                   μ
                                                   )
                                                
                                                [
                                                
                                                   (
                                                   
                                                      λ
                                                      K
                                                   
                                                   −
                                                   
                                                      λ
                                                      
                                                         K
                                                         −
                                                         1
                                                      
                                                   
                                                   μ
                                                   )
                                                
                                                +
                                                
                                                   (
                                                   
                                                      λ
                                                      K
                                                   
                                                   −
                                                   
                                                      λ
                                                      
                                                         K
                                                         −
                                                         2
                                                      
                                                   
                                                   
                                                      μ
                                                      2
                                                   
                                                   )
                                                
                                                +
                                                ⋯
                                                +
                                                
                                                   (
                                                   
                                                      λ
                                                      K
                                                   
                                                   −
                                                   
                                                      μ
                                                      K
                                                   
                                                   )
                                                
                                                ]
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   (
                                                   λ
                                                   −
                                                   μ
                                                   )
                                                
                                                [
                                                
                                                   λ
                                                   
                                                      K
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   λ
                                                   −
                                                   μ
                                                   )
                                                
                                                +
                                                
                                                   λ
                                                   
                                                      K
                                                      −
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   
                                                      λ
                                                      2
                                                   
                                                   −
                                                   
                                                      μ
                                                      2
                                                   
                                                   )
                                                
                                                +
                                                ⋯
                                                +
                                                
                                                   (
                                                   
                                                      λ
                                                      K
                                                   
                                                   −
                                                   
                                                      μ
                                                      K
                                                   
                                                   )
                                                
                                                ]
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Since λi
                            − μi
                            = (λ − μ)(λ
                           
                              i − 1 + λ
                           
                              i − 2
                           μ + ⋅⋅⋅ + μ
                           
                              i − 1) for any positive integer i, the above expression can be written as (λ − μ)2 multiplied by a positive component. Therefore, ∂T/∂λ > 0.□


                           If a real function f is increasing and convex on an open interval, then the inverse function f
                           −1 
                           is increasing and concave (
                           
                              Binmore, 1977
                           
                           ).
                        


                           Assume that I(μ) is twice-differentiable. If I(μ) is an increasing convex function of μ, and I′ ≠ 0, then T(λ, μ(I)) defined by 
                           (11) 
                           is an increasing concave function of I.

The loss probability can be written as

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   
                                                      
                                                         
                                                            1
                                                            
                                                               
                                                                  (
                                                                  λ
                                                                  /
                                                                  μ
                                                                  )
                                                               
                                                               K
                                                            
                                                         
                                                         +
                                                         
                                                            1
                                                            
                                                               
                                                                  (
                                                                  λ
                                                                  /
                                                                  μ
                                                                  )
                                                               
                                                               
                                                                  K
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                         +
                                                         ⋯
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           which obviously decreases in μ. Thus, the throughput increases in μ, i.e., ∂T/∂μ > 0. From Theorem 3, we have dμ/dI > 0 and

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      T
                                                   
                                                   
                                                      ∂
                                                      I
                                                   
                                                
                                                =
                                                
                                                   
                                                      ∂
                                                      T
                                                   
                                                   
                                                      ∂
                                                      μ
                                                   
                                                
                                                
                                                
                                                   
                                                      d
                                                      μ
                                                   
                                                   
                                                      d
                                                      I
                                                   
                                                
                                                >
                                                0
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Since B(λ, μ, K) is convex in μ, T(λ, μ) is concave in μ. Therefore,

                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                2
                                             
                                             T
                                          
                                          
                                             ∂
                                             
                                                I
                                                2
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∂
                                                2
                                             
                                             T
                                          
                                          
                                             ∂
                                             
                                                μ
                                                2
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   d
                                                   μ
                                                
                                                
                                                   d
                                                   I
                                                
                                             
                                             )
                                          
                                          2
                                       
                                       +
                                       
                                          
                                             ∂
                                             T
                                          
                                          
                                             ∂
                                             μ
                                          
                                       
                                       
                                       
                                          
                                             
                                                d
                                                2
                                             
                                             μ
                                          
                                          
                                             d
                                             
                                                I
                                                2
                                             
                                          
                                       
                                       ≤
                                       0
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       
                                          
                                             d
                                             2
                                          
                                          μ
                                       
                                       
                                          d
                                          
                                             I
                                             2
                                          
                                       
                                    
                                    ≤
                                    0
                                 
                              
                            is immediate from Theorem 3.□

Based on Proposition 5 below, we show Theorem 4 which is stronger than Proposition 4.

                        Proposition 5
                        
                           T(λ, μ) defined by 
                           (11) 
                           is jointly concave in λ and μ (
                           
                              Nagarajan & Towsley, 1992
                           
                           ).


                           Assume that I(μ) is twice-differentiable. If I(μ) is an increasing convex function of μ, and I′ ≠ 0, then T(λ, μ(I)) defined by 
                           (11) 
                           is jointly concave in λ and I.

In order to show that T(λ, μ(I)) is jointly concave in λ and I, it is necessary to show that the Hessian is negative semi-definite. The Hessian is

                              
                                 
                                    
                                       H
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               2
                                                            
                                                            T
                                                         
                                                         
                                                            ∂
                                                            
                                                               λ
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∂
                                                                  2
                                                               
                                                               T
                                                            
                                                            
                                                               ∂
                                                               λ
                                                               ∂
                                                               μ
                                                            
                                                         
                                                         
                                                            
                                                               d
                                                               μ
                                                            
                                                            
                                                               d
                                                               I
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                
                                                
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∂
                                                                  2
                                                               
                                                               T
                                                            
                                                            
                                                               ∂
                                                               λ
                                                               ∂
                                                               μ
                                                            
                                                         
                                                         
                                                            
                                                               d
                                                               μ
                                                            
                                                            
                                                               d
                                                               I
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∂
                                                                  2
                                                               
                                                               T
                                                            
                                                            
                                                               ∂
                                                               
                                                                  μ
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     d
                                                                     μ
                                                                  
                                                                  
                                                                     d
                                                                     I
                                                                  
                                                               
                                                               )
                                                            
                                                            2
                                                         
                                                         +
                                                         
                                                            
                                                               ∂
                                                               T
                                                            
                                                            
                                                               ∂
                                                               μ
                                                            
                                                         
                                                         
                                                         
                                                            
                                                               
                                                                  d
                                                                  2
                                                               
                                                               μ
                                                            
                                                            
                                                               d
                                                               
                                                                  I
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           Since T(λ, μ) is jointly concave in λ and μ, the following matrix is negative semi-definite:

                              
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               2
                                                            
                                                            T
                                                         
                                                         
                                                            ∂
                                                            
                                                               λ
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               2
                                                            
                                                            T
                                                         
                                                         
                                                            ∂
                                                            λ
                                                            ∂
                                                            μ
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                
                                                
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               2
                                                            
                                                            T
                                                         
                                                         
                                                            ∂
                                                            λ
                                                            ∂
                                                            μ
                                                         
                                                      
                                                   
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               2
                                                            
                                                            T
                                                         
                                                         
                                                            ∂
                                                            
                                                               μ
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           Since 
                              
                                 
                                    
                                       
                                          
                                             ∂
                                             2
                                          
                                          T
                                       
                                       
                                          ∂
                                          
                                             λ
                                             2
                                          
                                       
                                    
                                    ≤
                                    0
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          ∂
                                          T
                                       
                                       
                                          ∂
                                          μ
                                       
                                    
                                    
                                    
                                       
                                          
                                             d
                                             2
                                          
                                          μ
                                       
                                       
                                          d
                                          
                                             I
                                             2
                                          
                                       
                                    
                                    ≤
                                    0
                                    ,
                                 
                              
                            
                           H is negative semi-definite as well.□

We introduce an illustrative example which is again used later for parametric analysis. Let us consider the simple network in Fig. 2
                      where the length of links are the numbers next to the links and the demand weights of nodes are the numbers next to the nodes.

Suppose that θ = 1, p = 1, c = 0, K = 2, S = 0.02, α = 0.1, and I(μ) = 9μ
                     2. Quadratic investment functions have been used in the literature (See Bitran and Tirupati, 1989). Given a fixed set of m store locations, the profit function of a store with arrival rate λ is then

                        
                           
                              
                                 f
                                 
                                    (
                                    I
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   1
                                                   )
                                                
                                                
                                                   (
                                                   λ
                                                   )
                                                
                                                
                                                   [
                                                   
                                                      1
                                                      −
                                                      
                                                         
                                                            9
                                                            
                                                               
                                                                  (
                                                                  λ
                                                                  /
                                                                  
                                                                     I
                                                                  
                                                                  )
                                                               
                                                               2
                                                            
                                                            
                                                               (
                                                               1
                                                               −
                                                               3
                                                               λ
                                                               /
                                                               
                                                                  I
                                                               
                                                               )
                                                            
                                                         
                                                         
                                                            1
                                                            −
                                                            27
                                                            
                                                               
                                                                  (
                                                                  λ
                                                                  /
                                                                  
                                                                     I
                                                                  
                                                                  )
                                                               
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                                −
                                                I
                                                −
                                                0.02
                                             
                                          
                                          
                                             
                                                
                                                if
                                                
                                                I
                                                ≠
                                                0
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             
                                                
                                                otherwise.
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

We first demonstrate a hierarchical solution approach (similar to the one discussed in the Introduction) which results in a substantial decrease in the total profit of this network. Due to the concavity of f(I), we use the Golden Section method (Bertsekas, 1999) to find an optimal investment of a store for any given arrival rate. After complete enumeration, an optimal solution for (P
                     1) with z*(P
                     1) = 0.0205 is to locate 5 stores at nodes 1, 2, 4, 5, and 6 with arrival rates 0.15, 0.167, 0.1, 0.4, and 0.15 (with a total of 0.967), respectively. Consider the third store located at node 4 with an arrival rate of 0.1. Since the objective function of 
                        
                           (
                           
                              P
                              j
                              0
                           
                           )
                        
                      (or g(I)) is unimodal by Theorem 1 or 2, we again use the Golden Section method to solve 
                        
                           (
                           
                              P
                              j
                              0
                           
                           )
                        
                      with λj
                      = 0.1 and find 
                        
                           
                              z
                              *
                           
                           
                              (
                              
                                 P
                                 j
                                 0
                              
                              )
                           
                           =
                           0.0436
                        
                     . This means the largest possible ROI with λj
                      = 0.1 is 0.0436 ( < 10 percent) and it is better off to close this store. After closing the store at node 4, the arrival rates at the rest 4 stores are 0.15, 0.167, 0.45, and 0.15 (with a total of 0.9167), respectively. Solve 
                        
                           (
                           
                              P
                              j
                              2
                           
                           )
                        
                      for each store. Then, the resulting solution is not optimal for (P
                     2) with an objective value of 0.0192 which corresponds to a decrease of total profit over 6 percent.

By complete enumeration, however, we find that an optimal solution for (P
                     2) with z*(P
                     2) = 0.0203 is to locate 4 stores at nodes 1, 3, 5, and 6 with arrival rates 0.233, 0.15, 0.4, and 0.15 (with a total of 0.9333), respectively. The optimal value of z*(P
                     2) = 0.0203 corresponds to about 1 percent decrease in the total profit which is substantially larger than that from the hierarchical approach. In this case, the optimal solution for (P
                     2) has the same cardinality of that of (P
                     1), but one element differs from one solution to the other.

We note that more demands to stores do not necessarily mean a larger throughput leading to a larger total profit. If we locate 4 stores at nodes 1, 4, 5, and 6, the arrival rates are 0.233, 0.1, 0.4, 0.217 (with a total of 0.95), respectively. However, the objective value of (P
                     2) is 0.018. (P
                     2) would not only increase demands, but also balance them among the stores based on congestion. For example, when the investment function I(μ) is linear, i.e., I(μ) = bμ + e, all open stores must have the same utilization λ/μ if the ROI constraints (10) are non-binding. This can be seen from the first-order condition on μ of the profit function f(I(μ))

                        
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             p
                                             −
                                             c
                                             )
                                          
                                          
                                             
                                                K
                                                
                                                   
                                                      (
                                                      λ
                                                      /
                                                      μ
                                                      )
                                                   
                                                   
                                                      K
                                                      +
                                                      1
                                                   
                                                
                                                −
                                                
                                                   (
                                                   K
                                                   +
                                                   1
                                                   )
                                                
                                                
                                                   
                                                      (
                                                      λ
                                                      /
                                                      μ
                                                      )
                                                   
                                                   
                                                      K
                                                      +
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      (
                                                      λ
                                                      /
                                                      μ
                                                      )
                                                   
                                                   
                                                      2
                                                      K
                                                      +
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   [
                                                   1
                                                   −
                                                   
                                                      
                                                         (
                                                         λ
                                                         /
                                                         μ
                                                         )
                                                      
                                                      
                                                         K
                                                         +
                                                         1
                                                      
                                                   
                                                   ]
                                                
                                                2
                                             
                                          
                                          =
                                          b
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

We proceed with parametric analysis using the same example. Each curve is drawn from a combination of (S, K), where S is the fixed setup cost and K is often referred to as “maximum queue length” over which an arriving customer cannot join the queue. However, in this paper, it is not only the physical size of a store. Interpreted practically, it is a proxy for the degree of customers’ “willingness” to join a store or “patience” on waiting. For a larger K, a customer is more willing to join and wait in the queue. This interpretation allows us to investigate the impact of different degrees of patience (even though they are discretized as K), on the total profit of a network. First, Fig. 3
                      plots optimal total profit (z*(P
                     2)) over ROI threshold (α).

Some observations are summarized. First, a larger K (representing more patient customers) yields a larger z*(P
                     2). Second, z*(P
                     2) is non-increasing in α. This observation can be interpreted from Proposition 2 and Property 1. Suppose all ROI constraints in (P
                     2) are non-binding for α ≤ 
                        α
                      . Then, z*(P
                     2) remains the same. For α > 
                        α
                     , some ROI constraints start to be binding and thus z*(P
                     2) decreases.

Curves of z*(P
                     2) are neither concave nor convex in α. One of the reasons is that optimal solutions for different α values locate different numbers of stores. The curves still appear “concave-like” overall in the sense that they get more “elastic” as α increases. For example, the curve of (S = 0.25, K = 1) shows that, as α increases from 0.35 to 0.40, z*(P
                     2) decreases by 25 percent. However, as α increases from 0.40 to 0.45, z*(P
                     2) decreases by 100 percent.


                     Fig. 4
                      represents a retail chain with a lower ROI in contrast to Fig. 3. The results are similar and parameters are the same as in the previous case except for p = 3 and c = 2. Since p − c = 1 is the same and the numerator (or profit) of the ROI function in (2) remains the same. However, c = 1 increases to c = 2, ROI decreases for any α. Hence, as α increases, it approaches to 
                        
                           α
                           ¯
                        
                      faster because the corresponding feasible set of (P
                     2) approaches faster to an empty set. Thus, z*(P
                     2) drops steeper than in Fig. 3.

From Figs. 3 and 4 above, we observe that, as α increases, z*(P
                     2) deceases steeper. When an already-high α is required to increase further, z*(P
                     2) tends to decrease significantly even for a slight increase of α. This observation is the case for other metrics such as the optimal number of stores as shown below in Fig. 5
                     . The same parameters in Fig. 4 are used except for S = 0.25.

It is interesting to interpret Fig. 6
                      below along with Fig. 5.


                     Fig. 6 plots average utilization over α. The same parameters in Fig. 4 are used except for S = 0.25. We define the average utilization of a network as total arrival rate divided by total service rate of all open stores. In order to increase the total profit, the retail chain manager would attempt to reduce lost demand. She can reasonably expand investment by adding capacity (increasing service rates) of some open stores or locating more stores. It is plausible that more investment would decrease average utilization. However, this is not the case in Fig. 6 over the range of α where some ROI constraints are binding. Observe that average utilization is higher for a smaller K. When customers are impatient, the retail chain loses more demand. In this case, it might be more profitable to reduce investment/stores. When an ROI constraint is binding, the ROI threshold (α) would further limit investment. This could lead to a significant decrease in total service rate and also an unusually high average utilization, which occurs in parallel with fewer stores as shown in Fig. 5. Essentially, this observation results from the “conservativeness” of ROI criteria. When a high ROI threshold (α) is required, she would forego a substantial amount of total profit by reducing investment (decapacitating or closing stores) at the expense of lost demand. She should note, however, that reduced investment due to financial requirements can lead to a significantly high average utilization which directly affects service level measures such as waiting time.

In this section, we introduce an upper bound of z*(P
                     2) and develop three heuristic algorithms to solve (P
                     2). We note that application of these heuristics extends to a general class of jointly concave profit functions, but not limited to queueing-based profit functions in the previous section.

Given a fixed set of m store locations, the following linear integer programming formulation returns a maximal total demand per unit time:

                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             (
                                             MP
                                             )
                                             
                                             max
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   λ
                                                   ¯
                                                
                                                m
                                             
                                             =
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                w
                                                i
                                             
                                             ϕ
                                             
                                                (
                                                
                                                   d
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          s.t.
                                       
                                       
                                          
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             =
                                             1
                                             
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≤
                                             
                                                y
                                                j
                                             
                                             
                                             
                                             
                                             
                                             i
                                             ,
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                y
                                                j
                                             
                                             =
                                             m
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                             
                                                y
                                                j
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             
                                             
                                             i
                                             ,
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

By the definition of ϕ(dij
                        ), the maximal total demand is 
                           
                              
                                 
                                    λ
                                    ¯
                                 
                                 m
                              
                              =
                              ∑
                              
                                 w
                                 i
                              
                              −
                              
                                 (
                                 
                                    ∑
                                    i
                                 
                                 
                                    ∑
                                    j
                                 
                                 
                                    w
                                    i
                                 
                                 
                                    d
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                 
                                 )
                              
                              /
                              
                                 (
                                 θ
                                 
                                    d
                                    max
                                 
                                 )
                              
                           
                        . This formulation corresponds to the classical median problem (Hakimi, 1964) and we can use an efficient heuristic to solve (MP), e.g., a Lagrangian Relaxation heuristic with subgradient method.

                           Proposition 6
                           
                              There exists an integer m such that
                              
                                 
                                    
                                       m
                                       [
                                       
                                          (
                                          p
                                          −
                                          c
                                          )
                                       
                                       T
                                       
                                          (
                                          
                                             
                                                
                                                   λ
                                                   ¯
                                                
                                                m
                                             
                                             m
                                          
                                          ,
                                          
                                             I
                                             *
                                          
                                          )
                                       
                                       −
                                       
                                          I
                                          *
                                       
                                       −
                                       S
                                       ]
                                    
                                 
                               
                              is an upper bound of z*(P
                              1) ≥ z*(P
                              2), where I* ≥ 0 is a maximizer of
                              
                                 
                                    
                                       
                                          (
                                          p
                                          −
                                          c
                                          )
                                       
                                       T
                                       
                                          (
                                          
                                             
                                                
                                                   λ
                                                   ¯
                                                
                                                m
                                             
                                             m
                                          
                                          ,
                                          I
                                          )
                                       
                                       −
                                       I
                                       −
                                       S
                                    
                                 
                              .

Suppose that an optimal solution for (P
                              1) is to open m stores with 
                                 
                                    λ
                                    1
                                    ′
                                 
                               and 
                                 
                                    
                                       I
                                       1
                                       ′
                                    
                                    ,
                                    …
                                    ,
                                    
                                       λ
                                       m
                                       ′
                                    
                                 
                               and 
                                 
                                    
                                       I
                                       m
                                       ′
                                    
                                    ,
                                 
                               respectively, which is a feasible solution for the following problem:

                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                   
                                                      
                                                         λ
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         λ
                                                         m
                                                      
                                                      ,
                                                      
                                                         I
                                                         1
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         I
                                                         m
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         m
                                                      
                                                      
                                                         [
                                                         
                                                            (
                                                            p
                                                            −
                                                            c
                                                            )
                                                         
                                                         T
                                                         
                                                            (
                                                            
                                                               λ
                                                               j
                                                            
                                                            ,
                                                            
                                                               I
                                                               j
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            I
                                                            j
                                                         
                                                         −
                                                         S
                                                         ]
                                                      
                                                   
                                                
                                             
                                             
                                          
                                          
                                             
                                                s.t.
                                             
                                             
                                                
                                                   
                                                      
                                                         λ
                                                         1
                                                      
                                                      +
                                                      ⋯
                                                      +
                                                      
                                                         λ
                                                         m
                                                      
                                                      ≤
                                                      
                                                         
                                                            λ
                                                            ¯
                                                         
                                                         m
                                                      
                                                      .
                                                   
                                                
                                             
                                             
                                                
                                             
                                          
                                       
                                    
                                 
                              Introducing a Lagrange multiplier ν, we find λ
                              1, …, λm, I
                              1, …, Im
                              , and ν by solving the unconstrained problem

                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      max
                                                      
                                                         
                                                            λ
                                                            1
                                                         
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            λ
                                                            m
                                                         
                                                         ,
                                                         
                                                            I
                                                            1
                                                         
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            I
                                                            m
                                                         
                                                         ,
                                                         ν
                                                      
                                                   
                                                   
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         m
                                                      
                                                      
                                                         [
                                                         
                                                            (
                                                            p
                                                            −
                                                            c
                                                            )
                                                         
                                                         T
                                                         
                                                            (
                                                            
                                                               λ
                                                               j
                                                            
                                                            ,
                                                            
                                                               I
                                                               j
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            I
                                                            j
                                                         
                                                         −
                                                         S
                                                         ]
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                      −
                                                      
                                                      ν
                                                      [
                                                      
                                                         λ
                                                         1
                                                      
                                                      +
                                                      ⋯
                                                      +
                                                      
                                                         λ
                                                         m
                                                      
                                                      −
                                                      
                                                         
                                                            λ
                                                            ¯
                                                         
                                                         m
                                                      
                                                      ]
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              Since the objective function is jointly concave in λ
                              1, …, λm, I
                              1, …, Im
                              , the necessary and sufficient conditions for optimality are

                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                      p
                                                      −
                                                      c
                                                      )
                                                   
                                                   
                                                      
                                                         ∂
                                                         T
                                                         (
                                                         
                                                            λ
                                                            j
                                                         
                                                         ,
                                                         
                                                            I
                                                            j
                                                         
                                                         )
                                                      
                                                      
                                                         ∂
                                                         
                                                            λ
                                                            j
                                                         
                                                      
                                                   
                                                   −
                                                   ν
                                                   =
                                                   0
                                                   
                                                
                                             
                                             
                                                
                                                   j
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   m
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                      p
                                                      −
                                                      c
                                                      )
                                                   
                                                   
                                                      
                                                         ∂
                                                         T
                                                         (
                                                         
                                                            λ
                                                            j
                                                         
                                                         ,
                                                         
                                                            I
                                                            j
                                                         
                                                         )
                                                      
                                                      
                                                         ∂
                                                         
                                                            I
                                                            j
                                                         
                                                      
                                                   
                                                   −
                                                   1
                                                   =
                                                   0
                                                   
                                                
                                             
                                             
                                                
                                                   j
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   m
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         λ
                                                         1
                                                      
                                                      +
                                                      ⋯
                                                      +
                                                      
                                                         λ
                                                         m
                                                      
                                                      −
                                                      
                                                         
                                                            λ
                                                            ¯
                                                         
                                                         m
                                                      
                                                      =
                                                      0
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              It is obvious that 
                                 
                                    
                                       λ
                                       1
                                    
                                    =
                                    ⋯
                                    =
                                    
                                       λ
                                       m
                                    
                                    =
                                    
                                       
                                          λ
                                          ¯
                                       
                                       m
                                    
                                    /
                                    m
                                 
                               in an optimal solution, which completes the proof.□

We discuss how to find an upper bound of 
                           
                              
                                 λ
                                 ¯
                              
                              m
                           
                         in the Maximal Total Demand heuristic of the next subsection. We can also use a binary search to find a minimal demand 
                           λ
                         of a store such that h(λ, I) = (p − c)T(λ, I) − I − S − α(I + S) ≥ 0 for a given α, since h(λ, I) is jointly concave in λ and I. Thus, the maximal number of stores to be located is not more than min {n, ⌊ ∑wi
                        / 
                           λ
                          ⌋} and, due to customer’ distance sensitivity, fewer stores are located.

All of the heuristics use procedure local_search including drop/add/interchange procedures detailed below (See Brimberg et al., 2008 for the description and other references). The procedure local_search starts with a set Y of store locations. Let z(P) be an objective function value of a problem (P), which is not necessarily an optimal value of z*(P).


                        Procedure local_search(Y):

                           
                              
                                 Step 1:
                              
                              Fix Y and calculate z(P
                                 2).

(Drop) For each open store yj
                                  ∈ Y, calculate z(P
                                 2) using the solution Y∖{yj
                                 }.

(Add) For each closed store 
                                    
                                       
                                          y
                                          k
                                       
                                       ∉
                                       Y
                                       ,
                                    
                                  calculate z(P
                                 2) using the solution Y∪{yk
                                 }.

(Interchange) For each pair (yj, yk
                                 ), where yj
                                  ∈ Y and 
                                    
                                       
                                          y
                                          k
                                       
                                       ∉
                                       Y
                                       ,
                                    
                                  calculate z(P
                                 2) using the solution (Y∖{yj
                                 })∪{yk
                                 }.

Choose the solution Y* that yields the largest z(P
                                 2) in Steps 2, 3, and 4.

If there is no improvement in a full cycle of Steps 1–5, stop; Otherwise, set Y = Y* and go to Step 1.

It is not required that the starting and generated solutions in Steps 2–4 have to be feasible. If the unit-time demand of an open store, say yj
                        , in Y is less than 
                           λ
                        , we mark Y as infeasible, instead of evaluating Y∖{yj
                        }.

The Greedy heuristic attempts to choose potential locations that are the “best” at each iteration. This algorithm starts with an empty solution set Y and keeps adding one store to Y until there is no more improvement. At each iteration, it chooses the store whose addition yields the most increase in z(P
                           2). The Greedy heuristic calls procedure local_search at the end.

Variable Neighborhood Search (VNS) is a meta-heuristic for solving combinatorial problems (Mladenovic & Hansen, 1997). It changes neighborhoods systematically within a local search algorithm. First, we define the number of different elements in Y
                           1 and Y
                           2 as

                              
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                                
                                                   (
                                                   
                                                      Y
                                                      1
                                                   
                                                   ,
                                                   
                                                      Y
                                                      2
                                                   
                                                   )
                                                
                                                =
                                                
                                                   max
                                                   {
                                                   |
                                                
                                                
                                                   Y
                                                   1
                                                
                                                ∖
                                                
                                                   Y
                                                   2
                                                
                                                
                                                   |
                                                   ,
                                                   |
                                                
                                                
                                                   Y
                                                   2
                                                
                                                ∖
                                                
                                                   Y
                                                   1
                                                
                                                
                                                   |
                                                   }
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           For example, if Y
                           1 = {1, 2} and Y
                           2 = {1, 2, 3}, then ρ(Y
                           1, Y
                           2) = max {0, 1} = 1. For every k = 1, 2, …, we define the k th neighborhood of Y as

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                   k
                                                
                                                
                                                   (
                                                   Y
                                                   )
                                                
                                                =
                                                
                                                   {
                                                   
                                                      Y
                                                      ′
                                                   
                                                   :
                                                   ρ
                                                   
                                                      (
                                                      Y
                                                      ,
                                                      
                                                         Y
                                                         ′
                                                      
                                                      )
                                                   
                                                   =
                                                   k
                                                   }
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Note that the neighborhood used before in the local search procedure corresponds to 
                              
                                 
                                    N
                                    1
                                 
                                 
                                    (
                                    Y
                                    )
                                 
                              
                            in the current procedure. Comparing to local search heuristics, which are usually “1-opt” procedures, VNS does not stop at the 
                              
                                 
                                    N
                                    1
                                 
                                 
                                    (
                                    Y
                                    )
                                 
                              
                           . Suppose Y is the current solution, VNS chooses a solution, say Y′, from 
                              
                                 
                                    N
                                    1
                                 
                                 
                                    (
                                    Y
                                    )
                                 
                              
                            randomly and runs a local search (e.g. procedure local_search) in 
                              
                                 
                                    N
                                    1
                                 
                                 
                                    (
                                    
                                       Y
                                       ′
                                    
                                    )
                                 
                              
                           . If there is no improvement, VNS looks for another starting solution from 
                              
                                 
                                    N
                                    2
                                 
                                 
                                    (
                                    Y
                                    )
                                 
                              
                            randomly and runs a new local search and so on. When a better solution is identified, VNS sets it as the new current solution and a new iteration starts until some stopping condition is met. In this paper, we terminate the algorithm when the maximum number of iterations is reached. It is possible that there is no improvement after we run a local search for the randomly picked 
                              
                                 
                                    Y
                                    ′
                                 
                                 ∈
                                 
                                    N
                                    
                                       k
                                       max
                                    
                                 
                                 
                                    (
                                    Y
                                    )
                                 
                                 ,
                              
                            where k
                           max  is the maximum neighborhood size. In this case, we choose a random solution from 
                              
                                 
                                    N
                                    1
                                 
                                 
                                    (
                                    Y
                                    )
                                 
                              
                            and start a new iteration again. Given a solution Y, there are at most |Y| drop moves, at most min {n, ⌊ ∑wi
                           / 
                              λ
                             ⌋} − |Y| add moves, and at most min {min {n, ⌊ ∑wi
                           / 
                              λ
                             ⌋} − |Y|, |Y|} interchange moves. Thus, we set 
                              
                                 
                                    
                                       k
                                       max
                                    
                                    
                                       =
                                       max
                                       {
                                       min
                                    
                                    
                                       {
                                       n
                                       ,
                                       
                                          ⌊
                                          
                                          ∑
                                          
                                             w
                                             i
                                          
                                          /
                                          
                                             λ
                                             ̲
                                          
                                          
                                          ⌋
                                       
                                       }
                                    
                                    −
                                    
                                       |
                                       Y
                                       |
                                       ,
                                       |
                                       Y
                                       |
                                       }
                                    
                                 
                              
                           . The VNS procedure is stated as below.


                           Procedure VNS:

                              
                                 
                                    Step 1:
                                 
                                 Find an initial solution Y. Set the current best solution Y
                                    ⋆ = Y and k = 1.

Choose a solution Y′ randomly from 
                                       
                                          
                                             N
                                             k
                                          
                                          
                                             (
                                             
                                                Y
                                                ☆
                                             
                                             )
                                          
                                       
                                    .

Call procedure local_search to apply a local search based on Y′.

If the iteration limit is reached, stop. If k < k
                                    max  and the returned solution of Step 3, Y′′, is not better than Y
                                    ⋆, set k = (k + 1) and go back to Step 2. If k = k
                                    max  and the returned solution of Step 3, Y′′, is not better than Y
                                    ⋆, set k = 1 and go back to Step 2. Otherwise, set Y
                                    ⋆ = Y′′ and k = 1 and go back to Step 2.

By solving the median problem (MP), we can obtain a maximal total demand of m stores. In particular, we use the Lagrangian Relaxation heuristic (See Daskin, 1995, for more details) to find an upper bound of 
                              
                                 
                                    λ
                                    ¯
                                 
                                 m
                              
                            in (MP), which is used to calculate an upper bound of z*(P
                           1) in Proposition 6. Delivering tight bounds most of the time (less than 0.15 percent, see Daskin, 1995), the Lagrangian Relaxation heuristic with subgradient method is one of the most computationally attractive heuristics for a median problem. We state the Maximal Total Demand (MTD) heuristic below.


                           Procedure MTD:

                              
                                 
                                    Step 1:
                                 
                                 Set m = 0.

Set m = m + 1. If m > min {n, ⌊ ∑wi
                                    / 
                                       λ
                                      ⌋} (the maximal number of stores), stop.

Solve the m-median problem using the Lagrange Relaxation heuristic to obtain a solution, Y, and an upper bound.

Update the upper bound if necessary.

Call procedurelocal_search to apply a local search based on Y.

Update the best solution if necessary and go to Step 2.

In order to test the heuristic algorithms, a computational experiment was conducted on an extensive set of instances of (P
                     2). All runs were performed on a PC equipped with 2.33 gigahertz processor and 4G RAM. The procedures were coded in ANSI C. The problem data were generated randomly as follows: (i) The Cartesian coordinates of the nodes were generated uniformly over the interval (0, 100). (ii) Then nodes were connected randomly until a tree was formed. (iii) Finally, a random number of links (a random integer between 0 and n(n − 1)/2 − (n − 1), where n = |N|) were added to the generated tree. All demand weights were generated randomly over the interval (0,1), and then standardized to make the total demand equal to 200. The length of each link was calculated using the Euclidean distance formula.

We chose the constant θ in function ϕ(dij
                     ) from {0.5, 1}; the real ROI (β in Proposition 1) from set {0, 0.1, 0.125, 0.15$, $0.175, 0.20, 0.225, 0.25, 0.275, 0.3}; average cost c ∈ {1, 2} with average expense p = c + 1; maximum queue length K ∈ {1, 3}; setup cost S ∈ {1, 3}. In this experiment, we set the investment as I(μ) = bμ, where b ∈ {0.25, 0.5}. In total, there were 320 combinations. For each case, we executed the Greedy and MTD heuristics first. Then, we executed the VNS heuristic based on each of the solutions returned by these two heuristics. The VNS heuristic, involving more iterations, took much longer time than the other two heuristics.

In order to measure the performance of the heuristics, we define

                        
                           
                              
                                 
                                    
                                       
                                          Gap
                                          =
                                          
                                             
                                                Upper
                                                
                                                bound
                                                −
                                                z
                                                (
                                                
                                                   P
                                                   2
                                                
                                                )
                                                
                                                returned
                                                
                                                by
                                                
                                                a
                                                
                                                heuristic
                                             
                                             
                                                z
                                                (
                                                
                                                   P
                                                   2
                                                
                                                )
                                                
                                                returned
                                                
                                                by
                                                
                                                a
                                                
                                                heuristic
                                             
                                          
                                          ×
                                          100
                                          
                                          percent
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Among the 320 cases on 30-node random graphs, 186 cases were feasible (see Table 1
                     ). Among the 320 cases on 50-node random graphs, 190 cases were feasible. These feasible cases are summarized further (see Table 2
                     ).

Computational results are similar for 30-node and 50-node graphs and the proposed heuristics appear insensitive to the size of a network. Average gaps are not large ranging from 6.28 to 11.73 percent and about two thirds (from 58.47 to 72.11 percent) of the cases guarantee a gap of at most 5 percent. Since the gaps represent the difference between an upper bound and z(P
                     2) returned by a heuristic, the difference between z*(P
                     2) and z(P
                     2) must be even smaller. We observe that the MTD heuristic does not outperform consistently the Greedy heuristic. Although the Greedy heuristic performs better overall, the MTD heuristic is still an essential part of this experiment since it returns an upper bound of z*(P
                     2).

@&#CONCLUSION@&#

Our model was formulated under a more general assumption that the marginal profit of a store is decreasing in demand and investment, which was omitted in the previous location models under ROI criteria. In particular, we assumed that the profit function of a store is jointly concave in demand and investment, and showed the corresponding ROI function is unimodal.

Motivated by our observation on real location decisions, we developed a model for optimal location of retail stores on a network. The objective is to maximize the total profit of a network subject to a pre-specified ROI threshold required at each store. In order to analyze the resulting formulation, we focused on a decomposed subproblem regarding to a store. We showed that an optimal investment of the subproblem is equivalent to that of a subproblem without an ROI constraint for ROI thresholds under one critical value, and the subproblem becomes infeasible for ROI thresholds over the other critical value.

We demonstrated an application of our model to location of retail stores operating as an M/M/1/K queue and showed the joint concavity of a store’s profit. To this end, we proved the joint concavity of the throughput of an M/M/1/K queue. These properties on an M/M/1/K queue are new to the best of our knowledge.

The parametric analysis of ROI thresholds bears managerial implications for retail chain managers when designing a network. First, as a higher ROI threshold is required, the marginal decrease of optimal total profit generally increases. Second, when customers are impatient, an optimal solution under ROI requirements tends to reduce investment/stores and result in (often surprisingly) high utilizations which affect service level measures such as waiting time.

We introduced an upper bound of an optimal value of the problem and developed three heuristic algorithms based on the structural properties of the profit and ROI functions. While computational results appear to be promising, the gaps are not small. Tighter upper bounds for smaller gaps are desirable in future research. We note the stronger performance of Greedy heuristic compared to the MTD heuristic. It would be interesting to investigate if similar heuristics using a “myopic” approach are successful in other types of location problems with ROI criteria.

Allowing explicitly competition between retail chains is a more realistic scenario, but the analysis would involve location of competitive facilities which adds far more complexity to our already challenging model.

@&#ACKNOWLEDGMENTS@&#

We would like to give special thanks to the editor for his time and efforts in the editorial process. Also, we are grateful to the anonymous reviewers for providing detailed and valuable comments which helped to improve this paper.

@&#REFERENCES@&#

