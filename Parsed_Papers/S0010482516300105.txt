@&#MAIN-TITLE@&#Assessment of fetal maturation age by heart rate variability measures using random forest methodology

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Random Forest identifies maturation related hrv parameters without pre-selection.


                        
                        
                           
                           Complexity indices in short time scales and skewness mainly predicted fetal maturation.


                        
                        
                           
                           Traditional hrv parameters did not contribute considerably to the prediction.


                        
                        
                           
                           Prediction with Random Forest is comparable to multivariate linear regression.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Fetal maturation

Heart rate variability

Multiscale complexity

Random forest

@&#ABSTRACT@&#


               
               
                  Fetal maturation age assessment based on heart rate variability (HRV) is a predestinated tool in prenatal diagnosis. To date, almost linear maturation characteristic curves are used in univariate and multivariate models. Models using complex multivariate maturation characteristic curves are pending.
                  To address this problem, we use Random Forest (RF) to assess fetal maturation age and compare RF with linear, multivariate age regression. We include previously developed HRV indices such as traditional time and frequency domain indices and complexity indices of multiple scales.
                  We found that fetal maturation was best assessed by complexity indices of short scales and skewness in state-dependent datasets (quiet sleep, active sleep) as well as in state-independent recordings. Additionally, increasing fluctuation amplitude contributed to the model in the active sleep state. None of the traditional linear HRV parameters contributed to the RF models. Compared to linear, multivariate regression, the mean prediction of gestational age (GA) is more accurate with RF than in linear, multivariate regression (quiet state: 
                        
                           
                              R
                           
                           
                              2
                           
                        
                        =
                        0
                        ,
                        617
                      vs. 
                        
                           
                              R
                           
                           
                              2
                           
                        
                        =
                        0
                        ,
                        461
                     , active state: 
                        
                           
                              R
                           
                           
                              2
                           
                        
                        =
                        0
                        ,
                        521
                      vs. 
                        
                           
                              R
                           
                           
                              2
                           
                        
                        =
                        0
                        ,
                        436
                     , state independent: 
                        
                           
                              R
                           
                           
                              2
                           
                        
                        =
                        0
                        ,
                        583
                      vs. 
                        
                           
                              R
                           
                           
                              2
                           
                        
                        =
                        0
                        ,
                        548
                     ).
                  We conclude that classification and regression tree models such as RF methodology are appropriate for the evaluation of fetal maturation age. The decisive role of adjustments between different time scales of complexity may essentially extend previous analysis concepts mainly based on rhythms and univariate complexity indices. Those system characteristics may have implication for better understanding and accessibility of the maturating complex autonomic control and its disturbance.
               
            

@&#INTRODUCTION@&#

Since heart rate patterns are one of the few signals obtainable from the fetus easily and non-invasively, they are predestinated for assessing the maturating fetal autonomic control and its disturbances [1–5]. The complex behavior of the maturating fetal autonomic nervous system (ANS) was recently described by means of corresponding heart rate variability (HRV) indices. However, the maturation itself is a complex and non-linear process. Interpretation of non-linear complexity characteristics is ambiguous and has been discussed with the formation of fetal behavioral states [6–8]. On the basis of changes in the power spectra, van Leeuwen et al. showed that maturation is characterized by non-linear characteristics [9] and different stages of fetal development were discussed in association with the increasing influence of the different branches of the ANS [3,10]. However, to date the complex maturation process was mainly approximated by linear characteristic curves in univariate regression models using linear and non-linear HRV indices [6,9–11]. The investigation of the performance of the best predicting HRV indices in a multivariate model using non-linear and complex maturation characteristic curves is pending. Hoyer et al. recently proposed a fetal autonomic brain age score (fABAS) for the assessment of fetal age, based on MLR models according to universal developmental characteristics [12,13]. However, parameter selection for MLR models in these investigations was based on a pre-selection of HRV indices. Since even the maturation characteristic curves are not known and they can be different for different HRV indices, a complex non-linear approach without pre-setting is required.

With regard to that, classification and regression tree (CART) methodology such as Random Forest (RF) may provide potential advantages [14]. The non-linear and complex data structures of RF provide an ambitious technique for data mining, e.g. in geoinformatics [15,16] or computational biology [17–19]. A direct comparison between ordinary linear regression and RF was done by Nir et al., who investigated the performance of both models for the assessment of the nociception level under anesthesia [20]. They found that the advanced, non-linear approach performed better than linear regression. However, a general statement on the superiority of RF compared to other linear and non-linear models is limited due to the fact that the accuracy of predictions is biased by different methodological approaches and results heavily depend on the underlying problem [21]. With respect to clinical applications, researchers often try to obtain as much information as possible from the investigated process. Modeling such processes with common linear methods requires previous knowledge of interactions between variables and explicit modeling of non-linearities. RF as a non-linear, multivariate regression and classification methodology is able to overcome this problem, even when values are missing [14]. Additionally, the assessment of the parameter importance employed in RF provides a beneficial tool for the identification of important variables avoiding pre-selection of HRV parameters on the basis of single characteristic curves. Single applications of RF to heart rate time series in adults have been reported with satisfying results, e.g. in connection with sleep state classification [22], classification of cardiac rhythms [23], risk stratification for arrhythmic cardiac death [24], or the prediction of cardiovascular and cerebrovascular events [25]. As far as is known to the authors, the only application of RF in the context of fetal development was published by Peterek et al. who classified pathological, suspect and normal fetal states based on cardiotocography (CTG) measurements [26]. However, due to its restricted temporal resolution, CTG is of limited appropriateness for the precise assessment of fast heart rate modulation [27]. According to the “developmental origins of adult disease (Barker) hypothesis” (also known as fetal programming) [28], the precise evaluation of the normal development is important with respect to the early identification of fetal developmental disorders since these have implications for health problems in later life which cannot completely be compensated for by later postnatal therapies [29].

The objective of the present work is to evaluate the capability of a complex maturation model, using previously developed HRV indices obtained from high resolution fetal magnetocardiographic (fMCG) recordings and complex maturation functions to predict fetal gestational age (GA) for the assessment of normal fetal development. Further, we compare results of GA prediction from RF methodology with linear, multivariate age regression.

@&#METHODS@&#

359 fMCG recordings were taken from healthy, singleton fetuses with an age between 21–41 weeks of gestational age (WGA). Recordings from subjects with intrauterine growth restriction, non-reassuring non-stress test based on conventional CTG, known chromosomal abnormalities or congenital abnormalities based on ultrasound diagnosis, fetal arrhythmia or previous exposure to synthetic steroids in utero were not considered for analysis. Additionally, maternal exclusion criteria were: administration of cardiovascular effective drugs, cardiovascular diseases, diabetes. The study was approved by the local ethics committee of the Friedrich Schiller University. All women signed a written, informed consent form.

The fMCG measurements were taken at the Biomagnetic Center in a magnetically shielded room using the vector-magnetograph ARGOS 200 (ATB Chieti, Italy). In order to prevent compression of the inferior vena cava, the pregnant women were positioned supine with a slight twist to either side. The fetal heart was localized by sonographic measurements prior to the fMCG recording. Afterwards, the dewar was positioned contactless as close as possible to the fetal heart. In the next step, the fMCG-signal was recorded for 30min at a sampling rate of 1024Hz. For fetal heart beat detection we used an own toolbox [41,42]. Incorrectly detected beats (less than 2%) were linearly interpolated resulting in artifact free normal-to-normal (NN) interval series. After signal preprocessing (signal preprocessing toolbox, BMDSys, Jena) the NN interval series were independently pre-classified by three collaborators into 10-minute state specific heart rate pattern (HRP), referring to quiet sleep (HRP I, n=111) and active sleep (HRP II, n=248) according to [43]. Pre-classification of these two HRP was based on the criteria proposed by Schneider et al. [44] applicable throughout the second half of gestation.According to the Maternity Guidelines of Germany (FIGO, 2011), the gestational age was determined based on the history of the last menstrual period and confirmed by obligatory first trimester ultrasound screening between 9 and 12 weeks of pregnancy. The ultrasound results were taken from the maternity documents.

The selection of HRV parameters for multivariate age regression was based on previous investigations of HRV parameters and their relation to the fetal development in our own group [3,6,7,10,12,13,44,33,38,39]. The selected parameter set consisted of parameters from traditional signal analysis methods in the time-and frequency domains according to the guidelines of the HRV Task Force [30], but also included parameters obtained from methods with a non-linear approach such as multiscale (MSE) complexity [36], asymmetry [40] and fractal scaling [32] (see Table 1
                        ). Table 1 shows the selected HRV parameters. A more detailed explanation and their interpretation can be found in [12,13].

Fetal maturation age was predicted by multivariate linear regression (MLR) and RF models for each state (HRP I, HRP II) and for state independent measurements (30min). The models were 70/30 split sample cross-validated. Model prediction accuracy was determined by the mean of the corrected coefficient of determination (R
                        2) from regression of predicted maturation age and real maturation age in WGA. Forward procedure (stepwise inclusion of variables while 
                           P
                           <
                           0.05
                        ) and backward procedure (stepwise exclusion of variables while 
                           P
                           >
                           0.1
                        ) was used in MLR models.

In RF models, each decision tree of the forest was built by using a random bootstrap sample of 2/3 of the training set and a randomly selected number of predictors m
                        
                           try
                         for splitting at each node in the tree. The remaining 1/3 samples of the training set (out-of-bag samples, OOB) were used to calculate an unbiased prediction error OOBerror which allowed to validate the model accuracy during training and to calculate absolute values of parameter importance. Relative parameter importance is calculated as the increase in prediction error if the values of the parameter are permuted across the OOB-observations. The more the prediction error increases, the more important is the particular parameter. This relative importance is computed for every tree and averaged and divided by the standard deviation over the entire ensemble. Relative parameter importance was used to define the final parameter set in the RF model: The parameters with the smallest parameter importance were stepwise discarded and afterwards the OOBerror calculated. The final parameter set was the one which yielded the smallest OOBerror. After defining the final parameter set, the model was applied to the test set. In order to find an appropriate value for the number of decision trees n
                        
                           tree
                         grown in RF, the OOBerror was calculated as a function of n
                        
                           tree
                        . The minimum of the variance of the OOBerror from 50 calculations where 
                           
                              
                                 n
                              
                              
                                 tree
                              
                           
                           >
                           100
                         was used to define n
                        
                           tree
                        . In this work m
                        
                           try
                         was set to the standard value of 
                           
                              
                                 m
                              
                              
                                 try
                              
                           
                           =
                           p
                           /
                           3
                         for regression, according to the suggestion of Breiman et al. [14].

@&#RESULTS@&#

We determined 
                        
                           
                              n
                           
                           
                              tree
                           
                        
                        =
                        500
                      as the optimal choice for the number of trees grown in RF, providing sufficient model complexity at a moderate calculation time. Further increase of n
                     
                        tree
                      showed only negligible effects on the OOBerror (See Fig. 1
                     ).

After defining the model parameters n
                     
                        tree
                      and m
                     
                        try
                     , fetal age regression was performed by RF for fetal states HRP I, HRP II and state independent measurements (30min). RF showed a slightly better prediction accuracy in all three groups compared to MLR (HRP I: 0,555 vs. 0,461; HRP II: 0,453 vs. 0,436; 30
                     
                     min: 0,596 vs. 0,548), see Fig. 2
                      left column. In both regression models, RF and MLR, age prediction was best in state-independent measurements, followed by the quiet sleep state (HRP I).

In each cross-validation run of the particular group, the number of most important parameters selected by the RF model varied from min 12 to max 42. In order to select the most relevant parameters for each group, we selected solely those parameters, which appeared in all cross-validation runs as most important ones (Fig. 2 right column). In HRP I, parameter importance measurements show that most of the age-dependent information is contributed in the short scale range (scale 1–5) of multiscale generalized mututal information gMSE. In HRP II and 30min data, skewness (HRP II) and skewness + AMP (30min) clearly dominate parameter importance. However, also in these groups short scales of multiscale parameters MSE SE and gMSE appear as important predictors.

@&#DISCUSSION@&#

In this work we presented a novel approach for determining fetal maturation considering non-linear characteristics. In order to consider multiple interactions between HRV indices, we used a parameter set without any preselection on the basis of single characteristic curves of HRV parameters. As far as known to the authors, this is the first time that such a large number of linear and non-linear HRV parameters was included in a non-linear, multivariate analysis of fetal heart rate time series, obtained from high resolution fMCG measurements. Using parameter importance measurements embedded in the RF methodology, we were able to reduce the parameter set and identified important maturation related HRV indices. Our key finding is that the maturation of the ANS during 21–41 WGA is mainly reflected in changes of complexity indices belonging to different time scales. It is remarkable that none of the traditional parameters of the time domain (
                        meanHR
                        ,
                        SDNN
                        ,
                        RMSSD
                     ) contributed considerably to the prediction. However, the range of heart rate fluctuations determined by these parameters is covered by the multiscale approach. This result implies the importance of developing non-linear and complex processes and their associations across different time scales in the autonomic control system. Regarding the accuracy of fetal age prediction, RF show comparable results to MLR in HRP II and 30min data but slightly improved accuracy in HRP I by 10%. Hence, we may assume that these complex and non-linear heart rate pattern itself are characterized by a linear development in the investigated time period of gestation. The results of the RF model suggest that maturation in HRP II is not solely characterized by the increasing number of heart rate accelerations, plausibly associated with increasing skewness and fluctuation amplitude (AMP) [6,9–11], but rather in complex associations between skewness and short scale complexity (scale 1–3). Fetal maturation in HRP I was predominantly discriminated by short scales of multiscale complexity. These findings are consistent with the results reported in several studies, where particularly gMSE of scale 3 and associated scale ranges of permutation entropy (reflected in MSE KLE mean short) have been reported as potential markers for the assessment of the development of the ANS [12,38].

In a previous work we reported a fetal autonomic brain age score (fABAS) based on universal developmental indices, namely on indices of pattern formation, increasing pattern amplitude and increasing complexity [12,13]. In the present work indices of complexity and their associations over time scale mainly predicted fetal maturation. Those results are consistent with the physiological process of the growing and developing fetal autonomic control system where complex associations over an increasing number of neurons and neuronal control centers as well as over increasing time horizons evolve. It is obvious that most of the identified parameters are highly correlated and one can assume that those will be rated with higher importance. However, appearance of correlated neighboring scales in a complex system is typical [36,39] and due to the randomly restricted parameter selection scheme employed in RF, correlated and non-correlated parameters can equally contribute to the prediction [45]. Consequently, a previous exclusion of parameters on the basis of their correlation could even lead to a loss of information in the modeling process. Another aspect which has to be taken into account, is that application of principles learned in a multivariate model to a particular prediction does not consider the individual biological variability of the single fetus. With regard to that, the comparison of HRV in the individual fetus with results from a cross-sectional design led to the conclusion that the courses of complexity measurement such as approximate entropy reflect maturation more consistently than traditional time domain measures [46]. Based on the present results a unification and reduction of the parameter set seem substantiated. The choice of one multiscale complexity approach, namely gMSE or MSE SE, since both are highly correlated, in association with skewness and AMP, may lead to promising results. In previous publications, we could show that assessment of fetal maturation based on the fABAS score with a reduced, pre-selected parameter set performed with comparable results [12,13]. However, the aim of the present work was to include all parameters for the assessment in order to consider all relationships between single parameters and to identify important paramaters without pre-selection.

@&#CONCLUSION@&#

Within this work, we presented a novel approach for the assessment of fetal maturation, considering complex, non-linear characteristic curves. Relating to this, RF provides advantageous characteristics and is appropriate for the evaluation of fetal maturation age. Our results support the importance of complexity measurements and their relationships across multiple scales. Those inter-relationships may help to gain a deeper insight into the development of complex coordination mediated by the ANS.

@&#SUMMARY@&#

Prenatal risk factors can permanently change the fetal brain development and cause diseases in later age. However, prenatal functional diagnosis is limited and requires innovative concepts. What is required, is a more sophisticated analysis of the fetal neuro-vegetative (autonomic) control which provides valuable information. Since heart rate is one of the few signals that can be obtained non-invasively from the fetus, HRV analysis is uniquely suited to assess fetal functional autonomic brain development.

In this context, the analysis of complex heart rate patterns by mean of complex multivariate and non-linear analysis, such as by the random forest methodology may substantially improve the evaluation of the fetal autonomic brain developmental. In the present work, such a high dimensional complex and non-linear model approach was applied to fetal heart rate signals for the first time. We found novel complex maturation indices of the normal fetal development that may furthermore extend the understanding of the maturating complex associations across varies time scales and patterns of the autonomic control system.

None Declared

@&#ACKNOWLEDGEMENTS@&#

We thank Franziska Jaenicke, Esther Heinicke, Anja Rudolph, Ulrike Wallwitz, Isabelle Kynass, Franziska Bode, Janine Tegmeyer, Kathrin Kumm, and Liviu Moraru (Team of the Biomagnetic Center/Hans Berger Department of Neurology and the Department of Obstetrics, Jena University Hospital) for their contributions to fMCG recordings and heart beat trigger preprocessing.

@&#REFERENCES@&#

