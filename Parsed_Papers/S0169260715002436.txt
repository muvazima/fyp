@&#MAIN-TITLE@&#Impedance control in a wave-based teleoperator for rehabilitation motor therapies assisted by robots

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           An improved wave-based bilateral teleoperator for robotic rehabilitation therapies is proposed.


                        
                        
                           
                           Master and slave manipulators controlled by impedance provide versatility to telerehabiltation systems.


                        
                        
                           
                           A stable human–robot interaction with suitable force and path tracking is achieved.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Bilateral teleoperator

Impedance control

Rehabilitation therapies

Robot manipulators

Wave variables

@&#ABSTRACT@&#


               
               
                  This paper presents an improved wave-based bilateral teleoperation scheme for rehabilitation therapies assisted by robot manipulators. The main feature of this bilateral teleoperator is that both robot manipulators, master and slave, are controlled by impedance. Thus, a pair of motion-based adaptive impedance controllers are integrated into a wave-based configuration, in order to guarantee a stable human–robot interaction and to compensate the position drift, characteristic of the available schemes of bilateral teleoperation. Moreover, the teleoperator stability, in the presence of time delays in the communication channel, is guaranteed because the wave-variable approach is included to encode the force and velocity signals. It should be noted that the proposed structure enables the implementation of several teleoperator schemes, from passive therapies, without the intervention of a human operator on the master side, to fully active therapies where both manipulators interact with humans in a stable manner. The suitable performance of the proposed teleoperator is verified through some results obtained from the simulation of the passive and active-constrained modes, by considering typical tasks in motor-therapy rehabilitation, where an improved behavior is observed when compared to implementations of the classical wave-based approach.
               
            

@&#INTRODUCTION@&#

The world population over 65 years is increasing rapidly, approximately 70 percent by 2050 and up to 200 percent in industrialized countries, according to studies carried out by the World Health Organization (WHO) [1]. It should be noted that people in this group are highly prone to a stroke. Cerebrovascular accident (CVA) or stroke, traumatic brain and spinal cord injuries are the main causes of disability. CVA patients represent the largest group; e.g. in the United States, 750000 individuals are affected every year [2]. This is why there exists a growing need to care for all these patients and provide the appropriate rehabilitation therapy, in order to enable them to recover their motor skills.

The recovery process of neurological patients is often long and tedious, which is why it is very important to design suitable strategies for motivating and influencing their behavior during therapy sessions. Recent results show that a strong engagement and attention during the learning of new motor skills, or the re-learning of forgotten skills, is crucial for inducing cerebral plasticity after neurological impairment [3]. During motor rehabilitation therapy, a specific set of tasks are performed repetitively, i.e. the patient should perform repetitive exercises of physiological motion patterns with the affected limbs, as frequently and intensely as possible [2]. Classical physiotherapy has shown practical limitations in such tasks, mainly due to extreme exhaustion of therapists during training sessions when guided manually. Therefore, the repetitive nature of the therapy process has led to the use of specialized robotic systems as one of the most promising approaches for improving limb rehabilitation after stroke.

A wealth of robotic devices for rehabilitation have been developed to assist stroke survivors during treatment of motor recovery [4–11]. One of the earliest and pioneer robots for upper limb rehabilitation is MIT-MANUS, which consists of a two-degree-of-freedom system for the movement of shoulder and elbow. It can guide or perturb the upper-limb motion during pre-defined tasks. This assistive device has been tested in several clinical studies, the results have validated that it has no adverse effects and enables improved motor recovery processes [4,12–14]. A key challenge is to develop robotic therapy systems that are affordable and usable in different environments such as rehabilitation centers and home, due to the increasing demand for rehabilitation services [15].

The vast majority of rehabilitation centers and therapists tend to be located in central areas. Therefore, a lot of disabled people living in sparsely populated districts often lack appropriate rehabilitation programs [16]. A possible reduction in attention and duration of therapy would have a negative impact on the patient's condition and his/her recovery process; in fact, the evaluation and treatment must occur as soon as possible, or else the same duration of therapy may produce limited results. Such problems often occur in patients who live in remote rural areas or deprived urban areas, where generally there are no clinics in the vicinity of the patient's home [17]. Under these circumstances, a telerehabilitation system that allows the patient to participate in a rehabilitation program in a remote location becomes a very useful technological tool. Specifically, the robotic-assisted telerehabilitation allows for interactive and innovative therapy tasks that can be implemented from site to site, getting significant benefits for stroke survivors with upper- and lower-limb impairments [15]. Additionally, training at home through telerehabilitation has the potential of saving time and money for both the patient and the provider; moreover, the same therapist can supervise several patients who exercise simultaneously through a multiplexed setting [18].

A teleoperator or teleoperation system consists of a pair of robot manipulators connected in such a way that a human operator, handling the master-manipulator, operates in a remote environment via the slave-manipulator [19]. It is well known that adding force feedback in teleoperators avoids high contact forces, which can achieve low energy consumption, less number of errors and complete tasks in a shorter time [20]. Therefore, force feedback improves the operator's ability to perform complex tasks; in this case, the system is referred to as bilateral teleoperator. The desired goal for the slave robot is to follow the master's behavior in terms of force, position and velocity; and under ideal conditions, this goal is easy to accomplish. An important consideration in the development of remote physical therapies with transparent haptic feeling is that the stability and transparency of the teleoperation system will be harmed by the inherent time delay involved in communications between the therapist (master) and the patient (slave) located in a local clinic or home. This time delay, in the transmission channel between the local and remote environments, can cause instability [21]. Control and stability of bilateral teleoperators with time delay have been tackled by several researchers: a control law based on passivity and scattering theory, that guarantee the stability of a bilateral teleoperator, was proposed in [22]; whereas the wave-variable concept, which is a method based on passivity theory, was presented in [23]. This wave transformation has been implemented in teleoperated systems and satisfactory results have been obtained [24,25]. Recently, an extension of the wave-variable approach, using contraction theory, is proposed in order to study the stability of interacting nonlinear systems in group cooperation [26]. On the other hand, a modification of the wave-variable method with better force tracking and improving the phase delay induced by the latency in the communication network, is presented in [27].

Internet-based teleoperation is becoming very attractive since it allows the increasing of the number of potential applications and an economic installation. However, one of its main drawbacks is the variable time delays in data transmission. Several wave-based approaches have been proposed in order to preserve the stability. In particular, by ensuring the passivity via conservative energy filters [24] or time varying gains [28,29], and handling packet looses and blackouts [30,31]. Recently, an experimental comparison study was presented [32], where the approach proposed by [24] achieved the best performance. However, in all the control schemes evaluated during the study, an increment of tracking and force errors were observed in the presence of variable and large time delays. In this paper, in order to guarantee a stable human–robot interaction, and to improve the force tracking while compensating for the position drift, a motion-based impedance controller is integrated into a wave-based bilateral teleoperator.

Several kinds of telerehabilitation systems have been proposed, e.g. for improved motion tracking [1], for remote therapy with force feedback [20], for remote evaluation and diagnosis [33,34,16], using wave variables in the presence of time delay [35], collaborative telerehabilitation [36], virtual reality integrated systems [17,37,18], and for assistive therapy considering the therapist as an active element [38]. Recently, in order to decrease the influence of external forces, a novel scaling method in bilateral control was proposed in [39], enabling the operator to feel the environmental force more appropriately. Also, in order to improve the haptic sensing in a rehabilitation robot, a robust bilateral control scheme with a Kalman-Filter based state observer was presented [40]. In addition, innovative tools for stability analysis in haptic teleoperation systems have been successfully tested [41,42] and currently represent very attractive methods for use in robotic rehabilitation. Now, in order to create a versatile framework for implementing passive and active exercises in remote rehabilitation therapy, this paper aims to integrate adaptive impedance controllers on both sides of a wave-base bilateral teleoperator; and thus, this scheme addresses three major problems: the presence of time delays in communication by using wave variables, errors in path tracking with an adaptive motion-based controller, and human–robot interaction and force tracking with impedance control. Computer simulation tests corroborate the efficacy of the proposed scheme.

The following mathematical background and concepts represent the theoretical basis on which the stability analysis of the proposed scheme is supported.

The joint-space dynamics of a n-link constrained rigid robot manipulator, interacting with the environment in an m-dimensional task space, can be written as


                        
                           
                              (1)
                              
                                 
                                    
                                       M
                                    
                                 
                                 (
                                 
                                    
                                       
                                          q
                                       
                                    
                                    R
                                 
                                 )
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          ¨
                                       
                                    
                                    R
                                 
                                 +
                                 
                                    
                                       C
                                    
                                 
                                 (
                                 
                                    
                                       
                                          q
                                       
                                    
                                    R
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          ˙
                                       
                                    
                                    R
                                 
                                 )
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          ˙
                                       
                                    
                                    R
                                 
                                 +
                                 
                                    
                                       g
                                    
                                 
                                 (
                                 
                                    
                                       
                                          q
                                       
                                    
                                    R
                                 
                                 )
                                 +
                                 
                                    
                                       F
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          ˙
                                       
                                    
                                    R
                                 
                                 =
                                 
                                    
                                       τ
                                    
                                 
                                 −
                                 
                                    
                                       
                                          J
                                       
                                    
                                    T
                                 
                                 (
                                 
                                    
                                       
                                          q
                                       
                                    
                                    R
                                 
                                 )
                                 
                                    
                                       
                                          f
                                       
                                    
                                    e
                                 
                              
                           
                        where 
                           q
                        
                        
                           R
                        , 
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                    
                                    ˙
                                 
                              
                              R
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                    
                                    ¨
                                 
                              
                              R
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              n
                           
                         represent the joint position, velocity and acceleration vectors, respectively; 
                           
                              
                                 M
                              
                           
                           (
                           
                              
                                 
                                    q
                                 
                              
                              R
                           
                           )
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 n
                                 ×
                                 n
                              
                           
                         is the symmetric positive definite inertia matrix, 
                           
                              
                                 C
                              
                           
                           (
                           
                              
                                 
                                    q
                                 
                              
                              R
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                    
                                    ˙
                                 
                              
                              R
                           
                           )
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 n
                                 ×
                                 n
                              
                           
                         is the Coriolis and centripetal acceleration matrix, 
                           
                              
                                 g
                              
                           
                           (
                           
                              
                                 
                                    q
                                 
                              
                              R
                           
                           )
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              n
                           
                         is the vector of gravitational torques, 
                           
                              
                                 F
                              
                           
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                    
                                    ˙
                                 
                              
                              R
                           
                         is the vector of viscous friction, with 
                           
                              
                                 F
                              
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 n
                                 ×
                                 n
                              
                           
                         being a positive definite constant diagonal matrix whose entries satisfy f
                        
                           i
                        
                        >0, i
                        =1, …, n, and represent the viscous friction coefficients, whereas 
                           
                              
                                 
                                    f
                                 
                              
                              e
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              m
                           
                         denotes the vector of contact forces and 
                           J
                        (
                           q
                        
                        
                           R
                        ) is the manipulator Jacobian matrix [43].

Some well-known properties characterizing the terms of such a dynamical model are recalled here (see for instance [44]).


                        
                           Property 1
                           
                              
                                 M
                              (
                                 q
                              
                              
                                 R
                              ) is a symmetric, positive definite bounded matrix, i.e. μ
                              
                                 m
                              
                              
                                 I
                              
                              ≤
                              
                                 M
                              (
                                 q
                              
                              
                                 R
                              )≤
                              μ
                              
                                 M
                              
                              
                                 I
                              ,
                                 ∀
                                 
                                    
                                       
                                          q
                                       
                                    
                                    R
                                 
                                 ∈
                                 
                                    
                                       
                                          ℝ
                                       
                                    
                                    n
                                 
                              
                              , for some constants 0<
                              μ
                              
                                 m
                              
                              ≤
                              μ
                              
                                 M
                              
                              . Then for any position vector 
                              
                                 q
                              
                              
                                 R
                              
                              , there exists a symmetric, positive definite matrix 
                              
                                 M
                              
                              −1(
                                 q
                              
                              
                                 R
                              ) that represents the inverse of 
                              
                                 M
                              (
                                 q
                              
                              
                                 R
                              ).
                           


                        
                           Property 2
                           
                              For all 
                              
                                 q
                              
                              
                                 R
                              ,
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          ˙
                                       
                                    
                                    R
                                 
                              ,
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          ¨
                                       
                                    
                                    R
                                 
                                 ∈
                                 
                                    
                                       
                                          ℝ
                                       
                                    
                                    n
                                 
                               
                              it holds that
                           


                              
                                 
                                    (2)
                                    
                                       
                                          
                                             M
                                          
                                       
                                       (
                                       
                                          
                                             
                                                q
                                             
                                          
                                          R
                                       
                                       )
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                ¨
                                             
                                          
                                          R
                                       
                                       +
                                       
                                          
                                             C
                                          
                                       
                                       (
                                       
                                          
                                             
                                                q
                                             
                                          
                                          R
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                ˙
                                             
                                          
                                          R
                                       
                                       )
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                ˙
                                             
                                          
                                          R
                                       
                                       +
                                       
                                          
                                             g
                                          
                                       
                                       (
                                       
                                          
                                             
                                                q
                                             
                                          
                                          R
                                       
                                       )
                                       +
                                       
                                          
                                             F
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                ˙
                                             
                                          
                                          R
                                       
                                       =
                                       
                                          
                                             
                                                Y
                                             
                                          
                                          d
                                       
                                       (
                                       
                                          
                                             
                                                q
                                             
                                          
                                          R
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                ˙
                                             
                                          
                                          R
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                ¨
                                             
                                          
                                          R
                                       
                                       )
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          d
                                       
                                    
                                 
                              
                              where 
                              
                                 
                                    
                                       
                                          Y
                                       
                                    
                                    d
                                 
                                 (
                                 
                                    
                                       
                                          q
                                       
                                    
                                    R
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          ˙
                                       
                                    
                                    R
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          ¨
                                       
                                    
                                    R
                                 
                                 )
                                 ∈
                                 
                                    
                                       
                                          ℝ
                                       
                                    
                                    
                                       n
                                       ×
                                       p
                                    
                                 
                               
                              is a regression matrix and the vector 
                              
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    d
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          θ
                                          
                                             d
                                             1
                                          
                                       
                                       ,
                                       
                                          θ
                                          
                                             d
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          θ
                                          dp
                                       
                                       ]
                                    
                                    T
                                 
                                 ∈
                                 
                                    
                                       
                                          ℝ
                                       
                                    
                                    p
                                 
                               
                              depends only on the dynamic parameters of the manipulator. Moreover, if 
                              
                                 q
                              
                              
                                 R
                              ,
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          ˙
                                       
                                    
                                    R
                                 
                              ,
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          ¨
                                       
                                    
                                    R
                                 
                                 ∈
                                 
                                    L
                                    ∞
                                    n
                                 
                               
                              then 
                              
                                 
                                    
                                       
                                          Y
                                       
                                    
                                    d
                                 
                                 (
                                 
                                    
                                       
                                          q
                                       
                                    
                                    R
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          ˙
                                       
                                    
                                    R
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          ¨
                                       
                                    
                                    R
                                 
                                 )
                                 ∈
                                 
                                    L
                                    ∞
                                    
                                       n
                                       ×
                                       p
                                    
                                 
                              
                              .
                           

Note that 
                           J
                        (
                           q
                        
                        
                           R
                        ) has to be a full-rank matrix for all position vectors 
                           q
                        
                        
                           R
                         in order to have a singularity-free workspace for the robot manipulator. Thus, the following assumption turns out to be crucial for the subsequent derivations.


                        
                           Assumption 1
                           rank{
                                 J
                              (
                                 q
                              
                              
                                 R
                              )}=
                              n
                           

The human arm can be modeled by a nonlinear second-order differential equation, under the consideration of a system of rigid bodies with two degrees of freedom in the horizontal plane (Fig. 1a) as [45,46]
                        


                           
                              
                                 (3)
                                 
                                    
                                       
                                          M
                                       
                                    
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       H
                                    
                                    )
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             ¨
                                          
                                       
                                       H
                                    
                                    +
                                    
                                       
                                          c
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             ˙
                                          
                                       
                                       H
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       H
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             τ
                                          
                                       
                                       in
                                    
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             ˙
                                          
                                       
                                       H
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       H
                                    
                                    ,
                                    
                                       
                                          
                                             u
                                          
                                       
                                       H
                                    
                                    )
                                    +
                                    
                                       
                                          
                                             τ
                                          
                                       
                                       ext
                                    
                                 
                              
                           where 
                              q
                           
                           
                              H
                           , 
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                       
                                       ˙
                                    
                                 
                                 H
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                       
                                       ¨
                                    
                                 
                                 H
                              
                            are the vectors of position, velocity and acceleration, respectively; 
                              τ
                           
                           
                              in
                            represents the torques generated by the muscles, 
                              u
                           
                           
                              H
                            is the motor command of central nervous system; 
                              τ
                           
                           
                              ext
                            are external torques; and 
                              M
                           (
                              q
                           
                           
                              H
                           ) and 
                              
                                 
                                    c
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                       
                                       ˙
                                    
                                 
                                 H
                              
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 H
                              
                              )
                            denote the inertia matrix and the vector of Coriolis and centripetal forces, respectively, given by


                           
                              
                                 (4)
                                 
                                    
                                       
                                          M
                                       
                                    
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       H
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                         
                                                            
                                                               H
                                                               1
                                                            
                                                         
                                                      
                                                      +
                                                      2
                                                      
                                                         θ
                                                         
                                                            
                                                               H
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                      cos
                                                      (
                                                      
                                                         q
                                                         
                                                            
                                                               H
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         θ
                                                         
                                                            
                                                               H
                                                               3
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         θ
                                                         
                                                            
                                                               H
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                      cos
                                                      (
                                                      
                                                         q
                                                         
                                                            
                                                               H
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         θ
                                                         
                                                            
                                                               H
                                                               3
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         θ
                                                         
                                                            
                                                               H
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                      cos
                                                      (
                                                      
                                                         q
                                                         
                                                            
                                                               H
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         θ
                                                         
                                                            
                                                               H
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          c
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             ˙
                                          
                                       
                                       H
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       H
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      −
                                                      
                                                         θ
                                                         
                                                            
                                                               H
                                                               2
                                                            
                                                         
                                                      
                                                      [
                                                      
                                                         
                                                            
                                                               q
                                                               ˙
                                                            
                                                         
                                                         
                                                            
                                                               H
                                                               2
                                                            
                                                         
                                                         2
                                                      
                                                      +
                                                      2
                                                      
                                                         
                                                            
                                                               q
                                                               ˙
                                                            
                                                         
                                                         
                                                            
                                                               H
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               q
                                                               ˙
                                                            
                                                         
                                                         
                                                            
                                                               H
                                                               2
                                                            
                                                         
                                                      
                                                      ]
                                                      sin
                                                      (
                                                      
                                                         q
                                                         
                                                            
                                                               H
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         θ
                                                         
                                                            
                                                               H
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               q
                                                               ˙
                                                            
                                                         
                                                         
                                                            
                                                               H
                                                               1
                                                            
                                                         
                                                         2
                                                      
                                                      
                                                      sin
                                                      (
                                                      
                                                         q
                                                         
                                                            
                                                               H
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           with 
                              
                                 q
                                 
                                    
                                       H
                                       1
                                    
                                 
                              
                            and 
                              
                                 q
                                 
                                    
                                       H
                                       2
                                    
                                 
                              
                            representing the shoulder and elbow positions, respectively (
                              
                                 
                                    
                                       q
                                    
                                 
                                 H
                              
                              =
                              
                                 
                                    [
                                    
                                       q
                                       
                                          
                                             H
                                             1
                                          
                                       
                                    
                                    
                                       q
                                       
                                          
                                             H
                                             2
                                          
                                       
                                    
                                    ]
                                 
                                 T
                              
                           ); 
                              
                                 θ
                                 
                                    
                                       H
                                       1
                                    
                                 
                              
                              =
                              
                                 m
                                 
                                    
                                       H
                                       1
                                    
                                 
                              
                              
                                 l
                                 
                                    
                                       H
                                       
                                          c
                                          1
                                       
                                    
                                 
                                 2
                              
                              +
                              
                                 m
                                 
                                    
                                       H
                                       2
                                    
                                 
                              
                              (
                              
                                 l
                                 
                                    
                                       H
                                       1
                                    
                                 
                                 2
                              
                              +
                              
                                 l
                                 
                                    
                                       H
                                       
                                          c
                                          2
                                       
                                    
                                 
                                 2
                              
                              )
                              +
                              
                                 I
                                 
                                    
                                       H
                                       1
                                    
                                 
                              
                              +
                              
                                 I
                                 
                                    
                                       H
                                       2
                                    
                                 
                              
                           , 
                              
                                 θ
                                 
                                    
                                       H
                                       2
                                    
                                 
                              
                              =
                              
                                 m
                                 
                                    
                                       H
                                       2
                                    
                                 
                              
                              
                                 l
                                 
                                    
                                       H
                                       1
                                    
                                 
                              
                              
                                 l
                                 
                                    
                                       H
                                       
                                          c
                                          2
                                       
                                    
                                 
                              
                            and 
                              
                                 θ
                                 
                                    
                                       H
                                       3
                                    
                                 
                              
                              =
                              
                                 m
                                 
                                    
                                       H
                                       2
                                    
                                 
                              
                              
                                 l
                                 
                                    
                                       H
                                       
                                          c
                                          2
                                       
                                    
                                 
                                 2
                              
                              +
                              
                                 I
                                 
                                    
                                       H
                                       2
                                    
                                 
                              
                           , where 
                              
                                 m
                                 
                                    
                                       H
                                       1
                                    
                                 
                              
                            y 
                              
                                 m
                                 
                                    
                                       H
                                       2
                                    
                                 
                              
                            denote the arm and forearm mass, 
                              
                                 l
                                 
                                    
                                       H
                                       
                                          c
                                          1
                                       
                                    
                                 
                              
                            and 
                              
                                 l
                                 
                                    
                                       H
                                       
                                          c
                                          2
                                       
                                    
                                 
                              
                            represent the distance from every joint to the center of mass, 
                              
                                 I
                                 
                                    
                                       H
                                       1
                                    
                                 
                              
                            and 
                              
                                 I
                                 
                                    
                                       H
                                       2
                                    
                                 
                              
                            are the inertia moments, and 
                              
                                 l
                                 
                                    
                                       H
                                       1
                                    
                                 
                              
                            is the arm length.

On the other hand, the viscosity and stiffness properties of the muscle can be represented as
                              
                                 (5)
                                 
                                    −
                                    
                                       
                                          ∂
                                          
                                             
                                                
                                                   τ
                                                
                                             
                                             in
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                   
                                                   ˙
                                                
                                             
                                             H
                                          
                                       
                                    
                                    ≡
                                    
                                       
                                          D
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                         ss
                                                      
                                                   
                                                   
                                                      
                                                         D
                                                         se
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         D
                                                         es
                                                      
                                                   
                                                   
                                                      
                                                         D
                                                         ee
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    −
                                    
                                       
                                          ∂
                                          
                                             
                                                
                                                   τ
                                                
                                             
                                             in
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             H
                                          
                                       
                                    
                                    ≡
                                    
                                       
                                          R
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         R
                                                         ss
                                                      
                                                   
                                                   
                                                      
                                                         R
                                                         se
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         R
                                                         es
                                                      
                                                   
                                                   
                                                      
                                                         R
                                                         ee
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where the subscripts ss and ee denote the effects of monoarticular muscles of shoulder and elbow, respectively; whereas se and es are the effects of biarticular muscles.

Wave variables 
                           u
                         and 
                           
                              v
                           
                         are used in place of the more conventional power variables such as velocity 
                           
                              
                                 
                                    x
                                 
                              
                              ˙
                           
                         and force 
                           f
                        . Niemeyer and Slotine [23] defined right moving waves to be positive and left moving waves to be negative. Therefore, the equations that govern the transmission process are


                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          u
                                       
                                    
                                    s
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       
                                          u
                                       
                                    
                                    m
                                 
                                 (
                                 t
                                 −
                                 
                                    T
                                    r
                                 
                                 )
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          v
                                       
                                    
                                    m
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       
                                          v
                                       
                                    
                                    s
                                 
                                 (
                                 t
                                 −
                                 
                                    T
                                    l
                                 
                                 )
                              
                           
                        where T
                        
                           r
                         represents the time delay from the master to the slave and T
                        
                           l
                         represents the other time delay in the backward direction, subscript m corresponds to the master manipulator while s corresponds to the slave-manipulator. The wave transformations are given by


                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          u
                                       
                                    
                                    m
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       b
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                ˙
                                             
                                          
                                          m
                                       
                                       (
                                       t
                                       )
                                       +
                                       
                                          
                                             
                                                f
                                             
                                          
                                          m
                                       
                                       (
                                       t
                                       )
                                    
                                    
                                       
                                          
                                             2
                                             b
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          v
                                       
                                    
                                    s
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       b
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                ˙
                                             
                                          
                                          s
                                       
                                       (
                                       t
                                       )
                                       −
                                       
                                          
                                             
                                                f
                                             
                                          
                                          s
                                       
                                       (
                                       t
                                       )
                                    
                                    
                                       
                                          
                                             2
                                             b
                                          
                                       
                                    
                                 
                              
                           
                        where the characteristic wave impedance b is a positive constant or a symmetric positive definite matrix and assumes the role of a tuning parameter, trading off speed of motion against level of forces. As presented in [25], the wave-variable approach is stable as the wave energy is temporarily stored while the waves are in transit, making the communication passive.

The impedance-control approach used in this paper corresponds to a generalization of motion control in task-space, by choosing a desired trajectory 
                        x
                     
                     
                        d
                     . It attempts to maintain the following dynamic relationship,


                     
                        
                           (10)
                           
                              
                                 
                                    
                                       x
                                    
                                 
                                 d
                              
                              −
                              
                                 
                                    
                                       x
                                    
                                 
                                 R
                              
                              =
                              F
                              (
                              s
                              )
                              
                                 
                                    
                                       f
                                    
                                 
                                 e
                              
                           
                        
                     where 
                        
                           
                              
                                 x
                              
                           
                           R
                        
                        ∈
                        
                           
                              
                                 ℝ
                              
                           
                           m
                        
                      represents the position of the robot's end-effector in the task space, s denotes the differential operator and


                     
                        
                           (11)
                           
                              F
                              (
                              s
                              )
                              =
                              
                                 
                                    [
                                    
                                       s
                                       2
                                    
                                    
                                       
                                          
                                             M
                                          
                                       
                                       d
                                    
                                    +
                                    s
                                    
                                       
                                          
                                             B
                                          
                                       
                                       d
                                    
                                    +
                                    
                                       
                                          
                                             K
                                          
                                       
                                       d
                                    
                                    ]
                                 
                                 
                                    −
                                    1
                                 
                              
                           
                        
                     represents the operator related to a second-order multi-dimensional filter with 
                        K
                     
                     
                        d
                     , 
                        B
                     
                     
                        d
                     , 
                        
                           
                              
                                 M
                              
                           
                           d
                        
                        ∈
                        
                           
                              
                                 ℝ
                              
                           
                           
                              m
                              ×
                              m
                           
                        
                      being diagonal, positive definite matrices of stiffness, damping and inertia, respectively, i.e. 
                        K
                     
                     
                        d
                     
                     =diag[k
                     
                        d1, …, k
                     
                        dm
                     ], 
                        B
                     
                     
                        d
                     
                     =diag[b
                     
                        d1, …, b
                     
                        dm
                     ] and 
                        M
                     
                     
                        d
                     
                     =diag[m
                     
                        d1, …, m
                     
                        dm
                     ] with k
                     
                        di
                     
                     >0, b
                     
                        di
                     
                     >0 and m
                     
                        di
                     
                     >0 ∀i
                     =1, …, m, such that (see Ref. [47])


                     
                        
                           (12)
                           
                              
                                 b
                                 di
                              
                              ≥
                              
                                 
                                    4
                                    
                                       k
                                       di
                                    
                                    
                                       m
                                       di
                                    
                                 
                              
                           
                        
                     Then 
                        F
                        (
                        s
                        )
                      is a stable, second-order linear filter.

The impedance error 
                        
                           
                              
                                 
                                    ξ
                                 
                              
                              ˜
                           
                        
                        ∈
                        
                           
                              
                                 ℝ
                              
                           
                           m
                        
                      can be defined as [48]:


                     
                        
                           (13)
                           
                              
                                 
                                    
                                       
                                          ξ
                                       
                                    
                                    ˜
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    ˜
                                 
                              
                              −
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    
                                       f
                                       e
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 
                                    x
                                 
                              
                              ˜
                           
                        
                        =
                        
                           
                              
                                 x
                              
                           
                           d
                        
                        −
                        
                           
                              
                                 x
                              
                           
                           R
                        
                      represents the unconstrained tracking error and 
                        
                           
                              
                                 x
                              
                           
                           
                              
                                 f
                                 e
                              
                           
                        
                        =
                        F
                        (
                        s
                        )
                        
                           
                              
                                 f
                              
                           
                           e
                        
                      is the adjustment vector obtained from the filtered external contact forces.

Formally, the aim of our impedance-control approach consists of selecting 
                        τ
                      in such a way that:
                        
                           (14)
                           
                              
                                 lim
                                 
                                    t
                                    →
                                    ∞
                                 
                              
                              
                                 
                                    
                                       
                                          ξ
                                       
                                    
                                    ˜
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    0
                                 
                              
                           
                        
                     
                     
                        
                           (15)
                           
                              
                                 lim
                                 
                                    t
                                    →
                                    ∞
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                          
                                          ˜
                                       
                                    
                                    ˙
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    0
                                 
                              
                              .
                           
                        
                     Note that in the absence of contact, i.e. if 
                        f
                     
                     
                        e
                     
                     ≡
                     0, the objective of impedance control is equivalent to the objective of motion control in task-space. Therefore, this approach to impedance control can be seen as a motion-control approach allowing a tolerance to error in the tracking of the desired trajectory, in the presence of interaction forces.

The adaptive impedance control structure (Fig. 1b) used in this paper is based on the concept of inverse dynamics [49], where the robot torques are selected as


                     
                        
                           (16)
                           
                              
                                 
                                    τ
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                M
                                             
                                          
                                       
                                       ˆ
                                    
                                 
                                 0
                              
                              (
                              
                                 
                                    
                                       q
                                    
                                 
                                 R
                              
                              )
                              
                                 
                                    
                                       J
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    
                                       q
                                    
                                 
                                 R
                              
                              )
                              [
                              
                                 
                                    a
                                 
                              
                              −
                              
                                 
                                    
                                       
                                          J
                                       
                                    
                                    ˙
                                 
                              
                              (
                              
                                 
                                    
                                       q
                                    
                                 
                                 R
                              
                              )
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                       
                                       ˙
                                    
                                 
                                 R
                              
                              ]
                              +
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                       
                                    
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    
                                       q
                                    
                                 
                                 R
                              
                              ,
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                       
                                       ˙
                                    
                                 
                                 R
                              
                              )
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                       
                                       ˙
                                    
                                 
                                 R
                              
                              +
                              
                                 
                                    
                                       
                                          
                                             g
                                          
                                       
                                    
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    
                                       q
                                    
                                 
                                 R
                              
                              )
                              +
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                       
                                    
                                    ˆ
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                       
                                       ˙
                                    
                                 
                                 R
                              
                              +
                              
                                 
                                    
                                       J
                                    
                                 
                                 T
                              
                              (
                              
                                 
                                    
                                       q
                                    
                                 
                                 R
                              
                              )
                              
                                 
                                    
                                       f
                                    
                                 
                                 e
                              
                              +
                              
                                 
                                    
                                       δ
                                    
                                 
                                 M
                              
                           
                        
                     where 
                        
                           
                              
                                 
                                    
                                       
                                          M
                                       
                                    
                                 
                                 ˆ
                              
                           
                           0
                        
                        (
                        
                           
                              
                                 q
                              
                           
                           R
                        
                        )
                      is a symmetric, definite positive matrix that represents the initial estimate of 
                        M
                     (
                        q
                     
                     
                        R
                     ) with 
                        
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                    
                                 
                                 ˆ
                              
                           
                           
                              d
                              0
                           
                        
                      being the initial estimate of 
                        θ
                     
                     
                        d
                     ; 
                        
                           
                              
                                 
                                    
                                       C
                                    
                                 
                              
                              ˆ
                           
                        
                        (
                        
                           
                              
                                 q
                              
                           
                           R
                        
                        ,
                        
                           
                              
                                 
                                    
                                       q
                                    
                                 
                                 ˙
                              
                           
                           R
                        
                        )
                     , 
                        
                           
                              
                                 
                                    
                                       g
                                    
                                 
                              
                              ˆ
                           
                        
                        (
                        
                           
                              
                                 q
                              
                           
                           R
                        
                        )
                      and 
                        
                           
                              
                                 
                                    F
                                 
                              
                           
                           ˆ
                        
                      represent the estimates of 
                        
                           
                              C
                           
                        
                        (
                        
                           
                              
                                 q
                              
                           
                           R
                        
                        ,
                        
                           
                              
                                 
                                    
                                       q
                                    
                                 
                                 ˙
                              
                           
                           R
                        
                        )
                     , 
                        g
                     (
                        q
                     
                     
                        R
                     ) and 
                        F
                     , respectively, with 
                        
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                    
                                 
                                 ˆ
                              
                           
                           d
                        
                      being the current estimated value of 
                        θ
                     
                     
                        d
                     , and coming from the following auxiliary dynamics


                     
                        
                           (17)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                             ˆ
                                          
                                       
                                       ˙
                                    
                                 
                                 d
                              
                              =
                              
                                 
                                    
                                       Γ
                                    
                                 
                                 d
                              
                              
                                 
                                    
                                       Φ
                                    
                                 
                                 d
                                 T
                              
                              (
                              
                                 
                                    
                                       q
                                    
                                 
                                 R
                              
                              ,
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                       
                                       ˙
                                    
                                 
                                 R
                              
                              ,
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                       
                                       ¨
                                    
                                 
                                 R
                              
                              )
                              
                                 
                                    
                                       M
                                    
                                 
                                 d
                              
                              (
                              
                                 
                                    
                                       
                                          ξ
                                       
                                    
                                    ˜
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                          
                                          ˜
                                       
                                    
                                    ˙
                                 
                              
                              )
                           
                        
                     where 
                        
                           
                              
                                 Φ
                              
                           
                           d
                        
                        (
                        
                           
                              
                                 q
                              
                           
                           R
                        
                        ,
                        
                           
                              
                                 
                                    
                                       q
                                    
                                 
                                 ˙
                              
                           
                           R
                        
                        ,
                        
                           
                              
                                 
                                    
                                       q
                                    
                                 
                                 ¨
                              
                           
                           R
                        
                        )
                        =
                        
                           
                              J
                           
                        
                        (
                        
                           
                              
                                 q
                              
                           
                           R
                        
                        )
                      
                     
                        
                           
                              
                                 
                                    
                                       
                                          M
                                       
                                    
                                 
                                 ˆ
                              
                           
                           0
                           
                              −
                              1
                           
                        
                        (
                        
                           
                              
                                 q
                              
                           
                           R
                        
                        )
                        
                           
                              
                                 Y
                              
                           
                           d
                        
                        (
                        
                           
                              
                                 q
                              
                           
                           R
                        
                        ,
                        
                           
                              
                                 
                                    
                                       q
                                    
                                 
                                 ˙
                              
                           
                           R
                        
                        ,
                        
                           
                              
                                 
                                    
                                       q
                                    
                                 
                                 ¨
                              
                           
                           R
                        
                        )
                     , and 
                        
                           
                              
                                 Γ
                              
                           
                           d
                        
                        ∈
                        
                           
                              
                                 ℝ
                              
                           
                           
                              p
                              ×
                              p
                           
                        
                      is a diagonal, positive definite matrix of tuning parameters. Meanwhile,


                     
                        
                           (18)
                           
                              
                                 
                                    a
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                       ¨
                                    
                                 
                                 d
                              
                              −
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                       ¨
                                    
                                 
                                 
                                    
                                       f
                                       e
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       M
                                    
                                 
                                 d
                                 
                                    −
                                    1
                                 
                              
                              [
                              
                                 
                                    
                                       K
                                    
                                 
                                 P
                              
                              
                                 
                                    
                                       
                                          ξ
                                       
                                    
                                    ˜
                                 
                              
                              +
                              
                                 
                                    
                                       K
                                    
                                 
                                 D
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                          
                                          ˜
                                       
                                    
                                    ˙
                                 
                              
                              ]
                           
                        
                     where 
                        
                           
                              
                                 K
                              
                           
                           P
                        
                        ∈
                        
                           
                              
                                 ℝ
                              
                           
                           
                              m
                              ×
                              m
                           
                        
                      and 
                        
                           
                              
                                 K
                              
                           
                           D
                        
                        ∈
                        
                           
                              
                                 ℝ
                              
                           
                           
                              m
                              ×
                              m
                           
                        
                      are diagonal, definite positive matrices of proportional and derivative gains, respectively, i.e. 
                        K
                     
                     
                        P
                     
                     =diag[k
                     
                        P1, …, k
                     
                        Pm
                     ] with k
                     
                        Di
                     
                     >0 and 
                        K
                     
                     
                        D
                     
                     =diag[k
                     
                        D1, …, k
                     
                        Dm
                     ] with k
                     
                        Di
                     
                     >0 ∀i
                     =1, …, m, such that


                     
                        
                           (19)
                           
                              
                                 min
                                 i
                              
                              {
                              
                                 k
                                 Di
                              
                              }
                              >
                              
                                 max
                                 i
                              
                              {
                              
                                 m
                                 di
                              
                              }
                           
                        
                     Finally, as in [49],


                     
                        
                           (20)
                           
                              
                                 
                                    
                                       δ
                                    
                                 
                                 M
                              
                              =
                              [
                              
                                 
                                    
                                       
                                          
                                             M
                                          
                                       
                                    
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    
                                       q
                                    
                                 
                                 R
                              
                              )
                              −
                              
                                 
                                    
                                       
                                          
                                             
                                                M
                                             
                                          
                                       
                                       ˆ
                                    
                                 
                                 0
                              
                              (
                              
                                 
                                    
                                       q
                                    
                                 
                                 R
                              
                              )
                              ]
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                       
                                       ¨
                                    
                                 
                                 R
                              
                           
                        
                     is defined in order to compensate the differences between 
                        
                           
                              
                                 
                                    
                                       
                                          M
                                       
                                    
                                 
                                 ˆ
                              
                           
                           0
                        
                        (
                        
                           
                              
                                 q
                              
                           
                           R
                        
                        )
                      and 
                        M
                     (
                        q
                     
                     
                        R
                     ).

In order to simplify the notation, henceforth, the arguments of some functions will be omitted.

Observe that by combining Eqs. (1), (16), (18) and (20), the following dynamical system is obtained


                        
                           
                              (21)
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                M
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                   
                                                
                                                ˆ
                                             
                                          
                                          )
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                   
                                                   ¨
                                                
                                             
                                             R
                                          
                                          +
                                          (
                                          
                                             
                                                C
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                   
                                                
                                                ˆ
                                             
                                          
                                          )
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                   
                                                   ˙
                                                
                                             
                                             R
                                          
                                          +
                                          (
                                          
                                             
                                                g
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         g
                                                      
                                                   
                                                
                                                ˆ
                                             
                                          
                                          )
                                          +
                                          (
                                          
                                             
                                                F
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         F
                                                      
                                                   
                                                
                                                ˆ
                                             
                                          
                                          )
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                   
                                                   ˙
                                                
                                             
                                             R
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   ˆ
                                                
                                             
                                             0
                                          
                                          
                                             
                                                
                                                   J
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   ¨
                                                
                                             
                                             d
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   ¨
                                                
                                             
                                             
                                                
                                                   f
                                                   e
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             P
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             D
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ˙
                                             
                                          
                                          )
                                          −
                                          
                                             
                                                
                                                   
                                                      J
                                                   
                                                
                                                ˙
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                   
                                                   ˙
                                                
                                             
                                             R
                                          
                                          ]
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   ˆ
                                                
                                             
                                             0
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                   
                                                   ¨
                                                
                                             
                                             R
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Y
                                                
                                             
                                             d
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             d
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   ˆ
                                                
                                             
                                             0
                                          
                                          
                                             
                                                
                                                   J
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   ¨
                                                
                                             
                                             d
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   ¨
                                                
                                             
                                             
                                                
                                                   f
                                                   e
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             P
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             D
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ˙
                                             
                                          
                                          )
                                          −
                                          
                                             
                                                
                                                   
                                                      J
                                                   
                                                
                                                ˙
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                   
                                                   ˙
                                                
                                             
                                             R
                                          
                                          −
                                          
                                             
                                                J
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                   
                                                   ¨
                                                
                                             
                                             R
                                          
                                          ]
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Φ
                                                
                                             
                                             d
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             d
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ¨
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             P
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             D
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ˙
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˜
                                 
                              
                              d
                           
                           =
                           
                              
                                 
                                    
                                       θ
                                    
                                 
                              
                              d
                           
                           −
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˆ
                                 
                              
                              d
                           
                        . Then, the closed-loop dynamics take the following form


                        
                           
                              (22a)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                             
                                             ˜
                                          
                                       
                                       ¨
                                    
                                 
                                 =
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                    d
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                          
                                          ˜
                                       
                                    
                                    d
                                 
                                 −
                                 
                                    
                                       
                                          M
                                       
                                    
                                    d
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       
                                          K
                                       
                                    
                                    P
                                 
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 +
                                 
                                    
                                       
                                          K
                                       
                                    
                                    D
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                             
                                             ˜
                                          
                                       
                                       ˙
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (22b)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                
                                                ˜
                                             
                                          
                                          ˙
                                       
                                    
                                    d
                                 
                                 =
                                 −
                                 
                                    
                                       
                                          Γ
                                       
                                    
                                    d
                                 
                                 
                                    
                                       
                                          Φ
                                       
                                    
                                    d
                                    T
                                 
                                 
                                    
                                       
                                          M
                                       
                                    
                                    d
                                 
                                 (
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                             
                                             ˜
                                          
                                       
                                       ˙
                                    
                                 
                                 )
                              
                           
                        
                     

Note that, from Eqs. (22) under stationary conditions, i.e. by considering 
                           
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 ¨
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 ˙
                              
                           
                           =
                           
                              
                                 0
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                          
                                          ˜
                                       
                                    
                                    ˙
                                 
                              
                              d
                           
                           =
                           
                              
                                 0
                              
                           
                        , we have that


                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Φ
                                                
                                             
                                             d
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             d
                                          
                                          =
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             P
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Φ
                                                
                                             
                                             d
                                             T
                                          
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                          =
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and by combining these conditions


                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                          
                                          
                                             
                                                
                                                   Φ
                                                
                                             
                                             d
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             d
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                          
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             P
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                          
                                       
                                       
                                          ⇒
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             d
                                             T
                                          
                                          
                                             
                                                
                                                   Φ
                                                
                                             
                                             d
                                             T
                                          
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             P
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          ⇒
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             P
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                          =
                                          0
                                       
                                    
                                 
                              
                           
                        Then, by considering Assumption 1, 
                           
                              
                                 
                                    
                                       ξ
                                    
                                 
                                 ˜
                              
                           
                           =
                           
                              
                                 0
                              
                           
                         is an equilibrium condition, while for the estimation error 
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˜
                                 
                              
                              d
                           
                         turns out to be defined by the solutions of the equation 
                           
                              
                                 
                                    Φ
                                 
                              
                              d
                           
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˜
                                 
                              
                              d
                           
                           =
                           
                              
                                 0
                              
                           
                        , and consequently 
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˜
                                 
                              
                              d
                           
                           ∈
                           ker
                           (
                           
                              
                                 
                                    Φ
                                 
                              
                              d
                           
                           )
                        .

Now, in order to carry out the stability analysis, the following scalar function is defined


                        
                           
                              (23)
                              
                                 V
                                 (
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                             
                                             ˜
                                          
                                       
                                       ˙
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                             
                                          
                                          ˜
                                       
                                    
                                    d
                                 
                                 )
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ɛ
                                                
                                             
                                             T
                                          
                                          
                                             
                                                X
                                             
                                          
                                          
                                             
                                                ɛ
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             d
                                             T
                                          
                                          
                                             
                                                
                                                   Γ
                                                
                                             
                                             d
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             d
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             P
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 ɛ
                              
                           
                           =
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                          
                                          ˜
                                       
                                    
                                    T
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                          ˙
                                       
                                    
                                    T
                                 
                                 ]
                              
                              T
                           
                         and


                        
                           
                              
                                 
                                    
                                       X
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            K
                                                         
                                                      
                                                      D
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                      
                                                      d
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                      
                                                      d
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                      
                                                      d
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Observe that by using Schur complement [50]
                     


                        
                           
                              
                                 
                                    
                                       X
                                    
                                 
                                 >
                                 0
                                 
                                 ⇔
                                 
                                 
                                    
                                       
                                          M
                                       
                                    
                                    d
                                 
                                 >
                                 0
                                    
                                    
                                 and
                                    
                                    
                                 
                                    
                                       
                                          K
                                       
                                    
                                    D
                                 
                                 −
                                 
                                    
                                       
                                          M
                                       
                                    
                                    d
                                 
                                 
                                    
                                       
                                          M
                                       
                                    
                                    d
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          M
                                       
                                    
                                    d
                                 
                                 >
                                 0
                              
                           
                        and the positivity of 
                           X
                         is equivalent to the positivity of 
                           M
                        
                        
                           d
                         and 
                           K
                        
                        
                           D
                        
                        −
                        
                           M
                        
                        
                           d
                        . Since 
                           M
                        
                        
                           d
                         and 
                           K
                        
                        
                           D
                         are diagonal, positive definite matrices such that inequality (19) is satisfied, then 
                           X
                        
                        >0. From the quadratic form of the remaining terms, 
                           V
                           (
                           
                              
                                 
                                    
                                       ξ
                                    
                                 
                                 ˜
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 ˙
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˜
                                 
                              
                              d
                           
                           )
                         is concluded to be positive definite. Additionally, notice that 
                           ɛ
                        
                        
                           T
                        
                        
                           Xɛ
                        →∞ as 
                           ∥
                           
                              
                                 
                                    
                                       ξ
                                    
                                 
                                 ˜
                              
                           
                           ∥
                           →
                           ∞
                        , 
                           ɛ
                        
                        
                           T
                        
                        
                           Xɛ
                        →∞ as 
                           ∥
                           
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 ˙
                              
                           
                           ∥
                           →
                           ∞
                        , 
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˜
                                 
                              
                              d
                              T
                           
                           
                              
                                 
                                    Γ
                                 
                              
                              d
                              
                                 −
                                 1
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˜
                                 
                              
                              d
                           
                           →
                           ∞
                         as 
                           ∥
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˜
                                 
                              
                              d
                           
                           ∥
                           →
                           ∞
                         and 
                           
                              
                                 
                                    
                                       
                                          ξ
                                       
                                    
                                    ˜
                                 
                              
                              T
                           
                           
                              
                                 
                                    K
                                 
                              
                              P
                           
                           
                              
                                 
                                    
                                       ξ
                                    
                                 
                                 ˜
                              
                           
                           →
                           ∞
                         as 
                           ∥
                           
                              
                                 
                                    
                                       ξ
                                    
                                 
                                 ˜
                              
                           
                           ∥
                           →
                           ∞
                        , which prove that 
                           V
                           (
                           
                              
                                 
                                    
                                       ξ
                                    
                                 
                                 ˜
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 ˙
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˜
                                 
                              
                              d
                           
                           )
                         is radially unbounded [51].

Thereafter, the derivative of 
                           V
                           (
                           
                              
                                 
                                    
                                       ξ
                                    
                                 
                                 ˜
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 ˙
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˜
                                 
                              
                              d
                           
                           )
                         along the system trajectories is given by


                        
                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             
                                                V
                                                ˙
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ˙
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             d
                                          
                                          )
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             D
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ˙
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ¨
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                         
                                                         ˜
                                                      
                                                   
                                                   ˙
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ˙
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                         
                                                         ˜
                                                      
                                                   
                                                   ˙
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ¨
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             d
                                             T
                                          
                                          
                                             
                                                
                                                   Γ
                                                
                                             
                                             d
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  θ
                                                               
                                                            
                                                         
                                                         ˜
                                                      
                                                   
                                                   ˙
                                                
                                             
                                             d
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             P
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ˙
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             D
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ˙
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ξ
                                                               
                                                            
                                                            ˜
                                                         
                                                      
                                                      ˙
                                                   
                                                
                                                )
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                          
                                          [
                                          
                                             
                                                
                                                   Φ
                                                
                                             
                                             d
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             d
                                          
                                          −
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             P
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             D
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ˙
                                             
                                          
                                          )
                                          ]
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                         
                                                         ˜
                                                      
                                                   
                                                   ˙
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ˙
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             d
                                             T
                                          
                                          
                                             
                                                
                                                   Φ
                                                
                                             
                                             d
                                             T
                                          
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ˙
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             P
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ˙
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             P
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                         
                                                         ˜
                                                      
                                                   
                                                   ˙
                                                
                                             
                                             T
                                          
                                          (
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             D
                                          
                                          −
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                          
                                          )
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ˙
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          ξ
                                       
                                    
                                    ˜
                                 
                              
                              ¨
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          ˜
                                       
                                    
                                    ˙
                                 
                              
                              d
                           
                         have been replaced by the expressions (22a) and (22b) from the closed-loop dynamics. Therefore, under Assumption 1 and the inequality (19), 
                           
                              
                                 V
                                 ˙
                              
                           
                           (
                           
                              
                                 
                                    
                                       ξ
                                    
                                 
                                 ˜
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 ˙
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˜
                                 
                              
                              d
                           
                           )
                           ≤
                           0
                         
                        
                           ∀
                           (
                           
                              
                                 
                                    
                                       ξ
                                    
                                 
                                 ˜
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 ˙
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˜
                                 
                              
                              d
                           
                           )
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              m
                           
                           ×
                           
                              
                                 
                                    ℝ
                                 
                              
                              m
                           
                           ×
                           
                              
                                 
                                    ℝ
                                 
                              
                              p
                           
                        , with 
                           
                              
                                 V
                                 ˙
                              
                           
                           (
                           
                              
                                 
                                    
                                       ξ
                                    
                                 
                                 ˜
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 ˙
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˜
                                 
                              
                              d
                           
                           )
                           =
                           0
                         ⇔ 
                           (
                           
                              
                                 
                                    
                                       ξ
                                    
                                 
                                 ˜
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 ˙
                              
                           
                           )
                           =
                           (
                           
                              
                                 0
                              
                           
                           ,
                           
                              
                                 0
                              
                           
                           )
                        .

Now, the second derivative of 
                           V
                           (
                           
                              
                                 
                                    
                                       ξ
                                    
                                 
                                 ˜
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 ˙
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˜
                                 
                              
                              d
                           
                           )
                         along the system trajectories is given by


                        
                           
                              (25)
                              
                                 
                                    
                                       
                                          
                                             V
                                             ¨
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ˙
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             d
                                          
                                          )
                                       
                                       
                                          =
                                       
                                       
                                          −
                                          2
                                          
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             P
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ˙
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                         
                                                         ˜
                                                      
                                                   
                                                   ˙
                                                
                                             
                                             T
                                          
                                          (
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             D
                                          
                                          −
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                          
                                          )
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ¨
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          −
                                          2
                                          
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             P
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ˙
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                         
                                                         ˜
                                                      
                                                   
                                                   ˙
                                                
                                             
                                             T
                                          
                                          (
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             D
                                          
                                          −
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                          
                                          )
                                          [
                                          
                                             
                                                
                                                   Φ
                                                
                                             
                                             d
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                      
                                                   
                                                   ˜
                                                
                                             
                                             d
                                          
                                          −
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             d
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             P
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   K
                                                
                                             
                                             D
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                ˙
                                             
                                          
                                          )
                                          ]
                                       
                                    
                                 
                              
                           
                        Assume that 
                           
                              
                                 
                                    x
                                 
                              
                              d
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    ˙
                                 
                              
                              d
                           
                           ,
                           
                              
                                 
                                    
                                       x
                                    
                                 
                                 ¨
                              
                              d
                           
                           ,
                           
                              
                                 
                                    f
                                 
                              
                              e
                           
                           ∈
                           
                              L
                              ∞
                              m
                           
                        . Then, from Eq. (24) 
                        
                           
                              
                                 V
                                 ˙
                              
                           
                           (
                           
                              
                                 
                                    
                                       ξ
                                    
                                 
                                 ˜
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 ˙
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˜
                                 
                              
                              d
                           
                           )
                           ≤
                           0
                         ⇒ 
                           
                              
                                 
                                    ξ
                                 
                              
                              ˜
                           
                        , 
                           
                              
                                 
                                    
                                       
                                          ξ
                                       
                                    
                                    ˜
                                 
                              
                              ˙
                           
                         ∈ 
                           
                              L
                              2
                              m
                           
                           ∩
                           
                              L
                              ∞
                              m
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˜
                                 
                              
                              d
                           
                           ∈
                           
                              L
                              ∞
                              p
                           
                        . Further, from Eq. (13) we have that 
                           
                              
                                 
                                    
                                       ξ
                                    
                                 
                                 ˜
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 ˙
                              
                           
                           ∈
                           
                              L
                              ∞
                              m
                           
                         ⇒ 
                           
                              
                                 
                                    x
                                 
                              
                              ˜
                           
                        , 
                           x
                        
                        
                           fe
                        , 
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    ˜
                                 
                              
                              ˙
                           
                        , 
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    ˙
                                 
                              
                              fe
                           
                         
                        
                           ∈
                           
                              L
                              ∞
                              m
                           
                         and 
                           
                              
                                 
                                    x
                                 
                              
                              R
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    ˙
                                 
                              
                              R
                           
                           ∈
                           
                              L
                              ∞
                              m
                           
                        . Also, from the corresponding kinematic relationships we have that 
                           
                              
                                 
                                    x
                                 
                              
                              R
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    ˙
                                 
                              
                              R
                           
                           ∈
                           
                              L
                              ∞
                              m
                           
                         ⇒ 
                           
                              
                                 
                                    q
                                 
                              
                              R
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                    
                                    ˙
                                 
                              
                              R
                           
                           ∈
                           
                              L
                              ∞
                              n
                           
                         and under Assumption 1, 
                           J
                        (
                           q
                        
                        
                           R
                        ) is a bounded nonsingular matrix. Since 
                           
                              
                                 
                                    
                                       
                                          
                                             M
                                          
                                       
                                    
                                    ˆ
                                 
                              
                              0
                              
                                 −
                                 1
                              
                           
                         is bounded according to Property 1 and from the previous results and Property 2, 
                           Φ
                        
                        
                           d
                         is a bounded matrix. Therefore, with bounded gain matrices 
                           K
                        
                        
                           P
                        , 
                           K
                        
                        
                           D
                         and 
                           M
                        
                        
                           d
                        , 
                           
                              V
                              ¨
                           
                           (
                           
                              
                                 
                                    
                                       ξ
                                    
                                 
                                 ˜
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 ˙
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                       
                                    
                                    ˜
                                 
                              
                              d
                           
                           )
                           ∈
                           
                              L
                              ∞
                           
                         and according to Barbalat's Lemma [52], 
                           
                              
                                 
                                    
                                       ξ
                                    
                                 
                                 ˜
                              
                           
                           →
                           
                              
                                 0
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 ˙
                              
                           
                           →
                           
                              
                                 0
                              
                           
                         as t→∞, which completes the proof.

Traditionally, the bilateral teleoperators include classical proportional-derivative (PD) or proportional-integral (PI) controllers, which are suitable for unconstrained robot regulation. However, they present many limitations for interaction tasks because the contact forces are not properly regulated. In order to improve the performance in bilateral teleoperation for human–robot interaction and compensate the position drift, the impedance-control algorithm (16) is integrated in a wave-based teleoperator. The system also includes the wave-variable transformation in order to guarantee the stability in the communications in the presence of time delay.

In this bilateral teleoperation scheme, the master and slave behaviors are regulated by using the impedance controller. A path-planner can be used to determine the master desired motion (
                        x
                     
                     
                        md
                     , 
                        
                           
                              
                                 
                                    
                                       x
                                    
                                 
                                 ˙
                              
                           
                           md
                        
                     ) and the human-operator force 
                        f
                     
                     
                        h
                      can modify it at any time, thus the impedance controller (16) regulate the trajectory 
                        x
                     
                     
                        m
                      and velocity 
                        
                           
                              
                                 
                                    
                                       x
                                    
                                 
                                 ˙
                              
                           
                           m
                        
                      to be followed by the master-manipulator. Then, the position and velocity are encoded using the wave transformation and sent to the slave-manipulator using the communication channel. On the other side, the desired position 
                        x
                     
                     
                        sd
                      and velocity 
                        
                           
                              
                                 
                                    
                                       x
                                    
                                 
                                 ˙
                              
                           
                           sd
                        
                      for the slave-manipulator are obtained from the wave transformation. The desired position and velocity are processed by the impedance controller (16) in order to generate a suitable slave's motion, even when the slave-manipulator interacts with the environment and contact forces 
                        f
                     
                     
                        e
                      are generated (in typical wave-based bilateral teleoperators, the force feedback is generated by the controller; when the slave robot interacts with its environment, the tracking error 
                        
                           
                              
                                 x
                              
                           
                           ˜
                        
                      is increased and the contact force can be perceived from the master's side thanks to the corresponding increment of the feedback force generated by the controller. In this case, an impedance controller is used into a wave-based configuration, and because the impedance controller regulates the robot–environment interaction, the impedance error 
                        
                           
                              
                                 ξ
                              
                           
                           ˜
                        
                      tends to zero and does not have a significant increase to generate the required change on the force feedback). The impedance-controller force is given by


                     
                        
                           (26)
                           
                              
                                 
                                    
                                       f
                                    
                                 
                                 c
                              
                              =
                              
                                 
                                    
                                       K
                                    
                                 
                                 P
                              
                              
                                 
                                    
                                       
                                          ξ
                                       
                                    
                                    ˜
                                 
                              
                              +
                              
                                 
                                    
                                       K
                                    
                                 
                                 D
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                          
                                          ˜
                                       
                                    
                                    ˙
                                 
                              
                              .
                           
                        
                     This force is used both with the purpose of regulating the contact forces as well as obtaining a compliant slave's behavior. However, 
                        f
                     
                     
                        c
                      cannot be used as feedback force because the operator could not perceive the interaction. Therefore, in order to obtain the feedback force and for the operator to perceive the contact forces, we consider only the tracking errors, i.e. 
                        f
                     
                     
                        e
                     
                     ≡
                     0, then


                     
                        
                           (27)
                           
                              
                                 
                                    
                                       f
                                    
                                 
                                 s
                              
                              =
                              
                                 
                                    
                                       K
                                    
                                 
                                 P
                              
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    ˜
                                 
                              
                              +
                              
                                 
                                    
                                       K
                                    
                                 
                                 D
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                          
                                          ˜
                                       
                                    
                                    ˙
                                 
                              
                              .
                           
                        
                     Because 
                        
                           
                              
                                 
                                    x
                                 
                              
                              ˜
                           
                        
                        ≠
                        
                           
                              0
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    ˜
                                 
                              
                              ˙
                           
                        
                        ≠
                        
                           
                              0
                           
                        
                      when the contact occurs, the operator can perceive the interaction. Also, this force is encoded using wave variables and on the master's side the force 
                        f
                     
                     
                        m
                      is generated in order to provide the remote information needed to improve the task performance.

The stability of the bilateral teleoperator is guaranteed since:
                        
                           1.
                           The human operator (therapist) and the user (patient) can be modeled as passive systems.

The forces generated by the operator and the user are assumed bounded.

The communication channel is passive according to the wave transformation.

The human–robot interaction is stable by using the impedance controller (16).

Both robots, master and slave, are controlled by the adaptive scheme (16) and the passivity in both cases is guaranteed if


                     
                        
                           (28)
                           
                              
                                 
                                    V
                                    ˙
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          ξ
                                       
                                    
                                    ˜
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                          
                                          ˜
                                       
                                    
                                    ˙
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          
                                             
                                                θ
                                             
                                          
                                       
                                       ˜
                                    
                                 
                                 d
                              
                              )
                              ≤
                              −
                              α
                              V
                              (
                              
                                 
                                    
                                       
                                          ξ
                                       
                                    
                                    ˜
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                          
                                          ˜
                                       
                                    
                                    ˙
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          
                                             
                                                θ
                                             
                                          
                                       
                                       ˜
                                    
                                 
                                 d
                              
                              )
                           
                        
                     for any α
                     >0 [43]. Then,


                     
                        
                           (29)
                           
                              −
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 T
                              
                              
                                 
                                    
                                       K
                                    
                                 
                                 P
                              
                              
                                 
                                    
                                       
                                          ξ
                                       
                                    
                                    ˜
                                 
                              
                              −
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                             
                                             ˜
                                          
                                       
                                       ˙
                                    
                                 
                                 T
                              
                              (
                              
                                 
                                    
                                       K
                                    
                                 
                                 D
                              
                              −
                              
                                 
                                    
                                       M
                                    
                                 
                                 d
                              
                              )
                              
                                 
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                          
                                          ˜
                                       
                                    
                                    ˙
                                 
                              
                                 
                              ≤
                                 
                              −
                              
                                 α
                                 2
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ɛ
                                             
                                          
                                          T
                                       
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             ɛ
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                
                                                ˜
                                             
                                          
                                          d
                                          T
                                       
                                       
                                          
                                             
                                                Γ
                                             
                                          
                                          d
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                
                                                ˜
                                             
                                          
                                          d
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                          T
                                       
                                       
                                          
                                             
                                                K
                                             
                                          
                                          P
                                       
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                             
                                             ˜
                                          
                                       
                                    
                                 
                              
                           
                        
                     and after some algebraic procedures
                        
                           (30)
                           
                              (
                              1
                              −
                              α
                              )
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       ˜
                                    
                                 
                                 T
                              
                              
                                 
                                    
                                       K
                                    
                                 
                                 P
                              
                              
                                 
                                    
                                       
                                          ξ
                                       
                                    
                                    ˜
                                 
                              
                              −
                              
                                 α
                                 2
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                θ
                                             
                                          
                                       
                                       ˜
                                    
                                 
                                 d
                                 T
                              
                              
                                 
                                    
                                       Γ
                                    
                                 
                                 d
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                θ
                                             
                                          
                                       
                                       ˜
                                    
                                 
                                 d
                              
                              +
                              
                                 
                                    
                                       ɛ
                                    
                                 
                                 T
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                −
                                                
                                                   α
                                                   2
                                                
                                                
                                                   
                                                      
                                                         K
                                                      
                                                   
                                                   D
                                                
                                             
                                             
                                                −
                                                
                                                   α
                                                   2
                                                
                                                
                                                   
                                                      
                                                         M
                                                      
                                                   
                                                   d
                                                
                                             
                                          
                                          
                                             
                                                −
                                                
                                                   α
                                                   2
                                                
                                                
                                                   
                                                      
                                                         M
                                                      
                                                   
                                                   d
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                   
                                                   D
                                                
                                                −
                                                
                                                   
                                                      
                                                         1
                                                         +
                                                         
                                                            α
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         M
                                                      
                                                   
                                                   d
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    ɛ
                                 
                              
                                 
                              ≥
                                 
                              0
                           
                        
                     From the first two terms of (30) it is obtained that


                     
                        
                           (31)
                           
                              
                                 
                                    
                                       (
                                       1
                                       −
                                       α
                                       )
                                       
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                
                                                ˜
                                             
                                          
                                          T
                                       
                                       
                                          
                                             
                                                K
                                             
                                          
                                          P
                                       
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                             
                                             ˜
                                          
                                       
                                       ≥
                                       
                                          α
                                          2
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                
                                                ˜
                                             
                                          
                                          d
                                          T
                                       
                                       
                                          
                                             
                                                Γ
                                             
                                          
                                          d
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                
                                                ˜
                                             
                                          
                                          d
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             1
                                             −
                                             α
                                          
                                          α
                                       
                                       ≥
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                d
                                                T
                                             
                                             
                                                
                                                   
                                                      Γ
                                                   
                                                
                                                d
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               θ
                                                            
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                d
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                      
                                                      ˜
                                                   
                                                
                                                T
                                             
                                             
                                                
                                                   
                                                      K
                                                   
                                                
                                                P
                                             
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                   
                                                   ˜
                                                
                                             
                                          
                                       
                                       >
                                       0
                                       ⇒
                                       α
                                       ≥
                                       1
                                    
                                 
                              
                           
                        
                     and from the remaining term


                     
                        
                           (32)
                           
                              
                                 
                                    
                                       
                                          α
                                          2
                                       
                                       
                                          
                                             
                                                −
                                                
                                                   
                                                      
                                                         K
                                                      
                                                   
                                                   D
                                                
                                                
                                                   
                                                      
                                                         K
                                                      
                                                   
                                                   D
                                                
                                                +
                                                
                                                   
                                                      
                                                         1
                                                         +
                                                         
                                                            α
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         K
                                                      
                                                   
                                                   D
                                                
                                                
                                                   
                                                      
                                                         M
                                                      
                                                   
                                                   d
                                                
                                                −
                                                
                                                   α
                                                   2
                                                
                                                
                                                   
                                                      
                                                         M
                                                      
                                                   
                                                   d
                                                
                                                
                                                   
                                                      
                                                         M
                                                      
                                                   
                                                   d
                                                
                                             
                                          
                                       
                                       ≥
                                       0
                                    
                                 
                                 
                                    
                                       
                                          α
                                          2
                                       
                                       
                                          
                                             
                                                M
                                             
                                          
                                          d
                                       
                                       −
                                       
                                          
                                             
                                                K
                                             
                                          
                                          D
                                       
                                       ≥
                                       0
                                    
                                 
                                 
                                    
                                       α
                                       
                                          
                                             
                                                K
                                             
                                          
                                          D
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                M
                                             
                                          
                                          d
                                       
                                       ≥
                                       2
                                       
                                          
                                             I
                                          
                                       
                                    
                                 
                                 
                                    
                                       α
                                       ≥
                                       
                                          2
                                          
                                             ρ
                                             (
                                             
                                                
                                                   
                                                      K
                                                   
                                                
                                                D
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      M
                                                   
                                                
                                                d
                                             
                                             )
                                          
                                       
                                       >
                                       0
                                    
                                 
                              
                           
                        
                     where 
                        ρ
                        (
                        
                           
                              
                                 K
                              
                           
                           D
                           
                              −
                              1
                           
                        
                        
                           
                              
                                 M
                              
                           
                           d
                        
                        )
                      is the spectral radius of 
                        
                           
                              
                                 K
                              
                           
                           D
                           
                              −
                              1
                           
                        
                        
                           
                              
                                 M
                              
                           
                           d
                        
                     , which has a positive value lower than one considering the condition (19). Therefore, the passivity of the robots controlled by impedance is guaranteed.

The master and slave robots, both passive systems controlled by impedance, interact with each other through the communication channel. In bilateral teleoperation, the input power P
                     
                        in
                      is given by


                     
                        
                           (33)
                           
                              
                                 P
                                 in
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                       ˙
                                    
                                 
                                 T
                              
                              
                                 
                                    f
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 x
                              
                           
                           ˙
                        
                      represents the input vector and 
                        f
                      is the output vector of the communication system. In order to verify passivity, the overall power input P
                     
                        in
                      entering the communications


                     
                        
                           (34)
                           
                              
                                 P
                                 in
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                       ˙
                                    
                                 
                                 m
                                 T
                              
                              
                                 
                                    
                                       f
                                    
                                 
                                 m
                              
                              −
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                       ˙
                                    
                                 
                                 s
                                 T
                              
                              
                                 
                                    
                                       f
                                    
                                 
                                 s
                              
                           
                        
                     is considered. Substituting the wave transformation equations, the power input is computed as:


                     
                        
                           (35)
                           
                              
                                 P
                                 in
                              
                              =
                              
                                 1
                                 2
                              
                              
                                 
                                    
                                       u
                                    
                                 
                                 m
                                 T
                              
                              
                                 
                                    
                                       u
                                    
                                 
                                 m
                              
                              −
                              
                                 1
                                 2
                              
                              
                                 
                                    
                                       v
                                    
                                 
                                 m
                                 T
                              
                              
                                 
                                    
                                       v
                                    
                                 
                                 m
                              
                              −
                              
                                 1
                                 2
                              
                              
                                 
                                    
                                       u
                                    
                                 
                                 s
                                 T
                              
                              
                                 
                                    
                                       u
                                    
                                 
                                 s
                              
                              +
                              
                                 1
                                 2
                              
                              
                                 
                                    
                                       v
                                    
                                 
                                 s
                                 T
                              
                              
                                 
                                    
                                       v
                                    
                                 
                                 s
                              
                              .
                           
                        
                     In order to compute the stored energy, Eq. (35) is integrated assuming zero initial conditions


                     
                        
                           (36)
                           
                              
                                 E
                                 store
                              
                              (
                              t
                              )
                              =
                              
                                 1
                                 2
                              
                              
                                 
                                    
                                       
                                          ∫
                                          
                                             t
                                             −
                                             
                                                T
                                                r
                                             
                                          
                                          t
                                       
                                       
                                          
                                             
                                                u
                                             
                                          
                                          m
                                          T
                                       
                                       
                                          
                                             
                                                u
                                             
                                          
                                          m
                                       
                                       d
                                       τ
                                       +
                                       
                                          ∫
                                          
                                             t
                                             −
                                             
                                                T
                                                l
                                             
                                          
                                          t
                                       
                                       
                                          
                                             
                                                v
                                             
                                          
                                          s
                                          T
                                       
                                       
                                          
                                             
                                                v
                                             
                                          
                                          s
                                       
                                       d
                                       τ
                                    
                                 
                              
                              ≥
                              0
                              .
                           
                        
                     This means that the communications in wave domain is not only passive, but also lossless for any time delays T
                     
                        r
                      and T
                     
                        l
                     . In essence the communication channel becomes, temporarily, an energy-storage element.

@&#RESULTS@&#

In order to support the theoretical development presented herein, this section presents the computer simulation of some telerehabilitation tasks using the proposed, impedance-controlled teleoperation scheme. The simulation tests were performed by using Matlab/Simulink, including the dynamic models of the robot and the human arm. Therefore, most of the physical phenomena that might occur in an experimental test are considered. It is well known that there are several factors that cannot be simulated as they occur in the real world, however, the use of the adaptive control scheme (16) gives a certain degree of robustness and ensures adequate results in practice in the future. The robot MIT-MANUS, widely used in rehabilitation therapies, was considered as test platform in order to validate the suitable human–robot interaction when using the proposed bilateral teleoperator.

The master and slave robots, used in simulation, are identical and correspond to the MIT-MANUS with two degrees of freedom (see Fig. 1a), whose corresponding dynamical model (1) is defined as follows: first, the manipulator's inertia matrix is,


                        
                           
                              (37)
                              
                                 
                                    
                                       M
                                    
                                 
                                 (
                                 
                                    
                                       
                                          q
                                       
                                    
                                    R
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                      
                                                         d
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      θ
                                                      
                                                         d
                                                         2
                                                      
                                                   
                                                   
                                                   cos
                                                   
                                                      (
                                                      
                                                         q
                                                         
                                                            
                                                               R
                                                               2
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         q
                                                         
                                                            
                                                               R
                                                               1
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      θ
                                                      
                                                         d
                                                         2
                                                      
                                                   
                                                   
                                                   cos
                                                   
                                                      (
                                                      
                                                         q
                                                         
                                                            
                                                               R
                                                               2
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         q
                                                         
                                                            
                                                               R
                                                               1
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      θ
                                                      
                                                         d
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                    
                                 [
                                 Nm
                                 
                                 
                                    s
                                    2
                                 
                                 /
                                 rad
                                 ]
                              
                           
                        The Coriolis and centripetal acceleration matrix is,


                        
                           
                              (38)
                              
                                 
                                    
                                       C
                                    
                                 
                                 (
                                 
                                    
                                       
                                          q
                                       
                                    
                                    R
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                          
                                          ˙
                                       
                                    
                                    R
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   −
                                                   
                                                      θ
                                                      
                                                         d
                                                         2
                                                      
                                                   
                                                   
                                                   sin
                                                   
                                                      (
                                                      
                                                         q
                                                         
                                                            
                                                               R
                                                               2
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         q
                                                         
                                                            
                                                               R
                                                               1
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            q
                                                            ˙
                                                         
                                                      
                                                      
                                                         
                                                            R
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      θ
                                                      
                                                         d
                                                         2
                                                      
                                                   
                                                   
                                                   sin
                                                   
                                                      (
                                                      
                                                         q
                                                         
                                                            
                                                               R
                                                               2
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         q
                                                         
                                                            
                                                               R
                                                               1
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            q
                                                            ˙
                                                         
                                                      
                                                      
                                                         
                                                            R
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                                    
                                 [
                                 Nm
                                 
                                 s
                                 /
                                 rad
                                 ]
                              
                           
                        whereas the matrix of viscous friction is


                        
                           
                              (39)
                              
                                 
                                    
                                       F
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                      
                                                         d
                                                         4
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      θ
                                                      
                                                         d
                                                         5
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                    
                                 [
                                 Nm
                                 
                                 s
                                 /
                                 rad
                                 ]
                              
                           
                        Finally, the Jacobian matrix of the manipulator is given by


                        
                           
                              (40)
                              
                                 
                                    
                                       J
                                    
                                 
                                 (
                                 
                                    
                                       
                                          q
                                       
                                    
                                    R
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      l
                                                      1
                                                   
                                                   
                                                   cos
                                                   
                                                      (
                                                      
                                                         q
                                                         
                                                            
                                                               R
                                                               1
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      l
                                                      4
                                                   
                                                   
                                                   cos
                                                   
                                                      (
                                                      
                                                         q
                                                         
                                                            
                                                               R
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      l
                                                      1
                                                   
                                                   
                                                   sin
                                                   
                                                      (
                                                      
                                                         q
                                                         
                                                            
                                                               R
                                                               1
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      l
                                                      4
                                                   
                                                   
                                                   sin
                                                   
                                                      (
                                                      
                                                         q
                                                         
                                                            
                                                               R
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                    
                                 [
                                 m
                                 ]
                              
                           
                        where 
                           θ
                        
                        
                           d
                        
                        =[θ
                        
                           d1 
                        θ
                        
                           d2 
                        θ
                        
                           d3 
                        θ
                        
                           d4 
                        θ
                        
                           d5]
                           T
                         with 
                           
                              θ
                              
                                 d
                                 1
                              
                           
                           =
                           
                              m
                              1
                           
                           
                              l
                              
                                 c
                                 1
                              
                              2
                           
                           +
                           
                              m
                              3
                           
                           
                              l
                              
                                 c
                                 3
                              
                              2
                           
                           +
                           
                              m
                              4
                           
                           
                              l
                              1
                              2
                           
                           +
                           
                              I
                              1
                           
                           +
                           
                              I
                              3
                           
                        , θ
                        
                           d2
                        =
                        m
                        3
                        l
                        2
                        l
                        
                           c3
                        +
                        m
                        4
                        l
                        1
                        l
                        
                           c4, 
                           
                              θ
                              
                                 d
                                 3
                              
                           
                           =
                           
                              m
                              2
                           
                           
                              l
                              
                                 c
                                 2
                              
                              2
                           
                           +
                           
                              m
                              4
                           
                           
                              l
                              
                                 c
                                 4
                              
                              2
                           
                           +
                           
                              m
                              3
                           
                           
                              l
                              2
                              2
                           
                           +
                           
                              I
                              2
                           
                           +
                           
                              I
                              4
                           
                        , θ
                        
                           d4
                        =
                        f
                        1 y θ
                        
                           d5
                        =
                        f
                        2; m
                        
                           i
                         represents the mass, l
                        
                           i
                         the length, l
                        
                           ci
                         the center of mass and I
                        
                           i
                         the inertia moment of the ith link, whereas f
                        
                           i
                         is the viscous friction coefficient of the ith joint, respectively. In this paper, the nominal values of the robot's parameters were considered as l
                        1
                        =0.405, l
                        4
                        =0.515 and 
                           θ
                        
                        
                           d
                        
                        =[3.48, 0.145, 1.16, 1.12, 0.56]
                           T
                        .

In order to simulate the human–robot interaction (Fig. 1a) during motor therapy tasks, the numerical values of a subject presented in [45] were assumed. The parameters for the model described in Eqs. (3)–(5) are 
                           
                              θ
                              
                                 
                                    H
                                    1
                                 
                              
                           
                           =
                           0.451
                        , 
                           
                              θ
                              
                                 
                                    H
                                    2
                                 
                              
                           
                           =
                           0.158
                         and 
                           
                              θ
                              
                                 
                                    H
                                    3
                                 
                              
                           
                           =
                           0.153
                        
                        Nms2/rad; D
                        
                           ss
                        
                        =0.8, D
                        
                           se
                        
                        =
                        D
                        
                           es
                        
                        =0.3 and D
                        
                           ee
                        
                        =0.7Nms/rad; and R
                        
                           ss
                        
                        =11, R
                        
                           se
                        
                        =
                        R
                        
                           es
                        
                        =3 and R
                        
                           ee
                        
                        =9Nm/rad.

The coupling communication channel between the robot manipulators is a stochastic network model [32]. Both forward and backward are random time-varying delays with minimum value of 100ms and maximum value of 500ms.

According to most studies on tasks of motor rehabilitation therapy, several residual motor capabilities are common on stroke survivors and three general operating modalities can be implemented [53]:
                           
                              •
                              
                                 Passive mode: the patient is unable to autonomously accomplish the motor task and the robot actively moves the human limb. Therefore, the followed trajectory is fully determined by the robot control system.


                                 Active-assisted mode: the patient starts the movement but he/she is unable to reach the target; the robot helps her/him in order to complete the programmed task. When the robot takes control of the task, it goes to passive mode. Initially the machine is fully compliant to human motion, until it stops.


                                 Active-constrained mode: the patient is able to complete the movement, and the robot can exert a set of programmed force fields to allow a complete recovery of the muscular tone. Here, the trajectory of the end-effector dynamically depends on the human–robot interaction.

In this paper, the first and third modes are of interest in order to evaluate the performance of the proposed telerehabilitation scheme. Thus, a circular path was selected as a target trajectory for both robot manipulators (master and slave). Three cases were considered and referred to as Test 1, 2, and 3, respectively. Test 1 consisted of evaluating the teleoperator performance in passive mode, i.e. free trajectory tracking where the path components (x
                        
                           d1, x
                        
                           d2) were sinusoidal functions with three different frequencies. In Test 2, human–robot interaction in the slave side is considered, i.e. the teleoperator is on active-constrained mode. Finally, Test 3 consisted of evaluating again the system in active-constrained mode, but including human–robot interaction in both sides, i.e. master and slave robots interact with humans. In order to verify the suitable performance of the system under human intervention (active mode), the torques generated by the muscles and the motor command of central nervous system (represented by τ
                        
                           in
                         in (3)) were simulated in the same fashion as the robotic arm, i.e. an impedance controller is used to track the desired path, by changing only the radius of the reference path to see a noticeable change in the trajectory tracking between passive and active modes.

In order to compare the performance of the proposed scheme, for Test 1, additional simulations were implemented using a typical wave-based teleoperator [25]. This scheme was chosen because it presented the best performance of an experimental comparative study between the main control architectures for bilateral teleoperators [32]. The simulation results were obtained in Matlab/Simulink by modeling and numerically solving the dynamics of the MIT-MANUS robot, for the case of two degrees of freedom in Eqs. (37)–(40), widely used in rehabilitation motor therapies; therefore, the following results have a theoretical/practical background.


                        Figs. 2, 3–5 and 6
                        
                        
                        
                        
                         show the simulation results of Tests 1, 2, and 3, respectively. The control parameter values were 
                           K
                        
                        
                           P
                        
                        =diag[2500, 2500]N/m and 
                           K
                        
                        
                           D
                        
                        =diag[280, 280]Ns/m for the master, 
                           K
                        
                        
                           P
                        
                        =diag[1500, 1500]N/m and 
                           K
                        
                        
                           D
                        
                        =diag[150, 150]Ns/m for the slave, and 
                           K
                        
                        
                           d
                        
                        =diag[150, 150]N/m, 
                           B
                        
                        
                           d
                        
                        =diag[50, 50]Ns/m, 
                           M
                        
                        
                           d
                        
                        =diag[2, 2]kg, and 
                           Γ
                        
                        
                           d
                        
                        =diag[10.5, 0.5, 8.5, 8.5, 0.5] for both manipulators. The initial end-effector position was 
                           x
                        (0)=[−0.17, −0.48]
                           T
                        
                        m, while the initial dynamic parameter estimates were set as 
                           θ
                        
                        
                           d
                        (0)=[3, 0.6, 0.5, 0.7, 0.3]
                           T
                        . The performance-oriented tuning procedure that was used to obtain the simulation results is sketched as follows:
                           
                              1.
                              Set the parameter-estimation-subsystem parameters γ
                                 
                                    di
                                  such that 
                                    Γ
                                 
                                 
                                    d
                                 
                                 >0 with 0<
                                 γ
                                 
                                    di
                                 
                                 <1.

Set the inertial parameters m
                                 
                                    di
                                  according to the apparent mass of the human-arm, and the stiffness parameters k
                                 
                                    di
                                  according to the estimated passive stiffness of the human-arm. Compute the damping parameters b
                                 
                                    di
                                  using Eq. (12).

Run simulations/experiments with low control gains k
                                 
                                    Pi
                                  and k
                                 
                                    Di
                                 , under the consideration of (19).

Increase the proportional gains, k
                                 
                                    Pi
                                 , in order to reduce the impedance error.

Increase the derivative gains, k
                                 
                                    Di
                                 , in order to reduce inertial effects such as the overshoot.

Increase the parameter-estimation gains, γ
                                 
                                    di
                                 , in order to reduce the parameter-estimation error.

Repeat the steps 4–6 until the best possible response is obtained.

In Fig. 2a, the movement of the robot manipulators, in terms of the components (x
                        1, x
                        2) of the master and the slave end-effector paths, is presented. The master end-effector position is accurately followed by the slave end-effector despite the varying time delays present in the communication channel. A sinusoidal behavior with three different frequencies can be observed, where an accurate path tracking is achieved thanks to the use of the adaptive controller (16).

On the other hand, Fig. 2b depicts the norms of the errors of position, velocity and force tracking, respectively, between master and slave robots. The control scheme is adapted to the corresponding parametric uncertainty of the robotic systems and, as time evolves, the impedance error tends to zero, hence indirectly every robot adjusts its impedance according to the information obtained from the sensors. Also, in Fig. 2b it can be observed a better performance of the proposed scheme in comparison with the approach in [25]. In order to establish comparison criteria and as a measure of transparency, three performance indices were evaluated for every controller: the integral of the square of the position error (ISPE), i.e. 
                           
                              ∫
                              0
                              
                                 
                                    t
                                    f
                                 
                              
                           
                           [
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              2
                           
                           
                              
                                 (
                                 
                                    x
                                    mi
                                 
                                 (
                                 t
                                 )
                                 −
                                 
                                    x
                                    si
                                 
                                 (
                                 t
                                 )
                                 )
                              
                              2
                           
                           ]
                           dt
                         (with t
                        
                           f
                         being the final time), the integral of the square of the velocity error (ISVE), i.e. 
                           
                              ∫
                              0
                              
                                 
                                    t
                                    f
                                 
                              
                           
                           [
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              2
                           
                           
                              
                                 (
                                 
                                    
                                       
                                          x
                                          ˙
                                       
                                    
                                    mi
                                 
                                 (
                                 t
                                 )
                                 −
                                 
                                    
                                       
                                          x
                                          ˙
                                       
                                    
                                    si
                                 
                                 (
                                 t
                                 )
                                 )
                              
                              2
                           
                           ]
                           dt
                        , and the integral of the square of the force error (ISFE), i.e. 
                           
                              ∫
                              0
                              
                                 
                                    t
                                    f
                                 
                              
                           
                           [
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              2
                           
                           
                              
                                 (
                                 
                                    f
                                    mi
                                 
                                 (
                                 t
                                 )
                                 −
                                 
                                    f
                                    si
                                 
                                 (
                                 t
                                 )
                                 )
                              
                              2
                           
                           ]
                           dt
                        . The resulting values of such performance index evaluations were: ISPE=0.0010, ISVE=0.0031, and ISFE=82.5941 for the proposed scheme; and ISPE=0.0045, ISVE=0.0153, and ISFE=161.8324 for the scheme of Niemeyer et al. [25]. Then, the proposed teleoperator had a better performance, since it is the controller with the highest number of lowest performance index evaluations. Therefore, from these results, an appropriate behavior is obtained for passive mode.

On the other hand, Fig. 3a shows the trajectories for Test 2. It can be observed an accurate path tracking, however the circular shape of the trajectory is modified according to the forces imposed by the user (patient), which represents an expected feature of active-constrained mode. The value of parameter b in the wave-transformation (8) and (9) gives a higher priority to the trajectory (position and velocity) or force tracking. Then with b
                        =250, a more accurate position-velocity tracking is observed in Figs. 3a and 4a, in comparison with the results showed in Figs. 3b and 4b where b
                        =50 was selected. Conversely, a better force tracking is showed in Fig. 5b with b
                        =50, than Fig. 5a with b
                        =250.

Finally, in Test 3, the trajectory of the master manipulator is modified by the user (therapist), therefore an active-constrained mode with human–robot interaction in both sides is obtained. Fig. 6a–c shows similar behaviors to Figs. 3a–5a, but with a wider path determined by the therapist. Therefore, from the results of Tests 2 and 3, an appropriate and versatile behavior is obtained for active-constrained mode.

From simulation results the efficacy of the proposed scheme is corroborated. Note that the adaptive term guarantees a suitable performance under parameter uncertainty, since the regression matrix involves an auxiliary dynamics to estimate some robot physical phenomena. Then, this scheme proves to be useful in practice for rehabilitation motor therapies using a wave-based teleoperator when the trajectory of the robot end-effector dynamically depends on the human–robot interaction, which is a common practical situation.

@&#CONCLUSIONS@&#

In this paper, an improved approach to bilateral teleoperation for interaction tasks was presented, which uses an adaptive impedance controller to regulate and enhance the interaction between the robot manipulators and humans (therapists and stroke survivors). Additionally, wave transformation is included into the scheme in order to avoid the instability caused by inherent time delays to the communication channel.

The performance of the proposed bilateral teleoperator was tested on two types of motor therapy tasks in passive and active-constrained modalities. The obtained results enabled us to demonstrate the ability of the proposed scheme to improve the system performance on interaction tasks, as compared to the previous proposed schemes.

@&#ACKNOWLEDGEMENTS@&#

This work was supported by CONACYT (project no. 222316) and PRODEP (project no. DSA/103.5/14/10476).

@&#REFERENCES@&#

