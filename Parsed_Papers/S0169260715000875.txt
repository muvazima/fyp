@&#MAIN-TITLE@&#A framework for the atrial fibrillation prediction in electrophysiological studies

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           HRV analysis, designed to work with R wave, also works on A-waves.


                        
                        
                           
                           pre-AFib signal portions are predictive of spontaneous AFib onset.


                        
                        
                           
                           An automatic device to alert the physician about an incoming AFib onset can be built.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Atrial fibrillation

Intracardiac signal

Heart rate variability

Signal processing

Prediction algorithm

@&#ABSTRACT@&#


               
               
                  Background and objective
                  Cardiac arrhythmias are disorders in terms of speed or rhythm in the heart's electrical system. Atrial fibrillation (AFib) is the most common sustained arrhythmia that affects a large number of persons. Electrophysiologic study (EPS) procedures are used to study fibrillation in patients; they consist of inducing a controlled fibrillation in surgical room to analyze electrical heart reactions or to decide for implanting medical devices (i.e., pacemaker). Nevertheless, the spontaneous induction may generate an undesired AFib, which may induce risk for patient and thus a critical issue for physicians. We study the unexpected AFib onset, aiming to identify signal patterns occurring in time interval preceding an event of spontaneous (i.e., not inducted) fibrillation. Profiling such signal patterns allowed to design and implement an AFib prediction algorithm able to early identify a spontaneous fibrillation. The objective is to increase the reliability of EPS procedures.
               
               
                  Methods
                  We gathered data signals collected by a General Electric Healthcare's CardioLab electrophysiology recording system (i.e., a polygraph). We extracted superficial and intracavitary cardiac signals regarding 50 different patients studied at the University Magna Graecia Cardiology Department. By studying waveform (i.e., amplitude and energy) of intracavitary signals before the onset of the arrhythmia, we were able to define patterns related to AFib onsets that are side effects of an inducted fibrillation.
               
               
                  Results
                  A framework for atrial fibrillation prediction during electrophysiological studies has been developed. It includes a prediction algorithm to alert an upcoming AFib onset. Tests have been performed on an intracavitary cardiac signals data set, related to patients studied in electrophysiological room. Also, results have been validated by the clinicians, proving that the framework can be useful in case of integration with the polygraph, helping physicians in managing and controlling of patient status during EPS.
               
            

@&#INTRODUCTION@&#

Cardiac arrhythmias are abnormalities or perturbations of the normal activation sequence of the myocardium, the muscular tissue of the heart. Atrial fibrillation (AFib) is the most common sustained arrhythmia, characterized by chaotic and uncoordinated atrial activation of the atrial cells. Patients affected by cardiac arrhythmias must perform a specialistic visit conforming to analyze heart electrical activity. Superficial and intracavitary cardiac signal analysis represents the best way to study, identify and classify heart signals and to study cardiac arrhythmias. Electrocardiogram (ECG) is a non-invasive technique that acquires the signals by skin surface electrodes and reports the electrical activity of heart, mainly used as a primary diagnosis tool for cardiovascular diseases [1]. Intracavitary electrogram, also indicated as electrophysiologic study (EPS), is an invasive technique consisting in recording and studying signals captured directly from inner heart part (intracavitary signals).

Nevertheless, EPS studies consist in external pacing which sometimes may induce spontaneous AFib onset. Indeed, during EPS an intraprocedural run of AFib can be elicited, mostly during atrial incremental stimulation, which requires aggressive manoeuvres for restoration of sinus rhythm, like electric transthoracic synchronous defibrillation or pharmacologic cardioversion, the latter being often excluded because it can jeopardize the actual arrhythmia that is affecting the patient (rarely atrial fibrillation pertains young individuals). The occurrence of atrial fibrillation during the invasive EPS is an undesired situation, which can be self-limiting, or can last several minutes, sometimes requiring electric external cardioversion. Early detection of an AFib occurrence is thus an important research topic both for biomedical engineers and for clinicians. Indeed, even if they expose patient to risky situation, EPS studies are often required in many cases. For instance, young patients with unexplained palpitations are usually difficult to treat, mainly because the aetiology is unclear from several non-invasive examinations performed. To date, the invasive electrophysiologic study (EPS) is helpful for diagnosing and risk stratification, and it is considered a class I indication (to be performed) for those patients with atrioventricular reentrant tachycardias such as the Wolff–Parkinson–White syndrome.

Under this circumstance, we started by investigating the origin of the signals from the atrial electrocatheter in order to check whether the occurrence of AFib could be predicted somehow during the EPS and thus prevented. In this direction, a new device that evaluates the triggering activity during the stimulation protocol and promptly alerts the physician to stop the stimulation for avoiding atrial fibrillation induction is indeed needed. In this scenario, we present results of three years experience of collaboration among bioinformaticians and cardiologists sharing activities in electrophysiologic room where many procedures have been studied in terms of data signals and semantics, identifying useful information for AFib early prediction. As results we propose a framework hosting a prediction algorithm that allows to predict AFib events during electrophysiological studies. The prediction algorithm allows to analyze and extract predictive information from intracavitary signals. Experimental results show that it is possible to perform early detection of AFib onset during EPS, allowing the possibility of inserting such an algorithm into an online monitoring system to alert physicians during EPS studies. A preliminary version of the algorithm has been presented in [2].

In the remaining part of the section we report about state of the art and background, while the rest of the paper is organized as follows. Section 2 reports basic information about heart electrophysiology useful for algorithm comprehension. Section 3 reports the signal analysis procedures used to design the prediction algorithm. Section 4 reports results about the application of the proposed prediction framework, which includes preprocessing and signal analysis, on real patient data that have been anonymized. Finally, Section 5 concludes the paper.

Many computer-based approaches for automated detection and classification of cardiac arrhythmias have been described in literature. Signal processing methods performed on ECG signals have been proposed to extract clinical information about cardiac activities and to perform identification and classification of cardiac arrhythmias [3,4]. In [5] wavelet-based analysis has been performed to denoising ECG and to detect the specific waves of the signal. Authors in [6] present an algorithm for the detection of cardiac arrhythmias using an online database. Other contributions in terms of arrhythmias classification have been proposed in [7,8], where Support Vector Machine (SVM) technique has been applied to ECG signals, and artificial neural network and data mining methods have been used to select and extract interesting parameters from ECG signals respectively.

ECG features extraction in time and frequency domains and methods as heart rate variability (HRV) and non-linear ECG analysis have been proposed for a quantitative prediction of clinical cardiac events, prevalently used for AFib disease [9]. In [10] authors show different approaches to atrial activity extraction from ECG signal in terms of spectral properties. Information extraction from ECG signals in patients with AFib by using bispectrum and extreme learning machine is proposed in [11]. AFib prediction examples can be found in [12,13] based on the analysis of the HRV signal; both contributions work on superficial cardiac signals implementing different types of analysis. AFib termination prediction is reported in [14], in which authors present an algorithm by using HRV signals analysis. Sosnowski et al. in [15] investigate the influence on heart rate variability (HRV) in patients with permanent atrial fibrillation. In [16] authors evaluate atrial activity with HRV analysis in patients with AFib. The prediction of AFib recurrence is also proposed in [17], analyzing pre-cardioversion heart rate variability. Other examples of features extraction are reported in [18,19] in which authors investigate for the prediction of AFib in terms of HRV on normal sinus rhythms and AFib data.

The above reported papers represent the interest on the here treated topic. Nevertheless, to the best of our knowledge, in literature, there are still few works on intracavitary signal analysis and prediction; some preliminary results and studies are reported in [20,21], while recent works have contributed to the understanding of AFib by intracardiac recording [22,23] and by spectral analysis of intracardiac electrograms [24,25]. In order to better understand AF events, one of the most adopted techniques is complex fractionated atrial electrograms [26], which is able to relate AF with heart morphology, physical and geometrical parameters. Currently, intracavitary signal analysis (i.e. by means of EPS study) is not frequently performed because of the invasive techniques needed to record these signals. Sometimes, physical devices are used to record and monitor cardiac rhythms and to identify electrophysiological problems, e.g., the Holter 24h recording one to detect irregularities in the ECG signal. Innovative ones, as the one reported in [27–29], as well as new applications for smartphone or tablet [30,31] perform reliable ECGs and send data to physician for detailed diagnosis. Nevertheless, EPS studies are undoubtedly the best way to characterize local atrial activity with a high degree of detail, especially in AFib identification.

We report some basic principles of the heart electrophysiology, useful for AFib analysis and to introduce proposed prediction algorithm. The attention is focused on the study of: (i) superficial and intracavitary cardiac signals, (ii) heart rate variability, and (iii) atria fibrillation arrhythmia.

The cardiac electric activity can be measured by both surface electrocardiogram (ECG) and intracardiac electrogram (IEGM). The former is acquired through specific electrodes posed on skin (and well defined positions) and provides information about heart electrical activity [32,33]. An ECG is recorded through the standard 12-leads, e.g., lead V1 is an unipolar lead recording the activity of the electrode on the fourth intercostal space to the right of the sternum [34]. Intracardiac electrogram (IEGM) is gathered from heart inner parts by posing electrodes into cardiac zones reached by using vessels. It allows to gather localized electric heart activity [35–37]. One of the inner heart sites where IEGM signals are gathered is high right atrium (HRA). HRA signal allows to record a large atrial electrogram and a smaller and far-field ventricular electrogram; pacing at this position allows to evaluate the sinus node function and atrium-ventricular (AV) conduction, as well as the arrhythmias induction [38]. Examples of ECG from lead V1 and IEGM from the HRA are reported in Fig. 1
                     ; ECG signal is typically composed of five deflections (called waves); P wave represents the sequential depolarization of the right and left atria, the QRS complex reflects depolarization of the right and left ventricles and T wave represents repolarization of the ventricles. In IEGM signal, right atrial depolarization occurs during the onset of the P-wave on ECG and it is characterized by A-wave on HRA electrogram [40].

HRV analysis works on R peaks of ECG signal while HRA signal contains A peaks. The signal analysis techniques described in the paper are agnostic about the clinical semantics of the signals, hence we used the same algorithm to identify A peaks instead of R ones because they appear with the same frequency.

Heart rate variability (HRV) analysis is the most common procedure performed in clinical applications to extract specific parameters highly useful in diagnosis [41,42]. HRV is a signal measured by the variation in the beat-to-beat interval or correspondingly in the instantaneous heart rate (HR). HRV reflects many physiological factors that modulate the cardiac autonomic control, providing the recognition of a significant relation between the sympathetic nervous system (SNS) and parasympathetic nervous systems (PNS). We mention two methods to perform HRV analysis [43]: (i) time domain methods evaluate the magnitude of the temporal variations, and (ii) frequency domain methods provide the spectral composition of temporal variations.

In time domain analysis, different methods can be used to extract from signal statistics and geometric measures. A geometric method is the Poincare plot, a map of points in Cartesian coordinates in which each time interval between two consecutive R waves (RR interval) is plotted as function of the previous RR interval [44]. Poincare plot may be analyzed quantitatively by calculating the standard deviations SD1 and SD2: SD1 is an index related to the beat-to-beat variability representing parasympathetic activity; SD2 is an index describing the overall long-term variability.

Time domain analysis method is not able to discriminate between sympathetic and parasympathetic contributions of HRV. For this reason, frequency domain analysis methods are used to obtain information about SNS and PNS of sinus node for both normal and pathological subjects. The most common analysis is the Power Spectral Density (PSD) of RR intervals that provides the basic information about the power distribution as a function of frequency. FFT (Fast Fourier Transform)-based methods offer great benefits regarding the ability to assign the power in different bands to a number of underlying physiological functions. The Fourier transform gives information about the frequency content of a signal but it cannot give an information at which time a frequency has occurred. The short time Fourier transform (STFT) provides this information and is useful to analyze non-stationary signals. Therefore, only short periods of the signal are Fourier transformed and the quality of the STFT is strongly dependent on the window function. The Fourier and wavelet transforms (WT) measure similarity between a signal and an analyzing function. The wavelet transform is a time–frequency transformation and, compared to the FFT, the WT gives information about the frequency content of a signal and also information at which time segment a frequency occurs.

In spectral analysis of HRV, the three main spectral components are characterizing: (i) Very Low Frequency (VLF) component is related to the energy in the frequency range of 0–0.03Hz and it is connected to thermo-regulation and changes in physical activity; (ii) Low Frequency (LF) component in correspondence of the frequency range 0.04–0.15Hz is a measure of fluctuations of arterial pressure, reflecting sympathetic activity; (iii) High Frequency (HF) component in 0.15–0.40Hz reflects vagal activity modulated by breathing [41]. LF and HF components contain up to 65% of total power and are represented in normalized units to underlie the controlled and balanced behaviour of the two systems. An increase of LF/HF ratio is corresponding to an increase in LF and it is related to a predominant sympathetic modulation; on the contrary, a decrease in LF/HF ratio corresponds to an increase in HF, showing a prevailing vagal modulation.

We are interested in the signal analysis reported above for the characterization of AFib based on the extraction of time and frequency parameters. Main time and frequency domain measures of HRV used in this paper are reported in [43,45].

Atrial fibrillation (AFib) is a supraventricular arrhythmia characterized by chaotic and uncoordinated atrial activation of the atrial cells with a rate between 400 and 600 times per minute and by contraction which involves an irregular and rapid response of the ventricles [46,47].

In the ECG, AFib is characterized by rapid atrial activity, being irregular in timing and morphology. The surface ECG during AFib shows irregular fibrillatory waves due to chaotic activation of the atria compared with normal rhythm. Fig. 2
                         shows an AFib (part (a) of the figure) and normal sinus rhythm (part (b) of the figure) on lead I. The following features can be noted on the signal:
                           
                              •
                              irregular rhythm;

absence of P waves;

irregular RR intervals;

ventricular rate between 100 and 200beats/min and atrial rate between 240 and 540beats/min;

narrow QRS complex.

@&#METHODS@&#

The algorithm proposed has been designed to identify and predict AFib events by using intracardiac electrogram analysis. HRAd (distal HRA – low lateral right atrium) signals on V1 leads have been chosen because they represent the best to detect AFib events by just looking at a single HRAd recording. The idea of the algorithm in a nutshell is to detect A-waves on HRAd in correspondence of P-waves on the surface ECG recording, calculate the amplitude of consecutive A-waves and verify how these amplitudes change. In particular, a decrease of the amplitude in A-waves is associated to an absence of P-waves on ECG or, at least, to the fact that such P-waves are not easily recognizable because of amplitude reductions occurring during AFib. A reduction in the amplitude of A-waves in HRAd could be considered as a valid indicator and predictor of AFib induction. Therefore, the difference of amplitudes between consecutive A-waves has been monitored, as shown in Fig. 3
                     , where selected A-waves are highlighted with circles, both for normal (a) and AFib (b) rhythms. In particular, the normal rhythms, that represents the control trace, are characterized by the present of A-waves with constant amplitudes. Instead, Fig. 3b displays both pre-AFib and AFib signals; pre-AFib trace is marked by two groups of A-waves (named 1st and 2nd A-waves group respectively) with decreased amplitudes and AFib trace follows this A-waves trend.

A workflow representing the algorithm's main steps is reported in Fig. 4
                     . It involves three main modules: (i) the preprocessing module, which is in charge of acquiring and preprocessing signals (e.g., noise reduction) and is described in Section 3.1; (ii) feature extraction module, being in charge of identifying A-waves in HRAd signals, described in Section 3.2; (iii) AFib prediction module, which evaluates A-waves and predicts AFib events and is described in Section 3.3.

The preprocessing step consists of two procedures: (i) acquiring the signal file and waveform generation and (ii) filtering the signal to remove baseline wandering, wideband noise and undesired components.

Each bipolar atrial intracardiac recording of HRAd derivation has been extracted by the electrophysiology recording system in textual format and reconstructed by setting the sampling interval to 0.0005s (sampling frequency to 2kHz). For the filtering, instead, the following preprocessing steps have been performed [48]:
                           
                              •
                              Band-passed filtering using a zero-phase second-order Butterworth filter with cut-off frequencies of 40–300Hz.

Rectification calculating the absolute value of the output coming from the bandpass filter.

Low-pass filtering using a similar third-order Butterworth filter with a cut-off frequency of 20Hz.

The band-passed filtering has been used to emphasize the signal corresponding to the local depolarization. The high-pass filter blocks low frequency signals and allows the higher frequencies to emerge; it is designed to remove physiologic waveforms such as the low frequency myopotential emitted by the diaphragm or the slow far field signals from cardiac chambers outside the chamber that is mapping. Moreover, the filter removes the baseline wandering which is the low frequency trend of the signal, with frequencies in the range of 0.15 and 0.3Hz. The low pass filter, instead, allows lower frequencies to pass and helps removing high frequency environmental noise coming from outside of the recording system. The next rectification step transforms the biphasic waveform to a monophasic one to help identify peak frequencies. The last filter limits the spectrum to frequencies falling within a reasonable physiologic range of activation rates, preserving the most relevant temporal features of the signal. During AFib, the corresponding heart rate, measured through intracardiac electrograms, shows rapidly changing frequencies between 3 and 15Hz.

The aim of this step is to extract A-waves from HRAd signals. A-waves detection starts from the identification of N peaks P
                        
                           i
                         on HRA signal that exceeds a fixed threshold thr. It is performed by using a multiresolution wavelet analysis in Extraction method to find maxima peaks of a signal. The threshold has been set to 0.1mV to extract only the peaks that represent similar characteristics in amplitude with respect to A-waves. The 0.1 threshold parameter has been indicated by physicians. The workflow that summarizes A-waves detection is shown in Fig. 5
                        .

The algorithm considers the sequence of the detected peaks P
                        
                           i
                         and their corresponding times instant t
                        
                           i
                         in order to verify the temporal difference of the i
                        
                           th
                         peak with respect to its successive i
                        
                           th+1 peak. If such difference in time is less than 100ms, the two peaks P
                        
                           i
                         and P
                        
                           i+1 are sufficiently close to represent the same A-wave, so both peaks are saved into an X array by using the Save method. The procedure continues until the temporal difference becomes greater than 100ms. Then, the i
                        
                           th+1 peak is considered for next A-wave. The peak with maximum value in amplitude is extracted by the X array and saved in a new array (called A), to store all the M A-waves A
                        
                           j
                        , where M is the total number of A-waves detected and extracted.

We here report about the core part of the proposed framework, i.e. the AFib prediction algorithm. It evaluates the differences between the amplitudes values of A-waves stored in the vector A (the array data structure obtained in the feature extraction algorithm of Fig. 6
                        ).

The AFib algorithm has been designed as represented in the workflow schema of Fig. 6. It works by comparing the generic j
                        
                           th
                         A-wave value with the j
                        
                           th+1 one in the A vector, and by storing in a new vector Z (an array data structure), A-waves values with decreasing amplitudes. Difference of amplitudes W
                        
                           k
                         between maximum max(Z) and minimum min(Z) values is calculated. The K differences W
                        
                           k
                         are then loaded in another vector W; in particular, K represents the total number of A-waves groups with consecutive decreasing amplitudes as well as the number of differences W
                        
                           k
                         calculated between the maximum and minimum amplitudes of each A-waves group. The threshold value of 0.1 represents the minimum value beyond which AFib triggers; if the value in W is greater than 0.1, the difference of amplitude among consecutive A-waves is significant and thus it may signal the possibility of an AFib onset.

@&#RESULTS AND DISCUSSION@&#

Superficial and intracavitary cardiac signals of 50 patients subjected to EPS have been extracted directly from the electrophysiologic room in Cardiology Department of University Magna Graecia of Catanzaro, using the GE (General Electric) Healthcare's CardioLab Electrophysiology (EP) recording system [49]. All patients have been subjected to EPS according to the standard procedure and following the specific stimulation protocol reported in [50]. Only five patients (patients no. 1–5) of all patients enrolled for this study have been affected by spontaneous AFib onset; the algorithm has been able to identify these patients among all 50 tested subjects and to predict all AFib single events in each of the five patients. The AFib onset during EPS is a particular case and it is a rare event; this justifies the low number of patients that presents this problem. Moreover, the algorithm works with intracavitary signals that can be extracted only through an invasive procedure; so, only patients with a specific heart disease or suspect can be subjected to EPS. There is an intrinsic difficulty in finding patients suitable to reproduce spontaneous AFib onset and to test the prediction accuracy of the presented algorithm. Anyway, as just said before, the algorithm recognizes the patients with AFib onset and, for each of them, it is able to predict all the events of AFib that occur. For these patients, clinical characteristics and the relative times procedure are reported in Table 1
                     . Moreover, a patient without spontaneous AFib onset has been chosen between the other 45 patients and has been considered as reference patient indicated as Ref.

Patients from 1 to 5 were all in the age range (between 28 and 42 years old) that usually does not result to be affected by atrial fibrillation. Only one patient of them was affected by systemic hypertension, and under effective pharmacologic control by angiotensin receptor blocker inhibitors, while echocardiography examination was normal, as well as for the other patients. Ischaemic substrate for the arrhythmias was excluded in patients around forty years of age by performing coronary angiography, while the younger patients (N
                     =2) underwent an ECG monitoring during effort test, which did not display any anginal symptom nor ST-segment downslope. Anti-arrhythmic drug therapy was suspended in all patients undergoing electrophysiologic study at least three days before performing the invasive procedure.

We used HRV-based analysis as a preliminary study on the data set to identify patterns useful for prediction. Later, it has been used to support and validate the prediction algorithm design phase; this algorithm works only with the HRAd signal that gives more information on the fibrillation event. This choice has been validated by the clinicians due to the fact that the procedure has to be performed in real time in surgery room.

In the following subsections, the results regarding the five patients with AFib onset will be reported and divided as:
                        
                           •
                           results by HRV analysis for short and long recording;

results by test of prediction algorithm for single pre-AFib patterns and for entire recording.

HRV analysis has been performed on all acquired signals to evaluate the different behaviour of sinus rhythm and AFib event in terms of time and frequency information. In this work, HRV has been applied not on ECG signal but on HRA tracer, considering AA intervals instead of RR intervals. This kind of analysis has been performed as a preliminary step to study the different behaviour of normal, pre-AFib and AFib traces useful for the successive implementation and test of the proposed prediction algorithm.

A first HRV analysis has been primarily applied on few seconds of all patients’ IEGM on HRA derivation extracting two tracks, one track containing a normal signal (basal activity) and another containing AFib events, as reported in Table 2
                        , which shows results in both time and frequency domains. An up arrow (↑) indicates an heart rate increase, while a down arrow (↓) an heart rate decrease (as described in Section 2.1).

The same HRV analysis has been then performed on the entire procedures (mean recording time 3–4h) to monitor and analyze more AFib events. The results of time and frequency analysis are reported in Table 3
                         and they agree to results obtained for short recordings (Table 2).

By both Tables 2 and 3, frequency analysis reports that AFib onset is characterized by a heart rate acceleration, reflecting an increase and a decrease of sympathetic and vagal modulation of sinus node respectively, a predominance of LF component and a consequent greater LF/HF ratio.

After HRV analysis, the designed algorithm has been tested first on specific subsequences of the entire records for all patients. For each patient, three patterns have been identified and tested:
                           
                              •
                              
                                 pre-AFib: time interval immediately before an AFib event;


                                 AFib: time interval of an AFib event;


                                 post-AFib: time interval immediately after an AFib event.

In particular, pre-AFib patterns (that represent the time interval immediately before an AFib event) have been identified and tested because they represent the signal portions which enable the proposed algorithm to detect a warning condition thus predicting the AF onset. Table 4
                         shows results relative to the pre-AFib intervals (considering one of AFib events for each patient) and underline the ability of the algorithm to predict AFib events. For each patient, groups of consecutive decreasing A-waves values have been extracted. Each table row represents: (i) maximum and minimum amplitude of A-waves, (ii) the number of A-waves and (iii) the difference in amplitude between the maximum and the minimum A-wave. Moreover, a patient reference Ref has been introduced at the end of the table to show the different behaviour between a pre-AFib interval and an interval that is not preceding any AFib events.

The results show that, in pre-AFib intervals, the A-wave amplitudes are greater (0.1mV) than in reference patient Ref. The algorithm has been also tested for the other two patterns, AFib and post-AFib, to find similarities among patients. The results we obtained can be summarized as:
                           
                              •
                              
                                 AFib pattern: all A-waves differences are greater than 0.1mV and the trend of A-waves is completely irregular;


                                 post-AFib pattern: all A-waves differences are smaller than 0.1mV and the trend of A-waves is constant.

Finally, the algorithm has been tested on full length records to test the ability of the method in predicting AFib events early enough for the physician to avoid inducing them during surgery. Results for each patient are shown in Table 5
                        .

A-waves extracted have been associated to abnormal events known as ectopic beats which clinically would precede AFib onset. Ectopic beats, also known as PAC (Premature Atrial Contractions), are premature atrial contractions that precede AFib onset and can usually be appreciated just analyzing the HRA. Groups of A-waves are expressed in Table 5 in terms of ectopic beats and start time for the first beat of each group. Start times of AFib are also reported to show the time of AFib prediction.

Ectopic beats identification and consequently AFib onset prediction is reported in Fig. 7
                         and represents a sub-recorder (written in bold in Table 5) for patient no. 2. Specifically, for each of the five ectopic beats identified and for AFib events, a zoom view is proposed to show how the algorithm works with A-waves extraction and amplitude difference calculation. Differences in amplitude between two consecutive peaks are shown in Table 4; they are always higher than 0.1mV, confirming the previously reported results.

The algorithm was able to detect if an exact AFib event is present or not. Furthermore it was able to detect all AFib events with 100% accuracy in all our test sets.

The results proposed in this work have been evaluated and validated by physician that has confirmed all AFib events and indicated the extracted A-waves as ectopic beats that could be clinical predictors for AFib onset. The cohort of patients evaluated in our study was actually selected by two physicians (A.C., C.I.) who performed the electrophysiologic studies in all patients referred to our arrhythmias clinics at Magna Graecia University. Signals belonging to those patients who developed the unwanted atrial fibrillation were then given to the bioengineering researchers (Pa.Vi., G.T., Pi.Ve.) for analysis, that is to find whether during the stimulation protocol, there was an appreciable increase in ectopic activity (due to premature atrial contractions) that eventually led to atrial fibrillation and which perhaps could have been avoided by knowing that the above mentioned extrasystoles were increasing atrial vulnerability predisposing to AFib.

@&#CONCLUSIONS@&#

Analysis of cardiac signals has been implemented to extract relevant features used by an AFib prediction algorithm. The algorithm has been proposed as a tool to support intervention procedures and has been tested on a real patients data set. Intracavitary signal analysis is relevant for cardiac arrhythmia studies. However, due to risk of AFib induction, predictor framework plays an important role. To the best of our knowledge there are no works in literature supporting AFib prediction in EPS studies. This work represents a contribution towards the implementation of an on-line instrument to be used directly in electro-physiology room during EPS procedures.

@&#ACKNOWLEDGEMENTS@&#

This work has been partially funded by PON Cardiotech project, and by PON SH 2.0 Smart Health project, both funded by MIUR grant number Pon04a2_C MIUR D.D. 626/Ric and by PRIN GenDATA2020 
                  2010-2011. Moreover, the authors thank Professor Giovanni Cuda for comments on the manuscript and Professor Sergio Greco for discussion on the topic.

@&#REFERENCES@&#

