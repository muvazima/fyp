@&#MAIN-TITLE@&#Comparison of approaches for parameter estimation on stochastic models: Generic least squares versus specialized approaches

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Parameter estimation is demonstrated for a stochastic bistable genetic toggle switch.


                        
                        
                           
                           Conventional parameter estimation methods do not perform well for models with substantial intrinsic stochasticity.


                        
                        
                           
                           Parameter estimation for stochastic models can be done in a computationally efficient manner.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Stochastic models

Parameter estimation

Systems biology

Identifiability

@&#ABSTRACT@&#


               
               
                  Parameter estimation for models with intrinsic stochasticity poses specific challenges that do not exist for deterministic models. Therefore, specialized numerical methods for parameter estimation in stochastic models have been developed. Here, we study whether dedicated algorithms for stochastic models are indeed superior to the naive approach of applying the readily available least squares algorithm designed for deterministic models.
                  We compare the performance of the recently developed multiple shooting for stochastic systems (MSS) method designed for parameter estimation in stochastic models, a stochastic differential equations based Bayesian approach and a chemical master equation based techniques with the least squares approach for parameter estimation in models of ordinary differential equations (ODE). As test data, 1000 realizations of the stochastic models are simulated. For each realization an estimation is performed with each method, resulting in 1000 estimates for each approach. These are compared with respect to their deviation to the true parameter and, for the genetic toggle switch, also their ability to reproduce the symmetry of the switching behavior. Results are shown for different set of parameter values of a genetic toggle switch leading to symmetric and asymmetric switching behavior as well as an immigration-death and a susceptible-infected-recovered model. This comparison shows that it is important to choose a parameter estimation technique that can treat intrinsic stochasticity and that the specific choice of this algorithm shows only minor performance differences.
               
            

original data (red),

stochastic simulations with the MSS estimates (blue) and

stochastic simulations with the LSQ estimates (dashed blue).

Parameter name (column 1),

true parameter value (column 2),

averages of MSS estimates (column 3): 
                                 Mean
                                 =
                                 
                                    1
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       
                                          θ
                                          ˆ
                                       
                                    
                                    i
                                    MSS
                                 
                              ,

average relative errors of MSS method (column 4): 
                                 ARE
                                 =
                                 
                                    1
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       |
                                       
                                          
                                             
                                                θ
                                                ˆ
                                             
                                          
                                          i
                                          MSS
                                       
                                       −
                                       
                                          θ
                                          0
                                       
                                       |
                                    
                                    
                                       
                                          θ
                                          0
                                       
                                    
                                 
                              ,

average of the LSQ estimates (column 5): 
                                 Mean
                                 =
                                 
                                    1
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       
                                          θ
                                          ˆ
                                       
                                    
                                    i
                                    LSQ
                                 
                              ,

average relative errors of the LSQ method (column 6): 
                                 ARE
                                 =
                                 
                                    1
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       |
                                       
                                          
                                             
                                                θ
                                                ˆ
                                             
                                          
                                          i
                                          LSQ
                                       
                                       −
                                       
                                          θ
                                          0
                                       
                                       |
                                    
                                    
                                       
                                          θ
                                          0
                                       
                                    
                                 
                              ,

average of the SDE estimates (column 7): 
                                 Mean
                                 =
                                 
                                    1
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       
                                          θ
                                          ˆ
                                       
                                    
                                    i
                                    SDE
                                 
                              ,

average relative errors of the SDE method (column 8): 
                                 ARE
                                 =
                                 
                                    1
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       |
                                       
                                          
                                             
                                                θ
                                                ˆ
                                             
                                          
                                          i
                                          SDE
                                       
                                       −
                                       
                                          θ
                                          0
                                       
                                       |
                                    
                                    
                                       
                                          θ
                                          0
                                       
                                    
                                 
                              .

@&#INTRODUCTION@&#

Parameter estimation is very important for the analysis of models in systems biology. Computational modeling is a central approach in systems biology for studying increasingly complex biochemical systems. Progress in experimental techniques, e.g. the possibility to measure small numbers of molecules in single cells Raj and van Oudenaarden (2009) makes it possible to observe behavior that can only be explained by taking into account the intrinsic stochasticity of the underlying processes, leading to a need for stochastic modeling approaches. Simulation methods for stochastic processes have been developed for decades since (Gillespie, 1976) and nowadays exist with a lot of variants (Pahle, 2009). On the other hand, parameter estimation for stochastic models is a less mature field. The wide availability of software for parameter estimation in deterministic models (compared to specialized stochastic methods) may lead to an application of these methods even when the underlying data shows indications of intrinsic stochasticity. The question arises whether this naive approach (using a method designed for deterministic models to determine parameters of stochastic models) is acceptable, or whether specialized approaches are required for satisfactory results.

We compare, with three example models, the performance of dedicated stochastic parameter estimation methods with a least squares method designed for deterministic models. An important property of stochastic processes (and of their models) is that they can show behavior that is qualitatively different from the behavior of a corresponding deterministic model. One example for such a qualitatively different behavior is random switching between different states that in an ODE model would each be stable steady states. For this study we chose the stochastic model of a genetic toggle switch (Gardner et al., 2000) as a prototype model for such a switching behavior. Using this model, and an immigration-death as well as an epidemics model, we compare the multiple shooting for stochastic systems (MSS) approach (Zimmer and Sahle, 2012), a stochastic differential equation (SDE) based Bayesian approach (Golightly and Wilkinson, 2005) and a chemical master equation (CME) technique for parameter estimation in stochastic models with a least squares (LSQ) approach.

The problem for parameter estimation for stochastic models can be written in the following form: we assume that the experimental or simulated data measures at each time point t
                     
                        i
                     , i
                     =1, …, n, the number of molecules of species ν
                     
                        i
                      in the system, hence 
                        
                           ν
                           i
                        
                        ∈
                        
                           
                              
                                 ℕ
                              
                           
                           0
                        
                     . Each data set ν
                     =(ν
                     1, …, ν
                     
                        n
                     ) is stochastic. This means that even two simulated realizations of the system without assumption of measurement noise can be different. Fig. 1
                      illustrates that the behavior of the stochastic genetic toggle switch shows a switching behavior while the ODE model rapidly converges towards a steady state. This means that the behavior of the stochastic model is qualitatively different. Furthermore, it is assumed that the system's behavior depends on some unknown parameters 
                        θ
                        ∈
                        
                           
                              
                                 ℝ
                              
                           
                           q
                        
                      which are to be estimated. To this goal the data ν is compared to simulations with respect to some objective function F which measures the quality or the error of the fit. Parameter estimation means finding the optimal value 
                        
                           θ
                           ˆ
                        
                      for the parameter. For models of ODE the choice of the objective function has been widely discussed (Jaqaman and Danuser, 2006) and in case of normally distributed measurement error the common choice is a least squares function. Even in cases where the distribution of the error is not well known, a least squares approach is commonly used because it is widely available in software implementations.

Approaches using stochastic simulations and density estimation methods can be found in Tian et al. (2007) and Poovathingal and Gunawan (2010), a reversible jump algorithm (Boys et al., 2008) together with Bayesian methods or a stochastic gradient descent in Wang et al. (2010). Using a surrogate probabilistic model as an approximation is faster from a computational point of view (Henderson et al., 2010). A second class of methods focuses on a numerical solution of the Chemical Master equation (CME), which describes the probability for each state as a function of the time. As the state space might be infinite, state space truncation can be used (Andreychenko et al., 2011) or moment-closure methods, which are an approximation focusing on a finite number of moments of the probability distribution (Gillespie, 2009; Gillespie and Golightly, 2010). If distribution information is available from measurement a finite state projection (Munsky and Khammash, 2010) can be used to solve the CME without simulations. The common challenge is the fact that the solution of the CME as well as simulation-based methods becomes very time-consuming as the number of states in the state space becomes larger.

The MSS approach (Zimmer and Sahle, 2012) used in this article splits the time course into intervals that are treated separately. The initial values for each interval are calculated by state updating. The MSS method is motivated by a method proposed by Bock (1981) for the parameter estimation in systems of ordinary differential equations (ODE), further developed (Schlöder and Bock, 1983) and already successfully applied to deterministic systems with chaotic behavior (Baake et al., 1992; Kallrath et al., 1993). The method can tackle models with fully observed and partially observed data sets. The fact that it works without stochastic simulations and without solving a high dimensional chemical master equation (CME) means that it is possible to approach systems of a size as large as realistic models being tackled with ODEs. This is a main advantage in comparison with simulation or CME based methods. In Zimmer and Sahle (2012) examples are shown which compare the MSS method to the reversible jump algorithms (Boys et al., 2008; Wang et al., 2010) demonstrating that the increase in speed does not lead to a loss in accuracy. The approach is implemented in the widely used software package (Hoops et al., 2006) which allows the user to access all model import and analysis features of this well established software.

We also implemented a second approach that is suited for parameter estimation in stochastic models: a diffusion approximation that uses latent data points to treat unobserved components and a Bayesian framework for sampling these latent components as well as the parameters (Golightly and Wilkinson, 2005). A third approach is based on the chemical master equation. It is exact but requires a computational effort that can only be mastered for small models.

Since the objective function of the MSS method is deterministic the estimate for a single stochastic time course is unambiguous. This is also the case for the CME method and the LSQ method and, at least for infinite run time of the Markov chain, also for the Bayesian approach. But, using the same model with the same parameters and initial conditions, another stochastic time course realization will look different due to the intrinsic stochasticity and, therefore, the estimation will result in a different value. To compare both objective functions, it is, therefore, necessary to estimate more than one stochastic realization of the same model with the same parameters and initial conditions. This article uses 1000 different simulated realizations. A statistic over the 1000 estimations can then be used to assess the quality of the objective function. The quality is assessed with displaying relative errors. Furthermore, the estimated parameters of the genetic toggle switch are used to carry out new stochastic simulations and compare their symmetry of the switching behavior to that of the true parameters. It has to be underlined that the 1000 realizations are only used to test the quality of the objective function. For an estimation one realization is sufficient.

The article is structured as follows:

The method section will briefly introduce stochastic modeling and review the dedicated stochastic parameter estimation approaches as well as the LSQ approach. The results section will show the performance of the methods on several sets of parameter values of a stochastic model of a genetic toggle switch. Three sets of parameter values of an immigration-death model illustrate the conditions under which the dedicated stochastic methods have the strongest advantage against the least squares approach. The conclusion section will give some concluding remarks.

@&#METHOD@&#

Let X
                        =(X
                        1, …, X
                        
                           D
                        ) denotes the D species in a system with r reactions in which q
                        
                           ij
                         denotes the number of educt molecules of species X
                        
                           i
                         for reaction j and u
                        
                           ij
                         the number of product molecules of species X
                        
                           i
                         for reaction j. Hence the systems read as
                           
                              
                                 
                                    
                                       
                                          
                                             q
                                             
                                                1
                                                j
                                             
                                          
                                          
                                             X
                                             1
                                          
                                       
                                       
                                          +
                                          
                                             q
                                             
                                                2
                                                j
                                             
                                          
                                          
                                             X
                                             2
                                          
                                          +
                                          ⋯
                                          +
                                          
                                             q
                                             Dj
                                          
                                          
                                             X
                                             D
                                          
                                       
                                    
                                    
                                       
                                       
                                          ⟶
                                          
                                             u
                                             
                                                1
                                                j
                                             
                                          
                                          
                                             X
                                             1
                                          
                                          +
                                          
                                             u
                                             
                                                2
                                                j
                                             
                                          
                                          
                                             X
                                             2
                                          
                                          +
                                          ⋯
                                          +
                                          
                                             u
                                             Dj
                                          
                                          
                                             X
                                             D
                                          
                                          ,
                                       
                                    
                                    
                                       
                                       
                                          for
                                          
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          r
                                       
                                    
                                 
                              
                           
                        The stoichiometric matrix S is a matrix with D rows and r columns. Its entries s
                        
                           ij
                        
                        =
                        u
                        
                           ij
                        
                        −
                        q
                        
                           ij
                         describe the net effect of reaction j to species X
                        
                           i
                        . In terms of ordinary differential equations (ODE) with [X] as the concentration of X this systems would read as
                           
                              
                                 
                                    
                                       d
                                       [
                                       X
                                       ]
                                       (
                                       t
                                       )
                                    
                                    dt
                                 
                                 =
                                 S
                                    
                                 v
                                 (
                                 [
                                 X
                                 ]
                                 ,
                                 t
                                 )
                                 ,
                                 
                                 [
                                 X
                                 ]
                                 (
                                 0
                                 )
                                 =
                                 
                                    X
                                    0
                                 
                              
                           
                        with a rate law 
                           v
                           =
                           
                              
                                 (
                                 
                                    v
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    v
                                    r
                                 
                                 )
                              
                              T
                           
                         and an initial concentration X
                        0.

Stochastic modeling focuses on numbers of particles and considers each reaction explicitly. The order of the reactions and the waiting time are stochastic quantities depending on the state of the system and the rate laws. Let x be the number of molecules of X. The associated rate law or hazard function 
                           
                              h
                              j
                           
                           (
                           x
                           ,
                           
                              v
                              j
                           
                           )
                         describes the probability for a reaction R
                        
                           j
                         of any of the participating species in the next small time step [t, t
                        +
                        dt]. The probability distribution of the number of molecules at a time point given an initial value is described by the so-called chemical master equation (CME). The CME is a system of difference-differential equations in which each ODE describes the probability of being in this state depending on time. For larger systems solving the CME is computationally prohibitive.

For simulating a stochastic time courses the Gillespie algorithm (Gillespie, 1976) is the method of choice. It is an iterative algorithm simulating reaction event after reaction event using functions of random numbers to determine the time step and the reaction. There exist a number of implementations (Pahle, 2009) of the Gillespie algorithm.

Stochastic modeling can show system's behavior which cannot be seen with ODE modeling: in the case of the genetic toggle switch stochastic modeling allows for transitions between the steady states of the deterministic interpretation (Fig. 1). This shows the importance of stochastic modeling and the need for parameter estimation methods tailored for stochastic modeling.

While the choice of the objective function in ODE modeling is widely discussed objective functions for stochastic modeling still are in the early phase of development.

One suggestion is the MSS method (Zimmer and Sahle, 2012). This method has been shown to be successful even in models which have a qualitatively different behavior in stochastic modeling than in ODE modeling. Assume that data 
                              
                                 ν
                                 obs
                              
                              =
                              (
                              
                                 ν
                                 0
                                 obs
                              
                              ,
                              …
                              ,
                              
                                 ν
                                 n
                                 obs
                              
                              )
                            is observed at time points t
                           0, t
                           1, …, t
                           
                              n
                           . The state of the system at time t
                           
                              i
                            is composed of the observed and unobserved species: ν
                           
                              i
                           
                           =(ν
                           obs, ν
                           hid). A model that describes the dynamical behavior of the system can be given as a set of reactions or the corresponding systems of ordinary differential equations:
                              
                                 (1)
                                 
                                    
                                       
                                          
                                             
                                                d
                                                dt
                                             
                                             x
                                             (
                                             t
                                             ;
                                             θ
                                             ,
                                             
                                                x
                                                0
                                             
                                             )
                                             =
                                             S
                                                
                                             v
                                             (
                                             x
                                             (
                                             t
                                             ;
                                             θ
                                             ,
                                             
                                                ν
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             )
                                             ,
                                             θ
                                             )
                                          
                                       
                                       
                                          
                                             
                                             x
                                             (
                                             0
                                             ;
                                             θ
                                             ,
                                             
                                                x
                                                0
                                             
                                             )
                                             =
                                             
                                                x
                                                0
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           with a stoichiometric matrix S and a rate law vector 
                              v
                            describing the speed of the reaction in dependence of the parameter θ.

We recently published an objective function for parameter estimation (Zimmer and Sahle, 2012) that decomposes the whole time series into intervals and fits to the intervals individually. The initial value for each interval is obtained by a state updating. We suggest a slightly more flexible state updating here, namely the state updating is performed as follows: choose a subset of the measurement time points: T
                           ⊆{t
                           0, t
                           1, …, t
                           
                              n
                           } and define the state update 
                              
                                 
                                    
                                       ν
                                       ˆ
                                    
                                 
                                 i
                              
                            at t
                           
                              i
                            as:
                              
                                 (2)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ν
                                                      ˆ
                                                   
                                                
                                                i
                                                obs
                                             
                                             =
                                             
                                                ν
                                                i
                                                obs
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ν
                                                      ˆ
                                                   
                                                
                                                i
                                                hid
                                             
                                             =
                                             x
                                             
                                                
                                                   (
                                                   
                                                      Δ
                                                      i
                                                   
                                                   ,
                                                   θ
                                                   ,
                                                   
                                                      
                                                         
                                                            ν
                                                            ˆ
                                                         
                                                      
                                                      
                                                         i
                                                         −
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                hid
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           for i
                           =1, …, n. The objective function for parameter estimation is then defined as
                              
                                 (3)
                                 
                                    
                                       F
                                       K
                                    
                                    (
                                    ν
                                    ,
                                    θ
                                    ,
                                    
                                       ν
                                       0
                                    
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       
                                          (
                                          x
                                          (
                                          
                                             Δ
                                             i
                                          
                                          ;
                                          θ
                                          ,
                                          
                                             
                                                
                                                   ν
                                                   ˆ
                                                
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          )
                                          −
                                          
                                             ν
                                             i
                                          
                                          )
                                       
                                       2
                                    
                                 
                              
                           with x as in Eq. (1), 
                              
                                 
                                    
                                       ν
                                       ˆ
                                    
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                            as in Eq. (2) and Δ
                           
                              i
                           
                           =
                           t
                           
                              i
                           
                           −
                           t
                           
                              i−1.

The MSS method is fully implemented in the software Hoops et al. (2006).

A second approach uses a diffusion approximation to approximate the transition between ν
                           
                              i−1 and ν
                           
                              i
                           . These transition probabilities are then used to evaluate a likelihood function. Latent data points are used to model unobserved components and are sampled with a Bayesian strategy. The method is described in Golightly and Wilkinson (2005) and the Monte Carlo scheme in Golightly and Wilkinson (2004). The CME is a set of equations describing the probability for each state of the systems in time dependence. It's numerical solution gives rise to the transition probability between succeeding states.

For comparison a least squares approach for parameter estimation is chosen, it is a least squares from a single shooting ODE integrated trajectory to the data:
                              
                                 
                                    
                                       F
                                       LSQ
                                    
                                    (
                                    ν
                                    ,
                                    
                                       ν
                                       0
                                    
                                    ,
                                    θ
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                       
                                    ‖
                                    
                                       x
                                       d
                                       obs
                                    
                                    (
                                    
                                       t
                                       i
                                    
                                    ;
                                    
                                       t
                                       0
                                    
                                    ,
                                    θ
                                    ,
                                    
                                       ν
                                       0
                                    
                                    )
                                    −
                                    
                                       ν
                                       i
                                       obs
                                    
                                    
                                       ‖
                                       2
                                       2
                                    
                                 
                              
                           which is frequently used for parameter estimation in systems biology (Moles et al., 2003)

@&#RESULTS@&#

The genetic toggle switch model (Gardner et al., 2000; Deuflhard et al., 2008) consists of 2 species and 4 reactions. While it rapidly converges to one of two stable steady state with ODE modeling stochastic modeling shows a switching behavior between the two steady states Fig. 1. The system of reactions reads as
                           
                              
                                 
                                    
                                       
                                          
                                             R
                                             1
                                          
                                          :
                                       
                                       
                                          ø
                                          →
                                          
                                             X
                                             1
                                          
                                          ,
                                       
                                       
                                          
                                             v
                                             1
                                          
                                          (
                                          x
                                          )
                                          =
                                          
                                             
                                                
                                                   θ
                                                   1
                                                
                                             
                                             
                                                5400
                                                +
                                                
                                                   x
                                                   2
                                                   
                                                      
                                                         θ
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             R
                                             2
                                          
                                          :
                                       
                                       
                                          
                                             X
                                             1
                                          
                                          →
                                          ø
                                          ,
                                       
                                       
                                          
                                             v
                                             2
                                          
                                          (
                                          x
                                          )
                                          =
                                          1.005
                                          ×
                                          
                                             10
                                             
                                                −
                                                3
                                             
                                          
                                          
                                             x
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             R
                                             3
                                          
                                          :
                                       
                                       
                                          ø
                                          →
                                          
                                             X
                                             2
                                          
                                          ,
                                       
                                       
                                          
                                             v
                                             3
                                          
                                          (
                                          x
                                          )
                                          =
                                          
                                             
                                                
                                                   θ
                                                   3
                                                
                                             
                                             
                                                5400
                                                +
                                                
                                                   x
                                                   1
                                                   
                                                      
                                                         θ
                                                         4
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             R
                                             4
                                          
                                          :
                                       
                                       
                                          
                                             X
                                             2
                                          
                                          →
                                          ø
                                          ,
                                       
                                       
                                          
                                             v
                                             4
                                          
                                          (
                                          x
                                          )
                                          =
                                          1.005
                                          ×
                                          
                                             10
                                             
                                                −
                                                3
                                             
                                          
                                          
                                             x
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        or written in ODE form
                           
                              (4)
                              
                                 
                                    
                                       
                                          dx
                                          1
                                       
                                       (
                                       t
                                       )
                                    
                                    dt
                                 
                                 =
                                 
                                    
                                       
                                          θ
                                          1
                                       
                                    
                                    
                                       5400
                                       +
                                       
                                          x
                                          2
                                          
                                             
                                                θ
                                                2
                                             
                                          
                                       
                                    
                                 
                                 −
                                 1.005
                                 ×
                                 
                                    10
                                    
                                       −
                                       3
                                    
                                 
                                    
                                 
                                    x
                                    1
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          dx
                                          2
                                       
                                       (
                                       t
                                       )
                                    
                                    dt
                                 
                                 =
                                 
                                    
                                       
                                          θ
                                          3
                                       
                                    
                                    
                                       5400
                                       +
                                       
                                          x
                                          1
                                          
                                             
                                                θ
                                                4
                                             
                                          
                                       
                                    
                                 
                                 −
                                 1.005
                                 ×
                                 
                                    10
                                    
                                       −
                                       3
                                    
                                 
                                    
                                 
                                    x
                                    2
                                 
                              
                           
                        Different scenarios of the genetic toggle switch are considered to compare the performance of dedicated stochastic and the LSQ method in a simulation study.

The first scenario (GT1) under consideration is a symmetric switching with parameter θ
                           (0)
                           =(1000, 2, 1000, 2) and initial value ν
                           0
                           =(114, 53). 100 measurements are used with an inter-sample distance Δt
                           =20,000. The second scenario (GT2) uses an asymmetric switching with X
                           1 being 10% of the time higher than X
                           2. The model is very sensitive towards the parameters so a slight change is sufficient to produce an asymmetry. The second scenario uses θ
                           (0)
                           =(1000, 2.01, 1000, 2), the rest of the setting is as in (GT1). Scenario (GT3) uses θ
                           (0)
                           =(1000, 2.025, 1000, 2) which produces an 1/100 asymmetric switching. (GT4) uses a switch with even lower particle numbers: θ
                           (0)
                           =(1500, 2, 1500, 2) and ν
                           0
                           =(22, 10). (GT5) uses the setting of scenario (GT1) but adds relative measurement noise – normally distributed with a variance of 0.1. Scenario (GT6) decreases the number of observations to 30 equally distributed observations on the same time horizon as (GT1). Scenario (GT7) considers a case in which only X
                           1 observed, other settings as in (GT1). (GT8) is as (GT7) plus relative measurement error, see Fig. 2
                           
                            for visualizations of the trajectories.

For each scenario 1000 times series are calculated with the Gillespie algorithm and considered as pseudo data. For each of the 1000 time series three estimations are performed: one with the MSS method, one with the diffusion approximation and one with the LSQ method. Averages and average relative error (ARE) of the resulting 1000 estimators for all methods are displayed in Tables 1–7
                           
                           
                           
                           
                           
                           
                           , where also a formal definition of the ARE can be found. Beside the ARE a second way to judge the quality of the estimates is the question whether they can produce trajectories which show a switching behavior as was seen in the corresponding pseudo data series. Therefore for each estimate of all, MSS, diffusion approximation and LSQ method, 50 time series are simulated stochastically with Gillespie's algorithm and it is checked which percentage shows a switching behavior. Furthermore the symmetry, more precisely the relative frequency of time points with X
                           1
                           >
                           X
                           2, is calculated. For all the 50×1000 values a density estimation is performed which is then compared to the density estimate of the original symmetry values.

It is important to note here that the stochastic simulations are only necessary for the simulation study to asses the performance of the methods. Once experimental data is given a parameter estimation is possible without any stochastic simulations.

The MSS and the LSQ objective functions are deterministic and only based on the integration of initial value problems. This means that in general all approaches from derivative based over global optimization to Bayesian methods can be applied. The choice of the method depends on the shape of the fitness function landscape and on the user's preferences as well as software availability. Test runs with a Levenberg Marquardt method resulted in lower (better) function values than an evolutionary programming algorithm (Fogel et al., 2004; Bäck and Schwefel, 1993; Bäck et al., 1997) with 500 iterations and a population size of 200 on a domain of (1, 106) in each dimension. The reason is that the landscape is quite smooth and therefore a derivative based method shows better convergence behavior than global methods. In the case of the LSQ functional the landscape is obviously not the same. Here most test runs with the Levenberg Marquardt algorithm got stuck in local minima having a significantly higher function value than the results of the Evolutionary Programming algorithms. Hence for the results shown here the MSS functional is optimized with the Levenberg Marquardt algorithm while the LSQ functional is optimized with the Evolutionary Programming algorithm. The diffusion approximation approach is embedded in a Bayesian framework and optimization performed with a Markov chain with 10,000 iterations.

This observation is indeed more than of technical interest as this might mean that the choice of the objective function even leads to a much faster optimization. A deeper investigation of this phenomenon is up to further research.

The symmetric scenario (GT1) shows a good accuracy with small relative errors for the MSS method and a lot higher relative errors for the LSQ approach. The percentage of estimates still able to reproduce a switching behavior is very close to the values of the true parameter for the MSS method and far off for the LSQ approach. The mean symmetry value is good for both but it is important to look at Fig. 5
                           
                            because this shows that only the MSS method captures the shape of the distribution while the LSQ leads to a completely different shape of the distribution.

The situation is similar for the 1/10-asymmetric scenario (GT2): the MSS method outperforms the LSQ method with respect to all considered measures. Is worth to note the shape of the density estimation of the symmetry value distribution from the LSQ estimates: for (GT1) it shows a high density at both sides which comes from the two steady states in the ODE model. For the 1/10-asymmetric switch almost all LSQ estimates correspond to the same steady state therefore resulting in simulations with a very small symmetry value meaning that the trajectory is almost always in the same steady state.

Even if the asymmetry is changed to 1/100, the MSS method shows good performance while the LSQ method fails to estimate the parameters accurately. Considering the 1% values in the other steady state as “outliers” this means that the LSQ method is not able to estimate the parameters even with a few “outliers”. The situation does not change a lot when considering switches with even lower particle numbers (GT4), noisy measurements (GT5) or fewer observation points (GT6): the MSS method is well able to estimate the parameters and reproduce the switching behavior while the LSQ method is not. For the symmetric switching situations (GT1), (GT5) the average number of switching per trajectory is 7 and ranging from 0 to 20 which means that 100 measurements will in most realizations be able to record every switching. If only 30 observations are recorded (GT6) in situations with a high number of switchings not all of them are recorded.

If the system is only partially observed (GT7) the MSS method is still able to estimate the parameters. There seems to be a valley in the direction of parameter θ
                           3 which makes the identifiability challenging as few of the θ
                           3 estimates converged to very high values. Rejecting these – namely 10 for full observation and 12 for partial observation – parameters due to physiological reasons shows that the ARE for the remaining data sets is acceptably small. Independent of that, the switching and symmetry behavior is correctly captured. The LSQ method fails with even higher error rates as before. (GT7) is the only scenario in which the methods produce estimates which lead to simulations with exploding trajectories, namely 0.2% for the MSS method and 4.4% for the LSQ method. Combining partial observability and measurement noise (GT8) leads to similar results as (GT7) which shows that the MSS method can cope with measurement noise (see Table 8
                           ).

The results for the Bayesian diffusion approximation can be found in the tables GT1–GT7, right column. They show that the relative error of the SDE method is even smaller than the ARE for the MSS method. However, the difference between SDE and MSS method is small compared to the difference of SDE and MSS to LSQ. Fig. 5 shows that the symmetry’ distributions of the switching behavior are better reproduced with the MSS method. This can be explained by looking at the correlation between the symmetry of the original data set and the symmetry of simulations with the estimated parameter. This correlation is for most scenarios higher (results not shown) for the diffusion approximation than for MSS. As within one scenario, all data origin from the same parameter, differences in the symmetry between data sets are due to the stochasticity. The estimates with the diffusion approximation reflect these differences stronger than the MSS’ estimates.

This is remarkable because it shows that precision in the relative error of the parameter estimates and precision in the reproduction of the symmetry do not need to be identical. Therefore, the choice between diffusion approximation and MSS depends on the interest of the user. However, a clear suggestion can be made with respect to the use of a dedicated stochastic method as the LSQ performed poor for both measures.

The immigration-death model consists of one species and two reactions
                           
                              
                                 
                                    
                                       
                                          
                                             R
                                             1
                                          
                                          :
                                       
                                       
                                          ø
                                          →
                                          X
                                          ,
                                       
                                       
                                          
                                             v
                                             1
                                          
                                          (
                                          x
                                          )
                                          =
                                          
                                             θ
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             R
                                             2
                                          
                                          :
                                       
                                       
                                          X
                                          →
                                          ø
                                          ,
                                       
                                       
                                          
                                             v
                                             2
                                          
                                          (
                                          x
                                          )
                                          =
                                          
                                             θ
                                             2
                                          
                                          x
                                       
                                    
                                 
                              
                           
                        or written in ODE form


                        
                           
                              (6)
                              
                                 
                                    
                                       dx
                                       (
                                       t
                                       )
                                    
                                    dt
                                 
                                 =
                                 
                                    θ
                                    1
                                 
                                 −
                                 
                                    θ
                                    2
                                 
                                 x
                              
                           
                        The system in ODE modeling converges towards a steady state described by the quotient of the parameters. For the comparison study it is investigated in three sets of parameter values, all with initial value x
                        0
                        =10. For each scenario 1000 time series are simulated with the Gillespie algorithm implemented in Copasi, see Fig. 3 for a visualization of the trajectories for the scenarios. For each of the time series an optimization is performed for the MSS and the sdtODE objective function. All optimization are performed with the FindMinimum routine in the software Mathematica (2015).


                        Table 9
                         display the mean and average relative error of the 1000 estimates for both approaches for the parameters θ
                        1, θ
                        2 and the quotient (θ
                        2/θ
                        1). The dynamic of scenario (ID1) is close to the ODE solution. In this case the LSQ approach leads to acceptable results. Nevertheless an application of fthe MSS method does not make the situation worse. The same holds for the CME except that the calculation time is increased. In scenario (ID2) both methods are able to identify the quotient of the parameters correctly. The absolute value can only be identified by the MSS method and the CME. Decreasing the inter sample distance leads to a scenario (ID3) in which the LSQ and the MSS methods cannot identify the absolute value correctly but the accuracy in estimating the quotient is better in the MSS method than in the LSQ. The CME based method is well able to estimate all parameters. The reason for the failure of the MSS method to estimate both parameters is that in scenario (ID3) basically no or only very few reactions happen between two time points of observations. Although this is a limitation from a theoretical point of view this situation will rarely occur in experimental setups. It can be resolved by either changing the inter sample distances (and being again in scenario (ID2)) or using more samples or including variances information in the estimation (not shown here).

Another scenario of the immigration-death model has been mentioned in Zimmer and Sahle (2012): if only steady state data is available the MSS method is still able to identify both parameters if the inter sample distance is chosen appropriately.

A standard model for describing the development of an epidemic reads as
                           
                              
                                 
                                    
                                       
                                          
                                             R
                                             1
                                          
                                          :
                                       
                                       
                                          S
                                          →
                                          I
                                          ,
                                       
                                       
                                          
                                             v
                                             1
                                          
                                          (
                                          S
                                          )
                                          =
                                          
                                             θ
                                             1
                                          
                                          S
                                       
                                    
                                    
                                       
                                          
                                             R
                                             2
                                          
                                          :
                                       
                                       
                                          I
                                          →
                                          R
                                          ,
                                       
                                       
                                          
                                             v
                                             2
                                          
                                          (
                                          I
                                          )
                                          =
                                          
                                             θ
                                             2
                                          
                                          I
                                       
                                    
                                 
                              
                           
                        or written in ODE form
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                dS
                                                (
                                                t
                                                )
                                             
                                             dt
                                          
                                          =
                                          −
                                          
                                             θ
                                             1
                                          
                                          S
                                          (
                                          t
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                dI
                                                (
                                                t
                                                )
                                             
                                             dt
                                          
                                          =
                                          
                                             θ
                                             1
                                          
                                          S
                                          (
                                          t
                                          )
                                          −
                                          
                                             θ
                                             2
                                          
                                          I
                                          (
                                          t
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                dR
                                                (
                                                t
                                                )
                                             
                                             dt
                                          
                                          =
                                          
                                             θ
                                             2
                                          
                                          I
                                          (
                                          t
                                          )
                                       
                                    
                                 
                              
                           
                        with the constraint S(t)+
                        I(t)+
                        R(t)=
                        N and a total number of N individuals.

As in the previous examples 100 trajectories are stochastically simulated with the Gillespie algorithm (Gillespie, 1976), see Fig. 4 for a visualization, and 100 estimations are performed. Statistical quantities of the resulting 100 parameter estimates for each method can be found in Table 10
                        . Table 10 shows that in this example all three methods are able to estimate the parameters with more or less the same accuracy. This shows that special parameter estimation methods are not always necessary for obtaining the highest accuracy.

@&#DISCUSSION@&#

The article compares methods for parameter estimation on stochastic models of a genetic toggle switch, an immigration-death model and an epidemics model. One method is the MSS method which is designed for parameter estimation in stochastic models. The method is able to estimate parameters even in models which behave qualitatively different in stochastic modeling than in ODE modeling (Kummer et al., 2005). The data which is used as input for the method is a single stochastic trajectory which might be well different from the mean behavior or other stochastic realizations. The advantage of the objective function is that it does not need stochastic simulations nor a solution of a high dimensional CME which increases its speed. Hence it is well applicable in large realistic size models which would be very time consuming in simulation based methods. For the numerical optimization this allows the user to choose between various numerical optimization methods such as derivative based methods, global optimization techniques or Bayesian methods. As the approach is implemented in Hoops et al. (2006), this allows for an easy SMBL model import and further analysis features.

This method is compared to a diffusion approximation based Bayesian approach, a CME based technique and a LSQ objective function. While the first two are also suited to intrinsic stochasticity, the last is designed for ODE models but still widely used due to its easy availability. To compare the approaches taking into account effects of the intrinsic stochasticity, 1000 stochastic simulations are performed with the Gillespie algorithm in Copasi. For all of them estimates are calculated with the objective functions resulting in 1000 estimates for each method. A comparison is based on relative error to the true parameter values. Furthermore in the genetic toggle switch it is investigated whether the resulting estimates are able to reproduce the switching behavior of the original data.

In all considered genetic toggle switch scenarios (GT1–GT8) the MSS method and the diffusion approximation outperformed the LSQ method significantly. Both methods succeeded to estimate the parameters accurately for all genetic toggle switch scenarios, however, the diffusion approximation lead to slightly lower AREs, whereas the MSS method was able to produce parameter estimates that could reproduce the switching behavior of the original data better. This can be explained by the diffusion approximation leading to estimates that closely reflect the symmetry of the specific data set and its stochastic fluctuations. The LSQ method failed to do this in all scenarios.

The second example is an immigration-death model that is small enough that the chemical master equation can be employed leading to an exact estimate. Depending on the parametrization, we can produce scenarios, in which the three methods (CME, MSS and LSQ) are successful (ID1), in which CME and MSS are successful (ID2) and, in which only the CME is successful (ID3). The reason is that ID1 shows enough transient data points that are necessary for the LSQ to identify both parameters. ID2 and ID3 show mainly steady state data which leads to a non identifiability for LSQ. If the observation horizon is long enough, the MSS method can extract information from the intrinsic fluctuations and both parameters are identifiable. If the observation horizon is shorter with a same number of sample points, this leads to a dense design of observation points so that only a few reactions happen between two observations which is a limitation for the MSS method, and so only the CME method is successful for ID3.

The SIR model also falls also in the category of models that are small enough for an application of the CME method. The SIR model is a model that shows only few intrinsic stochastic effects, and therefore, CME, MSS and LSQ produce a satisfying accuracy here. This shows that an application of stochastic methods does not always lead to an higher accuracy. However, there is, in case of doubt, no harm in its application as the MSS method is from a computational point of view as fast as conventional parameter estimation methods for deterministic models due to its structure.

As parameter estimation methods for stochastic models are not very commonly available one might be tempted to use the results of a conventional parameter estimation method. However our results indicate that this is generally not feasible. As we tried to use the parameter estimates of the LSQ approach as input for stochastic simulations of the genetic toggle switch, we saw that these stochastic simulations were not able to reproduce the switching behavior. This means that the estimates obtained by the LSQ method are not able to capture one of the most important features of this model. As the MSS method is able to capture this feature and the diffusion approximation at least a lot better than the LSQ, we strongly recommend their use for parameter estimation in stochastic models.

@&#ACKNOWLEDGEMENTS@&#

This work is supported by BIOMS and the Klaus Tschira Stiftung.

@&#REFERENCES@&#

