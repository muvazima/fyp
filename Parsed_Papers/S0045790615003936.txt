@&#MAIN-TITLE@&#Self-localization of autonomous underwater vehicles with accurate sound travel time solution

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           RTR causes large ranging error.


                        
                        
                           
                           AOA and AUV's orientation are processed to produce accurate OWTT.


                        
                        
                           
                           Mathematical expectation of underwater sound speed reasonably catches its uncertainty.


                        
                        
                           
                           LMA serves as an effective ranging optimizer to localize the AUV.


                        
                        
                           
                           The strategy is sensitive to time measurement noise and less affected by angle measurement noise.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Underwater acoustic sensor networks

Autonomous underwater vehicles

Self-localization

Sound travel time

Ranging optimization

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           Image, graphical abstract
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

In underwater acoustic sensor networks (UASNs), autonomous underwater vehicles (AUVs) have been increasingly gaining concerns, as they make it accessible to those untouchable areas for human beings and assist with complex and arduous ocean tasks. AUVs are untethered and intelligent mobile platforms [1]. In many scenarios like target tracking [2], AUV-aid localization [3], and demining etc., AUVs need accurate localization for the accuracy of the gathered data [4]. And due to tough underwater conditions and technical restrictions, to localize a moving AUV is still challenging and needs more complementary researches.

Since the global position system (GPS) cannot work underwater because of bad attenuation of radio frequency (RF) signals, the inertial navigation system (INS) is mostly applied on AUVs. INS suffers from error accumulation. High-quality INS is however greatly expensive and can only provide relative locations. Overall, it is a better and available scheme to take advantage of acoustic communication for AUVs self-localization [5].

Acoustic localization system for AUVs includes long baseline (LBL), short baseline (SBL) and ultra-short baseline (USBL). Compared with SBL and USBL, LBL is more cost-effective [4]. In LBL, AUVs communicates with one or more transponders fixed on the seabed to measure range information and achieve self-localization. One-way ranging is mostly based on time of arrival (ToA) and time difference of arrival (TDoA). ToA needs strict time-synchronization, which is energy-intensive and hard to achieve. Multiple-node cooperation in TDoA [6,7] increases cost and is computationally complex. The round-trip ranging (RTR) technology [8] is frustrated by the long propagation delay and AUVs’ mobility. In RTR, the two-way travel time (TWTT) between the AUV and a transponder is halved as the one-way travel time (OWTT), which is the propagation delay of acoustic signals traveling from the AUV to a transponder or the opposite case. Consequently the ranging error is increased since the AUV has sailed away from where it signals. But many approaches ignored this e.g. [6,7,9]. Moreover, the underwater sound speed is no constant but varies with salinity, temperature and depth [10], which adds uncertainty of location estimates.

To solve these problems stated above, we propose a self-localization algorithm with accurate sound travel time solution (SL-STTS) for AUVs in shallow water (depth < 500 m). SL-STTS is time-synchronization free. The ranging accuracy relies on precise time measurement. It is accessible in microsecond resolution with seabed transponders [11] whose locations are known in advance with some technologies e.g. [12]. Orientation for the AUV and angle of arrival (AoA) for acoustic signals from transponders are analyzed to calculate the OWTT. As we know, the error of OWTT estimation in milliseconds may cause error of distance estimation in meters, which weakens localization accuracy. So it's indispensable to work out a high performance sound travel time solution. We model the function relating the distance estimates to the location vector of AUV. The Levenberg–Marquardt algorithm (LMA) [13] is utilized to optimize the distance estimates.

Our main contribution is as follows. First, the time-synchronization free scheme is presented which saves energy used for frequent two-way packet exchange in the time-synchronization ones. Second, the accurate sound travel time solution is proposed which improves ranging and localization accuracy. Third, we analyze the mathematical expectation of underwater sound speed, employ it for distance estimation and further analyze the rationality in theory. Fourth, we employ the LMA in solving the non-linear least squares optimization problem and localizing the AUV. SL-STTS can also be used in recalibrating the INS without resurfacing.

A reminder of this paper presents as follows: the related work are reviewed in Section 2. Section 3 gives an overview of the proposed algorithm and expatiates on how an AUV localizes itself. The performance of our algorithm is discussed in Section 4. Next a conclusion and the future efforts are summarized in Section 5.

@&#RELATED WORK@&#

Recent years, problems of AUVs localization have been studied extensively. In this section algorithms concerning AUVs localization presented in recent works are briefly reviewed.

In underwater area, acoustic signal is an ideal information carrier for it is less attenuated and can travel longer distances [14]. All underwater acoustic localization systems suffer most from sound speed uncertainty. In [10] the relation between OWTT and AUV location was modeled on the isogradient sound speed profile and Snell's law. Based on this model, the extend Kalman filter (EKF) was used to localize the AUV. Kussat et al. [11] conducted a series of sea trails in shallow water. They investigated the sources (salinity, temperature and depth) leading to sound speed uncertainty. Sound propagation ray trace was studied in [15] to model depth-dependent sound speed profile.

Based on unknown-but-bounded uncertainty and distance estimates, Caiti et al. [16] calculated out the region where the AUV resides. Then the sound propagation ray path was analyzed to obtain how the varying sound speed affected such region. Liu et al. [5] studied coordinated localization for multiple AUVs based on TDoA technology. In [15] a non-linear least squares estimator using the Newton's method was performed to give location estimates based on the ToA measurements. Meanwhile a gradient descent algorithm was adopted to improve the estimates. Karimi et al. [17] adopted a two-loop decentralized data fusion method. EKF worked in both loops to estimate locations of the AUV with its information of velocity, orientation and depth. A decentralized information filter did the final fusion of the estimates produced in both loops. Eustice et al. [18] proposed a max likelihood sensor fusion method based on the OWTT information, but it needs synchronous clock and surface ships as GPS to assist underwater localization, which is not economical.

Those algorithms listed above well disposes the localization uncertainties caused by measurement noise by means of denoising. The ranging optimization in this work is motivated by this point, for the main challenge that confronts LBL is the ranging uncertainty.

However, the above methods solve the OWTT through mathematically analyzing RTR, ToA or TDoA, which meets limitations stated in Section 1. Especially the RTR technology may trigger large ranging error. One major difference between this work and the above methods is that this problem has been considered and addressed well by the proposed sound travel time solution. And in the above approaches, the sound speed uncertainty is either processed with complicated computation or not given enough consideration. However, this work proposes a more simple way to estimate the sound speed.

In this work we focus on AUVs self-localization in shallow water (depth < 500 m). The orientation of an AUV includes yaw angle, pitch angle and roll angle [17]. In this work we only need the information of yaw angle and pitch angle. All the locations and angles are computed in the global Cartesian coordinates. The AUV is equipped with sensors measuring its forward velocity, z-axis gyro and inclinometer measuring its yaw angle and pitch angle [2,17], and AoA antennas measuring AoA of received acoustic signals. Conductivity–temperature–depth (CTD) instruments [11] are preloaded onto the AUV and transponders to help estimate sound speed by measuring salinity, temperature and depth. We first take an overview on SL-STTS and afterwards demonstrate how SL-STTS works in detail.

The AUV localizes itself through acoustic communication with seabed transponders. The network model is given in Fig. 1.
                        
                     

Consider the case that an AUV travels with velocity V in a three-dimensional (3D) underwater environment. At time instant t, the AUV locates at 
                           
                              
                                 M
                                 t
                              
                              
                              :
                              
                                 (
                                 
                                    
                                       x
                                       
                                          M
                                          t
                                       
                                    
                                    ,
                                    
                                       y
                                       
                                          M
                                          t
                                       
                                    
                                    ,
                                    
                                       z
                                       
                                          M
                                          t
                                       
                                    
                                 
                                 )
                              
                           
                         undetermined. It broadcasts a localization request, meanwhile starts a timer and measures the sound speed c(TAUV, sAUV, zAUV
                        ). Assume that there are w (w ≥ 3) transponders receiving this request and define the set as 
                           
                              A
                              =
                              {
                              
                                 a
                                 i
                              
                              }
                           
                        , 
                           
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              w
                           
                        , where i is the identifier (ID) of transponder ai
                         with known location 
                           
                              
                                 A
                                 i
                              
                              
                              :
                              
                                 (
                                 
                                    
                                       x
                                       
                                          a
                                          i
                                       
                                    
                                    ,
                                    
                                       y
                                       
                                          a
                                          i
                                       
                                    
                                    ,
                                    
                                       z
                                       
                                          a
                                          i
                                       
                                    
                                 
                                 )
                              
                           
                        .

For transponder ai
                         as an example. After ai
                         receives the request at its local time 
                           
                              t
                              1
                              i
                           
                        , it puts its ID, the sound speed measured by CTD and its location into a localization packet Φi
                        . At its local time 
                           
                              t
                              2
                              i
                           
                        , it adds the leaving time 
                           
                              t
                              2
                              i
                           
                         into Φi
                         as soon as it responds to the AUV with Φi
                        . The AUV receives Φi
                         at its local time 
                           
                              t
                              3
                              i
                           
                        . When the timer is out, the AUV stops receiving replies from transponders and processes the received localization packets.

Assume the communication range of AUV to be R. The maximum TWTT of an acoustic signal between the AUV and transponder ai
                         is 
                           
                              2
                              R
                              /
                              c
                              (
                              
                                 
                                    T
                                    
                                       A
                                       U
                                       V
                                    
                                 
                                 ,
                                 
                                    s
                                    
                                       A
                                       U
                                       V
                                    
                                 
                                 ,
                                 
                                    z
                                    
                                       A
                                       U
                                       V
                                    
                                 
                              
                              )
                              +
                              α
                           
                        , where α is the max time needed for transponders to process acoustic signals and prestored by the AUV. Thus the timer period can be defined as

                           
                              (1)
                              
                                 
                                    t
                                    i
                                    m
                                    e
                                    r
                                    
                                    p
                                    e
                                    r
                                    i
                                    o
                                    d
                                    =
                                    2
                                    R
                                    /
                                    c
                                    
                                       (
                                       
                                          
                                             T
                                             
                                                A
                                                U
                                                V
                                             
                                          
                                          ,
                                          
                                             s
                                             
                                                A
                                                U
                                                V
                                             
                                          
                                          ,
                                          
                                             z
                                             
                                                A
                                                U
                                                V
                                             
                                          
                                       
                                       )
                                    
                                    +
                                    α
                                 
                              
                           
                        
                     

From Fig. 1 we can observe that due to the AUV's motion, when the AUV receives Φi
                         at 
                           
                              t
                              3
                              i
                           
                        , it may have moved to the next location. Thus the OWTT of an acoustic signal traveling from the AUV to a transponder may not equal the opposite case. And since the time is not synchronized between transponders and the AUV, the OWTT cannot be calculated with single 
                           
                              
                                 t
                                 1
                                 i
                              
                              −
                              t
                           
                         or 
                           
                              
                                 t
                                 3
                                 i
                              
                              −
                              
                                 t
                                 2
                                 i
                              
                           
                        .

Generally, SL-STTS performs in two steps, (a) ranging and (b) optimization and iterative localization. Next we will give the detail process.

The AUV first broadcasts a localization request to estimate distances relative to transponders. The ranging step includes three stages: OWTT estimation, sound speed estimation and distance estimation.

The AUV measures the TWTT Δti
                            based on transponder ai
                            with

                              
                                 (2)
                                 
                                    
                                       Δ
                                       
                                          t
                                          i
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                t
                                                3
                                                i
                                             
                                             −
                                             t
                                          
                                          )
                                       
                                       −
                                       
                                          (
                                          
                                             
                                                t
                                                2
                                                i
                                             
                                             −
                                             
                                                t
                                                1
                                                i
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        

In the RTR technology usually used in other algorithms, Δti
                           /2 is taken as the OWTT, which may cause large ranging error.

When the AUV receives Φi
                           , it has moved from Mt
                            to 
                              
                                 
                                    M
                                    
                                       t
                                       3
                                       i
                                    
                                 
                                 
                                 :
                                 
                                    (
                                    
                                       
                                          x
                                          
                                             M
                                             
                                                t
                                                3
                                                i
                                             
                                          
                                       
                                       ,
                                       
                                          y
                                          
                                             M
                                             
                                                t
                                                3
                                                i
                                             
                                          
                                       
                                       ,
                                       
                                          z
                                          
                                             M
                                             
                                                t
                                                3
                                                i
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                            as shown in Fig. 2
                           . For simplicity we assume V to be a constant. Thus the traveling distance of AUV is

                              
                                 (3)
                                 
                                    
                                       
                                          D
                                          i
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                t
                                                3
                                                i
                                             
                                             −
                                             t
                                          
                                          )
                                       
                                       ·
                                       V
                                    
                                 
                              
                           
                        

Define the OWTT of a signal traveling from the AUV (at Mt
                           ) to transponder ai
                            as 
                              
                                 t
                                 i
                                 
                                    P
                                    D
                                    t
                                 
                              
                           , from transponder ai
                            to the AUV (at 
                              
                                 M
                                 
                                    t
                                    3
                                    i
                                 
                              
                           ) as 
                              
                                 t
                                 i
                                 
                                    P
                                    D
                                    f
                                 
                              
                           . Obviously 
                              
                                 t
                                 i
                                 
                                    P
                                    D
                                    t
                                 
                              
                            and 
                              
                                 t
                                 i
                                 
                                    P
                                    D
                                    f
                                 
                              
                            may not be equal. Redefined the TWTT model as

                              
                                 (4)
                                 
                                    
                                       Δ
                                       
                                          t
                                          i
                                       
                                       =
                                       
                                          t
                                          i
                                          
                                             P
                                             D
                                             t
                                          
                                       
                                       +
                                       
                                          t
                                          i
                                          
                                             P
                                             D
                                             f
                                          
                                       
                                       =
                                       2
                                       
                                          t
                                          i
                                          
                                             P
                                             D
                                             t
                                          
                                       
                                       +
                                       
                                          
                                             ɛ
                                          
                                          i
                                       
                                    
                                 
                              
                           
                        

It's clear that 
                              
                                 
                                    
                                       ɛ
                                    
                                    i
                                 
                                 =
                                 
                                    t
                                    i
                                    
                                       P
                                       D
                                       f
                                    
                                 
                                 −
                                 
                                    t
                                    i
                                    
                                       P
                                       D
                                       t
                                    
                                 
                              
                           .

In Fig. 2, let βi
                            denote the angle between vectors 
                              
                                 
                                    
                                       A
                                       i
                                    
                                    
                                       M
                                       
                                          t
                                          3
                                          i
                                       
                                    
                                 
                                 →
                              
                            and 
                              
                                 
                                    
                                       M
                                       t
                                    
                                    
                                       M
                                       
                                          t
                                          3
                                          i
                                       
                                    
                                 
                                 →
                              
                           . Define the elevation AoA and azimuth AoA of the received acoustic signal from transponder ai
                            be ϕi
                            and φ
                              i
                           , which are measured from the positive Z-axis and X-axis by AoA antennas, respectively. Since in shallow water the ray trace of sound can be treated as straight line [15], the values of direction cosine for 
                              
                                 
                                    
                                       A
                                       i
                                    
                                    
                                       M
                                       
                                          t
                                          3
                                          i
                                       
                                    
                                 
                                 →
                              
                            along X-axis, Y-axis and Z-axis are sin ϕi
                           cos φ
                              i
                           , sin ϕi
                           sin φ
                              i
                            and cos ϕi
                           , respectively [19].

The pitch angle θi
                            and yaw angle ψi
                            of an AUV can be measured by inclinometer and z-axis gyro [2,17]. As illustrated in Fig. 3
                           , θi
                            and ψi
                            are the rotation about the Yl
                           -axis and Zl
                           -axis in the AUV's local coordinates, respectively. The only difference between the AUV's local coordinates and the global Cartesian coordinates is that Zl
                           -axis is in the opposite direction of Z-axis. Thus in the global Cartesian coordinates, the pitch angle of AUV is 
                              
                                 π
                                 −
                                 
                                    θ
                                    i
                                 
                              
                            and the yaw angle is still ψi
                           .

In the ideal case, the AUV doesn't change its orientation (next we will analyze the case where the AUV changes its orientation). Similar to 
                              
                                 
                                    
                                       A
                                       i
                                    
                                    
                                       M
                                       
                                          t
                                          3
                                          i
                                       
                                    
                                 
                                 →
                              
                           , the values of direction cosine for 
                              
                                 
                                    
                                       M
                                       t
                                    
                                    
                                       M
                                       
                                          t
                                          3
                                          i
                                       
                                    
                                 
                                 →
                              
                            along X-axis, Y-axis and Z-axis are 
                              
                                 sin
                                 
                                    (
                                    
                                       π
                                       −
                                       
                                          θ
                                          i
                                       
                                    
                                    )
                                 
                                 cos
                                 
                                    ψ
                                    i
                                 
                              
                           , 
                              
                                 sin
                                 
                                    (
                                    
                                       π
                                       −
                                       
                                          θ
                                          i
                                       
                                    
                                    )
                                 
                                 sin
                                 
                                    ψ
                                    i
                                 
                              
                            and 
                              
                                 cos
                                 (
                                 
                                    π
                                    −
                                    
                                       θ
                                       i
                                    
                                 
                                 )
                              
                           , respectively.

Define the unit vectors with the same direction as 
                              
                                 
                                    
                                       A
                                       i
                                    
                                    
                                       M
                                       
                                          t
                                          3
                                          i
                                       
                                    
                                 
                                 →
                              
                            and 
                              
                                 
                                    
                                       M
                                       t
                                    
                                    
                                       M
                                       
                                          t
                                          3
                                          i
                                       
                                    
                                 
                                 →
                              
                            be λ and κ respectively. Then we can get

                              
                                 (5a)
                                 
                                    
                                       λ
                                       =
                                       
                                          (
                                          
                                             sin
                                             
                                                ϕ
                                                i
                                             
                                             cos
                                             
                                                φ
                                                i
                                             
                                             ,
                                             sin
                                             
                                                ϕ
                                                i
                                             
                                             sin
                                             
                                                φ
                                                i
                                             
                                             ,
                                             cos
                                             
                                                ϕ
                                                i
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                           
                              
                                 (5b)
                                 
                                    
                                       κ
                                       =
                                       
                                          (
                                          
                                             sin
                                             
                                                (
                                                
                                                   π
                                                   −
                                                   
                                                      θ
                                                      i
                                                   
                                                
                                                )
                                             
                                             cos
                                             
                                                ψ
                                                i
                                             
                                             ,
                                             sin
                                             
                                                (
                                                
                                                   π
                                                   −
                                                   
                                                      θ
                                                      i
                                                   
                                                
                                                )
                                             
                                             sin
                                             
                                                ψ
                                                i
                                             
                                             ,
                                             c
                                             o
                                             s
                                             
                                                (
                                                
                                                   π
                                                   −
                                                   
                                                      θ
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        

the cosine value of angle βi
                            is

                              
                                 (6)
                                 
                                    
                                       cos
                                       
                                          β
                                          i
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                      i
                                                   
                                                   
                                                      M
                                                      
                                                         t
                                                         3
                                                         i
                                                      
                                                   
                                                
                                                →
                                             
                                             ·
                                             
                                                
                                                   
                                                      M
                                                      t
                                                   
                                                   
                                                      M
                                                      
                                                         t
                                                         3
                                                         i
                                                      
                                                   
                                                
                                                →
                                             
                                          
                                          
                                             
                                                |
                                                
                                                   
                                                      
                                                         A
                                                         i
                                                      
                                                      
                                                         M
                                                         
                                                            t
                                                            3
                                                            i
                                                         
                                                      
                                                   
                                                   →
                                                
                                                |
                                             
                                             
                                                |
                                                
                                                   
                                                      
                                                         M
                                                         t
                                                      
                                                      
                                                         M
                                                         
                                                            t
                                                            3
                                                            i
                                                         
                                                      
                                                   
                                                   →
                                                
                                                |
                                             
                                          
                                       
                                       =
                                       λ
                                       ·
                                       κ
                                    
                                 
                              
                           
                        

Namely instead of vectors 
                              
                                 
                                    
                                       A
                                       i
                                    
                                    
                                       M
                                       
                                          t
                                          3
                                          i
                                       
                                    
                                 
                                 →
                              
                            and 
                              
                                 
                                    
                                       M
                                       t
                                    
                                    
                                       M
                                       
                                          t
                                          3
                                          i
                                       
                                    
                                 
                                 →
                              
                           , we can use their unit vectors to measure the cosine value of βi
                           . From Fig. 2 we can see that 
                              
                                 
                                    β
                                    i
                                 
                                 =
                                 ∠
                                 
                                    A
                                    i
                                 
                                 
                                    M
                                    
                                       t
                                       3
                                       i
                                    
                                 
                                 
                                    M
                                    t
                                 
                              
                           . According to the cosine law and combining formula (4), the cosine value of βi
                            can also be calculated as

                              
                                 (7)
                                 
                                    
                                       
                                          
                                             
                                                cos
                                                
                                                   β
                                                   i
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   
                                                      M
                                                      t
                                                   
                                                   
                                                      M
                                                      
                                                         
                                                            t
                                                            3
                                                            i
                                                         
                                                      
                                                      2
                                                   
                                                   +
                                                   
                                                      A
                                                      i
                                                   
                                                   
                                                      M
                                                      
                                                         
                                                            t
                                                            3
                                                            i
                                                         
                                                      
                                                      2
                                                   
                                                   −
                                                   
                                                      A
                                                      i
                                                   
                                                   
                                                      
                                                         
                                                            M
                                                            t
                                                         
                                                      
                                                      2
                                                   
                                                
                                                
                                                   2
                                                   ·
                                                   
                                                      M
                                                      t
                                                   
                                                   
                                                      M
                                                      
                                                         t
                                                         3
                                                         i
                                                      
                                                   
                                                   ·
                                                   
                                                      A
                                                      i
                                                   
                                                   
                                                      M
                                                      
                                                         t
                                                         3
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   
                                                      D
                                                      i
                                                      2
                                                   
                                                   +
                                                   Δ
                                                   
                                                      t
                                                      i
                                                   
                                                   
                                                      
                                                         ɛ
                                                      
                                                      i
                                                   
                                                   
                                                      C
                                                      2
                                                   
                                                
                                                
                                                   
                                                      D
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         Δ
                                                         
                                                            t
                                                            i
                                                         
                                                         +
                                                         
                                                            
                                                               ɛ
                                                            
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   C
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where C is the sound speed estimated by formula (12). It leads to ɛ
                              i
                            by substituting formulas (2), (3) and (6) into formula (7). Combining formula (4), 
                              
                                 t
                                 i
                                 
                                    P
                                    D
                                    t
                                 
                              
                            and 
                              
                                 t
                                 i
                                 
                                    P
                                    D
                                    f
                                 
                              
                            can be further solved out.

It is noteworthy that when the AUV receives the reply from transponder ai
                           , its orientation may have changed, as shown in Fig. 4
                           . Thus in this case, we should reconsider the vectors 
                              
                                 
                                    
                                       M
                                       t
                                    
                                    
                                       M
                                       
                                          t
                                          3
                                          i
                                       
                                    
                                 
                                 →
                              
                            and κ.

In Fig. 4, the orientation of AUV at time t and 
                              
                                 t
                                 3
                                 i
                              
                            can be denoted by 3D vectors 
                              
                                 
                                    
                                       M
                                       t
                                    
                                    
                                       M
                                       ′
                                    
                                 
                                 →
                              
                            and 
                              
                                 
                                    
                                       M
                                       ′
                                    
                                    
                                       M
                                       
                                          t
                                          3
                                          i
                                       
                                    
                                 
                                 →
                              
                            respectively. It is clear that

                              
                                 (8)
                                 
                                    
                                       
                                          
                                             
                                                M
                                                t
                                             
                                             
                                                M
                                                
                                                   t
                                                   3
                                                   i
                                                
                                             
                                          
                                          →
                                       
                                       =
                                       
                                          
                                             
                                                M
                                                t
                                             
                                             
                                                M
                                                ′
                                             
                                          
                                          →
                                       
                                       +
                                       
                                          
                                             
                                                M
                                                ′
                                             
                                             
                                                M
                                                
                                                   t
                                                   3
                                                   i
                                                
                                             
                                          
                                          →
                                       
                                    
                                 
                              
                           
                        

Define the unit vectors of 
                              
                                 
                                    
                                       M
                                       t
                                    
                                    
                                       M
                                       ′
                                    
                                 
                                 →
                              
                            and 
                              
                                 
                                    
                                       M
                                       ′
                                    
                                    
                                       M
                                       
                                          t
                                          3
                                          i
                                       
                                    
                                 
                                 →
                              
                            be λ
                           1 and λ
                           2 respectively. Thus we can get

                              
                                 (9)
                                 
                                    
                                       κ
                                       =
                                       
                                          λ
                                          1
                                       
                                       +
                                       
                                          λ
                                          2
                                       
                                    
                                 
                              
                           
                        


                           λ
                           1 and λ
                           2 can be calculated with the same principle as λ (see formula (5a)).

In underwater environment the sound speed varies with salinity, temperature and depth. The empirical model of sound speed is [6]
                           
                              
                                 (10)
                                 
                                    
                                       
                                          
                                             
                                                c
                                                
                                                   (
                                                   
                                                      T
                                                      ,
                                                      s
                                                      ,
                                                      h
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                1492.9
                                                +
                                                3
                                                
                                                   (
                                                   
                                                      T
                                                      −
                                                      10
                                                   
                                                   )
                                                
                                                −
                                                6
                                                ·
                                                
                                                   10
                                                   
                                                      −
                                                      3
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         T
                                                         −
                                                         10
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                −
                                                4
                                                ·
                                                
                                                   10
                                                   
                                                      −
                                                      2
                                                   
                                                
                                                ·
                                                
                                                   
                                                      (
                                                      
                                                         T
                                                         −
                                                         18
                                                      
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                1.2
                                                
                                                   (
                                                   
                                                      s
                                                      −
                                                      35
                                                   
                                                   )
                                                
                                                −
                                                
                                                   10
                                                   
                                                      −
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   
                                                      T
                                                      −
                                                      18
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      s
                                                      −
                                                      35
                                                   
                                                   )
                                                
                                                +
                                                h
                                                /
                                                61
                                             
                                          
                                       
                                    
                                 
                              
                           where T, s, h are temperature, salinity and depth respectively. With formula (10), the sound speed for the AUV and transponder ai
                            which are c(TAUV, sAUV, zAUV
                           ) and 
                              
                                 c
                                 (
                                 
                                    
                                       T
                                       
                                          a
                                          i
                                       
                                    
                                    ,
                                    
                                       s
                                       
                                          a
                                          i
                                       
                                    
                                    ,
                                    
                                       z
                                       
                                          a
                                          i
                                       
                                    
                                 
                                 )
                              
                            can be calculated after measuring the according parameters.

In shallow water, the sound speed can be assumed to vary pseudo-linearly with depth. It decreases continuously and monotonically [15]. Thus it obviously obeys the uniform distribution. Define 
                              
                                 
                                    c
                                    max
                                 
                                 =
                                 m
                                 a
                                 x
                                 
                                    (
                                    
                                       c
                                       
                                          (
                                          
                                             
                                                T
                                                
                                                   A
                                                   U
                                                   V
                                                
                                             
                                             ,
                                             
                                                s
                                                
                                                   A
                                                   U
                                                   V
                                                
                                             
                                             ,
                                             
                                                z
                                                
                                                   A
                                                   U
                                                   V
                                                
                                             
                                          
                                          )
                                       
                                       ,
                                       c
                                       
                                          (
                                          
                                             
                                                T
                                                
                                                   a
                                                   i
                                                
                                             
                                             ,
                                             
                                                s
                                                
                                                   a
                                                   i
                                                
                                             
                                             ,
                                             
                                                z
                                                
                                                   a
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                    
                                    )
                                 
                              
                            and 
                              
                                 
                                    c
                                    min
                                 
                                 =
                                 min
                                 
                                    (
                                    
                                       c
                                       
                                          (
                                          
                                             
                                                T
                                                
                                                   A
                                                   U
                                                   V
                                                
                                             
                                             ,
                                             
                                                s
                                                
                                                   A
                                                   U
                                                   V
                                                
                                             
                                             ,
                                             
                                                z
                                                
                                                   A
                                                   U
                                                   V
                                                
                                             
                                          
                                          )
                                       
                                       ,
                                       c
                                       
                                          (
                                          
                                             
                                                T
                                                
                                                   a
                                                   i
                                                
                                             
                                             ,
                                             
                                                s
                                                
                                                   a
                                                   i
                                                
                                             
                                             ,
                                             
                                                z
                                                
                                                   a
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                    
                                    )
                                 
                              
                           . The probability density function of sound speed c at interval [c
                           min , c
                           max ] is

                              
                                 (11)
                                 
                                    
                                       
                                          f
                                          i
                                       
                                       
                                          (
                                          c
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      1
                                                      /
                                                      (
                                                      
                                                         c
                                                         max
                                                      
                                                      −
                                                      
                                                         c
                                                         min
                                                      
                                                      )
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      c
                                                      ∈
                                                      
                                                         [
                                                         
                                                            
                                                               c
                                                               min
                                                            
                                                            ,
                                                            
                                                               c
                                                               max
                                                            
                                                         
                                                         ]
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      o
                                                      t
                                                      h
                                                      e
                                                      r
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

and hence the mathematical expectation of sound speed is

                              
                                 (12)
                                 
                                    
                                       
                                          E
                                          i
                                       
                                       
                                          (
                                          c
                                          )
                                       
                                       =
                                       
                                          ∫
                                          
                                             
                                                c
                                                min
                                             
                                          
                                          
                                             c
                                             max
                                          
                                       
                                       
                                          c
                                          
                                             f
                                             i
                                          
                                          
                                             (
                                             c
                                             )
                                          
                                       
                                       d
                                       c
                                    
                                 
                              
                           
                        


                           Ei
                           (c) is taken to approximate the sound speed. In Section 3.2.3 we will account for the rationality.

In this part we will give theoretical analysis on the rationality of using the mathematical expectation Ei
                           (c) to approximate the sound speed for distance estimation.

In order to estimate the distance 
                              
                                 
                                    d
                                    ^
                                 
                                 i
                              
                            between the AUV and transponder ai
                            at time instant t, we averagely divide the OWTT 
                              
                                 t
                                 i
                                 
                                    P
                                    D
                                    t
                                 
                              
                            into n weeny sub-intervals. Each interval is

                              
                                 (13)
                                 
                                    
                                       Δ
                                       Γ
                                       =
                                       
                                          t
                                          i
                                          
                                             P
                                             D
                                             t
                                          
                                       
                                       /
                                       n
                                       ,
                                       n
                                       →
                                       ∞
                                    
                                 
                              
                           
                        

Since ΔΓ is weeny, we can assume that the acoustic signal travels with constant speed 
                              
                                 
                                    c
                                    k
                                 
                                 ,
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              
                            during ΔΓ. Obviously ck
                            ∈ [c
                           min , c
                           max ]. Combined with formula (13) 
                              
                                 
                                    d
                                    ^
                                 
                                 i
                              
                            can be deduced as

                              
                                 (14)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                   ^
                                                
                                                i
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                ∑
                                                
                                                   Δ
                                                   Γ
                                                   ·
                                                   
                                                      c
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   t
                                                   i
                                                   
                                                      P
                                                      D
                                                      t
                                                   
                                                
                                                /
                                                n
                                                ·
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   c
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   t
                                                   i
                                                   
                                                      P
                                                      D
                                                      t
                                                   
                                                
                                                ·
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   c
                                                   k
                                                
                                                /
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In formula (14) the term 
                              
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    
                                       c
                                       k
                                    
                                    /
                                    n
                                 
                              
                            expresses the mean value of the sound speed at interval [c
                           min , c
                           max ], as ck
                            occurs with equal probability. And ck
                            has infinite available values. Thus we have 
                              
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    
                                       c
                                       k
                                    
                                    /
                                    n
                                 
                                 ≈
                                 
                                    E
                                    i
                                 
                                 
                                    (
                                    c
                                    )
                                 
                              
                           . And formula (14) can be rewritten as

                              
                                 (15)
                                 
                                    
                                       
                                          
                                             d
                                             ^
                                          
                                          i
                                       
                                       ≈
                                       
                                          t
                                          i
                                          
                                             P
                                             D
                                             t
                                          
                                       
                                       
                                          E
                                          i
                                       
                                       
                                          (
                                          c
                                          )
                                       
                                    
                                 
                              
                           
                        

The distance estimates are assumed to be disturbed by noise with Gaussian distribution as

                           
                              (16)
                              
                                 
                                    
                                       
                                          d
                                          ^
                                       
                                       i
                                    
                                    =
                                    d
                                    
                                       (
                                       Y
                                       )
                                    
                                    +
                                    W
                                 
                              
                           
                        where 
                           
                              d
                              
                                 (
                                 Y
                                 )
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          d
                                          1
                                       
                                       
                                          (
                                          Y
                                          )
                                       
                                       ,
                                       
                                          d
                                          2
                                       
                                       
                                          (
                                          Y
                                          )
                                       
                                       ,
                                       …
                                       ,
                                       
                                          d
                                          i
                                       
                                       
                                          (
                                          Y
                                          )
                                       
                                       ,
                                       …
                                       ,
                                       
                                          d
                                          w
                                       
                                       
                                          (
                                          Y
                                          )
                                       
                                    
                                    )
                                 
                                 T
                              
                           
                         is the vector of real distances between the AUV (at Mt
                        ) and transponders A, 
                           
                              
                                 d
                                 ^
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          
                                             d
                                             ^
                                          
                                          1
                                       
                                       ,
                                       
                                          
                                             d
                                             ^
                                          
                                          2
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             d
                                             ^
                                          
                                          w
                                       
                                    
                                    )
                                 
                                 T
                              
                           
                         is the estimate of d(Y); 
                           
                              
                                 d
                                 i
                              
                              
                                 (
                                 Y
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                x
                                                
                                                   M
                                                   t
                                                
                                             
                                             −
                                             
                                                x
                                                
                                                   a
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                       2
                                    
                                    +
                                    
                                       
                                          (
                                          
                                             
                                                y
                                                
                                                   M
                                                   t
                                                
                                             
                                             −
                                             
                                                y
                                                
                                                   a
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                       2
                                    
                                    +
                                    
                                       
                                          (
                                          
                                             
                                                z
                                                
                                                   M
                                                   t
                                                
                                             
                                             −
                                             
                                                z
                                                
                                                   a
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                       2
                                    
                                 
                              
                           
                        and 
                           
                              Y
                              =
                              
                                 
                                    (
                                    
                                       
                                          x
                                          
                                             M
                                             t
                                          
                                       
                                       ,
                                       
                                          y
                                          
                                             M
                                             t
                                          
                                       
                                       ,
                                       
                                          z
                                          
                                             M
                                             t
                                          
                                       
                                    
                                    )
                                 
                                 T
                              
                           
                        ; W represents the estimation noise vector which causes ranging errors. We assume that W is i.i.d with W ∼ N(0, COV). COV is the covariance matrix of W as 
                           
                              C
                              O
                              V
                              =
                              d
                              i
                              a
                              g
                              (
                              
                                 
                                    σ
                                    1
                                    2
                                 
                                 ,
                                 
                                    σ
                                    2
                                    2
                                 
                                 ,
                                 …
                                 ,
                                 
                                    σ
                                    i
                                    2
                                 
                                 ,
                                 …
                                 ,
                                 
                                    σ
                                    w
                                    2
                                 
                              
                              )
                           
                        , where 
                           
                              σ
                              i
                              2
                           
                         is the variance of the distance estimation noise based on transponder ai
                        . In order to solve Y, we adopt the LMA [13] to minimize the sum square error of distance estimates. This nonlinear least squares optimization problem w.r.t. the variable Y is defined as

                           
                              (17)
                              
                                 
                                    arg
                                    
                                       min
                                       Y
                                    
                                    
                                       
                                          ∥
                                       
                                       
                                          d
                                          
                                             (
                                             Y
                                             )
                                          
                                          −
                                          
                                             d
                                             ^
                                          
                                       
                                       
                                          
                                             ∥
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        
                     

LMA starts with an initial location estimate and improves it iteratively. We take the result of multilateration method as the initial location input. Since the depth of an AUV can be measured by CTD, it needs at least three transponders (w ≥ 3) to do the multilateration. The LMA is described in the Algorithm 1 below.

In LMA Yk
                         is the estimate of Y in the kth iteration; 
                           
                              f
                              
                                 (
                                 Y
                                 )
                              
                              =
                              d
                              
                                 (
                                 Y
                                 )
                              
                              −
                              
                                 d
                                 ^
                              
                           
                         and 
                           
                              F
                              
                                 (
                                 Y
                                 )
                              
                              =
                              1
                              /
                              2
                              ·
                              f
                              
                                 
                                    (
                                    Y
                                    )
                                 
                                 T
                              
                              f
                              
                                 (
                                 Y
                                 )
                              
                           
                         model the optimization problem; J(Y) is the Jacobian matrix of f(Y); μ determines the descent rate of step h; v decides the growth rate of μ; K and η are user-defined parameters to help stop the iteration. The final value of Yk
                         is taken to be the location estimate of the AUV at time instant t.

We conduct simulations on Matlab 7.9 for performance analyses of our proposed algorithm. An AUV travels freely with velocity V in a 3D underwater area of 500 m × 500 m × 400 m. The space coordinate varies from [0, 0, 100] to [500, 500, 500]. Eight transponders are deployed in. Their coordinates vary from [0, 0, 450] to [500, 500, 500]. The communication range R is set to be 200 m. We run our algorithm 50 times for each group of data. The sound speed is set to be 1500 m/s. The precision settings of CTD, inclinometer, z-axis gyro and velocity sensor are shown in Table 1.
                     
                     
                  

Performance of distance estimation for RTR and SL-STTS is compared in Section 4.2. The impact of distance estimation noise W is discussed in Section 4.3. How the main causes of W, which are the measurement noise of time and angles, affect localization accuracy is analyzed in Sections 4.4 and 4.5. Afterwards the influence of AUV's velocity is demonstrated in Section 4.6. The localization ratio under different values of R and V is shown in Section 4.7.

We adopt the root mean square error (RMSE)

                        
                           (18)
                           
                              
                                 R
                                 M
                                 S
                                 E
                                 =
                                 
                                    
                                       1
                                       /
                                       n
                                       ·
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          
                                             
                                                ∥
                                                
                                                   Y
                                                   −
                                                   
                                                      
                                                         Y
                                                         ^
                                                      
                                                      i
                                                   
                                                
                                                ∥
                                             
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        
                     
                  

as the error standard, where Y is the real coordinate vector of AUV and 
                        
                           
                              Y
                              ^
                           
                           i
                        
                      is the estimate of Y. n is set to be 50 as we run the algorithm 50 times. The Cramér–Rao bound (CRB) [13] is introduced to provide a benchmark for the performance of SL-STTS.

CRB places a lower bound on the variance of estimators of a nonrandom factor. The bound expresses that the variance of any unbiased estimator is at least as high as the inverse of the fisher information (FIM). The FIM I(Y) of an estimator disturbed by independent Gaussian noise can be calculated with [10]
                        
                           
                              (19)
                              
                                 
                                    I
                                    
                                       
                                          (
                                          Y
                                          )
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    ∂
                                    
                                       d
                                       T
                                    
                                    
                                       (
                                       Y
                                       )
                                    
                                    /
                                    ∂
                                    
                                       Y
                                       i
                                    
                                    ·
                                    C
                                    O
                                    
                                       V
                                       
                                          −
                                          1
                                       
                                    
                                    ·
                                    ∂
                                    d
                                    
                                       (
                                       Y
                                       )
                                    
                                    /
                                    ∂
                                    
                                       Y
                                       j
                                    
                                    +
                                    1
                                    /
                                    2
                                    t
                                    r
                                    
                                       [
                                       
                                          C
                                          O
                                          
                                             V
                                             
                                                −
                                                1
                                             
                                          
                                          ·
                                          ∂
                                          C
                                          O
                                          V
                                          /
                                          ∂
                                          
                                             Y
                                             i
                                          
                                          ·
                                          C
                                          O
                                          
                                             V
                                             
                                                −
                                                1
                                             
                                          
                                          ·
                                          ∂
                                          C
                                          O
                                          V
                                          /
                                          ∂
                                          
                                             Y
                                             j
                                          
                                       
                                       ]
                                    
                                 
                              
                           
                        where I(Y)
                           ij
                         is the element of the ith row and jth column of I(Y), ∂d(Y)/∂Yj
                         equals the jth column of J(Y), and

                           
                              (20)
                              
                                 
                                    ∂
                                    C
                                    O
                                    V
                                    /
                                    ∂
                                    
                                       Y
                                       j
                                    
                                    =
                                    d
                                    i
                                    a
                                    g
                                    
                                       (
                                       
                                          ∂
                                          
                                             
                                                [
                                                
                                                   C
                                                   O
                                                   V
                                                
                                                ]
                                             
                                             11
                                          
                                          /
                                          ∂
                                          
                                             Y
                                             j
                                          
                                          ,
                                          ∂
                                          
                                             
                                                [
                                                
                                                   C
                                                   O
                                                   V
                                                
                                                ]
                                             
                                             22
                                          
                                          /
                                          ∂
                                          
                                             Y
                                             j
                                          
                                          ,
                                          …
                                          ,
                                          ∂
                                          
                                             
                                                [
                                                
                                                   C
                                                   O
                                                   V
                                                
                                                ]
                                             
                                             
                                                w
                                                w
                                             
                                          
                                          /
                                          ∂
                                          
                                             Y
                                             j
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

and Yj
                         is the jth element of Y, i.e. 
                           
                              
                                 Y
                                 1
                              
                              =
                              
                                 x
                                 
                                    M
                                    t
                                 
                              
                           
                        , 
                           
                              
                                 Y
                                 2
                              
                              =
                              
                                 y
                                 
                                    M
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 Y
                                 3
                              
                              =
                              
                                 z
                                 
                                    M
                                    t
                                 
                              
                           
                        . The CRB can be computed by [10]
                        
                           
                              (21)
                              
                                 
                                    C
                                    R
                                    B
                                    =
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          3
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   I
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   Y
                                                   )
                                                
                                             
                                             ]
                                          
                                          
                                             i
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In the following simulations we will verify that SL-STTS meets the CRB well.

The performance of distance estimation under RTR and SL-STTS is compared in Fig. 5
                        . We set 
                           
                              
                                 σ
                                 i
                                 2
                              
                              =
                              
                                 10
                                 
                                    −
                                    1
                                 
                              
                           
                         and 
                           
                              V
                              =
                              2
                              
                              
                                 m
                                 /
                                 s
                              
                           
                        . The absolute difference between the real distance and its estimate is taken as distance estimation error. When 
                           
                              
                                 |
                              
                              
                                 
                                    ɛ
                                 
                                 i
                              
                              
                                 |
                                 =
                                 0
                              
                           
                        , namely when 
                           
                              
                                 t
                                 i
                                 
                                    P
                                    D
                                    t
                                 
                              
                              =
                              
                                 t
                                 i
                                 
                                    P
                                    D
                                    f
                                 
                              
                           
                        , RTR and SL-STTS estimate distance with the same principle. As shown in Fig. 5, the values of average distance estimation error for RTR and SL-STTS are similar at 
                           
                              
                                 |
                              
                              
                                 
                                    ɛ
                                 
                                 i
                              
                              
                                 |
                                 =
                                 0
                              
                           
                        . However with |ɛ
                           i
                        | increasing, the average distance estimation error of RTR exceeds SL-STTS and grows rapidly, while the latter is almost affected little. It is obvious because when 
                           
                              t
                              i
                              
                                 P
                                 D
                                 t
                              
                           
                         has larger bias against 
                           
                              t
                              i
                              
                                 P
                                 D
                                 f
                              
                           
                        , RTR results in bad OWTT estimate but SL-STTS can give much more accurate one. Compared with RTR, the average ranging error of SL-STTS is declined by about 42%.

In this experiment, we analyze how the distance estimation noise W affects localization accuracy. In order to compare localization performance with RTR, we also run our algorithm with RTR technology instead of our proposed accurate sound travel time solution to calculate the OWTT, and we call it SL-RTR.

For simplicity, 
                           
                              σ
                              i
                              2
                           
                         is set equal to each other and distance independent. Thus the second term of formula (19) is 0. The velocity of AUV is set to be 2 m/s. As the results shown in Fig. 6
                        
                        , in general the RMSE of SL-STTS meets the mean CRB however SL-RTR floats over it. SL-STTS performs 23% better than SL-RTR. With decreasing the noise variance, the values of RMSE for both SL-RTR and SL-STTS show a decline, however the latter downs much faster. In other words, the localization accuracy is sensitive to distance estimation noise, which verifies the significance of precise ranging. In Fig. 5 we have verified that high performance sound travel time solution brings accurate distance estimates. Combined with Fig. 6, we can further conclude that high performance sound travel time solution contributes to accurate location estimates.

It should be noted that the measurement accuracy of Δti
                         and angles dominates the precision of OWTT estimates and further affects localization performance. In this experiment we simply investigate the effect of time measurement noise and add no noise of angle measurements. The localization performance is compared with the other three methods, SL-RTR, method [15] (we call it Optimal-ToA) and method [10] (we call it EKF-ESSP). V is set to be 2 m/s. The time measurement Δti
                         based on transponder ai
                         is assumed to be disturbed by Gaussian distributed noise with zero mean and variance 
                           
                              σ
                              1
                              2
                           
                        . As shown in Fig. 7, the RMSE of SL-STTS meets the mean CRB however that of SL-RTR floats over it. With decreasing noise variance 
                           
                              σ
                              1
                              2
                           
                        , the values of RMSE for all these four methods go down sharply. The reason behind it is that the bias of time measurements in milliseconds may cause error of distance estimates in meters. Thus for both AUVs and transponders, it is necessary to equip clocks with high time resolution. Compared with SL-RTR, Optimal-ToA and EKF-ESSP, the localization performance of SL-STTS is improved by about 25%, 37% and 75%, respectively.

The input angles of SL-STTS are disturbed by noise assumed to be Gaussian distributed with zero mean and variance 
                           
                              σ
                              2
                              2
                           
                        . In this experiment we investigate how such noise affects localization accuracy. 
                           
                              σ
                              2
                              2
                           
                         is added to all the angle measurements and set to vary from 
                           
                              10
                              
                                 −
                                 4
                              
                           
                         to 101 and 
                           
                              V
                              =
                              2
                              
                              
                                 m
                                 /
                                 s
                              
                           
                        .

From the results shown in Fig. 8
                        , we can observe that with fixed 
                           
                              σ
                              1
                              2
                           
                         the RMSE of SL-STTS goes down slowly when 
                           
                              σ
                              2
                              2
                           
                         decreases. While the other three methods present little performance change as the fact that they are irrelevant to inputs of AoA and orientation.

When 
                           
                              σ
                              2
                              2
                           
                         is fixed and 
                           
                              σ
                              1
                              2
                           
                         is increasing, all the methods present a performance reduction. And SL-STTS works better than Optimal-ToA gradually. That is to say, SL-STTS is more immune to the time measurement noise than the other three approaches. Fig. 8 also indicates that the effect of angle measurement noise is small on the localization accuracy of SL-STTS. Namely, SL-STTS is slightly affected by the large error commonly arising in AoA and orientation measurements.


                        Fig. 9(
                        
                        a) shows the RMSE as a function of V. We vary V from 1 to 6 m/s and set 
                           
                              
                                 σ
                                 1
                                 2
                              
                              =
                              
                                 10
                                 
                                    −
                                    6
                                 
                              
                           
                        , 
                           
                              
                                 σ
                                 2
                                 2
                              
                              =
                              
                                 10
                                 
                                    −
                                    1
                                 
                              
                           
                        . It can be found that with V varying, the values of RMSE for all the four approaches change smoothly. And the localization performance of SL-STTS is improved by about 8%, 23% and 79% compared with Optimal-ToA, SL-RTR and EKF-ESSP, respectively. The percentage of error growth is compared in Fig. 9(b). It can be observed that when V is increased from 1 to 6 m/s, the values of RMSE don't grow too much for these four methods. The angle inputs for SL-STTS may lose accuracy under larger speed of the AUV. However in Fig. 8, it has proved that SL-STTS is slightly affected by the angle measurement noise. Furthermore, optimization of the measured data, as was performed in the counterparts, well eliminates the inaccuracy due to larger velocity.

The AUV receives localization packets within the timer period defined by formula (1). In this experiment we study how the communication range R in formula (1) and the velocity V of AUV affect the localization ratio, which can be calculated with

                           
                              (22)
                              
                                 
                                    L
                                    o
                                    c
                                    a
                                    l
                                    i
                                    z
                                    a
                                    t
                                    i
                                    o
                                    n
                                    
                                    r
                                    a
                                    t
                                    i
                                    o
                                    =
                                    
                                       
                                          l
                                          o
                                          c
                                          a
                                          l
                                          i
                                          z
                                          e
                                          d
                                          
                                          t
                                          i
                                          m
                                          e
                                          s
                                       
                                       n
                                    
                                    ×
                                    100
                                    %
                                 
                              
                           
                        where n is the total run times as defined in formula (18). If the AUV receives enough localization packets (at least three), it can be localized. Here we set 
                           
                              α
                              =
                              0.1
                              
                              s
                           
                        .

From the results shown in Fig. 10, we can see that when R increases, the localization ratio becomes little affected by V. In the LBL system, the value of R can reach hundreds of meters. The largest speed AUVs can achieve is only 5 m/s, which is about 300 times slower than the sound speed. And AUVs usually travel at normal speed 
                           
                              0.5
                              −
                              4
                              
                                 
                                    0.28
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              
                                 m
                              
                              /
                              
                                 s
                              
                           
                        . So the acoustic replies from transponders have arrived at the AUV before it moves out of its communication range. In other words, if the AUV moves fast enough and breaks through the communication range, however longer the timer period endures, the AUV cannot receive replies any more. It can be concluded that it is R that mainly affect the localization ratio.

@&#CONCLUSION@&#

Range based LBL localization is sensitive to ranging accuracy. For the purpose of enhancing distance estimation precision, the SL-STTS method is presented. SL-STTS is time-synchronization free and works in shallow water (depth < 500 m). It gives more accurate OWTT estimates for distance estimation by analyzing the information of AoA and orientation of AUV. To solve the sound speed uncertainty, SL-STTS computes the mathematical expectation to approximate sound speed for distance estimation and gives theoretical analysis for its rationality. Furthermore, distance estimates are disturbed by measurement noise and need optimization. SL-STTS models the function between ranging optimization and localization. It adopts LMA to solve this function.

Simulation results show that the localization performance of our proposed algorithm meets the mean CRB. And under the measurement uncertainties of angles and time, SL-STTS performs about 8–79% better than the counterparts. Its ranging accuracy is increased by 42% compared with RTR. From analyses through simulations, it is observed that the measurement noise of angles affects localization performance slightly however the time measurement noise affects it largely. In the next stage we will study more faithful noise models. We consider putting our algorithm into true underwater environment to verify the rationality and feasibility of the proposed sound speed solution. And as well, we will focus on the research of improving immunity of SL-STTS against time measurement noise in the future.

@&#ACKNOWLEDGMENTS@&#

This research was sponsored by the National Natural Science Foundation of China under grant no. 61271125 and 61501168, Educational Commission of Hebei Province under grant no. QN2015045.

Supplementary material associated with this article can be found, in the online version, at doi:10.1016/j.compeleceng.2015.11.018.


                     
                        
                           Image 1
                           Image, 1
                           
                        
                     
                  

@&#REFERENCES@&#

