@&#MAIN-TITLE@&#A comparison of regime-switching temperature modeling approaches for applications in weather derivatives

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Weather derivatives are used to hedge weather related financial risks.


                        
                        
                           
                           Three regime-switching models are proposed to capture the temperature dynamics.


                        
                        
                           
                           A model with a Brownian motion and a mean-reverting process performs the best.


                        
                        
                           
                           This model is then applied to price weather options based on heating degree days.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Weather derivatives

Regime-switching models

Lattice approaches

@&#ABSTRACT@&#


               
               
                  A comparison of regime-switching approaches to modeling the stochastic behavior of temperature with an aim to the valuation of temperature-based weather options is presented. Four models are developed. Three of these are two-state Markov regime-switching models and the other is a single-regime model. The regime-switching models are generated from a combination of different underlying processes for the stochastic component of temperature. In Model 1, one regime is governed by a mean-reverting process and the other by a Brownian motion. In Model 2, each regime is governed by a Brownian motion. In Model 3, each regime is governed by a mean-reverting process in which the mean and speed of the mean-reversion remain the same, but only the volatility switches between the states. Model 4 is a single-regime model, where the temperature dynamics are governed by a single mean-reverting process. All four models are utilized to determine the expected heating degree days (HDD) and cooling degree days (CDD), which play a crucial role in the valuation of weather options. A four-year temperature dataset from Toronto, Canada, is used for the analysis. Results demonstrate that Model 1 captures the temperature dynamics more accurately than the other three models. Model 1 is then used to price the monthly call options based on a range of strike HDD.
               
            

@&#INTRODUCTION@&#

Weather affects daily lives and influences the volume of sales and transactions in everyday trading and business. According to a report of the US Department of Commerce, 70% of American companies and as much as 22% of the American gross domestic product (GDP) are sensitive to weather (Ku, 2001). The snowfalls in the UK in December 2010 caused a loss of millions to the British Airports Authority (BAA), the operator of five British airports including Heathrow airport, when it was closed for 4days (Thornton, 2011). The warm weather during the winter of 2006 in the northeastern part of the USA prompted a drastic decline in the demand for winter clothes, such as sweaters and coats (Chen & Yano, 2010). These examples are a few among many instances of adverse weather effects that continuously pose huge financial risks to all kinds of businesses. To hedge such weather related financial risks, a financial instrument called weather derivative is introduced in the financial market in the form of: futures, options on futures or swaps, based on underlying weather variables, such as temperature, rainfall, and snowfall. Through weather derivatives, a business organization can transfer its weather related risks to someone, who is willing to absorb the risk, contingent on a predetermined value or index of the underlying weather variables. According to a Weather Risk Management Association (WRMA, 2003) report, more than 90% of weather derivatives are temperature-based. Degree-days indices, e.g., heating degree days (HDD) or cooling degree days (CDD), definitions of which are given in Section 2.1, are considered as the underlying assets of the temperature-based weather derivatives.

The first weather derivative transaction was executed in 1997 by an energy provider, Aquila Energy (Considine, 1999). An electric service provider, Consolidated Edison Company (ConEd) in the city of New York, USA, purchased electric power from Aquila Energy for the month of August at an agreed price, along with a weather clause that Aquila would pay ConEd a rebate, if the month of August turned out to be cooler than expected. In 2007, Weatherproof, a clothing manufacturer in the US, purchased a weather derivative brokered by StormExchange, a weather-related financial hedging firm, contingent on whether the month of December would be warmer than usual (Chen & Yano, 2010). Similarly, a power generation company, GenCo, could hedge its weather risks by taking a short position on a HDD call option for a winter season, for example, from January to March. If the winter is not so cold, the company keeps the premium. On the other hand, if the winter is very cold, electricity demand will go up and GenCo can still afford to finance the payout of the option from its high revenues. In either situation, GenCo could reduce its exposure to weather risk. The crucial decision here is to figure out the appropriate option price (premium), i.e., what price should be paid to buy or sell a HDD call option. Consequently, it greatly depends on the appropriate modeling of the temperature dynamics. This paper presents regime-switching models to capture the behavior of temperature dynamics with an aim to the valuation of weather option price.

Several studies in the literature outline the pricing problems of weather derivatives. The Ornstein–Uhlenbeck mean-revering process in different forms dominates the literature on modeling the stochastic behavior of temperature. Examples include Dornier and Queruel (2000), Alaton, Djehiche, and Stillberger (2002), Brody, Syroka, and Zervos (2002), Benth and Šaltytė-Benth (2005) and Benth, Šaltytė-Benth, and Koekebakker (2007). However, a single stochastic process may not be able to describe the dynamics of temperature appropriately and a switching behavior for temperature from one stochastic process to another may exist. This type of modeling approach leads to regime-switching models for temperature, in which temperature undergoes discrete shifts in mean and volatility as latent states. The rationale behind regime-switching behavior for temperature is discussed in Section 3.2. A variety of regime-switching models can be developed based on different stochastic processes for temperature in different regimes. Accordingly, the main objective of this paper is to examine different regime-switching models capturing the temperature dynamics and compare their performance with a single-regime model. Three Markov regime-switching models are proposed and their performances are compared with that of a single-regime Ornstein–Uhlenbeck mean-reverting model.

Model 1 assumes that daily temperature switches between two regimes: one regime is governed by a mean-reverting process and the other by a Brownian motion. Model 2 assumes that daily temperature switches between two regimes and each regime is governed by a Brownian motion. Model 3 assumes that each regime is governed by a mean-reverting process in which the mean and speed of the mean-reversion remain the same, but only the volatility switches between the states. Each Markov regime-switching model is represented by a pentanomial lattice. Model 4 assumes that daily temperature follows a mean-reverting process, which is represented by a binomial lattice proposed by Nelson and Ramaswamy (1991). For each of these four models, the average expected monthly and seasonal HDD (CDD) are calculated and then they are compared with the actual average monthly and seasonal HDD (CDD), respectively. Results show that the first regime-switching model (Model 1) captures the stochastic behavior of temperature more closely than the other models. Hence, Model 1 is used to price the HDD call options.

The organization of the remainder of this paper is as follows. Section 2 briefly describes weather derivative fundamentals, degree days indices, and the existing weather option pricing models. Section 3 discusses regime-switching models, their applications and the regime-switching behavior of the temperature observed in Toronto, Canada. Section 4 describes the models and construction of lattices for each model. Numerical examples are given in Section 5. Conclusions are discussed in Section 6.

Weather derivatives differ from standard financial derivatives in several aspects. Firstly, the underlying asset (e.g., HDD or CDD) is not tradable in the spot market. Secondly, standard financial derivatives hedge the price risk, while weather derivatives hedge the volume or quantity risk. Thirdly, weather is a location-specific and nonstandardized commodity, unlike a standardized commodity, such as a particular light sweet crude oil (e.g., Campbell & Diebold, 2005 & London, 2007). Weather derivatives also differ from insurance (Alaton et al., 2002). Payout of weather derivatives is based only on the actual outcome of the weather (e.g., HDD or CDD), not on damages and losses due to weather. The holder of a weather derivative, unlike the holder of an insurance contract, does not have to file a claim and prove damages to receive a payout. While weather derivatives cover low-risk, high-probability events (e.g., uncertainties in weather), insurance protects high-risk, low-probability events (e.g., earthquake, flood, etc.) (Cao & Wei, 2004).

A standard weather derivative contract usually includes six features: (i) a contract period, for example, a monthly contract for the month of December; (ii) a measurement station, for instance, Pearson International Airport, Toronto, Canada; (iii) a weather variable, for example, temperature, measured at the measurement station over the contract period; (iv) an index, for instance, HDD or CDD, which aggregates the weather variable over the contract period; (v) a pay-off function that converts the index into cash flow; and (vi) a premium or option price paid by the buyer at the start of the contract (Jewson & Brix, 2005).

The Chicago Mercantile Exchange (CME) introduced electronic trading of weather derivatives in September 1999 (London, 2007). The CME offers trading with futures contracts as well as options on futures based on the degree days index. The CME rulebook chapter 421 (rule 42101) states that “each particular CME Canadian degree days index is the accumulation of like degree days over a calender month. The accumulation period of each CME–HDD or CME–CDD index futures contract begins with the first calender day of the contract month and ends with the last calender day of the contract month.” The HDD contract months for Canadian degree days index options at CME are from January to April inclusive as well as from October to December inclusive, and the CDD contract months are from April to October inclusive. April and October are called shoulder months and are included as HDD and CDD months. The options on futures are of European style, as they can only be exercised at the expiration date (Alaton et al., 2002). At CME, there are both futures and options contracts on temperature-based derivatives for cities as follows: six Canadian (Calgary, Edmonton, Montreal, Toronto, Vancouver, and Winnipeg), 24 US, 10 European, 3 Australian, and 2 Asian.

Degree day (DD) indices originated in the energy industry and are designed to correlate with the domestic demand of heating and cooling (Jewson & Brix, 2005). Heating degree days (HDD) are used to measure the demand for heating and are thus a measure of how cold it is. The HDD index over the period from day 1 to day N is defined as:
                           
                              (1)
                              
                                 HDD
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    max
                                 
                                 {
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                                 -
                                 T
                                 (
                                 t
                                 )
                                 ,
                                 0
                                 }
                                 ,
                              
                           
                        where T
                        0
                        =Baseline temperature (usually 65°Fahrenheit in USA, 18°Celsius in other countries
                           1
                           Usually the base temperature of 18°Celsius is a temperature below which people tend to consume more energy to heat their residences and above which people start to turn on their air conditioners for cooling (Alaton et al., 2002).
                        
                        
                           1
                        ) and 
                           
                              T
                              (
                              t
                              )
                              =
                              
                                 
                                    T
                                    
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          max
                                       
                                    
                                    +
                                    T
                                    
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          min
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                           
                        
                        =Average temperature on day t, where T(t)max and T(t)min are the maximum and minimum temperatures on day t, respectively. Cooling degree days (CDD), on the other hand, are used to measure the demand for cooling. The hotter the day, the more CDD. The CDD index over the period from day 1 to day N is:
                           
                              (2)
                              
                                 CDD
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    max
                                 
                                 {
                                 T
                                 (
                                 t
                                 )
                                 -
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 0
                                 }
                                 .
                              
                           
                        
                     

Different forms of Ornstein–Uhlenbeck mean-reverting models to capture the dynamics of temperature are dominant in the literature for pricing weather options. For example, the stochastic component of daily temperature, x, follows a mean-reverting process dx
                        =
                        β(α
                        −
                        x)dt
                        +
                        σdz, where β is the speed of the mean reversion, α is the long-term mean of the process, σ is the standard deviation or volatility of the process, and dz is the increment of the Wiener process over an infinitesimally small period of time such that E(dz)=0 and Var (dz)=
                        dt. Dornier and Queruel (2000) first began investigation on the futures prices based on temperature indices. They model the temperature observations at O’Hare airport in Chicago, USA, as an Ornstein–Uhlenbeck mean-reverting process with constant σ. Alaton et al. (2002) extend the Ornstein–Uhlenbeck process with monthly variations in σ to fit the temperature observations at the Stockholm–Bromma airport, Sweden. Brody et al. (2002) propose a different modeling approach of the Ornstein–Uhlenbeck temperature model, assuming dz is the increment of fractional Brownian motion, instead of the Wiener process, with constant σ. They use the temperature of the city of London, UK, and calculate prices for different temperature derivatives. Benth and Šaltytė-Benth (2005) propose an Ornstein–Uhlenbeck process driven by a generalized hyperbolic Lèvy process for Norwegian temperature data.


                        Campbell and Diebold (2005) use an autoregressive moving average (ARMA) time series model for temperature and observe seasonality in the autocorrelation function for the (squared) residuals when modeling the temperature in US cities. They propose a seasonal autoregressive conditional heteroskedastic (ARCH) process to model σ. Benth and Šaltytė-Benth (2007) propose an Ornstein–Uhlenbeck process with seasonal volatility to model the dynamics of the temperature data from Stockholm, Sweden. Benth et al. (2007) propose a continuous-time autoregressive (CAR) process to model Swedish temperature data. Davis (2001) suggests a stochastic discount factor (SDF) approach (an approach of mathematical economics) to price weather options by modeling the accumulated HDD as a log-normal process. Cao and Wei (2004) propose an equilibrium pricing model based on the fact that, in equilibrium, both the financial market and the goods market are cleared so that the aggregate consumption equals the dividend generated from the risky stock. They calculate SDF, and use this factor to price weather derivatives. These weather derivatives pricing approaches are summarized in Table 1
                        .

To the best of our knowledge, no one uses regime-switching models for modeling the temperature dynamics. This paper examines three Markov regime-switching and one single-regime models based on lattice approaches to capture temperature dynamics with an application to the valuation of weather options. The goal of all these models is to model the behavior of the expected HDD and CDD in order to calculate the option prices for monthly and seasonal weather contracts.

This section introduces regime-switching models and discusses their application as well as the regime-switching behavior of the temperature data recorded in Toronto, Canada.

The concept behind the Markov regime-switching model is to capture the observed stochastic behavior of an underlying variable by more than one regime. For each regime, one can define an independent underlying process (Hamilton, 2008). The switching behavior between the regimes (states) is assumed to be governed by an unobservable latent variable R
                        
                           t
                        . For example, in a two-state regime-switching model, R
                        
                           t
                        
                        ={1,2}. A two-state Markov chain governs the description of the probability law of switching between R
                        
                           t
                        
                        =1 and R
                        
                           t
                        
                        =2 with transition probabilities
                           
                              (3)
                              
                                 
                                    
                                       γ
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 Pr
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 j
                                 |
                                 
                                    
                                       R
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 =
                                 i
                                 )
                                 
                                 for
                                 
                                 i
                                 ,
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 .
                              
                           
                        Transition probability is defined as the probability of switching between regimes from one observation to the next observation. That is, transition probability is dependent on the time period between consecutive observations.

There are many applications of regime-switching models in the literature. Bollen, Gray, and Whaley (2000) use regime-switching models to capture the dynamics of foreign exchange rates. Andrew and Bekaert (2002) examine the econometric performance of regime-switching models for interest rates of the USA, the UK, and Germany. Huisman and Mahieu (2003) and Bierbrauer, Trück, and Weron (2004) propose a three-state regime-switching model to describe the stochastic component of the spot price in the Nordic power exchange. To capture the cyclical behavior of the semiconductor business, Liu and Chyi (2006) use a Markov regime-switching model with two regimes representing expansion and contraction of semiconductor sales. For the Australian wholesale electricity market, Higgs and Worthington (2008) propose a three-state regime-switching model for electricity spot prices.

The lattice approach, which was first proposed by Cox, Ross, and Rubinstein (1979), is one of the methods used to model the multi-period behavior of the regime-switching underlying variables. For example, Bollen (1998) proposes a pentanominal lattice approach to describe a two-state regime-switching model for a single underlying variable and then values European and American options. Wahab, Yin, and Edirisinghe (2010) develop a lattice approach for the valuation of swing options by modeling the average daily price of electricity using a three-state regime-switching model. Wahab and Lee (2009) generalize the lattice approach for multiple regime-switching variables with multiple regimes and then value European and American rainbow options.

The strength of the lattice approach over the other non-lattice approaches (e.g., the Monte Carlo simulation and the finite difference method) lies in the fact that: (i) a lattice represents the possible future values of a regime-switching variable in a more intuitive way; (ii) the discrete-time framework of a lattice allows the valuation of European-style weather options more conveniently; (iii) a lattice approach is flexible enough to incorporate branch probabilities that change over time; and (iv) it is easy to implement and use (Bollen, 1998; Hull, 2002; Wahab & Lee, 2009). Moreover, the lattice approach performs better than the Monte Carlo simulation in valuing options for multiple correlated regime-switching variables (Wahab & Lee, 2009). On the other hand, the weakness of the lattice approach lies in the fact that with an increase in the number of variables, the number of nodes in the lattice grows rapidly. However, the Monte Carlo simulation usually takes more computational time to achieve an output with a high degree of accuracy and the finite difference method is useful when an option price can be determined by a partial differential equation with boundary conditions. In this paper, three two-state regime-switching models are utilized to describe the behavior of the average daily temperature and then the models are discretized by pentanominal lattices to price HDD call options. The performances of these regime-switching models are then compared with that of a single-regime model governed by an Ornstein–Uhlenbeck process.

The regime-switching behavior in electricity prices is prompted by spikes that are often caused by short-term instability between supply and demand (Huisman & Mahieu, 2003). Similarly, abrupt changes in temperature — caused by a combination of several factors including latitude, intensity of solar circulation, land and water surface areas, ocean currents, elevation, and clear skies (Ahrens, 2006) — induce the regime-switching behavior in temperature. The presence of abrupt changes in the annual and seasonal temperature time series in the Greater Toronto Area (GTA) is detected by Mohsin and Gough (2010). A report from Environment Canada (Francis & Hengeveld, 1998) states that “climates of the past, rather than changing gradually, have sometimes shown a tendency, at least regionally, to switch abruptly to a radically different mode.” Studies find that temperature is the main impetus for switching the climate’s state abruptly to a different radical mode. The Environment Canada report also states that a shift of 0.5°Celsius increase in the mean temperature would increase the number of hot days above 35°Celsius by 25% in Victoria, Australia. In the city of Toronto, an increase of 4°Celsius in the mean temperature would increase the number of hot days above 30.5°Celsius from 1 in 10days to 1 in 2days, i.e., from 10% to 50%, in a summer (Francis & Hengeveld, 1998). Huisman (2008) also shows that a shift in mean temperature induces regime-switching behavior in electricity prices and increases the probability of spike occurrences. These factors provide clues to examine the regime-switching behavior of Toronto temperatures.

The average daily temperature of Toronto, Canada, as measured at Pearson International Airport from January 1, 2005 to December 31, 2008, for a total of 1461days was collected from the website of National Climate Data and Information Archive of Canada.
                           2
                           When dealing with weather data, data cleaning is important before any pricing method is applied. There are two types of temperature data: ‘synoptic’ and ‘climate’. ‘Synoptic’ data are used for immediate feeding into weather forecast without data cleaning and quality checking. ‘Climate’ data are purely preserved for historical purpose and therefore pass through several levels of data cleaning and quality control in order to remove absurd values and fill gaps. Because of higher level of accuracy and reliability, ‘climate’ data are used for weather contracts (Jewson & Brix, 2005). The data used in this study are obtained from Environment Canada’s database of historical ‘climate’ data and can be used reliably for weather contracts.
                        
                        
                           2
                         The temperature ranges from a minimum of −20.3°Celsius to a maximum of 31.5°Celsius. The average temperature on day t, T(t), can be modeled as the sum of the deseasonalized stochastic component, x
                        
                           t
                        , and deterministic annual seasonality component, S(t), as follows:
                           
                              (4)
                              
                                 T
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 S
                                 (
                                 t
                                 )
                                 .
                              
                           
                        
                        S(t) can be further approximated as:
                           
                              (5)
                              
                                 S
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 sin
                                 [
                                 2
                                 π
                                 (
                                 t
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 /
                                 365
                                 ]
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       3
                                    
                                 
                                 t
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       4
                                    
                                 
                                 ,
                              
                           
                        where C
                        1, C
                        2, C
                        3 and C
                        4 are constants (e.g., Weron, 2007). The values of these constants shown in Table 2
                         are estimated by a Gauss–Newton non-linear least square regression on time t, where t
                        =1,2,…,1461, using a RATS (Regression Analysis of Time Series) function named “NLLS” (Enders, 2003). Fig. 1
                        (top) shows the average daily temperature (average over daily minimum and maximum) along with the fitted seasonality component, S(t). After removing S(t), the deseasonalized stochastic component, x
                        
                           t
                        
                        =
                        T(t)−
                        S(t), is shown in Fig. 1(bottom).

In this study, the temperature dataset of Toronto, Canada, is examined for the regime switching behavior. The regime-switching parameters are estimated using the log-likelihood function maximized by the Broyden–Fletcher–Goldfarb–Shanno (BFGS) method in RATS (Brooks, 2009, chap. 9.2). Fig. 2
                        (top) shows the presence of two regimes (or states) in solid and dashed lines and Fig. 2(bottom) depicts the smoothed probability of being in the corresponding states. To clearly show the two states (regimes), a snapshot of the first five hundred days of the dataset is taken. The regime parameters based on daily temperature data are reported in Table 3
                         in Section 5.1.

This section develops three regime-switching models and one single-regime model and their underlying processes along with construction of corresponding lattices for each model.

A two-state regime-switching model for the stochastic component of the temperature, x
                        
                           t
                        , can be represented by x
                        
                           t,i
                        , if x
                        
                           t
                         is in regime i, with unconditional probability p
                        
                           i
                        , for i
                        =1, 2, where 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           
                        . Accordingly,
                           
                              (6)
                              
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                   is in regime
                                                   
                                                   1
                                                   
                                                   with probability
                                                   
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                   where
                                                   
                                                   
                                                      
                                                         dx
                                                      
                                                      
                                                         t
                                                         ,
                                                         1
                                                      
                                                   
                                                   =
                                                   β
                                                   (
                                                   α
                                                   -
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                         ,
                                                         1
                                                      
                                                   
                                                   )
                                                   dt
                                                   +
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   dz
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                         ,
                                                         2
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                   is in regime
                                                   
                                                   2
                                                   
                                                   with probability
                                                   
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                   where
                                                   
                                                   
                                                      
                                                         dx
                                                      
                                                      
                                                         t
                                                         ,
                                                         2
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   dt
                                                   +
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   dz
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where β is the speed and α is the mean of the mean-reverting process, μ
                        2 is the mean of the Brownian motion, σ
                        1 and σ
                        2 are the volatilities of the mean-reverting and Brownian motion processes, respectively, and dz is the increment of the Wiener process. Since temperature is non-tradable, it is necessary to determine the risk-neutral equivalent drift that reflects the risk of the option. The risk-neutral equivalent drift is obtained by subtracting the risk premium from the actual growth rate. The amount of the risk premium depends on the market price of risk. Therefore, if the market price of risk is known, the risk-neutral equivalent drift can be computed (Wahab et al., 2010). Cao and Wei (2004) assess the significance of the market price of risk in the valuation of weather futures and options based on the extended Lucas equilibrium asset-pricing model, in which uncertainties in economy are simulated by aggregate dividend (i.e., total consumption) and a state variable represented by temperature. They find that the market price of risk is significant, if the correlation between the aggregate dividend and temperature is high and the risk aversion parameter is also high. Their empirical study finds the largest risk premium of 11.61% for call options for the city of Dallas, USA. It may also be noted, referring to Hull (2002, p. 485), that ‘the market price of risk is not dependent on the nature of the derivative and at any time the market price of risk must be the same for all derivatives that are dependent on the same underlying variable.’ Accordingly, considering the same market price of risk, λ, for both regimes, in Eq. (6), α is replaced by (α
                        −
                        λσ
                        1/β) and μ
                        2 is replaced by μ
                        2
                        −
                        λσ
                        2 (Weron, 2007). In a two-state regime-switching model, there are four transition probabilities in the Markov chain for the evolution of the unobserved latent indicator variable and given by Eq. (3).

To construct the lattice, the step size of the regime modeled by the mean-reverting process is defined as (e.g., Nelson & Ramaswamy, 1991):
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       h
                                    
                                 
                                 .
                              
                           
                        
                     

The step size of the other regime modeled by the Brownian motion can be defined as (e.g., Bollen, 1998):
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       h
                                    
                                 
                                 ,
                              
                           
                        where h represents the time interval between two layers of the lattice. Note that h can be chosen sufficiently small to make all conditional branch probabilities positive.

In order to develop a pentanominal lattice for the two-state regime-switching model, each regime is represented by a trinomial lattice and the middle branch is shared by both regimes. To reduce the number of nodes in the lattice, the nodes are merged by adjusting the step size of one regime as follows, so that the step sizes of two regimes have a 1:2 ratio. Let the step sizes of regimes 1 and 2, be given by 
                           
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                           
                         in (7) and 
                           
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                           
                         in (8), respectively. Define the indices 
                           
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              ≔
                              arg
                              min
                              {
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              :
                              
                              i
                              =
                              1
                              ,
                              
                              2
                              }
                           
                         and 
                           
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              ≔
                              arg
                              max
                              {
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              :
                              
                              i
                              =
                              1
                              ,
                              
                              2
                              }
                           
                        , and set 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         for i
                        =1,2. Thus, ϕ
                        1
                        <
                        ϕ
                        2 holds, and define 
                           
                              ϕ
                              =
                              
                                 
                                    max
                                 
                                 
                                    i
                                 
                              
                              {
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              }
                           
                        . Let 
                           
                              ϕ
                              =
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         (i.e., 
                           
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              >
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                           
                        ), then the step size of ϕ
                        
                           j
                         should be adjusted according to Eq. (9).
                           
                              (9)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   j
                                                   =
                                                   i
                                                   ,
                                                
                                             
                                             
                                                
                                                   j
                                                   
                                                      
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   j
                                                   
                                                   ≠
                                                   
                                                   i
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

For each trinomial lattice, the three conditional branch probabilities (
                           
                              
                                 
                                    π
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    u
                                 
                              
                              ,
                              
                                 
                                    π
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    m
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    π
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    d
                                 
                              
                           
                         for the upward, middle, and downward branches, respectively) can be determined by matching the moments implied by the lattice to the moments implied by the distribution of the underlying process of the corresponding regime (Wahab et al., 2010).

For the mean-reverting process:
                           
                              (10)
                              
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       u
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ϕ
                                                                           
                                                                           
                                                                              j
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        j
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    ϕ
                                                                                 
                                                                                 
                                                                                    i
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  β
                                                                  (
                                                                  α
                                                                  -
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        t
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  )
                                                                  h
                                                               
                                                               
                                                                  j
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ϕ
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   0
                                                   ⩽
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ϕ
                                                                           
                                                                           
                                                                              j
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        j
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    ϕ
                                                                                 
                                                                                 
                                                                                    i
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  β
                                                                  (
                                                                  α
                                                                  -
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        t
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  )
                                                                  h
                                                               
                                                               
                                                                  j
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ϕ
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ⩽
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ϕ
                                                                           
                                                                           
                                                                              j
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        j
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    ϕ
                                                                                 
                                                                                 
                                                                                    i
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  β
                                                                  (
                                                                  α
                                                                  -
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        t
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  )
                                                                  h
                                                               
                                                               
                                                                  j
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ϕ
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   <
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   otherwise.
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       d
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ϕ
                                                                           
                                                                           
                                                                              j
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        j
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    ϕ
                                                                                 
                                                                                 
                                                                                    i
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  β
                                                                  (
                                                                  α
                                                                  -
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        t
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  )
                                                                  h
                                                               
                                                               
                                                                  j
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ϕ
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   0
                                                   ⩽
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ϕ
                                                                           
                                                                           
                                                                              j
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        j
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    ϕ
                                                                                 
                                                                                 
                                                                                    i
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  β
                                                                  (
                                                                  α
                                                                  -
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        t
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  )
                                                                  h
                                                               
                                                               
                                                                  j
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ϕ
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ⩽
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ϕ
                                                                           
                                                                           
                                                                              j
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        j
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    ϕ
                                                                                 
                                                                                 
                                                                                    i
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  β
                                                                  (
                                                                  α
                                                                  -
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        t
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  )
                                                                  h
                                                               
                                                               
                                                                  j
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ϕ
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   <
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   otherwise.
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   i
                                                   =
                                                   j
                                                   ,
                                                
                                             
                                             
                                                
                                                   1
                                                   -
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         ,
                                                         u
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         ,
                                                         d
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   otherwise.
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

For the Brownian motion:
                           
                              (13)
                              
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       u
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      j
                                                      
                                                         
                                                            
                                                               
                                                                  ϕ
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                   
                                                
                                                h
                                             
                                             
                                                (
                                                j
                                                
                                                   
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       d
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      j
                                                      
                                                         
                                                            
                                                               
                                                                  ϕ
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                   
                                                
                                                h
                                             
                                             
                                                (
                                                j
                                                
                                                   
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       m
                                    
                                 
                                 =
                                 1
                                 -
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       u
                                    
                                 
                                 -
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       d
                                    
                                 
                                 .
                              
                           
                        
                     

To determine the expected HDD or CDD using the lattice defined above, a three-step procedure is utilized: (1) develop a lattice for the stochastic component, x
                        
                           t
                        , of the temperature; (2) add the deterministic annual seasonal component, S(t), to the value of x
                        
                           t
                         at each node of the lattice, to depict the behavior of the temperature, T(t); and (3) calculate the expected HDD or CDD. For example, the lattice is initialized at the root node with the stochastic component of the temperature. The step sizes of the lattice are determined by using Eqs. (7) and (8). Necessary adjustments are made to merge the nodes efficiently as stated in Eq. (9).

To calculate the expected HDD, the dynamic programming approach is used. For example, at a given node in period t,
                           
                              (16)
                              
                                 HDD
                                 (
                                 t
                                 ,
                                 i
                                 )
                                 =
                                 
                                    max
                                 
                                 (
                                 0
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                                 -
                                 T
                                 (
                                 t
                                 )
                                 )
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 E
                                 [
                                 HDD
                                 (
                                 t
                                 +
                                 1
                                 ,
                                 j
                                 )
                                 ]
                                 )
                                 
                                 for
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                              
                           
                        where HDD (t,
                        i) is the expected HDD at a given node in regime i at period t. Expectations of future conditional HDD, E[HDD (t
                        +1,
                        j)], are taken using the appropriate conditional branch probabilities.

In this two-state regime-switching model, where each regime is governed by a Brownian motion, the stochastic component, x
                        
                           t
                        , of the temperature can be represented by x
                        
                           t,i
                        , if x
                        
                           t
                         is in regime i, with unconditional probability p
                        
                           i
                        , for i
                        =1, 2, where 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           
                        . Accordingly,
                           
                              (17)
                              
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                   is in regime
                                                   
                                                   1
                                                   
                                                   with probability
                                                   
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                   where
                                                   
                                                   
                                                      
                                                         dx
                                                      
                                                      
                                                         t
                                                         ,
                                                         1
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   dt
                                                   +
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   dz
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                         ,
                                                         2
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                   is in regime
                                                   
                                                   2
                                                   
                                                   with probability
                                                   
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                   where
                                                   
                                                   
                                                      
                                                         dx
                                                      
                                                      
                                                         t
                                                         ,
                                                         2
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   dt
                                                   +
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   dz
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where μ
                        
                           i
                         and σ
                        
                           i
                         are the mean and volatility of the Brownian motion in regime i, and dz is the increment of the Wiener process. The step sizes of the regimes can be determined by the following equation:
                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       h
                                    
                                 
                                 ,
                                 
                                 for
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 .
                              
                           
                        
                     

As discussed in Section 4.1, a pentanominal lattice for the two-state regime-switching model is developed by adjusting the step size of one regime so that the step sizes of two regimes have a 1:2 ratio. The branch probabilities are then obtained by matching the moments of the lattice to the moments of the distributions and given by Eqs. (19)–(21) (Wahab & Lee, 2009):
                           
                              (19)
                              
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       u
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      j
                                                      
                                                         
                                                            
                                                               
                                                                  ϕ
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                   
                                                
                                                h
                                             
                                             
                                                (
                                                j
                                                
                                                   
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       d
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      j
                                                      
                                                         
                                                            
                                                               
                                                                  ϕ
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                   
                                                
                                                h
                                             
                                             
                                                (
                                                j
                                                
                                                   
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       m
                                    
                                 
                                 =
                                 1
                                 -
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       u
                                    
                                 
                                 -
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       d
                                    
                                 
                                 .
                              
                           
                        
                     

Finally, the same three-step procedure presented in Section 4.1 is used to calculate the expected HDD or CDD using this lattice.

In this two-state regime-switching model, where each regime is governed by a mean-reverting process, the stochastic component, x
                        
                           t
                        , of the temperature can be represented by x
                        
                           t,i
                        , if x
                        
                           t
                         is in regime i, with unconditional probability p
                        
                           i
                        , for i
                        =1, 2, where 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           
                        . Accordingly,
                           
                              (22)
                              
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                   is in regime
                                                   
                                                   1
                                                   
                                                   with probability
                                                   
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                   where
                                                   
                                                   
                                                      
                                                         dx
                                                      
                                                      
                                                         t
                                                         ,
                                                         1
                                                      
                                                   
                                                   =
                                                   β
                                                   (
                                                   α
                                                   -
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                         ,
                                                         1
                                                      
                                                   
                                                   )
                                                   dt
                                                   +
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   dz
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                         ,
                                                         2
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                   is in regime
                                                   
                                                   2
                                                   
                                                   with probability
                                                   
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                   where
                                                   
                                                   
                                                      
                                                         dx
                                                      
                                                      
                                                         t
                                                         ,
                                                         2
                                                      
                                                   
                                                   =
                                                   β
                                                   (
                                                   α
                                                   -
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                         ,
                                                         2
                                                      
                                                   
                                                   )
                                                   dt
                                                   +
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   dz
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where β is the speed and α is the mean of the mean-reverting process that remain the same in each regime, but volatilities of the mean-reverting processes, σ
                        1 and σ
                        2 switches between regimes or states, and dz is the increment of the Wiener process.

Following the three-step procedure described in Section 4.1, a pentanomial lattice is constructed for which the step size of each regime is calculated by Eq. (7). The branch probabilities for each lattice are determined by Eqs. (10)–(12). The expected HDD is calculated by Eq. (16).

The binomial lattice presented in Nelson and Ramaswamy (1991) is applied to model the stochastic component, x
                        
                           t
                        , of the temperature by a mean-reverting process. The step size is defined by Eq. (7). At any node, x
                        
                           t
                         may jump up or down with the corresponding branch probabilities given by Eqs. (23) and (24):
                           
                              (23)
                              
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             b
                                          
                                       
                                       ,
                                       u
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         h
                                                      
                                                   
                                                   β
                                                   (
                                                   α
                                                   -
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                   /
                                                   2
                                                   σ
                                                
                                                
                                                   if
                                                   
                                                   0
                                                   ⩽
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         h
                                                      
                                                   
                                                   β
                                                   (
                                                   α
                                                   -
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                   /
                                                   2
                                                   σ
                                                   ⩽
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         h
                                                      
                                                   
                                                   β
                                                   (
                                                   α
                                                   -
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                   /
                                                   2
                                                   σ
                                                   <
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   otherwise.
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             b
                                          
                                       
                                       ,
                                       d
                                    
                                 
                                 =
                                 1
                                 -
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             b
                                          
                                       
                                       ,
                                       u
                                    
                                 
                                 .
                              
                           
                        
                     

Using this binomial lattice, the same three-step procedure as presented in Section 4.1 is utilized to calculate the expected HDD or CDD. However, in the binomial lattice, the recursive function of the dynamic programming approach is modified as follows:
                           
                              (25)
                              
                                 HDD
                                 (
                                 t
                                 )
                                 =
                                 
                                    max
                                 
                                 (
                                 0
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                                 -
                                 T
                                 (
                                 t
                                 )
                                 )
                                 +
                                 (
                                 E
                                 [
                                 HDD
                                 (
                                 t
                                 +
                                 1
                                 )
                                 ]
                                 )
                                 .
                              
                           
                        
                     

This section discusses the implementation of the models developed using numerical examples. To illustrate details of these models, four-period (four-day) lattices are presented as examples for Model 1. Since Model 2 and Model 3 are also two-state regime-switching models, they follow the same procedure and steps illustrated for Model 1. Section 5.4 shows the lattice construction and HDD calculations presented for Model 4, which is based on a single-regime approach.

For the model described in Section 4.1, the regime parameters are obtained by discretizing Eq. (6) for regime 1 as a first order autoregressive AR (1) form of Δx
                        
                           t,1
                        =
                        c
                        1
                        +
                        b
                        1
                        x
                        
                           t−1
                        +
                        ∊
                        
                           t,1 and regime 2 as a regressive form of Δx
                        
                           t,2
                        =
                        c
                        2
                        +
                        ∊
                        
                           t,2, where c
                        1 and c
                        2 are the intercepts, b
                        1 is the slope or the first order coefficient of AR (1), ∊
                        
                           t,1
                        ∼
                        N (0,
                        σ
                        1) and ∊
                        
                           t,2
                        ∼
                        N (0,σ
                        2) (Alexander, 2008, chap. I.3.7.1). Table 3 shows the parameters obtained that are estimated using the log-likelihood function maximized by the BFGS method (Brooks, 2009, chap. 9.2).

Accordingly, the speed, β, and the mean, α, of regime 1 are calculated respectively by using the relationships between the continuous time mean-reverting process and discretized AR (1) as b
                        1
                        =(1+
                        β)−1 and c
                        1
                        =(αβ)(1+
                        β)−1 (Alexander, 2008, chap. I.3.7.1). The intercept c
                        2 is interpreted as the mean of regime 2 (Brooks, 2008, chap. 3.2). These parameters are given in Table 4
                        .

To construct the corresponding lattice, the step sizes 
                           
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              =
                              3.80
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              1.88
                           
                         are obtained from Eqs. (7) and (8), respectively. According to Section 4.1, since 
                           
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                           
                         is less than half of 
                           
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                           
                         is increased from 1.88 to 1.90 (i.e., half of the step size of 3.80 of regime 1) to efficiently merge the nodes of the lattice. The lattice expands in the forward direction with an increase in the number of nodes in accordance with (4t
                        −3), where t is the number of periods in the lattice.

The branch probabilities for the mean-reverting process (regime 1) are obtained using Eqs. (10)–(12). Since the step-size of this regime is unchanged, the middle branch probability is zero. Table 5
                         shows the other two branch probabilities of nodes from A to F in Fig. 3
                        .

The upward, middle, and downward branch probabilities for the Brownian motion (regime 2) are calculated as 0.05, 0.94, and 0.01, respectively, using Eqs. (13)–(15). Following the three-step procedure described in Section 4.1, Fig. 3(a) shows a four-day pentanomial lattice for x
                        
                           t
                         for the month of December, 2008. If x
                        
                           t
                         is in regime 1 at node A, it can stay in regime 1 (nodes B and F) or switch to regime 2 (i.e., nodes C, D, and E) in the next period. Similarly, if x
                        
                           t
                         is in regime 2 at node A, it can stay in regime 2 or switch to regime 1 in the next period. The lattice is initialized with x
                        
                           t
                        
                        =1.34 on December 1st. In the next period, the values of x
                        
                           t
                         at nodes B and C are 1.34+2×1.90=5.14 and 1.34+1.90=3.24 respectively. The temperature is now retrieved by adding corresponding S(t)=−0.04, −0.23, −0.42, and −0.60 of the 1st, 2nd, 3rd and 4th of December. The temperature on December 1st is retrieved as x
                        
                           t
                        
                        +
                        S(t)=1.34+(−0.04)=1.3 at node A in Fig. 3(b). In the next day, the temperature at node B is obtained as: 5.14+(−0.23)=4.91 and at node C as: 3.24+(−0.23)=3.01.

The value of HDD is calculated as max (0,18−12.14)=5.86 at the topmost node in the last period of Fig. 4
                        . Applying Eq. (16), the expected HDD is now calculated, for example, in period 2 of Fig. 4, at node B, as:
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             43.30
                                             =
                                             
                                                max
                                             
                                             (
                                             0
                                             ,
                                             18
                                             -
                                             (
                                             4.91
                                             )
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             +
                                             0.90
                                             ×
                                             (
                                             0.31
                                             ×
                                             21.38
                                             +
                                             0.0
                                             ×
                                             28.05
                                             +
                                             0.69
                                             ×
                                             34.72
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             +
                                             0.10
                                             ×
                                             (
                                             0.05
                                             ×
                                             23.28
                                             +
                                             0.94
                                             ×
                                             26.98
                                             +
                                             0.01
                                             ×
                                             30.67
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             40.71
                                             =
                                             
                                                max
                                             
                                             (
                                             0
                                             ,
                                             18
                                             -
                                             (
                                             4.91
                                             )
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             +
                                             0.21
                                             ×
                                             (
                                             0.31
                                             ×
                                             21.38
                                             +
                                             0.0
                                             ×
                                             28.05
                                             +
                                             0.69
                                             ×
                                             34.72
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             +
                                             0.79
                                             ×
                                             (
                                             0.05
                                             ×
                                             23.28
                                             +
                                             0.94
                                             ×
                                             26.98
                                             +
                                             0.01
                                             ×
                                             30.67
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Working backwards from day 4 to day 1, at the root node of Fig. 4, the expected HDD for regimes 1 and 2 are 69.74 and 68.27, respectively. If the unconditional regime probabilities are considered to be the initial regime, the expected HDD is 0.67×69.74+0.33×68.27=69.25.

For the model described in Section 4.2, the regime parameters are estimated by discretizing Eq. (17) for regime 1 and regime 2, respectively, in the form of Δx
                        
                           t,1
                        =
                        c
                        1
                        +
                        ∊
                        
                           t,1 and Δx
                        
                           t,2
                        =
                        c
                        2
                        +
                        ∊
                        
                           t,2, where c
                        1 and c
                        2 are the means; and ∊
                        
                           t,1
                        ∼N (0,
                        σ
                        1) and ∊
                        
                           t,2
                        ∼N (0,
                        σ
                        2). These parameters based on daily temperature data are shown in Table 6
                        .

To construct the corresponding lattice, 
                           
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              =
                              1.88
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              3.81
                           
                         are calculated by using Eq. (18). In order to merge the nodes efficiently, 
                           
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                           
                         is increased from 1.88 to 1.905, which is half of 
                           
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                           
                        . The branch probabilities are computed using Eqs. (19)–(21). Regime 1 has probabilities of 0.58 (upward), 0.02 (middle), and 0.40 (downward); and Regime 2 has probabilities of 0.47 (upward), 0.0 (middle) and 0.53 (downward). The three-step procedure described in Section 4.1 is applied to construct the lattices and to calculate the expected HDD.

For the model described in Section 4.3, the parameters are obtained by discretizing Eq. (22) for regime 1 and regime 2 respectively in the form of AR (1) as Δx
                        
                           t,1
                        =
                        c
                        +
                        bx
                        
                           t−1
                        +
                        ∊
                        
                           t,1 and Δx
                        
                           t,2
                        =
                        c
                        +
                        bx
                        
                           t−1
                        +
                        ∊
                        
                           t,2, where c is the intercept, b is the slope or the first order coefficient of AR (1), ∊
                        
                           t,1
                        ∼
                        N (0,
                        σ
                        1) and ∊
                        
                           t,2
                        ∼
                        N (0,
                        σ
                        2) (Alexander, 2008, chap. I.3.7.1). It is found that c
                        =−0.008 and b
                        =0.002. From the relationship between the mean-reverting process given in Eq. (22) and the discretized AR (1), the following relationship can be written: b
                        =(1+
                        β)−1 and c
                        =(αβ)(1+
                        β)−1 (Alexander, 2008, chap. I.3.7.1). Consequently, it is found that β
                        =457.72 and α
                        =−0.008. The regime parameters are given in Table 7
                        .

The calculation of step size and the construction of lattices for this model are the same as described for Model 1. The step sizes, 
                           
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              =
                              3.90
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              2.28
                           
                        , are obtained from Eq. (7). The step size 
                           
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              =
                              3.90
                           
                         is then adjusted to 4.56 using Eq. (9). The branch probabilities are obtained from Eqs. (10)–(12).

For the model described in Section 4.4, the parameters are obtained using the least-square first order autoregression method. The parameters are β
                        =0.28, α
                        =−0.02, and σ
                        =3.05. The branch probabilities of the binomial lattice are obtained by using Eqs. (23) and (24).

Node A in Fig. 5
                        (a) is initialized with the same value of 1.34 similar to node A in Fig. 3. The value at node B in the next level is 1.34+3.05=4.39 and the value at node C is 1.34−3.05=−1.71. Fig. 5(b) is the lattice for temperature built by adding the corresponding seasonal component, S(t), with x
                        
                           t
                        . For example, the value at node A in Fig. 5(b) is 1.34+(−0.04)=1.30. Table 8
                         presents the branch probabilities for the first three periods of the binomial lattices shown in Fig. 5.

The expected HDD, as shown in Fig. 6
                        , is calculated using Eq. (25). Working backwards from period 4 to period 1, at the root node of Fig. 6, the expected HDD is 68.00.

The expected heating degree days (HDD) indices from the models are compared with the actual HDD indices over the period of 2005–2008. At CME, for the city of Toronto, Canada, HDD months are from January to April and from October to December; and CDD months are from April to October. Fig. 7
                         shows the comparison of the expected monthly average HDD with the actual monthly average HDD. It is evident from the figure that for most of the HDD months, for example, for the months of January, March, April, and October, the expected monthly average HDDs obtained from Model 1 lies more closely with the actual monthly average HDD.


                        Fig. 8
                         shows the comparison of CDD. Again, the expected monthly average CDD obtained from Model 1 is observed to be very close to the actual monthly average CDD for all CDD months. Therefore, it can be concluded that for both HDD and CDD months, Model 1, which is a two-state regime-switching model with a mean-reverting process and a Brownian motion, estimates the expected monthly HDD and CDD more closely to the actual HDD and CDD than the other three models. Considering unconditional probabilities for this model, it is found that there is a 
                           
                              68
                              %
                              
                                 
                                    
                                       ≈
                                       
                                          
                                             1
                                             -
                                             0.79
                                          
                                          
                                             1
                                             +
                                             0.21
                                             -
                                             0.90
                                          
                                       
                                    
                                 
                              
                           
                         probability of being in the mean-reverting regime. Consequently, it can be inferred that the temperature tends to stay in a base regime of mean-reverting process. A deviation from this regime prompted by a Brownian motion is relatively short lived and brought back to the base regime by a mean-reverting process. It is also observed that January, February, March and December are prominent HDD months, while June, July and August are prominent CDD months for the city of Toronto, Canada.

Furthermore, as there are seasonal HDD options (e.g., more than one-month options), Figs. 9 and 10
                        
                         show the comparison of the actual seasonal HDD (CDD) with the expected seasonal HDD (CDD) obtained using Model 1. All the calculations throughout the paper are carried out with a market price of risk, λ
                        =0.10.

The observation from Figs. 9 and 10 also shows that while the actual seasonal HDDs are in the thousands, the actual seasonal CDDs are in the hundreds, suggesting more heating requirements in Toronto, Canada, than cooling requirements. Another point is that the average daily temperatures of CDD months – from April to October – are 6.3°Celsius, 12.9°Celsius, 17.8°Celsius, 20.8°Celsius, 19.9°Celsius, 15.3°Celsius, and 8.9°Celsius, respectively (Environment Canada, 2009). It is observed that the daily average temperatures of only July and August are higher than 18°Celsius, above which CDD is counted and accumulated. Hence, in Fig. 10, the seasonal CDD curves begin flatly during April to May and end flatly during September to October. Since the shoulder months of April and October have little effects on seasonal CDD, the CME could reconsider the CDD months for Toronto, Canada, by excluding the months of April and October.

The challenge of pricing temperature-based weather derivatives lies on the appropriate modeling of dynamic behavior of temperature. As stated in Section 2.2, pricing mechanisms of weather derivatives in the literature range from the marginal utility technique (e.g., Davis, 2001) to the simulation approach based on the Ornstein–Uhlenbeck process (e.g., Alaton et al., 2002) to an autoregressive temperature modeling approach (e.g., Benth et al., 2007). The resulting option prices obtained here are based on regime-switching modeling of temperature dynamics and are dependent on the choice of the strike heating degree day, K, tick size, κ, and market price of risk, λ. An important point to note, as observed from Fig. 7, is that the expected HDD obtained from Model 1 is very close to the actual HDD. Therefore, Model 1 is used in the valuation of the option price. To price a standard HDD call option, the following payoff function is used:
                           
                              (26)
                              
                                 p
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       rt
                                    
                                 
                                 κ
                                 [
                                 
                                    max
                                 
                                 (
                                 HDD
                                 -
                                 K
                                 ,
                                 0
                                 )
                                 ]
                                 ,
                              
                           
                        where HDD is the expected HDD during the contract period [0,
                        t], r is the risk-free interest rate, κ is the tick size, and K is the strike HDD.

In the following examples, κ
                        =$20 per HDD; r
                        =5%; the contract period for the monthly option price is from December 1 to December 31, 2008; and the seasonal option prices are calculated for HDD seasons (October, November, and December). For example, the expected HDD (from Model 1) for the contract period for the month of December 2008 is 632.28 and the option price for K
                        =620 is, therefore:
                           
                              
                                 p
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       (
                                       0.05
                                       )
                                       (
                                       
                                          
                                             31
                                          
                                          
                                             365
                                          
                                       
                                       )
                                    
                                 
                                 ×
                                 20
                                 ×
                                 [
                                 
                                    max
                                 
                                 (
                                 632.28
                                 -
                                 620
                                 ,
                                 0
                                 )
                                 ]
                                 =
                                 $
                                 244.56
                                 .
                              
                           
                        
                     


                        Fig. 11
                        (top) shows the variation of monthly option prices over a range of the strike HDD. As the strike HDD, K, increases from 610 to 650, the option price decreases until the strike HDD equals to the expected HDD at 632.28 and then falls to zero.


                        Fig. 11(bottom) shows the variation in seasonal (one month of October, two months of October and November, and three months of October, November, and December of 2008) option prices over a range of strike HDD from 100 to 1400. It is evident from Fig. 11(bottom) that as more months are included into the contract, the more premium one has to pay.

As mentioned earlier in Section 5.5 that a value of λ
                        =0.10 is assumed for all previous calculations. A sensitivity analysis is carried out to show the effect of market price of risk, λ, on option price by varying λ between 0 and 0.30. Fig. 12
                         shows that the monthly option price increases with the increase in λ. This is consistent with the finding of Cao and Wei (2004) that the market price of risk has a significant role for temperature derivatives.

@&#CONCLUSIONS@&#

Modeling the temperature dynamics is essential for pricing temperature-based weather options. This paper discusses the rationale behind the regime-switching behavior of temperature and examines regime-switching approaches to model the temperature dynamics of the city of Toronto, Canada. The study finds that there exists a regime-switching behavior in Toronto‘s temperature induced by abrupt changes in the city’s temperature. Three two-state regime-switching models and one single regime model have been developed. The first model assumes that one regime is governed by a mean-reverting process and the other by a Brownian motion. The second model is based on two regimes, each of which is governed by a Brownian motion. The third model assumes that each regime is governed by a mean-reverting process in which the mean and speed of the mean-reversion remain the same, but only the volatility switches between the states. In the fourth model, the temperature dynamics are governed by a single mean-reverting process. Each model is used to calculate the expected HDD and CDD for a monthly contract period. Results show that the two-state regime-switching model with a mean-reverting process and a Brownian motion determines both HDD and CDD more closely to the actual HDD and CDD than those obtained by the other three models. Using this model, monthly and seasonal call options are then priced under the martingale probability approach by adjusting the process drift to the risk-neutral equivalent drift considering the risk premium. One of the future improvements could be to extend the existing Markov regime-switching models with additional flexibility by incorporating time-varying transition probabilities.

@&#REFERENCES@&#

