@&#MAIN-TITLE@&#Core-based cost allocation in the cooperative traveling salesman problem

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A cooperative TSP model formulation is provided.


                        
                        
                           
                           Release dates are taken into account.


                        
                        
                           
                           A cost allocation for the salesmen is defined by means of a cooperative game theory solution concept, i.e. the (least) core.


                        
                        
                           
                           Mathematical programming is used to compute a (least) core element.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Traveling salesman problem

Cooperative game theory

Core

Cost allocation

@&#ABSTRACT@&#


               
               
                  This paper presents a cost allocation scheme for a horizontal cooperation of traveling salesmen that is implemented a priori and provides expected costs for the coalition members. The cost allocation is determined using the core concept. To compute the value of the characteristic function over the whole planning horizon the TSP with release dates combined with simulation is used. The developed core computation algorithm, based on mathematical programming techniques, provides a core element or, in case of an empty core, a least-core element. To decrease the computational effort of core computation a row generation procedure is implemented. The developed computation study tests the computational performance of the solution procedure.
               
            

@&#INTRODUCTION@&#

For logistic service providers horizontal cooperation has a variety of potentials. It offers increase of profitability and competitiveness, capacity optimization, cost reduction and network improvement. The issue of profit distribution among the partners plays the crucial role on a way to the establishment of cooperation. As studies show (see Muir, 2009, 2011) there are multiple barriers on the way to practical implementation of horizontal cooperation among logistic service providers, and the lack of profit sharing models belongs to the common ones.

In this paper we develop a cost allocation scheme for a horizontal cooperation of traveling salesmen using cooperative game theory. This cost allocation scheme can be implemented before the actual planning horizon (or before the establishment of cooperation agreement) and provides expected costs for coalition members, so they can value their savings and decide if they want to be a part of the partnership. Cooperative game theory offers several well-known allocation concepts: e.g. the core (introduced by Gilles (1959)), the Shapley value (proposed by Shapley (1953)) and the nucleolus (developed by Schmeidler (1969)). In a previous study (see Kimms & Kozeletskyi, 2013) the cost allocation for the cooperative traveling salesman problem was determined using the Shapley value. This paper focuses on the core concept and presents another modeling approach than in Kimms and Kozeletskyi (2013) where dynamic programming was used. Dynamic programming can be efficiently used for this problem only in combination with approximate dynamic programming techniques that give only an approximation of the total costs. This works well for the Shapley value, however for the core, where stability constraints should be proved (see Section 4 for a definition), approximation may lead to the distortion of results. For that reason we developed the mathematical programming model for computation of total costs, that is solved optimally.

This paper has the following structure. In the next section we give a brief literature review on horizontal cooperation in transportation problems. In Section 3 the optimization model and the resulting exact solution procedure for the cooperative TSP are formulated. Section 4 presents the core computation algorithm for this problem. In Section 5 we show results of our computational study for the performance and the solution quality of the developed algorithm. Section 6 concludes this paper.

@&#LITERATURE REVIEW@&#

The literature on horizontal partnerships in transportation planning focuses mostly on categorizing the cooperation forms and empirical studies of possible benefits and barriers. Thus quantitative planning models and especially game-theoretic approaches are barely studied. Cruijssen, Cools, and Dullaert (2007) conducted a survey on potential benefits from the horizontal cooperation among logistic service providers in Flanders. An extension of this study was presented in Cruijssen, Dullaert, and Joro (2010), where the efficiency of cooperating and non-cooperating road companies is compared. Cruijssen, Borm, Fleuren, and Hamers (2010) presented a supplier-initiated outsourcing of transportation requests and proposed an allocation approach for resulting savings. Verstrepen, Cools, Cruijssen, and Dullaert (2009) developed a framework for classification of horizontal cooperation in logistics. Muir (2009, 2011) presented the survey results on identification of drivers, benefits and barriers for horizontal cooperation among European and North American logistic companies. Cruijssen, Dullaert, and Fleuren (2007) provided a broad literature review on impediments and drivers in horizontal cooperation in transport and logistics.

An efficient cooperation in transportation planning requires first of all decision support models for planning purposes. Krajewka and Kopfer (2006) developed a general framework for the collaborative transportation planning model and designed a request exchange mechanism based on combinatorial auctions. Wang and Kopfer (2014) proposed a route-based combinatorial auction for the collaborative transportation planning for less-then-truckload transportation requests. Wang, Kopfer, and Gendreau (2014) studied operational planning of freight forwarders taking into account subcontracting and collaborative planning. Berger and Bierwirth (2010) proposed procedures for reassignment of transportation requests with limited information transfer. Özener, Ergun, and Savelsbergh (2011) studied exchange mechanisms for various scenarios with different information sharing concepts. Nadarajah and Bookbinder (2013) employed guided local search for developing a solution procedure for collaborative vehicle routing problems with time windows. Adenso-Diaz, Lozano, Garcia-Carbajal, and Smith-Miles (2014a) presented a model for connecting deliveries of different transportation companies. In Adenso-Diaz, Lozano, Garcia-Carbajal, and Smith-Miles (2014b) a question of predicting possible savings from cooperations is studied.

Profit-sharing approaches among freight carriers using the Shapley value were discussed in Krajewka, Kopfer, Laporte, Ropke, and Zaccour (2008). Frisk, Göthe-Lundgren, Jörnsten, and Rönnqvist (2010) presented the Equal Profit Method in the context of collaborative transport planning, however without proposing any solution procedure that solves the problem of exponential number of constraints in this method. D’Amours and Rönnqvist (2010) discussed issues on coalition building and sharing resources and benefits in collaborative logistics. Audy, D’Amours, and Rönnqvist (2012) presented a case study on cost savings among transportation companies from forest industry. Lozano, Moreno, Adenso-Diaz, and Algaba (2013) compared different cooperative game solution concepts for cost allocation on the example of full-truck-load collaborative planning. Guajardo and Rönnqvist (2015) studied coalitional structure and resulting cost allocations in collaborative logistics.

As our study focuses on the cooperation of salesmen and not on the cooperation of customers, this makes a crucial difference to the so-called routing games (introduced by Fishburn and Pollak (1983) on a TSP example) as they focus on the cooperation of customers in routing problems. This type of cooperative games was also studied by Potters, Curiel, and Tijs (1992) and extended by Göthe-Lundgren, Jörsten, and Värband (1996) and Engevall, Göthe-Lundgren, and Värband (2004) to the cooperation of customers in vehicle routing problems.

In this section we present an optimization model that computes total traveling cost for a given coalition in a cooperative case for the estimated demand outcome over the entire planning horizon. The optimization model is a variation of the multiple traveling salesman problem (mTSP) with multiple depots, that takes account of earliest arrival time for every customer (i.e. release dates). We call this problem cooperative traveling salesman problem with release dates (CTSPRD). In addition an optimal solution procedure for this problem is introduced.

The cooperation in this approach is defined through the joint planning of routes with the objective of minimizing the total traveling costs of a coalition. It means that in a coalition any salesman can visit any customer from this coalition. Furthermore our model considers cooperative planning that is realized on a short-time basis. As an example, this kind of cooperative planning defined in terms of TSP can be found at companies that perform a service at the customer’s site (e.g. maintenance, plumber, etc.). With such operations capacity restrictions of vehicles (as in VRPs) are not relevant and the capacity aspect is implied through the working hours (i.e. length of the tour in time units).

Let 
                        
                           N
                           =
                           {
                           1
                           ,
                           …
                           ,
                           n
                           }
                        
                      be a set of salesmen with depots 
                        
                           {
                           
                              0
                              1
                           
                           ,
                           …
                           ,
                           
                              0
                              n
                           
                           }
                        
                      and let 
                        
                           T
                           =
                           {
                           0
                           ,
                           …
                           ,
                           τ
                           }
                        
                      be our planning horizon divided into periods 
                        
                           0
                           ,
                           
                           1
                           ,
                           …
                           ,
                           τ
                        
                     . With every coalition S ⊆ N, S ≠ ∅ we associate the set of customers V(S). We assume that customer sets are disjoint: 
                        
                           ∀
                           k
                           ,
                           l
                           ∈
                           N
                           ,
                           
                           k
                           ≠
                           l
                           :
                           V
                           (
                           {
                           k
                           }
                           )
                           ∩
                           V
                           (
                           {
                           l
                           }
                           )
                           =
                           ∅
                        
                      and for two non-empty coalitions S, T⊆N we put that 
                        
                           V
                           (
                           S
                           ∪
                           T
                           )
                           =
                           V
                           (
                           S
                           )
                           ∪
                           V
                           (
                           T
                           )
                        
                     . With every customer i from V(S) we associate a time period 
                        
                           
                              d
                              i
                           
                           ∈
                           T
                           ,
                        
                      when his order is placed. In an a priori consideration di
                      is the result of the simulation procedure. Details on the simulation are given in Section 5. The problem can be represented as a directed graph 
                        
                           G
                           =
                           (
                           V
                           (
                           N
                           )
                           ,
                           A
                           ,
                           C
                           ,
                           T
                           )
                        
                      with the set of arcs A and the matrix of traveling costs 
                        
                           C
                           =
                           (
                           
                              c
                              
                                 i
                                 j
                              
                           
                           )
                        
                     . Furthermore we define for every arc (i, j) ∈ A traveling time tij
                      and the maximal length for every tour t
                     max.


                     Fig. 1 illustrates the problem description for an example with three salesmen and six customer nodes. The particular demand realization d in this example indicates the earliest period when the customer can be visited. For instance customers v
                     1 and v
                     3 can be planned in the initial period 0 while other customers appear during the periods 1–3.

For the formulation of the optimization model we define two types of decision variables. The binary decision variable xijk
                     :

                        
                           
                              
                                 
                                    x
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             
                                                if
                                                
                                                the
                                                
                                                arc
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                
                                                is
                                                
                                                used
                                                
                                                by
                                                
                                                the
                                                
                                                salesman
                                                
                                                k
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             otherwise
                                          
                                       
                                    
                                 
                              
                           
                        
                     identifies the assignment of customers to salesmen and cost minimal routes in the optimal solution. The real-valued decision variable δi
                      indicates the arrival time in node i and is also in combination with a large number M part of subtour elimination constraints. The problem formulation for coalition S⊆N, S ≠ ∅ is given as follows:

                        
                           (1)
                           
                              
                                 minimize
                                 
                                 
                                 
                                 
                                    F
                                    1
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       ∈
                                       N
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       V
                                       
                                          (
                                          S
                                          )
                                       
                                       ∪
                                       
                                          {
                                          
                                             0
                                             k
                                          
                                          }
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       V
                                       
                                          (
                                          S
                                          )
                                       
                                       ∪
                                       
                                          {
                                          
                                             0
                                             k
                                          
                                          }
                                       
                                    
                                 
                                 
                                    
                                       c
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       x
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                           
                        
                     s.t.

                        
                           (2)
                           
                              
                                 
                                    ∑
                                    
                                       k
                                       ∈
                                       S
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       V
                                       
                                          (
                                          S
                                          )
                                       
                                       ∪
                                       
                                          {
                                          
                                             0
                                             k
                                          
                                          }
                                       
                                    
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 =
                                 1
                                 
                                 i
                                 ∈
                                 V
                                 
                                    (
                                    S
                                    )
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    ∑
                                    
                                       k
                                       ∈
                                       S
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       V
                                       
                                          (
                                          S
                                          )
                                       
                                       ∪
                                       
                                          {
                                          
                                             0
                                             k
                                          
                                          }
                                       
                                    
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 =
                                 1
                                 
                                 j
                                 ∈
                                 V
                                 
                                    (
                                    S
                                    )
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       V
                                       
                                          (
                                          S
                                          )
                                       
                                       ∪
                                       
                                          {
                                          
                                             0
                                             k
                                          
                                          }
                                       
                                    
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       V
                                       
                                          (
                                          S
                                          )
                                       
                                       ∪
                                       
                                          {
                                          
                                             0
                                             l
                                          
                                          }
                                       
                                    
                                 
                                 
                                    x
                                    
                                       j
                                       i
                                       l
                                    
                                 
                                 ≤
                                 1
                                 
                                 i
                                 ∈
                                 V
                                 
                                    (
                                    S
                                    )
                                 
                                 ,
                                 
                                 k
                                 ,
                                 l
                                 ∈
                                 S
                                 ,
                                 k
                                 ≠
                                 l
                                 ,
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    δ
                                    j
                                 
                                 +
                                 M
                                 ≥
                                 
                                    δ
                                    i
                                 
                                 +
                                 
                                    t
                                    
                                       i
                                       j
                                    
                                 
                                 +
                                 M
                                 
                                    x
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 
                                 i
                                 ∈
                                 V
                                 
                                    (
                                    S
                                    )
                                 
                                 ,
                                 
                                 j
                                 ∈
                                 V
                                 
                                    (
                                    S
                                    )
                                 
                                 ,
                                 
                                 j
                                 ≠
                                 i
                                 ,
                                 
                                 k
                                 ∈
                                 S
                                 ,
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    δ
                                    i
                                 
                                 ≥
                                 
                                    d
                                    i
                                 
                                 
                                 i
                                 ∈
                                 V
                                 
                                    (
                                    S
                                    )
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (7)
                           
                              
                                 
                                    δ
                                    i
                                 
                                 ≤
                                 
                                    t
                                    max
                                 
                                 
                                 i
                                 ∈
                                 V
                                 
                                    (
                                    S
                                    )
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    x
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 ∈
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 
                                 i
                                 ,
                                 
                                 j
                                 ∈
                                 V
                                 
                                    (
                                    S
                                    )
                                 
                                 ,
                                 
                                 k
                                 ∈
                                 S
                                 .
                              
                           
                        
                     
                  

The optimal value of the objective function (1) corresponds to the total traveling cost for the coalition S. Constraints (2) and (3) are standard TSP constraints, which ensure that every node will be visited exactly once. Constraints (4) prevent that every salesman k cannot switch his affiliation to a different depot during his tour and therefore must return to his own depot 0
                        k
                     . Without these constraints the following situation can occur. Consider an example with 
                        
                           |
                           N
                           |
                           =
                           2
                           ,
                        
                     
                     
                        
                           V
                           (
                           N
                           )
                           =
                           {
                           1
                           ,
                           2
                           }
                           ,
                        
                     
                     
                        
                           
                              d
                              1
                           
                           =
                           
                              d
                              2
                           
                           =
                           0
                           ,
                        
                     
                     
                        
                           
                              t
                              max
                           
                           =
                           10
                        
                      and traveling times are set to 1. The illustration with traveling costs is presented in Fig. 2
                     .

Without constraints (4) the following assignment for variables xijl
                      is feasible: 
                        
                           
                              x
                              
                                 
                                    0
                                    1
                                 
                                 ,
                                 1
                                 ,
                                 1
                              
                           
                           =
                           1
                           ,
                        
                     
                     
                        
                           
                              x
                              
                                 1
                                 ,
                                 
                                    0
                                    2
                                 
                                 ,
                                 2
                              
                           
                           =
                           1
                           ,
                        
                     
                     
                        
                           
                              x
                              
                                 
                                    0
                                    2
                                 
                                 ,
                                 2
                                 ,
                                 2
                              
                           
                           =
                           1
                           ,
                        
                     
                     
                        
                           
                              x
                              
                                 2
                                 ,
                                 
                                    0
                                    1
                                 
                                 ,
                                 1
                              
                           
                           =
                           1
                        
                      as it satisfies all remaining constraints. This assignment means that the salesman 1 ends his tour in the depot 02 and the salesman 2 in the depot 01. Constraints (4) allow to prevent this kind of solutions. Constraints (5) are subtour elimination constraints, that also set an arrival time in every node. They are formulated as an extension of Miller–Tucker–Zemlin constraints (see Miller, Tucker, & Zemlin, 1960). For alternative definitions of subtour elimination constraints we refer to Punnen (2002). The earliest possible arrival time for every node i is stated in constrains (6) and the tour length is bounded through the constraints (7). The maximal length of the tour t
                     max represents a capacity restriction in our model. In combination with this restriction tij
                      can be seen not only as a traveling time from i to j but also as a traveling time that includes a service time at the customer j.

As the problem (1)–(8) is an NP-hard due to the NP-hardness of the classical TSP, we propose an optimal solution procedure that transforms this problem into the TSP with one salesman to reduce the computational effort for solving this problem. The proposed solution procedure is a modification of the transformation procedure proposed by Laporte, Nobert, and Taillefer (1988). This procedure provided good results for the cooperative TSP in a previous study (see Kimms & Kozeletskyi, 2013).

The idea of this procedure is the transformation of graph G into a new graph (we name it 
                        
                           G
                           ˇ
                        
                     ), where every depot 0
                        k
                      is depicted through two nodes 
                        
                           0
                           k
                           1
                        
                      and 
                        
                           0
                           k
                           2
                        
                      and a dummy node 0 is inserted. The new set of nodes for a coalition S is 
                        
                           
                              V
                              ˇ
                           
                           
                              (
                              S
                              )
                           
                           =
                           0
                           ∪
                           V
                           
                              (
                              S
                              )
                           
                           ∪
                           
                              (
                              
                                 ∪
                                 
                                    k
                                    ∈
                                    S
                                 
                              
                              
                                 ∪
                                 
                                    i
                                    =
                                    1
                                 
                                 2
                              
                              
                                 {
                                 
                                    0
                                    k
                                    i
                                 
                                 }
                              
                              )
                           
                        
                     . The new set of arcs 
                        
                           A
                           ˇ
                        
                      includes the following types of arcs:

                        
                           •
                           
                              A
                              1 - set of arcs from the dummy node to the first node of each depot 
                                 
                                    0
                                    k
                                    1
                                 
                              .


                              A
                              2 - set of arcs from the last node of each depot 
                                 
                                    0
                                    k
                                    2
                                 
                               to the dummy node 0.


                              A
                              3 - set of arcs from the first node of each depot to the customers.


                              A
                              4 - set of arcs from customers to the last node of each depot.


                              A
                              5 - set of arcs from the last node of each depot to the first node of every other depot.


                              A
                              6 - set of arcs from each customer to every other customer.


                              A
                              7 - set of loops for the depot nodes.

This transformation requires also redefinition of traveling costs and traveling times. The new traveling costs are:

                        
                           
                              
                                 
                                    
                                       c
                                       ˇ
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   A
                                                   1
                                                
                                                ∪
                                                
                                                   A
                                                   2
                                                
                                                ∪
                                                
                                                   A
                                                   5
                                                
                                                ∪
                                                
                                                   A
                                                   7
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                c
                                                
                                                   
                                                      0
                                                      k
                                                   
                                                   ,
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   A
                                                   3
                                                
                                                ,
                                                
                                                i
                                                =
                                                
                                                   0
                                                   k
                                                   1
                                                
                                                
                                                for
                                                
                                                some
                                                
                                                
                                                   k
                                                   ∈
                                                   S
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                c
                                                
                                                   i
                                                   ,
                                                   
                                                      0
                                                      k
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   A
                                                   4
                                                
                                                ,
                                                
                                                j
                                                =
                                                
                                                   0
                                                   k
                                                   2
                                                
                                                
                                                for
                                                
                                                some
                                                
                                                
                                                   k
                                                   ∈
                                                   S
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                c
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   A
                                                   6
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     And the new traveling times are:

                        
                           
                              
                                 
                                    
                                       t
                                       ˇ
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   A
                                                   1
                                                
                                                ∪
                                                
                                                   A
                                                   2
                                                
                                                ∪
                                                
                                                   A
                                                   7
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                t
                                                
                                                   
                                                      0
                                                      k
                                                   
                                                   ,
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   A
                                                   3
                                                
                                                ,
                                                
                                                i
                                                =
                                                
                                                   0
                                                   k
                                                   1
                                                
                                                
                                                for
                                                
                                                some
                                                
                                                
                                                   k
                                                   ∈
                                                   S
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                t
                                                
                                                   i
                                                   ,
                                                   
                                                      0
                                                      k
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   A
                                                   4
                                                
                                                ,
                                                
                                                j
                                                =
                                                
                                                   0
                                                   k
                                                   2
                                                
                                                
                                                for
                                                
                                                some
                                                
                                                
                                                   k
                                                   ∈
                                                   S
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                −
                                                M
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   A
                                                   5
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                t
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   A
                                                   6
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The assignment 
                        
                           
                              t
                              
                                 i
                                 j
                              
                           
                           =
                           −
                           M
                        
                      for (i, j) ∈ A
                     5 will be explained in the description of the constraints of the transformed model. We visualize the transformation of the graph using the example from Fig. 1. Fig. 3
                      shows a solution in the transformed graph where all nodes are visited in one tour. From this solution a single tour of every salesman k can be easily derived, as it corresponds to the sequence of customer nodes between depot nodes 
                        
                           0
                           k
                           1
                        
                      and 
                        
                           0
                           k
                           2
                        
                     .

The new binary decision variable yij
                      is 1 if arc (i, j) is selected for the tour and 0 otherwise. In addition we define variable γi
                      that indicates the nodes’ order in a solution and is important to ensure that every customer starts and ends his tour in his own depot. With this additional notation the new optimization problem can be formulated as follows:

                        
                           (9)
                           
                              
                                 minimize
                                 
                                 
                                 
                                 
                                    F
                                    2
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       
                                          V
                                          ˇ
                                       
                                       
                                          (
                                          S
                                          )
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       
                                          V
                                          ˇ
                                       
                                       
                                          (
                                          S
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          c
                                          ˇ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                    
                                       y
                                       
                                          i
                                          j
                                       
                                    
                                 
                              
                           
                        
                     
                  

s.t.

                        
                           (10)
                           
                              
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       
                                          V
                                          ˇ
                                       
                                    
                                 
                                 
                                    y
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 1
                                 
                                 i
                                 ∈
                                 
                                    V
                                    ˇ
                                 
                                 
                                    (
                                    S
                                    )
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (11)
                           
                              
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       
                                          V
                                          ˇ
                                       
                                    
                                 
                                 
                                    y
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 1
                                 
                                 j
                                 ∈
                                 
                                    V
                                    ˇ
                                 
                                 
                                    (
                                    S
                                    )
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (12)
                           
                              
                                 
                                    δ
                                    j
                                 
                                 +
                                 M
                                 ≥
                                 
                                    δ
                                    i
                                 
                                 +
                                 
                                    t
                                    
                                       i
                                       j
                                    
                                 
                                 +
                                 M
                                 
                                    y
                                    
                                       i
                                       j
                                    
                                 
                                 
                                 i
                                 ,
                                 
                                 j
                                 ∈
                                 
                                    V
                                    ˇ
                                 
                                 
                                    (
                                    S
                                    )
                                 
                                 ∖
                                 
                                    {
                                    0
                                    }
                                 
                                 ,
                                 
                                 i
                                 ≠
                                 j
                                 ,
                              
                           
                        
                     
                     
                        
                           (13)
                           
                              
                                 
                                    γ
                                    j
                                 
                                 +
                                 M
                                 ≥
                                 
                                    γ
                                    i
                                 
                                 +
                                 1
                                 +
                                 M
                                 
                                    y
                                    
                                       i
                                       j
                                    
                                 
                                 
                                 i
                                 ,
                                 
                                 j
                                 ∈
                                 
                                    V
                                    ˇ
                                 
                                 
                                    (
                                    S
                                    )
                                 
                                 ∖
                                 
                                    {
                                    0
                                    }
                                 
                                 ,
                                 
                                 i
                                 ≠
                                 j
                                 ,
                              
                           
                        
                     
                     
                        
                           (14)
                           
                              
                                 
                                    γ
                                    
                                       0
                                       k
                                       1
                                    
                                 
                                 ≤
                                 
                                    γ
                                    
                                       0
                                       k
                                       2
                                    
                                 
                                 
                                 k
                                 ∈
                                 S
                                 ,
                              
                           
                        
                     
                     
                        
                           (15)
                           
                              
                                 
                                    y
                                    
                                       
                                          0
                                          k
                                          1
                                       
                                       ,
                                       
                                          0
                                          k
                                          1
                                       
                                    
                                 
                                 =
                                 
                                    y
                                    
                                       
                                          0
                                          k
                                          2
                                       
                                       ,
                                       
                                          0
                                          k
                                          2
                                       
                                    
                                 
                                 
                                 k
                                 ∈
                                 S
                                 ,
                              
                           
                        
                     
                     
                        
                           (16)
                           
                              
                                 
                                    δ
                                    i
                                 
                                 ≥
                                 
                                    d
                                    i
                                 
                                 
                                 i
                                 ∈
                                 
                                    V
                                    ˇ
                                 
                                 
                                    (
                                    S
                                    )
                                 
                                 ∖
                                 
                                    {
                                    0
                                    }
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (17)
                           
                              
                                 
                                    δ
                                    
                                       0
                                       k
                                       2
                                    
                                 
                                 ≤
                                 
                                    t
                                    max
                                 
                                 
                                 k
                                 ∈
                                 S
                                 ,
                              
                           
                        
                     
                     
                        
                           (18)
                           
                              
                                 
                                    γ
                                    i
                                 
                                 ≥
                                 0
                                 
                                 
                                 i
                                 ∈
                                 
                                    V
                                    ˇ
                                 
                                 
                                    (
                                    S
                                    )
                                 
                                 ∖
                                 
                                    {
                                    0
                                    }
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (19)
                           
                              
                                 
                                    y
                                    
                                       i
                                       j
                                    
                                 
                                 ∈
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 
                                 
                                 i
                                 ,
                                 
                                 j
                                 ∈
                                 
                                    V
                                    ˇ
                                 
                                 
                                    (
                                    S
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

The objective function (9) gives the total traveling cost for coalition S. Constraints (10)–(12), (16), (17) have the same meaning as constraints (2), (3), (5)–(7) respectively. This transformation allows a simplification of constraints (7) as now only the depot nodes 
                        
                           0
                           k
                           2
                        
                      for all k ∈ S should be considered. The assignment 
                        
                           
                              t
                              
                                 i
                                 j
                              
                           
                           =
                           −
                           M
                        
                      for (i, j) ∈ A
                     5 is crucial for the formulation of constraints (16) and (7), as it resets the time counter in variable δi
                      each time a tour from a new depot is started. Therefore this allows a correct consideration of the time restriction t
                     max. Additional constraints (13)–(15) correspond to constraints (4) from the previous formulation and ensure that salesmen cannot change their affiliation during the tour and end tours in their own depots. Constraints (13) and (14) state in this context that depots are visited in the correct sequence, and constraints (15) imply that for every k ∈ S both nodes 
                        
                           0
                           k
                           1
                        
                      and 
                        
                           0
                           k
                           2
                        
                      are simultaneously either selected or not selected as part of the tour. If they are not selected, then loops are assigned to these nodes and for this purpose the set of arcs A
                     7 has been defined.

Before we start with the core computation procedure we provide a formal definition of the cooperative traveling salesman game and of the core. In the general case the cooperative cost game Γ is defined as a pair 
                        
                           Γ
                           =
                           (
                           N
                           ,
                           c
                           )
                           ,
                        
                      where N is a set of players also called the grand coalition (in our case the set of salesmen) and 
                        
                           c
                           :
                           
                              2
                              N
                           
                           →
                           R
                        
                      is the characteristic function that associates with every coalition S⊆N the value c(S). The value c(S) provides the total cost of coalition S. The cooperative traveling salesman game is defined as a pair (N, c), where the value c(S) equals to the optimal value of the objective function (1). It was proved in Kimms and Kozeletskyi (2013) that the cooperative TSP game is subadditive and non-monotonic. Subadditivity means that the total cost of any coalition is not larger than the sum of costs of any disjunctive partition, i.e. for any S, T⊆N such that 
                        
                           S
                           ∩
                           T
                           =
                           ∅
                        
                      holds 
                        
                           c
                           (
                           S
                           ∪
                           T
                           )
                           ≤
                           c
                           (
                           S
                           )
                           +
                           c
                           (
                           T
                           )
                        
                     . The property of non-monotonicity implies that a larger coalition may have lower cost than a smaller one. Proofs for these properties can also be found in the online supplement of this paper.

A core element is a vector 
                        
                           π
                           ∈
                           
                              R
                              N
                           
                        
                      that completely allocates the total cost c(N) among all players from the grand coalition N (this property is called efficiency) and assigns to each player i a cost allocation πi
                      that cannot be dominated by any other subcoalition from N (this property is called stability). The core is as a set of all such vectors 
                        
                           π
                           ∈
                           
                              R
                              N
                           
                        
                      and is formally defined as follows:

                        
                           (20)
                           
                              
                                 C
                                 
                                    (
                                    N
                                    ,
                                    c
                                    )
                                 
                                 =
                                 
                                    {
                                    π
                                    ∈
                                    
                                       R
                                       N
                                    
                                    
                                       |
                                    
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          N
                                       
                                    
                                    
                                       π
                                       i
                                    
                                    =
                                    c
                                    
                                       (
                                       N
                                       )
                                    
                                    ,
                                    
                                    ∀
                                    S
                                    ⊂
                                    N
                                    ,
                                    
                                    S
                                    ≠
                                    ∅
                                    :
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          S
                                       
                                    
                                    
                                       π
                                       i
                                    
                                    ≤
                                    c
                                    
                                       (
                                       S
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     
                  

The non-monotonicity of the cooperative TSP game allows negative cost allocations to the players. As Drechsel and Kimms (2010) showed, in case of monotone games one can consider only 
                        
                           π
                           ∈
                           
                              R
                              +
                              N
                           
                        
                     . However the core can be empty, as the stability constraints may not always be fulfilled. Bondareva (1963) and Shapley (1967) proved the necessary and sufficient condition for the non-emptiness of the core. In case the core is empty we will refer to the relaxed version of it known as the least-core. For a given ϵ ≥ 0 we consider a relaxation of the stability constraint and define an ϵ-core C
                     ϵ(c):

                        
                           (21)
                           
                              
                                 
                                    C
                                    ϵ
                                 
                                 
                                    (
                                    c
                                    )
                                 
                                 
                                 =
                                 
                                 
                                    {
                                    π
                                    ∈
                                    
                                       R
                                       N
                                    
                                    
                                       |
                                    
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          N
                                       
                                    
                                    
                                       π
                                       i
                                    
                                    
                                    =
                                    
                                    c
                                    
                                       (
                                       N
                                       )
                                    
                                    ,
                                    
                                    ∀
                                    S
                                    ⊂
                                    N
                                    ,
                                    
                                    S
                                    ≠
                                    ∅
                                    :
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          S
                                       
                                    
                                    
                                       π
                                       i
                                    
                                    ≤
                                    c
                                    
                                       (
                                       S
                                       )
                                    
                                    
                                    +
                                    
                                    ϵ
                                    }
                                 
                              
                           
                        
                     
                  


                     Maschler, Peleg, and Shapley (1979) define the least-core as an non-empty ϵ-core with the smallest ϵ:

                        
                           (22)
                           
                              
                                 
                                    C
                                    L
                                 
                                 
                                    (
                                    N
                                    ,
                                    c
                                    )
                                 
                                 =
                                 
                                    ⋂
                                    
                                       ϵ
                                       ≥
                                       0
                                       :
                                       
                                          C
                                          ϵ
                                       
                                       
                                          (
                                          c
                                          )
                                       
                                       ≠
                                       ∅
                                    
                                 
                                 
                                    C
                                    ϵ
                                 
                                 
                                    (
                                    c
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

The definition of the core (20) implies that we need to consider all possible subcoalitions of the grand coalitions N i.e. 
                        
                           
                              2
                              
                                 |
                                 N
                                 |
                              
                           
                           −
                           1
                        
                      subcoalitions and compute their coalition value defined as the optimal value of the objective function (1) to determine a core element. Drechsel and Kimms (2010) proposed an iterative row generation procedure for the exact computation of a core element in a general case, that considers only a small subset of 2
                        N
                      and therefore significantly reduces the computational effort. In this section we adapt this procedure for the cooperative TSP to determine the cost allocation.

The core computation algorithm consists of two optimization problems: the master problem that computes a cost allocation π for a given set of coalitions and the subproblem which searches for a new coalition that violates the stability condition for the given cost allocation π. These two problems will be solved iteratively until a core element or (in case of an empty core) a least-core element is found.

The master problem is a relaxed version of the constraint satisfaction problem that corresponds to the core definition. Let 
                           S
                         be the set of coalitions considered in current iteration (in the first iteration we take 
                           
                              S
                              =
                              {
                              {
                              1
                              }
                              ,
                              {
                              2
                              }
                              ,
                              …
                              ,
                              {
                              n
                              }
                              ,
                              N
                              }
                           
                        ) then the master problem is defined as the following linear program:

                           
                              (23)
                              
                                 
                                    minimize
                                    
                                    
                                    
                                    ϵ
                                 
                              
                           
                        s.t.

                           
                              (24)
                              
                                 
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          N
                                       
                                    
                                    
                                       π
                                       i
                                    
                                    =
                                    c
                                    
                                       (
                                       N
                                       )
                                    
                                    
                                 
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          S
                                       
                                    
                                    
                                       π
                                       i
                                    
                                    ≤
                                    c
                                    
                                       (
                                       S
                                       )
                                    
                                    +
                                    ϵ
                                    
                                    S
                                    ∈
                                    S
                                 
                              
                           
                        
                        
                           
                              (26)
                              
                                 
                                    ϵ
                                    ≥
                                    0
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    
                                       π
                                       i
                                    
                                    ∈
                                    R
                                    
                                    i
                                    ∈
                                    N
                                 
                              
                           
                        
                     

Constraint (24) is an efficiency condition from the core definition and constraint (25) is a relaxed formulation of the stability condition. The optimal value of the objective function indicates whether the core is empty (ϵ > 0) for a given instance of the cooperative TSP or not (
                           
                              ϵ
                              =
                              0
                           
                        ). In case of the empty core the optimal value for ϵ defines the least-core element. The optimal values of πi
                         and ϵ are used as the input data for the subproblem.

The purpose of this subproblem is to find for π and ϵ from the solution of the master problem (23)–(27) a coalition 
                           
                              
                                 S
                                 ′
                              
                              ∉
                              S
                           
                         such that 
                           
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    
                                       S
                                       ′
                                    
                                 
                              
                              
                                 π
                                 i
                              
                              >
                              c
                              
                                 (
                                 
                                    S
                                    ′
                                 
                                 )
                              
                              +
                              ϵ
                           
                        . Therefore it includes in its formulation the CTSPRD to compute the coalitional value for S′. For the mathematical formulation of the subproblem the following additional notation is required. The parameter βki
                         indicates if the customer i belongs to the set V({k}) (
                           
                              
                                 β
                                 
                                    k
                                    i
                                 
                              
                              =
                              1
                           
                        ) or not (
                           
                              
                                 β
                                 
                                    k
                                    i
                                 
                              
                              =
                              0
                           
                        ). The new decision variable zk
                         identifies the set S′:

                           
                              
                                 
                                    
                                       z
                                       k
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   if
                                                   
                                                   k
                                                   ∈
                                                   
                                                      S
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The corresponding mixed-integer formulation of the subproblem is given as follows:

                           
                              (28)
                              
                                 
                                    maximize
                                    
                                    
                                    
                                    
                                       F
                                       3
                                    
                                    =
                                    −
                                    o
                                    b
                                    j
                                    +
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          N
                                       
                                    
                                    
                                       
                                          π
                                          k
                                       
                                       
                                          z
                                          k
                                       
                                    
                                    −
                                    ϵ
                                 
                              
                           
                        
                     

s.t.

                           
                              (29)
                              
                                 
                                    obj
                                    =
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          N
                                       
                                    
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          V
                                          
                                             (
                                             N
                                             )
                                          
                                          ∪
                                          
                                             {
                                             
                                                0
                                                k
                                             
                                             }
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          V
                                          
                                             (
                                             N
                                             )
                                          
                                          ∪
                                          
                                             {
                                             
                                                0
                                                k
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                          c
                                          
                                             i
                                             j
                                          
                                       
                                       
                                       
                                          x
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (30)
                              
                                 
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          N
                                       
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          V
                                          
                                             (
                                             N
                                             )
                                          
                                          ∪
                                          
                                             {
                                             
                                                0
                                                k
                                             
                                             }
                                          
                                       
                                    
                                    
                                       x
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          N
                                       
                                    
                                    
                                       
                                          z
                                          k
                                       
                                       
                                          β
                                          
                                             k
                                             i
                                          
                                       
                                    
                                    
                                    i
                                    ∈
                                    V
                                    
                                       (
                                       N
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          N
                                       
                                    
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          V
                                          
                                             (
                                             N
                                             )
                                          
                                          ∪
                                          
                                             {
                                             
                                                0
                                                k
                                             
                                             }
                                          
                                       
                                    
                                    
                                       x
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          N
                                       
                                    
                                    
                                       
                                          z
                                          k
                                       
                                       
                                          β
                                          
                                             k
                                             j
                                          
                                       
                                    
                                    
                                    j
                                    ∈
                                    V
                                    
                                       (
                                       N
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (32)
                              
                                 
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          V
                                          
                                             (
                                             N
                                             )
                                          
                                          ∪
                                          
                                             {
                                             
                                                0
                                                k
                                             
                                             }
                                          
                                       
                                    
                                    
                                       x
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          V
                                          
                                             (
                                             N
                                             )
                                          
                                          ∪
                                          
                                             {
                                             
                                                0
                                                l
                                             
                                             }
                                          
                                       
                                    
                                    
                                       x
                                       
                                          j
                                          i
                                          l
                                       
                                    
                                    ≤
                                    1
                                    
                                    i
                                    ∈
                                    V
                                    
                                       (
                                       N
                                       )
                                    
                                    ,
                                    
                                    k
                                    ,
                                    l
                                    ∈
                                    N
                                    ,
                                    k
                                    ≠
                                    l
                                    ,
                                 
                              
                           
                        
                        
                           
                              (33)
                              
                                 
                                    
                                       δ
                                       j
                                    
                                    +
                                    M
                                    ≥
                                    
                                       δ
                                       i
                                    
                                    +
                                    
                                       t
                                       
                                          i
                                          j
                                       
                                    
                                    +
                                    M
                                    
                                       x
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    
                                    i
                                    ∈
                                    V
                                    
                                       (
                                       N
                                       )
                                    
                                    ,
                                    
                                    j
                                    ∈
                                    V
                                    
                                       (
                                       N
                                       )
                                    
                                    ,
                                    
                                    j
                                    ≠
                                    i
                                    ,
                                    
                                    k
                                    ∈
                                    N
                                    ,
                                 
                              
                           
                        
                        
                           
                              (34)
                              
                                 
                                    
                                       x
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    ≤
                                    
                                       z
                                       k
                                    
                                    
                                    k
                                    ∈
                                    N
                                    ,
                                    
                                    i
                                    ,
                                    
                                    j
                                    ∈
                                    V
                                    
                                       (
                                       N
                                       )
                                    
                                    ∪
                                    
                                       {
                                       
                                          0
                                          k
                                       
                                       }
                                    
                                    
                                 
                              
                           
                        
                        
                           
                              (35)
                              
                                 
                                    
                                       δ
                                       i
                                    
                                    ≥
                                    
                                       d
                                       i
                                    
                                    
                                    i
                                    ∈
                                    V
                                    
                                       (
                                       N
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (36)
                              
                                 
                                    
                                       δ
                                       i
                                    
                                    ≤
                                    
                                       t
                                       max
                                    
                                    
                                    i
                                    ∈
                                    V
                                    
                                       (
                                       N
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (37)
                              
                                 
                                    
                                       x
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                    
                                    i
                                    ,
                                    
                                    j
                                    ∈
                                    V
                                    
                                       (
                                       N
                                       )
                                    
                                    ,
                                    
                                    k
                                    ∈
                                    N
                                    ,
                                 
                              
                           
                        
                        
                           
                              (38)
                              
                                 
                                    
                                       z
                                       k
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                    k
                                    ∈
                                    N
                                    .
                                 
                              
                           
                        
                     

The value of the objective function (28) identifies whether the coalition S′ should be added to the master problem (i.e. F
                        3 > 0) or the current cost allocation πi
                         determines a (least-) core element. The left hand side of the constraint (29) corresponds to the value of characteristic function c(S′). Constraints (30), (31) and (34) ensure that only depots and customers of salesmen from the set S′ are considered. Constraints (32), (33), (35), (36) are the same as in formulation (1)–(8) of the CTSPRD.

To the subproblem (28)–(38) we apply the same procedure as in Section 3 to transform it into the TSP with one salesman and therefore reduce the computational effort for solving this problem. The new formulation requires a separation of the set of nodes into customer nodes V(N) and depot nodes 
                           
                              
                                 
                                    V
                                    ˇ
                                 
                                 D
                              
                              
                                 (
                                 N
                                 )
                              
                           
                        . Furthermore k(i) denotes for depot i the corresponding salesman k.

                           
                              (39)
                              
                                 
                                    maximize
                                    
                                    
                                    
                                    
                                       F
                                       4
                                    
                                    =
                                    −
                                    obj
                                    +
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          N
                                       
                                    
                                    
                                       
                                          π
                                          k
                                       
                                       
                                          z
                                          k
                                       
                                    
                                    −
                                    ϵ
                                 
                              
                           
                        
                     

s.t.

                           
                              (40)
                              
                                 
                                    obj
                                    =
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          
                                             V
                                             ˇ
                                          
                                          
                                             (
                                             N
                                             )
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          
                                             V
                                             ˇ
                                          
                                          
                                             (
                                             N
                                             )
                                          
                                       
                                    
                                    
                                       
                                          c
                                          
                                             i
                                             j
                                          
                                       
                                       
                                       
                                          y
                                          
                                             i
                                             j
                                          
                                       
                                    
                                    
                                 
                              
                           
                        
                        
                           
                              (41)
                              
                                 
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          
                                             V
                                             ˇ
                                          
                                          
                                             (
                                             N
                                             )
                                          
                                       
                                    
                                    
                                       y
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          N
                                       
                                    
                                    
                                       
                                          z
                                          k
                                       
                                       
                                          β
                                          
                                             k
                                             i
                                          
                                       
                                    
                                    
                                    i
                                    ∈
                                    V
                                    
                                       (
                                       N
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (42)
                              
                                 
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          
                                             V
                                             ˇ
                                          
                                          
                                             (
                                             N
                                             )
                                          
                                       
                                    
                                    
                                       y
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          N
                                       
                                    
                                    
                                       
                                          z
                                          k
                                       
                                       
                                          β
                                          
                                             k
                                             j
                                          
                                       
                                    
                                    
                                    j
                                    ∈
                                    V
                                    
                                       (
                                       N
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (43)
                              
                                 
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          
                                             V
                                             ˇ
                                          
                                          
                                             (
                                             N
                                             )
                                          
                                       
                                    
                                    
                                       y
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       z
                                       
                                          k
                                          (
                                          i
                                          )
                                       
                                    
                                    
                                    i
                                    ∈
                                    
                                       
                                          V
                                          ˇ
                                       
                                       D
                                    
                                    
                                       (
                                       N
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (44)
                              
                                 
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          
                                             V
                                             ˇ
                                          
                                          
                                             (
                                             N
                                             )
                                          
                                       
                                    
                                    
                                       y
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       z
                                       
                                          k
                                          (
                                          j
                                          )
                                       
                                    
                                    
                                    j
                                    ∈
                                    
                                       
                                          V
                                          ˇ
                                       
                                       D
                                    
                                    
                                       (
                                       N
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (45)
                              
                                 
                                    
                                       δ
                                       j
                                    
                                    +
                                    M
                                    ≥
                                    
                                       δ
                                       i
                                    
                                    +
                                    
                                       t
                                       
                                          i
                                          j
                                       
                                    
                                    +
                                    M
                                    
                                       y
                                       
                                          i
                                          j
                                       
                                    
                                    
                                    i
                                    ,
                                    
                                    j
                                    ∈
                                    V
                                    
                                       (
                                       N
                                       )
                                    
                                    ∖
                                    
                                       {
                                       0
                                       }
                                    
                                    ,
                                    
                                    i
                                    ≠
                                    j
                                    ,
                                 
                              
                           
                        
                        
                           
                              (46)
                              
                                 
                                    
                                       γ
                                       j
                                    
                                    +
                                    M
                                    ≥
                                    
                                       γ
                                       i
                                    
                                    +
                                    1
                                    +
                                    M
                                    
                                       y
                                       
                                          i
                                          j
                                       
                                    
                                    
                                    i
                                    ,
                                    
                                    j
                                    ∈
                                    V
                                    
                                       (
                                       N
                                       )
                                    
                                    ∖
                                    
                                       {
                                       0
                                       }
                                    
                                    ,
                                    
                                    i
                                    ≠
                                    j
                                    ,
                                 
                              
                           
                        
                        
                           
                              (47)
                              
                                 
                                    
                                       γ
                                       
                                          0
                                          k
                                          1
                                       
                                    
                                    ≤
                                    
                                       γ
                                       
                                          0
                                          k
                                          2
                                       
                                    
                                    
                                    k
                                    ∈
                                    N
                                    ,
                                 
                              
                           
                        
                        
                           
                              (48)
                              
                                 
                                    
                                       y
                                       
                                          
                                             0
                                             k
                                             1
                                          
                                          ,
                                          
                                             0
                                             k
                                             1
                                          
                                       
                                    
                                    =
                                    
                                       y
                                       
                                          
                                             0
                                             k
                                             2
                                          
                                          ,
                                          
                                             0
                                             k
                                             2
                                          
                                       
                                    
                                    
                                    k
                                    ∈
                                    N
                                    ,
                                 
                              
                           
                        
                        
                           
                              (49)
                              
                                 
                                    
                                       δ
                                       i
                                    
                                    ≥
                                    
                                       d
                                       i
                                    
                                    
                                    i
                                    ∈
                                    V
                                    
                                       (
                                       N
                                       )
                                    
                                    ∖
                                    
                                       {
                                       0
                                       }
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (50)
                              
                                 
                                    
                                       δ
                                       
                                          0
                                          k
                                          2
                                       
                                    
                                    ≤
                                    
                                       t
                                       max
                                    
                                    
                                    k
                                    ∈
                                    N
                                    ,
                                 
                              
                           
                        
                        
                           
                              (51)
                              
                                 
                                    
                                       γ
                                       i
                                    
                                    ≥
                                    0
                                    
                                    
                                    i
                                    ∈
                                    V
                                    
                                       (
                                       N
                                       )
                                    
                                    ∖
                                    
                                       {
                                       0
                                       }
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (52)
                              
                                 
                                    
                                       y
                                       
                                          i
                                          j
                                       
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                    
                                    i
                                    ,
                                    
                                    j
                                    ∈
                                    V
                                    
                                       (
                                       N
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (53)
                              
                                 
                                    
                                       z
                                       k
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                    k
                                    ∈
                                    N
                                    .
                                 
                              
                           
                        
                     

Constraints (40)–(44) have the same meaning as constraints (29)–(31), (34) from the initial formulation of the subproblem. Other constraints are identical to the transformed formulation of CTSPRD (9)– (19).

After having presented formulations of all required optimization problems we can summarize the overall procedure for computing the cost allocation as follows:

                           
                              
                                 Step 1.
                              Initialization:
                                    
                                       a.
                                       Simulate the release dates for the planning horizon 
                                             T
                                           i.e. values di
                                          .

Define the initial set 
                                             
                                                S
                                                =
                                                {
                                                {
                                                1
                                                }
                                                ,
                                                {
                                                2
                                                }
                                                ,
                                                …
                                                ,
                                                {
                                                n
                                                }
                                                ,
                                                N
                                                }
                                             
                                          .

Compute coalitional values for all 
                                             
                                                S
                                                ∈
                                                S
                                             
                                           by solving the problem (9)–(19).

Solve the master problem (23)–(27) for the set 
                                    S
                                 .

With the values of π and ϵ solve the subproblem in formulation (39)–(53):

                                    
                                       a.
                                       If F
                                          4 ≤ 0 then the cost allocation is found. Go to Step 4.

Define 
                                             
                                                
                                                   S
                                                   ′
                                                
                                                =
                                                
                                                   {
                                                   i
                                                   ∈
                                                   N
                                                   |
                                                   
                                                      z
                                                      i
                                                   
                                                   =
                                                   1
                                                   }
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                c
                                                (
                                                
                                                   S
                                                   ′
                                                
                                                )
                                                =
                                                o
                                                b
                                                j
                                             
                                          .

Update 
                                             
                                                S
                                                =
                                                S
                                                ∪
                                                
                                                   S
                                                   ′
                                                
                                             
                                          .

Go to Step 2.

If 
                                    
                                       ϵ
                                       =
                                       0
                                    
                                  then π defines a core element, otherwise is π the least-core element.

Calculate the percentual value of the cost allocation, i.e. for all i ∈ N:

                                    
                                       (54)
                                       
                                          
                                             
                                                π
                                                i
                                                p
                                             
                                             =
                                             
                                                
                                                   π
                                                   i
                                                
                                                
                                                   c
                                                   (
                                                   N
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              

If the formation of a cooperation causes certain coordination costs that need to be explicitly considered in the allocation problem, the proposed allocation procedure can be modified using an ϵ-core (21), but with some negative-valued ϵ, which absolute value depicts coordination costs.

This section presents the results of our computational study where we tested the performance of the developed algorithm from Section 4.3. To determine the values of di
                      for every customer i ∈ V(N) we assume that they are independent exponentially distributed random variables. That means we associate with every customer i the rate parameter λi
                     . Using these rate parameters and rounding the obtained random values we generate for every customer i the order time di
                     . For the real-life case the historical data from customer orders can be used to construct the empirical distribution function for every customer and with its help generate possible future arrival times. Furthermore, traveling costs and times for our computational study where generated as uniform distributed random variables.

The key parameters for the proposed algorithm, that influence the computational effort, are the number of players |N| and the number of customer nodes V(N). We have generated examples with up to 10 salesmen and up to 50 customer nodes. For the evaluation of our computational study we used following criteria: run-time of the algorithm, number of iterations for core computation (i.e. number of subcoalitions tested), relative savings (min. and max.) in the coalition compared to the non-cooperative case and emptiness of the core. The savings are computed for i ∈ N as:

                        
                           (55)
                           
                              
                                 
                                    s
                                    i
                                 
                                 =
                                 
                                    
                                       c
                                       
                                          (
                                          
                                             {
                                             i
                                             }
                                          
                                          )
                                       
                                       −
                                       
                                          π
                                          i
                                       
                                    
                                    
                                       c
                                       (
                                       {
                                       i
                                       }
                                       )
                                    
                                 
                              
                           
                        
                     
                  

To keep the computation time within reasonable limits, we limited the solver time to 20, 000 seconds. The algorithm was implemented using the commercial software AMPL with the solver Gurobi 4.5.1 on a computer with 2.80 gigahertz Duo CPU, 8 gigabyte RAM. Table 1
                      presents the obtained results. In the third column the computation time for the instances is provided. The fourth column (It.) gives a number of additional subcoalitions that were considered for the computation of the cost allocation. The fifth column (c/l-c) shows whether the obtained cost allocation is in the core (c) or in the least-core (l-c).

As it can be seen from this table we could handle instances with up to 10 salesmen and with 35 customer nodes within the predefined computation time. Furthermore one instance with an empty core was found. The details on this example can be found in the online supplement to this paper. This means that the cooperative TSP with release dates (CTSPRD) game may have an empty core and is not balanced. The empty core was found for the coalition with 
                        
                           |
                           N
                           |
                           =
                           9
                        
                      players and 20 customer nodes. The stability condition was violated for 
                        
                           
                              |
                           
                           
                              S
                              ′
                           
                           
                              |
                              =
                              7
                           
                        
                      and the violation (value of the ϵ) was 1.7 percent of the total cost of coalition S′. For all other instances a core element was found.

The obtained results also show, that the developed algorithm significantly reduces the number of considered subcoalitions for a (least-) core element, this points out the efficiency of our approach. For instance, for 
                        
                           |
                           N
                           |
                           =
                           9
                        
                      only 20 coalitions on average (from 511 possible coalitions) were considered. Negative cost allocations in some instances (i.e. savings over 100 percent) are the implication of non-monotonicity of the cooperative TSP game. The run-time of the algorithm can also be validated as reasonable.

@&#CONCLUSIONS@&#

The proposed solution procedure computes a core element for the cooperative traveling salesman a priori. A computational study made on randomly generated instances showed the efficiency of the proposed algorithm as well as significant cost savings compared to the non-cooperative case. The found instance with an empty core additionally proves the usage of the least-core as a cooperative TSP game can have an empty core and therefore is not balanced. The least-core can be also implemented for the instances with non-empty core due to fairness issues. For a further discussion on fairness of the core concept we refer to Drechsel and Kimms (2010). The developed optimization approach can also be applied for a priori calculation of cost allocations in problems with rolling horizon. One can simulate the appearance of customer orders and incorporate them in the optimization model through the release dates. Additionally the idea of the presented algorithm can also be extended for further modifications of transportation planning (e.g. vehicle routing problems).

@&#ACKNOWLEDGMENT@&#

This work was done with financial support from the Deutsche Forschungsgemeinschaft grant KI 1272/5-2.

Supplementary material associated with this article can be found, in the online version, at 10.1016/j.ejor.2015.08.002.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

